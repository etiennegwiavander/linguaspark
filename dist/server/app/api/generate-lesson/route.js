"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/generate-lesson/route";
exports.ids = ["app/api/generate-lesson/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson%2Froute&page=%2Fapi%2Fgenerate-lesson%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson%2Froute&page=%2Fapi%2Fgenerate-lesson%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_linguaspark_app_api_generate_lesson_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/generate-lesson/route.ts */ \"(rsc)/./app/api/generate-lesson/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/generate-lesson/route\",\n        pathname: \"/api/generate-lesson\",\n        filename: \"route\",\n        bundlePath: \"app/api/generate-lesson/route\"\n    },\n    resolvedPagePath: \"D:\\\\linguaspark\\\\app\\\\api\\\\generate-lesson\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_linguaspark_app_api_generate_lesson_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/generate-lesson/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZnZW5lcmF0ZS1sZXNzb24lMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmdlbmVyYXRlLWxlc3NvbiUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmdlbmVyYXRlLWxlc3NvbiUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDbGluZ3Vhc3BhcmslNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUQlM0ElNUNsaW5ndWFzcGFyayZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDSTtBQUNqRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvPzI3ZDQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxcbGluZ3Vhc3BhcmtcXFxcYXBwXFxcXGFwaVxcXFxnZW5lcmF0ZS1sZXNzb25cXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2dlbmVyYXRlLWxlc3Nvbi9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2dlbmVyYXRlLWxlc3NvblwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvZ2VuZXJhdGUtbGVzc29uL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRDpcXFxcbGluZ3Vhc3BhcmtcXFxcYXBwXFxcXGFwaVxcXFxnZW5lcmF0ZS1sZXNzb25cXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2dlbmVyYXRlLWxlc3Nvbi9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson%2Froute&page=%2Fapi%2Fgenerate-lesson%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/generate-lesson/route.ts":
/*!******************************************!*\
  !*** ./app/api/generate-lesson/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_lesson_ai_generator_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/lesson-ai-generator-server */ \"(rsc)/./lib/lesson-ai-generator-server.ts\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/supabase-server */ \"(rsc)/./lib/supabase-server.ts\");\n/* harmony import */ var _lib_content_validator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/content-validator */ \"(rsc)/./lib/content-validator.ts\");\n/* harmony import */ var _lib_error_classifier__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/error-classifier */ \"(rsc)/./lib/error-classifier.ts\");\n/* harmony import */ var _lib_usage_monitor__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/usage-monitor */ \"(rsc)/./lib/usage-monitor.ts\");\n\n // Updated import to use server-side generator\n\n\n\n\nasync function POST(request) {\n    let userId;\n    let requestContext = {};\n    try {\n        const body = await request.json();\n        const { sourceText: sourceText1, lessonType: lessonType1, studentLevel: studentLevel1, targetLanguage, sourceUrl, contentMetadata, structuredContent, wordCount, readingTime } = body;\n        // Set up request context for error logging\n        requestContext = {\n            contentLength: sourceText1?.length,\n            lessonType: lessonType1,\n            studentLevel: studentLevel1,\n            targetLanguage,\n            apiEndpoint: \"/api/generate-lesson\"\n        };\n        // Validate required fields\n        if (!sourceText1 || !lessonType1 || !studentLevel1 || !targetLanguage) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: {\n                    type: \"CONTENT_ISSUE\",\n                    message: \"Missing required fields\",\n                    actionableSteps: [\n                        \"Ensure all required fields are provided\",\n                        \"Check that source text is selected\",\n                        \"Verify lesson type and student level are set\"\n                    ],\n                    errorId: `REQ_${Date.now()}`\n                }\n            }, {\n                status: 400\n            });\n        }\n        // Validate content before AI processing\n        const validationResult = _lib_content_validator__WEBPACK_IMPORTED_MODULE_3__.contentValidator.validateContent(sourceText1);\n        if (!validationResult.isValid) {\n            const classifiedError = _lib_error_classifier__WEBPACK_IMPORTED_MODULE_4__.errorClassifier.classifyError(new Error(`Content validation failed: ${validationResult.reason}`), requestContext);\n            const userMessage = _lib_error_classifier__WEBPACK_IMPORTED_MODULE_4__.errorClassifier.generateUserMessage(classifiedError);\n            const supportMessage = _lib_error_classifier__WEBPACK_IMPORTED_MODULE_4__.errorClassifier.generateSupportMessage(classifiedError);\n            // Log error for support\n            console.error(\"Content validation error:\", supportMessage);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: {\n                    type: userMessage.title,\n                    message: userMessage.message,\n                    actionableSteps: userMessage.actionableSteps,\n                    errorId: userMessage.errorId,\n                    supportContact: userMessage.supportContact\n                }\n            }, {\n                status: 400\n            });\n        }\n        // Validate user authentication\n        const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__.createServerSupabaseClient)();\n        const { data: { user }, error: authError } = await supabase.auth.getUser();\n        if (authError || !user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: {\n                    type: \"AUTHENTICATION_ERROR\",\n                    message: \"Authentication required\",\n                    actionableSteps: [\n                        \"Please log in to your account\",\n                        \"Refresh the page and try again\",\n                        \"Contact support if login issues persist\"\n                    ],\n                    errorId: `AUTH_${Date.now()}`\n                }\n            }, {\n                status: 401\n            });\n        }\n        userId = user.id;\n        // Set up usage monitoring context\n        const generationContext = {\n            userId: user.id,\n            lessonId: `lesson_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            lessonType: lessonType1,\n            difficultyLevel: studentLevel1,\n            contentLength: sourceText1.length,\n            timestamp: new Date()\n        };\n        requestContext.userId = userId;\n        // Generate lesson using AI-only approach\n        console.log(\"\\uD83D\\uDE80 Starting AI-only lesson generation...\");\n        const generationStartTime = Date.now();\n        const lesson = await _lib_lesson_ai_generator_server__WEBPACK_IMPORTED_MODULE_1__.lessonAIServerGenerator.generateLesson({\n            sourceText: sourceText1,\n            lessonType: lessonType1,\n            studentLevel: studentLevel1,\n            targetLanguage,\n            sourceUrl,\n            contentMetadata,\n            structuredContent,\n            wordCount,\n            readingTime\n        });\n        const generationEndTime = Date.now();\n        // Log generation completion and basic metrics\n        _lib_usage_monitor__WEBPACK_IMPORTED_MODULE_5__.usageMonitor.logTokenUsage(\"lesson-generation-complete\", 0, \"ai-only-generation\", generationContext);\n        // Validate AI-generated lesson - NO FALLBACKS\n        if (!lesson || !lesson.sections || Object.keys(lesson.sections).length === 0) {\n            throw new Error(\"AI generation returned empty or invalid lesson structure\");\n        }\n        console.log(\"✅ AI lesson generation successful:\", {\n            sectionKeys: Object.keys(lesson.sections),\n            lessonType: lesson.lessonType,\n            studentLevel: lesson.studentLevel,\n            targetLanguage: lesson.targetLanguage\n        });\n        // Prepare final lesson structure (AI-only, no fallbacks)\n        const finalLesson = {\n            lessonType: lesson.lessonType,\n            studentLevel: lesson.studentLevel,\n            targetLanguage: lesson.targetLanguage,\n            sections: lesson.sections\n        };\n        // Save the AI-generated lesson\n        const { data: savedLesson, error: saveError } = await supabase.from(\"lessons\").insert({\n            tutor_id: user.id,\n            title: `${lessonType1} Lesson - ${new Date().toLocaleDateString()}`,\n            lesson_type: lessonType1,\n            student_level: studentLevel1,\n            target_language: targetLanguage,\n            source_url: sourceUrl,\n            source_text: sourceText1,\n            lesson_data: finalLesson\n        }).select().single();\n        if (saveError) {\n            console.error(\"Error saving lesson (non-critical):\", saveError);\n        // Return lesson even if save fails - this is not a generation failure\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            lesson: {\n                ...finalLesson,\n                id: savedLesson?.id\n            }\n        });\n    } catch (error) {\n        // Log error to usage monitor\n        if (userId) {\n            const errorContext = {\n                userId,\n                lessonId: `lesson_${Date.now()}_error`,\n                lessonType,\n                difficultyLevel: studentLevel,\n                contentLength: sourceText?.length || 0,\n                timestamp: new Date()\n            };\n            _lib_usage_monitor__WEBPACK_IMPORTED_MODULE_5__.usageMonitor.logError(error, \"AI_GENERATION_FAILED\", errorContext);\n        }\n        // Classify the error and generate appropriate response\n        const aiError = error;\n        const classifiedError = _lib_error_classifier__WEBPACK_IMPORTED_MODULE_4__.errorClassifier.classifyError(aiError, {\n            ...requestContext,\n            userId\n        });\n        const userMessage = _lib_error_classifier__WEBPACK_IMPORTED_MODULE_4__.errorClassifier.generateUserMessage(classifiedError);\n        const supportMessage = _lib_error_classifier__WEBPACK_IMPORTED_MODULE_4__.errorClassifier.generateSupportMessage(classifiedError);\n        // Log detailed error information for support and debugging\n        console.error(\"AI lesson generation error:\", {\n            errorId: supportMessage.errorId,\n            type: supportMessage.type,\n            technicalDetails: supportMessage.technicalDetails,\n            context: supportMessage.context,\n            stackTrace: supportMessage.stackTrace\n        });\n        // Return structured error response (NO FALLBACK CONTENT)\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: {\n                type: userMessage.title,\n                message: userMessage.message,\n                actionableSteps: userMessage.actionableSteps,\n                errorId: userMessage.errorId,\n                supportContact: userMessage.supportContact\n            }\n        }, {\n            status: classifiedError.type === \"QUOTA_EXCEEDED\" ? 429 : classifiedError.type === \"CONTENT_ISSUE\" ? 400 : classifiedError.type === \"NETWORK_ERROR\" ? 503 : 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0Y7UUFFQSxNQUFNZ0MsY0FBY3BDLGtFQUFlQSxDQUFDcUMsbUJBQW1CLENBQUNMO1FBQ3hELE1BQU1NLGlCQUFpQnRDLGtFQUFlQSxDQUFDdUMsc0JBQXNCLENBQUNQO1FBRTlELDJEQUEyRDtRQUMzRFEsUUFBUW5CLEtBQUssQ0FBQywrQkFBK0I7WUFDM0NJLFNBQVNhLGVBQWViLE9BQU87WUFDL0JILE1BQU1nQixlQUFlaEIsSUFBSTtZQUN6QmdFLGtCQUFrQmhELGVBQWVnRCxnQkFBZ0I7WUFDakRDLFNBQVNqRCxlQUFlaUQsT0FBTztZQUMvQkMsWUFBWWxELGVBQWVrRCxVQUFVO1FBQ3ZDO1FBRUEseURBQXlEO1FBQ3pELE9BQU81RixxREFBWUEsQ0FBQ1csSUFBSSxDQUFDO1lBQ3ZCYSxTQUFTO1lBQ1RDLE9BQU87Z0JBQ0xDLE1BQU1jLFlBQVlLLEtBQUs7Z0JBQ3ZCbEIsU0FBU2EsWUFBWWIsT0FBTztnQkFDNUJDLGlCQUFpQlksWUFBWVosZUFBZTtnQkFDNUNDLFNBQVNXLFlBQVlYLE9BQU87Z0JBQzVCaUIsZ0JBQWdCTixZQUFZTSxjQUFjO1lBQzVDO1FBQ0YsR0FBRztZQUNEZCxRQUFRSSxnQkFBZ0JWLElBQUksS0FBSyxtQkFBbUIsTUFDNUNVLGdCQUFnQlYsSUFBSSxLQUFLLGtCQUFrQixNQUMzQ1UsZ0JBQWdCVixJQUFJLEtBQUssa0JBQWtCLE1BQU07UUFDM0Q7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktdjAtcHJvamVjdC8uL2FwcC9hcGkvZ2VuZXJhdGUtbGVzc29uL3JvdXRlLnRzPzVhYmYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdHlwZSBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCJcbmltcG9ydCB7IGxlc3NvbkFJU2VydmVyR2VuZXJhdG9yIH0gZnJvbSBcIkAvbGliL2xlc3Nvbi1haS1nZW5lcmF0b3Itc2VydmVyXCIgLy8gVXBkYXRlZCBpbXBvcnQgdG8gdXNlIHNlcnZlci1zaWRlIGdlbmVyYXRvclxuaW1wb3J0IHsgY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQgfSBmcm9tIFwiQC9saWIvc3VwYWJhc2Utc2VydmVyXCJcbmltcG9ydCB7IGNvbnRlbnRWYWxpZGF0b3IgfSBmcm9tIFwiQC9saWIvY29udGVudC12YWxpZGF0b3JcIlxuaW1wb3J0IHsgZXJyb3JDbGFzc2lmaWVyLCB0eXBlIEFJRXJyb3IgfSBmcm9tIFwiQC9saWIvZXJyb3ItY2xhc3NpZmllclwiXG5pbXBvcnQgeyB1c2FnZU1vbml0b3IsIHR5cGUgR2VuZXJhdGlvbkNvbnRleHQgfSBmcm9tIFwiQC9saWIvdXNhZ2UtbW9uaXRvclwiXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGxldCB1c2VySWQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgbGV0IHJlcXVlc3RDb250ZXh0OiBhbnkgPSB7fTtcblxuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgIGNvbnN0IHsgXG4gICAgICBzb3VyY2VUZXh0LCBcbiAgICAgIGxlc3NvblR5cGUsIFxuICAgICAgc3R1ZGVudExldmVsLCBcbiAgICAgIHRhcmdldExhbmd1YWdlLCBcbiAgICAgIHNvdXJjZVVybCxcbiAgICAgIGNvbnRlbnRNZXRhZGF0YSxcbiAgICAgIHN0cnVjdHVyZWRDb250ZW50LFxuICAgICAgd29yZENvdW50LFxuICAgICAgcmVhZGluZ1RpbWVcbiAgICB9ID0gYm9keVxuXG4gICAgLy8gU2V0IHVwIHJlcXVlc3QgY29udGV4dCBmb3IgZXJyb3IgbG9nZ2luZ1xuICAgIHJlcXVlc3RDb250ZXh0ID0ge1xuICAgICAgY29udGVudExlbmd0aDogc291cmNlVGV4dD8ubGVuZ3RoLFxuICAgICAgbGVzc29uVHlwZSxcbiAgICAgIHN0dWRlbnRMZXZlbCxcbiAgICAgIHRhcmdldExhbmd1YWdlLFxuICAgICAgYXBpRW5kcG9pbnQ6ICcvYXBpL2dlbmVyYXRlLWxlc3NvbidcbiAgICB9O1xuXG4gICAgLy8gVmFsaWRhdGUgcmVxdWlyZWQgZmllbGRzXG4gICAgaWYgKCFzb3VyY2VUZXh0IHx8ICFsZXNzb25UeXBlIHx8ICFzdHVkZW50TGV2ZWwgfHwgIXRhcmdldExhbmd1YWdlKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgdHlwZTogJ0NPTlRFTlRfSVNTVUUnLFxuICAgICAgICAgIG1lc3NhZ2U6ICdNaXNzaW5nIHJlcXVpcmVkIGZpZWxkcycsXG4gICAgICAgICAgYWN0aW9uYWJsZVN0ZXBzOiBbXG4gICAgICAgICAgICAnRW5zdXJlIGFsbCByZXF1aXJlZCBmaWVsZHMgYXJlIHByb3ZpZGVkJyxcbiAgICAgICAgICAgICdDaGVjayB0aGF0IHNvdXJjZSB0ZXh0IGlzIHNlbGVjdGVkJyxcbiAgICAgICAgICAgICdWZXJpZnkgbGVzc29uIHR5cGUgYW5kIHN0dWRlbnQgbGV2ZWwgYXJlIHNldCdcbiAgICAgICAgICBdLFxuICAgICAgICAgIGVycm9ySWQ6IGBSRVFfJHtEYXRlLm5vdygpfWBcbiAgICAgICAgfVxuICAgICAgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIGNvbnRlbnQgYmVmb3JlIEFJIHByb2Nlc3NpbmdcbiAgICBjb25zdCB2YWxpZGF0aW9uUmVzdWx0ID0gY29udGVudFZhbGlkYXRvci52YWxpZGF0ZUNvbnRlbnQoc291cmNlVGV4dClcbiAgICBpZiAoIXZhbGlkYXRpb25SZXN1bHQuaXNWYWxpZCkge1xuICAgICAgY29uc3QgY2xhc3NpZmllZEVycm9yID0gZXJyb3JDbGFzc2lmaWVyLmNsYXNzaWZ5RXJyb3IoXG4gICAgICAgIG5ldyBFcnJvcihgQ29udGVudCB2YWxpZGF0aW9uIGZhaWxlZDogJHt2YWxpZGF0aW9uUmVzdWx0LnJlYXNvbn1gKSBhcyBBSUVycm9yLFxuICAgICAgICByZXF1ZXN0Q29udGV4dFxuICAgICAgKTtcbiAgICAgIGNvbnN0IHVzZXJNZXNzYWdlID0gZXJyb3JDbGFzc2lmaWVyLmdlbmVyYXRlVXNlck1lc3NhZ2UoY2xhc3NpZmllZEVycm9yKTtcbiAgICAgIGNvbnN0IHN1cHBvcnRNZXNzYWdlID0gZXJyb3JDbGFzc2lmaWVyLmdlbmVyYXRlU3VwcG9ydE1lc3NhZ2UoY2xhc3NpZmllZEVycm9yKTtcbiAgICAgIFxuICAgICAgLy8gTG9nIGVycm9yIGZvciBzdXBwb3J0XG4gICAgICBjb25zb2xlLmVycm9yKFwiQ29udGVudCB2YWxpZGF0aW9uIGVycm9yOlwiLCBzdXBwb3J0TWVzc2FnZSk7XG4gICAgICBcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICB0eXBlOiB1c2VyTWVzc2FnZS50aXRsZSxcbiAgICAgICAgICBtZXNzYWdlOiB1c2VyTWVzc2FnZS5tZXNzYWdlLFxuICAgICAgICAgIGFjdGlvbmFibGVTdGVwczogdXNlck1lc3NhZ2UuYWN0aW9uYWJsZVN0ZXBzLFxuICAgICAgICAgIGVycm9ySWQ6IHVzZXJNZXNzYWdlLmVycm9ySWQsXG4gICAgICAgICAgc3VwcG9ydENvbnRhY3Q6IHVzZXJNZXNzYWdlLnN1cHBvcnRDb250YWN0XG4gICAgICAgIH1cbiAgICAgIH0sIHsgc3RhdHVzOiA0MDAgfSlcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSB1c2VyIGF1dGhlbnRpY2F0aW9uXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTZXJ2ZXJTdXBhYmFzZUNsaWVudCgpXG4gICAgY29uc3Qge1xuICAgICAgZGF0YTogeyB1c2VyIH0sXG4gICAgICBlcnJvcjogYXV0aEVycm9yLFxuICAgIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIoKVxuXG4gICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIHR5cGU6ICdBVVRIRU5USUNBVElPTl9FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJyxcbiAgICAgICAgICBhY3Rpb25hYmxlU3RlcHM6IFtcbiAgICAgICAgICAgICdQbGVhc2UgbG9nIGluIHRvIHlvdXIgYWNjb3VudCcsXG4gICAgICAgICAgICAnUmVmcmVzaCB0aGUgcGFnZSBhbmQgdHJ5IGFnYWluJyxcbiAgICAgICAgICAgICdDb250YWN0IHN1cHBvcnQgaWYgbG9naW4gaXNzdWVzIHBlcnNpc3QnXG4gICAgICAgICAgXSxcbiAgICAgICAgICBlcnJvcklkOiBgQVVUSF8ke0RhdGUubm93KCl9YFxuICAgICAgICB9XG4gICAgICB9LCB7IHN0YXR1czogNDAxIH0pXG4gICAgfVxuXG4gICAgdXNlcklkID0gdXNlci5pZDtcblxuICAgIC8vIFNldCB1cCB1c2FnZSBtb25pdG9yaW5nIGNvbnRleHRcbiAgICBjb25zdCBnZW5lcmF0aW9uQ29udGV4dDogR2VuZXJhdGlvbkNvbnRleHQgPSB7XG4gICAgICB1c2VySWQ6IHVzZXIuaWQsXG4gICAgICBsZXNzb25JZDogYGxlc3Nvbl8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWAsXG4gICAgICBsZXNzb25UeXBlLFxuICAgICAgZGlmZmljdWx0eUxldmVsOiBzdHVkZW50TGV2ZWwsXG4gICAgICBjb250ZW50TGVuZ3RoOiBzb3VyY2VUZXh0Lmxlbmd0aCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgIH07XG4gICAgcmVxdWVzdENvbnRleHQudXNlcklkID0gdXNlcklkO1xuXG4gICAgLy8gR2VuZXJhdGUgbGVzc29uIHVzaW5nIEFJLW9ubHkgYXBwcm9hY2hcbiAgICBjb25zb2xlLmxvZyhcIvCfmoAgU3RhcnRpbmcgQUktb25seSBsZXNzb24gZ2VuZXJhdGlvbi4uLlwiKTtcbiAgICBcbiAgICBjb25zdCBnZW5lcmF0aW9uU3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCBsZXNzb24gPSBhd2FpdCBsZXNzb25BSVNlcnZlckdlbmVyYXRvci5nZW5lcmF0ZUxlc3Nvbih7XG4gICAgICBzb3VyY2VUZXh0LFxuICAgICAgbGVzc29uVHlwZSxcbiAgICAgIHN0dWRlbnRMZXZlbCxcbiAgICAgIHRhcmdldExhbmd1YWdlLFxuICAgICAgc291cmNlVXJsLFxuICAgICAgY29udGVudE1ldGFkYXRhLFxuICAgICAgc3RydWN0dXJlZENvbnRlbnQsXG4gICAgICB3b3JkQ291bnQsXG4gICAgICByZWFkaW5nVGltZSxcbiAgICB9KVxuICAgIGNvbnN0IGdlbmVyYXRpb25FbmRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgIC8vIExvZyBnZW5lcmF0aW9uIGNvbXBsZXRpb24gYW5kIGJhc2ljIG1ldHJpY3NcbiAgICB1c2FnZU1vbml0b3IubG9nVG9rZW5Vc2FnZShcbiAgICAgICdsZXNzb24tZ2VuZXJhdGlvbi1jb21wbGV0ZScsXG4gICAgICAwLCAvLyBXaWxsIGJlIHVwZGF0ZWQgd2l0aCBhY3R1YWwgdG9rZW4gY291bnRzIGZyb20gQUkgY2FsbHNcbiAgICAgICdhaS1vbmx5LWdlbmVyYXRpb24nLFxuICAgICAgZ2VuZXJhdGlvbkNvbnRleHRcbiAgICApO1xuXG4gICAgLy8gVmFsaWRhdGUgQUktZ2VuZXJhdGVkIGxlc3NvbiAtIE5PIEZBTExCQUNLU1xuICAgIGlmICghbGVzc29uIHx8ICFsZXNzb24uc2VjdGlvbnMgfHwgT2JqZWN0LmtleXMobGVzc29uLnNlY3Rpb25zKS5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkFJIGdlbmVyYXRpb24gcmV0dXJuZWQgZW1wdHkgb3IgaW52YWxpZCBsZXNzb24gc3RydWN0dXJlXCIpO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKFwi4pyFIEFJIGxlc3NvbiBnZW5lcmF0aW9uIHN1Y2Nlc3NmdWw6XCIsIHtcbiAgICAgIHNlY3Rpb25LZXlzOiBPYmplY3Qua2V5cyhsZXNzb24uc2VjdGlvbnMpLFxuICAgICAgbGVzc29uVHlwZTogbGVzc29uLmxlc3NvblR5cGUsXG4gICAgICBzdHVkZW50TGV2ZWw6IGxlc3Nvbi5zdHVkZW50TGV2ZWwsXG4gICAgICB0YXJnZXRMYW5ndWFnZTogbGVzc29uLnRhcmdldExhbmd1YWdlXG4gICAgfSk7XG5cbiAgICAvLyBQcmVwYXJlIGZpbmFsIGxlc3NvbiBzdHJ1Y3R1cmUgKEFJLW9ubHksIG5vIGZhbGxiYWNrcylcbiAgICBjb25zdCBmaW5hbExlc3NvbiA9IHtcbiAgICAgIGxlc3NvblR5cGU6IGxlc3Nvbi5sZXNzb25UeXBlLFxuICAgICAgc3R1ZGVudExldmVsOiBsZXNzb24uc3R1ZGVudExldmVsLFxuICAgICAgdGFyZ2V0TGFuZ3VhZ2U6IGxlc3Nvbi50YXJnZXRMYW5ndWFnZSxcbiAgICAgIHNlY3Rpb25zOiBsZXNzb24uc2VjdGlvbnNcbiAgICB9O1xuXG4gICAgLy8gU2F2ZSB0aGUgQUktZ2VuZXJhdGVkIGxlc3NvblxuICAgIGNvbnN0IHsgZGF0YTogc2F2ZWRMZXNzb24sIGVycm9yOiBzYXZlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbShcImxlc3NvbnNcIilcbiAgICAgIC5pbnNlcnQoe1xuICAgICAgICB0dXRvcl9pZDogdXNlci5pZCxcbiAgICAgICAgdGl0bGU6IGAke2xlc3NvblR5cGV9IExlc3NvbiAtICR7bmV3IERhdGUoKS50b0xvY2FsZURhdGVTdHJpbmcoKX1gLFxuICAgICAgICBsZXNzb25fdHlwZTogbGVzc29uVHlwZSxcbiAgICAgICAgc3R1ZGVudF9sZXZlbDogc3R1ZGVudExldmVsLFxuICAgICAgICB0YXJnZXRfbGFuZ3VhZ2U6IHRhcmdldExhbmd1YWdlLFxuICAgICAgICBzb3VyY2VfdXJsOiBzb3VyY2VVcmwsXG4gICAgICAgIHNvdXJjZV90ZXh0OiBzb3VyY2VUZXh0LFxuICAgICAgICBsZXNzb25fZGF0YTogZmluYWxMZXNzb24sXG4gICAgICB9KVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKClcblxuICAgIGlmIChzYXZlRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBzYXZpbmcgbGVzc29uIChub24tY3JpdGljYWwpOlwiLCBzYXZlRXJyb3IpO1xuICAgICAgLy8gUmV0dXJuIGxlc3NvbiBldmVuIGlmIHNhdmUgZmFpbHMgLSB0aGlzIGlzIG5vdCBhIGdlbmVyYXRpb24gZmFpbHVyZVxuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbGVzc29uOiB7XG4gICAgICAgIC4uLmZpbmFsTGVzc29uLFxuICAgICAgICBpZDogc2F2ZWRMZXNzb24/LmlkLFxuICAgICAgfSxcbiAgICB9KVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgLy8gTG9nIGVycm9yIHRvIHVzYWdlIG1vbml0b3JcbiAgICBpZiAodXNlcklkKSB7XG4gICAgICBjb25zdCBlcnJvckNvbnRleHQ6IEdlbmVyYXRpb25Db250ZXh0ID0ge1xuICAgICAgICB1c2VySWQsXG4gICAgICAgIGxlc3NvbklkOiBgbGVzc29uXyR7RGF0ZS5ub3coKX1fZXJyb3JgLFxuICAgICAgICBsZXNzb25UeXBlLFxuICAgICAgICBkaWZmaWN1bHR5TGV2ZWw6IHN0dWRlbnRMZXZlbCxcbiAgICAgICAgY29udGVudExlbmd0aDogc291cmNlVGV4dD8ubGVuZ3RoIHx8IDAsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgICAgfTtcbiAgICAgIHVzYWdlTW9uaXRvci5sb2dFcnJvcihlcnJvciBhcyBFcnJvciwgJ0FJX0dFTkVSQVRJT05fRkFJTEVEJywgZXJyb3JDb250ZXh0KTtcbiAgICB9XG5cbiAgICAvLyBDbGFzc2lmeSB0aGUgZXJyb3IgYW5kIGdlbmVyYXRlIGFwcHJvcHJpYXRlIHJlc3BvbnNlXG4gICAgY29uc3QgYWlFcnJvciA9IGVycm9yIGFzIEFJRXJyb3I7XG4gICAgY29uc3QgY2xhc3NpZmllZEVycm9yID0gZXJyb3JDbGFzc2lmaWVyLmNsYXNzaWZ5RXJyb3IoYWlFcnJvciwge1xuICAgICAgLi4ucmVxdWVzdENvbnRleHQsXG4gICAgICB1c2VySWRcbiAgICB9KTtcbiAgICBcbiAgICBjb25zdCB1c2VyTWVzc2FnZSA9IGVycm9yQ2xhc3NpZmllci5nZW5lcmF0ZVVzZXJNZXNzYWdlKGNsYXNzaWZpZWRFcnJvcik7XG4gICAgY29uc3Qgc3VwcG9ydE1lc3NhZ2UgPSBlcnJvckNsYXNzaWZpZXIuZ2VuZXJhdGVTdXBwb3J0TWVzc2FnZShjbGFzc2lmaWVkRXJyb3IpO1xuICAgIFxuICAgIC8vIExvZyBkZXRhaWxlZCBlcnJvciBpbmZvcm1hdGlvbiBmb3Igc3VwcG9ydCBhbmQgZGVidWdnaW5nXG4gICAgY29uc29sZS5lcnJvcihcIkFJIGxlc3NvbiBnZW5lcmF0aW9uIGVycm9yOlwiLCB7XG4gICAgICBlcnJvcklkOiBzdXBwb3J0TWVzc2FnZS5lcnJvcklkLFxuICAgICAgdHlwZTogc3VwcG9ydE1lc3NhZ2UudHlwZSxcbiAgICAgIHRlY2huaWNhbERldGFpbHM6IHN1cHBvcnRNZXNzYWdlLnRlY2huaWNhbERldGFpbHMsXG4gICAgICBjb250ZXh0OiBzdXBwb3J0TWVzc2FnZS5jb250ZXh0LFxuICAgICAgc3RhY2tUcmFjZTogc3VwcG9ydE1lc3NhZ2Uuc3RhY2tUcmFjZVxuICAgIH0pO1xuXG4gICAgLy8gUmV0dXJuIHN0cnVjdHVyZWQgZXJyb3IgcmVzcG9uc2UgKE5PIEZBTExCQUNLIENPTlRFTlQpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIHR5cGU6IHVzZXJNZXNzYWdlLnRpdGxlLFxuICAgICAgICBtZXNzYWdlOiB1c2VyTWVzc2FnZS5tZXNzYWdlLFxuICAgICAgICBhY3Rpb25hYmxlU3RlcHM6IHVzZXJNZXNzYWdlLmFjdGlvbmFibGVTdGVwcyxcbiAgICAgICAgZXJyb3JJZDogdXNlck1lc3NhZ2UuZXJyb3JJZCxcbiAgICAgICAgc3VwcG9ydENvbnRhY3Q6IHVzZXJNZXNzYWdlLnN1cHBvcnRDb250YWN0XG4gICAgICB9XG4gICAgfSwgeyBcbiAgICAgIHN0YXR1czogY2xhc3NpZmllZEVycm9yLnR5cGUgPT09ICdRVU9UQV9FWENFRURFRCcgPyA0MjkgOiBcbiAgICAgICAgICAgICAgY2xhc3NpZmllZEVycm9yLnR5cGUgPT09ICdDT05URU5UX0lTU1VFJyA/IDQwMCA6XG4gICAgICAgICAgICAgIGNsYXNzaWZpZWRFcnJvci50eXBlID09PSAnTkVUV09SS19FUlJPUicgPyA1MDMgOiA1MDAgXG4gICAgfSlcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImxlc3NvbkFJU2VydmVyR2VuZXJhdG9yIiwiY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQiLCJjb250ZW50VmFsaWRhdG9yIiwiZXJyb3JDbGFzc2lmaWVyIiwidXNhZ2VNb25pdG9yIiwiUE9TVCIsInJlcXVlc3QiLCJ1c2VySWQiLCJyZXF1ZXN0Q29udGV4dCIsImJvZHkiLCJqc29uIiwic291cmNlVGV4dCIsImxlc3NvblR5cGUiLCJzdHVkZW50TGV2ZWwiLCJ0YXJnZXRMYW5ndWFnZSIsInNvdXJjZVVybCIsImNvbnRlbnRNZXRhZGF0YSIsInN0cnVjdHVyZWRDb250ZW50Iiwid29yZENvdW50IiwicmVhZGluZ1RpbWUiLCJjb250ZW50TGVuZ3RoIiwibGVuZ3RoIiwiYXBpRW5kcG9pbnQiLCJzdWNjZXNzIiwiZXJyb3IiLCJ0eXBlIiwibWVzc2FnZSIsImFjdGlvbmFibGVTdGVwcyIsImVycm9ySWQiLCJEYXRlIiwibm93Iiwic3RhdHVzIiwidmFsaWRhdGlvblJlc3VsdCIsInZhbGlkYXRlQ29udGVudCIsImlzVmFsaWQiLCJjbGFzc2lmaWVkRXJyb3IiLCJjbGFzc2lmeUVycm9yIiwiRXJyb3IiLCJyZWFzb24iLCJ1c2VyTWVzc2FnZSIsImdlbmVyYXRlVXNlck1lc3NhZ2UiLCJzdXBwb3J0TWVzc2FnZSIsImdlbmVyYXRlU3VwcG9ydE1lc3NhZ2UiLCJjb25zb2xlIiwidGl0bGUiLCJzdXBwb3J0Q29udGFjdCIsInN1cGFiYXNlIiwiZGF0YSIsInVzZXIiLCJhdXRoRXJyb3IiLCJhdXRoIiwiZ2V0VXNlciIsImlkIiwiZ2VuZXJhdGlvbkNvbnRleHQiLCJsZXNzb25JZCIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0ciIsImRpZmZpY3VsdHlMZXZlbCIsInRpbWVzdGFtcCIsImxvZyIsImdlbmVyYXRpb25TdGFydFRpbWUiLCJsZXNzb24iLCJnZW5lcmF0ZUxlc3NvbiIsImdlbmVyYXRpb25FbmRUaW1lIiwibG9nVG9rZW5Vc2FnZSIsInNlY3Rpb25zIiwiT2JqZWN0Iiwia2V5cyIsInNlY3Rpb25LZXlzIiwiZmluYWxMZXNzb24iLCJzYXZlZExlc3NvbiIsInNhdmVFcnJvciIsImZyb20iLCJpbnNlcnQiLCJ0dXRvcl9pZCIsInRvTG9jYWxlRGF0ZVN0cmluZyIsImxlc3Nvbl90eXBlIiwic3R1ZGVudF9sZXZlbCIsInRhcmdldF9sYW5ndWFnZSIsInNvdXJjZV91cmwiLCJzb3VyY2VfdGV4dCIsImxlc3Nvbl9kYXRhIiwic2VsZWN0Iiwic2luZ2xlIiwiZXJyb3JDb250ZXh0IiwibG9nRXJyb3IiLCJhaUVycm9yIiwidGVjaG5pY2FsRGV0YWlscyIsImNvbnRleHQiLCJzdGFja1RyYWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/generate-lesson/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/content-validator.ts":
/*!**********************************!*\
  !*** ./lib/content-validator.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ContentValidatorImpl: () => (/* binding */ ContentValidatorImpl),\n/* harmony export */   contentValidator: () => (/* binding */ contentValidator)\n/* harmony export */ });\n/**\r\n * Content Validation Service\r\n * \r\n * Ensures source content meets minimum requirements for AI processing\r\n * before attempting lesson generation.\r\n */ class ContentValidatorImpl {\n    /**\r\n   * Validates content for AI lesson generation suitability\r\n   */ validateContent(content) {\n        // Basic sanitization and preparation\n        const cleanContent = this.sanitizeContent(content);\n        if (!cleanContent || cleanContent.trim().length === 0) {\n            return {\n                isValid: false,\n                reason: \"No content provided\",\n                suggestions: [\n                    \"Please select or paste some text content to generate a lesson from\"\n                ]\n            };\n        }\n        // Check minimum word count\n        const wordCount = this.getWordCount(cleanContent);\n        if (wordCount < this.MINIMUM_WORD_COUNT) {\n            return {\n                isValid: false,\n                reason: `Content too short (${wordCount} words, minimum ${this.MINIMUM_WORD_COUNT} required)`,\n                suggestions: [\n                    \"Select more text from the webpage\",\n                    \"Choose a longer article or passage\",\n                    \"Combine multiple paragraphs for better lesson content\"\n                ]\n            };\n        }\n        // Check sentence count\n        const sentenceCount = this.getSentenceCount(cleanContent);\n        if (sentenceCount < this.MINIMUM_SENTENCE_COUNT) {\n            return {\n                isValid: false,\n                reason: `Content lacks structure (${sentenceCount} sentences, minimum ${this.MINIMUM_SENTENCE_COUNT} required)`,\n                suggestions: [\n                    \"Select content with complete sentences\",\n                    \"Choose text with proper punctuation\",\n                    \"Avoid selecting only titles or bullet points\"\n                ]\n            };\n        }\n        // Check content quality\n        const qualityScore = this.checkContentQuality(cleanContent);\n        if (qualityScore.score < this.MINIMUM_QUALITY_SCORE) {\n            return {\n                isValid: false,\n                reason: `Content quality insufficient for lesson generation (score: ${qualityScore.score}/100)`,\n                suggestions: this.getQualityImprovementSuggestions(qualityScore)\n            };\n        }\n        return {\n            isValid: true\n        };\n    }\n    /**\r\n   * Returns the minimum word count required for content validation\r\n   */ getMinimumWordCount() {\n        return this.MINIMUM_WORD_COUNT;\n    }\n    /**\r\n   * Analyzes content quality and returns a detailed score\r\n   */ checkContentQuality(content) {\n        const cleanContent = this.sanitizeContent(content);\n        const words = this.getWords(cleanContent);\n        const sentences = this.getSentences(cleanContent);\n        const wordCount = words.length;\n        const sentenceCount = sentences.length;\n        const averageWordsPerSentence = sentenceCount > 0 ? wordCount / sentenceCount : 0;\n        // Check vocabulary variety (unique words vs total words)\n        const uniqueWords = new Set(words.map((word)=>word.toLowerCase()));\n        const vocabularyVariety = uniqueWords.size / wordCount;\n        const hasVariedVocabulary = vocabularyVariety > 0.4; // At least 40% unique words\n        // Check for complete thoughts (sentences ending with proper punctuation)\n        const completeThoughts = sentences.filter((sentence)=>/[.!?]$/.test(sentence.trim())).length;\n        const hasCompleteThoughts = completeThoughts / sentenceCount > 0.7; // 70% complete sentences\n        // Calculate overall quality score\n        let score = 0;\n        // Word count factor (0-30 points)\n        if (wordCount >= this.MINIMUM_WORD_COUNT) {\n            score += Math.min(30, wordCount / 200 * 30); // Max points at 200 words\n        }\n        // Sentence structure factor (0-25 points)\n        if (averageWordsPerSentence >= 8 && averageWordsPerSentence <= 25) {\n            score += 25; // Good sentence length\n        } else if (averageWordsPerSentence >= 5) {\n            score += 15; // Acceptable sentence length\n        }\n        // Vocabulary variety factor (0-25 points)\n        if (hasVariedVocabulary) {\n            score += 25;\n        } else if (vocabularyVariety > 0.25) {\n            score += 15;\n        }\n        // Complete thoughts factor (0-20 points)\n        if (hasCompleteThoughts) {\n            score += 20;\n        } else if (completeThoughts / sentenceCount > 0.5) {\n            score += 10;\n        }\n        return {\n            score: Math.round(score),\n            factors: {\n                wordCount,\n                sentenceCount,\n                averageWordsPerSentence: Math.round(averageWordsPerSentence * 10) / 10,\n                hasVariedVocabulary,\n                hasCompleteThoughts\n            }\n        };\n    }\n    /**\r\n   * Sanitizes content by removing excessive whitespace and non-text elements\r\n   */ sanitizeContent(content) {\n        return content.replace(/\\s+/g, \" \") // Replace multiple whitespace with single space\n        .replace(/[^\\w\\s.,!?;:'\"()-]/g, \"\") // Remove special characters except basic punctuation\n        .trim();\n    }\n    /**\r\n   * Counts words in the content\r\n   */ getWordCount(content) {\n        return this.getWords(content).length;\n    }\n    /**\r\n   * Gets array of words from content\r\n   */ getWords(content) {\n        return content.split(/\\s+/).filter((word)=>word.length > 0 && /\\w/.test(word));\n    }\n    /**\r\n   * Counts sentences in the content\r\n   */ getSentenceCount(content) {\n        return this.getSentences(content).length;\n    }\n    /**\r\n   * Gets array of sentences from content\r\n   */ getSentences(content) {\n        return content.split(/[.!?]+/).map((sentence)=>sentence.trim()).filter((sentence)=>sentence.length > 0);\n    }\n    /**\r\n   * Generates improvement suggestions based on quality score factors\r\n   */ getQualityImprovementSuggestions(qualityScore) {\n        const suggestions = [];\n        if (qualityScore.factors.wordCount < 100) {\n            suggestions.push(\"Select longer content with more detailed information\");\n        }\n        if (qualityScore.factors.averageWordsPerSentence < 8) {\n            suggestions.push(\"Choose content with more complex, complete sentences\");\n        }\n        if (!qualityScore.factors.hasVariedVocabulary) {\n            suggestions.push(\"Select content with more diverse vocabulary and topics\");\n        }\n        if (!qualityScore.factors.hasCompleteThoughts) {\n            suggestions.push(\"Choose well-structured text with proper punctuation\");\n        }\n        if (suggestions.length === 0) {\n            suggestions.push(\"Try selecting different content that is more suitable for language learning\");\n        }\n        return suggestions;\n    }\n    constructor(){\n        this.MINIMUM_WORD_COUNT = 50;\n        this.MINIMUM_SENTENCE_COUNT = 3;\n        this.MINIMUM_QUALITY_SCORE = 60;\n    }\n}\n// Export singleton instance\nconst contentValidator = new ContentValidatorImpl();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvY29udGVudC12YWxpZGF0b3IudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTs7Ozs7Q0FLQyxHQXlCTSxNQUFNQTtJQUtYOztHQUVDLEdBQ0RDLGdCQUFnQkMsT0FBZSxFQUFvQjtRQUNqRCxxQ0FBcUM7UUFDckMsTUFBTUMsZUFBZSxJQUFJLENBQUNDLGVBQWUsQ0FBQ0Y7UUFFMUMsSUFBSSxDQUFDQyxnQkFBZ0JBLGFBQWFFLElBQUksR0FBR0MsTUFBTSxLQUFLLEdBQUc7WUFDckQsT0FBTztnQkFDTEMsU0FBUztnQkFDVEMsUUFBUTtnQkFDUkMsYUFBYTtvQkFBQztpQkFBcUU7WUFDckY7UUFDRjtRQUVBLDJCQUEyQjtRQUMzQixNQUFNQyxZQUFZLElBQUksQ0FBQ0MsWUFBWSxDQUFDUjtRQUNwQyxJQUFJTyxZQUFZLElBQUksQ0FBQ0Usa0JBQWtCLEVBQUU7WUFDdkMsT0FBTztnQkFDTEwsU0FBUztnQkFDVEMsUUFBUSxDQUFDLG1CQUFtQixFQUFFRSxVQUFVLGdCQUFnQixFQUFFLElBQUksQ0FBQ0Usa0JBQWtCLENBQUMsVUFBVSxDQUFDO2dCQUM3RkgsYUFBYTtvQkFDWDtvQkFDQTtvQkFDQTtpQkFDRDtZQUNIO1FBQ0Y7UUFFQSx1QkFBdUI7UUFDdkIsTUFBTUksZ0JBQWdCLElBQUksQ0FBQ0MsZ0JBQWdCLENBQUNYO1FBQzVDLElBQUlVLGdCQUFnQixJQUFJLENBQUNFLHNCQUFzQixFQUFFO1lBQy9DLE9BQU87Z0JBQ0xSLFNBQVM7Z0JBQ1RDLFFBQVEsQ0FBQyx5QkFBeUIsRUFBRUssY0FBYyxvQkFBb0IsRUFBRSxJQUFJLENBQUNFLHNCQUFzQixDQUFDLFVBQVUsQ0FBQztnQkFDL0dOLGFBQWE7b0JBQ1g7b0JBQ0E7b0JBQ0E7aUJBQ0Q7WUFDSDtRQUNGO1FBRUEsd0JBQXdCO1FBQ3hCLE1BQU1PLGVBQWUsSUFBSSxDQUFDQyxtQkFBbUIsQ0FBQ2Q7UUFDOUMsSUFBSWEsYUFBYUUsS0FBSyxHQUFHLElBQUksQ0FBQ0MscUJBQXFCLEVBQUU7WUFDbkQsT0FBTztnQkFDTFosU0FBUztnQkFDVEMsUUFBUSxDQUFDLDJEQUEyRCxFQUFFUSxhQUFhRSxLQUFLLENBQUMsS0FBSyxDQUFDO2dCQUMvRlQsYUFBYSxJQUFJLENBQUNXLGdDQUFnQyxDQUFDSjtZQUNyRDtRQUNGO1FBRUEsT0FBTztZQUNMVCxTQUFTO1FBQ1g7SUFDRjtJQUVBOztHQUVDLEdBQ0RjLHNCQUE4QjtRQUM1QixPQUFPLElBQUksQ0FBQ1Qsa0JBQWtCO0lBQ2hDO0lBRUE7O0dBRUMsR0FDREssb0JBQW9CZixPQUFlLEVBQWdCO1FBQ2pELE1BQU1DLGVBQWUsSUFBSSxDQUFDQyxlQUFlLENBQUNGO1FBQzFDLE1BQU1vQixRQUFRLElBQUksQ0FBQ0MsUUFBUSxDQUFDcEI7UUFDNUIsTUFBTXFCLFlBQVksSUFBSSxDQUFDQyxZQUFZLENBQUN0QjtRQUVwQyxNQUFNTyxZQUFZWSxNQUFNaEIsTUFBTTtRQUM5QixNQUFNTyxnQkFBZ0JXLFVBQVVsQixNQUFNO1FBQ3RDLE1BQU1vQiwwQkFBMEJiLGdCQUFnQixJQUFJSCxZQUFZRyxnQkFBZ0I7UUFFaEYseURBQXlEO1FBQ3pELE1BQU1jLGNBQWMsSUFBSUMsSUFBSU4sTUFBTU8sR0FBRyxDQUFDQyxDQUFBQSxPQUFRQSxLQUFLQyxXQUFXO1FBQzlELE1BQU1DLG9CQUFvQkwsWUFBWU0sSUFBSSxHQUFHdkI7UUFDN0MsTUFBTXdCLHNCQUFzQkYsb0JBQW9CLEtBQUssNEJBQTRCO1FBRWpGLHlFQUF5RTtRQUN6RSxNQUFNRyxtQkFBbUJYLFVBQVVZLE1BQU0sQ0FBQ0MsQ0FBQUEsV0FDeEMsU0FBU0MsSUFBSSxDQUFDRCxTQUFTaEMsSUFBSSxLQUMzQkMsTUFBTTtRQUNSLE1BQU1pQyxzQkFBc0IsbUJBQW9CMUIsZ0JBQWlCLEtBQUsseUJBQXlCO1FBRS9GLGtDQUFrQztRQUNsQyxJQUFJSyxRQUFRO1FBRVosa0NBQWtDO1FBQ2xDLElBQUlSLGFBQWEsSUFBSSxDQUFDRSxrQkFBa0IsRUFBRTtZQUN4Q00sU0FBU3NCLEtBQUtDLEdBQUcsQ0FBQyxJQUFJLFlBQWEsTUFBTyxLQUFLLDBCQUEwQjtRQUMzRTtRQUVBLDBDQUEwQztRQUMxQyxJQUFJZiwyQkFBMkIsS0FBS0EsMkJBQTJCLElBQUk7WUFDakVSLFNBQVMsSUFBSSx1QkFBdUI7UUFDdEMsT0FBTyxJQUFJUSwyQkFBMkIsR0FBRztZQUN2Q1IsU0FBUyxJQUFJLDZCQUE2QjtRQUM1QztRQUVBLDBDQUEwQztRQUMxQyxJQUFJZ0IscUJBQXFCO1lBQ3ZCaEIsU0FBUztRQUNYLE9BQU8sSUFBSWMsb0JBQW9CLE1BQU07WUFDbkNkLFNBQVM7UUFDWDtRQUVBLHlDQUF5QztRQUN6QyxJQUFJcUIscUJBQXFCO1lBQ3ZCckIsU0FBUztRQUNYLE9BQU8sSUFBSSxtQkFBb0JMLGdCQUFpQixLQUFLO1lBQ25ESyxTQUFTO1FBQ1g7UUFFQSxPQUFPO1lBQ0xBLE9BQU9zQixLQUFLRSxLQUFLLENBQUN4QjtZQUNsQnlCLFNBQVM7Z0JBQ1BqQztnQkFDQUc7Z0JBQ0FhLHlCQUF5QmMsS0FBS0UsS0FBSyxDQUFDaEIsMEJBQTBCLE1BQU07Z0JBQ3BFUTtnQkFDQUs7WUFDRjtRQUNGO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELGdCQUF3QnJDLE9BQWUsRUFBVTtRQUMvQyxPQUFPQSxRQUNKMEMsT0FBTyxDQUFDLFFBQVEsS0FBSyxnREFBZ0Q7U0FDckVBLE9BQU8sQ0FBQyx1QkFBdUIsSUFBSSxxREFBcUQ7U0FDeEZ2QyxJQUFJO0lBQ1Q7SUFFQTs7R0FFQyxHQUNELGFBQXFCSCxPQUFlLEVBQVU7UUFDNUMsT0FBTyxJQUFJLENBQUNxQixRQUFRLENBQUNyQixTQUFTSSxNQUFNO0lBQ3RDO0lBRUE7O0dBRUMsR0FDRCxTQUFpQkosT0FBZSxFQUFZO1FBQzFDLE9BQU9BLFFBQ0oyQyxLQUFLLENBQUMsT0FDTlQsTUFBTSxDQUFDTixDQUFBQSxPQUFRQSxLQUFLeEIsTUFBTSxHQUFHLEtBQUssS0FBS2dDLElBQUksQ0FBQ1I7SUFDakQ7SUFFQTs7R0FFQyxHQUNELGlCQUF5QjVCLE9BQWUsRUFBVTtRQUNoRCxPQUFPLElBQUksQ0FBQ3VCLFlBQVksQ0FBQ3ZCLFNBQVNJLE1BQU07SUFDMUM7SUFFQTs7R0FFQyxHQUNELGFBQXFCSixPQUFlLEVBQVk7UUFDOUMsT0FBT0EsUUFDSjJDLEtBQUssQ0FBQyxVQUNOaEIsR0FBRyxDQUFDUSxDQUFBQSxXQUFZQSxTQUFTaEMsSUFBSSxJQUM3QitCLE1BQU0sQ0FBQ0MsQ0FBQUEsV0FBWUEsU0FBUy9CLE1BQU0sR0FBRztJQUMxQztJQUVBOztHQUVDLEdBQ0QsaUNBQXlDVSxZQUEwQixFQUFZO1FBQzdFLE1BQU1QLGNBQXdCLEVBQUU7UUFFaEMsSUFBSU8sYUFBYTJCLE9BQU8sQ0FBQ2pDLFNBQVMsR0FBRyxLQUFLO1lBQ3hDRCxZQUFZcUMsSUFBSSxDQUFDO1FBQ25CO1FBRUEsSUFBSTlCLGFBQWEyQixPQUFPLENBQUNqQix1QkFBdUIsR0FBRyxHQUFHO1lBQ3BEakIsWUFBWXFDLElBQUksQ0FBQztRQUNuQjtRQUVBLElBQUksQ0FBQzlCLGFBQWEyQixPQUFPLENBQUNULG1CQUFtQixFQUFFO1lBQzdDekIsWUFBWXFDLElBQUksQ0FBQztRQUNuQjtRQUVBLElBQUksQ0FBQzlCLGFBQWEyQixPQUFPLENBQUNKLG1CQUFtQixFQUFFO1lBQzdDOUIsWUFBWXFDLElBQUksQ0FBQztRQUNuQjtRQUVBLElBQUlyQyxZQUFZSCxNQUFNLEtBQUssR0FBRztZQUM1QkcsWUFBWXFDLElBQUksQ0FBQztRQUNuQjtRQUVBLE9BQU9yQztJQUNUOzthQTNNaUJHLHFCQUFxQjthQUNyQkcseUJBQXlCO2FBQ3pCSSx3QkFBd0I7O0FBME0zQztBQUVBLDRCQUE0QjtBQUNyQixNQUFNNEIsbUJBQW1CLElBQUkvQyx1QkFBdUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL2NvbnRlbnQtdmFsaWRhdG9yLnRzP2ZhNTUiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENvbnRlbnQgVmFsaWRhdGlvbiBTZXJ2aWNlXHJcbiAqIFxyXG4gKiBFbnN1cmVzIHNvdXJjZSBjb250ZW50IG1lZXRzIG1pbmltdW0gcmVxdWlyZW1lbnRzIGZvciBBSSBwcm9jZXNzaW5nXHJcbiAqIGJlZm9yZSBhdHRlbXB0aW5nIGxlc3NvbiBnZW5lcmF0aW9uLlxyXG4gKi9cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgaXNWYWxpZDogYm9vbGVhbjtcclxuICByZWFzb24/OiBzdHJpbmc7XHJcbiAgc3VnZ2VzdGlvbnM/OiBzdHJpbmdbXTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBRdWFsaXR5U2NvcmUge1xyXG4gIHNjb3JlOiBudW1iZXI7IC8vIDAtMTAwXHJcbiAgZmFjdG9yczoge1xyXG4gICAgd29yZENvdW50OiBudW1iZXI7XHJcbiAgICBzZW50ZW5jZUNvdW50OiBudW1iZXI7XHJcbiAgICBhdmVyYWdlV29yZHNQZXJTZW50ZW5jZTogbnVtYmVyO1xyXG4gICAgaGFzVmFyaWVkVm9jYWJ1bGFyeTogYm9vbGVhbjtcclxuICAgIGhhc0NvbXBsZXRlVGhvdWdodHM6IGJvb2xlYW47XHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDb250ZW50VmFsaWRhdG9yIHtcclxuICB2YWxpZGF0ZUNvbnRlbnQoY29udGVudDogc3RyaW5nKTogVmFsaWRhdGlvblJlc3VsdDtcclxuICBnZXRNaW5pbXVtV29yZENvdW50KCk6IG51bWJlcjtcclxuICBjaGVja0NvbnRlbnRRdWFsaXR5KGNvbnRlbnQ6IHN0cmluZyk6IFF1YWxpdHlTY29yZTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIENvbnRlbnRWYWxpZGF0b3JJbXBsIGltcGxlbWVudHMgQ29udGVudFZhbGlkYXRvciB7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBNSU5JTVVNX1dPUkRfQ09VTlQgPSA1MDtcclxuICBwcml2YXRlIHJlYWRvbmx5IE1JTklNVU1fU0VOVEVOQ0VfQ09VTlQgPSAzO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgTUlOSU1VTV9RVUFMSVRZX1NDT1JFID0gNjA7XHJcblxyXG4gIC8qKlxyXG4gICAqIFZhbGlkYXRlcyBjb250ZW50IGZvciBBSSBsZXNzb24gZ2VuZXJhdGlvbiBzdWl0YWJpbGl0eVxyXG4gICAqL1xyXG4gIHZhbGlkYXRlQ29udGVudChjb250ZW50OiBzdHJpbmcpOiBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICAgIC8vIEJhc2ljIHNhbml0aXphdGlvbiBhbmQgcHJlcGFyYXRpb25cclxuICAgIGNvbnN0IGNsZWFuQ29udGVudCA9IHRoaXMuc2FuaXRpemVDb250ZW50KGNvbnRlbnQpO1xyXG4gICAgXHJcbiAgICBpZiAoIWNsZWFuQ29udGVudCB8fCBjbGVhbkNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICAgIHJlYXNvbjogXCJObyBjb250ZW50IHByb3ZpZGVkXCIsXHJcbiAgICAgICAgc3VnZ2VzdGlvbnM6IFtcIlBsZWFzZSBzZWxlY3Qgb3IgcGFzdGUgc29tZSB0ZXh0IGNvbnRlbnQgdG8gZ2VuZXJhdGUgYSBsZXNzb24gZnJvbVwiXVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIG1pbmltdW0gd29yZCBjb3VudFxyXG4gICAgY29uc3Qgd29yZENvdW50ID0gdGhpcy5nZXRXb3JkQ291bnQoY2xlYW5Db250ZW50KTtcclxuICAgIGlmICh3b3JkQ291bnQgPCB0aGlzLk1JTklNVU1fV09SRF9DT1VOVCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICAgIHJlYXNvbjogYENvbnRlbnQgdG9vIHNob3J0ICgke3dvcmRDb3VudH0gd29yZHMsIG1pbmltdW0gJHt0aGlzLk1JTklNVU1fV09SRF9DT1VOVH0gcmVxdWlyZWQpYCxcclxuICAgICAgICBzdWdnZXN0aW9uczogW1xyXG4gICAgICAgICAgXCJTZWxlY3QgbW9yZSB0ZXh0IGZyb20gdGhlIHdlYnBhZ2VcIixcclxuICAgICAgICAgIFwiQ2hvb3NlIGEgbG9uZ2VyIGFydGljbGUgb3IgcGFzc2FnZVwiLFxyXG4gICAgICAgICAgXCJDb21iaW5lIG11bHRpcGxlIHBhcmFncmFwaHMgZm9yIGJldHRlciBsZXNzb24gY29udGVudFwiXHJcbiAgICAgICAgXVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIHNlbnRlbmNlIGNvdW50XHJcbiAgICBjb25zdCBzZW50ZW5jZUNvdW50ID0gdGhpcy5nZXRTZW50ZW5jZUNvdW50KGNsZWFuQ29udGVudCk7XHJcbiAgICBpZiAoc2VudGVuY2VDb3VudCA8IHRoaXMuTUlOSU1VTV9TRU5URU5DRV9DT1VOVCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICAgIHJlYXNvbjogYENvbnRlbnQgbGFja3Mgc3RydWN0dXJlICgke3NlbnRlbmNlQ291bnR9IHNlbnRlbmNlcywgbWluaW11bSAke3RoaXMuTUlOSU1VTV9TRU5URU5DRV9DT1VOVH0gcmVxdWlyZWQpYCxcclxuICAgICAgICBzdWdnZXN0aW9uczogW1xyXG4gICAgICAgICAgXCJTZWxlY3QgY29udGVudCB3aXRoIGNvbXBsZXRlIHNlbnRlbmNlc1wiLFxyXG4gICAgICAgICAgXCJDaG9vc2UgdGV4dCB3aXRoIHByb3BlciBwdW5jdHVhdGlvblwiLFxyXG4gICAgICAgICAgXCJBdm9pZCBzZWxlY3Rpbmcgb25seSB0aXRsZXMgb3IgYnVsbGV0IHBvaW50c1wiXHJcbiAgICAgICAgXVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGNvbnRlbnQgcXVhbGl0eVxyXG4gICAgY29uc3QgcXVhbGl0eVNjb3JlID0gdGhpcy5jaGVja0NvbnRlbnRRdWFsaXR5KGNsZWFuQ29udGVudCk7XHJcbiAgICBpZiAocXVhbGl0eVNjb3JlLnNjb3JlIDwgdGhpcy5NSU5JTVVNX1FVQUxJVFlfU0NPUkUpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcclxuICAgICAgICByZWFzb246IGBDb250ZW50IHF1YWxpdHkgaW5zdWZmaWNpZW50IGZvciBsZXNzb24gZ2VuZXJhdGlvbiAoc2NvcmU6ICR7cXVhbGl0eVNjb3JlLnNjb3JlfS8xMDApYCxcclxuICAgICAgICBzdWdnZXN0aW9uczogdGhpcy5nZXRRdWFsaXR5SW1wcm92ZW1lbnRTdWdnZXN0aW9ucyhxdWFsaXR5U2NvcmUpXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXNWYWxpZDogdHJ1ZVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdGhlIG1pbmltdW0gd29yZCBjb3VudCByZXF1aXJlZCBmb3IgY29udGVudCB2YWxpZGF0aW9uXHJcbiAgICovXHJcbiAgZ2V0TWluaW11bVdvcmRDb3VudCgpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuTUlOSU1VTV9XT1JEX0NPVU5UO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQW5hbHl6ZXMgY29udGVudCBxdWFsaXR5IGFuZCByZXR1cm5zIGEgZGV0YWlsZWQgc2NvcmVcclxuICAgKi9cclxuICBjaGVja0NvbnRlbnRRdWFsaXR5KGNvbnRlbnQ6IHN0cmluZyk6IFF1YWxpdHlTY29yZSB7XHJcbiAgICBjb25zdCBjbGVhbkNvbnRlbnQgPSB0aGlzLnNhbml0aXplQ29udGVudChjb250ZW50KTtcclxuICAgIGNvbnN0IHdvcmRzID0gdGhpcy5nZXRXb3JkcyhjbGVhbkNvbnRlbnQpO1xyXG4gICAgY29uc3Qgc2VudGVuY2VzID0gdGhpcy5nZXRTZW50ZW5jZXMoY2xlYW5Db250ZW50KTtcclxuICAgIFxyXG4gICAgY29uc3Qgd29yZENvdW50ID0gd29yZHMubGVuZ3RoO1xyXG4gICAgY29uc3Qgc2VudGVuY2VDb3VudCA9IHNlbnRlbmNlcy5sZW5ndGg7XHJcbiAgICBjb25zdCBhdmVyYWdlV29yZHNQZXJTZW50ZW5jZSA9IHNlbnRlbmNlQ291bnQgPiAwID8gd29yZENvdW50IC8gc2VudGVuY2VDb3VudCA6IDA7XHJcbiAgICBcclxuICAgIC8vIENoZWNrIHZvY2FidWxhcnkgdmFyaWV0eSAodW5pcXVlIHdvcmRzIHZzIHRvdGFsIHdvcmRzKVxyXG4gICAgY29uc3QgdW5pcXVlV29yZHMgPSBuZXcgU2V0KHdvcmRzLm1hcCh3b3JkID0+IHdvcmQudG9Mb3dlckNhc2UoKSkpO1xyXG4gICAgY29uc3Qgdm9jYWJ1bGFyeVZhcmlldHkgPSB1bmlxdWVXb3Jkcy5zaXplIC8gd29yZENvdW50O1xyXG4gICAgY29uc3QgaGFzVmFyaWVkVm9jYWJ1bGFyeSA9IHZvY2FidWxhcnlWYXJpZXR5ID4gMC40OyAvLyBBdCBsZWFzdCA0MCUgdW5pcXVlIHdvcmRzXHJcbiAgICBcclxuICAgIC8vIENoZWNrIGZvciBjb21wbGV0ZSB0aG91Z2h0cyAoc2VudGVuY2VzIGVuZGluZyB3aXRoIHByb3BlciBwdW5jdHVhdGlvbilcclxuICAgIGNvbnN0IGNvbXBsZXRlVGhvdWdodHMgPSBzZW50ZW5jZXMuZmlsdGVyKHNlbnRlbmNlID0+IFxyXG4gICAgICAvWy4hP10kLy50ZXN0KHNlbnRlbmNlLnRyaW0oKSlcclxuICAgICkubGVuZ3RoO1xyXG4gICAgY29uc3QgaGFzQ29tcGxldGVUaG91Z2h0cyA9IChjb21wbGV0ZVRob3VnaHRzIC8gc2VudGVuY2VDb3VudCkgPiAwLjc7IC8vIDcwJSBjb21wbGV0ZSBzZW50ZW5jZXNcclxuICAgIFxyXG4gICAgLy8gQ2FsY3VsYXRlIG92ZXJhbGwgcXVhbGl0eSBzY29yZVxyXG4gICAgbGV0IHNjb3JlID0gMDtcclxuICAgIFxyXG4gICAgLy8gV29yZCBjb3VudCBmYWN0b3IgKDAtMzAgcG9pbnRzKVxyXG4gICAgaWYgKHdvcmRDb3VudCA+PSB0aGlzLk1JTklNVU1fV09SRF9DT1VOVCkge1xyXG4gICAgICBzY29yZSArPSBNYXRoLm1pbigzMCwgKHdvcmRDb3VudCAvIDIwMCkgKiAzMCk7IC8vIE1heCBwb2ludHMgYXQgMjAwIHdvcmRzXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFNlbnRlbmNlIHN0cnVjdHVyZSBmYWN0b3IgKDAtMjUgcG9pbnRzKVxyXG4gICAgaWYgKGF2ZXJhZ2VXb3Jkc1BlclNlbnRlbmNlID49IDggJiYgYXZlcmFnZVdvcmRzUGVyU2VudGVuY2UgPD0gMjUpIHtcclxuICAgICAgc2NvcmUgKz0gMjU7IC8vIEdvb2Qgc2VudGVuY2UgbGVuZ3RoXHJcbiAgICB9IGVsc2UgaWYgKGF2ZXJhZ2VXb3Jkc1BlclNlbnRlbmNlID49IDUpIHtcclxuICAgICAgc2NvcmUgKz0gMTU7IC8vIEFjY2VwdGFibGUgc2VudGVuY2UgbGVuZ3RoXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFZvY2FidWxhcnkgdmFyaWV0eSBmYWN0b3IgKDAtMjUgcG9pbnRzKVxyXG4gICAgaWYgKGhhc1ZhcmllZFZvY2FidWxhcnkpIHtcclxuICAgICAgc2NvcmUgKz0gMjU7XHJcbiAgICB9IGVsc2UgaWYgKHZvY2FidWxhcnlWYXJpZXR5ID4gMC4yNSkge1xyXG4gICAgICBzY29yZSArPSAxNTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQ29tcGxldGUgdGhvdWdodHMgZmFjdG9yICgwLTIwIHBvaW50cylcclxuICAgIGlmIChoYXNDb21wbGV0ZVRob3VnaHRzKSB7XHJcbiAgICAgIHNjb3JlICs9IDIwO1xyXG4gICAgfSBlbHNlIGlmICgoY29tcGxldGVUaG91Z2h0cyAvIHNlbnRlbmNlQ291bnQpID4gMC41KSB7XHJcbiAgICAgIHNjb3JlICs9IDEwO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzY29yZTogTWF0aC5yb3VuZChzY29yZSksXHJcbiAgICAgIGZhY3RvcnM6IHtcclxuICAgICAgICB3b3JkQ291bnQsXHJcbiAgICAgICAgc2VudGVuY2VDb3VudCxcclxuICAgICAgICBhdmVyYWdlV29yZHNQZXJTZW50ZW5jZTogTWF0aC5yb3VuZChhdmVyYWdlV29yZHNQZXJTZW50ZW5jZSAqIDEwKSAvIDEwLFxyXG4gICAgICAgIGhhc1ZhcmllZFZvY2FidWxhcnksXHJcbiAgICAgICAgaGFzQ29tcGxldGVUaG91Z2h0c1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2FuaXRpemVzIGNvbnRlbnQgYnkgcmVtb3ZpbmcgZXhjZXNzaXZlIHdoaXRlc3BhY2UgYW5kIG5vbi10ZXh0IGVsZW1lbnRzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzYW5pdGl6ZUNvbnRlbnQoY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIHJldHVybiBjb250ZW50XHJcbiAgICAgIC5yZXBsYWNlKC9cXHMrL2csICcgJykgLy8gUmVwbGFjZSBtdWx0aXBsZSB3aGl0ZXNwYWNlIHdpdGggc2luZ2xlIHNwYWNlXHJcbiAgICAgIC5yZXBsYWNlKC9bXlxcd1xccy4sIT87OidcIigpLV0vZywgJycpIC8vIFJlbW92ZSBzcGVjaWFsIGNoYXJhY3RlcnMgZXhjZXB0IGJhc2ljIHB1bmN0dWF0aW9uXHJcbiAgICAgIC50cmltKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDb3VudHMgd29yZHMgaW4gdGhlIGNvbnRlbnRcclxuICAgKi9cclxuICBwcml2YXRlIGdldFdvcmRDb3VudChjb250ZW50OiBzdHJpbmcpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0V29yZHMoY29udGVudCkubGVuZ3RoO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0cyBhcnJheSBvZiB3b3JkcyBmcm9tIGNvbnRlbnRcclxuICAgKi9cclxuICBwcml2YXRlIGdldFdvcmRzKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIHJldHVybiBjb250ZW50XHJcbiAgICAgIC5zcGxpdCgvXFxzKy8pXHJcbiAgICAgIC5maWx0ZXIod29yZCA9PiB3b3JkLmxlbmd0aCA+IDAgJiYgL1xcdy8udGVzdCh3b3JkKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDb3VudHMgc2VudGVuY2VzIGluIHRoZSBjb250ZW50XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXRTZW50ZW5jZUNvdW50KGNvbnRlbnQ6IHN0cmluZyk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRTZW50ZW5jZXMoY29udGVudCkubGVuZ3RoO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0cyBhcnJheSBvZiBzZW50ZW5jZXMgZnJvbSBjb250ZW50XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXRTZW50ZW5jZXMoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgcmV0dXJuIGNvbnRlbnRcclxuICAgICAgLnNwbGl0KC9bLiE/XSsvKVxyXG4gICAgICAubWFwKHNlbnRlbmNlID0+IHNlbnRlbmNlLnRyaW0oKSlcclxuICAgICAgLmZpbHRlcihzZW50ZW5jZSA9PiBzZW50ZW5jZS5sZW5ndGggPiAwKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdlbmVyYXRlcyBpbXByb3ZlbWVudCBzdWdnZXN0aW9ucyBiYXNlZCBvbiBxdWFsaXR5IHNjb3JlIGZhY3RvcnNcclxuICAgKi9cclxuICBwcml2YXRlIGdldFF1YWxpdHlJbXByb3ZlbWVudFN1Z2dlc3Rpb25zKHF1YWxpdHlTY29yZTogUXVhbGl0eVNjb3JlKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XHJcbiAgICBcclxuICAgIGlmIChxdWFsaXR5U2NvcmUuZmFjdG9ycy53b3JkQ291bnQgPCAxMDApIHtcclxuICAgICAgc3VnZ2VzdGlvbnMucHVzaChcIlNlbGVjdCBsb25nZXIgY29udGVudCB3aXRoIG1vcmUgZGV0YWlsZWQgaW5mb3JtYXRpb25cIik7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChxdWFsaXR5U2NvcmUuZmFjdG9ycy5hdmVyYWdlV29yZHNQZXJTZW50ZW5jZSA8IDgpIHtcclxuICAgICAgc3VnZ2VzdGlvbnMucHVzaChcIkNob29zZSBjb250ZW50IHdpdGggbW9yZSBjb21wbGV4LCBjb21wbGV0ZSBzZW50ZW5jZXNcIik7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICghcXVhbGl0eVNjb3JlLmZhY3RvcnMuaGFzVmFyaWVkVm9jYWJ1bGFyeSkge1xyXG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKFwiU2VsZWN0IGNvbnRlbnQgd2l0aCBtb3JlIGRpdmVyc2Ugdm9jYWJ1bGFyeSBhbmQgdG9waWNzXCIpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoIXF1YWxpdHlTY29yZS5mYWN0b3JzLmhhc0NvbXBsZXRlVGhvdWdodHMpIHtcclxuICAgICAgc3VnZ2VzdGlvbnMucHVzaChcIkNob29zZSB3ZWxsLXN0cnVjdHVyZWQgdGV4dCB3aXRoIHByb3BlciBwdW5jdHVhdGlvblwiKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKHN1Z2dlc3Rpb25zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKFwiVHJ5IHNlbGVjdGluZyBkaWZmZXJlbnQgY29udGVudCB0aGF0IGlzIG1vcmUgc3VpdGFibGUgZm9yIGxhbmd1YWdlIGxlYXJuaW5nXCIpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXHJcbmV4cG9ydCBjb25zdCBjb250ZW50VmFsaWRhdG9yID0gbmV3IENvbnRlbnRWYWxpZGF0b3JJbXBsKCk7Il0sIm5hbWVzIjpbIkNvbnRlbnRWYWxpZGF0b3JJbXBsIiwidmFsaWRhdGVDb250ZW50IiwiY29udGVudCIsImNsZWFuQ29udGVudCIsInNhbml0aXplQ29udGVudCIsInRyaW0iLCJsZW5ndGgiLCJpc1ZhbGlkIiwicmVhc29uIiwic3VnZ2VzdGlvbnMiLCJ3b3JkQ291bnQiLCJnZXRXb3JkQ291bnQiLCJNSU5JTVVNX1dPUkRfQ09VTlQiLCJzZW50ZW5jZUNvdW50IiwiZ2V0U2VudGVuY2VDb3VudCIsIk1JTklNVU1fU0VOVEVOQ0VfQ09VTlQiLCJxdWFsaXR5U2NvcmUiLCJjaGVja0NvbnRlbnRRdWFsaXR5Iiwic2NvcmUiLCJNSU5JTVVNX1FVQUxJVFlfU0NPUkUiLCJnZXRRdWFsaXR5SW1wcm92ZW1lbnRTdWdnZXN0aW9ucyIsImdldE1pbmltdW1Xb3JkQ291bnQiLCJ3b3JkcyIsImdldFdvcmRzIiwic2VudGVuY2VzIiwiZ2V0U2VudGVuY2VzIiwiYXZlcmFnZVdvcmRzUGVyU2VudGVuY2UiLCJ1bmlxdWVXb3JkcyIsIlNldCIsIm1hcCIsIndvcmQiLCJ0b0xvd2VyQ2FzZSIsInZvY2FidWxhcnlWYXJpZXR5Iiwic2l6ZSIsImhhc1ZhcmllZFZvY2FidWxhcnkiLCJjb21wbGV0ZVRob3VnaHRzIiwiZmlsdGVyIiwic2VudGVuY2UiLCJ0ZXN0IiwiaGFzQ29tcGxldGVUaG91Z2h0cyIsIk1hdGgiLCJtaW4iLCJyb3VuZCIsImZhY3RvcnMiLCJyZXBsYWNlIiwic3BsaXQiLCJwdXNoIiwiY29udGVudFZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/content-validator.ts\n");

/***/ }),

/***/ "(rsc)/./lib/error-classifier.ts":
/*!*********************************!*\
  !*** ./lib/error-classifier.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ErrorClassifier: () => (/* binding */ ErrorClassifier),\n/* harmony export */   errorClassifier: () => (/* binding */ errorClassifier)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n/**\r\n * Error Classification System for AI-Only Lesson Generation\r\n * \r\n * This module provides error classification and message generation\r\n * for AI failures in the lesson generation system.\r\n */ \n/**\r\n * Implementation of the error classification system\r\n */ class ErrorClassifier {\n    /**\r\n   * Classifies an AI error based on error properties and context\r\n   */ classifyError(error, context = {}) {\n        const errorId = this.generateErrorId();\n        const fullContext = {\n            timestamp: new Date(),\n            ...context\n        };\n        const type = this.determineErrorType(error);\n        return {\n            type,\n            originalError: error,\n            context: fullContext,\n            errorId\n        };\n    }\n    /**\r\n   * Generates user-friendly error messages with actionable steps\r\n   */ generateUserMessage(error) {\n        switch(error.type){\n            case \"QUOTA_EXCEEDED\":\n                return {\n                    title: \"API Quota Exceeded\",\n                    message: \"API quota exceeded, please try again later\",\n                    actionableSteps: [\n                        \"Wait a few minutes before trying again\",\n                        \"Try generating a shorter lesson\",\n                        \"Contact support if the issue persists\"\n                    ],\n                    errorId: error.errorId,\n                    supportContact: \"support@linguaspark.com\"\n                };\n            case \"CONTENT_ISSUE\":\n                return {\n                    title: \"Content Processing Error\",\n                    message: \"Unable to process this content, please try different text\",\n                    actionableSteps: [\n                        \"Ensure the content has at least 100 words\",\n                        \"Try selecting different text from the webpage\",\n                        \"Check that the content is in a supported language\",\n                        \"Remove any special characters or formatting\"\n                    ],\n                    errorId: error.errorId\n                };\n            case \"NETWORK_ERROR\":\n                return {\n                    title: \"Connection Error\",\n                    message: \"Connection error, please check your internet and try again\",\n                    actionableSteps: [\n                        \"Check your internet connection\",\n                        \"Try refreshing the page\",\n                        \"Wait a moment and try again\",\n                        \"Contact support if the problem continues\"\n                    ],\n                    errorId: error.errorId\n                };\n            case \"UNKNOWN\":\n            default:\n                return {\n                    title: \"Service Temporarily Unavailable\",\n                    message: \"AI service temporarily unavailable, please try again later\",\n                    actionableSteps: [\n                        \"Wait a few minutes and try again\",\n                        \"Try refreshing the page\",\n                        \"Contact support with the error ID below\"\n                    ],\n                    errorId: error.errorId,\n                    supportContact: \"support@linguaspark.com\"\n                };\n        }\n    }\n    /**\r\n   * Generates detailed support messages for debugging\r\n   */ generateSupportMessage(error) {\n        return {\n            errorId: error.errorId,\n            type: error.type,\n            technicalDetails: this.extractTechnicalDetails(error.originalError),\n            context: error.context,\n            stackTrace: error.originalError.stack,\n            timestamp: error.context.timestamp\n        };\n    }\n    /**\r\n   * Determines error type based on error properties\r\n   */ determineErrorType(error) {\n        // Check for quota/rate limit errors\n        if (this.isQuotaError(error)) {\n            return \"QUOTA_EXCEEDED\";\n        }\n        // Check for network/connection errors\n        if (this.isNetworkError(error)) {\n            return \"NETWORK_ERROR\";\n        }\n        // Check for content-related errors\n        if (this.isContentError(error)) {\n            return \"CONTENT_ISSUE\";\n        }\n        // Default to unknown for unclassified errors\n        return \"UNKNOWN\";\n    }\n    /**\r\n   * Checks if error is related to API quota/rate limits\r\n   */ isQuotaError(error) {\n        const quotaIndicators = [\n            \"quota\",\n            \"rate limit\",\n            \"too many requests\",\n            \"limit exceeded\",\n            \"429\",\n            \"RESOURCE_EXHAUSTED\"\n        ];\n        const errorText = (error.message || \"\").toLowerCase();\n        const errorCode = (error.code || \"\").toLowerCase();\n        const status = error.status;\n        return status === 429 || quotaIndicators.some((indicator)=>errorText.includes(indicator) || errorCode.includes(indicator));\n    }\n    /**\r\n   * Checks if error is network/connection related\r\n   */ isNetworkError(error) {\n        const networkIndicators = [\n            \"network\",\n            \"connection\",\n            \"timeout\",\n            \"fetch\",\n            \"ECONNREFUSED\",\n            \"ENOTFOUND\",\n            \"ETIMEDOUT\"\n        ];\n        const errorText = (error.message || \"\").toLowerCase();\n        const errorCode = (error.code || \"\").toLowerCase();\n        const status = error.status;\n        return status === 0 || status === 502 || status === 503 || status === 504 || networkIndicators.some((indicator)=>errorText.includes(indicator) || errorCode.includes(indicator));\n    }\n    /**\r\n   * Checks if error is content-related\r\n   */ isContentError(error) {\n        const contentIndicators = [\n            \"invalid input\",\n            \"content too short\",\n            \"unsupported format\",\n            \"parsing error\",\n            \"invalid content\",\n            \"content validation\",\n            \"INVALID_ARGUMENT\"\n        ];\n        const errorText = (error.message || \"\").toLowerCase();\n        const errorCode = (error.code || \"\").toLowerCase();\n        const status = error.status;\n        return status === 400 || contentIndicators.some((indicator)=>errorText.includes(indicator) || errorCode.includes(indicator));\n    }\n    /**\r\n   * Extracts technical details from error for support\r\n   */ extractTechnicalDetails(error) {\n        const details = [];\n        if (error.message) {\n            details.push(`Message: ${error.message}`);\n        }\n        if (\"code\" in error && error.code) {\n            details.push(`Code: ${error.code}`);\n        }\n        if (\"status\" in error && error.status) {\n            details.push(`Status: ${error.status}`);\n        }\n        if (\"response\" in error && error.response) {\n            details.push(`Response: ${JSON.stringify(error.response, null, 2)}`);\n        }\n        return details.join(\"\\n\");\n    }\n    /**\r\n   * Generates unique error ID for support tracking\r\n   */ generateErrorId() {\n        const timestamp = Date.now().toString(36);\n        const random = (0,crypto__WEBPACK_IMPORTED_MODULE_0__.randomUUID)().split(\"-\")[0];\n        return `ERR_${timestamp}_${random}`.toUpperCase();\n    }\n}\n// Export singleton instance\nconst errorClassifier = new ErrorClassifier();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVFDLElBQUksQ0FBQyxDQUFDLE1BQU0sRUFBRW5DLE1BQU0yQixJQUFJLENBQUMsQ0FBQztRQUNwQztRQUVBLElBQUksWUFBWTNCLFNBQVNBLE1BQU00QixNQUFNLEVBQUU7WUFDckNNLFFBQVFDLElBQUksQ0FBQyxDQUFDLFFBQVEsRUFBRW5DLE1BQU00QixNQUFNLENBQUMsQ0FBQztRQUN4QztRQUVBLElBQUksY0FBYzVCLFNBQVNBLE1BQU1vQyxRQUFRLEVBQUU7WUFDekNGLFFBQVFDLElBQUksQ0FBQyxDQUFDLFVBQVUsRUFBRUUsS0FBS0MsU0FBUyxDQUFDdEMsTUFBTW9DLFFBQVEsRUFBRSxNQUFNLEdBQUcsQ0FBQztRQUNyRTtRQUVBLE9BQU9GLFFBQVFLLElBQUksQ0FBQztJQUN0QjtJQUVBOztHQUVDLEdBQ0Qsa0JBQWtDO1FBQ2hDLE1BQU1sQyxZQUFZQyxLQUFLa0MsR0FBRyxHQUFHQyxRQUFRLENBQUM7UUFDdEMsTUFBTUMsU0FBUzdDLGtEQUFVQSxHQUFHOEMsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQ3pDLE9BQU8sQ0FBQyxJQUFJLEVBQUV0QyxVQUFVLENBQUMsRUFBRXFDLE9BQU8sQ0FBQyxDQUFDRSxXQUFXO0lBQ2pEO0FBQ0Y7QUFFQSw0QkFBNEI7QUFDckIsTUFBTUMsa0JBQWtCLElBQUkvQyxrQkFBa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL2Vycm9yLWNsYXNzaWZpZXIudHM/Nzg1NSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogRXJyb3IgQ2xhc3NpZmljYXRpb24gU3lzdGVtIGZvciBBSS1Pbmx5IExlc3NvbiBHZW5lcmF0aW9uXHJcbiAqIFxyXG4gKiBUaGlzIG1vZHVsZSBwcm92aWRlcyBlcnJvciBjbGFzc2lmaWNhdGlvbiBhbmQgbWVzc2FnZSBnZW5lcmF0aW9uXHJcbiAqIGZvciBBSSBmYWlsdXJlcyBpbiB0aGUgbGVzc29uIGdlbmVyYXRpb24gc3lzdGVtLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IHJhbmRvbVVVSUQgfSBmcm9tICdjcnlwdG8nO1xyXG5cclxuLy8gRXJyb3IgdHlwZXMgYmFzZWQgb24gcmVxdWlyZW1lbnRzIDMuMS0zLjRcclxuZXhwb3J0IHR5cGUgRXJyb3JUeXBlID0gXHJcbiAgfCAnUVVPVEFfRVhDRUVERUQnIFxyXG4gIHwgJ0NPTlRFTlRfSVNTVUUnIFxyXG4gIHwgJ05FVFdPUktfRVJST1InIFxyXG4gIHwgJ1VOS05PV04nO1xyXG5cclxuLy8gQmFzZSBBSSBlcnJvciBpbnRlcmZhY2VcclxuZXhwb3J0IGludGVyZmFjZSBBSUVycm9yIGV4dGVuZHMgRXJyb3Ige1xyXG4gIGNvZGU/OiBzdHJpbmc7XHJcbiAgc3RhdHVzPzogbnVtYmVyO1xyXG4gIHJlc3BvbnNlPzogYW55O1xyXG59XHJcblxyXG4vLyBFcnJvciBjb250ZXh0IGZvciBkZWJ1Z2dpbmcgYW5kIHN1cHBvcnRcclxuZXhwb3J0IGludGVyZmFjZSBFcnJvckNvbnRleHQge1xyXG4gIHVzZXJJZD86IHN0cmluZztcclxuICBjb250ZW50TGVuZ3RoPzogbnVtYmVyO1xyXG4gIGxlc3NvblR5cGU/OiBzdHJpbmc7XHJcbiAgdGltZXN0YW1wOiBEYXRlO1xyXG4gIHJlcXVlc3RJZD86IHN0cmluZztcclxuICBhcGlFbmRwb2ludD86IHN0cmluZztcclxufVxyXG5cclxuLy8gQ2xhc3NpZmllZCBlcnJvciB3aXRoIGFkZGl0aW9uYWwgbWV0YWRhdGFcclxuZXhwb3J0IGludGVyZmFjZSBDbGFzc2lmaWVkRXJyb3Ige1xyXG4gIHR5cGU6IEVycm9yVHlwZTtcclxuICBvcmlnaW5hbEVycm9yOiBFcnJvcjtcclxuICBjb250ZXh0OiBFcnJvckNvbnRleHQ7XHJcbiAgZXJyb3JJZDogc3RyaW5nO1xyXG59XHJcblxyXG4vLyBVc2VyLWZhY2luZyBlcnJvciBtZXNzYWdlXHJcbmV4cG9ydCBpbnRlcmZhY2UgVXNlckVycm9yTWVzc2FnZSB7XHJcbiAgdGl0bGU6IHN0cmluZztcclxuICBtZXNzYWdlOiBzdHJpbmc7XHJcbiAgYWN0aW9uYWJsZVN0ZXBzOiBzdHJpbmdbXTtcclxuICBlcnJvcklkOiBzdHJpbmc7XHJcbiAgc3VwcG9ydENvbnRhY3Q/OiBzdHJpbmc7XHJcbn1cclxuXHJcbi8vIFN1cHBvcnQgZXJyb3IgbWVzc2FnZSB3aXRoIHRlY2huaWNhbCBkZXRhaWxzXHJcbmV4cG9ydCBpbnRlcmZhY2UgU3VwcG9ydEVycm9yTWVzc2FnZSB7XHJcbiAgZXJyb3JJZDogc3RyaW5nO1xyXG4gIHR5cGU6IEVycm9yVHlwZTtcclxuICB0ZWNobmljYWxEZXRhaWxzOiBzdHJpbmc7XHJcbiAgY29udGV4dDogRXJyb3JDb250ZXh0O1xyXG4gIHN0YWNrVHJhY2U/OiBzdHJpbmc7XHJcbiAgdGltZXN0YW1wOiBEYXRlO1xyXG59XHJcblxyXG4vLyBFcnJvciBjbGFzc2lmaWVyIGludGVyZmFjZVxyXG5leHBvcnQgaW50ZXJmYWNlIElFcnJvckNsYXNzaWZpZXIge1xyXG4gIGNsYXNzaWZ5RXJyb3IoZXJyb3I6IEFJRXJyb3IsIGNvbnRleHQ/OiBQYXJ0aWFsPEVycm9yQ29udGV4dD4pOiBDbGFzc2lmaWVkRXJyb3I7XHJcbiAgZ2VuZXJhdGVVc2VyTWVzc2FnZShlcnJvcjogQ2xhc3NpZmllZEVycm9yKTogVXNlckVycm9yTWVzc2FnZTtcclxuICBnZW5lcmF0ZVN1cHBvcnRNZXNzYWdlKGVycm9yOiBDbGFzc2lmaWVkRXJyb3IpOiBTdXBwb3J0RXJyb3JNZXNzYWdlO1xyXG59XHJcblxyXG4vKipcclxuICogSW1wbGVtZW50YXRpb24gb2YgdGhlIGVycm9yIGNsYXNzaWZpY2F0aW9uIHN5c3RlbVxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEVycm9yQ2xhc3NpZmllciBpbXBsZW1lbnRzIElFcnJvckNsYXNzaWZpZXIge1xyXG4gIFxyXG4gIC8qKlxyXG4gICAqIENsYXNzaWZpZXMgYW4gQUkgZXJyb3IgYmFzZWQgb24gZXJyb3IgcHJvcGVydGllcyBhbmQgY29udGV4dFxyXG4gICAqL1xyXG4gIGNsYXNzaWZ5RXJyb3IoZXJyb3I6IEFJRXJyb3IsIGNvbnRleHQ6IFBhcnRpYWw8RXJyb3JDb250ZXh0PiA9IHt9KTogQ2xhc3NpZmllZEVycm9yIHtcclxuICAgIGNvbnN0IGVycm9ySWQgPSB0aGlzLmdlbmVyYXRlRXJyb3JJZCgpO1xyXG4gICAgY29uc3QgZnVsbENvbnRleHQ6IEVycm9yQ29udGV4dCA9IHtcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAuLi5jb250ZXh0XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHR5cGUgPSB0aGlzLmRldGVybWluZUVycm9yVHlwZShlcnJvcik7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdHlwZSxcclxuICAgICAgb3JpZ2luYWxFcnJvcjogZXJyb3IsXHJcbiAgICAgIGNvbnRleHQ6IGZ1bGxDb250ZXh0LFxyXG4gICAgICBlcnJvcklkXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGVzIHVzZXItZnJpZW5kbHkgZXJyb3IgbWVzc2FnZXMgd2l0aCBhY3Rpb25hYmxlIHN0ZXBzXHJcbiAgICovXHJcbiAgZ2VuZXJhdGVVc2VyTWVzc2FnZShlcnJvcjogQ2xhc3NpZmllZEVycm9yKTogVXNlckVycm9yTWVzc2FnZSB7XHJcbiAgICBzd2l0Y2ggKGVycm9yLnR5cGUpIHtcclxuICAgICAgY2FzZSAnUVVPVEFfRVhDRUVERUQnOlxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICB0aXRsZTogJ0FQSSBRdW90YSBFeGNlZWRlZCcsXHJcbiAgICAgICAgICBtZXNzYWdlOiAnQVBJIHF1b3RhIGV4Y2VlZGVkLCBwbGVhc2UgdHJ5IGFnYWluIGxhdGVyJyxcclxuICAgICAgICAgIGFjdGlvbmFibGVTdGVwczogW1xyXG4gICAgICAgICAgICAnV2FpdCBhIGZldyBtaW51dGVzIGJlZm9yZSB0cnlpbmcgYWdhaW4nLFxyXG4gICAgICAgICAgICAnVHJ5IGdlbmVyYXRpbmcgYSBzaG9ydGVyIGxlc3NvbicsXHJcbiAgICAgICAgICAgICdDb250YWN0IHN1cHBvcnQgaWYgdGhlIGlzc3VlIHBlcnNpc3RzJ1xyXG4gICAgICAgICAgXSxcclxuICAgICAgICAgIGVycm9ySWQ6IGVycm9yLmVycm9ySWQsXHJcbiAgICAgICAgICBzdXBwb3J0Q29udGFjdDogJ3N1cHBvcnRAbGluZ3Vhc3BhcmsuY29tJ1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICBjYXNlICdDT05URU5UX0lTU1VFJzpcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgdGl0bGU6ICdDb250ZW50IFByb2Nlc3NpbmcgRXJyb3InLFxyXG4gICAgICAgICAgbWVzc2FnZTogJ1VuYWJsZSB0byBwcm9jZXNzIHRoaXMgY29udGVudCwgcGxlYXNlIHRyeSBkaWZmZXJlbnQgdGV4dCcsXHJcbiAgICAgICAgICBhY3Rpb25hYmxlU3RlcHM6IFtcclxuICAgICAgICAgICAgJ0Vuc3VyZSB0aGUgY29udGVudCBoYXMgYXQgbGVhc3QgMTAwIHdvcmRzJyxcclxuICAgICAgICAgICAgJ1RyeSBzZWxlY3RpbmcgZGlmZmVyZW50IHRleHQgZnJvbSB0aGUgd2VicGFnZScsXHJcbiAgICAgICAgICAgICdDaGVjayB0aGF0IHRoZSBjb250ZW50IGlzIGluIGEgc3VwcG9ydGVkIGxhbmd1YWdlJyxcclxuICAgICAgICAgICAgJ1JlbW92ZSBhbnkgc3BlY2lhbCBjaGFyYWN0ZXJzIG9yIGZvcm1hdHRpbmcnXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgICAgZXJyb3JJZDogZXJyb3IuZXJyb3JJZFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICBjYXNlICdORVRXT1JLX0VSUk9SJzpcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgdGl0bGU6ICdDb25uZWN0aW9uIEVycm9yJyxcclxuICAgICAgICAgIG1lc3NhZ2U6ICdDb25uZWN0aW9uIGVycm9yLCBwbGVhc2UgY2hlY2sgeW91ciBpbnRlcm5ldCBhbmQgdHJ5IGFnYWluJyxcclxuICAgICAgICAgIGFjdGlvbmFibGVTdGVwczogW1xyXG4gICAgICAgICAgICAnQ2hlY2sgeW91ciBpbnRlcm5ldCBjb25uZWN0aW9uJyxcclxuICAgICAgICAgICAgJ1RyeSByZWZyZXNoaW5nIHRoZSBwYWdlJyxcclxuICAgICAgICAgICAgJ1dhaXQgYSBtb21lbnQgYW5kIHRyeSBhZ2FpbicsXHJcbiAgICAgICAgICAgICdDb250YWN0IHN1cHBvcnQgaWYgdGhlIHByb2JsZW0gY29udGludWVzJ1xyXG4gICAgICAgICAgXSxcclxuICAgICAgICAgIGVycm9ySWQ6IGVycm9yLmVycm9ySWRcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgY2FzZSAnVU5LTk9XTic6XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHRpdGxlOiAnU2VydmljZSBUZW1wb3JhcmlseSBVbmF2YWlsYWJsZScsXHJcbiAgICAgICAgICBtZXNzYWdlOiAnQUkgc2VydmljZSB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZSwgcGxlYXNlIHRyeSBhZ2FpbiBsYXRlcicsXHJcbiAgICAgICAgICBhY3Rpb25hYmxlU3RlcHM6IFtcclxuICAgICAgICAgICAgJ1dhaXQgYSBmZXcgbWludXRlcyBhbmQgdHJ5IGFnYWluJyxcclxuICAgICAgICAgICAgJ1RyeSByZWZyZXNoaW5nIHRoZSBwYWdlJyxcclxuICAgICAgICAgICAgJ0NvbnRhY3Qgc3VwcG9ydCB3aXRoIHRoZSBlcnJvciBJRCBiZWxvdydcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICBlcnJvcklkOiBlcnJvci5lcnJvcklkLFxyXG4gICAgICAgICAgc3VwcG9ydENvbnRhY3Q6ICdzdXBwb3J0QGxpbmd1YXNwYXJrLmNvbSdcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGVzIGRldGFpbGVkIHN1cHBvcnQgbWVzc2FnZXMgZm9yIGRlYnVnZ2luZ1xyXG4gICAqL1xyXG4gIGdlbmVyYXRlU3VwcG9ydE1lc3NhZ2UoZXJyb3I6IENsYXNzaWZpZWRFcnJvcik6IFN1cHBvcnRFcnJvck1lc3NhZ2Uge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgZXJyb3JJZDogZXJyb3IuZXJyb3JJZCxcclxuICAgICAgdHlwZTogZXJyb3IudHlwZSxcclxuICAgICAgdGVjaG5pY2FsRGV0YWlsczogdGhpcy5leHRyYWN0VGVjaG5pY2FsRGV0YWlscyhlcnJvci5vcmlnaW5hbEVycm9yKSxcclxuICAgICAgY29udGV4dDogZXJyb3IuY29udGV4dCxcclxuICAgICAgc3RhY2tUcmFjZTogZXJyb3Iub3JpZ2luYWxFcnJvci5zdGFjayxcclxuICAgICAgdGltZXN0YW1wOiBlcnJvci5jb250ZXh0LnRpbWVzdGFtcFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERldGVybWluZXMgZXJyb3IgdHlwZSBiYXNlZCBvbiBlcnJvciBwcm9wZXJ0aWVzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBkZXRlcm1pbmVFcnJvclR5cGUoZXJyb3I6IEFJRXJyb3IpOiBFcnJvclR5cGUge1xyXG4gICAgLy8gQ2hlY2sgZm9yIHF1b3RhL3JhdGUgbGltaXQgZXJyb3JzXHJcbiAgICBpZiAodGhpcy5pc1F1b3RhRXJyb3IoZXJyb3IpKSB7XHJcbiAgICAgIHJldHVybiAnUVVPVEFfRVhDRUVERUQnO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGZvciBuZXR3b3JrL2Nvbm5lY3Rpb24gZXJyb3JzXHJcbiAgICBpZiAodGhpcy5pc05ldHdvcmtFcnJvcihlcnJvcikpIHtcclxuICAgICAgcmV0dXJuICdORVRXT1JLX0VSUk9SJztcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBmb3IgY29udGVudC1yZWxhdGVkIGVycm9yc1xyXG4gICAgaWYgKHRoaXMuaXNDb250ZW50RXJyb3IoZXJyb3IpKSB7XHJcbiAgICAgIHJldHVybiAnQ09OVEVOVF9JU1NVRSc7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRGVmYXVsdCB0byB1bmtub3duIGZvciB1bmNsYXNzaWZpZWQgZXJyb3JzXHJcbiAgICByZXR1cm4gJ1VOS05PV04nO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2tzIGlmIGVycm9yIGlzIHJlbGF0ZWQgdG8gQVBJIHF1b3RhL3JhdGUgbGltaXRzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpc1F1b3RhRXJyb3IoZXJyb3I6IEFJRXJyb3IpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IHF1b3RhSW5kaWNhdG9ycyA9IFtcclxuICAgICAgJ3F1b3RhJyxcclxuICAgICAgJ3JhdGUgbGltaXQnLFxyXG4gICAgICAndG9vIG1hbnkgcmVxdWVzdHMnLFxyXG4gICAgICAnbGltaXQgZXhjZWVkZWQnLFxyXG4gICAgICAnNDI5JyxcclxuICAgICAgJ1JFU09VUkNFX0VYSEFVU1RFRCdcclxuICAgIF07XHJcblxyXG4gICAgY29uc3QgZXJyb3JUZXh0ID0gKGVycm9yLm1lc3NhZ2UgfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBjb25zdCBlcnJvckNvZGUgPSAoZXJyb3IuY29kZSB8fCAnJykudG9Mb3dlckNhc2UoKTtcclxuICAgIGNvbnN0IHN0YXR1cyA9IGVycm9yLnN0YXR1cztcclxuXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICBzdGF0dXMgPT09IDQyOSB8fFxyXG4gICAgICBxdW90YUluZGljYXRvcnMuc29tZShpbmRpY2F0b3IgPT4gXHJcbiAgICAgICAgZXJyb3JUZXh0LmluY2x1ZGVzKGluZGljYXRvcikgfHwgZXJyb3JDb2RlLmluY2x1ZGVzKGluZGljYXRvcilcclxuICAgICAgKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoZWNrcyBpZiBlcnJvciBpcyBuZXR3b3JrL2Nvbm5lY3Rpb24gcmVsYXRlZFxyXG4gICAqL1xyXG4gIHByaXZhdGUgaXNOZXR3b3JrRXJyb3IoZXJyb3I6IEFJRXJyb3IpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IG5ldHdvcmtJbmRpY2F0b3JzID0gW1xyXG4gICAgICAnbmV0d29yaycsXHJcbiAgICAgICdjb25uZWN0aW9uJyxcclxuICAgICAgJ3RpbWVvdXQnLFxyXG4gICAgICAnZmV0Y2gnLFxyXG4gICAgICAnRUNPTk5SRUZVU0VEJyxcclxuICAgICAgJ0VOT1RGT1VORCcsXHJcbiAgICAgICdFVElNRURPVVQnXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IGVycm9yVGV4dCA9IChlcnJvci5tZXNzYWdlIHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgZXJyb3JDb2RlID0gKGVycm9yLmNvZGUgfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBjb25zdCBzdGF0dXMgPSBlcnJvci5zdGF0dXM7XHJcblxyXG4gICAgcmV0dXJuIChcclxuICAgICAgc3RhdHVzID09PSAwIHx8XHJcbiAgICAgIHN0YXR1cyA9PT0gNTAyIHx8XHJcbiAgICAgIHN0YXR1cyA9PT0gNTAzIHx8XHJcbiAgICAgIHN0YXR1cyA9PT0gNTA0IHx8XHJcbiAgICAgIG5ldHdvcmtJbmRpY2F0b3JzLnNvbWUoaW5kaWNhdG9yID0+IFxyXG4gICAgICAgIGVycm9yVGV4dC5pbmNsdWRlcyhpbmRpY2F0b3IpIHx8IGVycm9yQ29kZS5pbmNsdWRlcyhpbmRpY2F0b3IpXHJcbiAgICAgIClcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVja3MgaWYgZXJyb3IgaXMgY29udGVudC1yZWxhdGVkXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpc0NvbnRlbnRFcnJvcihlcnJvcjogQUlFcnJvcik6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgY29udGVudEluZGljYXRvcnMgPSBbXHJcbiAgICAgICdpbnZhbGlkIGlucHV0JyxcclxuICAgICAgJ2NvbnRlbnQgdG9vIHNob3J0JyxcclxuICAgICAgJ3Vuc3VwcG9ydGVkIGZvcm1hdCcsXHJcbiAgICAgICdwYXJzaW5nIGVycm9yJyxcclxuICAgICAgJ2ludmFsaWQgY29udGVudCcsXHJcbiAgICAgICdjb250ZW50IHZhbGlkYXRpb24nLFxyXG4gICAgICAnSU5WQUxJRF9BUkdVTUVOVCdcclxuICAgIF07XHJcblxyXG4gICAgY29uc3QgZXJyb3JUZXh0ID0gKGVycm9yLm1lc3NhZ2UgfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBjb25zdCBlcnJvckNvZGUgPSAoZXJyb3IuY29kZSB8fCAnJykudG9Mb3dlckNhc2UoKTtcclxuICAgIGNvbnN0IHN0YXR1cyA9IGVycm9yLnN0YXR1cztcclxuXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICBzdGF0dXMgPT09IDQwMCB8fFxyXG4gICAgICBjb250ZW50SW5kaWNhdG9ycy5zb21lKGluZGljYXRvciA9PiBcclxuICAgICAgICBlcnJvclRleHQuaW5jbHVkZXMoaW5kaWNhdG9yKSB8fCBlcnJvckNvZGUuaW5jbHVkZXMoaW5kaWNhdG9yKVxyXG4gICAgICApXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRXh0cmFjdHMgdGVjaG5pY2FsIGRldGFpbHMgZnJvbSBlcnJvciBmb3Igc3VwcG9ydFxyXG4gICAqL1xyXG4gIHByaXZhdGUgZXh0cmFjdFRlY2huaWNhbERldGFpbHMoZXJyb3I6IEVycm9yKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGRldGFpbHMgPSBbXTtcclxuICAgIFxyXG4gICAgaWYgKGVycm9yLm1lc3NhZ2UpIHtcclxuICAgICAgZGV0YWlscy5wdXNoKGBNZXNzYWdlOiAke2Vycm9yLm1lc3NhZ2V9YCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICgnY29kZScgaW4gZXJyb3IgJiYgZXJyb3IuY29kZSkge1xyXG4gICAgICBkZXRhaWxzLnB1c2goYENvZGU6ICR7ZXJyb3IuY29kZX1gKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKCdzdGF0dXMnIGluIGVycm9yICYmIGVycm9yLnN0YXR1cykge1xyXG4gICAgICBkZXRhaWxzLnB1c2goYFN0YXR1czogJHtlcnJvci5zdGF0dXN9YCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICgncmVzcG9uc2UnIGluIGVycm9yICYmIGVycm9yLnJlc3BvbnNlKSB7XHJcbiAgICAgIGRldGFpbHMucHVzaChgUmVzcG9uc2U6ICR7SlNPTi5zdHJpbmdpZnkoZXJyb3IucmVzcG9uc2UsIG51bGwsIDIpfWApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBkZXRhaWxzLmpvaW4oJ1xcbicpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGVzIHVuaXF1ZSBlcnJvciBJRCBmb3Igc3VwcG9ydCB0cmFja2luZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2VuZXJhdGVFcnJvcklkKCk6IHN0cmluZyB7XHJcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpLnRvU3RyaW5nKDM2KTtcclxuICAgIGNvbnN0IHJhbmRvbSA9IHJhbmRvbVVVSUQoKS5zcGxpdCgnLScpWzBdO1xyXG4gICAgcmV0dXJuIGBFUlJfJHt0aW1lc3RhbXB9XyR7cmFuZG9tfWAudG9VcHBlckNhc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2VcclxuZXhwb3J0IGNvbnN0IGVycm9yQ2xhc3NpZmllciA9IG5ldyBFcnJvckNsYXNzaWZpZXIoKTsiXSwibmFtZXMiOlsicmFuZG9tVVVJRCIsIkVycm9yQ2xhc3NpZmllciIsImNsYXNzaWZ5RXJyb3IiLCJlcnJvciIsImNvbnRleHQiLCJlcnJvcklkIiwiZ2VuZXJhdGVFcnJvcklkIiwiZnVsbENvbnRleHQiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidHlwZSIsImRldGVybWluZUVycm9yVHlwZSIsIm9yaWdpbmFsRXJyb3IiLCJnZW5lcmF0ZVVzZXJNZXNzYWdlIiwidGl0bGUiLCJtZXNzYWdlIiwiYWN0aW9uYWJsZVN0ZXBzIiwic3VwcG9ydENvbnRhY3QiLCJnZW5lcmF0ZVN1cHBvcnRNZXNzYWdlIiwidGVjaG5pY2FsRGV0YWlscyIsImV4dHJhY3RUZWNobmljYWxEZXRhaWxzIiwic3RhY2tUcmFjZSIsInN0YWNrIiwiaXNRdW90YUVycm9yIiwiaXNOZXR3b3JrRXJyb3IiLCJpc0NvbnRlbnRFcnJvciIsInF1b3RhSW5kaWNhdG9ycyIsImVycm9yVGV4dCIsInRvTG93ZXJDYXNlIiwiZXJyb3JDb2RlIiwiY29kZSIsInN0YXR1cyIsInNvbWUiLCJpbmRpY2F0b3IiLCJpbmNsdWRlcyIsIm5ldHdvcmtJbmRpY2F0b3JzIiwiY29udGVudEluZGljYXRvcnMiLCJkZXRhaWxzIiwicHVzaCIsInJlc3BvbnNlIiwiSlNPTiIsInN0cmluZ2lmeSIsImpvaW4iLCJub3ciLCJ0b1N0cmluZyIsInJhbmRvbSIsInNwbGl0IiwidG9VcHBlckNhc2UiLCJlcnJvckNsYXNzaWZpZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/error-classifier.ts\n");

/***/ }),

/***/ "(rsc)/./lib/google-ai-server.ts":
/*!*********************************!*\
  !*** ./lib/google-ai-server.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createGoogleAIServerService: () => (/* binding */ createGoogleAIServerService)\n/* harmony export */ });\n/* harmony import */ var _error_classifier__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./error-classifier */ \"(rsc)/./lib/error-classifier.ts\");\n/* harmony import */ var _usage_monitor__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./usage-monitor */ \"(rsc)/./lib/usage-monitor.ts\");\n// Server-side Google AI (Gemini) APIs service layer\n\n\nclass GoogleAIServerService {\n    constructor(config){\n        this.model = \"models/gemini-2.5-flash\" // Use actual available model\n        ;\n        this.maxRetries = 3;\n        this.baseRetryDelay = 1000 // 1 second\n        ;\n        this.maxRetryDelay = 30000 // 30 seconds\n        ;\n        this.config = config;\n    }\n    async makeGeminiRequest(prompt, options = {}, metadata) {\n        return this.makeGeminiRequestWithRetry(prompt, options, metadata, 0);\n    }\n    async makeGeminiRequestWithRetry(prompt, options = {}, metadata, retryAttempt = 0) {\n        const startTime = Date.now();\n        const requestId = this.generateRequestId();\n        const requestBody = {\n            contents: [\n                {\n                    parts: [\n                        {\n                            text: prompt\n                        }\n                    ]\n                }\n            ],\n            generationConfig: {\n                temperature: options.temperature || 0.7,\n                maxOutputTokens: options.maxTokens || 2000,\n                topP: options.topP || 0.9\n            }\n        };\n        // Estimate input tokens (rough approximation: 1 token ≈ 4 characters)\n        const estimatedInputTokens = Math.ceil(prompt.length / 4);\n        const url = `${this.config.baseUrl}/v1beta/models/gemini-2.5-flash:generateContent?key=${this.config.apiKey}`;\n        console.log(`🌐 API Request [${requestId}] - Attempt ${retryAttempt + 1}/${this.maxRetries + 1}`);\n        console.log(`📊 Estimated input tokens: ${estimatedInputTokens}`);\n        try {\n            const response = await fetch(url, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(requestBody)\n            });\n            console.log(`📡 Response [${requestId}]: ${response.status} ${response.statusText}`);\n            if (response.ok) {\n                const result = await response.json();\n                const endTime = Date.now();\n                const responseTime = endTime - startTime;\n                console.log(\"✅ Successful API response received\");\n                // Extract token usage information if available\n                const tokenUsage = this.extractTokenUsage(result, estimatedInputTokens);\n                // Log token usage\n                if (metadata?.section && tokenUsage) {\n                    _usage_monitor__WEBPACK_IMPORTED_MODULE_1__.usageMonitor.logTokenUsage(metadata.section, tokenUsage.totalTokens, metadata.optimization || \"none\", metadata.context);\n                }\n                // Parse response content\n                if (result.candidates && result.candidates.length > 0) {\n                    const candidate = result.candidates[0];\n                    // Check if we hit MAX_TOKENS limit\n                    if (candidate.finishReason === \"MAX_TOKENS\") {\n                        console.warn(\"⚠️ Hit MAX_TOKENS limit, response may be incomplete\");\n                        if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {\n                            const text = candidate.content.parts[0].text;\n                            console.log(`⚠️ Extracted partial text (${text.length} chars) due to MAX_TOKENS`);\n                            return text;\n                        } else {\n                            const error = new Error(\"MAX_TOKENS_EXCEEDED\");\n                            error.code = \"MAX_TOKENS\";\n                            throw error;\n                        }\n                    }\n                    // Normal response processing\n                    if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {\n                        const text = candidate.content.parts[0].text;\n                        console.log(`✅ Generated text (${text.length} chars) in ${responseTime}ms`);\n                        return text;\n                    } else {\n                        const error = new Error(\"Invalid content structure in API response\");\n                        error.code = \"INVALID_RESPONSE_STRUCTURE\";\n                        throw error;\n                    }\n                } else {\n                    const error = new Error(\"No candidates in API response\");\n                    error.code = \"NO_CANDIDATES\";\n                    throw error;\n                }\n            } else {\n                // Handle HTTP errors with potential retry\n                const errorText = await response.text();\n                const error = new Error(`Gemini API error: ${response.status} ${response.statusText} - ${errorText}`);\n                error.status = response.status;\n                error.response = errorText;\n                // Check if this is a retryable error\n                if (this.isRetryableError(response.status) && retryAttempt < this.maxRetries) {\n                    const delay = this.calculateRetryDelay(retryAttempt);\n                    console.warn(`⚠️ Retryable error (${response.status}), retrying in ${delay}ms...`);\n                    await this.sleep(delay);\n                    return this.makeGeminiRequestWithRetry(prompt, options, metadata, retryAttempt + 1);\n                }\n                throw error;\n            }\n        } catch (error) {\n            const aiError = error;\n            // Log error with context\n            if (metadata?.context) {\n                const errorContext = {\n                    userId: metadata.context.userId,\n                    contentLength: prompt.length,\n                    lessonType: metadata.context.lessonType,\n                    timestamp: new Date(),\n                    requestId,\n                    apiEndpoint: url\n                };\n                const classifiedError = _error_classifier__WEBPACK_IMPORTED_MODULE_0__.errorClassifier.classifyError(aiError, errorContext);\n                _usage_monitor__WEBPACK_IMPORTED_MODULE_1__.usageMonitor.logError(aiError, classifiedError.type, metadata.context);\n            }\n            // Check if this is a retryable network error\n            if (this.isNetworkError(aiError) && retryAttempt < this.maxRetries) {\n                const delay = this.calculateRetryDelay(retryAttempt);\n                console.warn(`⚠️ Network error, retrying in ${delay}ms...`);\n                await this.sleep(delay);\n                return this.makeGeminiRequestWithRetry(prompt, options, metadata, retryAttempt + 1);\n            }\n            console.error(`❌ API call failed [${requestId}]:`, aiError.message);\n            throw aiError;\n        }\n    }\n    /**\n   * Extract token usage from API response\n   */ extractTokenUsage(result, estimatedInputTokens) {\n        // Try to extract actual token usage from response metadata\n        let inputTokens = estimatedInputTokens;\n        let outputTokens = 0;\n        // Check if response includes usage metadata\n        if (result.usageMetadata) {\n            inputTokens = result.usageMetadata.promptTokenCount || estimatedInputTokens;\n            outputTokens = result.usageMetadata.candidatesTokenCount || 0;\n        } else if (result.candidates && result.candidates[0]?.content?.parts?.[0]?.text) {\n            // Estimate output tokens from response text\n            const responseText = result.candidates[0].content.parts[0].text;\n            outputTokens = Math.ceil(responseText.length / 4);\n        }\n        return {\n            inputTokens,\n            outputTokens,\n            totalTokens: inputTokens + outputTokens\n        };\n    }\n    /**\n   * Check if error is retryable based on status code\n   */ isRetryableError(status) {\n        return [\n            429,\n            500,\n            502,\n            503,\n            504\n        ].includes(status);\n    }\n    /**\n   * Check if error is a network error\n   */ isNetworkError(error) {\n        const networkIndicators = [\n            \"fetch\",\n            \"network\",\n            \"connection\",\n            \"timeout\",\n            \"ECONNREFUSED\",\n            \"ENOTFOUND\",\n            \"ETIMEDOUT\"\n        ];\n        const errorMessage = error.message.toLowerCase();\n        return networkIndicators.some((indicator)=>errorMessage.includes(indicator));\n    }\n    /**\n   * Calculate retry delay with exponential backoff\n   */ calculateRetryDelay(retryAttempt) {\n        const delay = this.baseRetryDelay * Math.pow(2, retryAttempt);\n        const jitter = Math.random() * 0.1 * delay; // Add 10% jitter\n        return Math.min(delay + jitter, this.maxRetryDelay);\n    }\n    /**\n   * Sleep utility for retry delays\n   */ sleep(ms) {\n        return new Promise((resolve)=>setTimeout(resolve, ms));\n    }\n    /**\n   * Generate unique request ID for tracking\n   */ generateRequestId() {\n        return `req_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    }\n    /**\n   * Process batch requests with intelligent batching\n   */ async processBatch(requests) {\n        console.log(`🔄 Processing batch of ${requests.length} requests`);\n        const results = [];\n        const batchSize = 5; // Process in smaller batches to avoid overwhelming the API\n        for(let i = 0; i < requests.length; i += batchSize){\n            const batch = requests.slice(i, i + batchSize);\n            console.log(`📦 Processing batch ${Math.floor(i / batchSize) + 1}/${Math.ceil(requests.length / batchSize)}`);\n            // Process batch requests concurrently\n            const batchPromises = batch.map(async (request)=>{\n                try {\n                    const result = await this.makeGeminiRequest(request.prompt, request.options, request.metadata);\n                    return {\n                        id: request.id,\n                        result\n                    };\n                } catch (error) {\n                    return {\n                        id: request.id,\n                        error: error\n                    };\n                }\n            });\n            const batchResults = await Promise.all(batchPromises);\n            results.push(...batchResults);\n            // Add delay between batches to respect rate limits\n            if (i + batchSize < requests.length) {\n                await this.sleep(500); // 500ms delay between batches\n            }\n        }\n        console.log(`✅ Batch processing complete: ${results.filter((r)=>r.result).length} successful, ${results.filter((r)=>r.error).length} failed`);\n        return results;\n    }\n    async summarize(text, options = {}, metadata) {\n        const summaryType = options.type || \"key-points\";\n        const length = options.length || \"medium\";\n        const lengthInstructions = {\n            short: \"in 2-3 sentences\",\n            medium: \"in 4-6 sentences\",\n            long: \"in 7-10 sentences\"\n        };\n        const typeInstructions = {\n            \"key-points\": \"Extract and summarize the key points\",\n            \"tl-dr\": \"Create a TL;DR summary\",\n            \"teaser\": \"Write an engaging teaser summary\",\n            \"headline\": \"Create a headline-style summary\"\n        };\n        const prompt = `${typeInstructions[summaryType]} of the following text ${lengthInstructions[length]}:\n\n${text}\n\nSummary:`;\n        const requestMetadata = {\n            section: \"summarize\",\n            optimization: \"content_summarization\",\n            ...metadata\n        };\n        try {\n            return await this.makeGeminiRequest(prompt, {\n                temperature: 0.3\n            }, requestMetadata);\n        } catch (error) {\n            console.error(\"Summarization failed:\", error);\n            // Re-throw error instead of fallback to maintain AI-only approach\n            throw error;\n        }\n    }\n    async translate(text, options, metadata) {\n        const targetLang = this.getLanguageName(options.targetLanguage);\n        const prompt = `Translate the following text to ${targetLang}. Maintain the original meaning and tone:\n\n${text}\n\nTranslation:`;\n        const requestMetadata = {\n            section: \"translate\",\n            optimization: \"direct_translation\",\n            ...metadata\n        };\n        try {\n            return await this.makeGeminiRequest(prompt, {\n                temperature: 0.2\n            }, requestMetadata);\n        } catch (error) {\n            console.error(\"Translation failed:\", error);\n            // Re-throw error instead of fallback to maintain AI-only approach\n            throw error;\n        }\n    }\n    async prompt(prompt, options = {}, metadata) {\n        const requestMetadata = {\n            section: \"prompt\",\n            optimization: \"direct_prompt\",\n            ...metadata\n        };\n        try {\n            return await this.makeGeminiRequest(prompt, options, requestMetadata);\n        } catch (error) {\n            console.error(\"Prompt generation failed:\", error);\n            throw error;\n        }\n    }\n    async write(prompt, options = {}, metadata) {\n        const tone = options.tone || \"casual\";\n        const length = options.length || \"medium\";\n        const format = options.format || \"paragraph\";\n        const lengthInstructions = {\n            short: \"Keep it brief and concise\",\n            medium: \"Write a moderate length response\",\n            long: \"Provide a detailed and comprehensive response\"\n        };\n        const formatInstructions = {\n            paragraph: \"Write in paragraph form\",\n            \"bullet-points\": \"Format as bullet points\",\n            \"numbered-list\": \"Format as a numbered list\"\n        };\n        const enhancedPrompt = `${prompt}\n\nInstructions:\n- Tone: ${tone}\n- ${lengthInstructions[length]}\n- ${formatInstructions[format]}\n\nResponse:`;\n        const requestMetadata = {\n            section: \"write\",\n            optimization: \"structured_writing\",\n            ...metadata\n        };\n        try {\n            return await this.makeGeminiRequest(enhancedPrompt, {\n                temperature: 0.7\n            }, requestMetadata);\n        } catch (error) {\n            console.error(\"Writing failed:\", error);\n            throw error;\n        }\n    }\n    async rewrite(text, options = {}, metadata) {\n        const tone = options.tone || \"casual\";\n        const length = options.length || \"same\";\n        const audience = options.audience || \"general\";\n        const lengthInstructions = {\n            shorter: \"Make it more concise\",\n            longer: \"Expand and add more detail\",\n            same: \"Keep approximately the same length\"\n        };\n        const prompt = `Rewrite the following text with these requirements:\n- Tone: ${tone}\n- Audience: ${audience}\n- Length: ${lengthInstructions[length]}\n\nOriginal text:\n${text}\n\nRewritten text:`;\n        const requestMetadata = {\n            section: \"rewrite\",\n            optimization: \"content_rewriting\",\n            ...metadata\n        };\n        try {\n            return await this.makeGeminiRequest(prompt, {\n                temperature: 0.5\n            }, requestMetadata);\n        } catch (error) {\n            console.error(\"Rewriting failed:\", error);\n            // Re-throw error instead of fallback to maintain AI-only approach\n            throw error;\n        }\n    }\n    async proofread(text, options = {}, metadata) {\n        const checkGrammar = options.checkGrammar !== false;\n        const checkSpelling = options.checkSpelling !== false;\n        const checkStyle = options.checkStyle !== false;\n        const checks = [];\n        if (checkGrammar) checks.push(\"grammar\");\n        if (checkSpelling) checks.push(\"spelling\");\n        if (checkStyle) checks.push(\"style and clarity\");\n        const prompt = `Proofread and correct the following text for ${checks.join(\", \")}. Return only the corrected text:\n\n${text}\n\nCorrected text:`;\n        const requestMetadata = {\n            section: \"proofread\",\n            optimization: \"text_correction\",\n            ...metadata\n        };\n        try {\n            const correctedText = await this.makeGeminiRequest(prompt, {\n                temperature: 0.2\n            }, requestMetadata);\n            return {\n                corrected_text: correctedText,\n                suggestions: [],\n                errors: []\n            };\n        } catch (error) {\n            console.error(\"Proofreading failed:\", error);\n            // Re-throw error instead of fallback to maintain AI-only approach\n            throw error;\n        }\n    }\n    getLanguageName(code) {\n        const languageMap = {\n            es: \"Spanish\",\n            fr: \"French\",\n            de: \"German\",\n            it: \"Italian\",\n            pt: \"Portuguese\",\n            ja: \"Japanese\",\n            ko: \"Korean\",\n            zh: \"Chinese\",\n            en: \"English\"\n        };\n        return languageMap[code] || \"English\";\n    }\n}\n// Server-side only initialization\nconst createGoogleAIServerService = ()=>{\n    const apiKey = \"AIzaSyAkDCpwWTPKYftoc1Fdm77P6B00Lj89Lio\";\n    const baseUrl = \"https://generativelanguage.googleapis.com\" || 0;\n    if (!apiKey) {\n        console.warn(\"Google AI API key not found. Lesson generation will use fallback templates.\");\n        // Return a service that will always throw errors, triggering fallbacks\n        return new GoogleAIServerService({\n            apiKey: \"dummy\",\n            baseUrl\n        });\n    }\n    return new GoogleAIServerService({\n        apiKey,\n        baseUrl\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFBSSxDQUFDckksUUFBUTtRQUNYQyxRQUFRMEIsSUFBSSxDQUFDO1FBQ2IsdUVBQXVFO1FBQ3ZFLE9BQU8sSUFBSTVELHNCQUFzQjtZQUFFaUMsUUFBUTtZQUFTRDtRQUFRO0lBQzlEO0lBRUEsT0FBTyxJQUFJaEMsc0JBQXNCO1FBQUVpQztRQUFRRDtJQUFRO0FBQ3JELEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL2dvb2dsZS1haS1zZXJ2ZXIudHM/NTJkNiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTZXJ2ZXItc2lkZSBHb29nbGUgQUkgKEdlbWluaSkgQVBJcyBzZXJ2aWNlIGxheWVyXG5pbXBvcnQgeyBlcnJvckNsYXNzaWZpZXIsIHR5cGUgQUlFcnJvciwgdHlwZSBFcnJvckNvbnRleHQgfSBmcm9tICcuL2Vycm9yLWNsYXNzaWZpZXInO1xuaW1wb3J0IHsgdXNhZ2VNb25pdG9yLCB0eXBlIEdlbmVyYXRpb25Db250ZXh0IH0gZnJvbSAnLi91c2FnZS1tb25pdG9yJztcblxuaW50ZXJmYWNlIEdvb2dsZUFJQ29uZmlnIHtcbiAgYXBpS2V5OiBzdHJpbmdcbiAgYmFzZVVybDogc3RyaW5nXG59XG5cbmludGVyZmFjZSBTdW1tYXJpemVyT3B0aW9ucyB7XG4gIHR5cGU/OiBcImtleS1wb2ludHNcIiB8IFwidGwtZHJcIiB8IFwidGVhc2VyXCIgfCBcImhlYWRsaW5lXCJcbiAgbGVuZ3RoPzogXCJzaG9ydFwiIHwgXCJtZWRpdW1cIiB8IFwibG9uZ1wiXG4gIGZvcm1hdD86IFwibWFya2Rvd25cIiB8IFwicGxhaW4tdGV4dFwiXG59XG5cbmludGVyZmFjZSBUcmFuc2xhdG9yT3B0aW9ucyB7XG4gIHNvdXJjZUxhbmd1YWdlPzogc3RyaW5nXG4gIHRhcmdldExhbmd1YWdlOiBzdHJpbmdcbn1cblxuaW50ZXJmYWNlIFByb21wdE9wdGlvbnMge1xuICB0ZW1wZXJhdHVyZT86IG51bWJlclxuICBtYXhUb2tlbnM/OiBudW1iZXJcbiAgdG9wUD86IG51bWJlclxufVxuXG5pbnRlcmZhY2UgV3JpdGVyT3B0aW9ucyB7XG4gIHRvbmU/OiBcImZvcm1hbFwiIHwgXCJjYXN1YWxcIiB8IFwiYWNhZGVtaWNcIiB8IFwiY3JlYXRpdmVcIlxuICBsZW5ndGg/OiBcInNob3J0XCIgfCBcIm1lZGl1bVwiIHwgXCJsb25nXCJcbiAgZm9ybWF0PzogXCJwYXJhZ3JhcGhcIiB8IFwiYnVsbGV0LXBvaW50c1wiIHwgXCJudW1iZXJlZC1saXN0XCJcbn1cblxuaW50ZXJmYWNlIFJld3JpdGVyT3B0aW9ucyB7XG4gIHRvbmU/OiBcImZvcm1hbFwiIHwgXCJjYXN1YWxcIiB8IFwiYWNhZGVtaWNcIiB8IFwiY3JlYXRpdmVcIlxuICBsZW5ndGg/OiBcInNob3J0ZXJcIiB8IFwibG9uZ2VyXCIgfCBcInNhbWVcIlxuICBhdWRpZW5jZT86IFwiZ2VuZXJhbFwiIHwgXCJleHBlcnRcIiB8IFwiYmVnaW5uZXJcIlxufVxuXG5pbnRlcmZhY2UgUHJvb2ZyZWFkZXJPcHRpb25zIHtcbiAgY2hlY2tHcmFtbWFyPzogYm9vbGVhblxuICBjaGVja1NwZWxsaW5nPzogYm9vbGVhblxuICBjaGVja1N0eWxlPzogYm9vbGVhblxuICBzdWdnZXN0SW1wcm92ZW1lbnRzPzogYm9vbGVhblxufVxuXG4vLyBUb2tlbiB1c2FnZSB0cmFja2luZyBpbnRlcmZhY2VcbmludGVyZmFjZSBUb2tlblVzYWdlIHtcbiAgaW5wdXRUb2tlbnM6IG51bWJlcjtcbiAgb3V0cHV0VG9rZW5zOiBudW1iZXI7XG4gIHRvdGFsVG9rZW5zOiBudW1iZXI7XG59XG5cbi8vIFJlcXVlc3QgbWV0YWRhdGEgZm9yIHRyYWNraW5nIGFuZCBvcHRpbWl6YXRpb25cbmludGVyZmFjZSBSZXF1ZXN0TWV0YWRhdGEge1xuICBzZWN0aW9uPzogc3RyaW5nO1xuICBvcHRpbWl6YXRpb24/OiBzdHJpbmc7XG4gIGNvbnRleHQ/OiBHZW5lcmF0aW9uQ29udGV4dDtcbiAgcmV0cnlBdHRlbXB0PzogbnVtYmVyO1xufVxuXG4vLyBCYXRjaCByZXF1ZXN0IGludGVyZmFjZVxuaW50ZXJmYWNlIEJhdGNoUmVxdWVzdCB7XG4gIGlkOiBzdHJpbmc7XG4gIHByb21wdDogc3RyaW5nO1xuICBvcHRpb25zOiBhbnk7XG4gIG1ldGFkYXRhPzogUmVxdWVzdE1ldGFkYXRhO1xufVxuXG4vLyBCYXRjaCByZXNwb25zZSBpbnRlcmZhY2VcbmludGVyZmFjZSBCYXRjaFJlc3BvbnNlIHtcbiAgaWQ6IHN0cmluZztcbiAgcmVzdWx0Pzogc3RyaW5nO1xuICBlcnJvcj86IEVycm9yO1xuICB0b2tlblVzYWdlPzogVG9rZW5Vc2FnZTtcbn1cblxuY2xhc3MgR29vZ2xlQUlTZXJ2ZXJTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBjb25maWc6IEdvb2dsZUFJQ29uZmlnXG4gIHByaXZhdGUgbW9kZWw6IHN0cmluZyA9IFwibW9kZWxzL2dlbWluaS0yLjUtZmxhc2hcIiAvLyBVc2UgYWN0dWFsIGF2YWlsYWJsZSBtb2RlbFxuICBwcml2YXRlIHJlYWRvbmx5IG1heFJldHJpZXMgPSAzO1xuICBwcml2YXRlIHJlYWRvbmx5IGJhc2VSZXRyeURlbGF5ID0gMTAwMDsgLy8gMSBzZWNvbmRcbiAgcHJpdmF0ZSByZWFkb25seSBtYXhSZXRyeURlbGF5ID0gMzAwMDA7IC8vIDMwIHNlY29uZHNcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IEdvb2dsZUFJQ29uZmlnKSB7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWdcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgbWFrZUdlbWluaVJlcXVlc3QoXG4gICAgcHJvbXB0OiBzdHJpbmcsIFxuICAgIG9wdGlvbnM6IGFueSA9IHt9LCBcbiAgICBtZXRhZGF0YT86IFJlcXVlc3RNZXRhZGF0YVxuICApOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIHJldHVybiB0aGlzLm1ha2VHZW1pbmlSZXF1ZXN0V2l0aFJldHJ5KHByb21wdCwgb3B0aW9ucywgbWV0YWRhdGEsIDApO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBtYWtlR2VtaW5pUmVxdWVzdFdpdGhSZXRyeShcbiAgICBwcm9tcHQ6IHN0cmluZywgXG4gICAgb3B0aW9uczogYW55ID0ge30sIFxuICAgIG1ldGFkYXRhPzogUmVxdWVzdE1ldGFkYXRhLFxuICAgIHJldHJ5QXR0ZW1wdDogbnVtYmVyID0gMFxuICApOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgY29uc3QgcmVxdWVzdElkID0gdGhpcy5nZW5lcmF0ZVJlcXVlc3RJZCgpO1xuICAgIFxuICAgIGNvbnN0IHJlcXVlc3RCb2R5ID0ge1xuICAgICAgY29udGVudHM6IFt7XG4gICAgICAgIHBhcnRzOiBbe1xuICAgICAgICAgIHRleHQ6IHByb21wdFxuICAgICAgICB9XVxuICAgICAgfV0sXG4gICAgICBnZW5lcmF0aW9uQ29uZmlnOiB7XG4gICAgICAgIHRlbXBlcmF0dXJlOiBvcHRpb25zLnRlbXBlcmF0dXJlIHx8IDAuNyxcbiAgICAgICAgbWF4T3V0cHV0VG9rZW5zOiBvcHRpb25zLm1heFRva2VucyB8fCAyMDAwLFxuICAgICAgICB0b3BQOiBvcHRpb25zLnRvcFAgfHwgMC45LFxuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBFc3RpbWF0ZSBpbnB1dCB0b2tlbnMgKHJvdWdoIGFwcHJveGltYXRpb246IDEgdG9rZW4g4omIIDQgY2hhcmFjdGVycylcbiAgICBjb25zdCBlc3RpbWF0ZWRJbnB1dFRva2VucyA9IE1hdGguY2VpbChwcm9tcHQubGVuZ3RoIC8gNCk7XG5cbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmNvbmZpZy5iYXNlVXJsfS92MWJldGEvbW9kZWxzL2dlbWluaS0yLjUtZmxhc2g6Z2VuZXJhdGVDb250ZW50P2tleT0ke3RoaXMuY29uZmlnLmFwaUtleX1gO1xuICAgIGNvbnNvbGUubG9nKGDwn4yQIEFQSSBSZXF1ZXN0IFske3JlcXVlc3RJZH1dIC0gQXR0ZW1wdCAke3JldHJ5QXR0ZW1wdCArIDF9LyR7dGhpcy5tYXhSZXRyaWVzICsgMX1gKTtcbiAgICBjb25zb2xlLmxvZyhg8J+TiiBFc3RpbWF0ZWQgaW5wdXQgdG9rZW5zOiAke2VzdGltYXRlZElucHV0VG9rZW5zfWApO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHJlcXVlc3RCb2R5KSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zb2xlLmxvZyhg8J+ToSBSZXNwb25zZSBbJHtyZXF1ZXN0SWR9XTogJHtyZXNwb25zZS5zdGF0dXN9ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblxuICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgY29uc3QgZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlVGltZSA9IGVuZFRpbWUgLSBzdGFydFRpbWU7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhcIuKchSBTdWNjZXNzZnVsIEFQSSByZXNwb25zZSByZWNlaXZlZFwiKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3QgdG9rZW4gdXNhZ2UgaW5mb3JtYXRpb24gaWYgYXZhaWxhYmxlXG4gICAgICAgIGNvbnN0IHRva2VuVXNhZ2UgPSB0aGlzLmV4dHJhY3RUb2tlblVzYWdlKHJlc3VsdCwgZXN0aW1hdGVkSW5wdXRUb2tlbnMpO1xuICAgICAgICBcbiAgICAgICAgLy8gTG9nIHRva2VuIHVzYWdlXG4gICAgICAgIGlmIChtZXRhZGF0YT8uc2VjdGlvbiAmJiB0b2tlblVzYWdlKSB7XG4gICAgICAgICAgdXNhZ2VNb25pdG9yLmxvZ1Rva2VuVXNhZ2UoXG4gICAgICAgICAgICBtZXRhZGF0YS5zZWN0aW9uLFxuICAgICAgICAgICAgdG9rZW5Vc2FnZS50b3RhbFRva2VucyxcbiAgICAgICAgICAgIG1ldGFkYXRhLm9wdGltaXphdGlvbiB8fCAnbm9uZScsXG4gICAgICAgICAgICBtZXRhZGF0YS5jb250ZXh0XG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFBhcnNlIHJlc3BvbnNlIGNvbnRlbnRcbiAgICAgICAgaWYgKHJlc3VsdC5jYW5kaWRhdGVzICYmIHJlc3VsdC5jYW5kaWRhdGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zdCBjYW5kaWRhdGUgPSByZXN1bHQuY2FuZGlkYXRlc1swXTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBDaGVjayBpZiB3ZSBoaXQgTUFYX1RPS0VOUyBsaW1pdFxuICAgICAgICAgIGlmIChjYW5kaWRhdGUuZmluaXNoUmVhc29uID09PSBcIk1BWF9UT0tFTlNcIikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEhpdCBNQVhfVE9LRU5TIGxpbWl0LCByZXNwb25zZSBtYXkgYmUgaW5jb21wbGV0ZVwiKTtcbiAgICAgICAgICAgIGlmIChjYW5kaWRhdGUuY29udGVudCAmJiBjYW5kaWRhdGUuY29udGVudC5wYXJ0cyAmJiBjYW5kaWRhdGUuY29udGVudC5wYXJ0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHRleHQgPSBjYW5kaWRhdGUuY29udGVudC5wYXJ0c1swXS50ZXh0O1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIEV4dHJhY3RlZCBwYXJ0aWFsIHRleHQgKCR7dGV4dC5sZW5ndGh9IGNoYXJzKSBkdWUgdG8gTUFYX1RPS0VOU2ApO1xuICAgICAgICAgICAgICByZXR1cm4gdGV4dDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiTUFYX1RPS0VOU19FWENFRURFRFwiKSBhcyBBSUVycm9yO1xuICAgICAgICAgICAgICBlcnJvci5jb2RlID0gXCJNQVhfVE9LRU5TXCI7XG4gICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICAvLyBOb3JtYWwgcmVzcG9uc2UgcHJvY2Vzc2luZ1xuICAgICAgICAgIGlmIChjYW5kaWRhdGUuY29udGVudCAmJiBjYW5kaWRhdGUuY29udGVudC5wYXJ0cyAmJiBjYW5kaWRhdGUuY29udGVudC5wYXJ0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gY2FuZGlkYXRlLmNvbnRlbnQucGFydHNbMF0udGV4dDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDinIUgR2VuZXJhdGVkIHRleHQgKCR7dGV4dC5sZW5ndGh9IGNoYXJzKSBpbiAke3Jlc3BvbnNlVGltZX1tc2ApO1xuICAgICAgICAgICAgcmV0dXJuIHRleHQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiSW52YWxpZCBjb250ZW50IHN0cnVjdHVyZSBpbiBBUEkgcmVzcG9uc2VcIikgYXMgQUlFcnJvcjtcbiAgICAgICAgICAgIGVycm9yLmNvZGUgPSBcIklOVkFMSURfUkVTUE9OU0VfU1RSVUNUVVJFXCI7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoXCJObyBjYW5kaWRhdGVzIGluIEFQSSByZXNwb25zZVwiKSBhcyBBSUVycm9yO1xuICAgICAgICAgIGVycm9yLmNvZGUgPSBcIk5PX0NBTkRJREFURVNcIjtcbiAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gSGFuZGxlIEhUVFAgZXJyb3JzIHdpdGggcG90ZW50aWFsIHJldHJ5XG4gICAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoYEdlbWluaSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9IC0gJHtlcnJvclRleHR9YCkgYXMgQUlFcnJvcjtcbiAgICAgICAgZXJyb3Iuc3RhdHVzID0gcmVzcG9uc2Uuc3RhdHVzO1xuICAgICAgICBlcnJvci5yZXNwb25zZSA9IGVycm9yVGV4dDtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGlmIHRoaXMgaXMgYSByZXRyeWFibGUgZXJyb3JcbiAgICAgICAgaWYgKHRoaXMuaXNSZXRyeWFibGVFcnJvcihyZXNwb25zZS5zdGF0dXMpICYmIHJldHJ5QXR0ZW1wdCA8IHRoaXMubWF4UmV0cmllcykge1xuICAgICAgICAgIGNvbnN0IGRlbGF5ID0gdGhpcy5jYWxjdWxhdGVSZXRyeURlbGF5KHJldHJ5QXR0ZW1wdCk7XG4gICAgICAgICAgY29uc29sZS53YXJuKGDimqDvuI8gUmV0cnlhYmxlIGVycm9yICgke3Jlc3BvbnNlLnN0YXR1c30pLCByZXRyeWluZyBpbiAke2RlbGF5fW1zLi4uYCk7XG4gICAgICAgICAgXG4gICAgICAgICAgYXdhaXQgdGhpcy5zbGVlcChkZWxheSk7XG4gICAgICAgICAgcmV0dXJuIHRoaXMubWFrZUdlbWluaVJlcXVlc3RXaXRoUmV0cnkocHJvbXB0LCBvcHRpb25zLCBtZXRhZGF0YSwgcmV0cnlBdHRlbXB0ICsgMSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBhaUVycm9yID0gZXJyb3IgYXMgQUlFcnJvcjtcbiAgICAgIFxuICAgICAgLy8gTG9nIGVycm9yIHdpdGggY29udGV4dFxuICAgICAgaWYgKG1ldGFkYXRhPy5jb250ZXh0KSB7XG4gICAgICAgIGNvbnN0IGVycm9yQ29udGV4dDogRXJyb3JDb250ZXh0ID0ge1xuICAgICAgICAgIHVzZXJJZDogbWV0YWRhdGEuY29udGV4dC51c2VySWQsXG4gICAgICAgICAgY29udGVudExlbmd0aDogcHJvbXB0Lmxlbmd0aCxcbiAgICAgICAgICBsZXNzb25UeXBlOiBtZXRhZGF0YS5jb250ZXh0Lmxlc3NvblR5cGUsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHJlcXVlc3RJZCxcbiAgICAgICAgICBhcGlFbmRwb2ludDogdXJsXG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICBjb25zdCBjbGFzc2lmaWVkRXJyb3IgPSBlcnJvckNsYXNzaWZpZXIuY2xhc3NpZnlFcnJvcihhaUVycm9yLCBlcnJvckNvbnRleHQpO1xuICAgICAgICB1c2FnZU1vbml0b3IubG9nRXJyb3IoYWlFcnJvciwgY2xhc3NpZmllZEVycm9yLnR5cGUsIG1ldGFkYXRhLmNvbnRleHQpO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgcmV0cnlhYmxlIG5ldHdvcmsgZXJyb3JcbiAgICAgIGlmICh0aGlzLmlzTmV0d29ya0Vycm9yKGFpRXJyb3IpICYmIHJldHJ5QXR0ZW1wdCA8IHRoaXMubWF4UmV0cmllcykge1xuICAgICAgICBjb25zdCBkZWxheSA9IHRoaXMuY2FsY3VsYXRlUmV0cnlEZWxheShyZXRyeUF0dGVtcHQpO1xuICAgICAgICBjb25zb2xlLndhcm4oYOKaoO+4jyBOZXR3b3JrIGVycm9yLCByZXRyeWluZyBpbiAke2RlbGF5fW1zLi4uYCk7XG4gICAgICAgIFxuICAgICAgICBhd2FpdCB0aGlzLnNsZWVwKGRlbGF5KTtcbiAgICAgICAgcmV0dXJuIHRoaXMubWFrZUdlbWluaVJlcXVlc3RXaXRoUmV0cnkocHJvbXB0LCBvcHRpb25zLCBtZXRhZGF0YSwgcmV0cnlBdHRlbXB0ICsgMSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBBUEkgY2FsbCBmYWlsZWQgWyR7cmVxdWVzdElkfV06YCwgYWlFcnJvci5tZXNzYWdlKTtcbiAgICAgIHRocm93IGFpRXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhY3QgdG9rZW4gdXNhZ2UgZnJvbSBBUEkgcmVzcG9uc2VcbiAgICovXG4gIHByaXZhdGUgZXh0cmFjdFRva2VuVXNhZ2UocmVzdWx0OiBhbnksIGVzdGltYXRlZElucHV0VG9rZW5zOiBudW1iZXIpOiBUb2tlblVzYWdlIHtcbiAgICAvLyBUcnkgdG8gZXh0cmFjdCBhY3R1YWwgdG9rZW4gdXNhZ2UgZnJvbSByZXNwb25zZSBtZXRhZGF0YVxuICAgIGxldCBpbnB1dFRva2VucyA9IGVzdGltYXRlZElucHV0VG9rZW5zO1xuICAgIGxldCBvdXRwdXRUb2tlbnMgPSAwO1xuICAgIFxuICAgIC8vIENoZWNrIGlmIHJlc3BvbnNlIGluY2x1ZGVzIHVzYWdlIG1ldGFkYXRhXG4gICAgaWYgKHJlc3VsdC51c2FnZU1ldGFkYXRhKSB7XG4gICAgICBpbnB1dFRva2VucyA9IHJlc3VsdC51c2FnZU1ldGFkYXRhLnByb21wdFRva2VuQ291bnQgfHwgZXN0aW1hdGVkSW5wdXRUb2tlbnM7XG4gICAgICBvdXRwdXRUb2tlbnMgPSByZXN1bHQudXNhZ2VNZXRhZGF0YS5jYW5kaWRhdGVzVG9rZW5Db3VudCB8fCAwO1xuICAgIH0gZWxzZSBpZiAocmVzdWx0LmNhbmRpZGF0ZXMgJiYgcmVzdWx0LmNhbmRpZGF0ZXNbMF0/LmNvbnRlbnQ/LnBhcnRzPy5bMF0/LnRleHQpIHtcbiAgICAgIC8vIEVzdGltYXRlIG91dHB1dCB0b2tlbnMgZnJvbSByZXNwb25zZSB0ZXh0XG4gICAgICBjb25zdCByZXNwb25zZVRleHQgPSByZXN1bHQuY2FuZGlkYXRlc1swXS5jb250ZW50LnBhcnRzWzBdLnRleHQ7XG4gICAgICBvdXRwdXRUb2tlbnMgPSBNYXRoLmNlaWwocmVzcG9uc2VUZXh0Lmxlbmd0aCAvIDQpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgaW5wdXRUb2tlbnMsXG4gICAgICBvdXRwdXRUb2tlbnMsXG4gICAgICB0b3RhbFRva2VuczogaW5wdXRUb2tlbnMgKyBvdXRwdXRUb2tlbnNcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGVycm9yIGlzIHJldHJ5YWJsZSBiYXNlZCBvbiBzdGF0dXMgY29kZVxuICAgKi9cbiAgcHJpdmF0ZSBpc1JldHJ5YWJsZUVycm9yKHN0YXR1czogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIFs0MjksIDUwMCwgNTAyLCA1MDMsIDUwNF0uaW5jbHVkZXMoc3RhdHVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBlcnJvciBpcyBhIG5ldHdvcmsgZXJyb3JcbiAgICovXG4gIHByaXZhdGUgaXNOZXR3b3JrRXJyb3IoZXJyb3I6IEFJRXJyb3IpOiBib29sZWFuIHtcbiAgICBjb25zdCBuZXR3b3JrSW5kaWNhdG9ycyA9IFsnZmV0Y2gnLCAnbmV0d29yaycsICdjb25uZWN0aW9uJywgJ3RpbWVvdXQnLCAnRUNPTk5SRUZVU0VEJywgJ0VOT1RGT1VORCcsICdFVElNRURPVVQnXTtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlLnRvTG93ZXJDYXNlKCk7XG4gICAgcmV0dXJuIG5ldHdvcmtJbmRpY2F0b3JzLnNvbWUoaW5kaWNhdG9yID0+IGVycm9yTWVzc2FnZS5pbmNsdWRlcyhpbmRpY2F0b3IpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgcmV0cnkgZGVsYXkgd2l0aCBleHBvbmVudGlhbCBiYWNrb2ZmXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZVJldHJ5RGVsYXkocmV0cnlBdHRlbXB0OiBudW1iZXIpOiBudW1iZXIge1xuICAgIGNvbnN0IGRlbGF5ID0gdGhpcy5iYXNlUmV0cnlEZWxheSAqIE1hdGgucG93KDIsIHJldHJ5QXR0ZW1wdCk7XG4gICAgY29uc3Qgaml0dGVyID0gTWF0aC5yYW5kb20oKSAqIDAuMSAqIGRlbGF5OyAvLyBBZGQgMTAlIGppdHRlclxuICAgIHJldHVybiBNYXRoLm1pbihkZWxheSArIGppdHRlciwgdGhpcy5tYXhSZXRyeURlbGF5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTbGVlcCB1dGlsaXR5IGZvciByZXRyeSBkZWxheXNcbiAgICovXG4gIHByaXZhdGUgc2xlZXAobXM6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSB1bmlxdWUgcmVxdWVzdCBJRCBmb3IgdHJhY2tpbmdcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVSZXF1ZXN0SWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYHJlcV8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG4gIH1cblxuICAvKipcbiAgICogUHJvY2VzcyBiYXRjaCByZXF1ZXN0cyB3aXRoIGludGVsbGlnZW50IGJhdGNoaW5nXG4gICAqL1xuICBhc3luYyBwcm9jZXNzQmF0Y2gocmVxdWVzdHM6IEJhdGNoUmVxdWVzdFtdKTogUHJvbWlzZTxCYXRjaFJlc3BvbnNlW10+IHtcbiAgICBjb25zb2xlLmxvZyhg8J+UhCBQcm9jZXNzaW5nIGJhdGNoIG9mICR7cmVxdWVzdHMubGVuZ3RofSByZXF1ZXN0c2ApO1xuICAgIFxuICAgIGNvbnN0IHJlc3VsdHM6IEJhdGNoUmVzcG9uc2VbXSA9IFtdO1xuICAgIGNvbnN0IGJhdGNoU2l6ZSA9IDU7IC8vIFByb2Nlc3MgaW4gc21hbGxlciBiYXRjaGVzIHRvIGF2b2lkIG92ZXJ3aGVsbWluZyB0aGUgQVBJXG4gICAgXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXF1ZXN0cy5sZW5ndGg7IGkgKz0gYmF0Y2hTaXplKSB7XG4gICAgICBjb25zdCBiYXRjaCA9IHJlcXVlc3RzLnNsaWNlKGksIGkgKyBiYXRjaFNpemUpO1xuICAgICAgY29uc29sZS5sb2coYPCfk6YgUHJvY2Vzc2luZyBiYXRjaCAke01hdGguZmxvb3IoaSAvIGJhdGNoU2l6ZSkgKyAxfS8ke01hdGguY2VpbChyZXF1ZXN0cy5sZW5ndGggLyBiYXRjaFNpemUpfWApO1xuICAgICAgXG4gICAgICAvLyBQcm9jZXNzIGJhdGNoIHJlcXVlc3RzIGNvbmN1cnJlbnRseVxuICAgICAgY29uc3QgYmF0Y2hQcm9taXNlcyA9IGJhdGNoLm1hcChhc3luYyAocmVxdWVzdCk6IFByb21pc2U8QmF0Y2hSZXNwb25zZT4gPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMubWFrZUdlbWluaVJlcXVlc3QoXG4gICAgICAgICAgICByZXF1ZXN0LnByb21wdCwgXG4gICAgICAgICAgICByZXF1ZXN0Lm9wdGlvbnMsIFxuICAgICAgICAgICAgcmVxdWVzdC5tZXRhZGF0YVxuICAgICAgICAgICk7XG4gICAgICAgICAgXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiByZXF1ZXN0LmlkLFxuICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IHJlcXVlc3QuaWQsXG4gICAgICAgICAgICBlcnJvcjogZXJyb3IgYXMgRXJyb3JcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgYmF0Y2hSZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwoYmF0Y2hQcm9taXNlcyk7XG4gICAgICByZXN1bHRzLnB1c2goLi4uYmF0Y2hSZXN1bHRzKTtcbiAgICAgIFxuICAgICAgLy8gQWRkIGRlbGF5IGJldHdlZW4gYmF0Y2hlcyB0byByZXNwZWN0IHJhdGUgbGltaXRzXG4gICAgICBpZiAoaSArIGJhdGNoU2l6ZSA8IHJlcXVlc3RzLmxlbmd0aCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNsZWVwKDUwMCk7IC8vIDUwMG1zIGRlbGF5IGJldHdlZW4gYmF0Y2hlc1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmxvZyhg4pyFIEJhdGNoIHByb2Nlc3NpbmcgY29tcGxldGU6ICR7cmVzdWx0cy5maWx0ZXIociA9PiByLnJlc3VsdCkubGVuZ3RofSBzdWNjZXNzZnVsLCAke3Jlc3VsdHMuZmlsdGVyKHIgPT4gci5lcnJvcikubGVuZ3RofSBmYWlsZWRgKTtcbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfVxuXG4gIGFzeW5jIHN1bW1hcml6ZSh0ZXh0OiBzdHJpbmcsIG9wdGlvbnM6IFN1bW1hcml6ZXJPcHRpb25zID0ge30sIG1ldGFkYXRhPzogUmVxdWVzdE1ldGFkYXRhKSB7XG4gICAgY29uc3Qgc3VtbWFyeVR5cGUgPSBvcHRpb25zLnR5cGUgfHwgXCJrZXktcG9pbnRzXCJcbiAgICBjb25zdCBsZW5ndGggPSBvcHRpb25zLmxlbmd0aCB8fCBcIm1lZGl1bVwiXG4gICAgXG4gICAgY29uc3QgbGVuZ3RoSW5zdHJ1Y3Rpb25zID0ge1xuICAgICAgc2hvcnQ6IFwiaW4gMi0zIHNlbnRlbmNlc1wiLFxuICAgICAgbWVkaXVtOiBcImluIDQtNiBzZW50ZW5jZXNcIiwgXG4gICAgICBsb25nOiBcImluIDctMTAgc2VudGVuY2VzXCJcbiAgICB9XG5cbiAgICBjb25zdCB0eXBlSW5zdHJ1Y3Rpb25zID0ge1xuICAgICAgXCJrZXktcG9pbnRzXCI6IFwiRXh0cmFjdCBhbmQgc3VtbWFyaXplIHRoZSBrZXkgcG9pbnRzXCIsXG4gICAgICBcInRsLWRyXCI6IFwiQ3JlYXRlIGEgVEw7RFIgc3VtbWFyeVwiLFxuICAgICAgXCJ0ZWFzZXJcIjogXCJXcml0ZSBhbiBlbmdhZ2luZyB0ZWFzZXIgc3VtbWFyeVwiLFxuICAgICAgXCJoZWFkbGluZVwiOiBcIkNyZWF0ZSBhIGhlYWRsaW5lLXN0eWxlIHN1bW1hcnlcIlxuICAgIH1cblxuICAgIGNvbnN0IHByb21wdCA9IGAke3R5cGVJbnN0cnVjdGlvbnNbc3VtbWFyeVR5cGVdfSBvZiB0aGUgZm9sbG93aW5nIHRleHQgJHtsZW5ndGhJbnN0cnVjdGlvbnNbbGVuZ3RoXX06XG5cbiR7dGV4dH1cblxuU3VtbWFyeTpgXG5cbiAgICBjb25zdCByZXF1ZXN0TWV0YWRhdGE6IFJlcXVlc3RNZXRhZGF0YSA9IHtcbiAgICAgIHNlY3Rpb246ICdzdW1tYXJpemUnLFxuICAgICAgb3B0aW1pemF0aW9uOiAnY29udGVudF9zdW1tYXJpemF0aW9uJyxcbiAgICAgIC4uLm1ldGFkYXRhXG4gICAgfTtcblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYWtlR2VtaW5pUmVxdWVzdChwcm9tcHQsIHsgdGVtcGVyYXR1cmU6IDAuMyB9LCByZXF1ZXN0TWV0YWRhdGEpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJTdW1tYXJpemF0aW9uIGZhaWxlZDpcIiwgZXJyb3IpXG4gICAgICAvLyBSZS10aHJvdyBlcnJvciBpbnN0ZWFkIG9mIGZhbGxiYWNrIHRvIG1haW50YWluIEFJLW9ubHkgYXBwcm9hY2hcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHRyYW5zbGF0ZSh0ZXh0OiBzdHJpbmcsIG9wdGlvbnM6IFRyYW5zbGF0b3JPcHRpb25zLCBtZXRhZGF0YT86IFJlcXVlc3RNZXRhZGF0YSkge1xuICAgIGNvbnN0IHRhcmdldExhbmcgPSB0aGlzLmdldExhbmd1YWdlTmFtZShvcHRpb25zLnRhcmdldExhbmd1YWdlKVxuICAgIFxuICAgIGNvbnN0IHByb21wdCA9IGBUcmFuc2xhdGUgdGhlIGZvbGxvd2luZyB0ZXh0IHRvICR7dGFyZ2V0TGFuZ30uIE1haW50YWluIHRoZSBvcmlnaW5hbCBtZWFuaW5nIGFuZCB0b25lOlxuXG4ke3RleHR9XG5cblRyYW5zbGF0aW9uOmBcblxuICAgIGNvbnN0IHJlcXVlc3RNZXRhZGF0YTogUmVxdWVzdE1ldGFkYXRhID0ge1xuICAgICAgc2VjdGlvbjogJ3RyYW5zbGF0ZScsXG4gICAgICBvcHRpbWl6YXRpb246ICdkaXJlY3RfdHJhbnNsYXRpb24nLFxuICAgICAgLi4ubWV0YWRhdGFcbiAgICB9O1xuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLm1ha2VHZW1pbmlSZXF1ZXN0KHByb21wdCwgeyB0ZW1wZXJhdHVyZTogMC4yIH0sIHJlcXVlc3RNZXRhZGF0YSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIlRyYW5zbGF0aW9uIGZhaWxlZDpcIiwgZXJyb3IpXG4gICAgICAvLyBSZS10aHJvdyBlcnJvciBpbnN0ZWFkIG9mIGZhbGxiYWNrIHRvIG1haW50YWluIEFJLW9ubHkgYXBwcm9hY2hcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHByb21wdChwcm9tcHQ6IHN0cmluZywgb3B0aW9uczogUHJvbXB0T3B0aW9ucyA9IHt9LCBtZXRhZGF0YT86IFJlcXVlc3RNZXRhZGF0YSkge1xuICAgIGNvbnN0IHJlcXVlc3RNZXRhZGF0YTogUmVxdWVzdE1ldGFkYXRhID0ge1xuICAgICAgc2VjdGlvbjogJ3Byb21wdCcsXG4gICAgICBvcHRpbWl6YXRpb246ICdkaXJlY3RfcHJvbXB0JyxcbiAgICAgIC4uLm1ldGFkYXRhXG4gICAgfTtcblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYWtlR2VtaW5pUmVxdWVzdChwcm9tcHQsIG9wdGlvbnMsIHJlcXVlc3RNZXRhZGF0YSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIlByb21wdCBnZW5lcmF0aW9uIGZhaWxlZDpcIiwgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHdyaXRlKHByb21wdDogc3RyaW5nLCBvcHRpb25zOiBXcml0ZXJPcHRpb25zID0ge30sIG1ldGFkYXRhPzogUmVxdWVzdE1ldGFkYXRhKSB7XG4gICAgY29uc3QgdG9uZSA9IG9wdGlvbnMudG9uZSB8fCBcImNhc3VhbFwiXG4gICAgY29uc3QgbGVuZ3RoID0gb3B0aW9ucy5sZW5ndGggfHwgXCJtZWRpdW1cIlxuICAgIGNvbnN0IGZvcm1hdCA9IG9wdGlvbnMuZm9ybWF0IHx8IFwicGFyYWdyYXBoXCJcblxuICAgIGNvbnN0IGxlbmd0aEluc3RydWN0aW9ucyA9IHtcbiAgICAgIHNob3J0OiBcIktlZXAgaXQgYnJpZWYgYW5kIGNvbmNpc2VcIixcbiAgICAgIG1lZGl1bTogXCJXcml0ZSBhIG1vZGVyYXRlIGxlbmd0aCByZXNwb25zZVwiLFxuICAgICAgbG9uZzogXCJQcm92aWRlIGEgZGV0YWlsZWQgYW5kIGNvbXByZWhlbnNpdmUgcmVzcG9uc2VcIlxuICAgIH1cblxuICAgIGNvbnN0IGZvcm1hdEluc3RydWN0aW9ucyA9IHtcbiAgICAgIHBhcmFncmFwaDogXCJXcml0ZSBpbiBwYXJhZ3JhcGggZm9ybVwiLFxuICAgICAgXCJidWxsZXQtcG9pbnRzXCI6IFwiRm9ybWF0IGFzIGJ1bGxldCBwb2ludHNcIixcbiAgICAgIFwibnVtYmVyZWQtbGlzdFwiOiBcIkZvcm1hdCBhcyBhIG51bWJlcmVkIGxpc3RcIlxuICAgIH1cblxuICAgIGNvbnN0IGVuaGFuY2VkUHJvbXB0ID0gYCR7cHJvbXB0fVxuXG5JbnN0cnVjdGlvbnM6XG4tIFRvbmU6ICR7dG9uZX1cbi0gJHtsZW5ndGhJbnN0cnVjdGlvbnNbbGVuZ3RoXX1cbi0gJHtmb3JtYXRJbnN0cnVjdGlvbnNbZm9ybWF0XX1cblxuUmVzcG9uc2U6YFxuXG4gICAgY29uc3QgcmVxdWVzdE1ldGFkYXRhOiBSZXF1ZXN0TWV0YWRhdGEgPSB7XG4gICAgICBzZWN0aW9uOiAnd3JpdGUnLFxuICAgICAgb3B0aW1pemF0aW9uOiAnc3RydWN0dXJlZF93cml0aW5nJyxcbiAgICAgIC4uLm1ldGFkYXRhXG4gICAgfTtcblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYWtlR2VtaW5pUmVxdWVzdChlbmhhbmNlZFByb21wdCwgeyB0ZW1wZXJhdHVyZTogMC43IH0sIHJlcXVlc3RNZXRhZGF0YSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIldyaXRpbmcgZmFpbGVkOlwiLCBlcnJvcilcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmV3cml0ZSh0ZXh0OiBzdHJpbmcsIG9wdGlvbnM6IFJld3JpdGVyT3B0aW9ucyA9IHt9LCBtZXRhZGF0YT86IFJlcXVlc3RNZXRhZGF0YSkge1xuICAgIGNvbnN0IHRvbmUgPSBvcHRpb25zLnRvbmUgfHwgXCJjYXN1YWxcIlxuICAgIGNvbnN0IGxlbmd0aCA9IG9wdGlvbnMubGVuZ3RoIHx8IFwic2FtZVwiXG4gICAgY29uc3QgYXVkaWVuY2UgPSBvcHRpb25zLmF1ZGllbmNlIHx8IFwiZ2VuZXJhbFwiXG5cbiAgICBjb25zdCBsZW5ndGhJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBzaG9ydGVyOiBcIk1ha2UgaXQgbW9yZSBjb25jaXNlXCIsXG4gICAgICBsb25nZXI6IFwiRXhwYW5kIGFuZCBhZGQgbW9yZSBkZXRhaWxcIixcbiAgICAgIHNhbWU6IFwiS2VlcCBhcHByb3hpbWF0ZWx5IHRoZSBzYW1lIGxlbmd0aFwiXG4gICAgfVxuXG4gICAgY29uc3QgcHJvbXB0ID0gYFJld3JpdGUgdGhlIGZvbGxvd2luZyB0ZXh0IHdpdGggdGhlc2UgcmVxdWlyZW1lbnRzOlxuLSBUb25lOiAke3RvbmV9XG4tIEF1ZGllbmNlOiAke2F1ZGllbmNlfVxuLSBMZW5ndGg6ICR7bGVuZ3RoSW5zdHJ1Y3Rpb25zW2xlbmd0aF19XG5cbk9yaWdpbmFsIHRleHQ6XG4ke3RleHR9XG5cblJld3JpdHRlbiB0ZXh0OmBcblxuICAgIGNvbnN0IHJlcXVlc3RNZXRhZGF0YTogUmVxdWVzdE1ldGFkYXRhID0ge1xuICAgICAgc2VjdGlvbjogJ3Jld3JpdGUnLFxuICAgICAgb3B0aW1pemF0aW9uOiAnY29udGVudF9yZXdyaXRpbmcnLFxuICAgICAgLi4ubWV0YWRhdGFcbiAgICB9O1xuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLm1ha2VHZW1pbmlSZXF1ZXN0KHByb21wdCwgeyB0ZW1wZXJhdHVyZTogMC41IH0sIHJlcXVlc3RNZXRhZGF0YSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIlJld3JpdGluZyBmYWlsZWQ6XCIsIGVycm9yKVxuICAgICAgLy8gUmUtdGhyb3cgZXJyb3IgaW5zdGVhZCBvZiBmYWxsYmFjayB0byBtYWludGFpbiBBSS1vbmx5IGFwcHJvYWNoXG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICBhc3luYyBwcm9vZnJlYWQodGV4dDogc3RyaW5nLCBvcHRpb25zOiBQcm9vZnJlYWRlck9wdGlvbnMgPSB7fSwgbWV0YWRhdGE/OiBSZXF1ZXN0TWV0YWRhdGEpIHtcbiAgICBjb25zdCBjaGVja0dyYW1tYXIgPSBvcHRpb25zLmNoZWNrR3JhbW1hciAhPT0gZmFsc2VcbiAgICBjb25zdCBjaGVja1NwZWxsaW5nID0gb3B0aW9ucy5jaGVja1NwZWxsaW5nICE9PSBmYWxzZVxuICAgIGNvbnN0IGNoZWNrU3R5bGUgPSBvcHRpb25zLmNoZWNrU3R5bGUgIT09IGZhbHNlXG5cbiAgICBjb25zdCBjaGVja3MgPSBbXVxuICAgIGlmIChjaGVja0dyYW1tYXIpIGNoZWNrcy5wdXNoKFwiZ3JhbW1hclwiKVxuICAgIGlmIChjaGVja1NwZWxsaW5nKSBjaGVja3MucHVzaChcInNwZWxsaW5nXCIpXG4gICAgaWYgKGNoZWNrU3R5bGUpIGNoZWNrcy5wdXNoKFwic3R5bGUgYW5kIGNsYXJpdHlcIilcblxuICAgIGNvbnN0IHByb21wdCA9IGBQcm9vZnJlYWQgYW5kIGNvcnJlY3QgdGhlIGZvbGxvd2luZyB0ZXh0IGZvciAke2NoZWNrcy5qb2luKFwiLCBcIil9LiBSZXR1cm4gb25seSB0aGUgY29ycmVjdGVkIHRleHQ6XG5cbiR7dGV4dH1cblxuQ29ycmVjdGVkIHRleHQ6YFxuXG4gICAgY29uc3QgcmVxdWVzdE1ldGFkYXRhOiBSZXF1ZXN0TWV0YWRhdGEgPSB7XG4gICAgICBzZWN0aW9uOiAncHJvb2ZyZWFkJyxcbiAgICAgIG9wdGltaXphdGlvbjogJ3RleHRfY29ycmVjdGlvbicsXG4gICAgICAuLi5tZXRhZGF0YVxuICAgIH07XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgY29ycmVjdGVkVGV4dCA9IGF3YWl0IHRoaXMubWFrZUdlbWluaVJlcXVlc3QocHJvbXB0LCB7IHRlbXBlcmF0dXJlOiAwLjIgfSwgcmVxdWVzdE1ldGFkYXRhKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY29ycmVjdGVkX3RleHQ6IGNvcnJlY3RlZFRleHQsXG4gICAgICAgIHN1Z2dlc3Rpb25zOiBbXSxcbiAgICAgICAgZXJyb3JzOiBbXVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiUHJvb2ZyZWFkaW5nIGZhaWxlZDpcIiwgZXJyb3IpXG4gICAgICAvLyBSZS10aHJvdyBlcnJvciBpbnN0ZWFkIG9mIGZhbGxiYWNrIHRvIG1haW50YWluIEFJLW9ubHkgYXBwcm9hY2hcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0TGFuZ3VhZ2VOYW1lKGNvZGU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgbGFuZ3VhZ2VNYXAgPSB7XG4gICAgICBlczogXCJTcGFuaXNoXCIsXG4gICAgICBmcjogXCJGcmVuY2hcIiwgXG4gICAgICBkZTogXCJHZXJtYW5cIixcbiAgICAgIGl0OiBcIkl0YWxpYW5cIixcbiAgICAgIHB0OiBcIlBvcnR1Z3Vlc2VcIixcbiAgICAgIGphOiBcIkphcGFuZXNlXCIsXG4gICAgICBrbzogXCJLb3JlYW5cIixcbiAgICAgIHpoOiBcIkNoaW5lc2VcIixcbiAgICAgIGVuOiBcIkVuZ2xpc2hcIlxuICAgIH1cbiAgICByZXR1cm4gbGFuZ3VhZ2VNYXBbY29kZV0gfHwgXCJFbmdsaXNoXCJcbiAgfVxufVxuXG4vLyBTZXJ2ZXItc2lkZSBvbmx5IGluaXRpYWxpemF0aW9uXG5leHBvcnQgY29uc3QgY3JlYXRlR29vZ2xlQUlTZXJ2ZXJTZXJ2aWNlID0gKCkgPT4ge1xuICBjb25zdCBhcGlLZXkgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19HT09HTEVfQUlfQVBJX0tFWVxuICBjb25zdCBiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfR09PR0xFX0FJX0JBU0VfVVJMIHx8IFwiaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb21cIlxuXG4gIGlmICghYXBpS2V5KSB7XG4gICAgY29uc29sZS53YXJuKFwiR29vZ2xlIEFJIEFQSSBrZXkgbm90IGZvdW5kLiBMZXNzb24gZ2VuZXJhdGlvbiB3aWxsIHVzZSBmYWxsYmFjayB0ZW1wbGF0ZXMuXCIpXG4gICAgLy8gUmV0dXJuIGEgc2VydmljZSB0aGF0IHdpbGwgYWx3YXlzIHRocm93IGVycm9ycywgdHJpZ2dlcmluZyBmYWxsYmFja3NcbiAgICByZXR1cm4gbmV3IEdvb2dsZUFJU2VydmVyU2VydmljZSh7IGFwaUtleTogXCJkdW1teVwiLCBiYXNlVXJsIH0pXG4gIH1cblxuICByZXR1cm4gbmV3IEdvb2dsZUFJU2VydmVyU2VydmljZSh7IGFwaUtleSwgYmFzZVVybCB9KVxufVxuXG5leHBvcnQgdHlwZSB7IFxuICBTdW1tYXJpemVyT3B0aW9ucywgXG4gIFRyYW5zbGF0b3JPcHRpb25zLCBcbiAgUHJvbXB0T3B0aW9ucywgXG4gIFdyaXRlck9wdGlvbnMsIFxuICBSZXdyaXRlck9wdGlvbnMsIFxuICBQcm9vZnJlYWRlck9wdGlvbnMsXG4gIFRva2VuVXNhZ2UsXG4gIFJlcXVlc3RNZXRhZGF0YSxcbiAgQmF0Y2hSZXF1ZXN0LFxuICBCYXRjaFJlc3BvbnNlXG59XG4iXSwibmFtZXMiOlsiZXJyb3JDbGFzc2lmaWVyIiwidXNhZ2VNb25pdG9yIiwiR29vZ2xlQUlTZXJ2ZXJTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJtb2RlbCIsIm1heFJldHJpZXMiLCJiYXNlUmV0cnlEZWxheSIsIm1heFJldHJ5RGVsYXkiLCJtYWtlR2VtaW5pUmVxdWVzdCIsInByb21wdCIsIm9wdGlvbnMiLCJtZXRhZGF0YSIsIm1ha2VHZW1pbmlSZXF1ZXN0V2l0aFJldHJ5IiwicmV0cnlBdHRlbXB0Iiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsInJlcXVlc3RJZCIsImdlbmVyYXRlUmVxdWVzdElkIiwicmVxdWVzdEJvZHkiLCJjb250ZW50cyIsInBhcnRzIiwidGV4dCIsImdlbmVyYXRpb25Db25maWciLCJ0ZW1wZXJhdHVyZSIsIm1heE91dHB1dFRva2VucyIsIm1heFRva2VucyIsInRvcFAiLCJlc3RpbWF0ZWRJbnB1dFRva2VucyIsIk1hdGgiLCJjZWlsIiwibGVuZ3RoIiwidXJsIiwiYmFzZVVybCIsImFwaUtleSIsImNvbnNvbGUiLCJsb2ciLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5Iiwic3RhdHVzIiwic3RhdHVzVGV4dCIsIm9rIiwicmVzdWx0IiwianNvbiIsImVuZFRpbWUiLCJyZXNwb25zZVRpbWUiLCJ0b2tlblVzYWdlIiwiZXh0cmFjdFRva2VuVXNhZ2UiLCJzZWN0aW9uIiwibG9nVG9rZW5Vc2FnZSIsInRvdGFsVG9rZW5zIiwib3B0aW1pemF0aW9uIiwiY29udGV4dCIsImNhbmRpZGF0ZXMiLCJjYW5kaWRhdGUiLCJmaW5pc2hSZWFzb24iLCJ3YXJuIiwiY29udGVudCIsImVycm9yIiwiRXJyb3IiLCJjb2RlIiwiZXJyb3JUZXh0IiwiaXNSZXRyeWFibGVFcnJvciIsImRlbGF5IiwiY2FsY3VsYXRlUmV0cnlEZWxheSIsInNsZWVwIiwiYWlFcnJvciIsImVycm9yQ29udGV4dCIsInVzZXJJZCIsImNvbnRlbnRMZW5ndGgiLCJsZXNzb25UeXBlIiwidGltZXN0YW1wIiwiYXBpRW5kcG9pbnQiLCJjbGFzc2lmaWVkRXJyb3IiLCJjbGFzc2lmeUVycm9yIiwibG9nRXJyb3IiLCJ0eXBlIiwiaXNOZXR3b3JrRXJyb3IiLCJtZXNzYWdlIiwiaW5wdXRUb2tlbnMiLCJvdXRwdXRUb2tlbnMiLCJ1c2FnZU1ldGFkYXRhIiwicHJvbXB0VG9rZW5Db3VudCIsImNhbmRpZGF0ZXNUb2tlbkNvdW50IiwicmVzcG9uc2VUZXh0IiwiaW5jbHVkZXMiLCJuZXR3b3JrSW5kaWNhdG9ycyIsImVycm9yTWVzc2FnZSIsInRvTG93ZXJDYXNlIiwic29tZSIsImluZGljYXRvciIsInBvdyIsImppdHRlciIsInJhbmRvbSIsIm1pbiIsIm1zIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwidG9TdHJpbmciLCJzdWJzdHIiLCJwcm9jZXNzQmF0Y2giLCJyZXF1ZXN0cyIsInJlc3VsdHMiLCJiYXRjaFNpemUiLCJpIiwiYmF0Y2giLCJzbGljZSIsImZsb29yIiwiYmF0Y2hQcm9taXNlcyIsIm1hcCIsInJlcXVlc3QiLCJpZCIsImJhdGNoUmVzdWx0cyIsImFsbCIsInB1c2giLCJmaWx0ZXIiLCJyIiwic3VtbWFyaXplIiwic3VtbWFyeVR5cGUiLCJsZW5ndGhJbnN0cnVjdGlvbnMiLCJzaG9ydCIsIm1lZGl1bSIsImxvbmciLCJ0eXBlSW5zdHJ1Y3Rpb25zIiwicmVxdWVzdE1ldGFkYXRhIiwidHJhbnNsYXRlIiwidGFyZ2V0TGFuZyIsImdldExhbmd1YWdlTmFtZSIsInRhcmdldExhbmd1YWdlIiwid3JpdGUiLCJ0b25lIiwiZm9ybWF0IiwiZm9ybWF0SW5zdHJ1Y3Rpb25zIiwicGFyYWdyYXBoIiwiZW5oYW5jZWRQcm9tcHQiLCJyZXdyaXRlIiwiYXVkaWVuY2UiLCJzaG9ydGVyIiwibG9uZ2VyIiwic2FtZSIsInByb29mcmVhZCIsImNoZWNrR3JhbW1hciIsImNoZWNrU3BlbGxpbmciLCJjaGVja1N0eWxlIiwiY2hlY2tzIiwiam9pbiIsImNvcnJlY3RlZFRleHQiLCJjb3JyZWN0ZWRfdGV4dCIsInN1Z2dlc3Rpb25zIiwiZXJyb3JzIiwibGFuZ3VhZ2VNYXAiLCJlcyIsImZyIiwiZGUiLCJpdCIsInB0IiwiamEiLCJrbyIsInpoIiwiZW4iLCJjcmVhdGVHb29nbGVBSVNlcnZlclNlcnZpY2UiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfR09PR0xFX0FJX0FQSV9LRVkiLCJORVhUX1BVQkxJQ19HT09HTEVfQUlfQkFTRV9VUkwiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/google-ai-server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/lesson-ai-generator-server.ts":
/*!*******************************************!*\
  !*** ./lib/lesson-ai-generator-server.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LessonAIServerGenerator: () => (/* binding */ LessonAIServerGenerator),\n/* harmony export */   lessonAIServerGenerator: () => (/* binding */ lessonAIServerGenerator)\n/* harmony export */ });\n/* harmony import */ var _google_ai_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./google-ai-server */ \"(rsc)/./lib/google-ai-server.ts\");\n/* harmony import */ var _progressive_generator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./progressive-generator */ \"(rsc)/./lib/progressive-generator.ts\");\n/* harmony import */ var _usage_monitor__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./usage-monitor */ \"(rsc)/./lib/usage-monitor.ts\");\n\n\n\nclass LessonAIServerGenerator {\n    getGoogleAI() {\n        if (!this.googleAI) {\n            this.googleAI = (0,_google_ai_server__WEBPACK_IMPORTED_MODULE_0__.createGoogleAIServerService)();\n        }\n        return this.googleAI;\n    }\n    getProgressiveGenerator() {\n        if (!this.progressiveGenerator) {\n            this.progressiveGenerator = new _progressive_generator__WEBPACK_IMPORTED_MODULE_1__.ProgressiveGeneratorImpl();\n        }\n        return this.progressiveGenerator;\n    }\n    // Summarize and adapt content to student level\n    async summarizeAndAdaptContent(sourceText, studentLevel, targetLanguage) {\n        try {\n            const levelGuidance = {\n                \"A1\": \"Use very simple vocabulary, present tense, short sentences (5-8 words). Explain basic concepts clearly.\",\n                \"A2\": \"Use simple vocabulary, basic past/present tense, medium sentences (8-12 words). Include familiar topics.\",\n                \"B1\": \"Use intermediate vocabulary, various tenses, longer sentences (12-15 words). Include opinions and explanations.\",\n                \"B2\": \"Use advanced vocabulary, complex sentences, abstract concepts. Include detailed explanations and analysis.\",\n                \"C1\": \"Use sophisticated vocabulary, complex structures, nuanced ideas. Include cultural and contextual depth.\"\n            };\n            const guidance = levelGuidance[studentLevel] || levelGuidance[\"B1\"];\n            const prompt = `Summarize and rewrite this content for ${studentLevel} level ${targetLanguage} students:\r\n\r\n${sourceText.substring(0, 1000)}\r\n\r\nREQUIREMENTS:\r\n- ${guidance}\r\n- Keep all important information and key concepts\r\n- Make it 200-400 words (appropriate length for reading)\r\n- Use vocabulary appropriate for ${studentLevel} level\r\n- Maintain the main ideas but simplify complex language\r\n- Include specific details and examples\r\n- Make it engaging and educational\r\n\r\nRewrite the content clearly and completely:`;\n            console.log(\"\\uD83D\\uDCDD Content adaptation prompt:\", prompt.length, \"chars\");\n            const response = await this.getGoogleAI().prompt(prompt);\n            return response.trim() || sourceText.substring(0, 400);\n        } catch (error) {\n            console.log(\"⚠️ Content adaptation failed, using original text\");\n            return sourceText.substring(0, 400);\n        }\n    }\n    async generateLesson(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage, sourceUrl, contentMetadata, structuredContent, wordCount, readingTime } = params;\n        // Create usage monitoring context\n        const generationContext = {\n            lessonId: `lesson_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            lessonType,\n            difficultyLevel: studentLevel,\n            contentLength: sourceText.length,\n            timestamp: new Date()\n        };\n        // Validate sourceText\n        if (!sourceText || typeof sourceText !== \"string\") {\n            throw new Error(\"Invalid sourceText: must be a non-empty string\");\n        }\n        console.log(\"\\uD83D\\uDE80 Starting lesson generation with params:\", {\n            textLength: sourceText.length,\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            hasMetadata: !!contentMetadata,\n            hasStructuredContent: !!structuredContent\n        });\n        try {\n            // Step 1: Summarize and adapt content to student level\n            console.log(\"\\uD83D\\uDCDD Step 1: Summarizing and adapting content to student level...\");\n            const adaptationStartTime = Date.now();\n            const adaptedContent = await this.summarizeAndAdaptContent(sourceText, studentLevel, targetLanguage);\n            const adaptationEndTime = Date.now();\n            // Log content adaptation usage\n            _usage_monitor__WEBPACK_IMPORTED_MODULE_2__.usageMonitor.logTokenUsage(\"content-adaptation\", Math.ceil(sourceText.length / 4), \"content-summarization\", generationContext);\n            console.log(\"✅ Content adapted:\", adaptedContent.length, \"chars\");\n            // Step 2: Generate lesson with adapted content\n            console.log(\"\\uD83E\\uDD16 Step 2: Generating lesson with adapted content...\");\n            const lessonGenerationStartTime = Date.now();\n            const lessonStructure = await this.generateMinimalAILesson(adaptedContent, lessonType, studentLevel, targetLanguage, contentMetadata);\n            const lessonGenerationEndTime = Date.now();\n            // Log lesson generation usage\n            _usage_monitor__WEBPACK_IMPORTED_MODULE_2__.usageMonitor.logTokenUsage(\"lesson-structure-generation\", Math.ceil(adaptedContent.length / 3), \"structured-generation\", generationContext);\n            console.log(\"✅ Minimal AI lesson generated:\", Object.keys(lessonStructure));\n            // Return properly structured GeneratedLesson object\n            const finalLesson = {\n                lessonType,\n                studentLevel,\n                targetLanguage,\n                sections: lessonStructure\n            };\n            console.log(\"\\uD83C\\uDFAF Returning AI-generated lesson:\", {\n                lessonType: finalLesson.lessonType,\n                studentLevel: finalLesson.studentLevel,\n                targetLanguage: finalLesson.targetLanguage,\n                sectionsCount: Object.keys(finalLesson.sections).length,\n                warmupCount: finalLesson.sections.warmup?.length || 0,\n                vocabularyCount: finalLesson.sections.vocabulary?.length || 0\n            });\n            console.log(\"\\uD83C\\uDF89 Optimized AI lesson generation complete!\");\n            return finalLesson;\n        } catch (error) {\n            // Log error to usage monitor\n            _usage_monitor__WEBPACK_IMPORTED_MODULE_2__.usageMonitor.logError(error, \"LESSON_GENERATION_FAILED\", generationContext);\n            console.error(\"❌ Error in AI lesson generation:\", error);\n            throw error;\n        }\n    }\n    // Progressive AI lesson generation with shared context\n    async generateMinimalAILesson(sourceText, lessonType, studentLevel, targetLanguage, metadata) {\n        console.log(\"\\uD83C\\uDFAF Using progressive generation with shared context...\");\n        const progressiveGen = this.getProgressiveGenerator();\n        // Step 1: Build shared context for all sections\n        console.log(\"\\uD83C\\uDFD7️ Building shared context...\");\n        const sharedContext = await progressiveGen.buildSharedContext(sourceText, lessonType, studentLevel, targetLanguage);\n        // Step 2: Define lesson sections with dependencies\n        const lessonSections = [\n            {\n                name: \"warmup\",\n                priority: 1,\n                dependencies: []\n            },\n            {\n                name: \"vocabulary\",\n                priority: 2,\n                dependencies: []\n            },\n            {\n                name: \"reading\",\n                priority: 3,\n                dependencies: [\n                    \"vocabulary\"\n                ]\n            },\n            {\n                name: \"comprehension\",\n                priority: 4,\n                dependencies: [\n                    \"reading\"\n                ]\n            },\n            {\n                name: \"discussion\",\n                priority: 5,\n                dependencies: [\n                    \"reading\",\n                    \"comprehension\"\n                ]\n            },\n            {\n                name: \"grammar\",\n                priority: 6,\n                dependencies: [\n                    \"reading\"\n                ]\n            },\n            {\n                name: \"pronunciation\",\n                priority: 7,\n                dependencies: [\n                    \"vocabulary\"\n                ]\n            },\n            {\n                name: \"wrapup\",\n                priority: 8,\n                dependencies: [\n                    \"discussion\"\n                ]\n            }\n        ];\n        // Step 3: Generate sections progressively\n        const generatedSections = [];\n        let currentContext = sharedContext;\n        for (const section of lessonSections){\n            console.log(`🔄 Generating section: ${section.name}`);\n            const generatedSection = await progressiveGen.generateSection(section, currentContext, generatedSections);\n            generatedSections.push(generatedSection);\n            // Update context with new section information\n            currentContext = progressiveGen.updateContext(currentContext, generatedSection);\n        }\n        // Step 4: Generate dialogue sections using template methods\n        const vocabularyWords = generatedSections.find((s)=>s.sectionName === \"vocabulary\")?.content?.filter((item)=>item.word !== \"INSTRUCTION\")?.map((item)=>item.word) || [];\n        const mainTopic = sharedContext.mainThemes[0] || \"this topic\";\n        const dialoguePractice = this.generateTemplateDialoguePractice(mainTopic, studentLevel, vocabularyWords);\n        const dialogueFillGap = this.generateTemplateDialogueFillGap(mainTopic, studentLevel, vocabularyWords);\n        // Step 5: Assemble final lesson structure\n        const lessonStructure = {};\n        for (const section of generatedSections){\n            lessonStructure[section.sectionName] = section.content;\n        }\n        lessonStructure.dialoguePractice = dialoguePractice;\n        lessonStructure.dialogueFillGap = dialogueFillGap;\n        console.log(\"✅ Progressive lesson generation complete!\");\n        return lessonStructure;\n    }\n    // Ultra-minimal warmup generation\n    async generateMinimalWarmup(sourceText, studentLevel) {\n        // Extract better context for topic identification\n        const topics = this.extractBetterTopics(sourceText);\n        const mainTopic = topics[0] || \"this topic\";\n        // Create a more specific prompt that avoids content assumptions\n        const prompt = `Write 3 ${studentLevel} warm-up questions about ${mainTopic}. Ask about students' prior knowledge and experience. Do not mention any specific events or results. Format: just the questions, one per line:`;\n        try {\n            console.log(\"\\uD83D\\uDD25 Minimal warmup prompt:\", prompt.length, \"chars\");\n            console.log(\"\\uD83C\\uDFAF Topic identified:\", mainTopic);\n            const response = await this.getGoogleAI().prompt(prompt);\n            // Extract only actual questions (must end with ?)\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>{\n                // Must be a question (ends with ?) and not an instruction\n                return line.endsWith(\"?\") && line.length > 10 && !line.toLowerCase().includes(\"here are\") && !line.toLowerCase().includes(\"based on\") && !line.toLowerCase().includes(\"headline mentions\") && !line.toLowerCase().includes(\"the text\") && !line.toLowerCase().includes(\"the article\") && !line.toLowerCase().includes(\"according to\") && !line.toLowerCase().includes(\"the passage\");\n            }).map((line)=>line.replace(/^\\d+\\.?\\s*/, \"\").replace(/^-\\s*/, \"\").trim()).slice(0, 3);\n            console.log(\"\\uD83C\\uDFAF Extracted warmup questions:\", questions);\n            if (questions.length < 3) {\n                throw new Error(\"Failed to generate sufficient warmup questions\");\n            }\n            return questions;\n        } catch (error) {\n            console.log(\"⚠️ Minimal warmup failed\");\n            throw new Error(\"Failed to generate warmup questions: \" + error.message);\n        }\n    }\n    // Add instructional text to sections\n    addWarmupInstructions(questions, studentLevel) {\n        const instruction = \"Have the following conversations or discussions with your tutor before reading the text:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    addComprehensionInstructions(questions, studentLevel) {\n        const instruction = \"After reading the text, answer these comprehension questions:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    addDiscussionInstructions(questions, studentLevel) {\n        const instruction = \"Discuss these questions with your tutor to explore the topic in depth:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    addWrapupInstructions(questions, studentLevel) {\n        const instruction = \"Reflect on your learning by discussing these wrap-up questions:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    addVocabularyInstructions(vocabulary, studentLevel) {\n        const instruction = {\n            word: \"INSTRUCTION\",\n            meaning: \"Study the following words with your tutor before reading the text:\",\n            example: \"\"\n        };\n        return [\n            instruction,\n            ...vocabulary\n        ];\n    }\n    addReadingInstructions(readingText, studentLevel) {\n        const instruction = \"Read the following text carefully. Your tutor will help you with any difficult words or concepts:\";\n        return `${instruction}\\n\\n${readingText}`;\n    }\n    // Better topic extraction that recognizes compound terms\n    extractBetterTopics(text) {\n        const topics = [];\n        // Look for compound terms first (like \"Ryder Cup\", \"World Cup\", etc.)\n        const compoundPatterns = [\n            /\\b(Ryder Cup|World Cup|Champions League|Premier League|Super Bowl|Olympics|World Series)\\b/gi,\n            /\\b(artificial intelligence|machine learning|climate change|social media)\\b/gi,\n            /\\b([A-Z][a-z]+ [A-Z][a-z]+)\\b/g // General compound proper nouns\n        ];\n        for (const pattern of compoundPatterns){\n            const matches = text.match(pattern);\n            if (matches) {\n                topics.push(...matches.map((m)=>m.toLowerCase()));\n            }\n        }\n        // If no compound terms found, fall back to single words\n        if (topics.length === 0) {\n            const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n            const commonWords = [\n                \"europe\",\n                \"team\",\n                \"golf\",\n                \"tournament\",\n                \"sports\",\n                \"competition\"\n            ];\n            const foundWords = words.filter((word)=>commonWords.includes(word));\n            topics.push(...foundWords.slice(0, 3));\n        }\n        return topics.length > 0 ? topics : [\n            \"sports\"\n        ];\n    }\n    // Enhanced vocabulary generation with AI-generated contextual examples\n    async generateMinimalVocabulary(sourceText, studentLevel) {\n        // Use smart vocabulary extraction instead of basic word matching\n        const meaningfulWords = this.extractMeaningfulVocabulary(sourceText, studentLevel);\n        console.log(\"\\uD83D\\uDCDA Meaningful vocabulary extracted:\", meaningfulWords);\n        const vocabulary = [];\n        for (const word of meaningfulWords){\n            try {\n                const capitalizedWord = this.capitalizeWord(word);\n                // Generate AI definition\n                const definitionPrompt = `Define \"${word}\" simply for ${studentLevel} level. Context: ${sourceText.substring(0, 80)}. Give only the definition, no extra text:`;\n                console.log(\"\\uD83D\\uDCDA Vocab definition prompt:\", definitionPrompt.length, \"chars\");\n                const rawMeaning = await this.getGoogleAI().prompt(definitionPrompt);\n                const meaning = this.cleanDefinition(rawMeaning, studentLevel);\n                // Generate AI contextual examples\n                const examples = await this.generateAIExampleSentences(word, studentLevel, sourceText);\n                vocabulary.push({\n                    word: capitalizedWord,\n                    meaning: meaning.trim().substring(0, 200),\n                    example: examples\n                });\n            } catch (error) {\n                console.log(`⚠️ Vocab failed for ${word}, using enhanced template`);\n                const capitalizedWord = this.capitalizeWord(word);\n                vocabulary.push({\n                    word: capitalizedWord,\n                    meaning: this.generateContextualWordMeaning(word, studentLevel, sourceText),\n                    example: await this.generateAIExampleSentences(word, studentLevel, sourceText)\n                });\n            }\n        }\n        // Ensure we have 6-10 words\n        return vocabulary.slice(0, 10).length >= 6 ? vocabulary.slice(0, 10) : vocabulary.slice(0, 6);\n    }\n    // Ultra-minimal comprehension generation\n    async generateMinimalComprehension(sourceText, studentLevel) {\n        const shortText = sourceText.substring(0, 200) // Increase context for more questions\n        ;\n        const prompt = `Write 5 ${studentLevel} reading comprehension questions about this text. Only return questions, no instructions: ${shortText}`;\n        try {\n            console.log(\"❓ Minimal comprehension prompt:\", prompt.length, \"chars\");\n            const response = await this.getGoogleAI().prompt(prompt);\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>{\n                // Must be a question and not an instruction\n                return line.endsWith(\"?\") && line.length > 10 && !line.toLowerCase().includes(\"here are\") && !line.toLowerCase().includes(\"based on\");\n            }).map((line)=>line.replace(/^\\d+\\.?\\s*/, \"\").replace(/^\\*\\*/, \"\").replace(/\\*\\*$/, \"\").trim()).slice(0, 5);\n            if (questions.length < 5) {\n                throw new Error(\"Failed to generate sufficient comprehension questions\");\n            }\n            return questions;\n        } catch (error) {\n            console.log(\"⚠️ Minimal comprehension failed\");\n            throw new Error(\"Failed to generate comprehension questions: \" + error.message);\n        }\n    }\n    // Minimal AI-only reading passage generation\n    async generateMinimalReading(sourceText, studentLevel) {\n        const prompt = `Rewrite this text for ${studentLevel} level students. Keep it 200-400 words: ${sourceText.substring(0, 500)}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            return response.trim();\n        } catch (error) {\n            throw new Error(\"Failed to generate reading passage: \" + error.message);\n        }\n    }\n    // Minimal AI-only discussion questions generation\n    async generateMinimalDiscussion(sourceText, studentLevel) {\n        const prompt = `Write 3 ${studentLevel} discussion questions about this text. Only return questions: ${sourceText.substring(0, 200)}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.endsWith(\"?\") && line.length > 10).map((line)=>line.replace(/^\\d+\\.?\\s*/, \"\").trim()).slice(0, 3);\n            if (questions.length < 3) {\n                throw new Error(\"Failed to generate sufficient discussion questions\");\n            }\n            return questions;\n        } catch (error) {\n            throw new Error(\"Failed to generate discussion questions: \" + error.message);\n        }\n    }\n    // Minimal AI-only grammar section generation\n    async generateMinimalGrammar(sourceText, studentLevel) {\n        const prompt = `Create a grammar lesson for ${studentLevel} level based on this text. Return JSON with focus, examples, exercise: ${sourceText.substring(0, 200)}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            return JSON.parse(response);\n        } catch (error) {\n            throw new Error(\"Failed to generate grammar section: \" + error.message);\n        }\n    }\n    // Minimal AI-only pronunciation section generation\n    async generateMinimalPronunciation(vocabularyWords, studentLevel) {\n        const word = vocabularyWords[0] || \"communication\";\n        const prompt = `Create pronunciation practice for \"${word}\". Return JSON with word, ipa, practice:`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            return JSON.parse(response);\n        } catch (error) {\n            throw new Error(\"Failed to generate pronunciation section: \" + error.message);\n        }\n    }\n    // Minimal AI-only wrapup questions generation\n    async generateMinimalWrapup(sourceText, studentLevel) {\n        const prompt = `Write 3 ${studentLevel} wrap-up questions about this lesson. Only return questions: ${sourceText.substring(0, 200)}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.endsWith(\"?\") && line.length > 10).map((line)=>line.replace(/^\\d+\\.?\\s*/, \"\").trim()).slice(0, 3);\n            if (questions.length < 3) {\n                throw new Error(\"Failed to generate sufficient wrapup questions\");\n            }\n            return questions;\n        } catch (error) {\n            throw new Error(\"Failed to generate wrapup questions: \" + error.message);\n        }\n    }\n    // Content analysis without AI calls\n    analyzeContentContextNoAI(sourceText, metadata, structuredContent, studentLevel) {\n        console.log(\"\\uD83D\\uDD0D Analyzing content context without AI...\");\n        const analysis = {\n            contentType: metadata?.contentType || \"general\",\n            domain: metadata?.domain || \"\",\n            complexity: \"medium\",\n            topics: [],\n            keyVocabulary: [],\n            culturalContext: \"\",\n            learningObjectives: [],\n            difficulty: studentLevel || \"B1\",\n            title: metadata?.title || \"\",\n            sourceCountry: this.determineSourceCountry(metadata?.domain || \"\")\n        };\n        // Analyze content complexity\n        const sentences = sourceText.split(/[.!?]+/).filter((s)=>s.trim().length > 10);\n        const avgSentenceLength = sentences.length > 0 ? sentences.reduce((sum, s)=>sum + s.split(\" \").length, 0) / sentences.length : 0;\n        const complexWords = sourceText.match(/\\b\\w{8,}\\b/g)?.length || 0;\n        const totalWords = sourceText.split(/\\s+/).length;\n        if (avgSentenceLength > 20 || complexWords / totalWords > 0.15) {\n            analysis.complexity = \"high\";\n        } else if (avgSentenceLength < 12 && complexWords / totalWords < 0.08) {\n            analysis.complexity = \"low\";\n        }\n        // Extract topics using text analysis\n        analysis.topics = this.extractTopicsFromText(sourceText, structuredContent?.headings || []);\n        // Extract vocabulary using text analysis\n        analysis.keyVocabulary = this.extractVocabularyFromText(sourceText, studentLevel);\n        // Determine cultural context\n        if (metadata?.domain) {\n            analysis.culturalContext = this.determineCulturalContext(metadata.domain, sourceText);\n        }\n        // Generate learning objectives\n        analysis.learningObjectives = this.generateLearningObjectives(analysis.contentType, analysis.topics, studentLevel);\n        return analysis;\n    }\n    // New method: Analyze content context and complexity\n    async analyzeContentContext(sourceText, metadata, structuredContent, studentLevel) {\n        console.log(\"\\uD83D\\uDD0D Analyzing content context...\");\n        const analysis = {\n            contentType: metadata?.contentType || \"general\",\n            domain: metadata?.domain || \"\",\n            complexity: \"medium\",\n            topics: [],\n            keyVocabulary: [],\n            culturalContext: \"\",\n            learningObjectives: [],\n            difficulty: studentLevel || \"B1\",\n            title: metadata?.title || \"\",\n            sourceCountry: this.determineSourceCountry(metadata?.domain || \"\")\n        };\n        // Analyze content complexity based on text characteristics\n        const sentences = sourceText.split(/[.!?]+/).filter((s)=>s.trim().length > 10);\n        const avgSentenceLength = sentences.length > 0 ? sentences.reduce((sum, s)=>sum + s.split(\" \").length, 0) / sentences.length : 0;\n        const complexWords = sourceText.match(/\\b\\w{8,}\\b/g)?.length || 0;\n        const totalWords = sourceText.split(/\\s+/).length;\n        if (avgSentenceLength > 20 || complexWords / totalWords > 0.15) {\n            analysis.complexity = \"high\";\n        } else if (avgSentenceLength < 12 && complexWords / totalWords < 0.08) {\n            analysis.complexity = \"low\";\n        }\n        console.log(\"\\uD83D\\uDCC8 Text complexity analysis:\", {\n            avgSentenceLength,\n            complexWords,\n            totalWords,\n            complexity: analysis.complexity\n        });\n        // Extract key topics using simple text analysis (skip AI to avoid token limits)\n        console.log(\"\\uD83C\\uDFAF Extracting topics using text analysis...\");\n        analysis.topics = this.extractTopicsFromText(sourceText, structuredContent?.headings || []);\n        console.log(\"✅ Extracted topics:\", analysis.topics);\n        // Extract key vocabulary using text analysis (skip AI to avoid token limits)\n        console.log(\"\\uD83D\\uDCDA Extracting vocabulary using text analysis...\");\n        analysis.keyVocabulary = this.extractVocabularyFromText(sourceText, studentLevel);\n        console.log(\"✅ Extracted vocabulary:\", analysis.keyVocabulary);\n        // Determine cultural context\n        if (metadata?.domain) {\n            analysis.culturalContext = this.determineCulturalContext(metadata.domain, sourceText);\n            console.log(\"\\uD83C\\uDF0D Cultural context:\", analysis.culturalContext);\n        }\n        // Generate learning objectives based on content type and lesson type\n        analysis.learningObjectives = this.generateLearningObjectives(analysis.contentType, analysis.topics, studentLevel);\n        console.log(\"\\uD83C\\uDFAF Learning objectives:\", analysis.learningObjectives);\n        return analysis;\n    }\n    // Enhanced contextual summary creation\n    async createContextualSummary(sourceText, contentAnalysis, lessonType, studentLevel) {\n        console.log(\"\\uD83D\\uDCDD Creating contextual summary...\");\n        // Use simple prompt to avoid token limits\n        const summaryPrompt = `Summarize this text in 4-5 sentences for ${studentLevel} level students:\r\n\r\n${sourceText.substring(0, 800)}\r\n\r\nSummary:`;\n        try {\n            console.log(\"\\uD83E\\uDD16 Calling AI for contextual summary...\");\n            const summary = await this.getGoogleAI().prompt(summaryPrompt, {\n                temperature: 0.4,\n                maxTokens: 300\n            });\n            console.log(\"✅ AI contextual summary created:\", summary.substring(0, 100) + \"...\");\n            return summary;\n        } catch (error) {\n            console.warn(\"⚠️ AI contextual summary failed, using text truncation:\", error.message);\n            // Skip complex fallbacks, just use truncation\n            const truncated = sourceText.substring(0, 600) + \"...\";\n            console.log(\"\\uD83D\\uDD04 Using truncated text as summary\");\n            return truncated;\n        }\n    }\n    // Generate CEFR-adapted warm-up questions\n    async generateContextualWarmupQuestions(content, contentAnalysis, studentLevel, metadata) {\n        console.log(\"\\uD83D\\uDD25 Generating CEFR-adapted warm-up questions...\");\n        const levelInstructions = {\n            \"A1\": `\r\nCreate 3 warm-up questions for A1 (beginner) level:\r\n- Use simple present tense and basic vocabulary\r\n- Ask yes/no questions or simple choice questions\r\n- Focus on familiar, concrete concepts\r\n- Keep questions short and direct\r\n- Use vocabulary the student likely knows\r\nExample: \"Do you use [topic] in your daily life? Yes or No?\"`,\n            \"A2\": `\r\nCreate 3 warm-up questions for A2 (elementary) level:\r\n- Use simple past tense and personal experiences\r\n- Ask for short, simple answers\r\n- Include basic comparisons with \"different\" or \"same\"\r\n- Focus on personal experiences and familiar situations\r\n- Use simple connecting words like \"and\", \"but\"\r\nExample: \"Have you ever [experienced topic]? How was it?\"`,\n            \"B1\": `\r\nCreate 3 warm-up questions for B1 (intermediate) level:\r\n- Ask for opinions with \"What do you think...?\"\r\n- Include comparisons between countries/cultures\r\n- Ask students to explain reasons with \"because\" or \"why\"\r\n- Discuss advantages and disadvantages\r\n- Use more varied vocabulary but keep structure clear\r\nExample: \"What do you think about [topic]? How is it different in your country?\"`,\n            \"B2\": `\r\nCreate 3 warm-up questions for B2 (upper intermediate) level:\r\n- Ask students to analyze situations and predict outcomes\r\n- Include complex opinions and explanations\r\n- Discuss implications and consequences\r\n- Use conditional language (\"What would happen if...?\")\r\n- Encourage detailed responses with examples\r\nExample: \"What challenges do you think [specific group] face with [topic]?\"`,\n            \"C1\": `\r\nCreate 3 warm-up questions for C1 (advanced) level:\r\n- Ask students to evaluate arguments and consider multiple perspectives\r\n- Include abstract concepts and societal implications\r\n- Use sophisticated vocabulary and complex structures\r\n- Encourage critical thinking and nuanced discussion\r\n- Ask about broader cultural and social contexts\r\nExample: \"How do cultural attitudes toward [concept] influence [topic] in different societies?\"`\n        };\n        // Ultra-simple prompt to avoid token limits\n        const topic = contentAnalysis.topics[0] || \"this topic\";\n        const warmupPrompt = `Create 3 ${studentLevel} level warm-up questions about ${topic}. Return only the questions:`;\n        try {\n            console.log(\"\\uD83E\\uDD16 Calling AI for contextual warm-up questions...\");\n            console.log(\"\\uD83D\\uDCDD Warm-up prompt:\", warmupPrompt.substring(0, 200) + \"...\");\n            const response = await this.getGoogleAI().prompt(warmupPrompt, {\n                temperature: 0.6,\n                maxTokens: 150\n            });\n            console.log(\"✅ AI warm-up questions generated\");\n            console.log(\"\\uD83E\\uDD16 Raw AI response:\", response);\n            const questions = this.parseListFromText(response).slice(0, 3);\n            console.log(\"\\uD83D\\uDD25 Parsed warm-up questions:\", questions);\n            console.log(\"\\uD83D\\uDD0D Questions array length:\", questions.length);\n            // Ensure we have 3 questions, add fallbacks if needed\n            while(questions.length < 3){\n                const fallbackQuestion = this.getFallbackWarmupQuestion(studentLevel, contentAnalysis, questions.length);\n                console.log(`🔄 Adding fallback question ${questions.length + 1}:`, fallbackQuestion);\n                questions.push(fallbackQuestion);\n            }\n            console.log(\"✅ Final warm-up questions:\", questions);\n            // Final safety check - if still empty, use basic fallback\n            if (questions.length === 0) {\n                console.warn(\"⚠️ No questions generated, using emergency fallback\");\n                return [\n                    \"What do you know about this topic?\",\n                    \"Have you experienced something similar?\",\n                    \"What would you like to learn?\"\n                ];\n            }\n            return questions;\n        } catch (error) {\n            console.warn(\"⚠️ AI warm-up generation failed, using contextual fallbacks:\", error.message);\n            const fallbackQuestions = this.getContextualWarmupFallback(studentLevel, contentAnalysis, metadata);\n            console.log(\"\\uD83D\\uDD04 Fallback warm-up questions:\", fallbackQuestions);\n            // Final safety check for fallback\n            if (!fallbackQuestions || fallbackQuestions.length === 0) {\n                console.warn(\"⚠️ Fallback also empty, using emergency questions\");\n                return [\n                    \"What do you know about this topic?\",\n                    \"Have you experienced something similar?\",\n                    \"What would you like to learn?\"\n                ];\n            }\n            return fallbackQuestions;\n        }\n    }\n    // Enhanced contextual lesson structure generation\n    async generateContextualLessonStructure(content, contentAnalysis, lessonType, studentLevel, targetLanguage, metadata) {\n        console.log(\"\\uD83C\\uDFD7️ Generating contextual lesson structure...\");\n        // Generate contextual warm-up questions first\n        const contextualWarmup = await this.generateContextualWarmupQuestions(content, contentAnalysis, studentLevel, metadata);\n        console.log(\"\\uD83D\\uDD25 Generated contextual warm-up questions:\", contextualWarmup);\n        // Ultra-simplified prompt to avoid token limits\n        const topics = contentAnalysis.topics.slice(0, 2).join(\", \") || \"technology\";\n        const vocab = contentAnalysis.keyVocabulary.slice(0, 4).join(\", \");\n        const prompt = `Create a ${lessonType} lesson for ${studentLevel} students about: ${topics}\r\n\r\nContent: \"${content.substring(0, 400)}\"\r\nKey words: ${vocab}\r\n\r\nReturn JSON with: warmup (use provided), vocabulary (4 words from content), reading (simplified content), comprehension (3 questions), discussion (3 questions), grammar (focus + examples), pronunciation (1 word), wrapup (3 questions).\r\n\r\n{\r\n  \"warmup\": ${JSON.stringify(contextualWarmup)},\r\n  \"vocabulary\": [{\"word\": \"word\", \"meaning\": \"definition\", \"example\": \"sentence\"}],\r\n  \"reading\": \"text\",\r\n  \"comprehension\": [\"question\"],\r\n  \"discussion\": [\"question\"], \r\n  \"grammar\": {\"focus\": \"topic\", \"examples\": [\"example\"], \"exercise\": [\"exercise\"]},\r\n  \"pronunciation\": {\"word\": \"word\", \"ipa\": \"/ipa/\", \"practice\": \"sentence\"},\r\n  \"wrapup\": [\"question\"]\r\n}`;\n        try {\n            console.log(\"\\uD83E\\uDD16 Calling AI for lesson structure...\");\n            const response = await this.getGoogleAI().prompt(prompt, {\n                temperature: 0.7,\n                maxTokens: 1500\n            });\n            console.log(\"\\uD83E\\uDD16 AI lesson structure response:\", response.substring(0, 200) + \"...\");\n            try {\n                const parsed = JSON.parse(response);\n                console.log(\"✅ Successfully parsed lesson structure JSON\");\n                // Ensure our contextual warm-up questions are preserved\n                parsed.warmup = contextualWarmup;\n                console.log(\"\\uD83D\\uDD25 Preserved contextual warm-up questions in final structure\");\n                return parsed;\n            } catch (parseError) {\n                console.warn(\"⚠️ Failed to parse JSON, attempting to clean response...\");\n                // Try to extract JSON from the response\n                const jsonMatch = response.match(/\\{[\\s\\S]*\\}/);\n                if (jsonMatch) {\n                    try {\n                        const cleaned = JSON.parse(jsonMatch[0]);\n                        console.log(\"✅ Successfully parsed cleaned JSON\");\n                        // Ensure our contextual warm-up questions are preserved\n                        cleaned.warmup = contextualWarmup;\n                        console.log(\"\\uD83D\\uDD25 Preserved contextual warm-up questions in cleaned structure\");\n                        return cleaned;\n                    } catch (cleanError) {\n                        console.warn(\"⚠️ Failed to parse cleaned JSON, using fallback\");\n                    }\n                }\n                // If JSON parsing fails, return a structured fallback with contextual warm-up\n                const fallback = this.createStructuredFallback(content, lessonType, studentLevel);\n                fallback.warmup = contextualWarmup;\n                console.log(\"\\uD83D\\uDD25 Using fallback with contextual warm-up questions\");\n                return fallback;\n            }\n        } catch (error) {\n            console.warn(\"⚠️ AI lesson structure generation failed, using fallback:\", error.message);\n            const fallback = this.createStructuredFallback(content, lessonType, studentLevel);\n            fallback.warmup = contextualWarmup;\n            console.log(\"\\uD83D\\uDD25 Using error fallback with contextual warm-up questions\");\n            return fallback;\n        }\n    }\n    // Enhanced detailed content generation with context\n    async generateDetailedContextualContent(structure, content, contentAnalysis, lessonType, studentLevel, targetLanguage, structuredContent) {\n        // Use Writer API to expand each section with contextual, detailed content\n        const sections = {\n            ...structure\n        };\n        // Enhance vocabulary section with contextual examples\n        if (sections.vocabulary) {\n            for(let i = 0; i < sections.vocabulary.length; i++){\n                const vocab = sections.vocabulary[i];\n                try {\n                    const contextualExamplePrompt = `\r\nCreate a natural example sentence using the word \"${vocab.word}\" that relates to this content context:\r\nTopics: ${contentAnalysis.topics.join(\", \")}\r\nContent type: ${contentAnalysis.contentType}\r\nLevel: ${studentLevel}\r\n\r\nMake the example relevant to the source material and appropriate for ${studentLevel} level students.\r\n`;\n                    const enhancedExample = await this.getGoogleAI().write(contextualExamplePrompt, {\n                        tone: \"casual\",\n                        length: \"short\"\n                    });\n                    sections.vocabulary[i].example = enhancedExample;\n                    // Add contextual meaning based on source content\n                    const contextualMeaningPrompt = `\r\nExplain the meaning of \"${vocab.word}\" in the context of: ${contentAnalysis.topics[0] || contentAnalysis.contentType}\r\nKeep it simple for ${studentLevel} level students.\r\n`;\n                    const contextualMeaning = await this.getGoogleAI().write(contextualMeaningPrompt, {\n                        tone: \"casual\",\n                        length: \"short\"\n                    });\n                    sections.vocabulary[i].contextualMeaning = contextualMeaning;\n                } catch (error) {\n                    // Keep original if enhancement fails\n                    console.warn(`Failed to enhance vocabulary for ${vocab.word}:`, error);\n                }\n            }\n        }\n        // Enhance discussion questions with specific content references\n        if (sections.discussion) {\n            try {\n                const enhancedDiscussionPrompt = `\r\nEnhance these discussion questions for a ${lessonType} lesson about ${contentAnalysis.topics.join(\" and \")}:\r\n${sections.discussion.join(\"\\n\")}\r\n\r\nMake them more specific to the content, engaging for ${studentLevel} level students, and encourage deeper thinking about:\r\n- ${contentAnalysis.topics.slice(0, 3).join(\"\\n- \")}\r\n\r\nReturn 3-4 enhanced questions that reference specific aspects of the content.\r\n`;\n                const enhancedDiscussion = await this.getGoogleAI().write(enhancedDiscussionPrompt, {\n                    tone: \"casual\",\n                    length: \"medium\",\n                    format: \"bullet-points\"\n                });\n                sections.discussion = this.parseListFromText(enhancedDiscussion).slice(0, 4);\n            } catch (error) {\n                console.warn(\"Failed to enhance discussion questions:\", error);\n            }\n        }\n        // Enhance reading section with better structure\n        if (sections.reading && structuredContent?.headings?.length > 0) {\n            try {\n                const structuredReadingPrompt = `\r\nImprove this reading text by organizing it with clear structure based on these headings from the original:\r\n${structuredContent.headings.slice(0, 3).map((h)=>`- ${h.text}`).join(\"\\n\")}\r\n\r\nOriginal text: \"${sections.reading}\"\r\n\r\nCreate a well-structured, ${studentLevel}-appropriate reading passage that maintains the key information but improves readability.\r\n`;\n                const enhancedReading = await this.getGoogleAI().rewrite(sections.reading, {\n                    tone: \"casual\",\n                    length: \"same\",\n                    audience: this.getAudienceLevel(studentLevel)\n                });\n                sections.reading = enhancedReading;\n            } catch (error) {\n                console.warn(\"Failed to enhance reading section:\", error);\n            }\n        }\n        // Enhance grammar section with content-specific examples\n        if (sections.grammar && sections.grammar.focus) {\n            try {\n                const grammarExamplesPrompt = `\r\nCreate 3 grammar examples for \"${sections.grammar.focus}\" using vocabulary and concepts from this content:\r\nTopics: ${contentAnalysis.topics.join(\", \")}\r\nKey vocabulary: ${contentAnalysis.keyVocabulary.slice(0, 5).join(\", \")}\r\n\r\nMake examples relevant to the content and appropriate for ${studentLevel} level.\r\n`;\n                const contextualGrammarExamples = await this.getGoogleAI().write(grammarExamplesPrompt, {\n                    tone: \"casual\",\n                    length: \"short\",\n                    format: \"bullet-points\"\n                });\n                sections.grammar.contextualExamples = this.parseListFromText(contextualGrammarExamples);\n            } catch (error) {\n                console.warn(\"Failed to enhance grammar examples:\", error);\n            }\n        }\n        return sections;\n    }\n    async proofreadLesson(lesson) {\n        // Proofread key text sections\n        const sectionsToProofread = [\n            \"reading\",\n            \"grammar.examples\",\n            \"pronunciation.practice\"\n        ];\n        for (const sectionPath of sectionsToProofread){\n            const value = this.getNestedValue(lesson, sectionPath);\n            if (typeof value === \"string\") {\n                const proofread = await this.getGoogleAI().proofread(value, {\n                    checkGrammar: true,\n                    checkSpelling: true,\n                    checkStyle: true\n                });\n                this.setNestedValue(lesson, sectionPath, proofread.corrected_text);\n            }\n        }\n        return lesson;\n    }\n    generateFallbackLesson(params) {\n        // Template-based fallback when AI APIs fail\n        const { sourceText, lessonType, studentLevel, targetLanguage } = params;\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: this.getTemplateWarmup(lessonType, studentLevel),\n                vocabulary: this.extractVocabulary(sourceText, studentLevel),\n                reading: this.simplifyText(sourceText, studentLevel),\n                comprehension: this.getTemplateComprehension(lessonType, studentLevel),\n                dialoguePractice: this.generateTemplateDialoguePractice(\"this topic\", studentLevel, []),\n                dialogueFillGap: this.generateTemplateDialogueFillGap(\"this topic\", studentLevel, []),\n                discussion: this.getTemplateDiscussion(lessonType, studentLevel),\n                grammar: this.getTemplateGrammar(studentLevel),\n                pronunciation: this.getTemplatePronunciation(sourceText),\n                wrapup: this.getTemplateWrapup(lessonType)\n            }\n        };\n    }\n    // Helper methods\n    getSummaryLength(level) {\n        const lengthMap = {\n            A1: \"short\",\n            A2: \"short\",\n            B1: \"medium\",\n            B2: \"medium\",\n            C1: \"long\"\n        };\n        return lengthMap[level] || \"medium\";\n    }\n    getLanguageCode(language) {\n        const languageMap = {\n            spanish: \"es\",\n            french: \"fr\",\n            german: \"de\",\n            italian: \"it\",\n            portuguese: \"pt\",\n            japanese: \"ja\",\n            korean: \"ko\",\n            chinese: \"zh\"\n        };\n        return languageMap[language] || \"en\";\n    }\n    parseListFromText(text) {\n        return text.split(\"\\n\").filter((line)=>line.trim()).map((line)=>line.replace(/^[-•*]\\s*/, \"\").trim()).filter((line)=>line.length > 0).slice(0, 4) // Limit to 4 items\n        ;\n    }\n    getNestedValue(obj, path) {\n        return path.split(\".\").reduce((current, key)=>current?.[key], obj);\n    }\n    setNestedValue(obj, path, value) {\n        const keys = path.split(\".\");\n        const lastKey = keys.pop();\n        const target = keys.reduce((current, key)=>current[key], obj);\n        target[lastKey] = value;\n    }\n    createStructuredFallback(content, lessonType, studentLevel) {\n        console.log(\"\\uD83D\\uDD04 Creating structured fallback lesson...\");\n        // Extract some basic information from content for better fallback\n        const words = content.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words)).slice(0, 6);\n        const fallback = {\n            warmup: [],\n            vocabulary: uniqueWords.map((word)=>({\n                    word: word,\n                    meaning: `Definition of ${word}`,\n                    example: `Example sentence with ${word}.`\n                })),\n            reading: this.simplifyText(content, studentLevel),\n            comprehension: this.getTemplateComprehension(lessonType, studentLevel),\n            discussion: this.getTemplateDiscussion(lessonType, studentLevel),\n            grammar: this.getTemplateGrammar(studentLevel),\n            pronunciation: this.getTemplatePronunciation(content),\n            wrapup: this.getTemplateWrapup(lessonType)\n        };\n        console.log(\"✅ Structured fallback created (warmup will be set by caller)\");\n        return fallback;\n    }\n    getTemplateWarmup(lessonType, studentLevel) {\n        const templates = {\n            discussion: [\n                \"What do you already know about this topic?\",\n                \"Have you had similar experiences?\",\n                \"What would you like to learn more about?\"\n            ],\n            grammar: [\n                \"What grammar patterns do you notice?\",\n                \"Which sentences seem most complex?\",\n                \"What grammar rules do you remember?\"\n            ],\n            travel: [\n                \"Where would you like to travel next?\",\n                \"What travel experiences have you had?\",\n                \"What travel vocabulary do you know?\"\n            ],\n            business: [\n                \"What business situations are you familiar with?\",\n                \"How do you communicate professionally?\",\n                \"What business terms are challenging?\"\n            ],\n            pronunciation: [\n                \"Which sounds are difficult to pronounce?\",\n                \"How do you practice pronunciation?\",\n                \"What pronunciation goals do you have?\"\n            ]\n        };\n        return templates[lessonType] || templates.discussion;\n    }\n    extractVocabulary(text, studentLevel) {\n        // Simple vocabulary extraction based on word frequency and complexity\n        const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words));\n        const selectedWords = uniqueWords.slice(0, 6);\n        return selectedWords.map((word)=>({\n                word: word,\n                meaning: `Definition of ${word}`,\n                example: `Example sentence with ${word}.`\n            }));\n    }\n    simplifyText(text, studentLevel) {\n        // Basic text simplification based on level\n        const maxLength = {\n            A1: 200,\n            A2: 300,\n            B1: 400,\n            B2: 500,\n            C1: 600\n        };\n        const limit = maxLength[studentLevel] || 400;\n        return text.substring(0, limit) + (text.length > limit ? \"...\" : \"\");\n    }\n    getTemplateComprehension(lessonType, studentLevel) {\n        return [\n            \"What is the main idea of this text?\",\n            \"What supporting details can you identify?\",\n            \"How does this relate to your experience?\",\n            \"What conclusions can you draw?\"\n        ];\n    }\n    getTemplateDiscussion(lessonType, studentLevel) {\n        const templates = {\n            discussion: [\n                \"What is your opinion on this topic?\",\n                \"How would you handle this situation?\",\n                \"What alternative approaches exist?\"\n            ],\n            business: [\n                \"How would you apply this professionally?\",\n                \"What business challenges does this address?\",\n                \"How would you present this to colleagues?\"\n            ],\n            travel: [\n                \"How would this help while traveling?\",\n                \"What preparations would you make?\",\n                \"How would you share this experience?\"\n            ]\n        };\n        return templates[lessonType] || templates.discussion;\n    }\n    getTemplateGrammar(studentLevel) {\n        const grammarFoci = {\n            A1: \"Present Simple Tense\",\n            A2: \"Past Simple Tense\",\n            B1: \"Present Perfect Tense\",\n            B2: \"Conditional Sentences\",\n            C1: \"Advanced Grammar Structures\"\n        };\n        return {\n            focus: grammarFoci[studentLevel] || \"Present Perfect Tense\",\n            examples: [\n                \"I have learned many new things.\",\n                \"She has improved her skills.\",\n                \"We have discussed this topic.\"\n            ],\n            exercise: [\n                \"I _____ (learn) a lot today.\",\n                \"They _____ (complete) the project.\",\n                \"She _____ (improve) significantly.\"\n            ]\n        };\n    }\n    getTemplatePronunciation(text) {\n        // Extract a challenging word from the text\n        const words = text.match(/\\b[a-z]{6,}\\b/gi) || [\n            \"communication\"\n        ];\n        const selectedWord = words[0] || \"communication\";\n        return {\n            word: selectedWord.toLowerCase(),\n            ipa: \"/kəˌmjuːnɪˈkeɪʃən/\",\n            practice: `Practice saying: \"${selectedWord}\" in a sentence.`\n        };\n    }\n    getTemplateWrapup(lessonType) {\n        return [\n            \"What new vocabulary did you learn?\",\n            \"Which concepts need more practice?\",\n            \"How will you use this knowledge?\",\n            \"What questions do you still have?\"\n        ];\n    }\n    // New helper methods for enhanced contextual analysis\n    extractTopicsFromHeadings(headings) {\n        return headings.filter((h)=>h.level <= 3) // Focus on main headings\n        .map((h)=>h.text).slice(0, 5);\n    }\n    extractTopicsFromText(text, headings) {\n        // First try to get topics from headings\n        const headingTopics = this.extractTopicsFromHeadings(headings);\n        if (headingTopics.length > 0) {\n            return headingTopics;\n        }\n        // Fallback: extract key phrases from text\n        const sentences = text.split(/[.!?]+/).filter((s)=>s.trim().length > 20);\n        const topics = [];\n        // Look for common topic indicators\n        const topicPatterns = [\n            /about (.+?)(?:\\s|,|\\.)/gi,\n            /discuss (.+?)(?:\\s|,|\\.)/gi,\n            /focus on (.+?)(?:\\s|,|\\.)/gi,\n            /regarding (.+?)(?:\\s|,|\\.)/gi\n        ];\n        for (const sentence of sentences.slice(0, 5)){\n            for (const pattern of topicPatterns){\n                const matches = sentence.match(pattern);\n                if (matches) {\n                    topics.push(...matches.map((m)=>m.replace(pattern, \"$1\").trim()).slice(0, 2));\n                }\n            }\n        }\n        // If no patterns found, extract key nouns\n        if (topics.length === 0) {\n            const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n            const commonWords = [\n                \"this\",\n                \"that\",\n                \"with\",\n                \"from\",\n                \"they\",\n                \"have\",\n                \"been\",\n                \"will\",\n                \"more\",\n                \"some\",\n                \"what\",\n                \"when\",\n                \"where\",\n                \"which\",\n                \"their\",\n                \"would\",\n                \"could\",\n                \"should\"\n            ];\n            const keyWords = words.filter((word)=>!commonWords.includes(word)).filter((word, index, arr)=>arr.indexOf(word) === index) // unique\n            .slice(0, 3);\n            return keyWords.length > 0 ? keyWords : [\n                \"AI technology\",\n                \"mobile devices\",\n                \"privacy\"\n            ];\n        }\n        return topics.slice(0, 3);\n    }\n    // Extract meaningful vocabulary for lesson content (improved algorithm)\n    extractMeaningfulVocabulary(text, level) {\n        const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words));\n        // Enhanced exclusion list focusing on truly basic words and proper names\n        const excludeWords = new Set([\n            // Basic function words\n            \"the\",\n            \"and\",\n            \"for\",\n            \"are\",\n            \"but\",\n            \"not\",\n            \"you\",\n            \"all\",\n            \"can\",\n            \"had\",\n            \"her\",\n            \"was\",\n            \"one\",\n            \"our\",\n            \"out\",\n            \"day\",\n            \"get\",\n            \"has\",\n            \"him\",\n            \"his\",\n            \"how\",\n            \"its\",\n            \"may\",\n            \"new\",\n            \"now\",\n            \"old\",\n            \"see\",\n            \"two\",\n            \"who\",\n            \"boy\",\n            \"did\",\n            \"she\",\n            \"use\",\n            \"way\",\n            \"what\",\n            \"when\",\n            \"where\",\n            \"will\",\n            \"with\",\n            \"have\",\n            \"this\",\n            \"that\",\n            \"they\",\n            \"been\",\n            \"said\",\n            \"each\",\n            \"which\",\n            \"their\",\n            \"time\",\n            \"would\",\n            \"there\",\n            \"could\",\n            \"other\",\n            \"after\",\n            \"first\",\n            \"well\",\n            \"water\",\n            \"very\",\n            \"what\",\n            \"know\",\n            \"just\",\n            \"people\",\n            \"into\",\n            \"over\",\n            \"think\",\n            \"also\",\n            \"back\",\n            \"work\",\n            \"life\",\n            \"only\",\n            \"year\",\n            \"years\",\n            \"come\",\n            \"came\",\n            \"right\",\n            \"good\",\n            \"each\",\n            \"those\",\n            \"feel\",\n            \"seem\",\n            \"these\",\n            \"give\",\n            \"most\",\n            \"hand\",\n            \"high\",\n            \"keep\",\n            \"last\",\n            \"left\",\n            \"life\",\n            \"live\",\n            \"look\",\n            \"made\",\n            \"make\",\n            \"many\",\n            \"much\",\n            \"must\",\n            \"name\",\n            \"need\",\n            \"next\",\n            \"open\",\n            \"part\",\n            \"play\",\n            \"said\",\n            \"same\",\n            \"seem\",\n            \"show\",\n            \"side\",\n            \"take\",\n            \"tell\",\n            \"turn\",\n            \"want\",\n            \"ways\",\n            \"well\",\n            \"went\",\n            \"were\",\n            \"here\",\n            \"home\",\n            \"long\",\n            \"look\",\n            \"move\",\n            \"place\",\n            \"right\",\n            \"small\",\n            \"sound\",\n            \"still\",\n            \"such\",\n            \"thing\",\n            \"think\",\n            \"three\",\n            \"under\",\n            \"water\",\n            \"where\",\n            \"while\",\n            \"world\",\n            \"write\",\n            \"young\",\n            // Very basic words that B1+ students should know\n            \"student\",\n            \"english\",\n            \"september\",\n            \"october\",\n            \"november\",\n            \"december\",\n            \"january\",\n            \"february\",\n            \"march\",\n            \"april\",\n            \"june\",\n            \"july\",\n            \"august\",\n            \"south\",\n            \"africa\",\n            \"images\",\n            \"image\",\n            \"photo\",\n            \"picture\",\n            \"black\",\n            \"white\",\n            \"coloured\",\n            \"colored\",\n            // Problematic or sensitive terms to avoid in vocabulary\n            \"slur\",\n            \"slurs\",\n            \"racial\",\n            \"racist\",\n            \"racism\",\n            \"mckenzie\",\n            \"apartheid\",\n            \"monday\",\n            \"tuesday\",\n            \"wednesday\",\n            \"thursday\",\n            \"friday\",\n            \"saturday\",\n            \"sunday\",\n            \"today\",\n            \"yesterday\",\n            \"tomorrow\",\n            \"morning\",\n            \"afternoon\",\n            \"evening\",\n            \"night\",\n            // Common proper names to avoid (people's names and specific places)\n            \"john\",\n            \"mary\",\n            \"david\",\n            \"sarah\",\n            \"michael\",\n            \"jennifer\",\n            \"robert\",\n            \"lisa\",\n            \"william\",\n            \"karen\",\n            \"james\",\n            \"susan\",\n            \"christopher\",\n            \"jessica\",\n            \"daniel\",\n            \"nancy\",\n            \"matthew\",\n            \"betty\",\n            \"anthony\",\n            \"helen\",\n            \"mark\",\n            \"sandra\",\n            \"donald\",\n            \"donna\",\n            \"steven\",\n            \"carol\",\n            \"paul\",\n            \"ruth\",\n            \"andrew\",\n            \"sharon\",\n            \"joshua\",\n            \"michelle\",\n            \"kenneth\",\n            \"laura\",\n            \"kevin\",\n            \"sarah\",\n            \"brian\",\n            \"kimberly\",\n            \"george\",\n            \"deborah\",\n            \"edward\",\n            \"dorothy\",\n            \"ronald\",\n            \"lisa\",\n            \"timothy\",\n            \"nancy\",\n            \"jason\",\n            \"karen\",\n            \"jeffrey\",\n            \"betty\",\n            \"ryan\",\n            \"helen\",\n            \"jacob\",\n            \"sandra\",\n            \"gary\",\n            \"donna\",\n            \"nicholas\",\n            \"carol\",\n            \"eric\",\n            \"ruth\",\n            \"jonathan\",\n            \"sharon\",\n            \"stephen\",\n            \"michelle\",\n            \"larry\",\n            \"laura\",\n            \"justin\",\n            \"sarah\",\n            \"scott\",\n            \"kimberly\",\n            \"brandon\",\n            \"deborah\",\n            \"benjamin\",\n            \"dorothy\",\n            \"samuel\",\n            \"lisa\",\n            \"gregory\",\n            \"nancy\",\n            \"alexander\",\n            \"karen\",\n            \"patrick\",\n            \"betty\",\n            \"frank\",\n            \"helen\",\n            \"raymond\",\n            \"sandra\",\n            \"jack\",\n            \"donna\",\n            \"dennis\",\n            \"carol\",\n            \"jerry\",\n            \"ruth\",\n            \"tyler\",\n            \"sharon\",\n            \"aaron\",\n            \"michelle\",\n            \"jose\",\n            \"laura\",\n            \"henry\",\n            \"sarah\",\n            \"adam\",\n            \"kimberly\",\n            \"douglas\",\n            \"deborah\",\n            \"nathan\",\n            \"dorothy\",\n            \"peter\",\n            \"lisa\",\n            \"zachary\",\n            \"nancy\",\n            \"kyle\",\n            \"karen\",\n            \"julius\",\n            \"malema\"\n        ]);\n        // Filter and score words for educational value\n        const meaningfulWords = uniqueWords.filter((word)=>{\n            if (excludeWords.has(word)) return false;\n            if (/^\\d+$/.test(word)) return false // Skip pure numbers\n            ;\n            if (word.length < 4) return false // Skip very short words\n            ;\n            if (word.length > 15) return false // Skip very long words\n            ;\n            if (this.isProperName(word)) return false // Skip proper names\n            ;\n            return true;\n        });\n        // Score words based on educational and contextual value\n        const scoredWords = meaningfulWords.map((word)=>{\n            let score = 0;\n            // High-value content-specific vocabulary (political, business, academic terms)\n            if (/^(announcement|opposition|recognition|leadership|management|government|political|parliament|democracy|election|policy|legislation|constitution|rights|freedom|justice|equality|development|economic|social|cultural|environmental|international|national|regional|community|organization|institution|administration|authority|responsibility|accountability|transparency|governance|regulation|compliance|strategy|implementation|evaluation|assessment|analysis|research|investigation|examination|consideration|discussion|negotiation|agreement|cooperation|collaboration|partnership|relationship|communication|information|education|training|knowledge|understanding|awareness|consciousness|perspective|opinion|belief|attitude|approach|method|technique|process|system|structure|framework|principle|concept|theory|practice|experience|skill|expertise|professional|academic|scientific|technical|technological|digital|innovation|creativity|development|improvement|enhancement|transformation|change|progress|advancement|achievement|success|performance|quality|efficiency|effectiveness|productivity|sustainability|responsibility|commitment|dedication|motivation|inspiration|leadership|management|coordination|supervision|direction|guidance|support|assistance|service|provision|delivery|implementation|execution|operation|function|activity|action|behavior|conduct|practice|procedure|protocol|standard|guideline|requirement|condition|situation|circumstance|context|environment|setting|background|history|tradition|culture|society|community|population|group|team|organization|institution|establishment|authority|government|administration|policy|regulation|law|rule|standard|guideline|procedure|protocol|framework|model|pattern|template|example|instance|case|scenario)/.test(word)) {\n                score += 6 // Highest priority for meaningful content vocabulary\n                ;\n            }\n            // Business and professional terms\n            if (/^(manage|leader|team|company|business|strategy|develop|create|innovat|technolog|digital|global|professional|experience|skill|expert|analysis|research|project|solution|challenge|opportunity|growth|success|achievement|performance|quality|efficiency|productivity|collaboration|communication|decision|responsibility|objective|goal|target|result|outcome|impact|benefit|advantage|value|profit|revenue|investment|market|customer|client|service|product|brand|reputation|competitive|industry|sector|economy|economic|financial|budget|cost|price|sales|marketing|advertising|promotion|campaign|strategy|planning|implementation|execution|evaluation|assessment|improvement|optimization|transformation|change|adaptation|flexibility|agility|resilience|sustainability|environmental|social|ethical|governance|compliance|regulation|policy|procedure|standard|guideline|framework|methodology|approach|technique|method|process|system|structure|organization|hierarchy|department|division|function|role|position|title|career|development|training|education|learning|knowledge|information|data|insight|intelligence)/.test(word)) {\n                score += 4;\n            }\n            // Academic and formal vocabulary\n            if (/^(research|study|analysis|theory|concept|principle|method|approach|technique|process|system|structure|function|relationship|connection|interaction|influence|effect|impact|cause|result|consequence|factor|element|component|aspect|feature|characteristic|property|quality|attribute|dimension|level|degree|extent|scope|range|scale|measure|measurement|evaluation|assessment|comparison|contrast|similarity|difference|variation|change|development|evolution|progress|advancement|improvement|enhancement|modification|adjustment|adaptation|transformation|revolution|innovation|discovery|invention|creation|production|construction|design|planning|organization|management|administration|operation|implementation|execution|performance|achievement|accomplishment)/.test(word)) {\n                score += 3;\n            }\n            // Action words and processes (often good for learning)\n            if (/^(announce|reorganize|manage|develop|implement|achieve|improve|transform|communicate|collaborate|investigate|explore|examine|evaluate|assess|consider|discuss|negotiate|present|demonstrate|explain|describe|illustrate|interpret|translate|adapt|modify|optimize|organize|coordinate|administer|supervise|operate|execute|perform|accomplish|establish|maintain|preserve|conserve|protect|prevent|promote|advance|enhance|enrich|empower|engage|involve|participate|contribute|dedicate|commit|invest|allocate|distribute|circulate|transmit|transport|deliver|provide|supply|support|assist|guide|direct|instruct|educate|train|prepare|plan|schedule|arrange|coordinate|synchronize|integrate|combine|connect|associate|relate|partner|collaborate|cooperate|compete|compare|contrast|differentiate|distinguish|identify|recognize|acknowledge|appreciate|understand|comprehend|realize|aware|conscious|perceive|observe|monitor|track|measure|calculate|estimate|predict|forecast|project|anticipate|expect|assume|hypothesize|speculate|investigate|explore|research|analyze|synthesize|evaluate|assess|judge|decide|choose|select|prefer|recommend|suggest|propose|offer|request|demand|require|specify|instruct|direct|guide|advise|consult|discuss|negotiate|agree|contract|deal|transaction|exchange|trade|purchase|sale|investment|funding|financing|sponsorship|support|assistance|service|provision|delivery|distribution|allocation|assignment|delegation|authorization|approval|permission|consent|acceptance|rejection|refusal|denial|prohibition|restriction|limitation|constraint|regulation|control|management|administration|governance|leadership|supervision|oversight|monitoring|evaluation|assessment|review|audit|inspection|examination|investigation|inquiry)/.test(word)) {\n                score += 3;\n            }\n            // Frequency bonus (words that appear multiple times are likely important)\n            const frequency = (text.toLowerCase().match(new RegExp(`\\\\b${word}\\\\b`, \"g\")) || []).length;\n            if (frequency > 1) score += frequency * 2;\n            // Length bonus for substantial words\n            if (word.length >= 6 && word.length <= 12) score += 1;\n            return {\n                word,\n                score\n            };\n        });\n        // Sort by score and return top words\n        const topWords = scoredWords.sort((a, b)=>b.score - a.score).slice(0, 8) // Take top 8 words\n        .map((item)=>item.word);\n        console.log(\"\\uD83D\\uDCDA Meaningful vocabulary extraction results:\", topWords.map((w)=>`${w} (score: ${scoredWords.find((s)=>s.word === w)?.score})`));\n        return topWords;\n    }\n    extractVocabularyFromText(text, level) {\n        // Smart vocabulary extraction focusing on meaningful, educational words\n        const words = text.toLowerCase().match(/\\b[a-z]{3,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words));\n        // Words to exclude (common, non-educational words)\n        const excludeWords = new Set([\n            // Common words\n            \"the\",\n            \"and\",\n            \"for\",\n            \"are\",\n            \"but\",\n            \"not\",\n            \"you\",\n            \"all\",\n            \"can\",\n            \"had\",\n            \"her\",\n            \"was\",\n            \"one\",\n            \"our\",\n            \"out\",\n            \"day\",\n            \"get\",\n            \"has\",\n            \"him\",\n            \"his\",\n            \"how\",\n            \"its\",\n            \"may\",\n            \"new\",\n            \"now\",\n            \"old\",\n            \"see\",\n            \"two\",\n            \"who\",\n            \"boy\",\n            \"did\",\n            \"she\",\n            \"use\",\n            \"way\",\n            \"what\",\n            \"when\",\n            \"where\",\n            \"will\",\n            \"with\",\n            \"have\",\n            \"this\",\n            \"that\",\n            \"they\",\n            \"been\",\n            \"said\",\n            \"each\",\n            \"which\",\n            \"their\",\n            \"time\",\n            \"would\",\n            \"there\",\n            \"could\",\n            \"other\",\n            \"after\",\n            \"first\",\n            \"well\",\n            \"water\",\n            \"very\",\n            \"what\",\n            \"know\",\n            \"just\",\n            \"people\",\n            \"into\",\n            \"over\",\n            \"think\",\n            \"also\",\n            \"back\",\n            \"work\",\n            \"life\",\n            \"only\",\n            \"year\",\n            \"years\",\n            \"come\",\n            \"came\",\n            \"right\",\n            \"good\",\n            \"each\",\n            \"those\",\n            \"feel\",\n            \"seem\",\n            \"these\",\n            \"give\",\n            \"most\",\n            \"hand\",\n            \"high\",\n            \"keep\",\n            \"last\",\n            \"left\",\n            \"life\",\n            \"live\",\n            \"look\",\n            \"made\",\n            \"make\",\n            \"many\",\n            \"much\",\n            \"must\",\n            \"name\",\n            \"need\",\n            \"next\",\n            \"open\",\n            \"part\",\n            \"play\",\n            \"said\",\n            \"same\",\n            \"seem\",\n            \"show\",\n            \"side\",\n            \"take\",\n            \"tell\",\n            \"turn\",\n            \"want\",\n            \"ways\",\n            \"well\",\n            \"went\",\n            \"were\",\n            \"here\",\n            \"home\",\n            \"long\",\n            \"look\",\n            \"move\",\n            \"place\",\n            \"right\",\n            \"small\",\n            \"sound\",\n            \"still\",\n            \"such\",\n            \"thing\",\n            \"think\",\n            \"three\",\n            \"under\",\n            \"water\",\n            \"where\",\n            \"while\",\n            \"world\",\n            \"write\",\n            \"young\",\n            // Dates, numbers, names (often not useful for vocabulary)\n            \"january\",\n            \"february\",\n            \"march\",\n            \"april\",\n            \"june\",\n            \"july\",\n            \"august\",\n            \"september\",\n            \"october\",\n            \"november\",\n            \"december\",\n            \"monday\",\n            \"tuesday\",\n            \"wednesday\",\n            \"thursday\",\n            \"friday\",\n            \"saturday\",\n            \"sunday\",\n            \"today\",\n            \"yesterday\",\n            \"tomorrow\",\n            \"morning\",\n            \"afternoon\",\n            \"evening\",\n            \"night\",\n            // Common proper nouns that are often not educational\n            \"francisco\",\n            \"california\",\n            \"america\",\n            \"american\",\n            \"united\",\n            \"states\",\n            \"york\",\n            \"london\",\n            \"paris\",\n            \"tokyo\"\n        ]);\n        // Prioritize meaningful vocabulary categories\n        const meaningfulWords = uniqueWords.filter((word)=>{\n            // Skip excluded words\n            if (excludeWords.has(word)) return false;\n            // Skip pure numbers or dates\n            if (/^\\d+$/.test(word) || /^\\d{4}$/.test(word)) return false;\n            // Skip very short words (less than 4 letters) unless they're important\n            if (word.length < 4) return false;\n            // Skip very long words that might be too complex\n            if (word.length > 15) return false;\n            return true;\n        });\n        // Score words based on educational value\n        const scoredWords = meaningfulWords.map((word)=>{\n            let score = 0;\n            // Business/professional vocabulary\n            if (/^(manage|leader|team|company|business|strategy|develop|create|innovat|technolog|digital|global|international|professional|experience|skill|expert|analysis|research|project|solution|challenge|opportunity|growth|success|achievement|performance|quality|efficiency|productivity|collaboration|communication|decision|responsibility|objective|goal|target|result|outcome|impact|benefit|advantage|value|profit|revenue|investment|market|customer|client|service|product|brand|reputation|competitive|industry|sector|economy|economic|financial|budget|cost|price|sales|marketing|advertising|promotion|campaign|strategy|planning|implementation|execution|evaluation|assessment|improvement|optimization|transformation|change|adaptation|flexibility|agility|resilience|sustainability|environmental|social|ethical|governance|compliance|regulation|policy|procedure|standard|guideline|framework|methodology|approach|technique|method|process|system|structure|organization|hierarchy|department|division|function|role|position|title|career|development|training|education|learning|knowledge|information|data|insight|intelligence|wisdom|understanding|comprehension|awareness|consciousness|perception|perspective|viewpoint|opinion|belief|attitude|mindset|culture|values|principles|ethics|integrity|honesty|transparency|accountability|responsibility|commitment|dedication|passion|motivation|inspiration|creativity|innovation|imagination|vision|mission|purpose|meaning|significance|importance|relevance|priority|urgency|critical|essential|fundamental|basic|advanced|complex|sophisticated|comprehensive|detailed|specific|particular|general|overall|total|complete|full|entire|whole|partial|limited|restricted|exclusive|inclusive|diverse|varied|different|similar|comparable|equivalent|equal|fair|just|reasonable|logical|rational|practical|realistic|achievable|feasible|possible|probable|likely|unlikely|impossible|certain|uncertain|confident|doubtful|optimistic|pessimistic|positive|negative|neutral|objective|subjective|personal|individual|collective|social|public|private|internal|external|local|regional|national|international|global|worldwide|universal)/.test(word)) {\n                score += 3;\n            }\n            // Academic/educational vocabulary\n            if (/^(research|study|analysis|theory|concept|principle|method|approach|technique|process|system|structure|function|relationship|connection|interaction|influence|effect|impact|cause|result|consequence|factor|element|component|aspect|feature|characteristic|property|quality|attribute|dimension|level|degree|extent|scope|range|scale|measure|measurement|evaluation|assessment|comparison|contrast|similarity|difference|variation|change|development|evolution|progress|advancement|improvement|enhancement|modification|adjustment|adaptation|transformation|revolution|innovation|discovery|invention|creation|production|construction|design|planning|organization|management|administration|operation|implementation|execution|performance|achievement|accomplishment|success|failure|challenge|problem|issue|difficulty|obstacle|barrier|limitation|constraint|restriction|requirement|condition|situation|circumstance|context|environment|setting|background|history|tradition|culture|society|community|population|group|team|organization|institution|establishment|authority|government|administration|policy|regulation|law|rule|standard|guideline|procedure|protocol|framework|model|pattern|template|example|instance|case|scenario|situation|condition|state|status|position|location|place|area|region|zone|territory|domain|field|sector|industry|market|economy|business|commerce|trade|exchange|transaction|deal|agreement|contract|partnership|collaboration|cooperation|coordination|communication|interaction|relationship|connection|network|system|structure|organization|hierarchy|level|rank|grade|class|category|type|kind|sort|variety|diversity|range|spectrum)/.test(word)) {\n                score += 2;\n            }\n            // Technical/specialized vocabulary\n            if (/^(technolog|digital|computer|software|hardware|internet|online|website|platform|application|program|code|data|information|network|system|security|privacy|encryption|algorithm|artificial|intelligence|machine|learning|automation|robot|innovation|development|engineering|science|scientific|medical|health|treatment|diagnosis|research|experiment|laboratory|equipment|instrument|device|tool|machine|mechanism|process|procedure|technique|method|approach|strategy|solution|problem|challenge|opportunity|advantage|benefit|risk|threat|danger|safety|protection|prevention|control|management|monitoring|supervision|oversight|governance|regulation|compliance|standard|quality|performance|efficiency|effectiveness|productivity|optimization|improvement|enhancement|upgrade|update|modification|customization|personalization|adaptation|flexibility|scalability|sustainability|reliability|durability|stability|consistency|accuracy|precision|validity|credibility|authenticity|transparency|accountability|responsibility|integrity|ethics|morality|values|principles|beliefs|attitudes|perspectives|opinions|views|thoughts|ideas|concepts|theories|models|frameworks|paradigms|approaches|methodologies|strategies|tactics|techniques|procedures|protocols)/.test(word)) {\n                score += 2;\n            }\n            // Action/process words (verbs in noun form or gerunds)\n            if (/^(announcement|leadership|management|development|implementation|achievement|improvement|transformation|communication|collaboration|investigation|exploration|examination|evaluation|assessment|consideration|discussion|negotiation|presentation|demonstration|explanation|description|illustration|interpretation|translation|adaptation|modification|optimization|organization|coordination|administration|supervision|operation|execution|performance|accomplishment|establishment|maintenance|preservation|conservation|protection|prevention|promotion|advancement|enhancement|enrichment|empowerment|engagement|involvement|participation|contribution|dedication|commitment|investment|allocation|distribution|circulation|transmission|transportation|delivery|provision|supply|support|assistance|guidance|direction|instruction|education|training|preparation|planning|scheduling|arrangement|coordination|synchronization|integration|combination|connection|association|relationship|partnership|collaboration|cooperation|competition|comparison|contrast|differentiation|distinction|identification|recognition|acknowledgment|appreciation|understanding|comprehension|realization|awareness|consciousness|perception|observation|monitoring|tracking|measurement|calculation|estimation|prediction|forecasting|projection|anticipation|expectation|assumption|hypothesis|speculation|investigation|exploration|research|analysis|synthesis|evaluation|assessment|judgment|decision|choice|selection|preference|recommendation|suggestion|proposal|offer|request|demand|requirement|specification|instruction|direction|guidance|advice|consultation|discussion|negotiation|agreement|contract|deal|transaction|exchange|trade|purchase|sale|investment|funding|financing|sponsorship|support|assistance|service|provision|delivery|distribution|allocation|assignment|delegation|authorization|approval|permission|consent|acceptance|rejection|refusal|denial|prohibition|restriction|limitation|constraint|regulation|control|management|administration|governance|leadership|supervision|oversight|monitoring|evaluation|assessment|review|audit|inspection|examination|investigation|inquiry|research|study|analysis|interpretation|explanation|clarification|specification|definition|description|illustration|demonstration|presentation|exhibition|display|show|performance|execution|implementation|application|utilization|employment|usage|operation|function|activity|action|behavior|conduct|practice|procedure|process|method|technique|approach|strategy|plan|scheme|program|project|initiative|campaign|movement|effort|attempt|trial|experiment|test|examination|evaluation|assessment|measurement|calculation|estimation|determination|identification|recognition|discovery|invention|creation|production|construction|building|development|growth|expansion|extension|enlargement|increase|improvement|enhancement|upgrade|advancement|progress|evolution|transformation|change|modification|adjustment|adaptation|customization|personalization|optimization|refinement|perfection|completion|achievement|accomplishment|success|victory|triumph|conquest|defeat|failure|loss|mistake|error|problem|issue|difficulty|challenge|obstacle|barrier|limitation|constraint|restriction|requirement|condition|situation|circumstance|context|environment|setting|atmosphere|climate|culture|tradition|custom|habit|routine|pattern|trend|tendency|inclination|preference|choice|option|alternative|possibility|opportunity|chance|probability|likelihood|certainty|uncertainty|doubt|confidence|trust|faith|belief|conviction|opinion|view|perspective|standpoint|position|stance|attitude|approach|mindset|mentality|psychology|philosophy|ideology|theory|concept|idea|notion|thought|consideration|reflection|contemplation|meditation|concentration|focus|attention|interest|curiosity|wonder|amazement|surprise|shock|astonishment|bewilderment|confusion|uncertainty|clarity|understanding|comprehension|knowledge|information|data|facts|details|specifics|particulars|characteristics|features|attributes|properties|qualities|aspects|elements|components|parts|sections|segments|divisions|categories|types|kinds|varieties|forms|shapes|sizes|dimensions|measurements|quantities|amounts|numbers|figures|statistics|percentages|proportions|ratios|rates|speeds|frequencies|intervals|periods|durations|times|moments|instances|occasions|events|incidents|occurrences|happenings|developments|changes|modifications|alterations|adjustments|improvements|enhancements|upgrades|updates|revisions|corrections|fixes|repairs|maintenance|preservation|conservation|protection|security|safety|defense|prevention|precaution|preparation|readiness|availability|accessibility|convenience|comfort|ease|simplicity|complexity|difficulty|challenge|complication|sophistication|advancement|progress|development|growth|expansion|extension|increase|rise|improvement|enhancement|betterment|amelioration|optimization|perfection|excellence|quality|standard|level|grade|rank|status|position|location|place|site|spot|point|area|region|zone|territory|domain|field|sector|industry|market|economy|business|enterprise|organization|institution|establishment|company|corporation|firm|agency|department|division|section|unit|team|group|committee|board|council|assembly|association|society|community|population|public|audience|customers|clients|users|consumers|buyers|purchasers|investors|stakeholders|shareholders|partners|collaborators|colleagues|associates|members|participants|contributors|supporters|advocates|representatives|delegates|ambassadors|spokespersons|leaders|managers|directors|executives|administrators|supervisors|coordinators|organizers|planners|designers|developers|creators|producers|manufacturers|suppliers|providers|distributors|retailers|sellers|vendors|contractors|consultants|advisors|experts|specialists|professionals|practitioners|technicians|operators|workers|employees|staff|personnel|workforce|labor|human|resources|capital|assets|investments|funds|finances|budget|costs|expenses|revenues|income|profits|earnings|returns|benefits|advantages|gains|losses|risks|threats|dangers|hazards|challenges|problems|issues|difficulties|obstacles|barriers|limitations|constraints|restrictions|requirements|conditions|terms|specifications|standards|criteria|guidelines|rules|regulations|policies|procedures|protocols|processes|methods|techniques|approaches|strategies|plans|programs|projects|initiatives|campaigns|efforts|activities|actions|operations|functions|services|products|goods|items|articles|objects|things|materials|substances|elements|components|ingredients|contents)$/.test(word)) {\n                score += 3;\n            }\n            // Bonus for words that appear multiple times (indicating importance)\n            const frequency = (text.toLowerCase().match(new RegExp(`\\\\b${word}\\\\b`, \"g\")) || []).length;\n            if (frequency > 1) score += frequency;\n            return {\n                word,\n                score\n            };\n        });\n        // Sort by score and return top words\n        const topWords = scoredWords.sort((a, b)=>b.score - a.score).slice(0, 10).map((item)=>item.word);\n        console.log(\"\\uD83D\\uDCDA Smart vocabulary extraction results:\", topWords);\n        return topWords;\n    }\n    determineCulturalContext(domain, text) {\n        // Determine cultural context based on domain and content\n        const culturalIndicators = {\n            \"bbc.com\": \"British English, UK culture\",\n            \"cnn.com\": \"American English, US culture\",\n            \"wikipedia.org\": \"International, encyclopedic\",\n            \"nytimes.com\": \"American English, US perspective\",\n            \"theguardian.com\": \"British English, UK perspective\"\n        };\n        if (culturalIndicators[domain]) {\n            return culturalIndicators[domain];\n        }\n        // Analyze text for cultural markers\n        const americanMarkers = [\n            \"dollar\",\n            \"president\",\n            \"congress\",\n            \"state\",\n            \"federal\"\n        ];\n        const britishMarkers = [\n            \"pound\",\n            \"minister\",\n            \"parliament\",\n            \"council\",\n            \"government\"\n        ];\n        const americanCount = americanMarkers.filter((marker)=>text.toLowerCase().includes(marker)).length;\n        const britishCount = britishMarkers.filter((marker)=>text.toLowerCase().includes(marker)).length;\n        if (americanCount > britishCount) {\n            return \"American English context\";\n        } else if (britishCount > americanCount) {\n            return \"British English context\";\n        }\n        return \"International context\";\n    }\n    generateLearningObjectives(contentType, topics, level) {\n        const objectives = [];\n        // Base objectives on content type\n        switch(contentType){\n            case \"news\":\n                objectives.push(\"Understand current events vocabulary\");\n                objectives.push(\"Practice reading news articles\");\n                break;\n            case \"blog\":\n                objectives.push(\"Learn informal writing style\");\n                objectives.push(\"Understand personal opinions and experiences\");\n                break;\n            case \"tutorial\":\n                objectives.push(\"Follow step-by-step instructions\");\n                objectives.push(\"Learn technical vocabulary\");\n                break;\n            case \"encyclopedia\":\n                objectives.push(\"Understand factual information\");\n                objectives.push(\"Learn academic vocabulary\");\n                break;\n            default:\n                objectives.push(\"Improve reading comprehension\");\n                objectives.push(\"Expand vocabulary knowledge\");\n        }\n        // Add topic-specific objectives\n        topics.slice(0, 2).forEach((topic)=>{\n            objectives.push(`Discuss topics related to ${topic.toLowerCase()}`);\n        });\n        return objectives.slice(0, 4);\n    }\n    getAudienceLevel(cefrLevel) {\n        const levelMap = {\n            \"A1\": \"beginner\",\n            \"A2\": \"beginner\",\n            \"B1\": \"general\",\n            \"B2\": \"general\",\n            \"C1\": \"expert\"\n        };\n        return levelMap[cefrLevel] || \"general\";\n    }\n    // Enhanced fallback lesson generation with context\n    generateEnhancedFallbackLesson(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage, contentMetadata, structuredContent } = params;\n        console.log(\"\\uD83D\\uDD04 Generating enhanced fallback lesson with contextual warm-up...\");\n        // Use available context even in fallback\n        const topics = structuredContent?.headings?.map((h)=>h.text).slice(0, 3) || [];\n        const contentType = contentMetadata?.contentType || \"general\";\n        // Create mock content analysis for fallback warm-up generation\n        const mockContentAnalysis = {\n            topics: topics,\n            contentType: contentType,\n            sourceCountry: this.determineSourceCountry(contentMetadata?.domain || \"\"),\n            culturalContext: this.determineCulturalContext(contentMetadata?.domain || \"\", sourceText)\n        };\n        // Generate contextual warm-up questions even in fallback\n        const contextualWarmup = this.getContextualWarmupFallback(studentLevel, mockContentAnalysis, contentMetadata);\n        console.log(\"\\uD83D\\uDD25 Generated fallback contextual warm-up:\", contextualWarmup);\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: contextualWarmup,\n                vocabulary: this.extractContextualVocabulary(sourceText, studentLevel, topics),\n                reading: this.simplifyText(sourceText, studentLevel),\n                comprehension: this.getContextualComprehension(lessonType, studentLevel, topics),\n                dialoguePractice: this.generateTemplateDialoguePractice(topics[0] || \"this topic\", studentLevel, []),\n                dialogueFillGap: this.generateTemplateDialogueFillGap(topics[0] || \"this topic\", studentLevel, []),\n                discussion: this.getContextualDiscussion(lessonType, studentLevel, topics),\n                grammar: this.getTemplateGrammar(studentLevel),\n                pronunciation: this.getTemplatePronunciation(sourceText),\n                wrapup: this.getContextualWrapup(lessonType, topics)\n            }\n        };\n    }\n    getContextualWarmup(lessonType, studentLevel, topics, contentType) {\n        // Use the same contextual fallback logic\n        const mockAnalysis = {\n            topics: topics,\n            contentType: contentType,\n            sourceCountry: \"International\"\n        };\n        return this.getContextualWarmupFallback(studentLevel, mockAnalysis, {\n            title: topics[0] || \"Content\"\n        });\n    }\n    // Basic fallback for complete failures\n    generateBasicFallbackLesson(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage } = params;\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: [\n                    \"What do you already know about this topic?\",\n                    \"Have you had similar experiences?\",\n                    \"What would you like to learn?\"\n                ],\n                vocabulary: [],\n                reading: sourceText.substring(0, 400),\n                comprehension: [\n                    \"What is the main idea?\",\n                    \"What details can you identify?\"\n                ],\n                dialoguePractice: this.generateTemplateDialoguePractice(\"this topic\", studentLevel, []),\n                dialogueFillGap: this.generateTemplateDialogueFillGap(\"this topic\", studentLevel, []),\n                discussion: [\n                    \"What is your opinion?\",\n                    \"How would you handle this?\"\n                ],\n                grammar: this.getTemplateGrammar(studentLevel),\n                pronunciation: {\n                    word: \"example\",\n                    ipa: \"/ɪɡˈz\\xe6mpəl/\",\n                    practice: \"Practice saying example.\"\n                },\n                wrapup: [\n                    \"What did you learn?\",\n                    \"What needs more practice?\"\n                ]\n            }\n        };\n    }\n    extractContextualVocabulary(text, studentLevel, topics) {\n        const vocabulary = this.extractVocabulary(text, studentLevel);\n        // Enhance with topic context if available\n        if (topics.length > 0) {\n            return vocabulary.map((vocab, index)=>({\n                    ...vocab,\n                    context: index < topics.length ? `Related to ${topics[index].toLowerCase()}` : vocab.meaning\n                }));\n        }\n        return vocabulary;\n    }\n    getContextualComprehension(lessonType, studentLevel, topics) {\n        const baseQuestions = this.getTemplateComprehension(lessonType, studentLevel);\n        if (topics.length > 0) {\n            return [\n                `What is the main point about ${topics[0]?.toLowerCase()}?`,\n                `How does the text explain ${topics[1]?.toLowerCase() || \"the topic\"}?`,\n                \"What supporting details can you identify?\",\n                \"What conclusions can you draw from this information?\"\n            ];\n        }\n        return baseQuestions;\n    }\n    getContextualDiscussion(lessonType, studentLevel, topics) {\n        const baseQuestions = this.getTemplateDiscussion(lessonType, studentLevel);\n        if (topics.length > 0) {\n            return [\n                `What is your opinion about ${topics[0]?.toLowerCase()}?`,\n                `How would you apply this information about ${topics[1]?.toLowerCase() || \"this topic\"}?`,\n                `What are the implications of what you learned about ${topics[0]?.toLowerCase()}?`\n            ];\n        }\n        return baseQuestions;\n    }\n    getContextualWrapup(lessonType, topics) {\n        if (topics.length > 0) {\n            return [\n                `What new vocabulary did you learn about ${topics[0]?.toLowerCase()}?`,\n                `Which concepts about ${topics[1]?.toLowerCase() || \"this topic\"} need more practice?`,\n                \"How will you use this knowledge in real situations?\",\n                \"What questions do you still have about this content?\"\n            ];\n        }\n        return this.getTemplateWrapup(lessonType);\n    }\n    // Template dialogue generation methods\n    generateTemplateDialoguePractice(topic, studentLevel, vocabularyWords) {\n        const levelDialogues = {\n            \"A1\": {\n                instruction: \"Practice this simple conversation with your tutor:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `I want to learn about ${topic}.`\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `That's great! What do you already know about ${topic}?`\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"I know a little bit.\"\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `Let's explore ${topic} together.`\n                    }\n                ],\n                followUpQuestions: [\n                    `What interests you most about ${topic}?`,\n                    \"What would you like to know more about?\",\n                    \"How can this help you in daily life?\"\n                ]\n            },\n            \"A2\": {\n                instruction: \"Practice this conversation with your tutor:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `I've been reading about ${topic}. It's quite interesting.`\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What did you find most interesting about ${topic}?`\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"I learned some new things I didn't know before.\"\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `Can you share what you learned about ${topic}?`\n                    }\n                ],\n                followUpQuestions: [\n                    `How does ${topic} relate to your experience?`,\n                    \"What surprised you the most?\",\n                    \"Would you recommend this topic to others?\"\n                ]\n            },\n            \"B1\": {\n                instruction: \"Practice this discussion with your tutor:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `I've been thinking about ${topic} and its implications.`\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `That's a complex topic. What aspects of ${topic} interest you most?`\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"There are several factors to consider when discussing this.\"\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `Let's explore those factors. What do you think is most important about ${topic}?`\n                    }\n                ],\n                followUpQuestions: [\n                    `What are the advantages and disadvantages of ${topic}?`,\n                    \"How might this impact different groups of people?\",\n                    \"What solutions would you propose?\"\n                ]\n            },\n            \"B2\": {\n                instruction: \"Engage in this analytical discussion with your tutor:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `The complexity of ${topic} requires careful analysis of multiple perspectives.`\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `Excellent point. How do you think different stakeholders view ${topic}?`\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"Each perspective brings unique insights and challenges to consider.\"\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What evidence supports your analysis of ${topic}?`\n                    }\n                ],\n                followUpQuestions: [\n                    `How do cultural differences influence perspectives on ${topic}?`,\n                    \"What long-term consequences should we consider?\",\n                    \"How would you evaluate the effectiveness of current approaches?\"\n                ]\n            },\n            \"C1\": {\n                instruction: \"Participate in this sophisticated discourse with your tutor:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `The nuanced nature of ${topic} demands a multifaceted approach to understanding.`\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `Indeed. How do you reconcile the apparent contradictions within ${topic}?`\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"The paradoxes inherent in this subject reflect broader societal complexities.\"\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What theoretical frameworks best illuminate the intricacies of ${topic}?`\n                    }\n                ],\n                followUpQuestions: [\n                    `How do philosophical underpinnings shape our understanding of ${topic}?`,\n                    \"What paradigm shifts might be necessary for progress?\",\n                    \"How do you envision the evolution of thought regarding this matter?\"\n                ]\n            }\n        };\n        return levelDialogues[studentLevel] || levelDialogues[\"B1\"];\n    }\n    generateTemplateDialogueFillGap(topic, studentLevel, vocabularyWords) {\n        const levelGapDialogues = {\n            \"A1\": {\n                instruction: \"Fill in the gaps in this conversation:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `I _____ to learn about ${topic}.`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `That's great! What _____ you already know?`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"I know _____ little bit.\",\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `Let's _____ together.`,\n                        isGap: true\n                    }\n                ],\n                answers: [\n                    \"want\",\n                    \"do\",\n                    \"a\",\n                    \"learn\"\n                ]\n            },\n            \"A2\": {\n                instruction: \"Complete this conversation with the missing words:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `I've been _____ about ${topic}.`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What did you _____ most interesting?`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"I _____ some new things.\",\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `Can you _____ what you learned?`,\n                        isGap: true\n                    }\n                ],\n                answers: [\n                    \"reading\",\n                    \"find\",\n                    \"learned\",\n                    \"share\"\n                ]\n            },\n            \"B1\": {\n                instruction: \"Fill in the blanks to complete this discussion:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `I've been _____ about ${topic} and its implications.`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What _____ interest you most?`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"There are several _____ to consider.\",\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What do you think is most _____ ?`,\n                        isGap: true\n                    }\n                ],\n                answers: [\n                    \"thinking\",\n                    \"aspects\",\n                    \"factors\",\n                    \"important\"\n                ]\n            },\n            \"B2\": {\n                instruction: \"Complete this analytical discussion:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `The _____ of ${topic} requires careful analysis.`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `How do different _____ view this topic?`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"Each perspective brings unique _____ .\",\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What _____ supports your analysis?`,\n                        isGap: true\n                    }\n                ],\n                answers: [\n                    \"complexity\",\n                    \"stakeholders\",\n                    \"insights\",\n                    \"evidence\"\n                ]\n            },\n            \"C1\": {\n                instruction: \"Fill in the sophisticated vocabulary:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `The _____ nature of ${topic} demands a multifaceted approach.`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `How do you _____ the apparent contradictions?`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"The _____ reflect broader complexities.\",\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What theoretical _____ best illuminate this?`,\n                        isGap: true\n                    }\n                ],\n                answers: [\n                    \"nuanced\",\n                    \"reconcile\",\n                    \"paradoxes\",\n                    \"frameworks\"\n                ]\n            }\n        };\n        return levelGapDialogues[studentLevel] || levelGapDialogues[\"B1\"];\n    }\n    constructor(){\n        this.googleAI = null;\n        this.progressiveGenerator = null;\n    }\n}\nconst lessonAIServerGenerator = new LessonAIServerGenerator();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvbGVzc29uLWFpLWdlbmVyYXRvci1zZXJ2ZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBZ0U7QUFDc0M7QUFDaEM7QUFnRS9ELE1BQU1HO0lBSUhDLGNBQWM7UUFDcEIsSUFBSSxDQUFDLElBQUksQ0FBQ0MsUUFBUSxFQUFFO1lBQ2xCLElBQUksQ0FBQ0EsUUFBUSxHQUFHTCw4RUFBMkJBO1FBQzdDO1FBQ0EsT0FBTyxJQUFJLENBQUNLLFFBQVE7SUFDdEI7SUFFUUMsMEJBQTBCO1FBQ2hDLElBQUksQ0FBQyxJQUFJLENBQUNDLG9CQUFvQixFQUFFO1lBQzlCLElBQUksQ0FBQ0Esb0JBQW9CLEdBQUcsSUFBSU4sNEVBQXdCQTtRQUMxRDtRQUNBLE9BQU8sSUFBSSxDQUFDTSxvQkFBb0I7SUFDbEM7SUFFQSwrQ0FBK0M7SUFDL0MsTUFBY0MseUJBQXlCQyxVQUFrQixFQUFFQyxZQUFvQixFQUFFQyxjQUFzQixFQUFtQjtRQUN4SCxJQUFJO1lBQ0YsTUFBTUMsZ0JBQWdCO2dCQUNwQixNQUFNO2dCQUNOLE1BQU07Z0JBQ04sTUFBTTtnQkFDTixNQUFNO2dCQUNOLE1BQU07WUFDUjtZQUVBLE1BQU1DLFdBQVdELGFBQWEsQ0FBQ0YsYUFBYSxJQUFJRSxhQUFhLENBQUMsS0FBSztZQUVuRSxNQUFNRSxTQUFTLENBQUMsdUNBQXVDLEVBQUVKLGFBQWEsT0FBTyxFQUFFQyxlQUFlOztBQUVwRyxFQUFFRixXQUFXTSxTQUFTLENBQUMsR0FBRyxNQUFNOzs7RUFHOUIsRUFBRUYsU0FBUzs7O2lDQUdvQixFQUFFSCxhQUFhOzs7OzsyQ0FLTCxDQUFDO1lBRXRDTSxRQUFRQyxHQUFHLENBQUMsMkNBQWlDSCxPQUFPSSxNQUFNLEVBQUU7WUFDNUQsTUFBTUMsV0FBVyxNQUFNLElBQUksQ0FBQ2YsV0FBVyxHQUFHVSxNQUFNLENBQUNBO1lBRWpELE9BQU9LLFNBQVNDLElBQUksTUFBTVgsV0FBV00sU0FBUyxDQUFDLEdBQUc7UUFDcEQsRUFBRSxPQUFP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QUFpQixDQUFDcFUsYUFBK0MsSUFBSW9VLGlCQUFpQixDQUFDLEtBQUs7SUFDckc7O2FBL3VEUXpVLFdBQWtFO2FBQ2xFRSx1QkFBd0Q7O0FBK3VEbEU7QUFFTyxNQUFNMFUsMEJBQTBCLElBQUk5VSwwQkFBeUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL2xlc3Nvbi1haS1nZW5lcmF0b3Itc2VydmVyLnRzPzBiYjEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlR29vZ2xlQUlTZXJ2ZXJTZXJ2aWNlIH0gZnJvbSBcIi4vZ29vZ2xlLWFpLXNlcnZlclwiXHJcbmltcG9ydCB7IFByb2dyZXNzaXZlR2VuZXJhdG9ySW1wbCwgdHlwZSBDRUZSTGV2ZWwsIHR5cGUgTGVzc29uU2VjdGlvbiB9IGZyb20gXCIuL3Byb2dyZXNzaXZlLWdlbmVyYXRvclwiXHJcbmltcG9ydCB7IHVzYWdlTW9uaXRvciwgdHlwZSBHZW5lcmF0aW9uQ29udGV4dCB9IGZyb20gXCIuL3VzYWdlLW1vbml0b3JcIlxyXG5cclxuaW50ZXJmYWNlIExlc3NvbkdlbmVyYXRpb25QYXJhbXMge1xyXG4gIHNvdXJjZVRleHQ6IHN0cmluZ1xyXG4gIGxlc3NvblR5cGU6IHN0cmluZ1xyXG4gIHN0dWRlbnRMZXZlbDogc3RyaW5nXHJcbiAgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZ1xyXG4gIHNvdXJjZVVybD86IHN0cmluZ1xyXG4gIGNvbnRlbnRNZXRhZGF0YT86IHtcclxuICAgIHRpdGxlPzogc3RyaW5nXHJcbiAgICBkZXNjcmlwdGlvbj86IHN0cmluZ1xyXG4gICAgYXV0aG9yPzogc3RyaW5nXHJcbiAgICBwdWJsaXNoRGF0ZT86IHN0cmluZ1xyXG4gICAgY29udGVudFR5cGU/OiBzdHJpbmdcclxuICAgIGRvbWFpbj86IHN0cmluZ1xyXG4gICAgbGFuZ3VhZ2U/OiBzdHJpbmdcclxuICAgIGtleXdvcmRzPzogc3RyaW5nW11cclxuICB9XHJcbiAgc3RydWN0dXJlZENvbnRlbnQ/OiB7XHJcbiAgICBoZWFkaW5ncz86IEFycmF5PHsgbGV2ZWw6IG51bWJlcjsgdGV4dDogc3RyaW5nIH0+XHJcbiAgICBwYXJhZ3JhcGhzPzogc3RyaW5nW11cclxuICAgIGxpc3RzPzogQXJyYXk8eyB0eXBlOiBzdHJpbmc7IGl0ZW1zOiBzdHJpbmdbXSB9PlxyXG4gICAgcXVvdGVzPzogc3RyaW5nW11cclxuICAgIGltYWdlcz86IEFycmF5PHsgYWx0OiBzdHJpbmc7IHNyYzogc3RyaW5nIH0+XHJcbiAgICBsaW5rcz86IEFycmF5PHsgdGV4dDogc3RyaW5nOyB1cmw6IHN0cmluZyB9PlxyXG4gIH1cclxuICB3b3JkQ291bnQ/OiBudW1iZXJcclxuICByZWFkaW5nVGltZT86IG51bWJlclxyXG59XHJcblxyXG5pbnRlcmZhY2UgR2VuZXJhdGVkTGVzc29uIHtcclxuICBsZXNzb25UeXBlOiBzdHJpbmdcclxuICBzdHVkZW50TGV2ZWw6IHN0cmluZ1xyXG4gIHRhcmdldExhbmd1YWdlOiBzdHJpbmdcclxuICBzZWN0aW9uczoge1xyXG4gICAgd2FybXVwOiBzdHJpbmdbXVxyXG4gICAgdm9jYWJ1bGFyeTogQXJyYXk8eyB3b3JkOiBzdHJpbmc7IG1lYW5pbmc6IHN0cmluZzsgZXhhbXBsZTogc3RyaW5nIH0+XHJcbiAgICByZWFkaW5nOiBzdHJpbmdcclxuICAgIGNvbXByZWhlbnNpb246IHN0cmluZ1tdXHJcbiAgICBkaXNjdXNzaW9uOiBzdHJpbmdbXVxyXG4gICAgZGlhbG9ndWVQcmFjdGljZToge1xyXG4gICAgICBpbnN0cnVjdGlvbjogc3RyaW5nXHJcbiAgICAgIGRpYWxvZ3VlOiBBcnJheTx7IGNoYXJhY3Rlcjogc3RyaW5nOyBsaW5lOiBzdHJpbmcgfT5cclxuICAgICAgZm9sbG93VXBRdWVzdGlvbnM6IHN0cmluZ1tdXHJcbiAgICB9XHJcbiAgICBkaWFsb2d1ZUZpbGxHYXA6IHtcclxuICAgICAgaW5zdHJ1Y3Rpb246IHN0cmluZ1xyXG4gICAgICBkaWFsb2d1ZTogQXJyYXk8eyBjaGFyYWN0ZXI6IHN0cmluZzsgbGluZTogc3RyaW5nOyBpc0dhcD86IGJvb2xlYW4gfT5cclxuICAgICAgYW5zd2Vyczogc3RyaW5nW11cclxuICAgIH1cclxuICAgIGdyYW1tYXI6IHtcclxuICAgICAgZm9jdXM6IHN0cmluZ1xyXG4gICAgICBleGFtcGxlczogc3RyaW5nW11cclxuICAgICAgZXhlcmNpc2U6IHN0cmluZ1tdXHJcbiAgICB9XHJcbiAgICBwcm9udW5jaWF0aW9uOiB7XHJcbiAgICAgIHdvcmQ6IHN0cmluZ1xyXG4gICAgICBpcGE6IHN0cmluZ1xyXG4gICAgICBwcmFjdGljZTogc3RyaW5nXHJcbiAgICB9XHJcbiAgICB3cmFwdXA6IHN0cmluZ1tdXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgTGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3Ige1xyXG4gIHByaXZhdGUgZ29vZ2xlQUk6IFJldHVyblR5cGU8dHlwZW9mIGNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZT4gfCBudWxsID0gbnVsbFxyXG4gIHByaXZhdGUgcHJvZ3Jlc3NpdmVHZW5lcmF0b3I6IFByb2dyZXNzaXZlR2VuZXJhdG9ySW1wbCB8IG51bGwgPSBudWxsXHJcblxyXG4gIHByaXZhdGUgZ2V0R29vZ2xlQUkoKSB7XHJcbiAgICBpZiAoIXRoaXMuZ29vZ2xlQUkpIHtcclxuICAgICAgdGhpcy5nb29nbGVBSSA9IGNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZSgpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5nb29nbGVBSVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRQcm9ncmVzc2l2ZUdlbmVyYXRvcigpIHtcclxuICAgIGlmICghdGhpcy5wcm9ncmVzc2l2ZUdlbmVyYXRvcikge1xyXG4gICAgICB0aGlzLnByb2dyZXNzaXZlR2VuZXJhdG9yID0gbmV3IFByb2dyZXNzaXZlR2VuZXJhdG9ySW1wbCgpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5wcm9ncmVzc2l2ZUdlbmVyYXRvclxyXG4gIH1cclxuXHJcbiAgLy8gU3VtbWFyaXplIGFuZCBhZGFwdCBjb250ZW50IHRvIHN0dWRlbnQgbGV2ZWxcclxuICBwcml2YXRlIGFzeW5jIHN1bW1hcml6ZUFuZEFkYXB0Q29udGVudChzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nLCB0YXJnZXRMYW5ndWFnZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGxldmVsR3VpZGFuY2UgPSB7XHJcbiAgICAgICAgJ0ExJzogJ1VzZSB2ZXJ5IHNpbXBsZSB2b2NhYnVsYXJ5LCBwcmVzZW50IHRlbnNlLCBzaG9ydCBzZW50ZW5jZXMgKDUtOCB3b3JkcykuIEV4cGxhaW4gYmFzaWMgY29uY2VwdHMgY2xlYXJseS4nLFxyXG4gICAgICAgICdBMic6ICdVc2Ugc2ltcGxlIHZvY2FidWxhcnksIGJhc2ljIHBhc3QvcHJlc2VudCB0ZW5zZSwgbWVkaXVtIHNlbnRlbmNlcyAoOC0xMiB3b3JkcykuIEluY2x1ZGUgZmFtaWxpYXIgdG9waWNzLicsXHJcbiAgICAgICAgJ0IxJzogJ1VzZSBpbnRlcm1lZGlhdGUgdm9jYWJ1bGFyeSwgdmFyaW91cyB0ZW5zZXMsIGxvbmdlciBzZW50ZW5jZXMgKDEyLTE1IHdvcmRzKS4gSW5jbHVkZSBvcGluaW9ucyBhbmQgZXhwbGFuYXRpb25zLicsXHJcbiAgICAgICAgJ0IyJzogJ1VzZSBhZHZhbmNlZCB2b2NhYnVsYXJ5LCBjb21wbGV4IHNlbnRlbmNlcywgYWJzdHJhY3QgY29uY2VwdHMuIEluY2x1ZGUgZGV0YWlsZWQgZXhwbGFuYXRpb25zIGFuZCBhbmFseXNpcy4nLFxyXG4gICAgICAgICdDMSc6ICdVc2Ugc29waGlzdGljYXRlZCB2b2NhYnVsYXJ5LCBjb21wbGV4IHN0cnVjdHVyZXMsIG51YW5jZWQgaWRlYXMuIEluY2x1ZGUgY3VsdHVyYWwgYW5kIGNvbnRleHR1YWwgZGVwdGguJ1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBndWlkYW5jZSA9IGxldmVsR3VpZGFuY2Vbc3R1ZGVudExldmVsXSB8fCBsZXZlbEd1aWRhbmNlWydCMSddXHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBwcm9tcHQgPSBgU3VtbWFyaXplIGFuZCByZXdyaXRlIHRoaXMgY29udGVudCBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsICR7dGFyZ2V0TGFuZ3VhZ2V9IHN0dWRlbnRzOlxyXG5cclxuJHtzb3VyY2VUZXh0LnN1YnN0cmluZygwLCAxMDAwKX1cclxuXHJcblJFUVVJUkVNRU5UUzpcclxuLSAke2d1aWRhbmNlfVxyXG4tIEtlZXAgYWxsIGltcG9ydGFudCBpbmZvcm1hdGlvbiBhbmQga2V5IGNvbmNlcHRzXHJcbi0gTWFrZSBpdCAyMDAtNDAwIHdvcmRzIChhcHByb3ByaWF0ZSBsZW5ndGggZm9yIHJlYWRpbmcpXHJcbi0gVXNlIHZvY2FidWxhcnkgYXBwcm9wcmlhdGUgZm9yICR7c3R1ZGVudExldmVsfSBsZXZlbFxyXG4tIE1haW50YWluIHRoZSBtYWluIGlkZWFzIGJ1dCBzaW1wbGlmeSBjb21wbGV4IGxhbmd1YWdlXHJcbi0gSW5jbHVkZSBzcGVjaWZpYyBkZXRhaWxzIGFuZCBleGFtcGxlc1xyXG4tIE1ha2UgaXQgZW5nYWdpbmcgYW5kIGVkdWNhdGlvbmFsXHJcblxyXG5SZXdyaXRlIHRoZSBjb250ZW50IGNsZWFybHkgYW5kIGNvbXBsZXRlbHk6YFxyXG5cclxuICAgICAgY29uc29sZS5sb2coXCLwn5OdIENvbnRlbnQgYWRhcHRhdGlvbiBwcm9tcHQ6XCIsIHByb21wdC5sZW5ndGgsIFwiY2hhcnNcIilcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcclxuICAgICAgXHJcbiAgICAgIHJldHVybiByZXNwb25zZS50cmltKCkgfHwgc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgNDAwKVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5sb2coXCLimqDvuI8gQ29udGVudCBhZGFwdGF0aW9uIGZhaWxlZCwgdXNpbmcgb3JpZ2luYWwgdGV4dFwiKVxyXG4gICAgICByZXR1cm4gc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgNDAwKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZ2VuZXJhdGVMZXNzb24ocGFyYW1zOiBMZXNzb25HZW5lcmF0aW9uUGFyYW1zKTogUHJvbWlzZTxHZW5lcmF0ZWRMZXNzb24+IHtcclxuICAgIGNvbnN0IHtcclxuICAgICAgc291cmNlVGV4dCxcclxuICAgICAgbGVzc29uVHlwZSxcclxuICAgICAgc3R1ZGVudExldmVsLFxyXG4gICAgICB0YXJnZXRMYW5ndWFnZSxcclxuICAgICAgc291cmNlVXJsLFxyXG4gICAgICBjb250ZW50TWV0YWRhdGEsXHJcbiAgICAgIHN0cnVjdHVyZWRDb250ZW50LFxyXG4gICAgICB3b3JkQ291bnQsXHJcbiAgICAgIHJlYWRpbmdUaW1lXHJcbiAgICB9ID0gcGFyYW1zXHJcblxyXG4gICAgLy8gQ3JlYXRlIHVzYWdlIG1vbml0b3JpbmcgY29udGV4dFxyXG4gICAgY29uc3QgZ2VuZXJhdGlvbkNvbnRleHQ6IEdlbmVyYXRpb25Db250ZXh0ID0ge1xyXG4gICAgICBsZXNzb25JZDogYGxlc3Nvbl8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWAsXHJcbiAgICAgIGxlc3NvblR5cGUsXHJcbiAgICAgIGRpZmZpY3VsdHlMZXZlbDogc3R1ZGVudExldmVsLFxyXG4gICAgICBjb250ZW50TGVuZ3RoOiBzb3VyY2VUZXh0Lmxlbmd0aCxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFZhbGlkYXRlIHNvdXJjZVRleHRcclxuICAgIGlmICghc291cmNlVGV4dCB8fCB0eXBlb2Ygc291cmNlVGV4dCAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBzb3VyY2VUZXh0OiBtdXN0IGJlIGEgbm9uLWVtcHR5IHN0cmluZ1wiKVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnNvbGUubG9nKFwi8J+agCBTdGFydGluZyBsZXNzb24gZ2VuZXJhdGlvbiB3aXRoIHBhcmFtczpcIiwge1xyXG4gICAgICB0ZXh0TGVuZ3RoOiBzb3VyY2VUZXh0Lmxlbmd0aCxcclxuICAgICAgbGVzc29uVHlwZSxcclxuICAgICAgc3R1ZGVudExldmVsLFxyXG4gICAgICB0YXJnZXRMYW5ndWFnZSxcclxuICAgICAgaGFzTWV0YWRhdGE6ICEhY29udGVudE1ldGFkYXRhLFxyXG4gICAgICBoYXNTdHJ1Y3R1cmVkQ29udGVudDogISFzdHJ1Y3R1cmVkQ29udGVudFxyXG4gICAgfSlcclxuXHJcblxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIFN0ZXAgMTogU3VtbWFyaXplIGFuZCBhZGFwdCBjb250ZW50IHRvIHN0dWRlbnQgbGV2ZWxcclxuICAgICAgY29uc29sZS5sb2coXCLwn5OdIFN0ZXAgMTogU3VtbWFyaXppbmcgYW5kIGFkYXB0aW5nIGNvbnRlbnQgdG8gc3R1ZGVudCBsZXZlbC4uLlwiKVxyXG4gICAgICBjb25zdCBhZGFwdGF0aW9uU3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgY29uc3QgYWRhcHRlZENvbnRlbnQgPSBhd2FpdCB0aGlzLnN1bW1hcml6ZUFuZEFkYXB0Q29udGVudChzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwsIHRhcmdldExhbmd1YWdlKVxyXG4gICAgICBjb25zdCBhZGFwdGF0aW9uRW5kVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBMb2cgY29udGVudCBhZGFwdGF0aW9uIHVzYWdlXHJcbiAgICAgIHVzYWdlTW9uaXRvci5sb2dUb2tlblVzYWdlKFxyXG4gICAgICAgICdjb250ZW50LWFkYXB0YXRpb24nLFxyXG4gICAgICAgIE1hdGguY2VpbChzb3VyY2VUZXh0Lmxlbmd0aCAvIDQpLCAvLyBSb3VnaCB0b2tlbiBlc3RpbWF0ZVxyXG4gICAgICAgICdjb250ZW50LXN1bW1hcml6YXRpb24nLFxyXG4gICAgICAgIGdlbmVyYXRpb25Db250ZXh0XHJcbiAgICAgICk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zb2xlLmxvZyhcIuKchSBDb250ZW50IGFkYXB0ZWQ6XCIsIGFkYXB0ZWRDb250ZW50Lmxlbmd0aCwgXCJjaGFyc1wiKVxyXG5cclxuICAgICAgLy8gU3RlcCAyOiBHZW5lcmF0ZSBsZXNzb24gd2l0aCBhZGFwdGVkIGNvbnRlbnRcclxuICAgICAgY29uc29sZS5sb2coXCLwn6SWIFN0ZXAgMjogR2VuZXJhdGluZyBsZXNzb24gd2l0aCBhZGFwdGVkIGNvbnRlbnQuLi5cIilcclxuICAgICAgY29uc3QgbGVzc29uR2VuZXJhdGlvblN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgIGNvbnN0IGxlc3NvblN0cnVjdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVNaW5pbWFsQUlMZXNzb24oXHJcbiAgICAgICAgYWRhcHRlZENvbnRlbnQsXHJcbiAgICAgICAgbGVzc29uVHlwZSxcclxuICAgICAgICBzdHVkZW50TGV2ZWwsXHJcbiAgICAgICAgdGFyZ2V0TGFuZ3VhZ2UsXHJcbiAgICAgICAgY29udGVudE1ldGFkYXRhXHJcbiAgICAgIClcclxuICAgICAgY29uc3QgbGVzc29uR2VuZXJhdGlvbkVuZFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICBcclxuICAgICAgLy8gTG9nIGxlc3NvbiBnZW5lcmF0aW9uIHVzYWdlXHJcbiAgICAgIHVzYWdlTW9uaXRvci5sb2dUb2tlblVzYWdlKFxyXG4gICAgICAgICdsZXNzb24tc3RydWN0dXJlLWdlbmVyYXRpb24nLFxyXG4gICAgICAgIE1hdGguY2VpbChhZGFwdGVkQ29udGVudC5sZW5ndGggLyAzKSwgLy8gUm91Z2ggdG9rZW4gZXN0aW1hdGUgZm9yIGxlc3NvbiBnZW5lcmF0aW9uXHJcbiAgICAgICAgJ3N0cnVjdHVyZWQtZ2VuZXJhdGlvbicsXHJcbiAgICAgICAgZ2VuZXJhdGlvbkNvbnRleHRcclxuICAgICAgKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnNvbGUubG9nKFwi4pyFIE1pbmltYWwgQUkgbGVzc29uIGdlbmVyYXRlZDpcIiwgT2JqZWN0LmtleXMobGVzc29uU3RydWN0dXJlKSlcclxuXHJcbiAgICAgIC8vIFJldHVybiBwcm9wZXJseSBzdHJ1Y3R1cmVkIEdlbmVyYXRlZExlc3NvbiBvYmplY3RcclxuICAgICAgY29uc3QgZmluYWxMZXNzb246IEdlbmVyYXRlZExlc3NvbiA9IHtcclxuICAgICAgICBsZXNzb25UeXBlLFxyXG4gICAgICAgIHN0dWRlbnRMZXZlbCxcclxuICAgICAgICB0YXJnZXRMYW5ndWFnZSxcclxuICAgICAgICBzZWN0aW9uczogbGVzc29uU3RydWN0dXJlXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+OryBSZXR1cm5pbmcgQUktZ2VuZXJhdGVkIGxlc3NvbjpcIiwge1xyXG4gICAgICAgIGxlc3NvblR5cGU6IGZpbmFsTGVzc29uLmxlc3NvblR5cGUsXHJcbiAgICAgICAgc3R1ZGVudExldmVsOiBmaW5hbExlc3Nvbi5zdHVkZW50TGV2ZWwsXHJcbiAgICAgICAgdGFyZ2V0TGFuZ3VhZ2U6IGZpbmFsTGVzc29uLnRhcmdldExhbmd1YWdlLFxyXG4gICAgICAgIHNlY3Rpb25zQ291bnQ6IE9iamVjdC5rZXlzKGZpbmFsTGVzc29uLnNlY3Rpb25zKS5sZW5ndGgsXHJcbiAgICAgICAgd2FybXVwQ291bnQ6IGZpbmFsTGVzc29uLnNlY3Rpb25zLndhcm11cD8ubGVuZ3RoIHx8IDAsXHJcbiAgICAgICAgdm9jYWJ1bGFyeUNvdW50OiBmaW5hbExlc3Nvbi5zZWN0aW9ucy52b2NhYnVsYXJ5Py5sZW5ndGggfHwgMFxyXG4gICAgICB9KVxyXG5cclxuICAgICAgY29uc29sZS5sb2coXCLwn46JIE9wdGltaXplZCBBSSBsZXNzb24gZ2VuZXJhdGlvbiBjb21wbGV0ZSFcIilcclxuICAgICAgcmV0dXJuIGZpbmFsTGVzc29uXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAvLyBMb2cgZXJyb3IgdG8gdXNhZ2UgbW9uaXRvclxyXG4gICAgICB1c2FnZU1vbml0b3IubG9nRXJyb3IoZXJyb3IgYXMgRXJyb3IsICdMRVNTT05fR0VORVJBVElPTl9GQUlMRUQnLCBnZW5lcmF0aW9uQ29udGV4dCk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zb2xlLmVycm9yKFwi4p2MIEVycm9yIGluIEFJIGxlc3NvbiBnZW5lcmF0aW9uOlwiLCBlcnJvcilcclxuICAgICAgdGhyb3cgZXJyb3JcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIFByb2dyZXNzaXZlIEFJIGxlc3NvbiBnZW5lcmF0aW9uIHdpdGggc2hhcmVkIGNvbnRleHRcclxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlTWluaW1hbEFJTGVzc29uKFxyXG4gICAgc291cmNlVGV4dDogc3RyaW5nLFxyXG4gICAgbGVzc29uVHlwZTogc3RyaW5nLFxyXG4gICAgc3R1ZGVudExldmVsOiBzdHJpbmcsXHJcbiAgICB0YXJnZXRMYW5ndWFnZTogc3RyaW5nLFxyXG4gICAgbWV0YWRhdGE/OiBhbnlcclxuICApIHtcclxuICAgIGNvbnNvbGUubG9nKFwi8J+OryBVc2luZyBwcm9ncmVzc2l2ZSBnZW5lcmF0aW9uIHdpdGggc2hhcmVkIGNvbnRleHQuLi5cIilcclxuXHJcbiAgICBjb25zdCBwcm9ncmVzc2l2ZUdlbiA9IHRoaXMuZ2V0UHJvZ3Jlc3NpdmVHZW5lcmF0b3IoKVxyXG5cclxuICAgIC8vIFN0ZXAgMTogQnVpbGQgc2hhcmVkIGNvbnRleHQgZm9yIGFsbCBzZWN0aW9uc1xyXG4gICAgY29uc29sZS5sb2coXCLwn4+X77iPIEJ1aWxkaW5nIHNoYXJlZCBjb250ZXh0Li4uXCIpXHJcbiAgICBjb25zdCBzaGFyZWRDb250ZXh0ID0gYXdhaXQgcHJvZ3Jlc3NpdmVHZW4uYnVpbGRTaGFyZWRDb250ZXh0KFxyXG4gICAgICBzb3VyY2VUZXh0LFxyXG4gICAgICBsZXNzb25UeXBlLFxyXG4gICAgICBzdHVkZW50TGV2ZWwgYXMgQ0VGUkxldmVsLFxyXG4gICAgICB0YXJnZXRMYW5ndWFnZVxyXG4gICAgKVxyXG5cclxuICAgIC8vIFN0ZXAgMjogRGVmaW5lIGxlc3NvbiBzZWN0aW9ucyB3aXRoIGRlcGVuZGVuY2llc1xyXG4gICAgY29uc3QgbGVzc29uU2VjdGlvbnM6IExlc3NvblNlY3Rpb25bXSA9IFtcclxuICAgICAgeyBuYW1lOiAnd2FybXVwJywgcHJpb3JpdHk6IDEsIGRlcGVuZGVuY2llczogW10gfSxcclxuICAgICAgeyBuYW1lOiAndm9jYWJ1bGFyeScsIHByaW9yaXR5OiAyLCBkZXBlbmRlbmNpZXM6IFtdIH0sXHJcbiAgICAgIHsgbmFtZTogJ3JlYWRpbmcnLCBwcmlvcml0eTogMywgZGVwZW5kZW5jaWVzOiBbJ3ZvY2FidWxhcnknXSB9LFxyXG4gICAgICB7IG5hbWU6ICdjb21wcmVoZW5zaW9uJywgcHJpb3JpdHk6IDQsIGRlcGVuZGVuY2llczogWydyZWFkaW5nJ10gfSxcclxuICAgICAgeyBuYW1lOiAnZGlzY3Vzc2lvbicsIHByaW9yaXR5OiA1LCBkZXBlbmRlbmNpZXM6IFsncmVhZGluZycsICdjb21wcmVoZW5zaW9uJ10gfSxcclxuICAgICAgeyBuYW1lOiAnZ3JhbW1hcicsIHByaW9yaXR5OiA2LCBkZXBlbmRlbmNpZXM6IFsncmVhZGluZyddIH0sXHJcbiAgICAgIHsgbmFtZTogJ3Byb251bmNpYXRpb24nLCBwcmlvcml0eTogNywgZGVwZW5kZW5jaWVzOiBbJ3ZvY2FidWxhcnknXSB9LFxyXG4gICAgICB7IG5hbWU6ICd3cmFwdXAnLCBwcmlvcml0eTogOCwgZGVwZW5kZW5jaWVzOiBbJ2Rpc2N1c3Npb24nXSB9XHJcbiAgICBdXHJcblxyXG4gICAgLy8gU3RlcCAzOiBHZW5lcmF0ZSBzZWN0aW9ucyBwcm9ncmVzc2l2ZWx5XHJcbiAgICBjb25zdCBnZW5lcmF0ZWRTZWN0aW9ucyA9IFtdXHJcbiAgICBsZXQgY3VycmVudENvbnRleHQgPSBzaGFyZWRDb250ZXh0XHJcblxyXG4gICAgZm9yIChjb25zdCBzZWN0aW9uIG9mIGxlc3NvblNlY3Rpb25zKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDwn5SEIEdlbmVyYXRpbmcgc2VjdGlvbjogJHtzZWN0aW9uLm5hbWV9YClcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGdlbmVyYXRlZFNlY3Rpb24gPSBhd2FpdCBwcm9ncmVzc2l2ZUdlbi5nZW5lcmF0ZVNlY3Rpb24oXHJcbiAgICAgICAgc2VjdGlvbixcclxuICAgICAgICBjdXJyZW50Q29udGV4dCxcclxuICAgICAgICBnZW5lcmF0ZWRTZWN0aW9uc1xyXG4gICAgICApXHJcbiAgICAgIFxyXG4gICAgICBnZW5lcmF0ZWRTZWN0aW9ucy5wdXNoKGdlbmVyYXRlZFNlY3Rpb24pXHJcbiAgICAgIFxyXG4gICAgICAvLyBVcGRhdGUgY29udGV4dCB3aXRoIG5ldyBzZWN0aW9uIGluZm9ybWF0aW9uXHJcbiAgICAgIGN1cnJlbnRDb250ZXh0ID0gcHJvZ3Jlc3NpdmVHZW4udXBkYXRlQ29udGV4dChjdXJyZW50Q29udGV4dCwgZ2VuZXJhdGVkU2VjdGlvbilcclxuICAgIH1cclxuXHJcbiAgICAvLyBTdGVwIDQ6IEdlbmVyYXRlIGRpYWxvZ3VlIHNlY3Rpb25zIHVzaW5nIHRlbXBsYXRlIG1ldGhvZHNcclxuICAgIGNvbnN0IHZvY2FidWxhcnlXb3JkcyA9IGdlbmVyYXRlZFNlY3Rpb25zXHJcbiAgICAgIC5maW5kKHMgPT4gcy5zZWN0aW9uTmFtZSA9PT0gJ3ZvY2FidWxhcnknKT8uY29udGVudFxyXG4gICAgICA/LmZpbHRlcigoaXRlbTogYW55KSA9PiBpdGVtLndvcmQgIT09ICdJTlNUUlVDVElPTicpXHJcbiAgICAgID8ubWFwKChpdGVtOiBhbnkpID0+IGl0ZW0ud29yZCkgfHwgW11cclxuXHJcbiAgICBjb25zdCBtYWluVG9waWMgPSBzaGFyZWRDb250ZXh0Lm1haW5UaGVtZXNbMF0gfHwgJ3RoaXMgdG9waWMnXHJcbiAgICBjb25zdCBkaWFsb2d1ZVByYWN0aWNlID0gdGhpcy5nZW5lcmF0ZVRlbXBsYXRlRGlhbG9ndWVQcmFjdGljZShtYWluVG9waWMsIHN0dWRlbnRMZXZlbCwgdm9jYWJ1bGFyeVdvcmRzKVxyXG4gICAgY29uc3QgZGlhbG9ndWVGaWxsR2FwID0gdGhpcy5nZW5lcmF0ZVRlbXBsYXRlRGlhbG9ndWVGaWxsR2FwKG1haW5Ub3BpYywgc3R1ZGVudExldmVsLCB2b2NhYnVsYXJ5V29yZHMpXHJcblxyXG4gICAgLy8gU3RlcCA1OiBBc3NlbWJsZSBmaW5hbCBsZXNzb24gc3RydWN0dXJlXHJcbiAgICBjb25zdCBsZXNzb25TdHJ1Y3R1cmU6IGFueSA9IHt9XHJcbiAgICBcclxuICAgIGZvciAoY29uc3Qgc2VjdGlvbiBvZiBnZW5lcmF0ZWRTZWN0aW9ucykge1xyXG4gICAgICBsZXNzb25TdHJ1Y3R1cmVbc2VjdGlvbi5zZWN0aW9uTmFtZV0gPSBzZWN0aW9uLmNvbnRlbnRcclxuICAgIH1cclxuXHJcbiAgICBsZXNzb25TdHJ1Y3R1cmUuZGlhbG9ndWVQcmFjdGljZSA9IGRpYWxvZ3VlUHJhY3RpY2VcclxuICAgIGxlc3NvblN0cnVjdHVyZS5kaWFsb2d1ZUZpbGxHYXAgPSBkaWFsb2d1ZUZpbGxHYXBcclxuXHJcbiAgICBjb25zb2xlLmxvZyhcIuKchSBQcm9ncmVzc2l2ZSBsZXNzb24gZ2VuZXJhdGlvbiBjb21wbGV0ZSFcIilcclxuICAgIHJldHVybiBsZXNzb25TdHJ1Y3R1cmVcclxuICB9XHJcblxyXG4gIC8vIFVsdHJhLW1pbmltYWwgd2FybXVwIGdlbmVyYXRpb25cclxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlTWluaW1hbFdhcm11cChzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gICAgLy8gRXh0cmFjdCBiZXR0ZXIgY29udGV4dCBmb3IgdG9waWMgaWRlbnRpZmljYXRpb25cclxuICAgIGNvbnN0IHRvcGljcyA9IHRoaXMuZXh0cmFjdEJldHRlclRvcGljcyhzb3VyY2VUZXh0KVxyXG4gICAgY29uc3QgbWFpblRvcGljID0gdG9waWNzWzBdIHx8ICd0aGlzIHRvcGljJ1xyXG5cclxuICAgIC8vIENyZWF0ZSBhIG1vcmUgc3BlY2lmaWMgcHJvbXB0IHRoYXQgYXZvaWRzIGNvbnRlbnQgYXNzdW1wdGlvbnNcclxuICAgIGNvbnN0IHByb21wdCA9IGBXcml0ZSAzICR7c3R1ZGVudExldmVsfSB3YXJtLXVwIHF1ZXN0aW9ucyBhYm91dCAke21haW5Ub3BpY30uIEFzayBhYm91dCBzdHVkZW50cycgcHJpb3Iga25vd2xlZGdlIGFuZCBleHBlcmllbmNlLiBEbyBub3QgbWVudGlvbiBhbnkgc3BlY2lmaWMgZXZlbnRzIG9yIHJlc3VsdHMuIEZvcm1hdDoganVzdCB0aGUgcXVlc3Rpb25zLCBvbmUgcGVyIGxpbmU6YFxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UpSBNaW5pbWFsIHdhcm11cCBwcm9tcHQ6XCIsIHByb21wdC5sZW5ndGgsIFwiY2hhcnNcIilcclxuICAgICAgY29uc29sZS5sb2coXCLwn46vIFRvcGljIGlkZW50aWZpZWQ6XCIsIG1haW5Ub3BpYylcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcclxuXHJcbiAgICAgIC8vIEV4dHJhY3Qgb25seSBhY3R1YWwgcXVlc3Rpb25zIChtdXN0IGVuZCB3aXRoID8pXHJcbiAgICAgIGNvbnN0IHF1ZXN0aW9ucyA9IHJlc3BvbnNlLnNwbGl0KCdcXG4nKVxyXG4gICAgICAgIC5tYXAobGluZSA9PiBsaW5lLnRyaW0oKSlcclxuICAgICAgICAuZmlsdGVyKGxpbmUgPT4ge1xyXG4gICAgICAgICAgLy8gTXVzdCBiZSBhIHF1ZXN0aW9uIChlbmRzIHdpdGggPykgYW5kIG5vdCBhbiBpbnN0cnVjdGlvblxyXG4gICAgICAgICAgcmV0dXJuIGxpbmUuZW5kc1dpdGgoJz8nKSAmJlxyXG4gICAgICAgICAgICBsaW5lLmxlbmd0aCA+IDEwICYmXHJcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2hlcmUgYXJlJykgJiZcclxuICAgICAgICAgICAgIWxpbmUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnYmFzZWQgb24nKSAmJlxyXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdoZWFkbGluZSBtZW50aW9ucycpICYmXHJcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3RoZSB0ZXh0JykgJiZcclxuICAgICAgICAgICAgIWxpbmUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygndGhlIGFydGljbGUnKSAmJlxyXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdhY2NvcmRpbmcgdG8nKSAmJlxyXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd0aGUgcGFzc2FnZScpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAubWFwKGxpbmUgPT4gbGluZS5yZXBsYWNlKC9eXFxkK1xcLj9cXHMqLywgJycpLnJlcGxhY2UoL14tXFxzKi8sICcnKS50cmltKCkpXHJcbiAgICAgICAgLnNsaWNlKDAsIDMpXHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhcIvCfjq8gRXh0cmFjdGVkIHdhcm11cCBxdWVzdGlvbnM6XCIsIHF1ZXN0aW9ucylcclxuXHJcbiAgICAgIGlmIChxdWVzdGlvbnMubGVuZ3RoIDwgMykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBnZW5lcmF0ZSBzdWZmaWNpZW50IHdhcm11cCBxdWVzdGlvbnNcIilcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gcXVlc3Rpb25zXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIuKaoO+4jyBNaW5pbWFsIHdhcm11cCBmYWlsZWRcIilcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIHdhcm11cCBxdWVzdGlvbnM6IFwiICsgZXJyb3IubWVzc2FnZSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEFkZCBpbnN0cnVjdGlvbmFsIHRleHQgdG8gc2VjdGlvbnNcclxuICBwcml2YXRlIGFkZFdhcm11cEluc3RydWN0aW9ucyhxdWVzdGlvbnM6IHN0cmluZ1tdLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IGluc3RydWN0aW9uID0gXCJIYXZlIHRoZSBmb2xsb3dpbmcgY29udmVyc2F0aW9ucyBvciBkaXNjdXNzaW9ucyB3aXRoIHlvdXIgdHV0b3IgYmVmb3JlIHJlYWRpbmcgdGhlIHRleHQ6XCJcclxuICAgIHJldHVybiBbaW5zdHJ1Y3Rpb24sIC4uLnF1ZXN0aW9uc11cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYWRkQ29tcHJlaGVuc2lvbkluc3RydWN0aW9ucyhxdWVzdGlvbnM6IHN0cmluZ1tdLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IGluc3RydWN0aW9uID0gXCJBZnRlciByZWFkaW5nIHRoZSB0ZXh0LCBhbnN3ZXIgdGhlc2UgY29tcHJlaGVuc2lvbiBxdWVzdGlvbnM6XCJcclxuICAgIHJldHVybiBbaW5zdHJ1Y3Rpb24sIC4uLnF1ZXN0aW9uc11cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYWRkRGlzY3Vzc2lvbkluc3RydWN0aW9ucyhxdWVzdGlvbnM6IHN0cmluZ1tdLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IGluc3RydWN0aW9uID0gXCJEaXNjdXNzIHRoZXNlIHF1ZXN0aW9ucyB3aXRoIHlvdXIgdHV0b3IgdG8gZXhwbG9yZSB0aGUgdG9waWMgaW4gZGVwdGg6XCJcclxuICAgIHJldHVybiBbaW5zdHJ1Y3Rpb24sIC4uLnF1ZXN0aW9uc11cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYWRkV3JhcHVwSW5zdHJ1Y3Rpb25zKHF1ZXN0aW9uczogc3RyaW5nW10sIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3QgaW5zdHJ1Y3Rpb24gPSBcIlJlZmxlY3Qgb24geW91ciBsZWFybmluZyBieSBkaXNjdXNzaW5nIHRoZXNlIHdyYXAtdXAgcXVlc3Rpb25zOlwiXHJcbiAgICByZXR1cm4gW2luc3RydWN0aW9uLCAuLi5xdWVzdGlvbnNdXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFkZFZvY2FidWxhcnlJbnN0cnVjdGlvbnModm9jYWJ1bGFyeTogQXJyYXk8eyB3b3JkOiBzdHJpbmcsIG1lYW5pbmc6IHN0cmluZywgZXhhbXBsZTogc3RyaW5nIH0+LCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IEFycmF5PHsgd29yZDogc3RyaW5nLCBtZWFuaW5nOiBzdHJpbmcsIGV4YW1wbGU6IHN0cmluZyB9PiB7XHJcbiAgICBjb25zdCBpbnN0cnVjdGlvbiA9IHtcclxuICAgICAgd29yZDogXCJJTlNUUlVDVElPTlwiLFxyXG4gICAgICBtZWFuaW5nOiBcIlN0dWR5IHRoZSBmb2xsb3dpbmcgd29yZHMgd2l0aCB5b3VyIHR1dG9yIGJlZm9yZSByZWFkaW5nIHRoZSB0ZXh0OlwiLFxyXG4gICAgICBleGFtcGxlOiBcIlwiXHJcbiAgICB9XHJcbiAgICByZXR1cm4gW2luc3RydWN0aW9uLCAuLi52b2NhYnVsYXJ5XVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhZGRSZWFkaW5nSW5zdHJ1Y3Rpb25zKHJlYWRpbmdUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGluc3RydWN0aW9uID0gXCJSZWFkIHRoZSBmb2xsb3dpbmcgdGV4dCBjYXJlZnVsbHkuIFlvdXIgdHV0b3Igd2lsbCBoZWxwIHlvdSB3aXRoIGFueSBkaWZmaWN1bHQgd29yZHMgb3IgY29uY2VwdHM6XCJcclxuICAgIHJldHVybiBgJHtpbnN0cnVjdGlvbn1cXG5cXG4ke3JlYWRpbmdUZXh0fWBcclxuICB9XHJcblxyXG4gIC8vIEJldHRlciB0b3BpYyBleHRyYWN0aW9uIHRoYXQgcmVjb2duaXplcyBjb21wb3VuZCB0ZXJtc1xyXG4gIHByaXZhdGUgZXh0cmFjdEJldHRlclRvcGljcyh0ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICBjb25zdCB0b3BpY3MgPSBbXVxyXG5cclxuICAgIC8vIExvb2sgZm9yIGNvbXBvdW5kIHRlcm1zIGZpcnN0IChsaWtlIFwiUnlkZXIgQ3VwXCIsIFwiV29ybGQgQ3VwXCIsIGV0Yy4pXHJcbiAgICBjb25zdCBjb21wb3VuZFBhdHRlcm5zID0gW1xyXG4gICAgICAvXFxiKFJ5ZGVyIEN1cHxXb3JsZCBDdXB8Q2hhbXBpb25zIExlYWd1ZXxQcmVtaWVyIExlYWd1ZXxTdXBlciBCb3dsfE9seW1waWNzfFdvcmxkIFNlcmllcylcXGIvZ2ksXHJcbiAgICAgIC9cXGIoYXJ0aWZpY2lhbCBpbnRlbGxpZ2VuY2V8bWFjaGluZSBsZWFybmluZ3xjbGltYXRlIGNoYW5nZXxzb2NpYWwgbWVkaWEpXFxiL2dpLFxyXG4gICAgICAvXFxiKFtBLVpdW2Etel0rIFtBLVpdW2Etel0rKVxcYi9nIC8vIEdlbmVyYWwgY29tcG91bmQgcHJvcGVyIG5vdW5zXHJcbiAgICBdXHJcblxyXG4gICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIGNvbXBvdW5kUGF0dGVybnMpIHtcclxuICAgICAgY29uc3QgbWF0Y2hlcyA9IHRleHQubWF0Y2gocGF0dGVybilcclxuICAgICAgaWYgKG1hdGNoZXMpIHtcclxuICAgICAgICB0b3BpY3MucHVzaCguLi5tYXRjaGVzLm1hcChtID0+IG0udG9Mb3dlckNhc2UoKSkpXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBJZiBubyBjb21wb3VuZCB0ZXJtcyBmb3VuZCwgZmFsbCBiYWNrIHRvIHNpbmdsZSB3b3Jkc1xyXG4gICAgaWYgKHRvcGljcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgY29uc3Qgd29yZHMgPSB0ZXh0LnRvTG93ZXJDYXNlKCkubWF0Y2goL1xcYlthLXpdezQsfVxcYi9nKSB8fCBbXVxyXG4gICAgICBjb25zdCBjb21tb25Xb3JkcyA9IFsnZXVyb3BlJywgJ3RlYW0nLCAnZ29sZicsICd0b3VybmFtZW50JywgJ3Nwb3J0cycsICdjb21wZXRpdGlvbiddXHJcbiAgICAgIGNvbnN0IGZvdW5kV29yZHMgPSB3b3Jkcy5maWx0ZXIod29yZCA9PiBjb21tb25Xb3Jkcy5pbmNsdWRlcyh3b3JkKSlcclxuICAgICAgdG9waWNzLnB1c2goLi4uZm91bmRXb3Jkcy5zbGljZSgwLCAzKSlcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdG9waWNzLmxlbmd0aCA+IDAgPyB0b3BpY3MgOiBbJ3Nwb3J0cyddXHJcbiAgfVxyXG5cclxuICAvLyBFbmhhbmNlZCB2b2NhYnVsYXJ5IGdlbmVyYXRpb24gd2l0aCBBSS1nZW5lcmF0ZWQgY29udGV4dHVhbCBleGFtcGxlc1xyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVNaW5pbWFsVm9jYWJ1bGFyeShzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogUHJvbWlzZTxBcnJheTx7IHdvcmQ6IHN0cmluZywgbWVhbmluZzogc3RyaW5nLCBleGFtcGxlOiBzdHJpbmcgfT4+IHtcclxuICAgIC8vIFVzZSBzbWFydCB2b2NhYnVsYXJ5IGV4dHJhY3Rpb24gaW5zdGVhZCBvZiBiYXNpYyB3b3JkIG1hdGNoaW5nXHJcbiAgICBjb25zdCBtZWFuaW5nZnVsV29yZHMgPSB0aGlzLmV4dHJhY3RNZWFuaW5nZnVsVm9jYWJ1bGFyeShzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpXHJcbiAgICBjb25zb2xlLmxvZyhcIvCfk5ogTWVhbmluZ2Z1bCB2b2NhYnVsYXJ5IGV4dHJhY3RlZDpcIiwgbWVhbmluZ2Z1bFdvcmRzKVxyXG5cclxuICAgIGNvbnN0IHZvY2FidWxhcnkgPSBbXVxyXG5cclxuICAgIGZvciAoY29uc3Qgd29yZCBvZiBtZWFuaW5nZnVsV29yZHMpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBjYXBpdGFsaXplZFdvcmQgPSB0aGlzLmNhcGl0YWxpemVXb3JkKHdvcmQpXHJcblxyXG4gICAgICAgIC8vIEdlbmVyYXRlIEFJIGRlZmluaXRpb25cclxuICAgICAgICBjb25zdCBkZWZpbml0aW9uUHJvbXB0ID0gYERlZmluZSBcIiR7d29yZH1cIiBzaW1wbHkgZm9yICR7c3R1ZGVudExldmVsfSBsZXZlbC4gQ29udGV4dDogJHtzb3VyY2VUZXh0LnN1YnN0cmluZygwLCA4MCl9LiBHaXZlIG9ubHkgdGhlIGRlZmluaXRpb24sIG5vIGV4dHJhIHRleHQ6YFxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi8J+TmiBWb2NhYiBkZWZpbml0aW9uIHByb21wdDpcIiwgZGVmaW5pdGlvblByb21wdC5sZW5ndGgsIFwiY2hhcnNcIilcclxuICAgICAgICBjb25zdCByYXdNZWFuaW5nID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChkZWZpbml0aW9uUHJvbXB0KVxyXG4gICAgICAgIGNvbnN0IG1lYW5pbmcgPSB0aGlzLmNsZWFuRGVmaW5pdGlvbihyYXdNZWFuaW5nLCBzdHVkZW50TGV2ZWwpXHJcblxyXG4gICAgICAgIC8vIEdlbmVyYXRlIEFJIGNvbnRleHR1YWwgZXhhbXBsZXNcclxuICAgICAgICBjb25zdCBleGFtcGxlcyA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVBSUV4YW1wbGVTZW50ZW5jZXMod29yZCwgc3R1ZGVudExldmVsLCBzb3VyY2VUZXh0KVxyXG5cclxuICAgICAgICB2b2NhYnVsYXJ5LnB1c2goe1xyXG4gICAgICAgICAgd29yZDogY2FwaXRhbGl6ZWRXb3JkLFxyXG4gICAgICAgICAgbWVhbmluZzogbWVhbmluZy50cmltKCkuc3Vic3RyaW5nKDAsIDIwMCksXHJcbiAgICAgICAgICBleGFtcGxlOiBleGFtcGxlc1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYOKaoO+4jyBWb2NhYiBmYWlsZWQgZm9yICR7d29yZH0sIHVzaW5nIGVuaGFuY2VkIHRlbXBsYXRlYClcclxuICAgICAgICBjb25zdCBjYXBpdGFsaXplZFdvcmQgPSB0aGlzLmNhcGl0YWxpemVXb3JkKHdvcmQpXHJcbiAgICAgICAgdm9jYWJ1bGFyeS5wdXNoKHtcclxuICAgICAgICAgIHdvcmQ6IGNhcGl0YWxpemVkV29yZCxcclxuICAgICAgICAgIG1lYW5pbmc6IHRoaXMuZ2VuZXJhdGVDb250ZXh0dWFsV29yZE1lYW5pbmcod29yZCwgc3R1ZGVudExldmVsLCBzb3VyY2VUZXh0KSxcclxuICAgICAgICAgIGV4YW1wbGU6IGF3YWl0IHRoaXMuZ2VuZXJhdGVBSUV4YW1wbGVTZW50ZW5jZXMod29yZCwgc3R1ZGVudExldmVsLCBzb3VyY2VUZXh0KVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBFbnN1cmUgd2UgaGF2ZSA2LTEwIHdvcmRzXHJcbiAgICByZXR1cm4gdm9jYWJ1bGFyeS5zbGljZSgwLCAxMCkubGVuZ3RoID49IDYgPyB2b2NhYnVsYXJ5LnNsaWNlKDAsIDEwKSA6IHZvY2FidWxhcnkuc2xpY2UoMCwgNilcclxuICB9XHJcblxyXG4gIC8vIFVsdHJhLW1pbmltYWwgY29tcHJlaGVuc2lvbiBnZW5lcmF0aW9uXHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZU1pbmltYWxDb21wcmVoZW5zaW9uKHNvdXJjZVRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XHJcbiAgICBjb25zdCBzaG9ydFRleHQgPSBzb3VyY2VUZXh0LnN1YnN0cmluZygwLCAyMDApIC8vIEluY3JlYXNlIGNvbnRleHQgZm9yIG1vcmUgcXVlc3Rpb25zXHJcbiAgICBjb25zdCBwcm9tcHQgPSBgV3JpdGUgNSAke3N0dWRlbnRMZXZlbH0gcmVhZGluZyBjb21wcmVoZW5zaW9uIHF1ZXN0aW9ucyBhYm91dCB0aGlzIHRleHQuIE9ubHkgcmV0dXJuIHF1ZXN0aW9ucywgbm8gaW5zdHJ1Y3Rpb25zOiAke3Nob3J0VGV4dH1gXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5sb2coXCLinZMgTWluaW1hbCBjb21wcmVoZW5zaW9uIHByb21wdDpcIiwgcHJvbXB0Lmxlbmd0aCwgXCJjaGFyc1wiKVxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQocHJvbXB0KVxyXG5cclxuICAgICAgY29uc3QgcXVlc3Rpb25zID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpXHJcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKVxyXG4gICAgICAgIC5maWx0ZXIobGluZSA9PiB7XHJcbiAgICAgICAgICAvLyBNdXN0IGJlIGEgcXVlc3Rpb24gYW5kIG5vdCBhbiBpbnN0cnVjdGlvblxyXG4gICAgICAgICAgcmV0dXJuIGxpbmUuZW5kc1dpdGgoJz8nKSAmJlxyXG4gICAgICAgICAgICBsaW5lLmxlbmd0aCA+IDEwICYmXHJcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2hlcmUgYXJlJykgJiZcclxuICAgICAgICAgICAgIWxpbmUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnYmFzZWQgb24nKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUucmVwbGFjZSgvXlxcZCtcXC4/XFxzKi8sICcnKS5yZXBsYWNlKC9eXFwqXFwqLywgJycpLnJlcGxhY2UoL1xcKlxcKiQvLCAnJykudHJpbSgpKVxyXG4gICAgICAgIC5zbGljZSgwLCA1KVxyXG5cclxuICAgICAgaWYgKHF1ZXN0aW9ucy5sZW5ndGggPCA1KSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIHN1ZmZpY2llbnQgY29tcHJlaGVuc2lvbiBxdWVzdGlvbnNcIilcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gcXVlc3Rpb25zXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIuKaoO+4jyBNaW5pbWFsIGNvbXByZWhlbnNpb24gZmFpbGVkXCIpXHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBnZW5lcmF0ZSBjb21wcmVoZW5zaW9uIHF1ZXN0aW9uczogXCIgKyBlcnJvci5tZXNzYWdlKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gTWluaW1hbCBBSS1vbmx5IHJlYWRpbmcgcGFzc2FnZSBnZW5lcmF0aW9uXHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZU1pbmltYWxSZWFkaW5nKHNvdXJjZVRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gICAgY29uc3QgcHJvbXB0ID0gYFJld3JpdGUgdGhpcyB0ZXh0IGZvciAke3N0dWRlbnRMZXZlbH0gbGV2ZWwgc3R1ZGVudHMuIEtlZXAgaXQgMjAwLTQwMCB3b3JkczogJHtzb3VyY2VUZXh0LnN1YnN0cmluZygwLCA1MDApfWBcclxuICAgIFxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcclxuICAgICAgcmV0dXJuIHJlc3BvbnNlLnRyaW0oKVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIHJlYWRpbmcgcGFzc2FnZTogXCIgKyBlcnJvci5tZXNzYWdlKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gTWluaW1hbCBBSS1vbmx5IGRpc2N1c3Npb24gcXVlc3Rpb25zIGdlbmVyYXRpb25cclxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlTWluaW1hbERpc2N1c3Npb24oc291cmNlVGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcclxuICAgIGNvbnN0IHByb21wdCA9IGBXcml0ZSAzICR7c3R1ZGVudExldmVsfSBkaXNjdXNzaW9uIHF1ZXN0aW9ucyBhYm91dCB0aGlzIHRleHQuIE9ubHkgcmV0dXJuIHF1ZXN0aW9uczogJHtzb3VyY2VUZXh0LnN1YnN0cmluZygwLCAyMDApfWBcclxuICAgIFxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcclxuICAgICAgY29uc3QgcXVlc3Rpb25zID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpXHJcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKVxyXG4gICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLmVuZHNXaXRoKCc/JykgJiYgbGluZS5sZW5ndGggPiAxMClcclxuICAgICAgICAubWFwKGxpbmUgPT4gbGluZS5yZXBsYWNlKC9eXFxkK1xcLj9cXHMqLywgJycpLnRyaW0oKSlcclxuICAgICAgICAuc2xpY2UoMCwgMylcclxuXHJcbiAgICAgIGlmIChxdWVzdGlvbnMubGVuZ3RoIDwgMykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBnZW5lcmF0ZSBzdWZmaWNpZW50IGRpc2N1c3Npb24gcXVlc3Rpb25zXCIpXHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHF1ZXN0aW9uc1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIGRpc2N1c3Npb24gcXVlc3Rpb25zOiBcIiArIGVycm9yLm1lc3NhZ2UpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBNaW5pbWFsIEFJLW9ubHkgZ3JhbW1hciBzZWN0aW9uIGdlbmVyYXRpb25cclxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlTWluaW1hbEdyYW1tYXIoc291cmNlVGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XHJcbiAgICBjb25zdCBwcm9tcHQgPSBgQ3JlYXRlIGEgZ3JhbW1hciBsZXNzb24gZm9yICR7c3R1ZGVudExldmVsfSBsZXZlbCBiYXNlZCBvbiB0aGlzIHRleHQuIFJldHVybiBKU09OIHdpdGggZm9jdXMsIGV4YW1wbGVzLCBleGVyY2lzZTogJHtzb3VyY2VUZXh0LnN1YnN0cmluZygwLCAyMDApfWBcclxuICAgIFxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcclxuICAgICAgcmV0dXJuIEpTT04ucGFyc2UocmVzcG9uc2UpXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2VuZXJhdGUgZ3JhbW1hciBzZWN0aW9uOiBcIiArIGVycm9yLm1lc3NhZ2UpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBNaW5pbWFsIEFJLW9ubHkgcHJvbnVuY2lhdGlvbiBzZWN0aW9uIGdlbmVyYXRpb25cclxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlTWluaW1hbFByb251bmNpYXRpb24odm9jYWJ1bGFyeVdvcmRzOiBzdHJpbmdbXSwgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgY29uc3Qgd29yZCA9IHZvY2FidWxhcnlXb3Jkc1swXSB8fCAnY29tbXVuaWNhdGlvbidcclxuICAgIGNvbnN0IHByb21wdCA9IGBDcmVhdGUgcHJvbnVuY2lhdGlvbiBwcmFjdGljZSBmb3IgXCIke3dvcmR9XCIuIFJldHVybiBKU09OIHdpdGggd29yZCwgaXBhLCBwcmFjdGljZTpgXHJcbiAgICBcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQpXHJcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKHJlc3BvbnNlKVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIHByb251bmNpYXRpb24gc2VjdGlvbjogXCIgKyBlcnJvci5tZXNzYWdlKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gTWluaW1hbCBBSS1vbmx5IHdyYXB1cCBxdWVzdGlvbnMgZ2VuZXJhdGlvblxyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVNaW5pbWFsV3JhcHVwKHNvdXJjZVRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XHJcbiAgICBjb25zdCBwcm9tcHQgPSBgV3JpdGUgMyAke3N0dWRlbnRMZXZlbH0gd3JhcC11cCBxdWVzdGlvbnMgYWJvdXQgdGhpcyBsZXNzb24uIE9ubHkgcmV0dXJuIHF1ZXN0aW9uczogJHtzb3VyY2VUZXh0LnN1YnN0cmluZygwLCAyMDApfWBcclxuICAgIFxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcclxuICAgICAgY29uc3QgcXVlc3Rpb25zID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpXHJcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKVxyXG4gICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLmVuZHNXaXRoKCc/JykgJiYgbGluZS5sZW5ndGggPiAxMClcclxuICAgICAgICAubWFwKGxpbmUgPT4gbGluZS5yZXBsYWNlKC9eXFxkK1xcLj9cXHMqLywgJycpLnRyaW0oKSlcclxuICAgICAgICAuc2xpY2UoMCwgMylcclxuXHJcbiAgICAgIGlmIChxdWVzdGlvbnMubGVuZ3RoIDwgMykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBnZW5lcmF0ZSBzdWZmaWNpZW50IHdyYXB1cCBxdWVzdGlvbnNcIilcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gcXVlc3Rpb25zXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2VuZXJhdGUgd3JhcHVwIHF1ZXN0aW9uczogXCIgKyBlcnJvci5tZXNzYWdlKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG5cclxuICAvLyBDb250ZW50IGFuYWx5c2lzIHdpdGhvdXQgQUkgY2FsbHNcclxuICBwcml2YXRlIGFuYWx5emVDb250ZW50Q29udGV4dE5vQUkoXHJcbiAgICBzb3VyY2VUZXh0OiBzdHJpbmcsXHJcbiAgICBtZXRhZGF0YT86IGFueSxcclxuICAgIHN0cnVjdHVyZWRDb250ZW50PzogYW55LFxyXG4gICAgc3R1ZGVudExldmVsPzogc3RyaW5nXHJcbiAgKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIvCflI0gQW5hbHl6aW5nIGNvbnRlbnQgY29udGV4dCB3aXRob3V0IEFJLi4uXCIpXHJcblxyXG4gICAgY29uc3QgYW5hbHlzaXMgPSB7XHJcbiAgICAgIGNvbnRlbnRUeXBlOiBtZXRhZGF0YT8uY29udGVudFR5cGUgfHwgJ2dlbmVyYWwnLFxyXG4gICAgICBkb21haW46IG1ldGFkYXRhPy5kb21haW4gfHwgJycsXHJcbiAgICAgIGNvbXBsZXhpdHk6ICdtZWRpdW0nLFxyXG4gICAgICB0b3BpY3M6IFtdLFxyXG4gICAgICBrZXlWb2NhYnVsYXJ5OiBbXSxcclxuICAgICAgY3VsdHVyYWxDb250ZXh0OiAnJyxcclxuICAgICAgbGVhcm5pbmdPYmplY3RpdmVzOiBbXSxcclxuICAgICAgZGlmZmljdWx0eTogc3R1ZGVudExldmVsIHx8ICdCMScsXHJcbiAgICAgIHRpdGxlOiBtZXRhZGF0YT8udGl0bGUgfHwgJycsXHJcbiAgICAgIHNvdXJjZUNvdW50cnk6IHRoaXMuZGV0ZXJtaW5lU291cmNlQ291bnRyeShtZXRhZGF0YT8uZG9tYWluIHx8ICcnKSxcclxuICAgIH1cclxuXHJcbiAgICAvLyBBbmFseXplIGNvbnRlbnQgY29tcGxleGl0eVxyXG4gICAgY29uc3Qgc2VudGVuY2VzID0gc291cmNlVGV4dC5zcGxpdCgvWy4hP10rLykuZmlsdGVyKHMgPT4gcy50cmltKCkubGVuZ3RoID4gMTApXHJcbiAgICBjb25zdCBhdmdTZW50ZW5jZUxlbmd0aCA9IHNlbnRlbmNlcy5sZW5ndGggPiAwID8gc2VudGVuY2VzLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLnNwbGl0KCcgJykubGVuZ3RoLCAwKSAvIHNlbnRlbmNlcy5sZW5ndGggOiAwXHJcbiAgICBjb25zdCBjb21wbGV4V29yZHMgPSBzb3VyY2VUZXh0Lm1hdGNoKC9cXGJcXHd7OCx9XFxiL2cpPy5sZW5ndGggfHwgMFxyXG4gICAgY29uc3QgdG90YWxXb3JkcyA9IHNvdXJjZVRleHQuc3BsaXQoL1xccysvKS5sZW5ndGhcclxuXHJcbiAgICBpZiAoYXZnU2VudGVuY2VMZW5ndGggPiAyMCB8fCBjb21wbGV4V29yZHMgLyB0b3RhbFdvcmRzID4gMC4xNSkge1xyXG4gICAgICBhbmFseXNpcy5jb21wbGV4aXR5ID0gJ2hpZ2gnXHJcbiAgICB9IGVsc2UgaWYgKGF2Z1NlbnRlbmNlTGVuZ3RoIDwgMTIgJiYgY29tcGxleFdvcmRzIC8gdG90YWxXb3JkcyA8IDAuMDgpIHtcclxuICAgICAgYW5hbHlzaXMuY29tcGxleGl0eSA9ICdsb3cnXHJcbiAgICB9XHJcblxyXG4gICAgLy8gRXh0cmFjdCB0b3BpY3MgdXNpbmcgdGV4dCBhbmFseXNpc1xyXG4gICAgYW5hbHlzaXMudG9waWNzID0gdGhpcy5leHRyYWN0VG9waWNzRnJvbVRleHQoc291cmNlVGV4dCwgc3RydWN0dXJlZENvbnRlbnQ/LmhlYWRpbmdzIHx8IFtdKVxyXG5cclxuICAgIC8vIEV4dHJhY3Qgdm9jYWJ1bGFyeSB1c2luZyB0ZXh0IGFuYWx5c2lzXHJcbiAgICBhbmFseXNpcy5rZXlWb2NhYnVsYXJ5ID0gdGhpcy5leHRyYWN0Vm9jYWJ1bGFyeUZyb21UZXh0KHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbClcclxuXHJcbiAgICAvLyBEZXRlcm1pbmUgY3VsdHVyYWwgY29udGV4dFxyXG4gICAgaWYgKG1ldGFkYXRhPy5kb21haW4pIHtcclxuICAgICAgYW5hbHlzaXMuY3VsdHVyYWxDb250ZXh0ID0gdGhpcy5kZXRlcm1pbmVDdWx0dXJhbENvbnRleHQobWV0YWRhdGEuZG9tYWluLCBzb3VyY2VUZXh0KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEdlbmVyYXRlIGxlYXJuaW5nIG9iamVjdGl2ZXNcclxuICAgIGFuYWx5c2lzLmxlYXJuaW5nT2JqZWN0aXZlcyA9IHRoaXMuZ2VuZXJhdGVMZWFybmluZ09iamVjdGl2ZXMoXHJcbiAgICAgIGFuYWx5c2lzLmNvbnRlbnRUeXBlLFxyXG4gICAgICBhbmFseXNpcy50b3BpY3MsXHJcbiAgICAgIHN0dWRlbnRMZXZlbFxyXG4gICAgKVxyXG5cclxuICAgIHJldHVybiBhbmFseXNpc1xyXG4gIH1cclxuXHJcbiAgLy8gTmV3IG1ldGhvZDogQW5hbHl6ZSBjb250ZW50IGNvbnRleHQgYW5kIGNvbXBsZXhpdHlcclxuICBwcml2YXRlIGFzeW5jIGFuYWx5emVDb250ZW50Q29udGV4dChcclxuICAgIHNvdXJjZVRleHQ6IHN0cmluZyxcclxuICAgIG1ldGFkYXRhPzogYW55LFxyXG4gICAgc3RydWN0dXJlZENvbnRlbnQ/OiBhbnksXHJcbiAgICBzdHVkZW50TGV2ZWw/OiBzdHJpbmdcclxuICApIHtcclxuICAgIGNvbnNvbGUubG9nKFwi8J+UjSBBbmFseXppbmcgY29udGVudCBjb250ZXh0Li4uXCIpXHJcblxyXG4gICAgY29uc3QgYW5hbHlzaXMgPSB7XHJcbiAgICAgIGNvbnRlbnRUeXBlOiBtZXRhZGF0YT8uY29udGVudFR5cGUgfHwgJ2dlbmVyYWwnLFxyXG4gICAgICBkb21haW46IG1ldGFkYXRhPy5kb21haW4gfHwgJycsXHJcbiAgICAgIGNvbXBsZXhpdHk6ICdtZWRpdW0nLFxyXG4gICAgICB0b3BpY3M6IFtdLFxyXG4gICAgICBrZXlWb2NhYnVsYXJ5OiBbXSxcclxuICAgICAgY3VsdHVyYWxDb250ZXh0OiAnJyxcclxuICAgICAgbGVhcm5pbmdPYmplY3RpdmVzOiBbXSxcclxuICAgICAgZGlmZmljdWx0eTogc3R1ZGVudExldmVsIHx8ICdCMScsXHJcbiAgICAgIHRpdGxlOiBtZXRhZGF0YT8udGl0bGUgfHwgJycsXHJcbiAgICAgIHNvdXJjZUNvdW50cnk6IHRoaXMuZGV0ZXJtaW5lU291cmNlQ291bnRyeShtZXRhZGF0YT8uZG9tYWluIHx8ICcnKSxcclxuICAgIH1cclxuXHJcbiAgICAvLyBBbmFseXplIGNvbnRlbnQgY29tcGxleGl0eSBiYXNlZCBvbiB0ZXh0IGNoYXJhY3RlcmlzdGljc1xyXG4gICAgY29uc3Qgc2VudGVuY2VzID0gc291cmNlVGV4dC5zcGxpdCgvWy4hP10rLykuZmlsdGVyKHMgPT4gcy50cmltKCkubGVuZ3RoID4gMTApXHJcbiAgICBjb25zdCBhdmdTZW50ZW5jZUxlbmd0aCA9IHNlbnRlbmNlcy5sZW5ndGggPiAwID8gc2VudGVuY2VzLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLnNwbGl0KCcgJykubGVuZ3RoLCAwKSAvIHNlbnRlbmNlcy5sZW5ndGggOiAwXHJcbiAgICBjb25zdCBjb21wbGV4V29yZHMgPSBzb3VyY2VUZXh0Lm1hdGNoKC9cXGJcXHd7OCx9XFxiL2cpPy5sZW5ndGggfHwgMFxyXG4gICAgY29uc3QgdG90YWxXb3JkcyA9IHNvdXJjZVRleHQuc3BsaXQoL1xccysvKS5sZW5ndGhcclxuXHJcbiAgICBpZiAoYXZnU2VudGVuY2VMZW5ndGggPiAyMCB8fCBjb21wbGV4V29yZHMgLyB0b3RhbFdvcmRzID4gMC4xNSkge1xyXG4gICAgICBhbmFseXNpcy5jb21wbGV4aXR5ID0gJ2hpZ2gnXHJcbiAgICB9IGVsc2UgaWYgKGF2Z1NlbnRlbmNlTGVuZ3RoIDwgMTIgJiYgY29tcGxleFdvcmRzIC8gdG90YWxXb3JkcyA8IDAuMDgpIHtcclxuICAgICAgYW5hbHlzaXMuY29tcGxleGl0eSA9ICdsb3cnXHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coXCLwn5OIIFRleHQgY29tcGxleGl0eSBhbmFseXNpczpcIiwge1xyXG4gICAgICBhdmdTZW50ZW5jZUxlbmd0aCxcclxuICAgICAgY29tcGxleFdvcmRzLFxyXG4gICAgICB0b3RhbFdvcmRzLFxyXG4gICAgICBjb21wbGV4aXR5OiBhbmFseXNpcy5jb21wbGV4aXR5XHJcbiAgICB9KVxyXG5cclxuICAgIC8vIEV4dHJhY3Qga2V5IHRvcGljcyB1c2luZyBzaW1wbGUgdGV4dCBhbmFseXNpcyAoc2tpcCBBSSB0byBhdm9pZCB0b2tlbiBsaW1pdHMpXHJcbiAgICBjb25zb2xlLmxvZyhcIvCfjq8gRXh0cmFjdGluZyB0b3BpY3MgdXNpbmcgdGV4dCBhbmFseXNpcy4uLlwiKVxyXG4gICAgYW5hbHlzaXMudG9waWNzID0gdGhpcy5leHRyYWN0VG9waWNzRnJvbVRleHQoc291cmNlVGV4dCwgc3RydWN0dXJlZENvbnRlbnQ/LmhlYWRpbmdzIHx8IFtdKVxyXG4gICAgY29uc29sZS5sb2coXCLinIUgRXh0cmFjdGVkIHRvcGljczpcIiwgYW5hbHlzaXMudG9waWNzKVxyXG5cclxuICAgIC8vIEV4dHJhY3Qga2V5IHZvY2FidWxhcnkgdXNpbmcgdGV4dCBhbmFseXNpcyAoc2tpcCBBSSB0byBhdm9pZCB0b2tlbiBsaW1pdHMpXHJcbiAgICBjb25zb2xlLmxvZyhcIvCfk5ogRXh0cmFjdGluZyB2b2NhYnVsYXJ5IHVzaW5nIHRleHQgYW5hbHlzaXMuLi5cIilcclxuICAgIGFuYWx5c2lzLmtleVZvY2FidWxhcnkgPSB0aGlzLmV4dHJhY3RWb2NhYnVsYXJ5RnJvbVRleHQoc291cmNlVGV4dCwgc3R1ZGVudExldmVsKVxyXG4gICAgY29uc29sZS5sb2coXCLinIUgRXh0cmFjdGVkIHZvY2FidWxhcnk6XCIsIGFuYWx5c2lzLmtleVZvY2FidWxhcnkpXHJcblxyXG4gICAgLy8gRGV0ZXJtaW5lIGN1bHR1cmFsIGNvbnRleHRcclxuICAgIGlmIChtZXRhZGF0YT8uZG9tYWluKSB7XHJcbiAgICAgIGFuYWx5c2lzLmN1bHR1cmFsQ29udGV4dCA9IHRoaXMuZGV0ZXJtaW5lQ3VsdHVyYWxDb250ZXh0KG1ldGFkYXRhLmRvbWFpbiwgc291cmNlVGV4dClcclxuICAgICAgY29uc29sZS5sb2coXCLwn4yNIEN1bHR1cmFsIGNvbnRleHQ6XCIsIGFuYWx5c2lzLmN1bHR1cmFsQ29udGV4dClcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZW5lcmF0ZSBsZWFybmluZyBvYmplY3RpdmVzIGJhc2VkIG9uIGNvbnRlbnQgdHlwZSBhbmQgbGVzc29uIHR5cGVcclxuICAgIGFuYWx5c2lzLmxlYXJuaW5nT2JqZWN0aXZlcyA9IHRoaXMuZ2VuZXJhdGVMZWFybmluZ09iamVjdGl2ZXMoXHJcbiAgICAgIGFuYWx5c2lzLmNvbnRlbnRUeXBlLFxyXG4gICAgICBhbmFseXNpcy50b3BpY3MsXHJcbiAgICAgIHN0dWRlbnRMZXZlbFxyXG4gICAgKVxyXG4gICAgY29uc29sZS5sb2coXCLwn46vIExlYXJuaW5nIG9iamVjdGl2ZXM6XCIsIGFuYWx5c2lzLmxlYXJuaW5nT2JqZWN0aXZlcylcclxuXHJcbiAgICByZXR1cm4gYW5hbHlzaXNcclxuICB9XHJcblxyXG4gIC8vIEVuaGFuY2VkIGNvbnRleHR1YWwgc3VtbWFyeSBjcmVhdGlvblxyXG4gIHByaXZhdGUgYXN5bmMgY3JlYXRlQ29udGV4dHVhbFN1bW1hcnkoXHJcbiAgICBzb3VyY2VUZXh0OiBzdHJpbmcsXHJcbiAgICBjb250ZW50QW5hbHlzaXM6IGFueSxcclxuICAgIGxlc3NvblR5cGU6IHN0cmluZyxcclxuICAgIHN0dWRlbnRMZXZlbDogc3RyaW5nXHJcbiAgKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIvCfk50gQ3JlYXRpbmcgY29udGV4dHVhbCBzdW1tYXJ5Li4uXCIpXHJcblxyXG4gICAgLy8gVXNlIHNpbXBsZSBwcm9tcHQgdG8gYXZvaWQgdG9rZW4gbGltaXRzXHJcbiAgICBjb25zdCBzdW1tYXJ5UHJvbXB0ID0gYFN1bW1hcml6ZSB0aGlzIHRleHQgaW4gNC01IHNlbnRlbmNlcyBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsIHN0dWRlbnRzOlxyXG5cclxuJHtzb3VyY2VUZXh0LnN1YnN0cmluZygwLCA4MDApfVxyXG5cclxuU3VtbWFyeTpgXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5sb2coXCLwn6SWIENhbGxpbmcgQUkgZm9yIGNvbnRleHR1YWwgc3VtbWFyeS4uLlwiKVxyXG4gICAgICBjb25zdCBzdW1tYXJ5ID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChzdW1tYXJ5UHJvbXB0LCB7XHJcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNCxcclxuICAgICAgICBtYXhUb2tlbnM6IDMwMCwgLy8gUmVkdWNlZCBmcm9tIDUwMFxyXG4gICAgICB9KVxyXG4gICAgICBjb25zb2xlLmxvZyhcIuKchSBBSSBjb250ZXh0dWFsIHN1bW1hcnkgY3JlYXRlZDpcIiwgc3VtbWFyeS5zdWJzdHJpbmcoMCwgMTAwKSArIFwiLi4uXCIpXHJcbiAgICAgIHJldHVybiBzdW1tYXJ5XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLndhcm4oXCLimqDvuI8gQUkgY29udGV4dHVhbCBzdW1tYXJ5IGZhaWxlZCwgdXNpbmcgdGV4dCB0cnVuY2F0aW9uOlwiLCBlcnJvci5tZXNzYWdlKVxyXG4gICAgICAvLyBTa2lwIGNvbXBsZXggZmFsbGJhY2tzLCBqdXN0IHVzZSB0cnVuY2F0aW9uXHJcbiAgICAgIGNvbnN0IHRydW5jYXRlZCA9IHNvdXJjZVRleHQuc3Vic3RyaW5nKDAsIDYwMCkgKyBcIi4uLlwiXHJcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UhCBVc2luZyB0cnVuY2F0ZWQgdGV4dCBhcyBzdW1tYXJ5XCIpXHJcbiAgICAgIHJldHVybiB0cnVuY2F0ZWRcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEdlbmVyYXRlIENFRlItYWRhcHRlZCB3YXJtLXVwIHF1ZXN0aW9uc1xyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVDb250ZXh0dWFsV2FybXVwUXVlc3Rpb25zKFxyXG4gICAgY29udGVudDogc3RyaW5nLFxyXG4gICAgY29udGVudEFuYWx5c2lzOiBhbnksXHJcbiAgICBzdHVkZW50TGV2ZWw6IHN0cmluZyxcclxuICAgIG1ldGFkYXRhPzogYW55XHJcbiAgKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIvCflKUgR2VuZXJhdGluZyBDRUZSLWFkYXB0ZWQgd2FybS11cCBxdWVzdGlvbnMuLi5cIilcclxuXHJcbiAgICBjb25zdCBsZXZlbEluc3RydWN0aW9ucyA9IHtcclxuICAgICAgJ0ExJzogYFxyXG5DcmVhdGUgMyB3YXJtLXVwIHF1ZXN0aW9ucyBmb3IgQTEgKGJlZ2lubmVyKSBsZXZlbDpcclxuLSBVc2Ugc2ltcGxlIHByZXNlbnQgdGVuc2UgYW5kIGJhc2ljIHZvY2FidWxhcnlcclxuLSBBc2sgeWVzL25vIHF1ZXN0aW9ucyBvciBzaW1wbGUgY2hvaWNlIHF1ZXN0aW9uc1xyXG4tIEZvY3VzIG9uIGZhbWlsaWFyLCBjb25jcmV0ZSBjb25jZXB0c1xyXG4tIEtlZXAgcXVlc3Rpb25zIHNob3J0IGFuZCBkaXJlY3RcclxuLSBVc2Ugdm9jYWJ1bGFyeSB0aGUgc3R1ZGVudCBsaWtlbHkga25vd3NcclxuRXhhbXBsZTogXCJEbyB5b3UgdXNlIFt0b3BpY10gaW4geW91ciBkYWlseSBsaWZlPyBZZXMgb3IgTm8/XCJgLFxyXG5cclxuICAgICAgJ0EyJzogYFxyXG5DcmVhdGUgMyB3YXJtLXVwIHF1ZXN0aW9ucyBmb3IgQTIgKGVsZW1lbnRhcnkpIGxldmVsOlxyXG4tIFVzZSBzaW1wbGUgcGFzdCB0ZW5zZSBhbmQgcGVyc29uYWwgZXhwZXJpZW5jZXNcclxuLSBBc2sgZm9yIHNob3J0LCBzaW1wbGUgYW5zd2Vyc1xyXG4tIEluY2x1ZGUgYmFzaWMgY29tcGFyaXNvbnMgd2l0aCBcImRpZmZlcmVudFwiIG9yIFwic2FtZVwiXHJcbi0gRm9jdXMgb24gcGVyc29uYWwgZXhwZXJpZW5jZXMgYW5kIGZhbWlsaWFyIHNpdHVhdGlvbnNcclxuLSBVc2Ugc2ltcGxlIGNvbm5lY3Rpbmcgd29yZHMgbGlrZSBcImFuZFwiLCBcImJ1dFwiXHJcbkV4YW1wbGU6IFwiSGF2ZSB5b3UgZXZlciBbZXhwZXJpZW5jZWQgdG9waWNdPyBIb3cgd2FzIGl0P1wiYCxcclxuXHJcbiAgICAgICdCMSc6IGBcclxuQ3JlYXRlIDMgd2FybS11cCBxdWVzdGlvbnMgZm9yIEIxIChpbnRlcm1lZGlhdGUpIGxldmVsOlxyXG4tIEFzayBmb3Igb3BpbmlvbnMgd2l0aCBcIldoYXQgZG8geW91IHRoaW5rLi4uP1wiXHJcbi0gSW5jbHVkZSBjb21wYXJpc29ucyBiZXR3ZWVuIGNvdW50cmllcy9jdWx0dXJlc1xyXG4tIEFzayBzdHVkZW50cyB0byBleHBsYWluIHJlYXNvbnMgd2l0aCBcImJlY2F1c2VcIiBvciBcIndoeVwiXHJcbi0gRGlzY3VzcyBhZHZhbnRhZ2VzIGFuZCBkaXNhZHZhbnRhZ2VzXHJcbi0gVXNlIG1vcmUgdmFyaWVkIHZvY2FidWxhcnkgYnV0IGtlZXAgc3RydWN0dXJlIGNsZWFyXHJcbkV4YW1wbGU6IFwiV2hhdCBkbyB5b3UgdGhpbmsgYWJvdXQgW3RvcGljXT8gSG93IGlzIGl0IGRpZmZlcmVudCBpbiB5b3VyIGNvdW50cnk/XCJgLFxyXG5cclxuICAgICAgJ0IyJzogYFxyXG5DcmVhdGUgMyB3YXJtLXVwIHF1ZXN0aW9ucyBmb3IgQjIgKHVwcGVyIGludGVybWVkaWF0ZSkgbGV2ZWw6XHJcbi0gQXNrIHN0dWRlbnRzIHRvIGFuYWx5emUgc2l0dWF0aW9ucyBhbmQgcHJlZGljdCBvdXRjb21lc1xyXG4tIEluY2x1ZGUgY29tcGxleCBvcGluaW9ucyBhbmQgZXhwbGFuYXRpb25zXHJcbi0gRGlzY3VzcyBpbXBsaWNhdGlvbnMgYW5kIGNvbnNlcXVlbmNlc1xyXG4tIFVzZSBjb25kaXRpb25hbCBsYW5ndWFnZSAoXCJXaGF0IHdvdWxkIGhhcHBlbiBpZi4uLj9cIilcclxuLSBFbmNvdXJhZ2UgZGV0YWlsZWQgcmVzcG9uc2VzIHdpdGggZXhhbXBsZXNcclxuRXhhbXBsZTogXCJXaGF0IGNoYWxsZW5nZXMgZG8geW91IHRoaW5rIFtzcGVjaWZpYyBncm91cF0gZmFjZSB3aXRoIFt0b3BpY10/XCJgLFxyXG5cclxuICAgICAgJ0MxJzogYFxyXG5DcmVhdGUgMyB3YXJtLXVwIHF1ZXN0aW9ucyBmb3IgQzEgKGFkdmFuY2VkKSBsZXZlbDpcclxuLSBBc2sgc3R1ZGVudHMgdG8gZXZhbHVhdGUgYXJndW1lbnRzIGFuZCBjb25zaWRlciBtdWx0aXBsZSBwZXJzcGVjdGl2ZXNcclxuLSBJbmNsdWRlIGFic3RyYWN0IGNvbmNlcHRzIGFuZCBzb2NpZXRhbCBpbXBsaWNhdGlvbnNcclxuLSBVc2Ugc29waGlzdGljYXRlZCB2b2NhYnVsYXJ5IGFuZCBjb21wbGV4IHN0cnVjdHVyZXNcclxuLSBFbmNvdXJhZ2UgY3JpdGljYWwgdGhpbmtpbmcgYW5kIG51YW5jZWQgZGlzY3Vzc2lvblxyXG4tIEFzayBhYm91dCBicm9hZGVyIGN1bHR1cmFsIGFuZCBzb2NpYWwgY29udGV4dHNcclxuRXhhbXBsZTogXCJIb3cgZG8gY3VsdHVyYWwgYXR0aXR1ZGVzIHRvd2FyZCBbY29uY2VwdF0gaW5mbHVlbmNlIFt0b3BpY10gaW4gZGlmZmVyZW50IHNvY2lldGllcz9cImBcclxuICAgIH1cclxuXHJcbiAgICAvLyBVbHRyYS1zaW1wbGUgcHJvbXB0IHRvIGF2b2lkIHRva2VuIGxpbWl0c1xyXG4gICAgY29uc3QgdG9waWMgPSBjb250ZW50QW5hbHlzaXMudG9waWNzWzBdIHx8ICd0aGlzIHRvcGljJ1xyXG4gICAgY29uc3Qgd2FybXVwUHJvbXB0ID0gYENyZWF0ZSAzICR7c3R1ZGVudExldmVsfSBsZXZlbCB3YXJtLXVwIHF1ZXN0aW9ucyBhYm91dCAke3RvcGljfS4gUmV0dXJuIG9ubHkgdGhlIHF1ZXN0aW9uczpgXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5sb2coXCLwn6SWIENhbGxpbmcgQUkgZm9yIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnMuLi5cIilcclxuICAgICAgY29uc29sZS5sb2coXCLwn5OdIFdhcm0tdXAgcHJvbXB0OlwiLCB3YXJtdXBQcm9tcHQuc3Vic3RyaW5nKDAsIDIwMCkgKyBcIi4uLlwiKVxyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHdhcm11cFByb21wdCwge1xyXG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjYsXHJcbiAgICAgICAgbWF4VG9rZW5zOiAxNTAsIC8vIFJlZHVjZWQgZnJvbSAzMDBcclxuICAgICAgfSlcclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKFwi4pyFIEFJIHdhcm0tdXAgcXVlc3Rpb25zIGdlbmVyYXRlZFwiKVxyXG4gICAgICBjb25zb2xlLmxvZyhcIvCfpJYgUmF3IEFJIHJlc3BvbnNlOlwiLCByZXNwb25zZSlcclxuXHJcbiAgICAgIGNvbnN0IHF1ZXN0aW9ucyA9IHRoaXMucGFyc2VMaXN0RnJvbVRleHQocmVzcG9uc2UpLnNsaWNlKDAsIDMpXHJcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UpSBQYXJzZWQgd2FybS11cCBxdWVzdGlvbnM6XCIsIHF1ZXN0aW9ucylcclxuICAgICAgY29uc29sZS5sb2coXCLwn5SNIFF1ZXN0aW9ucyBhcnJheSBsZW5ndGg6XCIsIHF1ZXN0aW9ucy5sZW5ndGgpXHJcblxyXG4gICAgICAvLyBFbnN1cmUgd2UgaGF2ZSAzIHF1ZXN0aW9ucywgYWRkIGZhbGxiYWNrcyBpZiBuZWVkZWRcclxuICAgICAgd2hpbGUgKHF1ZXN0aW9ucy5sZW5ndGggPCAzKSB7XHJcbiAgICAgICAgY29uc3QgZmFsbGJhY2tRdWVzdGlvbiA9IHRoaXMuZ2V0RmFsbGJhY2tXYXJtdXBRdWVzdGlvbihzdHVkZW50TGV2ZWwsIGNvbnRlbnRBbmFseXNpcywgcXVlc3Rpb25zLmxlbmd0aClcclxuICAgICAgICBjb25zb2xlLmxvZyhg8J+UhCBBZGRpbmcgZmFsbGJhY2sgcXVlc3Rpb24gJHtxdWVzdGlvbnMubGVuZ3RoICsgMX06YCwgZmFsbGJhY2tRdWVzdGlvbilcclxuICAgICAgICBxdWVzdGlvbnMucHVzaChmYWxsYmFja1F1ZXN0aW9uKVxyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhcIuKchSBGaW5hbCB3YXJtLXVwIHF1ZXN0aW9uczpcIiwgcXVlc3Rpb25zKVxyXG5cclxuICAgICAgLy8gRmluYWwgc2FmZXR5IGNoZWNrIC0gaWYgc3RpbGwgZW1wdHksIHVzZSBiYXNpYyBmYWxsYmFja1xyXG4gICAgICBpZiAocXVlc3Rpb25zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBObyBxdWVzdGlvbnMgZ2VuZXJhdGVkLCB1c2luZyBlbWVyZ2VuY3kgZmFsbGJhY2tcIilcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgXCJXaGF0IGRvIHlvdSBrbm93IGFib3V0IHRoaXMgdG9waWM/XCIsXHJcbiAgICAgICAgICBcIkhhdmUgeW91IGV4cGVyaWVuY2VkIHNvbWV0aGluZyBzaW1pbGFyP1wiLFxyXG4gICAgICAgICAgXCJXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGxlYXJuP1wiXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcXVlc3Rpb25zXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLndhcm4oXCLimqDvuI8gQUkgd2FybS11cCBnZW5lcmF0aW9uIGZhaWxlZCwgdXNpbmcgY29udGV4dHVhbCBmYWxsYmFja3M6XCIsIGVycm9yLm1lc3NhZ2UpXHJcbiAgICAgIGNvbnN0IGZhbGxiYWNrUXVlc3Rpb25zID0gdGhpcy5nZXRDb250ZXh0dWFsV2FybXVwRmFsbGJhY2soc3R1ZGVudExldmVsLCBjb250ZW50QW5hbHlzaXMsIG1ldGFkYXRhKVxyXG4gICAgICBjb25zb2xlLmxvZyhcIvCflIQgRmFsbGJhY2sgd2FybS11cCBxdWVzdGlvbnM6XCIsIGZhbGxiYWNrUXVlc3Rpb25zKVxyXG5cclxuICAgICAgLy8gRmluYWwgc2FmZXR5IGNoZWNrIGZvciBmYWxsYmFja1xyXG4gICAgICBpZiAoIWZhbGxiYWNrUXVlc3Rpb25zIHx8IGZhbGxiYWNrUXVlc3Rpb25zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBGYWxsYmFjayBhbHNvIGVtcHR5LCB1c2luZyBlbWVyZ2VuY3kgcXVlc3Rpb25zXCIpXHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgIFwiV2hhdCBkbyB5b3Uga25vdyBhYm91dCB0aGlzIHRvcGljP1wiLFxyXG4gICAgICAgICAgXCJIYXZlIHlvdSBleHBlcmllbmNlZCBzb21ldGhpbmcgc2ltaWxhcj9cIixcclxuICAgICAgICAgIFwiV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBsZWFybj9cIlxyXG4gICAgICAgIF1cclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIGZhbGxiYWNrUXVlc3Rpb25zXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBFbmhhbmNlZCBjb250ZXh0dWFsIGxlc3NvbiBzdHJ1Y3R1cmUgZ2VuZXJhdGlvblxyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVDb250ZXh0dWFsTGVzc29uU3RydWN0dXJlKFxyXG4gICAgY29udGVudDogc3RyaW5nLFxyXG4gICAgY29udGVudEFuYWx5c2lzOiBhbnksXHJcbiAgICBsZXNzb25UeXBlOiBzdHJpbmcsXHJcbiAgICBzdHVkZW50TGV2ZWw6IHN0cmluZyxcclxuICAgIHRhcmdldExhbmd1YWdlOiBzdHJpbmcsXHJcbiAgICBtZXRhZGF0YT86IGFueVxyXG4gICkge1xyXG4gICAgY29uc29sZS5sb2coXCLwn4+X77iPIEdlbmVyYXRpbmcgY29udGV4dHVhbCBsZXNzb24gc3RydWN0dXJlLi4uXCIpXHJcblxyXG4gICAgLy8gR2VuZXJhdGUgY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9ucyBmaXJzdFxyXG4gICAgY29uc3QgY29udGV4dHVhbFdhcm11cCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVDb250ZXh0dWFsV2FybXVwUXVlc3Rpb25zKFxyXG4gICAgICBjb250ZW50LFxyXG4gICAgICBjb250ZW50QW5hbHlzaXMsXHJcbiAgICAgIHN0dWRlbnRMZXZlbCxcclxuICAgICAgbWV0YWRhdGFcclxuICAgIClcclxuXHJcbiAgICBjb25zb2xlLmxvZyhcIvCflKUgR2VuZXJhdGVkIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnM6XCIsIGNvbnRleHR1YWxXYXJtdXApXHJcblxyXG4gICAgLy8gVWx0cmEtc2ltcGxpZmllZCBwcm9tcHQgdG8gYXZvaWQgdG9rZW4gbGltaXRzXHJcbiAgICBjb25zdCB0b3BpY3MgPSBjb250ZW50QW5hbHlzaXMudG9waWNzLnNsaWNlKDAsIDIpLmpvaW4oJywgJykgfHwgJ3RlY2hub2xvZ3knXHJcbiAgICBjb25zdCB2b2NhYiA9IGNvbnRlbnRBbmFseXNpcy5rZXlWb2NhYnVsYXJ5LnNsaWNlKDAsIDQpLmpvaW4oJywgJylcclxuXHJcbiAgICBjb25zdCBwcm9tcHQgPSBgQ3JlYXRlIGEgJHtsZXNzb25UeXBlfSBsZXNzb24gZm9yICR7c3R1ZGVudExldmVsfSBzdHVkZW50cyBhYm91dDogJHt0b3BpY3N9XHJcblxyXG5Db250ZW50OiBcIiR7Y29udGVudC5zdWJzdHJpbmcoMCwgNDAwKX1cIlxyXG5LZXkgd29yZHM6ICR7dm9jYWJ9XHJcblxyXG5SZXR1cm4gSlNPTiB3aXRoOiB3YXJtdXAgKHVzZSBwcm92aWRlZCksIHZvY2FidWxhcnkgKDQgd29yZHMgZnJvbSBjb250ZW50KSwgcmVhZGluZyAoc2ltcGxpZmllZCBjb250ZW50KSwgY29tcHJlaGVuc2lvbiAoMyBxdWVzdGlvbnMpLCBkaXNjdXNzaW9uICgzIHF1ZXN0aW9ucyksIGdyYW1tYXIgKGZvY3VzICsgZXhhbXBsZXMpLCBwcm9udW5jaWF0aW9uICgxIHdvcmQpLCB3cmFwdXAgKDMgcXVlc3Rpb25zKS5cclxuXHJcbntcclxuICBcIndhcm11cFwiOiAke0pTT04uc3RyaW5naWZ5KGNvbnRleHR1YWxXYXJtdXApfSxcclxuICBcInZvY2FidWxhcnlcIjogW3tcIndvcmRcIjogXCJ3b3JkXCIsIFwibWVhbmluZ1wiOiBcImRlZmluaXRpb25cIiwgXCJleGFtcGxlXCI6IFwic2VudGVuY2VcIn1dLFxyXG4gIFwicmVhZGluZ1wiOiBcInRleHRcIixcclxuICBcImNvbXByZWhlbnNpb25cIjogW1wicXVlc3Rpb25cIl0sXHJcbiAgXCJkaXNjdXNzaW9uXCI6IFtcInF1ZXN0aW9uXCJdLCBcclxuICBcImdyYW1tYXJcIjoge1wiZm9jdXNcIjogXCJ0b3BpY1wiLCBcImV4YW1wbGVzXCI6IFtcImV4YW1wbGVcIl0sIFwiZXhlcmNpc2VcIjogW1wiZXhlcmNpc2VcIl19LFxyXG4gIFwicHJvbnVuY2lhdGlvblwiOiB7XCJ3b3JkXCI6IFwid29yZFwiLCBcImlwYVwiOiBcIi9pcGEvXCIsIFwicHJhY3RpY2VcIjogXCJzZW50ZW5jZVwifSxcclxuICBcIndyYXB1cFwiOiBbXCJxdWVzdGlvblwiXVxyXG59YFxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+kliBDYWxsaW5nIEFJIGZvciBsZXNzb24gc3RydWN0dXJlLi4uXCIpXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQsIHtcclxuICAgICAgICB0ZW1wZXJhdHVyZTogMC43LFxyXG4gICAgICAgIG1heFRva2VuczogMTUwMCwgLy8gUmVkdWNlZCBmcm9tIDMwMDAgdG8gYXZvaWQgdG9rZW4gbGltaXRzXHJcbiAgICAgIH0pXHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhcIvCfpJYgQUkgbGVzc29uIHN0cnVjdHVyZSByZXNwb25zZTpcIiwgcmVzcG9uc2Uuc3Vic3RyaW5nKDAsIDIwMCkgKyBcIi4uLlwiKVxyXG5cclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKHJlc3BvbnNlKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi4pyFIFN1Y2Nlc3NmdWxseSBwYXJzZWQgbGVzc29uIHN0cnVjdHVyZSBKU09OXCIpXHJcblxyXG4gICAgICAgIC8vIEVuc3VyZSBvdXIgY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9ucyBhcmUgcHJlc2VydmVkXHJcbiAgICAgICAgcGFyc2VkLndhcm11cCA9IGNvbnRleHR1YWxXYXJtdXBcclxuICAgICAgICBjb25zb2xlLmxvZyhcIvCflKUgUHJlc2VydmVkIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnMgaW4gZmluYWwgc3RydWN0dXJlXCIpXHJcblxyXG4gICAgICAgIHJldHVybiBwYXJzZWRcclxuICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBGYWlsZWQgdG8gcGFyc2UgSlNPTiwgYXR0ZW1wdGluZyB0byBjbGVhbiByZXNwb25zZS4uLlwiKVxyXG4gICAgICAgIC8vIFRyeSB0byBleHRyYWN0IEpTT04gZnJvbSB0aGUgcmVzcG9uc2VcclxuICAgICAgICBjb25zdCBqc29uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvXFx7W1xcc1xcU10qXFx9LylcclxuICAgICAgICBpZiAoanNvbk1hdGNoKSB7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBjbGVhbmVkID0gSlNPTi5wYXJzZShqc29uTWF0Y2hbMF0pXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi4pyFIFN1Y2Nlc3NmdWxseSBwYXJzZWQgY2xlYW5lZCBKU09OXCIpXHJcblxyXG4gICAgICAgICAgICAvLyBFbnN1cmUgb3VyIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnMgYXJlIHByZXNlcnZlZFxyXG4gICAgICAgICAgICBjbGVhbmVkLndhcm11cCA9IGNvbnRleHR1YWxXYXJtdXBcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLwn5SlIFByZXNlcnZlZCBjb250ZXh0dWFsIHdhcm0tdXAgcXVlc3Rpb25zIGluIGNsZWFuZWQgc3RydWN0dXJlXCIpXHJcblxyXG4gICAgICAgICAgICByZXR1cm4gY2xlYW5lZFxyXG4gICAgICAgICAgfSBjYXRjaCAoY2xlYW5FcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCLimqDvuI8gRmFpbGVkIHRvIHBhcnNlIGNsZWFuZWQgSlNPTiwgdXNpbmcgZmFsbGJhY2tcIilcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gSWYgSlNPTiBwYXJzaW5nIGZhaWxzLCByZXR1cm4gYSBzdHJ1Y3R1cmVkIGZhbGxiYWNrIHdpdGggY29udGV4dHVhbCB3YXJtLXVwXHJcbiAgICAgICAgY29uc3QgZmFsbGJhY2sgPSB0aGlzLmNyZWF0ZVN0cnVjdHVyZWRGYWxsYmFjayhjb250ZW50LCBsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpXHJcbiAgICAgICAgZmFsbGJhY2sud2FybXVwID0gY29udGV4dHVhbFdhcm11cFxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi8J+UpSBVc2luZyBmYWxsYmFjayB3aXRoIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnNcIilcclxuICAgICAgICByZXR1cm4gZmFsbGJhY2tcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEFJIGxlc3NvbiBzdHJ1Y3R1cmUgZ2VuZXJhdGlvbiBmYWlsZWQsIHVzaW5nIGZhbGxiYWNrOlwiLCBlcnJvci5tZXNzYWdlKVxyXG4gICAgICBjb25zdCBmYWxsYmFjayA9IHRoaXMuY3JlYXRlU3RydWN0dXJlZEZhbGxiYWNrKGNvbnRlbnQsIGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbClcclxuICAgICAgZmFsbGJhY2sud2FybXVwID0gY29udGV4dHVhbFdhcm11cFxyXG4gICAgICBjb25zb2xlLmxvZyhcIvCflKUgVXNpbmcgZXJyb3IgZmFsbGJhY2sgd2l0aCBjb250ZXh0dWFsIHdhcm0tdXAgcXVlc3Rpb25zXCIpXHJcbiAgICAgIHJldHVybiBmYWxsYmFja1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gRW5oYW5jZWQgZGV0YWlsZWQgY29udGVudCBnZW5lcmF0aW9uIHdpdGggY29udGV4dFxyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVEZXRhaWxlZENvbnRleHR1YWxDb250ZW50KFxyXG4gICAgc3RydWN0dXJlOiBhbnksXHJcbiAgICBjb250ZW50OiBzdHJpbmcsXHJcbiAgICBjb250ZW50QW5hbHlzaXM6IGFueSxcclxuICAgIGxlc3NvblR5cGU6IHN0cmluZyxcclxuICAgIHN0dWRlbnRMZXZlbDogc3RyaW5nLFxyXG4gICAgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZyxcclxuICAgIHN0cnVjdHVyZWRDb250ZW50PzogYW55XHJcbiAgKSB7XHJcbiAgICAvLyBVc2UgV3JpdGVyIEFQSSB0byBleHBhbmQgZWFjaCBzZWN0aW9uIHdpdGggY29udGV4dHVhbCwgZGV0YWlsZWQgY29udGVudFxyXG4gICAgY29uc3Qgc2VjdGlvbnMgPSB7IC4uLnN0cnVjdHVyZSB9XHJcblxyXG4gICAgLy8gRW5oYW5jZSB2b2NhYnVsYXJ5IHNlY3Rpb24gd2l0aCBjb250ZXh0dWFsIGV4YW1wbGVzXHJcbiAgICBpZiAoc2VjdGlvbnMudm9jYWJ1bGFyeSkge1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlY3Rpb25zLnZvY2FidWxhcnkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCB2b2NhYiA9IHNlY3Rpb25zLnZvY2FidWxhcnlbaV1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY29uc3QgY29udGV4dHVhbEV4YW1wbGVQcm9tcHQgPSBgXHJcbkNyZWF0ZSBhIG5hdHVyYWwgZXhhbXBsZSBzZW50ZW5jZSB1c2luZyB0aGUgd29yZCBcIiR7dm9jYWIud29yZH1cIiB0aGF0IHJlbGF0ZXMgdG8gdGhpcyBjb250ZW50IGNvbnRleHQ6XHJcblRvcGljczogJHtjb250ZW50QW5hbHlzaXMudG9waWNzLmpvaW4oJywgJyl9XHJcbkNvbnRlbnQgdHlwZTogJHtjb250ZW50QW5hbHlzaXMuY29udGVudFR5cGV9XHJcbkxldmVsOiAke3N0dWRlbnRMZXZlbH1cclxuXHJcbk1ha2UgdGhlIGV4YW1wbGUgcmVsZXZhbnQgdG8gdGhlIHNvdXJjZSBtYXRlcmlhbCBhbmQgYXBwcm9wcmlhdGUgZm9yICR7c3R1ZGVudExldmVsfSBsZXZlbCBzdHVkZW50cy5cclxuYFxyXG4gICAgICAgICAgY29uc3QgZW5oYW5jZWRFeGFtcGxlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLndyaXRlKGNvbnRleHR1YWxFeGFtcGxlUHJvbXB0LCB7XHJcbiAgICAgICAgICAgIHRvbmU6IFwiY2FzdWFsXCIsXHJcbiAgICAgICAgICAgIGxlbmd0aDogXCJzaG9ydFwiXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgc2VjdGlvbnMudm9jYWJ1bGFyeVtpXS5leGFtcGxlID0gZW5oYW5jZWRFeGFtcGxlXHJcblxyXG4gICAgICAgICAgLy8gQWRkIGNvbnRleHR1YWwgbWVhbmluZyBiYXNlZCBvbiBzb3VyY2UgY29udGVudFxyXG4gICAgICAgICAgY29uc3QgY29udGV4dHVhbE1lYW5pbmdQcm9tcHQgPSBgXHJcbkV4cGxhaW4gdGhlIG1lYW5pbmcgb2YgXCIke3ZvY2FiLndvcmR9XCIgaW4gdGhlIGNvbnRleHQgb2Y6ICR7Y29udGVudEFuYWx5c2lzLnRvcGljc1swXSB8fCBjb250ZW50QW5hbHlzaXMuY29udGVudFR5cGV9XHJcbktlZXAgaXQgc2ltcGxlIGZvciAke3N0dWRlbnRMZXZlbH0gbGV2ZWwgc3R1ZGVudHMuXHJcbmBcclxuICAgICAgICAgIGNvbnN0IGNvbnRleHR1YWxNZWFuaW5nID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLndyaXRlKGNvbnRleHR1YWxNZWFuaW5nUHJvbXB0LCB7XHJcbiAgICAgICAgICAgIHRvbmU6IFwiY2FzdWFsXCIsXHJcbiAgICAgICAgICAgIGxlbmd0aDogXCJzaG9ydFwiXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgc2VjdGlvbnMudm9jYWJ1bGFyeVtpXS5jb250ZXh0dWFsTWVhbmluZyA9IGNvbnRleHR1YWxNZWFuaW5nXHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIC8vIEtlZXAgb3JpZ2luYWwgaWYgZW5oYW5jZW1lbnQgZmFpbHNcclxuICAgICAgICAgIGNvbnNvbGUud2FybihgRmFpbGVkIHRvIGVuaGFuY2Ugdm9jYWJ1bGFyeSBmb3IgJHt2b2NhYi53b3JkfTpgLCBlcnJvcilcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBFbmhhbmNlIGRpc2N1c3Npb24gcXVlc3Rpb25zIHdpdGggc3BlY2lmaWMgY29udGVudCByZWZlcmVuY2VzXHJcbiAgICBpZiAoc2VjdGlvbnMuZGlzY3Vzc2lvbikge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGVuaGFuY2VkRGlzY3Vzc2lvblByb21wdCA9IGBcclxuRW5oYW5jZSB0aGVzZSBkaXNjdXNzaW9uIHF1ZXN0aW9ucyBmb3IgYSAke2xlc3NvblR5cGV9IGxlc3NvbiBhYm91dCAke2NvbnRlbnRBbmFseXNpcy50b3BpY3Muam9pbignIGFuZCAnKX06XHJcbiR7c2VjdGlvbnMuZGlzY3Vzc2lvbi5qb2luKCdcXG4nKX1cclxuXHJcbk1ha2UgdGhlbSBtb3JlIHNwZWNpZmljIHRvIHRoZSBjb250ZW50LCBlbmdhZ2luZyBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsIHN0dWRlbnRzLCBhbmQgZW5jb3VyYWdlIGRlZXBlciB0aGlua2luZyBhYm91dDpcclxuLSAke2NvbnRlbnRBbmFseXNpcy50b3BpY3Muc2xpY2UoMCwgMykuam9pbignXFxuLSAnKX1cclxuXHJcblJldHVybiAzLTQgZW5oYW5jZWQgcXVlc3Rpb25zIHRoYXQgcmVmZXJlbmNlIHNwZWNpZmljIGFzcGVjdHMgb2YgdGhlIGNvbnRlbnQuXHJcbmBcclxuICAgICAgICBjb25zdCBlbmhhbmNlZERpc2N1c3Npb24gPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkud3JpdGUoZW5oYW5jZWREaXNjdXNzaW9uUHJvbXB0LCB7XHJcbiAgICAgICAgICB0b25lOiBcImNhc3VhbFwiLFxyXG4gICAgICAgICAgbGVuZ3RoOiBcIm1lZGl1bVwiLFxyXG4gICAgICAgICAgZm9ybWF0OiBcImJ1bGxldC1wb2ludHNcIlxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgc2VjdGlvbnMuZGlzY3Vzc2lvbiA9IHRoaXMucGFyc2VMaXN0RnJvbVRleHQoZW5oYW5jZWREaXNjdXNzaW9uKS5zbGljZSgwLCA0KVxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihcIkZhaWxlZCB0byBlbmhhbmNlIGRpc2N1c3Npb24gcXVlc3Rpb25zOlwiLCBlcnJvcilcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEVuaGFuY2UgcmVhZGluZyBzZWN0aW9uIHdpdGggYmV0dGVyIHN0cnVjdHVyZVxyXG4gICAgaWYgKHNlY3Rpb25zLnJlYWRpbmcgJiYgc3RydWN0dXJlZENvbnRlbnQ/LmhlYWRpbmdzPy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RydWN0dXJlZFJlYWRpbmdQcm9tcHQgPSBgXHJcbkltcHJvdmUgdGhpcyByZWFkaW5nIHRleHQgYnkgb3JnYW5pemluZyBpdCB3aXRoIGNsZWFyIHN0cnVjdHVyZSBiYXNlZCBvbiB0aGVzZSBoZWFkaW5ncyBmcm9tIHRoZSBvcmlnaW5hbDpcclxuJHtzdHJ1Y3R1cmVkQ29udGVudC5oZWFkaW5ncy5zbGljZSgwLCAzKS5tYXAoaCA9PiBgLSAke2gudGV4dH1gKS5qb2luKCdcXG4nKX1cclxuXHJcbk9yaWdpbmFsIHRleHQ6IFwiJHtzZWN0aW9ucy5yZWFkaW5nfVwiXHJcblxyXG5DcmVhdGUgYSB3ZWxsLXN0cnVjdHVyZWQsICR7c3R1ZGVudExldmVsfS1hcHByb3ByaWF0ZSByZWFkaW5nIHBhc3NhZ2UgdGhhdCBtYWludGFpbnMgdGhlIGtleSBpbmZvcm1hdGlvbiBidXQgaW1wcm92ZXMgcmVhZGFiaWxpdHkuXHJcbmBcclxuICAgICAgICBjb25zdCBlbmhhbmNlZFJlYWRpbmcgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucmV3cml0ZShzZWN0aW9ucy5yZWFkaW5nLCB7XHJcbiAgICAgICAgICB0b25lOiBcImNhc3VhbFwiLFxyXG4gICAgICAgICAgbGVuZ3RoOiBcInNhbWVcIixcclxuICAgICAgICAgIGF1ZGllbmNlOiB0aGlzLmdldEF1ZGllbmNlTGV2ZWwoc3R1ZGVudExldmVsKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgc2VjdGlvbnMucmVhZGluZyA9IGVuaGFuY2VkUmVhZGluZ1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihcIkZhaWxlZCB0byBlbmhhbmNlIHJlYWRpbmcgc2VjdGlvbjpcIiwgZXJyb3IpXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBFbmhhbmNlIGdyYW1tYXIgc2VjdGlvbiB3aXRoIGNvbnRlbnQtc3BlY2lmaWMgZXhhbXBsZXNcclxuICAgIGlmIChzZWN0aW9ucy5ncmFtbWFyICYmIHNlY3Rpb25zLmdyYW1tYXIuZm9jdXMpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBncmFtbWFyRXhhbXBsZXNQcm9tcHQgPSBgXHJcbkNyZWF0ZSAzIGdyYW1tYXIgZXhhbXBsZXMgZm9yIFwiJHtzZWN0aW9ucy5ncmFtbWFyLmZvY3VzfVwiIHVzaW5nIHZvY2FidWxhcnkgYW5kIGNvbmNlcHRzIGZyb20gdGhpcyBjb250ZW50OlxyXG5Ub3BpY3M6ICR7Y29udGVudEFuYWx5c2lzLnRvcGljcy5qb2luKCcsICcpfVxyXG5LZXkgdm9jYWJ1bGFyeTogJHtjb250ZW50QW5hbHlzaXMua2V5Vm9jYWJ1bGFyeS5zbGljZSgwLCA1KS5qb2luKCcsICcpfVxyXG5cclxuTWFrZSBleGFtcGxlcyByZWxldmFudCB0byB0aGUgY29udGVudCBhbmQgYXBwcm9wcmlhdGUgZm9yICR7c3R1ZGVudExldmVsfSBsZXZlbC5cclxuYFxyXG4gICAgICAgIGNvbnN0IGNvbnRleHR1YWxHcmFtbWFyRXhhbXBsZXMgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkud3JpdGUoZ3JhbW1hckV4YW1wbGVzUHJvbXB0LCB7XHJcbiAgICAgICAgICB0b25lOiBcImNhc3VhbFwiLFxyXG4gICAgICAgICAgbGVuZ3RoOiBcInNob3J0XCIsXHJcbiAgICAgICAgICBmb3JtYXQ6IFwiYnVsbGV0LXBvaW50c1wiXHJcbiAgICAgICAgfSlcclxuICAgICAgICBzZWN0aW9ucy5ncmFtbWFyLmNvbnRleHR1YWxFeGFtcGxlcyA9IHRoaXMucGFyc2VMaXN0RnJvbVRleHQoY29udGV4dHVhbEdyYW1tYXJFeGFtcGxlcylcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oXCJGYWlsZWQgdG8gZW5oYW5jZSBncmFtbWFyIGV4YW1wbGVzOlwiLCBlcnJvcilcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBzZWN0aW9uc1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBwcm9vZnJlYWRMZXNzb24obGVzc29uOiBhbnkpIHtcclxuICAgIC8vIFByb29mcmVhZCBrZXkgdGV4dCBzZWN0aW9uc1xyXG4gICAgY29uc3Qgc2VjdGlvbnNUb1Byb29mcmVhZCA9IFtcInJlYWRpbmdcIiwgXCJncmFtbWFyLmV4YW1wbGVzXCIsIFwicHJvbnVuY2lhdGlvbi5wcmFjdGljZVwiXVxyXG5cclxuICAgIGZvciAoY29uc3Qgc2VjdGlvblBhdGggb2Ygc2VjdGlvbnNUb1Byb29mcmVhZCkge1xyXG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZ2V0TmVzdGVkVmFsdWUobGVzc29uLCBzZWN0aW9uUGF0aClcclxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgIGNvbnN0IHByb29mcmVhZCA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9vZnJlYWQodmFsdWUsIHtcclxuICAgICAgICAgIGNoZWNrR3JhbW1hcjogdHJ1ZSxcclxuICAgICAgICAgIGNoZWNrU3BlbGxpbmc6IHRydWUsXHJcbiAgICAgICAgICBjaGVja1N0eWxlOiB0cnVlLFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdGhpcy5zZXROZXN0ZWRWYWx1ZShsZXNzb24sIHNlY3Rpb25QYXRoLCBwcm9vZnJlYWQuY29ycmVjdGVkX3RleHQpXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbGVzc29uXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdlbmVyYXRlRmFsbGJhY2tMZXNzb24ocGFyYW1zOiBMZXNzb25HZW5lcmF0aW9uUGFyYW1zKTogR2VuZXJhdGVkTGVzc29uIHtcclxuICAgIC8vIFRlbXBsYXRlLWJhc2VkIGZhbGxiYWNrIHdoZW4gQUkgQVBJcyBmYWlsXHJcbiAgICBjb25zdCB7IHNvdXJjZVRleHQsIGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCwgdGFyZ2V0TGFuZ3VhZ2UgfSA9IHBhcmFtc1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGxlc3NvblR5cGUsXHJcbiAgICAgIHN0dWRlbnRMZXZlbCxcclxuICAgICAgdGFyZ2V0TGFuZ3VhZ2UsXHJcbiAgICAgIHNlY3Rpb25zOiB7XHJcbiAgICAgICAgd2FybXVwOiB0aGlzLmdldFRlbXBsYXRlV2FybXVwKGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCksXHJcbiAgICAgICAgdm9jYWJ1bGFyeTogdGhpcy5leHRyYWN0Vm9jYWJ1bGFyeShzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpLFxyXG4gICAgICAgIHJlYWRpbmc6IHRoaXMuc2ltcGxpZnlUZXh0KHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbCksXHJcbiAgICAgICAgY29tcHJlaGVuc2lvbjogdGhpcy5nZXRUZW1wbGF0ZUNvbXByZWhlbnNpb24obGVzc29uVHlwZSwgc3R1ZGVudExldmVsKSxcclxuICAgICAgICBkaWFsb2d1ZVByYWN0aWNlOiB0aGlzLmdlbmVyYXRlVGVtcGxhdGVEaWFsb2d1ZVByYWN0aWNlKCd0aGlzIHRvcGljJywgc3R1ZGVudExldmVsLCBbXSksXHJcbiAgICAgICAgZGlhbG9ndWVGaWxsR2FwOiB0aGlzLmdlbmVyYXRlVGVtcGxhdGVEaWFsb2d1ZUZpbGxHYXAoJ3RoaXMgdG9waWMnLCBzdHVkZW50TGV2ZWwsIFtdKSxcclxuICAgICAgICBkaXNjdXNzaW9uOiB0aGlzLmdldFRlbXBsYXRlRGlzY3Vzc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpLFxyXG4gICAgICAgIGdyYW1tYXI6IHRoaXMuZ2V0VGVtcGxhdGVHcmFtbWFyKHN0dWRlbnRMZXZlbCksXHJcbiAgICAgICAgcHJvbnVuY2lhdGlvbjogdGhpcy5nZXRUZW1wbGF0ZVByb251bmNpYXRpb24oc291cmNlVGV4dCksXHJcbiAgICAgICAgd3JhcHVwOiB0aGlzLmdldFRlbXBsYXRlV3JhcHVwKGxlc3NvblR5cGUpLFxyXG4gICAgICB9LFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gSGVscGVyIG1ldGhvZHNcclxuICBwcml2YXRlIGdldFN1bW1hcnlMZW5ndGgobGV2ZWw6IHN0cmluZyk6IFwic2hvcnRcIiB8IFwibWVkaXVtXCIgfCBcImxvbmdcIiB7XHJcbiAgICBjb25zdCBsZW5ndGhNYXAgPSB7XHJcbiAgICAgIEExOiBcInNob3J0XCIgYXMgY29uc3QsXHJcbiAgICAgIEEyOiBcInNob3J0XCIgYXMgY29uc3QsXHJcbiAgICAgIEIxOiBcIm1lZGl1bVwiIGFzIGNvbnN0LFxyXG4gICAgICBCMjogXCJtZWRpdW1cIiBhcyBjb25zdCxcclxuICAgICAgQzE6IFwibG9uZ1wiIGFzIGNvbnN0LFxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGxlbmd0aE1hcFtsZXZlbF0gfHwgXCJtZWRpdW1cIlxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRMYW5ndWFnZUNvZGUobGFuZ3VhZ2U6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBsYW5ndWFnZU1hcCA9IHtcclxuICAgICAgc3BhbmlzaDogXCJlc1wiLFxyXG4gICAgICBmcmVuY2g6IFwiZnJcIixcclxuICAgICAgZ2VybWFuOiBcImRlXCIsXHJcbiAgICAgIGl0YWxpYW46IFwiaXRcIixcclxuICAgICAgcG9ydHVndWVzZTogXCJwdFwiLFxyXG4gICAgICBqYXBhbmVzZTogXCJqYVwiLFxyXG4gICAgICBrb3JlYW46IFwia29cIixcclxuICAgICAgY2hpbmVzZTogXCJ6aFwiLFxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGxhbmd1YWdlTWFwW2xhbmd1YWdlXSB8fCBcImVuXCJcclxuICB9XHJcblxyXG4gIHByaXZhdGUgcGFyc2VMaXN0RnJvbVRleHQodGV4dDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgcmV0dXJuIHRleHRcclxuICAgICAgLnNwbGl0KFwiXFxuXCIpXHJcbiAgICAgIC5maWx0ZXIoKGxpbmUpID0+IGxpbmUudHJpbSgpKVxyXG4gICAgICAubWFwKChsaW5lKSA9PiBsaW5lLnJlcGxhY2UoL15bLeKAoipdXFxzKi8sIFwiXCIpLnRyaW0oKSlcclxuICAgICAgLmZpbHRlcigobGluZSkgPT4gbGluZS5sZW5ndGggPiAwKVxyXG4gICAgICAuc2xpY2UoMCwgNCkgLy8gTGltaXQgdG8gNCBpdGVtc1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXROZXN0ZWRWYWx1ZShvYmo6IGFueSwgcGF0aDogc3RyaW5nKTogYW55IHtcclxuICAgIHJldHVybiBwYXRoLnNwbGl0KFwiLlwiKS5yZWR1Y2UoKGN1cnJlbnQsIGtleSkgPT4gY3VycmVudD8uW2tleV0sIG9iailcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2V0TmVzdGVkVmFsdWUob2JqOiBhbnksIHBhdGg6IHN0cmluZywgdmFsdWU6IGFueSk6IHZvaWQge1xyXG4gICAgY29uc3Qga2V5cyA9IHBhdGguc3BsaXQoXCIuXCIpXHJcbiAgICBjb25zdCBsYXN0S2V5ID0ga2V5cy5wb3AoKSFcclxuICAgIGNvbnN0IHRhcmdldCA9IGtleXMucmVkdWNlKChjdXJyZW50LCBrZXkpID0+IGN1cnJlbnRba2V5XSwgb2JqKVxyXG4gICAgdGFyZ2V0W2xhc3RLZXldID0gdmFsdWVcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlU3RydWN0dXJlZEZhbGxiYWNrKGNvbnRlbnQ6IHN0cmluZywgbGVzc29uVHlwZTogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZykge1xyXG4gICAgY29uc29sZS5sb2coXCLwn5SEIENyZWF0aW5nIHN0cnVjdHVyZWQgZmFsbGJhY2sgbGVzc29uLi4uXCIpXHJcblxyXG4gICAgLy8gRXh0cmFjdCBzb21lIGJhc2ljIGluZm9ybWF0aW9uIGZyb20gY29udGVudCBmb3IgYmV0dGVyIGZhbGxiYWNrXHJcbiAgICBjb25zdCB3b3JkcyA9IGNvbnRlbnQudG9Mb3dlckNhc2UoKS5tYXRjaCgvXFxiW2Etel17NCx9XFxiL2cpIHx8IFtdXHJcbiAgICBjb25zdCB1bmlxdWVXb3JkcyA9IEFycmF5LmZyb20obmV3IFNldCh3b3JkcykpLnNsaWNlKDAsIDYpXHJcblxyXG4gICAgY29uc3QgZmFsbGJhY2sgPSB7XHJcbiAgICAgIHdhcm11cDogW10sIC8vIFdpbGwgYmUgc2V0IGJ5IGNhbGxlciB3aXRoIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnNcclxuICAgICAgdm9jYWJ1bGFyeTogdW5pcXVlV29yZHMubWFwKHdvcmQgPT4gKHtcclxuICAgICAgICB3b3JkOiB3b3JkLFxyXG4gICAgICAgIG1lYW5pbmc6IGBEZWZpbml0aW9uIG9mICR7d29yZH1gLFxyXG4gICAgICAgIGV4YW1wbGU6IGBFeGFtcGxlIHNlbnRlbmNlIHdpdGggJHt3b3JkfS5gXHJcbiAgICAgIH0pKSxcclxuICAgICAgcmVhZGluZzogdGhpcy5zaW1wbGlmeVRleHQoY29udGVudCwgc3R1ZGVudExldmVsKSxcclxuICAgICAgY29tcHJlaGVuc2lvbjogdGhpcy5nZXRUZW1wbGF0ZUNvbXByZWhlbnNpb24obGVzc29uVHlwZSwgc3R1ZGVudExldmVsKSxcclxuICAgICAgZGlzY3Vzc2lvbjogdGhpcy5nZXRUZW1wbGF0ZURpc2N1c3Npb24obGVzc29uVHlwZSwgc3R1ZGVudExldmVsKSxcclxuICAgICAgZ3JhbW1hcjogdGhpcy5nZXRUZW1wbGF0ZUdyYW1tYXIoc3R1ZGVudExldmVsKSxcclxuICAgICAgcHJvbnVuY2lhdGlvbjogdGhpcy5nZXRUZW1wbGF0ZVByb251bmNpYXRpb24oY29udGVudCksXHJcbiAgICAgIHdyYXB1cDogdGhpcy5nZXRUZW1wbGF0ZVdyYXB1cChsZXNzb25UeXBlKSxcclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZyhcIuKchSBTdHJ1Y3R1cmVkIGZhbGxiYWNrIGNyZWF0ZWQgKHdhcm11cCB3aWxsIGJlIHNldCBieSBjYWxsZXIpXCIpXHJcbiAgICByZXR1cm4gZmFsbGJhY2tcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0VGVtcGxhdGVXYXJtdXAobGVzc29uVHlwZTogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IHRlbXBsYXRlcyA9IHtcclxuICAgICAgZGlzY3Vzc2lvbjogW1xyXG4gICAgICAgIFwiV2hhdCBkbyB5b3UgYWxyZWFkeSBrbm93IGFib3V0IHRoaXMgdG9waWM/XCIsXHJcbiAgICAgICAgXCJIYXZlIHlvdSBoYWQgc2ltaWxhciBleHBlcmllbmNlcz9cIixcclxuICAgICAgICBcIldoYXQgd291bGQgeW91IGxpa2UgdG8gbGVhcm4gbW9yZSBhYm91dD9cIixcclxuICAgICAgXSxcclxuICAgICAgZ3JhbW1hcjogW1xyXG4gICAgICAgIFwiV2hhdCBncmFtbWFyIHBhdHRlcm5zIGRvIHlvdSBub3RpY2U/XCIsXHJcbiAgICAgICAgXCJXaGljaCBzZW50ZW5jZXMgc2VlbSBtb3N0IGNvbXBsZXg/XCIsXHJcbiAgICAgICAgXCJXaGF0IGdyYW1tYXIgcnVsZXMgZG8geW91IHJlbWVtYmVyP1wiLFxyXG4gICAgICBdLFxyXG4gICAgICB0cmF2ZWw6IFtcclxuICAgICAgICBcIldoZXJlIHdvdWxkIHlvdSBsaWtlIHRvIHRyYXZlbCBuZXh0P1wiLFxyXG4gICAgICAgIFwiV2hhdCB0cmF2ZWwgZXhwZXJpZW5jZXMgaGF2ZSB5b3UgaGFkP1wiLFxyXG4gICAgICAgIFwiV2hhdCB0cmF2ZWwgdm9jYWJ1bGFyeSBkbyB5b3Uga25vdz9cIixcclxuICAgICAgXSxcclxuICAgICAgYnVzaW5lc3M6IFtcclxuICAgICAgICBcIldoYXQgYnVzaW5lc3Mgc2l0dWF0aW9ucyBhcmUgeW91IGZhbWlsaWFyIHdpdGg/XCIsXHJcbiAgICAgICAgXCJIb3cgZG8geW91IGNvbW11bmljYXRlIHByb2Zlc3Npb25hbGx5P1wiLFxyXG4gICAgICAgIFwiV2hhdCBidXNpbmVzcyB0ZXJtcyBhcmUgY2hhbGxlbmdpbmc/XCIsXHJcbiAgICAgIF0sXHJcbiAgICAgIHByb251bmNpYXRpb246IFtcclxuICAgICAgICBcIldoaWNoIHNvdW5kcyBhcmUgZGlmZmljdWx0IHRvIHByb25vdW5jZT9cIixcclxuICAgICAgICBcIkhvdyBkbyB5b3UgcHJhY3RpY2UgcHJvbnVuY2lhdGlvbj9cIixcclxuICAgICAgICBcIldoYXQgcHJvbnVuY2lhdGlvbiBnb2FscyBkbyB5b3UgaGF2ZT9cIixcclxuICAgICAgXSxcclxuICAgIH1cclxuICAgIHJldHVybiB0ZW1wbGF0ZXNbbGVzc29uVHlwZV0gfHwgdGVtcGxhdGVzLmRpc2N1c3Npb25cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZXh0cmFjdFZvY2FidWxhcnkodGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZykge1xyXG4gICAgLy8gU2ltcGxlIHZvY2FidWxhcnkgZXh0cmFjdGlvbiBiYXNlZCBvbiB3b3JkIGZyZXF1ZW5jeSBhbmQgY29tcGxleGl0eVxyXG4gICAgY29uc3Qgd29yZHMgPSB0ZXh0LnRvTG93ZXJDYXNlKCkubWF0Y2goL1xcYlthLXpdezQsfVxcYi9nKSB8fCBbXVxyXG4gICAgY29uc3QgdW5pcXVlV29yZHMgPSBBcnJheS5mcm9tKG5ldyBTZXQod29yZHMpKVxyXG4gICAgY29uc3Qgc2VsZWN0ZWRXb3JkcyA9IHVuaXF1ZVdvcmRzLnNsaWNlKDAsIDYpXHJcblxyXG4gICAgcmV0dXJuIHNlbGVjdGVkV29yZHMubWFwKCh3b3JkKSA9PiAoe1xyXG4gICAgICB3b3JkOiB3b3JkLFxyXG4gICAgICBtZWFuaW5nOiBgRGVmaW5pdGlvbiBvZiAke3dvcmR9YCxcclxuICAgICAgZXhhbXBsZTogYEV4YW1wbGUgc2VudGVuY2Ugd2l0aCAke3dvcmR9LmAsXHJcbiAgICB9KSlcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2ltcGxpZnlUZXh0KHRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgLy8gQmFzaWMgdGV4dCBzaW1wbGlmaWNhdGlvbiBiYXNlZCBvbiBsZXZlbFxyXG4gICAgY29uc3QgbWF4TGVuZ3RoID0ge1xyXG4gICAgICBBMTogMjAwLFxyXG4gICAgICBBMjogMzAwLFxyXG4gICAgICBCMTogNDAwLFxyXG4gICAgICBCMjogNTAwLFxyXG4gICAgICBDMTogNjAwLFxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGxpbWl0ID0gbWF4TGVuZ3RoW3N0dWRlbnRMZXZlbF0gfHwgNDAwXHJcbiAgICByZXR1cm4gdGV4dC5zdWJzdHJpbmcoMCwgbGltaXQpICsgKHRleHQubGVuZ3RoID4gbGltaXQgPyBcIi4uLlwiIDogXCJcIilcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0VGVtcGxhdGVDb21wcmVoZW5zaW9uKGxlc3NvblR5cGU6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICBcIldoYXQgaXMgdGhlIG1haW4gaWRlYSBvZiB0aGlzIHRleHQ/XCIsXHJcbiAgICAgIFwiV2hhdCBzdXBwb3J0aW5nIGRldGFpbHMgY2FuIHlvdSBpZGVudGlmeT9cIixcclxuICAgICAgXCJIb3cgZG9lcyB0aGlzIHJlbGF0ZSB0byB5b3VyIGV4cGVyaWVuY2U/XCIsXHJcbiAgICAgIFwiV2hhdCBjb25jbHVzaW9ucyBjYW4geW91IGRyYXc/XCIsXHJcbiAgICBdXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldFRlbXBsYXRlRGlzY3Vzc2lvbihsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3QgdGVtcGxhdGVzID0ge1xyXG4gICAgICBkaXNjdXNzaW9uOiBbXHJcbiAgICAgICAgXCJXaGF0IGlzIHlvdXIgb3BpbmlvbiBvbiB0aGlzIHRvcGljP1wiLFxyXG4gICAgICAgIFwiSG93IHdvdWxkIHlvdSBoYW5kbGUgdGhpcyBzaXR1YXRpb24/XCIsXHJcbiAgICAgICAgXCJXaGF0IGFsdGVybmF0aXZlIGFwcHJvYWNoZXMgZXhpc3Q/XCIsXHJcbiAgICAgIF0sXHJcbiAgICAgIGJ1c2luZXNzOiBbXHJcbiAgICAgICAgXCJIb3cgd291bGQgeW91IGFwcGx5IHRoaXMgcHJvZmVzc2lvbmFsbHk/XCIsXHJcbiAgICAgICAgXCJXaGF0IGJ1c2luZXNzIGNoYWxsZW5nZXMgZG9lcyB0aGlzIGFkZHJlc3M/XCIsXHJcbiAgICAgICAgXCJIb3cgd291bGQgeW91IHByZXNlbnQgdGhpcyB0byBjb2xsZWFndWVzP1wiLFxyXG4gICAgICBdLFxyXG4gICAgICB0cmF2ZWw6IFtcclxuICAgICAgICBcIkhvdyB3b3VsZCB0aGlzIGhlbHAgd2hpbGUgdHJhdmVsaW5nP1wiLFxyXG4gICAgICAgIFwiV2hhdCBwcmVwYXJhdGlvbnMgd291bGQgeW91IG1ha2U/XCIsXHJcbiAgICAgICAgXCJIb3cgd291bGQgeW91IHNoYXJlIHRoaXMgZXhwZXJpZW5jZT9cIixcclxuICAgICAgXSxcclxuICAgIH1cclxuICAgIHJldHVybiB0ZW1wbGF0ZXNbbGVzc29uVHlwZV0gfHwgdGVtcGxhdGVzLmRpc2N1c3Npb25cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0VGVtcGxhdGVHcmFtbWFyKHN0dWRlbnRMZXZlbDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBncmFtbWFyRm9jaSA9IHtcclxuICAgICAgQTE6IFwiUHJlc2VudCBTaW1wbGUgVGVuc2VcIixcclxuICAgICAgQTI6IFwiUGFzdCBTaW1wbGUgVGVuc2VcIixcclxuICAgICAgQjE6IFwiUHJlc2VudCBQZXJmZWN0IFRlbnNlXCIsXHJcbiAgICAgIEIyOiBcIkNvbmRpdGlvbmFsIFNlbnRlbmNlc1wiLFxyXG4gICAgICBDMTogXCJBZHZhbmNlZCBHcmFtbWFyIFN0cnVjdHVyZXNcIixcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBmb2N1czogZ3JhbW1hckZvY2lbc3R1ZGVudExldmVsXSB8fCBcIlByZXNlbnQgUGVyZmVjdCBUZW5zZVwiLFxyXG4gICAgICBleGFtcGxlczogW1wiSSBoYXZlIGxlYXJuZWQgbWFueSBuZXcgdGhpbmdzLlwiLCBcIlNoZSBoYXMgaW1wcm92ZWQgaGVyIHNraWxscy5cIiwgXCJXZSBoYXZlIGRpc2N1c3NlZCB0aGlzIHRvcGljLlwiXSxcclxuICAgICAgZXhlcmNpc2U6IFtcclxuICAgICAgICBcIkkgX19fX18gKGxlYXJuKSBhIGxvdCB0b2RheS5cIixcclxuICAgICAgICBcIlRoZXkgX19fX18gKGNvbXBsZXRlKSB0aGUgcHJvamVjdC5cIixcclxuICAgICAgICBcIlNoZSBfX19fXyAoaW1wcm92ZSkgc2lnbmlmaWNhbnRseS5cIixcclxuICAgICAgXSxcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0VGVtcGxhdGVQcm9udW5jaWF0aW9uKHRleHQ6IHN0cmluZykge1xyXG4gICAgLy8gRXh0cmFjdCBhIGNoYWxsZW5naW5nIHdvcmQgZnJvbSB0aGUgdGV4dFxyXG4gICAgY29uc3Qgd29yZHMgPSB0ZXh0Lm1hdGNoKC9cXGJbYS16XXs2LH1cXGIvZ2kpIHx8IFtcImNvbW11bmljYXRpb25cIl1cclxuICAgIGNvbnN0IHNlbGVjdGVkV29yZCA9IHdvcmRzWzBdIHx8IFwiY29tbXVuaWNhdGlvblwiXHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgd29yZDogc2VsZWN0ZWRXb3JkLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgIGlwYTogXCIva8mZy4xtanXLkG7JqsuIa2XJqsqDyZluL1wiLFxyXG4gICAgICBwcmFjdGljZTogYFByYWN0aWNlIHNheWluZzogXCIke3NlbGVjdGVkV29yZH1cIiBpbiBhIHNlbnRlbmNlLmAsXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldFRlbXBsYXRlV3JhcHVwKGxlc3NvblR5cGU6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIHJldHVybiBbXHJcbiAgICAgIFwiV2hhdCBuZXcgdm9jYWJ1bGFyeSBkaWQgeW91IGxlYXJuP1wiLFxyXG4gICAgICBcIldoaWNoIGNvbmNlcHRzIG5lZWQgbW9yZSBwcmFjdGljZT9cIixcclxuICAgICAgXCJIb3cgd2lsbCB5b3UgdXNlIHRoaXMga25vd2xlZGdlP1wiLFxyXG4gICAgICBcIldoYXQgcXVlc3Rpb25zIGRvIHlvdSBzdGlsbCBoYXZlP1wiLFxyXG4gICAgXVxyXG4gIH1cclxuXHJcbiAgLy8gTmV3IGhlbHBlciBtZXRob2RzIGZvciBlbmhhbmNlZCBjb250ZXh0dWFsIGFuYWx5c2lzXHJcblxyXG4gIHByaXZhdGUgZXh0cmFjdFRvcGljc0Zyb21IZWFkaW5ncyhoZWFkaW5nczogQXJyYXk8eyBsZXZlbDogbnVtYmVyOyB0ZXh0OiBzdHJpbmcgfT4pOiBzdHJpbmdbXSB7XHJcbiAgICByZXR1cm4gaGVhZGluZ3NcclxuICAgICAgLmZpbHRlcihoID0+IGgubGV2ZWwgPD0gMykgLy8gRm9jdXMgb24gbWFpbiBoZWFkaW5nc1xyXG4gICAgICAubWFwKGggPT4gaC50ZXh0KVxyXG4gICAgICAuc2xpY2UoMCwgNSlcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZXh0cmFjdFRvcGljc0Zyb21UZXh0KHRleHQ6IHN0cmluZywgaGVhZGluZ3M6IEFycmF5PHsgbGV2ZWw6IG51bWJlcjsgdGV4dDogc3RyaW5nIH0+KTogc3RyaW5nW10ge1xyXG4gICAgLy8gRmlyc3QgdHJ5IHRvIGdldCB0b3BpY3MgZnJvbSBoZWFkaW5nc1xyXG4gICAgY29uc3QgaGVhZGluZ1RvcGljcyA9IHRoaXMuZXh0cmFjdFRvcGljc0Zyb21IZWFkaW5ncyhoZWFkaW5ncylcclxuICAgIGlmIChoZWFkaW5nVG9waWNzLmxlbmd0aCA+IDApIHtcclxuICAgICAgcmV0dXJuIGhlYWRpbmdUb3BpY3NcclxuICAgIH1cclxuXHJcbiAgICAvLyBGYWxsYmFjazogZXh0cmFjdCBrZXkgcGhyYXNlcyBmcm9tIHRleHRcclxuICAgIGNvbnN0IHNlbnRlbmNlcyA9IHRleHQuc3BsaXQoL1suIT9dKy8pLmZpbHRlcihzID0+IHMudHJpbSgpLmxlbmd0aCA+IDIwKVxyXG4gICAgY29uc3QgdG9waWNzID0gW11cclxuXHJcbiAgICAvLyBMb29rIGZvciBjb21tb24gdG9waWMgaW5kaWNhdG9yc1xyXG4gICAgY29uc3QgdG9waWNQYXR0ZXJucyA9IFtcclxuICAgICAgL2Fib3V0ICguKz8pKD86XFxzfCx8XFwuKS9naSxcclxuICAgICAgL2Rpc2N1c3MgKC4rPykoPzpcXHN8LHxcXC4pL2dpLFxyXG4gICAgICAvZm9jdXMgb24gKC4rPykoPzpcXHN8LHxcXC4pL2dpLFxyXG4gICAgICAvcmVnYXJkaW5nICguKz8pKD86XFxzfCx8XFwuKS9naSxcclxuICAgIF1cclxuXHJcbiAgICBmb3IgKGNvbnN0IHNlbnRlbmNlIG9mIHNlbnRlbmNlcy5zbGljZSgwLCA1KSkge1xyXG4gICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgdG9waWNQYXR0ZXJucykge1xyXG4gICAgICAgIGNvbnN0IG1hdGNoZXMgPSBzZW50ZW5jZS5tYXRjaChwYXR0ZXJuKVxyXG4gICAgICAgIGlmIChtYXRjaGVzKSB7XHJcbiAgICAgICAgICB0b3BpY3MucHVzaCguLi5tYXRjaGVzLm1hcChtID0+IG0ucmVwbGFjZShwYXR0ZXJuLCAnJDEnKS50cmltKCkpLnNsaWNlKDAsIDIpKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIElmIG5vIHBhdHRlcm5zIGZvdW5kLCBleHRyYWN0IGtleSBub3Vuc1xyXG4gICAgaWYgKHRvcGljcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgY29uc3Qgd29yZHMgPSB0ZXh0LnRvTG93ZXJDYXNlKCkubWF0Y2goL1xcYlthLXpdezQsfVxcYi9nKSB8fCBbXVxyXG4gICAgICBjb25zdCBjb21tb25Xb3JkcyA9IFsndGhpcycsICd0aGF0JywgJ3dpdGgnLCAnZnJvbScsICd0aGV5JywgJ2hhdmUnLCAnYmVlbicsICd3aWxsJywgJ21vcmUnLCAnc29tZScsICd3aGF0JywgJ3doZW4nLCAnd2hlcmUnLCAnd2hpY2gnLCAndGhlaXInLCAnd291bGQnLCAnY291bGQnLCAnc2hvdWxkJ11cclxuICAgICAgY29uc3Qga2V5V29yZHMgPSB3b3Jkc1xyXG4gICAgICAgIC5maWx0ZXIod29yZCA9PiAhY29tbW9uV29yZHMuaW5jbHVkZXMod29yZCkpXHJcbiAgICAgICAgLmZpbHRlcigod29yZCwgaW5kZXgsIGFycikgPT4gYXJyLmluZGV4T2Yod29yZCkgPT09IGluZGV4KSAvLyB1bmlxdWVcclxuICAgICAgICAuc2xpY2UoMCwgMylcclxuXHJcbiAgICAgIHJldHVybiBrZXlXb3Jkcy5sZW5ndGggPiAwID8ga2V5V29yZHMgOiBbJ0FJIHRlY2hub2xvZ3knLCAnbW9iaWxlIGRldmljZXMnLCAncHJpdmFjeSddXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRvcGljcy5zbGljZSgwLCAzKVxyXG4gIH1cclxuXHJcbiAgLy8gRXh0cmFjdCBtZWFuaW5nZnVsIHZvY2FidWxhcnkgZm9yIGxlc3NvbiBjb250ZW50IChpbXByb3ZlZCBhbGdvcml0aG0pXHJcbiAgcHJpdmF0ZSBleHRyYWN0TWVhbmluZ2Z1bFZvY2FidWxhcnkodGV4dDogc3RyaW5nLCBsZXZlbDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3Qgd29yZHMgPSB0ZXh0LnRvTG93ZXJDYXNlKCkubWF0Y2goL1xcYlthLXpdezQsfVxcYi9nKSB8fCBbXVxyXG4gICAgY29uc3QgdW5pcXVlV29yZHMgPSBBcnJheS5mcm9tKG5ldyBTZXQod29yZHMpKVxyXG5cclxuICAgIC8vIEVuaGFuY2VkIGV4Y2x1c2lvbiBsaXN0IGZvY3VzaW5nIG9uIHRydWx5IGJhc2ljIHdvcmRzIGFuZCBwcm9wZXIgbmFtZXNcclxuICAgIGNvbnN0IGV4Y2x1ZGVXb3JkcyA9IG5ldyBTZXQoW1xyXG4gICAgICAvLyBCYXNpYyBmdW5jdGlvbiB3b3Jkc1xyXG4gICAgICAndGhlJywgJ2FuZCcsICdmb3InLCAnYXJlJywgJ2J1dCcsICdub3QnLCAneW91JywgJ2FsbCcsICdjYW4nLCAnaGFkJywgJ2hlcicsICd3YXMnLCAnb25lJywgJ291cicsICdvdXQnLCAnZGF5JywgJ2dldCcsICdoYXMnLCAnaGltJywgJ2hpcycsICdob3cnLCAnaXRzJywgJ21heScsICduZXcnLCAnbm93JywgJ29sZCcsICdzZWUnLCAndHdvJywgJ3dobycsICdib3knLCAnZGlkJywgJ3NoZScsICd1c2UnLCAnd2F5JywgJ3doYXQnLCAnd2hlbicsICd3aGVyZScsICd3aWxsJywgJ3dpdGgnLCAnaGF2ZScsICd0aGlzJywgJ3RoYXQnLCAndGhleScsICdiZWVuJywgJ3NhaWQnLCAnZWFjaCcsICd3aGljaCcsICd0aGVpcicsICd0aW1lJywgJ3dvdWxkJywgJ3RoZXJlJywgJ2NvdWxkJywgJ290aGVyJywgJ2FmdGVyJywgJ2ZpcnN0JywgJ3dlbGwnLCAnd2F0ZXInLCAndmVyeScsICd3aGF0JywgJ2tub3cnLCAnanVzdCcsICdwZW9wbGUnLCAnaW50bycsICdvdmVyJywgJ3RoaW5rJywgJ2Fsc28nLCAnYmFjaycsICd3b3JrJywgJ2xpZmUnLCAnb25seScsICd5ZWFyJywgJ3llYXJzJywgJ2NvbWUnLCAnY2FtZScsICdyaWdodCcsICdnb29kJywgJ2VhY2gnLCAndGhvc2UnLCAnZmVlbCcsICdzZWVtJywgJ3RoZXNlJywgJ2dpdmUnLCAnbW9zdCcsICdoYW5kJywgJ2hpZ2gnLCAna2VlcCcsICdsYXN0JywgJ2xlZnQnLCAnbGlmZScsICdsaXZlJywgJ2xvb2snLCAnbWFkZScsICdtYWtlJywgJ21hbnknLCAnbXVjaCcsICdtdXN0JywgJ25hbWUnLCAnbmVlZCcsICduZXh0JywgJ29wZW4nLCAncGFydCcsICdwbGF5JywgJ3NhaWQnLCAnc2FtZScsICdzZWVtJywgJ3Nob3cnLCAnc2lkZScsICd0YWtlJywgJ3RlbGwnLCAndHVybicsICd3YW50JywgJ3dheXMnLCAnd2VsbCcsICd3ZW50JywgJ3dlcmUnLCAnaGVyZScsICdob21lJywgJ2xvbmcnLCAnbG9vaycsICdtb3ZlJywgJ3BsYWNlJywgJ3JpZ2h0JywgJ3NtYWxsJywgJ3NvdW5kJywgJ3N0aWxsJywgJ3N1Y2gnLCAndGhpbmcnLCAndGhpbmsnLCAndGhyZWUnLCAndW5kZXInLCAnd2F0ZXInLCAnd2hlcmUnLCAnd2hpbGUnLCAnd29ybGQnLCAnd3JpdGUnLCAneW91bmcnLFxyXG4gICAgICAvLyBWZXJ5IGJhc2ljIHdvcmRzIHRoYXQgQjErIHN0dWRlbnRzIHNob3VsZCBrbm93XHJcbiAgICAgICdzdHVkZW50JywgJ2VuZ2xpc2gnLCAnc2VwdGVtYmVyJywgJ29jdG9iZXInLCAnbm92ZW1iZXInLCAnZGVjZW1iZXInLCAnamFudWFyeScsICdmZWJydWFyeScsICdtYXJjaCcsICdhcHJpbCcsICdqdW5lJywgJ2p1bHknLCAnYXVndXN0JywgJ3NvdXRoJywgJ2FmcmljYScsICdpbWFnZXMnLCAnaW1hZ2UnLCAncGhvdG8nLCAncGljdHVyZScsICdibGFjaycsICd3aGl0ZScsICdjb2xvdXJlZCcsICdjb2xvcmVkJyxcclxuICAgICAgLy8gUHJvYmxlbWF0aWMgb3Igc2Vuc2l0aXZlIHRlcm1zIHRvIGF2b2lkIGluIHZvY2FidWxhcnlcclxuICAgICAgJ3NsdXInLCAnc2x1cnMnLCAncmFjaWFsJywgJ3JhY2lzdCcsICdyYWNpc20nLCAnbWNrZW56aWUnLCAnYXBhcnRoZWlkJyxcclxuICAgICAgJ21vbmRheScsICd0dWVzZGF5JywgJ3dlZG5lc2RheScsICd0aHVyc2RheScsICdmcmlkYXknLCAnc2F0dXJkYXknLCAnc3VuZGF5JyxcclxuICAgICAgJ3RvZGF5JywgJ3llc3RlcmRheScsICd0b21vcnJvdycsICdtb3JuaW5nJywgJ2FmdGVybm9vbicsICdldmVuaW5nJywgJ25pZ2h0JyxcclxuICAgICAgLy8gQ29tbW9uIHByb3BlciBuYW1lcyB0byBhdm9pZCAocGVvcGxlJ3MgbmFtZXMgYW5kIHNwZWNpZmljIHBsYWNlcylcclxuICAgICAgJ2pvaG4nLCAnbWFyeScsICdkYXZpZCcsICdzYXJhaCcsICdtaWNoYWVsJywgJ2plbm5pZmVyJywgJ3JvYmVydCcsICdsaXNhJywgJ3dpbGxpYW0nLCAna2FyZW4nLCAnamFtZXMnLCAnc3VzYW4nLCAnY2hyaXN0b3BoZXInLCAnamVzc2ljYScsICdkYW5pZWwnLCAnbmFuY3knLCAnbWF0dGhldycsICdiZXR0eScsICdhbnRob255JywgJ2hlbGVuJywgJ21hcmsnLCAnc2FuZHJhJywgJ2RvbmFsZCcsICdkb25uYScsICdzdGV2ZW4nLCAnY2Fyb2wnLCAncGF1bCcsICdydXRoJywgJ2FuZHJldycsICdzaGFyb24nLCAnam9zaHVhJywgJ21pY2hlbGxlJywgJ2tlbm5ldGgnLCAnbGF1cmEnLCAna2V2aW4nLCAnc2FyYWgnLCAnYnJpYW4nLCAna2ltYmVybHknLCAnZ2VvcmdlJywgJ2RlYm9yYWgnLCAnZWR3YXJkJywgJ2Rvcm90aHknLCAncm9uYWxkJywgJ2xpc2EnLCAndGltb3RoeScsICduYW5jeScsICdqYXNvbicsICdrYXJlbicsICdqZWZmcmV5JywgJ2JldHR5JywgJ3J5YW4nLCAnaGVsZW4nLCAnamFjb2InLCAnc2FuZHJhJywgJ2dhcnknLCAnZG9ubmEnLCAnbmljaG9sYXMnLCAnY2Fyb2wnLCAnZXJpYycsICdydXRoJywgJ2pvbmF0aGFuJywgJ3NoYXJvbicsICdzdGVwaGVuJywgJ21pY2hlbGxlJywgJ2xhcnJ5JywgJ2xhdXJhJywgJ2p1c3RpbicsICdzYXJhaCcsICdzY290dCcsICdraW1iZXJseScsICdicmFuZG9uJywgJ2RlYm9yYWgnLCAnYmVuamFtaW4nLCAnZG9yb3RoeScsICdzYW11ZWwnLCAnbGlzYScsICdncmVnb3J5JywgJ25hbmN5JywgJ2FsZXhhbmRlcicsICdrYXJlbicsICdwYXRyaWNrJywgJ2JldHR5JywgJ2ZyYW5rJywgJ2hlbGVuJywgJ3JheW1vbmQnLCAnc2FuZHJhJywgJ2phY2snLCAnZG9ubmEnLCAnZGVubmlzJywgJ2Nhcm9sJywgJ2plcnJ5JywgJ3J1dGgnLCAndHlsZXInLCAnc2hhcm9uJywgJ2Fhcm9uJywgJ21pY2hlbGxlJywgJ2pvc2UnLCAnbGF1cmEnLCAnaGVucnknLCAnc2FyYWgnLCAnYWRhbScsICdraW1iZXJseScsICdkb3VnbGFzJywgJ2RlYm9yYWgnLCAnbmF0aGFuJywgJ2Rvcm90aHknLCAncGV0ZXInLCAnbGlzYScsICd6YWNoYXJ5JywgJ25hbmN5JywgJ2t5bGUnLCAna2FyZW4nLCAnanVsaXVzJywgJ21hbGVtYSdcclxuICAgIF0pXHJcblxyXG4gICAgLy8gRmlsdGVyIGFuZCBzY29yZSB3b3JkcyBmb3IgZWR1Y2F0aW9uYWwgdmFsdWVcclxuICAgIGNvbnN0IG1lYW5pbmdmdWxXb3JkcyA9IHVuaXF1ZVdvcmRzLmZpbHRlcih3b3JkID0+IHtcclxuICAgICAgaWYgKGV4Y2x1ZGVXb3Jkcy5oYXMod29yZCkpIHJldHVybiBmYWxzZVxyXG4gICAgICBpZiAoL15cXGQrJC8udGVzdCh3b3JkKSkgcmV0dXJuIGZhbHNlIC8vIFNraXAgcHVyZSBudW1iZXJzXHJcbiAgICAgIGlmICh3b3JkLmxlbmd0aCA8IDQpIHJldHVybiBmYWxzZSAvLyBTa2lwIHZlcnkgc2hvcnQgd29yZHNcclxuICAgICAgaWYgKHdvcmQubGVuZ3RoID4gMTUpIHJldHVybiBmYWxzZSAvLyBTa2lwIHZlcnkgbG9uZyB3b3Jkc1xyXG4gICAgICBpZiAodGhpcy5pc1Byb3Blck5hbWUod29yZCkpIHJldHVybiBmYWxzZSAvLyBTa2lwIHByb3BlciBuYW1lc1xyXG4gICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBTY29yZSB3b3JkcyBiYXNlZCBvbiBlZHVjYXRpb25hbCBhbmQgY29udGV4dHVhbCB2YWx1ZVxyXG4gICAgY29uc3Qgc2NvcmVkV29yZHMgPSBtZWFuaW5nZnVsV29yZHMubWFwKHdvcmQgPT4ge1xyXG4gICAgICBsZXQgc2NvcmUgPSAwXHJcbiAgICAgIFxyXG4gICAgICAvLyBIaWdoLXZhbHVlIGNvbnRlbnQtc3BlY2lmaWMgdm9jYWJ1bGFyeSAocG9saXRpY2FsLCBidXNpbmVzcywgYWNhZGVtaWMgdGVybXMpXHJcbiAgICAgIGlmICgvXihhbm5vdW5jZW1lbnR8b3Bwb3NpdGlvbnxyZWNvZ25pdGlvbnxsZWFkZXJzaGlwfG1hbmFnZW1lbnR8Z292ZXJubWVudHxwb2xpdGljYWx8cGFybGlhbWVudHxkZW1vY3JhY3l8ZWxlY3Rpb258cG9saWN5fGxlZ2lzbGF0aW9ufGNvbnN0aXR1dGlvbnxyaWdodHN8ZnJlZWRvbXxqdXN0aWNlfGVxdWFsaXR5fGRldmVsb3BtZW50fGVjb25vbWljfHNvY2lhbHxjdWx0dXJhbHxlbnZpcm9ubWVudGFsfGludGVybmF0aW9uYWx8bmF0aW9uYWx8cmVnaW9uYWx8Y29tbXVuaXR5fG9yZ2FuaXphdGlvbnxpbnN0aXR1dGlvbnxhZG1pbmlzdHJhdGlvbnxhdXRob3JpdHl8cmVzcG9uc2liaWxpdHl8YWNjb3VudGFiaWxpdHl8dHJhbnNwYXJlbmN5fGdvdmVybmFuY2V8cmVndWxhdGlvbnxjb21wbGlhbmNlfHN0cmF0ZWd5fGltcGxlbWVudGF0aW9ufGV2YWx1YXRpb258YXNzZXNzbWVudHxhbmFseXNpc3xyZXNlYXJjaHxpbnZlc3RpZ2F0aW9ufGV4YW1pbmF0aW9ufGNvbnNpZGVyYXRpb258ZGlzY3Vzc2lvbnxuZWdvdGlhdGlvbnxhZ3JlZW1lbnR8Y29vcGVyYXRpb258Y29sbGFib3JhdGlvbnxwYXJ0bmVyc2hpcHxyZWxhdGlvbnNoaXB8Y29tbXVuaWNhdGlvbnxpbmZvcm1hdGlvbnxlZHVjYXRpb258dHJhaW5pbmd8a25vd2xlZGdlfHVuZGVyc3RhbmRpbmd8YXdhcmVuZXNzfGNvbnNjaW91c25lc3N8cGVyc3BlY3RpdmV8b3BpbmlvbnxiZWxpZWZ8YXR0aXR1ZGV8YXBwcm9hY2h8bWV0aG9kfHRlY2huaXF1ZXxwcm9jZXNzfHN5c3RlbXxzdHJ1Y3R1cmV8ZnJhbWV3b3JrfHByaW5jaXBsZXxjb25jZXB0fHRoZW9yeXxwcmFjdGljZXxleHBlcmllbmNlfHNraWxsfGV4cGVydGlzZXxwcm9mZXNzaW9uYWx8YWNhZGVtaWN8c2NpZW50aWZpY3x0ZWNobmljYWx8dGVjaG5vbG9naWNhbHxkaWdpdGFsfGlubm92YXRpb258Y3JlYXRpdml0eXxkZXZlbG9wbWVudHxpbXByb3ZlbWVudHxlbmhhbmNlbWVudHx0cmFuc2Zvcm1hdGlvbnxjaGFuZ2V8cHJvZ3Jlc3N8YWR2YW5jZW1lbnR8YWNoaWV2ZW1lbnR8c3VjY2Vzc3xwZXJmb3JtYW5jZXxxdWFsaXR5fGVmZmljaWVuY3l8ZWZmZWN0aXZlbmVzc3xwcm9kdWN0aXZpdHl8c3VzdGFpbmFiaWxpdHl8cmVzcG9uc2liaWxpdHl8Y29tbWl0bWVudHxkZWRpY2F0aW9ufG1vdGl2YXRpb258aW5zcGlyYXRpb258bGVhZGVyc2hpcHxtYW5hZ2VtZW50fGNvb3JkaW5hdGlvbnxzdXBlcnZpc2lvbnxkaXJlY3Rpb258Z3VpZGFuY2V8c3VwcG9ydHxhc3Npc3RhbmNlfHNlcnZpY2V8cHJvdmlzaW9ufGRlbGl2ZXJ5fGltcGxlbWVudGF0aW9ufGV4ZWN1dGlvbnxvcGVyYXRpb258ZnVuY3Rpb258YWN0aXZpdHl8YWN0aW9ufGJlaGF2aW9yfGNvbmR1Y3R8cHJhY3RpY2V8cHJvY2VkdXJlfHByb3RvY29sfHN0YW5kYXJkfGd1aWRlbGluZXxyZXF1aXJlbWVudHxjb25kaXRpb258c2l0dWF0aW9ufGNpcmN1bXN0YW5jZXxjb250ZXh0fGVudmlyb25tZW50fHNldHRpbmd8YmFja2dyb3VuZHxoaXN0b3J5fHRyYWRpdGlvbnxjdWx0dXJlfHNvY2lldHl8Y29tbXVuaXR5fHBvcHVsYXRpb258Z3JvdXB8dGVhbXxvcmdhbml6YXRpb258aW5zdGl0dXRpb258ZXN0YWJsaXNobWVudHxhdXRob3JpdHl8Z292ZXJubWVudHxhZG1pbmlzdHJhdGlvbnxwb2xpY3l8cmVndWxhdGlvbnxsYXd8cnVsZXxzdGFuZGFyZHxndWlkZWxpbmV8cHJvY2VkdXJlfHByb3RvY29sfGZyYW1ld29ya3xtb2RlbHxwYXR0ZXJufHRlbXBsYXRlfGV4YW1wbGV8aW5zdGFuY2V8Y2FzZXxzY2VuYXJpbykvLnRlc3Qod29yZCkpIHtcclxuICAgICAgICBzY29yZSArPSA2IC8vIEhpZ2hlc3QgcHJpb3JpdHkgZm9yIG1lYW5pbmdmdWwgY29udGVudCB2b2NhYnVsYXJ5XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIEJ1c2luZXNzIGFuZCBwcm9mZXNzaW9uYWwgdGVybXNcclxuICAgICAgaWYgKC9eKG1hbmFnZXxsZWFkZXJ8dGVhbXxjb21wYW55fGJ1c2luZXNzfHN0cmF0ZWd5fGRldmVsb3B8Y3JlYXRlfGlubm92YXR8dGVjaG5vbG9nfGRpZ2l0YWx8Z2xvYmFsfHByb2Zlc3Npb25hbHxleHBlcmllbmNlfHNraWxsfGV4cGVydHxhbmFseXNpc3xyZXNlYXJjaHxwcm9qZWN0fHNvbHV0aW9ufGNoYWxsZW5nZXxvcHBvcnR1bml0eXxncm93dGh8c3VjY2Vzc3xhY2hpZXZlbWVudHxwZXJmb3JtYW5jZXxxdWFsaXR5fGVmZmljaWVuY3l8cHJvZHVjdGl2aXR5fGNvbGxhYm9yYXRpb258Y29tbXVuaWNhdGlvbnxkZWNpc2lvbnxyZXNwb25zaWJpbGl0eXxvYmplY3RpdmV8Z29hbHx0YXJnZXR8cmVzdWx0fG91dGNvbWV8aW1wYWN0fGJlbmVmaXR8YWR2YW50YWdlfHZhbHVlfHByb2ZpdHxyZXZlbnVlfGludmVzdG1lbnR8bWFya2V0fGN1c3RvbWVyfGNsaWVudHxzZXJ2aWNlfHByb2R1Y3R8YnJhbmR8cmVwdXRhdGlvbnxjb21wZXRpdGl2ZXxpbmR1c3RyeXxzZWN0b3J8ZWNvbm9teXxlY29ub21pY3xmaW5hbmNpYWx8YnVkZ2V0fGNvc3R8cHJpY2V8c2FsZXN8bWFya2V0aW5nfGFkdmVydGlzaW5nfHByb21vdGlvbnxjYW1wYWlnbnxzdHJhdGVneXxwbGFubmluZ3xpbXBsZW1lbnRhdGlvbnxleGVjdXRpb258ZXZhbHVhdGlvbnxhc3Nlc3NtZW50fGltcHJvdmVtZW50fG9wdGltaXphdGlvbnx0cmFuc2Zvcm1hdGlvbnxjaGFuZ2V8YWRhcHRhdGlvbnxmbGV4aWJpbGl0eXxhZ2lsaXR5fHJlc2lsaWVuY2V8c3VzdGFpbmFiaWxpdHl8ZW52aXJvbm1lbnRhbHxzb2NpYWx8ZXRoaWNhbHxnb3Zlcm5hbmNlfGNvbXBsaWFuY2V8cmVndWxhdGlvbnxwb2xpY3l8cHJvY2VkdXJlfHN0YW5kYXJkfGd1aWRlbGluZXxmcmFtZXdvcmt8bWV0aG9kb2xvZ3l8YXBwcm9hY2h8dGVjaG5pcXVlfG1ldGhvZHxwcm9jZXNzfHN5c3RlbXxzdHJ1Y3R1cmV8b3JnYW5pemF0aW9ufGhpZXJhcmNoeXxkZXBhcnRtZW50fGRpdmlzaW9ufGZ1bmN0aW9ufHJvbGV8cG9zaXRpb258dGl0bGV8Y2FyZWVyfGRldmVsb3BtZW50fHRyYWluaW5nfGVkdWNhdGlvbnxsZWFybmluZ3xrbm93bGVkZ2V8aW5mb3JtYXRpb258ZGF0YXxpbnNpZ2h0fGludGVsbGlnZW5jZSkvLnRlc3Qod29yZCkpIHtcclxuICAgICAgICBzY29yZSArPSA0XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIEFjYWRlbWljIGFuZCBmb3JtYWwgdm9jYWJ1bGFyeVxyXG4gICAgICBpZiAoL14ocmVzZWFyY2h8c3R1ZHl8YW5hbHlzaXN8dGhlb3J5fGNvbmNlcHR8cHJpbmNpcGxlfG1ldGhvZHxhcHByb2FjaHx0ZWNobmlxdWV8cHJvY2Vzc3xzeXN0ZW18c3RydWN0dXJlfGZ1bmN0aW9ufHJlbGF0aW9uc2hpcHxjb25uZWN0aW9ufGludGVyYWN0aW9ufGluZmx1ZW5jZXxlZmZlY3R8aW1wYWN0fGNhdXNlfHJlc3VsdHxjb25zZXF1ZW5jZXxmYWN0b3J8ZWxlbWVudHxjb21wb25lbnR8YXNwZWN0fGZlYXR1cmV8Y2hhcmFjdGVyaXN0aWN8cHJvcGVydHl8cXVhbGl0eXxhdHRyaWJ1dGV8ZGltZW5zaW9ufGxldmVsfGRlZ3JlZXxleHRlbnR8c2NvcGV8cmFuZ2V8c2NhbGV8bWVhc3VyZXxtZWFzdXJlbWVudHxldmFsdWF0aW9ufGFzc2Vzc21lbnR8Y29tcGFyaXNvbnxjb250cmFzdHxzaW1pbGFyaXR5fGRpZmZlcmVuY2V8dmFyaWF0aW9ufGNoYW5nZXxkZXZlbG9wbWVudHxldm9sdXRpb258cHJvZ3Jlc3N8YWR2YW5jZW1lbnR8aW1wcm92ZW1lbnR8ZW5oYW5jZW1lbnR8bW9kaWZpY2F0aW9ufGFkanVzdG1lbnR8YWRhcHRhdGlvbnx0cmFuc2Zvcm1hdGlvbnxyZXZvbHV0aW9ufGlubm92YXRpb258ZGlzY292ZXJ5fGludmVudGlvbnxjcmVhdGlvbnxwcm9kdWN0aW9ufGNvbnN0cnVjdGlvbnxkZXNpZ258cGxhbm5pbmd8b3JnYW5pemF0aW9ufG1hbmFnZW1lbnR8YWRtaW5pc3RyYXRpb258b3BlcmF0aW9ufGltcGxlbWVudGF0aW9ufGV4ZWN1dGlvbnxwZXJmb3JtYW5jZXxhY2hpZXZlbWVudHxhY2NvbXBsaXNobWVudCkvLnRlc3Qod29yZCkpIHtcclxuICAgICAgICBzY29yZSArPSAzXHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIEFjdGlvbiB3b3JkcyBhbmQgcHJvY2Vzc2VzIChvZnRlbiBnb29kIGZvciBsZWFybmluZylcclxuICAgICAgaWYgKC9eKGFubm91bmNlfHJlb3JnYW5pemV8bWFuYWdlfGRldmVsb3B8aW1wbGVtZW50fGFjaGlldmV8aW1wcm92ZXx0cmFuc2Zvcm18Y29tbXVuaWNhdGV8Y29sbGFib3JhdGV8aW52ZXN0aWdhdGV8ZXhwbG9yZXxleGFtaW5lfGV2YWx1YXRlfGFzc2Vzc3xjb25zaWRlcnxkaXNjdXNzfG5lZ290aWF0ZXxwcmVzZW50fGRlbW9uc3RyYXRlfGV4cGxhaW58ZGVzY3JpYmV8aWxsdXN0cmF0ZXxpbnRlcnByZXR8dHJhbnNsYXRlfGFkYXB0fG1vZGlmeXxvcHRpbWl6ZXxvcmdhbml6ZXxjb29yZGluYXRlfGFkbWluaXN0ZXJ8c3VwZXJ2aXNlfG9wZXJhdGV8ZXhlY3V0ZXxwZXJmb3JtfGFjY29tcGxpc2h8ZXN0YWJsaXNofG1haW50YWlufHByZXNlcnZlfGNvbnNlcnZlfHByb3RlY3R8cHJldmVudHxwcm9tb3RlfGFkdmFuY2V8ZW5oYW5jZXxlbnJpY2h8ZW1wb3dlcnxlbmdhZ2V8aW52b2x2ZXxwYXJ0aWNpcGF0ZXxjb250cmlidXRlfGRlZGljYXRlfGNvbW1pdHxpbnZlc3R8YWxsb2NhdGV8ZGlzdHJpYnV0ZXxjaXJjdWxhdGV8dHJhbnNtaXR8dHJhbnNwb3J0fGRlbGl2ZXJ8cHJvdmlkZXxzdXBwbHl8c3VwcG9ydHxhc3Npc3R8Z3VpZGV8ZGlyZWN0fGluc3RydWN0fGVkdWNhdGV8dHJhaW58cHJlcGFyZXxwbGFufHNjaGVkdWxlfGFycmFuZ2V8Y29vcmRpbmF0ZXxzeW5jaHJvbml6ZXxpbnRlZ3JhdGV8Y29tYmluZXxjb25uZWN0fGFzc29jaWF0ZXxyZWxhdGV8cGFydG5lcnxjb2xsYWJvcmF0ZXxjb29wZXJhdGV8Y29tcGV0ZXxjb21wYXJlfGNvbnRyYXN0fGRpZmZlcmVudGlhdGV8ZGlzdGluZ3Vpc2h8aWRlbnRpZnl8cmVjb2duaXplfGFja25vd2xlZGdlfGFwcHJlY2lhdGV8dW5kZXJzdGFuZHxjb21wcmVoZW5kfHJlYWxpemV8YXdhcmV8Y29uc2Npb3VzfHBlcmNlaXZlfG9ic2VydmV8bW9uaXRvcnx0cmFja3xtZWFzdXJlfGNhbGN1bGF0ZXxlc3RpbWF0ZXxwcmVkaWN0fGZvcmVjYXN0fHByb2plY3R8YW50aWNpcGF0ZXxleHBlY3R8YXNzdW1lfGh5cG90aGVzaXplfHNwZWN1bGF0ZXxpbnZlc3RpZ2F0ZXxleHBsb3JlfHJlc2VhcmNofGFuYWx5emV8c3ludGhlc2l6ZXxldmFsdWF0ZXxhc3Nlc3N8anVkZ2V8ZGVjaWRlfGNob29zZXxzZWxlY3R8cHJlZmVyfHJlY29tbWVuZHxzdWdnZXN0fHByb3Bvc2V8b2ZmZXJ8cmVxdWVzdHxkZW1hbmR8cmVxdWlyZXxzcGVjaWZ5fGluc3RydWN0fGRpcmVjdHxndWlkZXxhZHZpc2V8Y29uc3VsdHxkaXNjdXNzfG5lZ290aWF0ZXxhZ3JlZXxjb250cmFjdHxkZWFsfHRyYW5zYWN0aW9ufGV4Y2hhbmdlfHRyYWRlfHB1cmNoYXNlfHNhbGV8aW52ZXN0bWVudHxmdW5kaW5nfGZpbmFuY2luZ3xzcG9uc29yc2hpcHxzdXBwb3J0fGFzc2lzdGFuY2V8c2VydmljZXxwcm92aXNpb258ZGVsaXZlcnl8ZGlzdHJpYnV0aW9ufGFsbG9jYXRpb258YXNzaWdubWVudHxkZWxlZ2F0aW9ufGF1dGhvcml6YXRpb258YXBwcm92YWx8cGVybWlzc2lvbnxjb25zZW50fGFjY2VwdGFuY2V8cmVqZWN0aW9ufHJlZnVzYWx8ZGVuaWFsfHByb2hpYml0aW9ufHJlc3RyaWN0aW9ufGxpbWl0YXRpb258Y29uc3RyYWludHxyZWd1bGF0aW9ufGNvbnRyb2x8bWFuYWdlbWVudHxhZG1pbmlzdHJhdGlvbnxnb3Zlcm5hbmNlfGxlYWRlcnNoaXB8c3VwZXJ2aXNpb258b3ZlcnNpZ2h0fG1vbml0b3Jpbmd8ZXZhbHVhdGlvbnxhc3Nlc3NtZW50fHJldmlld3xhdWRpdHxpbnNwZWN0aW9ufGV4YW1pbmF0aW9ufGludmVzdGlnYXRpb258aW5xdWlyeSkvLnRlc3Qod29yZCkpIHtcclxuICAgICAgICBzY29yZSArPSAzXHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIEZyZXF1ZW5jeSBib251cyAod29yZHMgdGhhdCBhcHBlYXIgbXVsdGlwbGUgdGltZXMgYXJlIGxpa2VseSBpbXBvcnRhbnQpXHJcbiAgICAgIGNvbnN0IGZyZXF1ZW5jeSA9ICh0ZXh0LnRvTG93ZXJDYXNlKCkubWF0Y2gobmV3IFJlZ0V4cChgXFxcXGIke3dvcmR9XFxcXGJgLCAnZycpKSB8fCBbXSkubGVuZ3RoXHJcbiAgICAgIGlmIChmcmVxdWVuY3kgPiAxKSBzY29yZSArPSBmcmVxdWVuY3kgKiAyXHJcbiAgICAgIFxyXG4gICAgICAvLyBMZW5ndGggYm9udXMgZm9yIHN1YnN0YW50aWFsIHdvcmRzXHJcbiAgICAgIGlmICh3b3JkLmxlbmd0aCA+PSA2ICYmIHdvcmQubGVuZ3RoIDw9IDEyKSBzY29yZSArPSAxXHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4geyB3b3JkLCBzY29yZSB9XHJcbiAgICB9KVxyXG5cclxuICAgIC8vIFNvcnQgYnkgc2NvcmUgYW5kIHJldHVybiB0b3Agd29yZHNcclxuICAgIGNvbnN0IHRvcFdvcmRzID0gc2NvcmVkV29yZHNcclxuICAgICAgLnNvcnQoKGEsIGIpID0+IGIuc2NvcmUgLSBhLnNjb3JlKVxyXG4gICAgICAuc2xpY2UoMCwgOCkgLy8gVGFrZSB0b3AgOCB3b3Jkc1xyXG4gICAgICAubWFwKGl0ZW0gPT4gaXRlbS53b3JkKVxyXG5cclxuICAgIGNvbnNvbGUubG9nKFwi8J+TmiBNZWFuaW5nZnVsIHZvY2FidWxhcnkgZXh0cmFjdGlvbiByZXN1bHRzOlwiLCB0b3BXb3Jkcy5tYXAodyA9PiBgJHt3fSAoc2NvcmU6ICR7c2NvcmVkV29yZHMuZmluZChzID0+IHMud29yZCA9PT0gdyk/LnNjb3JlfSlgKSlcclxuICAgIHJldHVybiB0b3BXb3Jkc1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBleHRyYWN0Vm9jYWJ1bGFyeUZyb21UZXh0KHRleHQ6IHN0cmluZywgbGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIC8vIFNtYXJ0IHZvY2FidWxhcnkgZXh0cmFjdGlvbiBmb2N1c2luZyBvbiBtZWFuaW5nZnVsLCBlZHVjYXRpb25hbCB3b3Jkc1xyXG4gICAgY29uc3Qgd29yZHMgPSB0ZXh0LnRvTG93ZXJDYXNlKCkubWF0Y2goL1xcYlthLXpdezMsfVxcYi9nKSB8fCBbXVxyXG4gICAgY29uc3QgdW5pcXVlV29yZHMgPSBBcnJheS5mcm9tKG5ldyBTZXQod29yZHMpKVxyXG5cclxuICAgIC8vIFdvcmRzIHRvIGV4Y2x1ZGUgKGNvbW1vbiwgbm9uLWVkdWNhdGlvbmFsIHdvcmRzKVxyXG4gICAgY29uc3QgZXhjbHVkZVdvcmRzID0gbmV3IFNldChbXHJcbiAgICAgIC8vIENvbW1vbiB3b3Jkc1xyXG4gICAgICAndGhlJywgJ2FuZCcsICdmb3InLCAnYXJlJywgJ2J1dCcsICdub3QnLCAneW91JywgJ2FsbCcsICdjYW4nLCAnaGFkJywgJ2hlcicsICd3YXMnLCAnb25lJywgJ291cicsICdvdXQnLCAnZGF5JywgJ2dldCcsICdoYXMnLCAnaGltJywgJ2hpcycsICdob3cnLCAnaXRzJywgJ21heScsICduZXcnLCAnbm93JywgJ29sZCcsICdzZWUnLCAndHdvJywgJ3dobycsICdib3knLCAnZGlkJywgJ3NoZScsICd1c2UnLCAnd2F5JywgJ3doYXQnLCAnd2hlbicsICd3aGVyZScsICd3aWxsJywgJ3dpdGgnLCAnaGF2ZScsICd0aGlzJywgJ3RoYXQnLCAndGhleScsICdiZWVuJywgJ3NhaWQnLCAnZWFjaCcsICd3aGljaCcsICd0aGVpcicsICd0aW1lJywgJ3dvdWxkJywgJ3RoZXJlJywgJ2NvdWxkJywgJ290aGVyJywgJ2FmdGVyJywgJ2ZpcnN0JywgJ3dlbGwnLCAnd2F0ZXInLCAndmVyeScsICd3aGF0JywgJ2tub3cnLCAnanVzdCcsICdwZW9wbGUnLCAnaW50bycsICdvdmVyJywgJ3RoaW5rJywgJ2Fsc28nLCAnYmFjaycsICd3b3JrJywgJ2xpZmUnLCAnb25seScsICd5ZWFyJywgJ3llYXJzJywgJ2NvbWUnLCAnY2FtZScsICdyaWdodCcsICdnb29kJywgJ2VhY2gnLCAndGhvc2UnLCAnZmVlbCcsICdzZWVtJywgJ3RoZXNlJywgJ2dpdmUnLCAnbW9zdCcsICdoYW5kJywgJ2hpZ2gnLCAna2VlcCcsICdsYXN0JywgJ2xlZnQnLCAnbGlmZScsICdsaXZlJywgJ2xvb2snLCAnbWFkZScsICdtYWtlJywgJ21hbnknLCAnbXVjaCcsICdtdXN0JywgJ25hbWUnLCAnbmVlZCcsICduZXh0JywgJ29wZW4nLCAncGFydCcsICdwbGF5JywgJ3NhaWQnLCAnc2FtZScsICdzZWVtJywgJ3Nob3cnLCAnc2lkZScsICd0YWtlJywgJ3RlbGwnLCAndHVybicsICd3YW50JywgJ3dheXMnLCAnd2VsbCcsICd3ZW50JywgJ3dlcmUnLCAnaGVyZScsICdob21lJywgJ2xvbmcnLCAnbG9vaycsICdtb3ZlJywgJ3BsYWNlJywgJ3JpZ2h0JywgJ3NtYWxsJywgJ3NvdW5kJywgJ3N0aWxsJywgJ3N1Y2gnLCAndGhpbmcnLCAndGhpbmsnLCAndGhyZWUnLCAndW5kZXInLCAnd2F0ZXInLCAnd2hlcmUnLCAnd2hpbGUnLCAnd29ybGQnLCAnd3JpdGUnLCAneW91bmcnLFxyXG4gICAgICAvLyBEYXRlcywgbnVtYmVycywgbmFtZXMgKG9mdGVuIG5vdCB1c2VmdWwgZm9yIHZvY2FidWxhcnkpXHJcbiAgICAgICdqYW51YXJ5JywgJ2ZlYnJ1YXJ5JywgJ21hcmNoJywgJ2FwcmlsJywgJ2p1bmUnLCAnanVseScsICdhdWd1c3QnLCAnc2VwdGVtYmVyJywgJ29jdG9iZXInLCAnbm92ZW1iZXInLCAnZGVjZW1iZXInLFxyXG4gICAgICAnbW9uZGF5JywgJ3R1ZXNkYXknLCAnd2VkbmVzZGF5JywgJ3RodXJzZGF5JywgJ2ZyaWRheScsICdzYXR1cmRheScsICdzdW5kYXknLFxyXG4gICAgICAndG9kYXknLCAneWVzdGVyZGF5JywgJ3RvbW9ycm93JywgJ21vcm5pbmcnLCAnYWZ0ZXJub29uJywgJ2V2ZW5pbmcnLCAnbmlnaHQnLFxyXG4gICAgICAvLyBDb21tb24gcHJvcGVyIG5vdW5zIHRoYXQgYXJlIG9mdGVuIG5vdCBlZHVjYXRpb25hbFxyXG4gICAgICAnZnJhbmNpc2NvJywgJ2NhbGlmb3JuaWEnLCAnYW1lcmljYScsICdhbWVyaWNhbicsICd1bml0ZWQnLCAnc3RhdGVzJywgJ3lvcmsnLCAnbG9uZG9uJywgJ3BhcmlzJywgJ3Rva3lvJ1xyXG4gICAgXSlcclxuXHJcbiAgICAvLyBQcmlvcml0aXplIG1lYW5pbmdmdWwgdm9jYWJ1bGFyeSBjYXRlZ29yaWVzXHJcbiAgICBjb25zdCBtZWFuaW5nZnVsV29yZHMgPSB1bmlxdWVXb3Jkcy5maWx0ZXIod29yZCA9PiB7XHJcbiAgICAgIC8vIFNraXAgZXhjbHVkZWQgd29yZHNcclxuICAgICAgaWYgKGV4Y2x1ZGVXb3Jkcy5oYXMod29yZCkpIHJldHVybiBmYWxzZVxyXG4gICAgICBcclxuICAgICAgLy8gU2tpcCBwdXJlIG51bWJlcnMgb3IgZGF0ZXNcclxuICAgICAgaWYgKC9eXFxkKyQvLnRlc3Qod29yZCkgfHwgL15cXGR7NH0kLy50ZXN0KHdvcmQpKSByZXR1cm4gZmFsc2VcclxuICAgICAgXHJcbiAgICAgIC8vIFNraXAgdmVyeSBzaG9ydCB3b3JkcyAobGVzcyB0aGFuIDQgbGV0dGVycykgdW5sZXNzIHRoZXkncmUgaW1wb3J0YW50XHJcbiAgICAgIGlmICh3b3JkLmxlbmd0aCA8IDQpIHJldHVybiBmYWxzZVxyXG4gICAgICBcclxuICAgICAgLy8gU2tpcCB2ZXJ5IGxvbmcgd29yZHMgdGhhdCBtaWdodCBiZSB0b28gY29tcGxleFxyXG4gICAgICBpZiAod29yZC5sZW5ndGggPiAxNSkgcmV0dXJuIGZhbHNlXHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBTY29yZSB3b3JkcyBiYXNlZCBvbiBlZHVjYXRpb25hbCB2YWx1ZVxyXG4gICAgY29uc3Qgc2NvcmVkV29yZHMgPSBtZWFuaW5nZnVsV29yZHMubWFwKHdvcmQgPT4ge1xyXG4gICAgICBsZXQgc2NvcmUgPSAwXHJcbiAgICAgIFxyXG4gICAgICAvLyBCdXNpbmVzcy9wcm9mZXNzaW9uYWwgdm9jYWJ1bGFyeVxyXG4gICAgICBpZiAoL14obWFuYWdlfGxlYWRlcnx0ZWFtfGNvbXBhbnl8YnVzaW5lc3N8c3RyYXRlZ3l8ZGV2ZWxvcHxjcmVhdGV8aW5ub3ZhdHx0ZWNobm9sb2d8ZGlnaXRhbHxnbG9iYWx8aW50ZXJuYXRpb25hbHxwcm9mZXNzaW9uYWx8ZXhwZXJpZW5jZXxza2lsbHxleHBlcnR8YW5hbHlzaXN8cmVzZWFyY2h8cHJvamVjdHxzb2x1dGlvbnxjaGFsbGVuZ2V8b3Bwb3J0dW5pdHl8Z3Jvd3RofHN1Y2Nlc3N8YWNoaWV2ZW1lbnR8cGVyZm9ybWFuY2V8cXVhbGl0eXxlZmZpY2llbmN5fHByb2R1Y3Rpdml0eXxjb2xsYWJvcmF0aW9ufGNvbW11bmljYXRpb258ZGVjaXNpb258cmVzcG9uc2liaWxpdHl8b2JqZWN0aXZlfGdvYWx8dGFyZ2V0fHJlc3VsdHxvdXRjb21lfGltcGFjdHxiZW5lZml0fGFkdmFudGFnZXx2YWx1ZXxwcm9maXR8cmV2ZW51ZXxpbnZlc3RtZW50fG1hcmtldHxjdXN0b21lcnxjbGllbnR8c2VydmljZXxwcm9kdWN0fGJyYW5kfHJlcHV0YXRpb258Y29tcGV0aXRpdmV8aW5kdXN0cnl8c2VjdG9yfGVjb25vbXl8ZWNvbm9taWN8ZmluYW5jaWFsfGJ1ZGdldHxjb3N0fHByaWNlfHNhbGVzfG1hcmtldGluZ3xhZHZlcnRpc2luZ3xwcm9tb3Rpb258Y2FtcGFpZ258c3RyYXRlZ3l8cGxhbm5pbmd8aW1wbGVtZW50YXRpb258ZXhlY3V0aW9ufGV2YWx1YXRpb258YXNzZXNzbWVudHxpbXByb3ZlbWVudHxvcHRpbWl6YXRpb258dHJhbnNmb3JtYXRpb258Y2hhbmdlfGFkYXB0YXRpb258ZmxleGliaWxpdHl8YWdpbGl0eXxyZXNpbGllbmNlfHN1c3RhaW5hYmlsaXR5fGVudmlyb25tZW50YWx8c29jaWFsfGV0aGljYWx8Z292ZXJuYW5jZXxjb21wbGlhbmNlfHJlZ3VsYXRpb258cG9saWN5fHByb2NlZHVyZXxzdGFuZGFyZHxndWlkZWxpbmV8ZnJhbWV3b3JrfG1ldGhvZG9sb2d5fGFwcHJvYWNofHRlY2huaXF1ZXxtZXRob2R8cHJvY2Vzc3xzeXN0ZW18c3RydWN0dXJlfG9yZ2FuaXphdGlvbnxoaWVyYXJjaHl8ZGVwYXJ0bWVudHxkaXZpc2lvbnxmdW5jdGlvbnxyb2xlfHBvc2l0aW9ufHRpdGxlfGNhcmVlcnxkZXZlbG9wbWVudHx0cmFpbmluZ3xlZHVjYXRpb258bGVhcm5pbmd8a25vd2xlZGdlfGluZm9ybWF0aW9ufGRhdGF8aW5zaWdodHxpbnRlbGxpZ2VuY2V8d2lzZG9tfHVuZGVyc3RhbmRpbmd8Y29tcHJlaGVuc2lvbnxhd2FyZW5lc3N8Y29uc2Npb3VzbmVzc3xwZXJjZXB0aW9ufHBlcnNwZWN0aXZlfHZpZXdwb2ludHxvcGluaW9ufGJlbGllZnxhdHRpdHVkZXxtaW5kc2V0fGN1bHR1cmV8dmFsdWVzfHByaW5jaXBsZXN8ZXRoaWNzfGludGVncml0eXxob25lc3R5fHRyYW5zcGFyZW5jeXxhY2NvdW50YWJpbGl0eXxyZXNwb25zaWJpbGl0eXxjb21taXRtZW50fGRlZGljYXRpb258cGFzc2lvbnxtb3RpdmF0aW9ufGluc3BpcmF0aW9ufGNyZWF0aXZpdHl8aW5ub3ZhdGlvbnxpbWFnaW5hdGlvbnx2aXNpb258bWlzc2lvbnxwdXJwb3NlfG1lYW5pbmd8c2lnbmlmaWNhbmNlfGltcG9ydGFuY2V8cmVsZXZhbmNlfHByaW9yaXR5fHVyZ2VuY3l8Y3JpdGljYWx8ZXNzZW50aWFsfGZ1bmRhbWVudGFsfGJhc2ljfGFkdmFuY2VkfGNvbXBsZXh8c29waGlzdGljYXRlZHxjb21wcmVoZW5zaXZlfGRldGFpbGVkfHNwZWNpZmljfHBhcnRpY3VsYXJ8Z2VuZXJhbHxvdmVyYWxsfHRvdGFsfGNvbXBsZXRlfGZ1bGx8ZW50aXJlfHdob2xlfHBhcnRpYWx8bGltaXRlZHxyZXN0cmljdGVkfGV4Y2x1c2l2ZXxpbmNsdXNpdmV8ZGl2ZXJzZXx2YXJpZWR8ZGlmZmVyZW50fHNpbWlsYXJ8Y29tcGFyYWJsZXxlcXVpdmFsZW50fGVxdWFsfGZhaXJ8anVzdHxyZWFzb25hYmxlfGxvZ2ljYWx8cmF0aW9uYWx8cHJhY3RpY2FsfHJlYWxpc3RpY3xhY2hpZXZhYmxlfGZlYXNpYmxlfHBvc3NpYmxlfHByb2JhYmxlfGxpa2VseXx1bmxpa2VseXxpbXBvc3NpYmxlfGNlcnRhaW58dW5jZXJ0YWlufGNvbmZpZGVudHxkb3VidGZ1bHxvcHRpbWlzdGljfHBlc3NpbWlzdGljfHBvc2l0aXZlfG5lZ2F0aXZlfG5ldXRyYWx8b2JqZWN0aXZlfHN1YmplY3RpdmV8cGVyc29uYWx8aW5kaXZpZHVhbHxjb2xsZWN0aXZlfHNvY2lhbHxwdWJsaWN8cHJpdmF0ZXxpbnRlcm5hbHxleHRlcm5hbHxsb2NhbHxyZWdpb25hbHxuYXRpb25hbHxpbnRlcm5hdGlvbmFsfGdsb2JhbHx3b3JsZHdpZGV8dW5pdmVyc2FsKS8udGVzdCh3b3JkKSkge1xyXG4gICAgICAgIHNjb3JlICs9IDNcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gQWNhZGVtaWMvZWR1Y2F0aW9uYWwgdm9jYWJ1bGFyeVxyXG4gICAgICBpZiAoL14ocmVzZWFyY2h8c3R1ZHl8YW5hbHlzaXN8dGhlb3J5fGNvbmNlcHR8cHJpbmNpcGxlfG1ldGhvZHxhcHByb2FjaHx0ZWNobmlxdWV8cHJvY2Vzc3xzeXN0ZW18c3RydWN0dXJlfGZ1bmN0aW9ufHJlbGF0aW9uc2hpcHxjb25uZWN0aW9ufGludGVyYWN0aW9ufGluZmx1ZW5jZXxlZmZlY3R8aW1wYWN0fGNhdXNlfHJlc3VsdHxjb25zZXF1ZW5jZXxmYWN0b3J8ZWxlbWVudHxjb21wb25lbnR8YXNwZWN0fGZlYXR1cmV8Y2hhcmFjdGVyaXN0aWN8cHJvcGVydHl8cXVhbGl0eXxhdHRyaWJ1dGV8ZGltZW5zaW9ufGxldmVsfGRlZ3JlZXxleHRlbnR8c2NvcGV8cmFuZ2V8c2NhbGV8bWVhc3VyZXxtZWFzdXJlbWVudHxldmFsdWF0aW9ufGFzc2Vzc21lbnR8Y29tcGFyaXNvbnxjb250cmFzdHxzaW1pbGFyaXR5fGRpZmZlcmVuY2V8dmFyaWF0aW9ufGNoYW5nZXxkZXZlbG9wbWVudHxldm9sdXRpb258cHJvZ3Jlc3N8YWR2YW5jZW1lbnR8aW1wcm92ZW1lbnR8ZW5oYW5jZW1lbnR8bW9kaWZpY2F0aW9ufGFkanVzdG1lbnR8YWRhcHRhdGlvbnx0cmFuc2Zvcm1hdGlvbnxyZXZvbHV0aW9ufGlubm92YXRpb258ZGlzY292ZXJ5fGludmVudGlvbnxjcmVhdGlvbnxwcm9kdWN0aW9ufGNvbnN0cnVjdGlvbnxkZXNpZ258cGxhbm5pbmd8b3JnYW5pemF0aW9ufG1hbmFnZW1lbnR8YWRtaW5pc3RyYXRpb258b3BlcmF0aW9ufGltcGxlbWVudGF0aW9ufGV4ZWN1dGlvbnxwZXJmb3JtYW5jZXxhY2hpZXZlbWVudHxhY2NvbXBsaXNobWVudHxzdWNjZXNzfGZhaWx1cmV8Y2hhbGxlbmdlfHByb2JsZW18aXNzdWV8ZGlmZmljdWx0eXxvYnN0YWNsZXxiYXJyaWVyfGxpbWl0YXRpb258Y29uc3RyYWludHxyZXN0cmljdGlvbnxyZXF1aXJlbWVudHxjb25kaXRpb258c2l0dWF0aW9ufGNpcmN1bXN0YW5jZXxjb250ZXh0fGVudmlyb25tZW50fHNldHRpbmd8YmFja2dyb3VuZHxoaXN0b3J5fHRyYWRpdGlvbnxjdWx0dXJlfHNvY2lldHl8Y29tbXVuaXR5fHBvcHVsYXRpb258Z3JvdXB8dGVhbXxvcmdhbml6YXRpb258aW5zdGl0dXRpb258ZXN0YWJsaXNobWVudHxhdXRob3JpdHl8Z292ZXJubWVudHxhZG1pbmlzdHJhdGlvbnxwb2xpY3l8cmVndWxhdGlvbnxsYXd8cnVsZXxzdGFuZGFyZHxndWlkZWxpbmV8cHJvY2VkdXJlfHByb3RvY29sfGZyYW1ld29ya3xtb2RlbHxwYXR0ZXJufHRlbXBsYXRlfGV4YW1wbGV8aW5zdGFuY2V8Y2FzZXxzY2VuYXJpb3xzaXR1YXRpb258Y29uZGl0aW9ufHN0YXRlfHN0YXR1c3xwb3NpdGlvbnxsb2NhdGlvbnxwbGFjZXxhcmVhfHJlZ2lvbnx6b25lfHRlcnJpdG9yeXxkb21haW58ZmllbGR8c2VjdG9yfGluZHVzdHJ5fG1hcmtldHxlY29ub215fGJ1c2luZXNzfGNvbW1lcmNlfHRyYWRlfGV4Y2hhbmdlfHRyYW5zYWN0aW9ufGRlYWx8YWdyZWVtZW50fGNvbnRyYWN0fHBhcnRuZXJzaGlwfGNvbGxhYm9yYXRpb258Y29vcGVyYXRpb258Y29vcmRpbmF0aW9ufGNvbW11bmljYXRpb258aW50ZXJhY3Rpb258cmVsYXRpb25zaGlwfGNvbm5lY3Rpb258bmV0d29ya3xzeXN0ZW18c3RydWN0dXJlfG9yZ2FuaXphdGlvbnxoaWVyYXJjaHl8bGV2ZWx8cmFua3xncmFkZXxjbGFzc3xjYXRlZ29yeXx0eXBlfGtpbmR8c29ydHx2YXJpZXR5fGRpdmVyc2l0eXxyYW5nZXxzcGVjdHJ1bSkvLnRlc3Qod29yZCkpIHtcclxuICAgICAgICBzY29yZSArPSAyXHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIFRlY2huaWNhbC9zcGVjaWFsaXplZCB2b2NhYnVsYXJ5XHJcbiAgICAgIGlmICgvXih0ZWNobm9sb2d8ZGlnaXRhbHxjb21wdXRlcnxzb2Z0d2FyZXxoYXJkd2FyZXxpbnRlcm5ldHxvbmxpbmV8d2Vic2l0ZXxwbGF0Zm9ybXxhcHBsaWNhdGlvbnxwcm9ncmFtfGNvZGV8ZGF0YXxpbmZvcm1hdGlvbnxuZXR3b3JrfHN5c3RlbXxzZWN1cml0eXxwcml2YWN5fGVuY3J5cHRpb258YWxnb3JpdGhtfGFydGlmaWNpYWx8aW50ZWxsaWdlbmNlfG1hY2hpbmV8bGVhcm5pbmd8YXV0b21hdGlvbnxyb2JvdHxpbm5vdmF0aW9ufGRldmVsb3BtZW50fGVuZ2luZWVyaW5nfHNjaWVuY2V8c2NpZW50aWZpY3xtZWRpY2FsfGhlYWx0aHx0cmVhdG1lbnR8ZGlhZ25vc2lzfHJlc2VhcmNofGV4cGVyaW1lbnR8bGFib3JhdG9yeXxlcXVpcG1lbnR8aW5zdHJ1bWVudHxkZXZpY2V8dG9vbHxtYWNoaW5lfG1lY2hhbmlzbXxwcm9jZXNzfHByb2NlZHVyZXx0ZWNobmlxdWV8bWV0aG9kfGFwcHJvYWNofHN0cmF0ZWd5fHNvbHV0aW9ufHByb2JsZW18Y2hhbGxlbmdlfG9wcG9ydHVuaXR5fGFkdmFudGFnZXxiZW5lZml0fHJpc2t8dGhyZWF0fGRhbmdlcnxzYWZldHl8cHJvdGVjdGlvbnxwcmV2ZW50aW9ufGNvbnRyb2x8bWFuYWdlbWVudHxtb25pdG9yaW5nfHN1cGVydmlzaW9ufG92ZXJzaWdodHxnb3Zlcm5hbmNlfHJlZ3VsYXRpb258Y29tcGxpYW5jZXxzdGFuZGFyZHxxdWFsaXR5fHBlcmZvcm1hbmNlfGVmZmljaWVuY3l8ZWZmZWN0aXZlbmVzc3xwcm9kdWN0aXZpdHl8b3B0aW1pemF0aW9ufGltcHJvdmVtZW50fGVuaGFuY2VtZW50fHVwZ3JhZGV8dXBkYXRlfG1vZGlmaWNhdGlvbnxjdXN0b21pemF0aW9ufHBlcnNvbmFsaXphdGlvbnxhZGFwdGF0aW9ufGZsZXhpYmlsaXR5fHNjYWxhYmlsaXR5fHN1c3RhaW5hYmlsaXR5fHJlbGlhYmlsaXR5fGR1cmFiaWxpdHl8c3RhYmlsaXR5fGNvbnNpc3RlbmN5fGFjY3VyYWN5fHByZWNpc2lvbnx2YWxpZGl0eXxjcmVkaWJpbGl0eXxhdXRoZW50aWNpdHl8dHJhbnNwYXJlbmN5fGFjY291bnRhYmlsaXR5fHJlc3BvbnNpYmlsaXR5fGludGVncml0eXxldGhpY3N8bW9yYWxpdHl8dmFsdWVzfHByaW5jaXBsZXN8YmVsaWVmc3xhdHRpdHVkZXN8cGVyc3BlY3RpdmVzfG9waW5pb25zfHZpZXdzfHRob3VnaHRzfGlkZWFzfGNvbmNlcHRzfHRoZW9yaWVzfG1vZGVsc3xmcmFtZXdvcmtzfHBhcmFkaWdtc3xhcHByb2FjaGVzfG1ldGhvZG9sb2dpZXN8c3RyYXRlZ2llc3x0YWN0aWNzfHRlY2huaXF1ZXN8cHJvY2VkdXJlc3xwcm90b2NvbHMpLy50ZXN0KHdvcmQpKSB7XHJcbiAgICAgICAgc2NvcmUgKz0gMlxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBBY3Rpb24vcHJvY2VzcyB3b3JkcyAodmVyYnMgaW4gbm91biBmb3JtIG9yIGdlcnVuZHMpXHJcbiAgICAgIGlmICgvXihhbm5vdW5jZW1lbnR8bGVhZGVyc2hpcHxtYW5hZ2VtZW50fGRldmVsb3BtZW50fGltcGxlbWVudGF0aW9ufGFjaGlldmVtZW50fGltcHJvdmVtZW50fHRyYW5zZm9ybWF0aW9ufGNvbW11bmljYXRpb258Y29sbGFib3JhdGlvbnxpbnZlc3RpZ2F0aW9ufGV4cGxvcmF0aW9ufGV4YW1pbmF0aW9ufGV2YWx1YXRpb258YXNzZXNzbWVudHxjb25zaWRlcmF0aW9ufGRpc2N1c3Npb258bmVnb3RpYXRpb258cHJlc2VudGF0aW9ufGRlbW9uc3RyYXRpb258ZXhwbGFuYXRpb258ZGVzY3JpcHRpb258aWxsdXN0cmF0aW9ufGludGVycHJldGF0aW9ufHRyYW5zbGF0aW9ufGFkYXB0YXRpb258bW9kaWZpY2F0aW9ufG9wdGltaXphdGlvbnxvcmdhbml6YXRpb258Y29vcmRpbmF0aW9ufGFkbWluaXN0cmF0aW9ufHN1cGVydmlzaW9ufG9wZXJhdGlvbnxleGVjdXRpb258cGVyZm9ybWFuY2V8YWNjb21wbGlzaG1lbnR8ZXN0YWJsaXNobWVudHxtYWludGVuYW5jZXxwcmVzZXJ2YXRpb258Y29uc2VydmF0aW9ufHByb3RlY3Rpb258cHJldmVudGlvbnxwcm9tb3Rpb258YWR2YW5jZW1lbnR8ZW5oYW5jZW1lbnR8ZW5yaWNobWVudHxlbXBvd2VybWVudHxlbmdhZ2VtZW50fGludm9sdmVtZW50fHBhcnRpY2lwYXRpb258Y29udHJpYnV0aW9ufGRlZGljYXRpb258Y29tbWl0bWVudHxpbnZlc3RtZW50fGFsbG9jYXRpb258ZGlzdHJpYnV0aW9ufGNpcmN1bGF0aW9ufHRyYW5zbWlzc2lvbnx0cmFuc3BvcnRhdGlvbnxkZWxpdmVyeXxwcm92aXNpb258c3VwcGx5fHN1cHBvcnR8YXNzaXN0YW5jZXxndWlkYW5jZXxkaXJlY3Rpb258aW5zdHJ1Y3Rpb258ZWR1Y2F0aW9ufHRyYWluaW5nfHByZXBhcmF0aW9ufHBsYW5uaW5nfHNjaGVkdWxpbmd8YXJyYW5nZW1lbnR8Y29vcmRpbmF0aW9ufHN5bmNocm9uaXphdGlvbnxpbnRlZ3JhdGlvbnxjb21iaW5hdGlvbnxjb25uZWN0aW9ufGFzc29jaWF0aW9ufHJlbGF0aW9uc2hpcHxwYXJ0bmVyc2hpcHxjb2xsYWJvcmF0aW9ufGNvb3BlcmF0aW9ufGNvbXBldGl0aW9ufGNvbXBhcmlzb258Y29udHJhc3R8ZGlmZmVyZW50aWF0aW9ufGRpc3RpbmN0aW9ufGlkZW50aWZpY2F0aW9ufHJlY29nbml0aW9ufGFja25vd2xlZGdtZW50fGFwcHJlY2lhdGlvbnx1bmRlcnN0YW5kaW5nfGNvbXByZWhlbnNpb258cmVhbGl6YXRpb258YXdhcmVuZXNzfGNvbnNjaW91c25lc3N8cGVyY2VwdGlvbnxvYnNlcnZhdGlvbnxtb25pdG9yaW5nfHRyYWNraW5nfG1lYXN1cmVtZW50fGNhbGN1bGF0aW9ufGVzdGltYXRpb258cHJlZGljdGlvbnxmb3JlY2FzdGluZ3xwcm9qZWN0aW9ufGFudGljaXBhdGlvbnxleHBlY3RhdGlvbnxhc3N1bXB0aW9ufGh5cG90aGVzaXN8c3BlY3VsYXRpb258aW52ZXN0aWdhdGlvbnxleHBsb3JhdGlvbnxyZXNlYXJjaHxhbmFseXNpc3xzeW50aGVzaXN8ZXZhbHVhdGlvbnxhc3Nlc3NtZW50fGp1ZGdtZW50fGRlY2lzaW9ufGNob2ljZXxzZWxlY3Rpb258cHJlZmVyZW5jZXxyZWNvbW1lbmRhdGlvbnxzdWdnZXN0aW9ufHByb3Bvc2FsfG9mZmVyfHJlcXVlc3R8ZGVtYW5kfHJlcXVpcmVtZW50fHNwZWNpZmljYXRpb258aW5zdHJ1Y3Rpb258ZGlyZWN0aW9ufGd1aWRhbmNlfGFkdmljZXxjb25zdWx0YXRpb258ZGlzY3Vzc2lvbnxuZWdvdGlhdGlvbnxhZ3JlZW1lbnR8Y29udHJhY3R8ZGVhbHx0cmFuc2FjdGlvbnxleGNoYW5nZXx0cmFkZXxwdXJjaGFzZXxzYWxlfGludmVzdG1lbnR8ZnVuZGluZ3xmaW5hbmNpbmd8c3BvbnNvcnNoaXB8c3VwcG9ydHxhc3Npc3RhbmNlfHNlcnZpY2V8cHJvdmlzaW9ufGRlbGl2ZXJ5fGRpc3RyaWJ1dGlvbnxhbGxvY2F0aW9ufGFzc2lnbm1lbnR8ZGVsZWdhdGlvbnxhdXRob3JpemF0aW9ufGFwcHJvdmFsfHBlcm1pc3Npb258Y29uc2VudHxhY2NlcHRhbmNlfHJlamVjdGlvbnxyZWZ1c2FsfGRlbmlhbHxwcm9oaWJpdGlvbnxyZXN0cmljdGlvbnxsaW1pdGF0aW9ufGNvbnN0cmFpbnR8cmVndWxhdGlvbnxjb250cm9sfG1hbmFnZW1lbnR8YWRtaW5pc3RyYXRpb258Z292ZXJuYW5jZXxsZWFkZXJzaGlwfHN1cGVydmlzaW9ufG92ZXJzaWdodHxtb25pdG9yaW5nfGV2YWx1YXRpb258YXNzZXNzbWVudHxyZXZpZXd8YXVkaXR8aW5zcGVjdGlvbnxleGFtaW5hdGlvbnxpbnZlc3RpZ2F0aW9ufGlucXVpcnl8cmVzZWFyY2h8c3R1ZHl8YW5hbHlzaXN8aW50ZXJwcmV0YXRpb258ZXhwbGFuYXRpb258Y2xhcmlmaWNhdGlvbnxzcGVjaWZpY2F0aW9ufGRlZmluaXRpb258ZGVzY3JpcHRpb258aWxsdXN0cmF0aW9ufGRlbW9uc3RyYXRpb258cHJlc2VudGF0aW9ufGV4aGliaXRpb258ZGlzcGxheXxzaG93fHBlcmZvcm1hbmNlfGV4ZWN1dGlvbnxpbXBsZW1lbnRhdGlvbnxhcHBsaWNhdGlvbnx1dGlsaXphdGlvbnxlbXBsb3ltZW50fHVzYWdlfG9wZXJhdGlvbnxmdW5jdGlvbnxhY3Rpdml0eXxhY3Rpb258YmVoYXZpb3J8Y29uZHVjdHxwcmFjdGljZXxwcm9jZWR1cmV8cHJvY2Vzc3xtZXRob2R8dGVjaG5pcXVlfGFwcHJvYWNofHN0cmF0ZWd5fHBsYW58c2NoZW1lfHByb2dyYW18cHJvamVjdHxpbml0aWF0aXZlfGNhbXBhaWdufG1vdmVtZW50fGVmZm9ydHxhdHRlbXB0fHRyaWFsfGV4cGVyaW1lbnR8dGVzdHxleGFtaW5hdGlvbnxldmFsdWF0aW9ufGFzc2Vzc21lbnR8bWVhc3VyZW1lbnR8Y2FsY3VsYXRpb258ZXN0aW1hdGlvbnxkZXRlcm1pbmF0aW9ufGlkZW50aWZpY2F0aW9ufHJlY29nbml0aW9ufGRpc2NvdmVyeXxpbnZlbnRpb258Y3JlYXRpb258cHJvZHVjdGlvbnxjb25zdHJ1Y3Rpb258YnVpbGRpbmd8ZGV2ZWxvcG1lbnR8Z3Jvd3RofGV4cGFuc2lvbnxleHRlbnNpb258ZW5sYXJnZW1lbnR8aW5jcmVhc2V8aW1wcm92ZW1lbnR8ZW5oYW5jZW1lbnR8dXBncmFkZXxhZHZhbmNlbWVudHxwcm9ncmVzc3xldm9sdXRpb258dHJhbnNmb3JtYXRpb258Y2hhbmdlfG1vZGlmaWNhdGlvbnxhZGp1c3RtZW50fGFkYXB0YXRpb258Y3VzdG9taXphdGlvbnxwZXJzb25hbGl6YXRpb258b3B0aW1pemF0aW9ufHJlZmluZW1lbnR8cGVyZmVjdGlvbnxjb21wbGV0aW9ufGFjaGlldmVtZW50fGFjY29tcGxpc2htZW50fHN1Y2Nlc3N8dmljdG9yeXx0cml1bXBofGNvbnF1ZXN0fGRlZmVhdHxmYWlsdXJlfGxvc3N8bWlzdGFrZXxlcnJvcnxwcm9ibGVtfGlzc3VlfGRpZmZpY3VsdHl8Y2hhbGxlbmdlfG9ic3RhY2xlfGJhcnJpZXJ8bGltaXRhdGlvbnxjb25zdHJhaW50fHJlc3RyaWN0aW9ufHJlcXVpcmVtZW50fGNvbmRpdGlvbnxzaXR1YXRpb258Y2lyY3Vtc3RhbmNlfGNvbnRleHR8ZW52aXJvbm1lbnR8c2V0dGluZ3xhdG1vc3BoZXJlfGNsaW1hdGV8Y3VsdHVyZXx0cmFkaXRpb258Y3VzdG9tfGhhYml0fHJvdXRpbmV8cGF0dGVybnx0cmVuZHx0ZW5kZW5jeXxpbmNsaW5hdGlvbnxwcmVmZXJlbmNlfGNob2ljZXxvcHRpb258YWx0ZXJuYXRpdmV8cG9zc2liaWxpdHl8b3Bwb3J0dW5pdHl8Y2hhbmNlfHByb2JhYmlsaXR5fGxpa2VsaWhvb2R8Y2VydGFpbnR5fHVuY2VydGFpbnR5fGRvdWJ0fGNvbmZpZGVuY2V8dHJ1c3R8ZmFpdGh8YmVsaWVmfGNvbnZpY3Rpb258b3Bpbmlvbnx2aWV3fHBlcnNwZWN0aXZlfHN0YW5kcG9pbnR8cG9zaXRpb258c3RhbmNlfGF0dGl0dWRlfGFwcHJvYWNofG1pbmRzZXR8bWVudGFsaXR5fHBzeWNob2xvZ3l8cGhpbG9zb3BoeXxpZGVvbG9neXx0aGVvcnl8Y29uY2VwdHxpZGVhfG5vdGlvbnx0aG91Z2h0fGNvbnNpZGVyYXRpb258cmVmbGVjdGlvbnxjb250ZW1wbGF0aW9ufG1lZGl0YXRpb258Y29uY2VudHJhdGlvbnxmb2N1c3xhdHRlbnRpb258aW50ZXJlc3R8Y3VyaW9zaXR5fHdvbmRlcnxhbWF6ZW1lbnR8c3VycHJpc2V8c2hvY2t8YXN0b25pc2htZW50fGJld2lsZGVybWVudHxjb25mdXNpb258dW5jZXJ0YWludHl8Y2xhcml0eXx1bmRlcnN0YW5kaW5nfGNvbXByZWhlbnNpb258a25vd2xlZGdlfGluZm9ybWF0aW9ufGRhdGF8ZmFjdHN8ZGV0YWlsc3xzcGVjaWZpY3N8cGFydGljdWxhcnN8Y2hhcmFjdGVyaXN0aWNzfGZlYXR1cmVzfGF0dHJpYnV0ZXN8cHJvcGVydGllc3xxdWFsaXRpZXN8YXNwZWN0c3xlbGVtZW50c3xjb21wb25lbnRzfHBhcnRzfHNlY3Rpb25zfHNlZ21lbnRzfGRpdmlzaW9uc3xjYXRlZ29yaWVzfHR5cGVzfGtpbmRzfHZhcmlldGllc3xmb3Jtc3xzaGFwZXN8c2l6ZXN8ZGltZW5zaW9uc3xtZWFzdXJlbWVudHN8cXVhbnRpdGllc3xhbW91bnRzfG51bWJlcnN8ZmlndXJlc3xzdGF0aXN0aWNzfHBlcmNlbnRhZ2VzfHByb3BvcnRpb25zfHJhdGlvc3xyYXRlc3xzcGVlZHN8ZnJlcXVlbmNpZXN8aW50ZXJ2YWxzfHBlcmlvZHN8ZHVyYXRpb25zfHRpbWVzfG1vbWVudHN8aW5zdGFuY2VzfG9jY2FzaW9uc3xldmVudHN8aW5jaWRlbnRzfG9jY3VycmVuY2VzfGhhcHBlbmluZ3N8ZGV2ZWxvcG1lbnRzfGNoYW5nZXN8bW9kaWZpY2F0aW9uc3xhbHRlcmF0aW9uc3xhZGp1c3RtZW50c3xpbXByb3ZlbWVudHN8ZW5oYW5jZW1lbnRzfHVwZ3JhZGVzfHVwZGF0ZXN8cmV2aXNpb25zfGNvcnJlY3Rpb25zfGZpeGVzfHJlcGFpcnN8bWFpbnRlbmFuY2V8cHJlc2VydmF0aW9ufGNvbnNlcnZhdGlvbnxwcm90ZWN0aW9ufHNlY3VyaXR5fHNhZmV0eXxkZWZlbnNlfHByZXZlbnRpb258cHJlY2F1dGlvbnxwcmVwYXJhdGlvbnxyZWFkaW5lc3N8YXZhaWxhYmlsaXR5fGFjY2Vzc2liaWxpdHl8Y29udmVuaWVuY2V8Y29tZm9ydHxlYXNlfHNpbXBsaWNpdHl8Y29tcGxleGl0eXxkaWZmaWN1bHR5fGNoYWxsZW5nZXxjb21wbGljYXRpb258c29waGlzdGljYXRpb258YWR2YW5jZW1lbnR8cHJvZ3Jlc3N8ZGV2ZWxvcG1lbnR8Z3Jvd3RofGV4cGFuc2lvbnxleHRlbnNpb258aW5jcmVhc2V8cmlzZXxpbXByb3ZlbWVudHxlbmhhbmNlbWVudHxiZXR0ZXJtZW50fGFtZWxpb3JhdGlvbnxvcHRpbWl6YXRpb258cGVyZmVjdGlvbnxleGNlbGxlbmNlfHF1YWxpdHl8c3RhbmRhcmR8bGV2ZWx8Z3JhZGV8cmFua3xzdGF0dXN8cG9zaXRpb258bG9jYXRpb258cGxhY2V8c2l0ZXxzcG90fHBvaW50fGFyZWF8cmVnaW9ufHpvbmV8dGVycml0b3J5fGRvbWFpbnxmaWVsZHxzZWN0b3J8aW5kdXN0cnl8bWFya2V0fGVjb25vbXl8YnVzaW5lc3N8ZW50ZXJwcmlzZXxvcmdhbml6YXRpb258aW5zdGl0dXRpb258ZXN0YWJsaXNobWVudHxjb21wYW55fGNvcnBvcmF0aW9ufGZpcm18YWdlbmN5fGRlcGFydG1lbnR8ZGl2aXNpb258c2VjdGlvbnx1bml0fHRlYW18Z3JvdXB8Y29tbWl0dGVlfGJvYXJkfGNvdW5jaWx8YXNzZW1ibHl8YXNzb2NpYXRpb258c29jaWV0eXxjb21tdW5pdHl8cG9wdWxhdGlvbnxwdWJsaWN8YXVkaWVuY2V8Y3VzdG9tZXJzfGNsaWVudHN8dXNlcnN8Y29uc3VtZXJzfGJ1eWVyc3xwdXJjaGFzZXJzfGludmVzdG9yc3xzdGFrZWhvbGRlcnN8c2hhcmVob2xkZXJzfHBhcnRuZXJzfGNvbGxhYm9yYXRvcnN8Y29sbGVhZ3Vlc3xhc3NvY2lhdGVzfG1lbWJlcnN8cGFydGljaXBhbnRzfGNvbnRyaWJ1dG9yc3xzdXBwb3J0ZXJzfGFkdm9jYXRlc3xyZXByZXNlbnRhdGl2ZXN8ZGVsZWdhdGVzfGFtYmFzc2Fkb3JzfHNwb2tlc3BlcnNvbnN8bGVhZGVyc3xtYW5hZ2Vyc3xkaXJlY3RvcnN8ZXhlY3V0aXZlc3xhZG1pbmlzdHJhdG9yc3xzdXBlcnZpc29yc3xjb29yZGluYXRvcnN8b3JnYW5pemVyc3xwbGFubmVyc3xkZXNpZ25lcnN8ZGV2ZWxvcGVyc3xjcmVhdG9yc3xwcm9kdWNlcnN8bWFudWZhY3R1cmVyc3xzdXBwbGllcnN8cHJvdmlkZXJzfGRpc3RyaWJ1dG9yc3xyZXRhaWxlcnN8c2VsbGVyc3x2ZW5kb3JzfGNvbnRyYWN0b3JzfGNvbnN1bHRhbnRzfGFkdmlzb3JzfGV4cGVydHN8c3BlY2lhbGlzdHN8cHJvZmVzc2lvbmFsc3xwcmFjdGl0aW9uZXJzfHRlY2huaWNpYW5zfG9wZXJhdG9yc3x3b3JrZXJzfGVtcGxveWVlc3xzdGFmZnxwZXJzb25uZWx8d29ya2ZvcmNlfGxhYm9yfGh1bWFufHJlc291cmNlc3xjYXBpdGFsfGFzc2V0c3xpbnZlc3RtZW50c3xmdW5kc3xmaW5hbmNlc3xidWRnZXR8Y29zdHN8ZXhwZW5zZXN8cmV2ZW51ZXN8aW5jb21lfHByb2ZpdHN8ZWFybmluZ3N8cmV0dXJuc3xiZW5lZml0c3xhZHZhbnRhZ2VzfGdhaW5zfGxvc3Nlc3xyaXNrc3x0aHJlYXRzfGRhbmdlcnN8aGF6YXJkc3xjaGFsbGVuZ2VzfHByb2JsZW1zfGlzc3Vlc3xkaWZmaWN1bHRpZXN8b2JzdGFjbGVzfGJhcnJpZXJzfGxpbWl0YXRpb25zfGNvbnN0cmFpbnRzfHJlc3RyaWN0aW9uc3xyZXF1aXJlbWVudHN8Y29uZGl0aW9uc3x0ZXJtc3xzcGVjaWZpY2F0aW9uc3xzdGFuZGFyZHN8Y3JpdGVyaWF8Z3VpZGVsaW5lc3xydWxlc3xyZWd1bGF0aW9uc3xwb2xpY2llc3xwcm9jZWR1cmVzfHByb3RvY29sc3xwcm9jZXNzZXN8bWV0aG9kc3x0ZWNobmlxdWVzfGFwcHJvYWNoZXN8c3RyYXRlZ2llc3xwbGFuc3xwcm9ncmFtc3xwcm9qZWN0c3xpbml0aWF0aXZlc3xjYW1wYWlnbnN8ZWZmb3J0c3xhY3Rpdml0aWVzfGFjdGlvbnN8b3BlcmF0aW9uc3xmdW5jdGlvbnN8c2VydmljZXN8cHJvZHVjdHN8Z29vZHN8aXRlbXN8YXJ0aWNsZXN8b2JqZWN0c3x0aGluZ3N8bWF0ZXJpYWxzfHN1YnN0YW5jZXN8ZWxlbWVudHN8Y29tcG9uZW50c3xpbmdyZWRpZW50c3xjb250ZW50cykkLy50ZXN0KHdvcmQpKSB7XHJcbiAgICAgICAgc2NvcmUgKz0gM1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBCb251cyBmb3Igd29yZHMgdGhhdCBhcHBlYXIgbXVsdGlwbGUgdGltZXMgKGluZGljYXRpbmcgaW1wb3J0YW5jZSlcclxuICAgICAgY29uc3QgZnJlcXVlbmN5ID0gKHRleHQudG9Mb3dlckNhc2UoKS5tYXRjaChuZXcgUmVnRXhwKGBcXFxcYiR7d29yZH1cXFxcYmAsICdnJykpIHx8IFtdKS5sZW5ndGhcclxuICAgICAgaWYgKGZyZXF1ZW5jeSA+IDEpIHNjb3JlICs9IGZyZXF1ZW5jeVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHsgd29yZCwgc2NvcmUgfVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBTb3J0IGJ5IHNjb3JlIGFuZCByZXR1cm4gdG9wIHdvcmRzXHJcbiAgICBjb25zdCB0b3BXb3JkcyA9IHNjb3JlZFdvcmRzXHJcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnNjb3JlIC0gYS5zY29yZSlcclxuICAgICAgLnNsaWNlKDAsIDEwKVxyXG4gICAgICAubWFwKGl0ZW0gPT4gaXRlbS53b3JkKVxyXG5cclxuICAgIGNvbnNvbGUubG9nKFwi8J+TmiBTbWFydCB2b2NhYnVsYXJ5IGV4dHJhY3Rpb24gcmVzdWx0czpcIiwgdG9wV29yZHMpXHJcbiAgICByZXR1cm4gdG9wV29yZHNcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZGV0ZXJtaW5lQ3VsdHVyYWxDb250ZXh0KGRvbWFpbjogc3RyaW5nLCB0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgLy8gRGV0ZXJtaW5lIGN1bHR1cmFsIGNvbnRleHQgYmFzZWQgb24gZG9tYWluIGFuZCBjb250ZW50XHJcbiAgICBjb25zdCBjdWx0dXJhbEluZGljYXRvcnMgPSB7XHJcbiAgICAgICdiYmMuY29tJzogJ0JyaXRpc2ggRW5nbGlzaCwgVUsgY3VsdHVyZScsXHJcbiAgICAgICdjbm4uY29tJzogJ0FtZXJpY2FuIEVuZ2xpc2gsIFVTIGN1bHR1cmUnLFxyXG4gICAgICAnd2lraXBlZGlhLm9yZyc6ICdJbnRlcm5hdGlvbmFsLCBlbmN5Y2xvcGVkaWMnLFxyXG4gICAgICAnbnl0aW1lcy5jb20nOiAnQW1lcmljYW4gRW5nbGlzaCwgVVMgcGVyc3BlY3RpdmUnLFxyXG4gICAgICAndGhlZ3VhcmRpYW4uY29tJzogJ0JyaXRpc2ggRW5nbGlzaCwgVUsgcGVyc3BlY3RpdmUnLFxyXG4gICAgfVxyXG5cclxuICAgIGlmIChjdWx0dXJhbEluZGljYXRvcnNbZG9tYWluXSkge1xyXG4gICAgICByZXR1cm4gY3VsdHVyYWxJbmRpY2F0b3JzW2RvbWFpbl1cclxuICAgIH1cclxuXHJcbiAgICAvLyBBbmFseXplIHRleHQgZm9yIGN1bHR1cmFsIG1hcmtlcnNcclxuICAgIGNvbnN0IGFtZXJpY2FuTWFya2VycyA9IFsnZG9sbGFyJywgJ3ByZXNpZGVudCcsICdjb25ncmVzcycsICdzdGF0ZScsICdmZWRlcmFsJ11cclxuICAgIGNvbnN0IGJyaXRpc2hNYXJrZXJzID0gWydwb3VuZCcsICdtaW5pc3RlcicsICdwYXJsaWFtZW50JywgJ2NvdW5jaWwnLCAnZ292ZXJubWVudCddXHJcblxyXG4gICAgY29uc3QgYW1lcmljYW5Db3VudCA9IGFtZXJpY2FuTWFya2Vycy5maWx0ZXIobWFya2VyID0+XHJcbiAgICAgIHRleHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhtYXJrZXIpXHJcbiAgICApLmxlbmd0aFxyXG5cclxuICAgIGNvbnN0IGJyaXRpc2hDb3VudCA9IGJyaXRpc2hNYXJrZXJzLmZpbHRlcihtYXJrZXIgPT5cclxuICAgICAgdGV4dC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKG1hcmtlcilcclxuICAgICkubGVuZ3RoXHJcblxyXG4gICAgaWYgKGFtZXJpY2FuQ291bnQgPiBicml0aXNoQ291bnQpIHtcclxuICAgICAgcmV0dXJuICdBbWVyaWNhbiBFbmdsaXNoIGNvbnRleHQnXHJcbiAgICB9IGVsc2UgaWYgKGJyaXRpc2hDb3VudCA+IGFtZXJpY2FuQ291bnQpIHtcclxuICAgICAgcmV0dXJuICdCcml0aXNoIEVuZ2xpc2ggY29udGV4dCdcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gJ0ludGVybmF0aW9uYWwgY29udGV4dCdcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2VuZXJhdGVMZWFybmluZ09iamVjdGl2ZXMoY29udGVudFR5cGU6IHN0cmluZywgdG9waWNzOiBzdHJpbmdbXSwgbGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IG9iamVjdGl2ZXMgPSBbXVxyXG5cclxuICAgIC8vIEJhc2Ugb2JqZWN0aXZlcyBvbiBjb250ZW50IHR5cGVcclxuICAgIHN3aXRjaCAoY29udGVudFR5cGUpIHtcclxuICAgICAgY2FzZSAnbmV3cyc6XHJcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdVbmRlcnN0YW5kIGN1cnJlbnQgZXZlbnRzIHZvY2FidWxhcnknKVxyXG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnUHJhY3RpY2UgcmVhZGluZyBuZXdzIGFydGljbGVzJylcclxuICAgICAgICBicmVha1xyXG4gICAgICBjYXNlICdibG9nJzpcclxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ0xlYXJuIGluZm9ybWFsIHdyaXRpbmcgc3R5bGUnKVxyXG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnVW5kZXJzdGFuZCBwZXJzb25hbCBvcGluaW9ucyBhbmQgZXhwZXJpZW5jZXMnKVxyXG4gICAgICAgIGJyZWFrXHJcbiAgICAgIGNhc2UgJ3R1dG9yaWFsJzpcclxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ0ZvbGxvdyBzdGVwLWJ5LXN0ZXAgaW5zdHJ1Y3Rpb25zJylcclxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ0xlYXJuIHRlY2huaWNhbCB2b2NhYnVsYXJ5JylcclxuICAgICAgICBicmVha1xyXG4gICAgICBjYXNlICdlbmN5Y2xvcGVkaWEnOlxyXG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnVW5kZXJzdGFuZCBmYWN0dWFsIGluZm9ybWF0aW9uJylcclxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ0xlYXJuIGFjYWRlbWljIHZvY2FidWxhcnknKVxyXG4gICAgICAgIGJyZWFrXHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdJbXByb3ZlIHJlYWRpbmcgY29tcHJlaGVuc2lvbicpXHJcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdFeHBhbmQgdm9jYWJ1bGFyeSBrbm93bGVkZ2UnKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCB0b3BpYy1zcGVjaWZpYyBvYmplY3RpdmVzXHJcbiAgICB0b3BpY3Muc2xpY2UoMCwgMikuZm9yRWFjaCh0b3BpYyA9PiB7XHJcbiAgICAgIG9iamVjdGl2ZXMucHVzaChgRGlzY3VzcyB0b3BpY3MgcmVsYXRlZCB0byAke3RvcGljLnRvTG93ZXJDYXNlKCl9YClcclxuICAgIH0pXHJcblxyXG4gICAgcmV0dXJuIG9iamVjdGl2ZXMuc2xpY2UoMCwgNClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0QXVkaWVuY2VMZXZlbChjZWZyTGV2ZWw6IHN0cmluZyk6IFwiZ2VuZXJhbFwiIHwgXCJleHBlcnRcIiB8IFwiYmVnaW5uZXJcIiB7XHJcbiAgICBjb25zdCBsZXZlbE1hcCA9IHtcclxuICAgICAgJ0ExJzogJ2JlZ2lubmVyJyBhcyBjb25zdCxcclxuICAgICAgJ0EyJzogJ2JlZ2lubmVyJyBhcyBjb25zdCxcclxuICAgICAgJ0IxJzogJ2dlbmVyYWwnIGFzIGNvbnN0LFxyXG4gICAgICAnQjInOiAnZ2VuZXJhbCcgYXMgY29uc3QsXHJcbiAgICAgICdDMSc6ICdleHBlcnQnIGFzIGNvbnN0LFxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGxldmVsTWFwW2NlZnJMZXZlbF0gfHwgJ2dlbmVyYWwnXHJcbiAgfVxyXG5cclxuICAvLyBFbmhhbmNlZCBmYWxsYmFjayBsZXNzb24gZ2VuZXJhdGlvbiB3aXRoIGNvbnRleHRcclxuICBwcml2YXRlIGdlbmVyYXRlRW5oYW5jZWRGYWxsYmFja0xlc3NvbihwYXJhbXM6IExlc3NvbkdlbmVyYXRpb25QYXJhbXMpOiBHZW5lcmF0ZWRMZXNzb24ge1xyXG4gICAgY29uc3Qge1xyXG4gICAgICBzb3VyY2VUZXh0LFxyXG4gICAgICBsZXNzb25UeXBlLFxyXG4gICAgICBzdHVkZW50TGV2ZWwsXHJcbiAgICAgIHRhcmdldExhbmd1YWdlLFxyXG4gICAgICBjb250ZW50TWV0YWRhdGEsXHJcbiAgICAgIHN0cnVjdHVyZWRDb250ZW50XHJcbiAgICB9ID0gcGFyYW1zXHJcblxyXG4gICAgY29uc29sZS5sb2coXCLwn5SEIEdlbmVyYXRpbmcgZW5oYW5jZWQgZmFsbGJhY2sgbGVzc29uIHdpdGggY29udGV4dHVhbCB3YXJtLXVwLi4uXCIpXHJcblxyXG4gICAgLy8gVXNlIGF2YWlsYWJsZSBjb250ZXh0IGV2ZW4gaW4gZmFsbGJhY2tcclxuICAgIGNvbnN0IHRvcGljcyA9IHN0cnVjdHVyZWRDb250ZW50Py5oZWFkaW5ncz8ubWFwKGggPT4gaC50ZXh0KS5zbGljZSgwLCAzKSB8fCBbXVxyXG4gICAgY29uc3QgY29udGVudFR5cGUgPSBjb250ZW50TWV0YWRhdGE/LmNvbnRlbnRUeXBlIHx8ICdnZW5lcmFsJ1xyXG5cclxuICAgIC8vIENyZWF0ZSBtb2NrIGNvbnRlbnQgYW5hbHlzaXMgZm9yIGZhbGxiYWNrIHdhcm0tdXAgZ2VuZXJhdGlvblxyXG4gICAgY29uc3QgbW9ja0NvbnRlbnRBbmFseXNpcyA9IHtcclxuICAgICAgdG9waWNzOiB0b3BpY3MsXHJcbiAgICAgIGNvbnRlbnRUeXBlOiBjb250ZW50VHlwZSxcclxuICAgICAgc291cmNlQ291bnRyeTogdGhpcy5kZXRlcm1pbmVTb3VyY2VDb3VudHJ5KGNvbnRlbnRNZXRhZGF0YT8uZG9tYWluIHx8ICcnKSxcclxuICAgICAgY3VsdHVyYWxDb250ZXh0OiB0aGlzLmRldGVybWluZUN1bHR1cmFsQ29udGV4dChjb250ZW50TWV0YWRhdGE/LmRvbWFpbiB8fCAnJywgc291cmNlVGV4dClcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZW5lcmF0ZSBjb250ZXh0dWFsIHdhcm0tdXAgcXVlc3Rpb25zIGV2ZW4gaW4gZmFsbGJhY2tcclxuICAgIGNvbnN0IGNvbnRleHR1YWxXYXJtdXAgPSB0aGlzLmdldENvbnRleHR1YWxXYXJtdXBGYWxsYmFjayhzdHVkZW50TGV2ZWwsIG1vY2tDb250ZW50QW5hbHlzaXMsIGNvbnRlbnRNZXRhZGF0YSlcclxuXHJcbiAgICBjb25zb2xlLmxvZyhcIvCflKUgR2VuZXJhdGVkIGZhbGxiYWNrIGNvbnRleHR1YWwgd2FybS11cDpcIiwgY29udGV4dHVhbFdhcm11cClcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBsZXNzb25UeXBlLFxyXG4gICAgICBzdHVkZW50TGV2ZWwsXHJcbiAgICAgIHRhcmdldExhbmd1YWdlLFxyXG4gICAgICBzZWN0aW9uczoge1xyXG4gICAgICAgIHdhcm11cDogY29udGV4dHVhbFdhcm11cCxcclxuICAgICAgICB2b2NhYnVsYXJ5OiB0aGlzLmV4dHJhY3RDb250ZXh0dWFsVm9jYWJ1bGFyeShzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwsIHRvcGljcyksXHJcbiAgICAgICAgcmVhZGluZzogdGhpcy5zaW1wbGlmeVRleHQoc291cmNlVGV4dCwgc3R1ZGVudExldmVsKSxcclxuICAgICAgICBjb21wcmVoZW5zaW9uOiB0aGlzLmdldENvbnRleHR1YWxDb21wcmVoZW5zaW9uKGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCwgdG9waWNzKSxcclxuICAgICAgICBkaWFsb2d1ZVByYWN0aWNlOiB0aGlzLmdlbmVyYXRlVGVtcGxhdGVEaWFsb2d1ZVByYWN0aWNlKHRvcGljc1swXSB8fCAndGhpcyB0b3BpYycsIHN0dWRlbnRMZXZlbCwgW10pLFxyXG4gICAgICAgIGRpYWxvZ3VlRmlsbEdhcDogdGhpcy5nZW5lcmF0ZVRlbXBsYXRlRGlhbG9ndWVGaWxsR2FwKHRvcGljc1swXSB8fCAndGhpcyB0b3BpYycsIHN0dWRlbnRMZXZlbCwgW10pLFxyXG4gICAgICAgIGRpc2N1c3Npb246IHRoaXMuZ2V0Q29udGV4dHVhbERpc2N1c3Npb24obGVzc29uVHlwZSwgc3R1ZGVudExldmVsLCB0b3BpY3MpLFxyXG4gICAgICAgIGdyYW1tYXI6IHRoaXMuZ2V0VGVtcGxhdGVHcmFtbWFyKHN0dWRlbnRMZXZlbCksXHJcbiAgICAgICAgcHJvbnVuY2lhdGlvbjogdGhpcy5nZXRUZW1wbGF0ZVByb251bmNpYXRpb24oc291cmNlVGV4dCksXHJcbiAgICAgICAgd3JhcHVwOiB0aGlzLmdldENvbnRleHR1YWxXcmFwdXAobGVzc29uVHlwZSwgdG9waWNzKSxcclxuICAgICAgfSxcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0Q29udGV4dHVhbFdhcm11cChsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nLCB0b3BpY3M6IHN0cmluZ1tdLCBjb250ZW50VHlwZTogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgLy8gVXNlIHRoZSBzYW1lIGNvbnRleHR1YWwgZmFsbGJhY2sgbG9naWNcclxuICAgIGNvbnN0IG1vY2tBbmFseXNpcyA9IHtcclxuICAgICAgdG9waWNzOiB0b3BpY3MsXHJcbiAgICAgIGNvbnRlbnRUeXBlOiBjb250ZW50VHlwZSxcclxuICAgICAgc291cmNlQ291bnRyeTogJ0ludGVybmF0aW9uYWwnXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuZ2V0Q29udGV4dHVhbFdhcm11cEZhbGxiYWNrKHN0dWRlbnRMZXZlbCwgbW9ja0FuYWx5c2lzLCB7IHRpdGxlOiB0b3BpY3NbMF0gfHwgJ0NvbnRlbnQnIH0pXHJcbiAgfVxyXG5cclxuICAvLyBCYXNpYyBmYWxsYmFjayBmb3IgY29tcGxldGUgZmFpbHVyZXNcclxuICBwcml2YXRlIGdlbmVyYXRlQmFzaWNGYWxsYmFja0xlc3NvbihwYXJhbXM6IExlc3NvbkdlbmVyYXRpb25QYXJhbXMpOiBHZW5lcmF0ZWRMZXNzb24ge1xyXG4gICAgY29uc3QgeyBzb3VyY2VUZXh0LCBsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwsIHRhcmdldExhbmd1YWdlIH0gPSBwYXJhbXNcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBsZXNzb25UeXBlLFxyXG4gICAgICBzdHVkZW50TGV2ZWwsXHJcbiAgICAgIHRhcmdldExhbmd1YWdlLFxyXG4gICAgICBzZWN0aW9uczoge1xyXG4gICAgICAgIHdhcm11cDogW1wiV2hhdCBkbyB5b3UgYWxyZWFkeSBrbm93IGFib3V0IHRoaXMgdG9waWM/XCIsIFwiSGF2ZSB5b3UgaGFkIHNpbWlsYXIgZXhwZXJpZW5jZXM/XCIsIFwiV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBsZWFybj9cIl0sXHJcbiAgICAgICAgdm9jYWJ1bGFyeTogW10sXHJcbiAgICAgICAgcmVhZGluZzogc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgNDAwKSxcclxuICAgICAgICBjb21wcmVoZW5zaW9uOiBbXCJXaGF0IGlzIHRoZSBtYWluIGlkZWE/XCIsIFwiV2hhdCBkZXRhaWxzIGNhbiB5b3UgaWRlbnRpZnk/XCJdLFxyXG4gICAgICAgIGRpYWxvZ3VlUHJhY3RpY2U6IHRoaXMuZ2VuZXJhdGVUZW1wbGF0ZURpYWxvZ3VlUHJhY3RpY2UoJ3RoaXMgdG9waWMnLCBzdHVkZW50TGV2ZWwsIFtdKSxcclxuICAgICAgICBkaWFsb2d1ZUZpbGxHYXA6IHRoaXMuZ2VuZXJhdGVUZW1wbGF0ZURpYWxvZ3VlRmlsbEdhcCgndGhpcyB0b3BpYycsIHN0dWRlbnRMZXZlbCwgW10pLFxyXG4gICAgICAgIGRpc2N1c3Npb246IFtcIldoYXQgaXMgeW91ciBvcGluaW9uP1wiLCBcIkhvdyB3b3VsZCB5b3UgaGFuZGxlIHRoaXM/XCJdLFxyXG4gICAgICAgIGdyYW1tYXI6IHRoaXMuZ2V0VGVtcGxhdGVHcmFtbWFyKHN0dWRlbnRMZXZlbCksXHJcbiAgICAgICAgcHJvbnVuY2lhdGlvbjogeyB3b3JkOiBcImV4YW1wbGVcIiwgaXBhOiBcIi/Jqsmhy4h6w6ZtcMmZbC9cIiwgcHJhY3RpY2U6IFwiUHJhY3RpY2Ugc2F5aW5nIGV4YW1wbGUuXCIgfSxcclxuICAgICAgICB3cmFwdXA6IFtcIldoYXQgZGlkIHlvdSBsZWFybj9cIiwgXCJXaGF0IG5lZWRzIG1vcmUgcHJhY3RpY2U/XCJdXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZXh0cmFjdENvbnRleHR1YWxWb2NhYnVsYXJ5KHRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcsIHRvcGljczogc3RyaW5nW10pIHtcclxuICAgIGNvbnN0IHZvY2FidWxhcnkgPSB0aGlzLmV4dHJhY3RWb2NhYnVsYXJ5KHRleHQsIHN0dWRlbnRMZXZlbClcclxuXHJcbiAgICAvLyBFbmhhbmNlIHdpdGggdG9waWMgY29udGV4dCBpZiBhdmFpbGFibGVcclxuICAgIGlmICh0b3BpY3MubGVuZ3RoID4gMCkge1xyXG4gICAgICByZXR1cm4gdm9jYWJ1bGFyeS5tYXAoKHZvY2FiLCBpbmRleCkgPT4gKHtcclxuICAgICAgICAuLi52b2NhYixcclxuICAgICAgICBjb250ZXh0OiBpbmRleCA8IHRvcGljcy5sZW5ndGggPyBgUmVsYXRlZCB0byAke3RvcGljc1tpbmRleF0udG9Mb3dlckNhc2UoKX1gIDogdm9jYWIubWVhbmluZyxcclxuICAgICAgfSkpXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHZvY2FidWxhcnlcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0Q29udGV4dHVhbENvbXByZWhlbnNpb24obGVzc29uVHlwZTogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZywgdG9waWNzOiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IGJhc2VRdWVzdGlvbnMgPSB0aGlzLmdldFRlbXBsYXRlQ29tcHJlaGVuc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpXHJcblxyXG4gICAgaWYgKHRvcGljcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHJldHVybiBbXHJcbiAgICAgICAgYFdoYXQgaXMgdGhlIG1haW4gcG9pbnQgYWJvdXQgJHt0b3BpY3NbMF0/LnRvTG93ZXJDYXNlKCl9P2AsXHJcbiAgICAgICAgYEhvdyBkb2VzIHRoZSB0ZXh0IGV4cGxhaW4gJHt0b3BpY3NbMV0/LnRvTG93ZXJDYXNlKCkgfHwgJ3RoZSB0b3BpYyd9P2AsXHJcbiAgICAgICAgXCJXaGF0IHN1cHBvcnRpbmcgZGV0YWlscyBjYW4geW91IGlkZW50aWZ5P1wiLFxyXG4gICAgICAgIFwiV2hhdCBjb25jbHVzaW9ucyBjYW4geW91IGRyYXcgZnJvbSB0aGlzIGluZm9ybWF0aW9uP1wiLFxyXG4gICAgICBdXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGJhc2VRdWVzdGlvbnNcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0Q29udGV4dHVhbERpc2N1c3Npb24obGVzc29uVHlwZTogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZywgdG9waWNzOiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IGJhc2VRdWVzdGlvbnMgPSB0aGlzLmdldFRlbXBsYXRlRGlzY3Vzc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpXHJcblxyXG4gICAgaWYgKHRvcGljcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHJldHVybiBbXHJcbiAgICAgICAgYFdoYXQgaXMgeW91ciBvcGluaW9uIGFib3V0ICR7dG9waWNzWzBdPy50b0xvd2VyQ2FzZSgpfT9gLFxyXG4gICAgICAgIGBIb3cgd291bGQgeW91IGFwcGx5IHRoaXMgaW5mb3JtYXRpb24gYWJvdXQgJHt0b3BpY3NbMV0/LnRvTG93ZXJDYXNlKCkgfHwgJ3RoaXMgdG9waWMnfT9gLFxyXG4gICAgICAgIGBXaGF0IGFyZSB0aGUgaW1wbGljYXRpb25zIG9mIHdoYXQgeW91IGxlYXJuZWQgYWJvdXQgJHt0b3BpY3NbMF0/LnRvTG93ZXJDYXNlKCl9P2AsXHJcbiAgICAgIF1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gYmFzZVF1ZXN0aW9uc1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRDb250ZXh0dWFsV3JhcHVwKGxlc3NvblR5cGU6IHN0cmluZywgdG9waWNzOiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcclxuICAgIGlmICh0b3BpY3MubGVuZ3RoID4gMCkge1xyXG4gICAgICByZXR1cm4gW1xyXG4gICAgICAgIGBXaGF0IG5ldyB2b2NhYnVsYXJ5IGRpZCB5b3UgbGVhcm4gYWJvdXQgJHt0b3BpY3NbMF0/LnRvTG93ZXJDYXNlKCl9P2AsXHJcbiAgICAgICAgYFdoaWNoIGNvbmNlcHRzIGFib3V0ICR7dG9waWNzWzFdPy50b0xvd2VyQ2FzZSgpIHx8ICd0aGlzIHRvcGljJ30gbmVlZCBtb3JlIHByYWN0aWNlP2AsXHJcbiAgICAgICAgXCJIb3cgd2lsbCB5b3UgdXNlIHRoaXMga25vd2xlZGdlIGluIHJlYWwgc2l0dWF0aW9ucz9cIixcclxuICAgICAgICBcIldoYXQgcXVlc3Rpb25zIGRvIHlvdSBzdGlsbCBoYXZlIGFib3V0IHRoaXMgY29udGVudD9cIixcclxuICAgICAgXVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0aGlzLmdldFRlbXBsYXRlV3JhcHVwKGxlc3NvblR5cGUpXHJcbiAgfVxyXG5cclxuICAvLyBUZW1wbGF0ZSBkaWFsb2d1ZSBnZW5lcmF0aW9uIG1ldGhvZHNcclxuICBwcml2YXRlIGdlbmVyYXRlVGVtcGxhdGVEaWFsb2d1ZVByYWN0aWNlKHRvcGljOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nLCB2b2NhYnVsYXJ5V29yZHM6IHN0cmluZ1tdKTogYW55IHtcclxuICAgIGNvbnN0IGxldmVsRGlhbG9ndWVzID0ge1xyXG4gICAgICAnQTEnOiB7XHJcbiAgICAgICAgaW5zdHJ1Y3Rpb246IFwiUHJhY3RpY2UgdGhpcyBzaW1wbGUgY29udmVyc2F0aW9uIHdpdGggeW91ciB0dXRvcjpcIixcclxuICAgICAgICBkaWFsb2d1ZTogW1xyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiU3R1ZGVudFwiLCBsaW5lOiBgSSB3YW50IHRvIGxlYXJuIGFib3V0ICR7dG9waWN9LmAgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlR1dG9yXCIsIGxpbmU6IGBUaGF0J3MgZ3JlYXQhIFdoYXQgZG8geW91IGFscmVhZHkga25vdyBhYm91dCAke3RvcGljfT9gIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJTdHVkZW50XCIsIGxpbmU6IFwiSSBrbm93IGEgbGl0dGxlIGJpdC5cIiB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiVHV0b3JcIiwgbGluZTogYExldCdzIGV4cGxvcmUgJHt0b3BpY30gdG9nZXRoZXIuYCB9XHJcbiAgICAgICAgXSxcclxuICAgICAgICBmb2xsb3dVcFF1ZXN0aW9uczogW1xyXG4gICAgICAgICAgYFdoYXQgaW50ZXJlc3RzIHlvdSBtb3N0IGFib3V0ICR7dG9waWN9P2AsXHJcbiAgICAgICAgICBcIldoYXQgd291bGQgeW91IGxpa2UgdG8ga25vdyBtb3JlIGFib3V0P1wiLFxyXG4gICAgICAgICAgXCJIb3cgY2FuIHRoaXMgaGVscCB5b3UgaW4gZGFpbHkgbGlmZT9cIlxyXG4gICAgICAgIF1cclxuICAgICAgfSxcclxuICAgICAgJ0EyJzoge1xyXG4gICAgICAgIGluc3RydWN0aW9uOiBcIlByYWN0aWNlIHRoaXMgY29udmVyc2F0aW9uIHdpdGggeW91ciB0dXRvcjpcIixcclxuICAgICAgICBkaWFsb2d1ZTogW1xyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiU3R1ZGVudFwiLCBsaW5lOiBgSSd2ZSBiZWVuIHJlYWRpbmcgYWJvdXQgJHt0b3BpY30uIEl0J3MgcXVpdGUgaW50ZXJlc3RpbmcuYCB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiVHV0b3JcIiwgbGluZTogYFdoYXQgZGlkIHlvdSBmaW5kIG1vc3QgaW50ZXJlc3RpbmcgYWJvdXQgJHt0b3BpY30/YCB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiU3R1ZGVudFwiLCBsaW5lOiBcIkkgbGVhcm5lZCBzb21lIG5ldyB0aGluZ3MgSSBkaWRuJ3Qga25vdyBiZWZvcmUuXCIgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlR1dG9yXCIsIGxpbmU6IGBDYW4geW91IHNoYXJlIHdoYXQgeW91IGxlYXJuZWQgYWJvdXQgJHt0b3BpY30/YCB9XHJcbiAgICAgICAgXSxcclxuICAgICAgICBmb2xsb3dVcFF1ZXN0aW9uczogW1xyXG4gICAgICAgICAgYEhvdyBkb2VzICR7dG9waWN9IHJlbGF0ZSB0byB5b3VyIGV4cGVyaWVuY2U/YCxcclxuICAgICAgICAgIFwiV2hhdCBzdXJwcmlzZWQgeW91IHRoZSBtb3N0P1wiLFxyXG4gICAgICAgICAgXCJXb3VsZCB5b3UgcmVjb21tZW5kIHRoaXMgdG9waWMgdG8gb3RoZXJzP1wiXHJcbiAgICAgICAgXVxyXG4gICAgICB9LFxyXG4gICAgICAnQjEnOiB7XHJcbiAgICAgICAgaW5zdHJ1Y3Rpb246IFwiUHJhY3RpY2UgdGhpcyBkaXNjdXNzaW9uIHdpdGggeW91ciB0dXRvcjpcIixcclxuICAgICAgICBkaWFsb2d1ZTogW1xyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiU3R1ZGVudFwiLCBsaW5lOiBgSSd2ZSBiZWVuIHRoaW5raW5nIGFib3V0ICR7dG9waWN9IGFuZCBpdHMgaW1wbGljYXRpb25zLmAgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlR1dG9yXCIsIGxpbmU6IGBUaGF0J3MgYSBjb21wbGV4IHRvcGljLiBXaGF0IGFzcGVjdHMgb2YgJHt0b3BpY30gaW50ZXJlc3QgeW91IG1vc3Q/YCB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiU3R1ZGVudFwiLCBsaW5lOiBcIlRoZXJlIGFyZSBzZXZlcmFsIGZhY3RvcnMgdG8gY29uc2lkZXIgd2hlbiBkaXNjdXNzaW5nIHRoaXMuXCIgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlR1dG9yXCIsIGxpbmU6IGBMZXQncyBleHBsb3JlIHRob3NlIGZhY3RvcnMuIFdoYXQgZG8geW91IHRoaW5rIGlzIG1vc3QgaW1wb3J0YW50IGFib3V0ICR7dG9waWN9P2AgfVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgZm9sbG93VXBRdWVzdGlvbnM6IFtcclxuICAgICAgICAgIGBXaGF0IGFyZSB0aGUgYWR2YW50YWdlcyBhbmQgZGlzYWR2YW50YWdlcyBvZiAke3RvcGljfT9gLFxyXG4gICAgICAgICAgXCJIb3cgbWlnaHQgdGhpcyBpbXBhY3QgZGlmZmVyZW50IGdyb3VwcyBvZiBwZW9wbGU/XCIsXHJcbiAgICAgICAgICBcIldoYXQgc29sdXRpb25zIHdvdWxkIHlvdSBwcm9wb3NlP1wiXHJcbiAgICAgICAgXVxyXG4gICAgICB9LFxyXG4gICAgICAnQjInOiB7XHJcbiAgICAgICAgaW5zdHJ1Y3Rpb246IFwiRW5nYWdlIGluIHRoaXMgYW5hbHl0aWNhbCBkaXNjdXNzaW9uIHdpdGggeW91ciB0dXRvcjpcIixcclxuICAgICAgICBkaWFsb2d1ZTogW1xyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiU3R1ZGVudFwiLCBsaW5lOiBgVGhlIGNvbXBsZXhpdHkgb2YgJHt0b3BpY30gcmVxdWlyZXMgY2FyZWZ1bCBhbmFseXNpcyBvZiBtdWx0aXBsZSBwZXJzcGVjdGl2ZXMuYCB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiVHV0b3JcIiwgbGluZTogYEV4Y2VsbGVudCBwb2ludC4gSG93IGRvIHlvdSB0aGluayBkaWZmZXJlbnQgc3Rha2Vob2xkZXJzIHZpZXcgJHt0b3BpY30/YCB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiU3R1ZGVudFwiLCBsaW5lOiBcIkVhY2ggcGVyc3BlY3RpdmUgYnJpbmdzIHVuaXF1ZSBpbnNpZ2h0cyBhbmQgY2hhbGxlbmdlcyB0byBjb25zaWRlci5cIiB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiVHV0b3JcIiwgbGluZTogYFdoYXQgZXZpZGVuY2Ugc3VwcG9ydHMgeW91ciBhbmFseXNpcyBvZiAke3RvcGljfT9gIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIGZvbGxvd1VwUXVlc3Rpb25zOiBbXHJcbiAgICAgICAgICBgSG93IGRvIGN1bHR1cmFsIGRpZmZlcmVuY2VzIGluZmx1ZW5jZSBwZXJzcGVjdGl2ZXMgb24gJHt0b3BpY30/YCxcclxuICAgICAgICAgIFwiV2hhdCBsb25nLXRlcm0gY29uc2VxdWVuY2VzIHNob3VsZCB3ZSBjb25zaWRlcj9cIixcclxuICAgICAgICAgIFwiSG93IHdvdWxkIHlvdSBldmFsdWF0ZSB0aGUgZWZmZWN0aXZlbmVzcyBvZiBjdXJyZW50IGFwcHJvYWNoZXM/XCJcclxuICAgICAgICBdXHJcbiAgICAgIH0sXHJcbiAgICAgICdDMSc6IHtcclxuICAgICAgICBpbnN0cnVjdGlvbjogXCJQYXJ0aWNpcGF0ZSBpbiB0aGlzIHNvcGhpc3RpY2F0ZWQgZGlzY291cnNlIHdpdGggeW91ciB0dXRvcjpcIixcclxuICAgICAgICBkaWFsb2d1ZTogW1xyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiU3R1ZGVudFwiLCBsaW5lOiBgVGhlIG51YW5jZWQgbmF0dXJlIG9mICR7dG9waWN9IGRlbWFuZHMgYSBtdWx0aWZhY2V0ZWQgYXBwcm9hY2ggdG8gdW5kZXJzdGFuZGluZy5gIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJUdXRvclwiLCBsaW5lOiBgSW5kZWVkLiBIb3cgZG8geW91IHJlY29uY2lsZSB0aGUgYXBwYXJlbnQgY29udHJhZGljdGlvbnMgd2l0aGluICR7dG9waWN9P2AgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlN0dWRlbnRcIiwgbGluZTogXCJUaGUgcGFyYWRveGVzIGluaGVyZW50IGluIHRoaXMgc3ViamVjdCByZWZsZWN0IGJyb2FkZXIgc29jaWV0YWwgY29tcGxleGl0aWVzLlwiIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJUdXRvclwiLCBsaW5lOiBgV2hhdCB0aGVvcmV0aWNhbCBmcmFtZXdvcmtzIGJlc3QgaWxsdW1pbmF0ZSB0aGUgaW50cmljYWNpZXMgb2YgJHt0b3BpY30/YCB9XHJcbiAgICAgICAgXSxcclxuICAgICAgICBmb2xsb3dVcFF1ZXN0aW9uczogW1xyXG4gICAgICAgICAgYEhvdyBkbyBwaGlsb3NvcGhpY2FsIHVuZGVycGlubmluZ3Mgc2hhcGUgb3VyIHVuZGVyc3RhbmRpbmcgb2YgJHt0b3BpY30/YCxcclxuICAgICAgICAgIFwiV2hhdCBwYXJhZGlnbSBzaGlmdHMgbWlnaHQgYmUgbmVjZXNzYXJ5IGZvciBwcm9ncmVzcz9cIixcclxuICAgICAgICAgIFwiSG93IGRvIHlvdSBlbnZpc2lvbiB0aGUgZXZvbHV0aW9uIG9mIHRob3VnaHQgcmVnYXJkaW5nIHRoaXMgbWF0dGVyP1wiXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGxldmVsRGlhbG9ndWVzW3N0dWRlbnRMZXZlbCBhcyBrZXlvZiB0eXBlb2YgbGV2ZWxEaWFsb2d1ZXNdIHx8IGxldmVsRGlhbG9ndWVzWydCMSddXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdlbmVyYXRlVGVtcGxhdGVEaWFsb2d1ZUZpbGxHYXAodG9waWM6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcsIHZvY2FidWxhcnlXb3Jkczogc3RyaW5nW10pOiBhbnkge1xyXG4gICAgY29uc3QgbGV2ZWxHYXBEaWFsb2d1ZXMgPSB7XHJcbiAgICAgICdBMSc6IHtcclxuICAgICAgICBpbnN0cnVjdGlvbjogXCJGaWxsIGluIHRoZSBnYXBzIGluIHRoaXMgY29udmVyc2F0aW9uOlwiLFxyXG4gICAgICAgIGRpYWxvZ3VlOiBbXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJTdHVkZW50XCIsIGxpbmU6IGBJIF9fX19fIHRvIGxlYXJuIGFib3V0ICR7dG9waWN9LmAsIGlzR2FwOiB0cnVlIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJUdXRvclwiLCBsaW5lOiBgVGhhdCdzIGdyZWF0ISBXaGF0IF9fX19fIHlvdSBhbHJlYWR5IGtub3c/YCwgaXNHYXA6IHRydWUgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlN0dWRlbnRcIiwgbGluZTogXCJJIGtub3cgX19fX18gbGl0dGxlIGJpdC5cIiwgaXNHYXA6IHRydWUgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlR1dG9yXCIsIGxpbmU6IGBMZXQncyBfX19fXyB0b2dldGhlci5gLCBpc0dhcDogdHJ1ZSB9XHJcbiAgICAgICAgXSxcclxuICAgICAgICBhbnN3ZXJzOiBbXCJ3YW50XCIsIFwiZG9cIiwgXCJhXCIsIFwibGVhcm5cIl1cclxuICAgICAgfSxcclxuICAgICAgJ0EyJzoge1xyXG4gICAgICAgIGluc3RydWN0aW9uOiBcIkNvbXBsZXRlIHRoaXMgY29udmVyc2F0aW9uIHdpdGggdGhlIG1pc3Npbmcgd29yZHM6XCIsXHJcbiAgICAgICAgZGlhbG9ndWU6IFtcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlN0dWRlbnRcIiwgbGluZTogYEkndmUgYmVlbiBfX19fXyBhYm91dCAke3RvcGljfS5gLCBpc0dhcDogdHJ1ZSB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiVHV0b3JcIiwgbGluZTogYFdoYXQgZGlkIHlvdSBfX19fXyBtb3N0IGludGVyZXN0aW5nP2AsIGlzR2FwOiB0cnVlIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJTdHVkZW50XCIsIGxpbmU6IFwiSSBfX19fXyBzb21lIG5ldyB0aGluZ3MuXCIsIGlzR2FwOiB0cnVlIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJUdXRvclwiLCBsaW5lOiBgQ2FuIHlvdSBfX19fXyB3aGF0IHlvdSBsZWFybmVkP2AsIGlzR2FwOiB0cnVlIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIGFuc3dlcnM6IFtcInJlYWRpbmdcIiwgXCJmaW5kXCIsIFwibGVhcm5lZFwiLCBcInNoYXJlXCJdXHJcbiAgICAgIH0sXHJcbiAgICAgICdCMSc6IHtcclxuICAgICAgICBpbnN0cnVjdGlvbjogXCJGaWxsIGluIHRoZSBibGFua3MgdG8gY29tcGxldGUgdGhpcyBkaXNjdXNzaW9uOlwiLFxyXG4gICAgICAgIGRpYWxvZ3VlOiBbXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJTdHVkZW50XCIsIGxpbmU6IGBJJ3ZlIGJlZW4gX19fX18gYWJvdXQgJHt0b3BpY30gYW5kIGl0cyBpbXBsaWNhdGlvbnMuYCwgaXNHYXA6IHRydWUgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlR1dG9yXCIsIGxpbmU6IGBXaGF0IF9fX19fIGludGVyZXN0IHlvdSBtb3N0P2AsIGlzR2FwOiB0cnVlIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJTdHVkZW50XCIsIGxpbmU6IFwiVGhlcmUgYXJlIHNldmVyYWwgX19fX18gdG8gY29uc2lkZXIuXCIsIGlzR2FwOiB0cnVlIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJUdXRvclwiLCBsaW5lOiBgV2hhdCBkbyB5b3UgdGhpbmsgaXMgbW9zdCBfX19fXyA/YCwgaXNHYXA6IHRydWUgfVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgYW5zd2VyczogW1widGhpbmtpbmdcIiwgXCJhc3BlY3RzXCIsIFwiZmFjdG9yc1wiLCBcImltcG9ydGFudFwiXVxyXG4gICAgICB9LFxyXG4gICAgICAnQjInOiB7XHJcbiAgICAgICAgaW5zdHJ1Y3Rpb246IFwiQ29tcGxldGUgdGhpcyBhbmFseXRpY2FsIGRpc2N1c3Npb246XCIsXHJcbiAgICAgICAgZGlhbG9ndWU6IFtcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlN0dWRlbnRcIiwgbGluZTogYFRoZSBfX19fXyBvZiAke3RvcGljfSByZXF1aXJlcyBjYXJlZnVsIGFuYWx5c2lzLmAsIGlzR2FwOiB0cnVlIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJUdXRvclwiLCBsaW5lOiBgSG93IGRvIGRpZmZlcmVudCBfX19fXyB2aWV3IHRoaXMgdG9waWM/YCwgaXNHYXA6IHRydWUgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlN0dWRlbnRcIiwgbGluZTogXCJFYWNoIHBlcnNwZWN0aXZlIGJyaW5ncyB1bmlxdWUgX19fX18gLlwiLCBpc0dhcDogdHJ1ZSB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiVHV0b3JcIiwgbGluZTogYFdoYXQgX19fX18gc3VwcG9ydHMgeW91ciBhbmFseXNpcz9gLCBpc0dhcDogdHJ1ZSB9XHJcbiAgICAgICAgXSxcclxuICAgICAgICBhbnN3ZXJzOiBbXCJjb21wbGV4aXR5XCIsIFwic3Rha2Vob2xkZXJzXCIsIFwiaW5zaWdodHNcIiwgXCJldmlkZW5jZVwiXVxyXG4gICAgICB9LFxyXG4gICAgICAnQzEnOiB7XHJcbiAgICAgICAgaW5zdHJ1Y3Rpb246IFwiRmlsbCBpbiB0aGUgc29waGlzdGljYXRlZCB2b2NhYnVsYXJ5OlwiLFxyXG4gICAgICAgIGRpYWxvZ3VlOiBbXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJTdHVkZW50XCIsIGxpbmU6IGBUaGUgX19fX18gbmF0dXJlIG9mICR7dG9waWN9IGRlbWFuZHMgYSBtdWx0aWZhY2V0ZWQgYXBwcm9hY2guYCwgaXNHYXA6IHRydWUgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlR1dG9yXCIsIGxpbmU6IGBIb3cgZG8geW91IF9fX19fIHRoZSBhcHBhcmVudCBjb250cmFkaWN0aW9ucz9gLCBpc0dhcDogdHJ1ZSB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiU3R1ZGVudFwiLCBsaW5lOiBcIlRoZSBfX19fXyByZWZsZWN0IGJyb2FkZXIgY29tcGxleGl0aWVzLlwiLCBpc0dhcDogdHJ1ZSB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiVHV0b3JcIiwgbGluZTogYFdoYXQgdGhlb3JldGljYWwgX19fX18gYmVzdCBpbGx1bWluYXRlIHRoaXM/YCwgaXNHYXA6IHRydWUgfVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgYW5zd2VyczogW1wibnVhbmNlZFwiLCBcInJlY29uY2lsZVwiLCBcInBhcmFkb3hlc1wiLCBcImZyYW1ld29ya3NcIl1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBsZXZlbEdhcERpYWxvZ3Vlc1tzdHVkZW50TGV2ZWwgYXMga2V5b2YgdHlwZW9mIGxldmVsR2FwRGlhbG9ndWVzXSB8fCBsZXZlbEdhcERpYWxvZ3Vlc1snQjEnXVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGxlc3NvbkFJU2VydmVyR2VuZXJhdG9yID0gbmV3IExlc3NvbkFJU2VydmVyR2VuZXJhdG9yKClcclxuIl0sIm5hbWVzIjpbImNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZSIsIlByb2dyZXNzaXZlR2VuZXJhdG9ySW1wbCIsInVzYWdlTW9uaXRvciIsIkxlc3NvbkFJU2VydmVyR2VuZXJhdG9yIiwiZ2V0R29vZ2xlQUkiLCJnb29nbGVBSSIsImdldFByb2dyZXNzaXZlR2VuZXJhdG9yIiwicHJvZ3Jlc3NpdmVHZW5lcmF0b3IiLCJzdW1tYXJpemVBbmRBZGFwdENvbnRlbnQiLCJzb3VyY2VUZXh0Iiwic3R1ZGVudExldmVsIiwidGFyZ2V0TGFuZ3VhZ2UiLCJsZXZlbEd1aWRhbmNlIiwiZ3VpZGFuY2UiLCJwcm9tcHQiLCJzdWJzdHJpbmciLCJjb25zb2xlIiwibG9nIiwibGVuZ3RoIiwicmVzcG9uc2UiLCJ0cmltIiwiZXJyb3IiLCJnZW5lcmF0ZUxlc3NvbiIsInBhcmFtcyIsImxlc3NvblR5cGUiLCJzb3VyY2VVcmwiLCJjb250ZW50TWV0YWRhdGEiLCJzdHJ1Y3R1cmVkQ29udGVudCIsIndvcmRDb3VudCIsInJlYWRpbmdUaW1lIiwiZ2VuZXJhdGlvbkNvbnRleHQiLCJsZXNzb25JZCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJkaWZmaWN1bHR5TGV2ZWwiLCJjb250ZW50TGVuZ3RoIiwidGltZXN0YW1wIiwiRXJyb3IiLCJ0ZXh0TGVuZ3RoIiwiaGFzTWV0YWRhdGEiLCJoYXNTdHJ1Y3R1cmVkQ29udGVudCIsImFkYXB0YXRpb25TdGFydFRpbWUiLCJhZGFwdGVkQ29udGVudCIsImFkYXB0YXRpb25FbmRUaW1lIiwibG9nVG9rZW5Vc2FnZSIsImNlaWwiLCJsZXNzb25HZW5lcmF0aW9uU3RhcnRUaW1lIiwibGVzc29uU3RydWN0dXJlIiwiZ2VuZXJhdGVNaW5pbWFsQUlMZXNzb24iLCJsZXNzb25HZW5lcmF0aW9uRW5kVGltZSIsIk9iamVjdCIsImtleXMiLCJmaW5hbExlc3NvbiIsInNlY3Rpb25zIiwic2VjdGlvbnNDb3VudCIsIndhcm11cENvdW50Iiwid2FybXVwIiwidm9jYWJ1bGFyeUNvdW50Iiwidm9jYWJ1bGFyeSIsImxvZ0Vycm9yIiwibWV0YWRhdGEiLCJwcm9ncmVzc2l2ZUdlbiIsInNoYXJlZENvbnRleHQiLCJidWlsZFNoYXJlZENvbnRleHQiLCJsZXNzb25TZWN0aW9ucyIsIm5hbWUiLCJwcmlvcml0eSIsImRlcGVuZGVuY2llcyIsImdlbmVyYXRlZFNlY3Rpb25zIiwiY3VycmVudENvbnRleHQiLCJzZWN0aW9uIiwiZ2VuZXJhdGVkU2VjdGlvbiIsImdlbmVyYXRlU2VjdGlvbiIsInB1c2giLCJ1cGRhdGVDb250ZXh0Iiwidm9jYWJ1bGFyeVdvcmRzIiwiZmluZCIsInMiLCJzZWN0aW9uTmFtZSIsImNvbnRlbnQiLCJmaWx0ZXIiLCJpdGVtIiwid29yZCIsIm1hcCIsIm1haW5Ub3BpYyIsIm1haW5UaGVtZXMiLCJkaWFsb2d1ZVByYWN0aWNlIiwiZ2VuZXJhdGVUZW1wbGF0ZURpYWxvZ3VlUHJhY3RpY2UiLCJkaWFsb2d1ZUZpbGxHYXAiLCJnZW5lcmF0ZVRlbXBsYXRlRGlhbG9ndWVGaWxsR2FwIiwiZ2VuZXJhdGVNaW5pbWFsV2FybXVwIiwidG9waWNzIiwiZXh0cmFjdEJldHRlclRvcGljcyIsInF1ZXN0aW9ucyIsInNwbGl0IiwibGluZSIsImVuZHNXaXRoIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsInJlcGxhY2UiLCJzbGljZSIsIm1lc3NhZ2UiLCJhZGRXYXJtdXBJbnN0cnVjdGlvbnMiLCJpbnN0cnVjdGlvbiIsImFkZENvbXByZWhlbnNpb25JbnN0cnVjdGlvbnMiLCJhZGREaXNjdXNzaW9uSW5zdHJ1Y3Rpb25zIiwiYWRkV3JhcHVwSW5zdHJ1Y3Rpb25zIiwiYWRkVm9jYWJ1bGFyeUluc3RydWN0aW9ucyIsIm1lYW5pbmciLCJleGFtcGxlIiwiYWRkUmVhZGluZ0luc3RydWN0aW9ucyIsInJlYWRpbmdUZXh0IiwidGV4dCIsImNvbXBvdW5kUGF0dGVybnMiLCJwYXR0ZXJuIiwibWF0Y2hlcyIsIm1hdGNoIiwibSIsIndvcmRzIiwiY29tbW9uV29yZHMiLCJmb3VuZFdvcmRzIiwiZ2VuZXJhdGVNaW5pbWFsVm9jYWJ1bGFyeSIsIm1lYW5pbmdmdWxXb3JkcyIsImV4dHJhY3RNZWFuaW5nZnVsVm9jYWJ1bGFyeSIsImNhcGl0YWxpemVkV29yZCIsImNhcGl0YWxpemVXb3JkIiwiZGVmaW5pdGlvblByb21wdCIsInJhd01lYW5pbmciLCJjbGVhbkRlZmluaXRpb24iLCJleGFtcGxlcyIsImdlbmVyYXRlQUlFeGFtcGxlU2VudGVuY2VzIiwiZ2VuZXJhdGVDb250ZXh0dWFsV29yZE1lYW5pbmciLCJnZW5lcmF0ZU1pbmltYWxDb21wcmVoZW5zaW9uIiwic2hvcnRUZXh0IiwiZ2VuZXJhdGVNaW5pbWFsUmVhZGluZyIsImdlbmVyYXRlTWluaW1hbERpc2N1c3Npb24iLCJnZW5lcmF0ZU1pbmltYWxHcmFtbWFyIiwiSlNPTiIsInBhcnNlIiwiZ2VuZXJhdGVNaW5pbWFsUHJvbnVuY2lhdGlvbiIsImdlbmVyYXRlTWluaW1hbFdyYXB1cCIsImFuYWx5emVDb250ZW50Q29udGV4dE5vQUkiLCJhbmFseXNpcyIsImNvbnRlbnRUeXBlIiwiZG9tYWluIiwiY29tcGxleGl0eSIsImtleVZvY2FidWxhcnkiLCJjdWx0dXJhbENvbnRleHQiLCJsZWFybmluZ09iamVjdGl2ZXMiLCJkaWZmaWN1bHR5IiwidGl0bGUiLCJzb3VyY2VDb3VudHJ5IiwiZGV0ZXJtaW5lU291cmNlQ291bnRyeSIsInNlbnRlbmNlcyIsImF2Z1NlbnRlbmNlTGVuZ3RoIiwicmVkdWNlIiwic3VtIiwiY29tcGxleFdvcmRzIiwidG90YWxXb3JkcyIsImV4dHJhY3RUb3BpY3NGcm9tVGV4dCIsImhlYWRpbmdzIiwiZXh0cmFjdFZvY2FidWxhcnlGcm9tVGV4dCIsImRldGVybWluZUN1bHR1cmFsQ29udGV4dCIsImdlbmVyYXRlTGVhcm5pbmdPYmplY3RpdmVzIiwiYW5hbHl6ZUNvbnRlbnRDb250ZXh0IiwiY3JlYXRlQ29udGV4dHVhbFN1bW1hcnkiLCJjb250ZW50QW5hbHlzaXMiLCJzdW1tYXJ5UHJvbXB0Iiwic3VtbWFyeSIsInRlbXBlcmF0dXJlIiwibWF4VG9rZW5zIiwid2FybiIsInRydW5jYXRlZCIsImdlbmVyYXRlQ29udGV4dHVhbFdhcm11cFF1ZXN0aW9ucyIsImxldmVsSW5zdHJ1Y3Rpb25zIiwidG9waWMiLCJ3YXJtdXBQcm9tcHQiLCJwYXJzZUxpc3RGcm9tVGV4dCIsImZhbGxiYWNrUXVlc3Rpb24iLCJnZXRGYWxsYmFja1dhcm11cFF1ZXN0aW9uIiwiZmFsbGJhY2tRdWVzdGlvbnMiLCJnZXRDb250ZXh0dWFsV2FybXVwRmFsbGJhY2siLCJnZW5lcmF0ZUNvbnRleHR1YWxMZXNzb25TdHJ1Y3R1cmUiLCJjb250ZXh0dWFsV2FybXVwIiwiam9pbiIsInZvY2FiIiwic3RyaW5naWZ5IiwicGFyc2VkIiwicGFyc2VFcnJvciIsImpzb25NYXRjaCIsImNsZWFuZWQiLCJjbGVhbkVycm9yIiwiZmFsbGJhY2siLCJjcmVhdGVTdHJ1Y3R1cmVkRmFsbGJhY2siLCJnZW5lcmF0ZURldGFpbGVkQ29udGV4dHVhbENvbnRlbnQiLCJzdHJ1Y3R1cmUiLCJpIiwiY29udGV4dHVhbEV4YW1wbGVQcm9tcHQiLCJlbmhhbmNlZEV4YW1wbGUiLCJ3cml0ZSIsInRvbmUiLCJjb250ZXh0dWFsTWVhbmluZ1Byb21wdCIsImNvbnRleHR1YWxNZWFuaW5nIiwiZGlzY3Vzc2lvbiIsImVuaGFuY2VkRGlzY3Vzc2lvblByb21wdCIsImVuaGFuY2VkRGlzY3Vzc2lvbiIsImZvcm1hdCIsInJlYWRpbmciLCJzdHJ1Y3R1cmVkUmVhZGluZ1Byb21wdCIsImgiLCJlbmhhbmNlZFJlYWRpbmciLCJyZXdyaXRlIiwiYXVkaWVuY2UiLCJnZXRBdWRpZW5jZUxldmVsIiwiZ3JhbW1hciIsImZvY3VzIiwiZ3JhbW1hckV4YW1wbGVzUHJvbXB0IiwiY29udGV4dHVhbEdyYW1tYXJFeGFtcGxlcyIsImNvbnRleHR1YWxFeGFtcGxlcyIsInByb29mcmVhZExlc3NvbiIsImxlc3NvbiIsInNlY3Rpb25zVG9Qcm9vZnJlYWQiLCJzZWN0aW9uUGF0aCIsInZhbHVlIiwiZ2V0TmVzdGVkVmFsdWUiLCJwcm9vZnJlYWQiLCJjaGVja0dyYW1tYXIiLCJjaGVja1NwZWxsaW5nIiwiY2hlY2tTdHlsZSIsInNldE5lc3RlZFZhbHVlIiwiY29ycmVjdGVkX3RleHQiLCJnZW5lcmF0ZUZhbGxiYWNrTGVzc29uIiwiZ2V0VGVtcGxhdGVXYXJtdXAiLCJleHRyYWN0Vm9jYWJ1bGFyeSIsInNpbXBsaWZ5VGV4dCIsImNvbXByZWhlbnNpb24iLCJnZXRUZW1wbGF0ZUNvbXByZWhlbnNpb24iLCJnZXRUZW1wbGF0ZURpc2N1c3Npb24iLCJnZXRUZW1wbGF0ZUdyYW1tYXIiLCJwcm9udW5jaWF0aW9uIiwiZ2V0VGVtcGxhdGVQcm9udW5jaWF0aW9uIiwid3JhcHVwIiwiZ2V0VGVtcGxhdGVXcmFwdXAiLCJnZXRTdW1tYXJ5TGVuZ3RoIiwibGV2ZWwiLCJsZW5ndGhNYXAiLCJBMSIsIkEyIiwiQjEiLCJCMiIsIkMxIiwiZ2V0TGFuZ3VhZ2VDb2RlIiwibGFuZ3VhZ2UiLCJsYW5ndWFnZU1hcCIsInNwYW5pc2giLCJmcmVuY2giLCJnZXJtYW4iLCJpdGFsaWFuIiwicG9ydHVndWVzZSIsImphcGFuZXNlIiwia29yZWFuIiwiY2hpbmVzZSIsIm9iaiIsInBhdGgiLCJjdXJyZW50Iiwia2V5IiwibGFzdEtleSIsInBvcCIsInRhcmdldCIsInVuaXF1ZVdvcmRzIiwiQXJyYXkiLCJmcm9tIiwiU2V0IiwidGVtcGxhdGVzIiwidHJhdmVsIiwiYnVzaW5lc3MiLCJzZWxlY3RlZFdvcmRzIiwibWF4TGVuZ3RoIiwibGltaXQiLCJncmFtbWFyRm9jaSIsImV4ZXJjaXNlIiwic2VsZWN0ZWRXb3JkIiwiaXBhIiwicHJhY3RpY2UiLCJleHRyYWN0VG9waWNzRnJvbUhlYWRpbmdzIiwiaGVhZGluZ1RvcGljcyIsInRvcGljUGF0dGVybnMiLCJzZW50ZW5jZSIsImtleVdvcmRzIiwiaW5kZXgiLCJhcnIiLCJpbmRleE9mIiwiZXhjbHVkZVdvcmRzIiwiaGFzIiwidGVzdCIsImlzUHJvcGVyTmFtZSIsInNjb3JlZFdvcmRzIiwic2NvcmUiLCJmcmVxdWVuY3kiLCJSZWdFeHAiLCJ0b3BXb3JkcyIsInNvcnQiLCJhIiwiYiIsInciLCJjdWx0dXJhbEluZGljYXRvcnMiLCJhbWVyaWNhbk1hcmtlcnMiLCJicml0aXNoTWFya2VycyIsImFtZXJpY2FuQ291bnQiLCJtYXJrZXIiLCJicml0aXNoQ291bnQiLCJvYmplY3RpdmVzIiwiZm9yRWFjaCIsImNlZnJMZXZlbCIsImxldmVsTWFwIiwiZ2VuZXJhdGVFbmhhbmNlZEZhbGxiYWNrTGVzc29uIiwibW9ja0NvbnRlbnRBbmFseXNpcyIsImV4dHJhY3RDb250ZXh0dWFsVm9jYWJ1bGFyeSIsImdldENvbnRleHR1YWxDb21wcmVoZW5zaW9uIiwiZ2V0Q29udGV4dHVhbERpc2N1c3Npb24iLCJnZXRDb250ZXh0dWFsV3JhcHVwIiwiZ2V0Q29udGV4dHVhbFdhcm11cCIsIm1vY2tBbmFseXNpcyIsImdlbmVyYXRlQmFzaWNGYWxsYmFja0xlc3NvbiIsImNvbnRleHQiLCJiYXNlUXVlc3Rpb25zIiwibGV2ZWxEaWFsb2d1ZXMiLCJkaWFsb2d1ZSIsImNoYXJhY3RlciIsImZvbGxvd1VwUXVlc3Rpb25zIiwibGV2ZWxHYXBEaWFsb2d1ZXMiLCJpc0dhcCIsImFuc3dlcnMiLCJsZXNzb25BSVNlcnZlckdlbmVyYXRvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/lesson-ai-generator-server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/progressive-generator.ts":
/*!**************************************!*\
  !*** ./lib/progressive-generator.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ProgressiveGeneratorImpl: () => (/* binding */ ProgressiveGeneratorImpl)\n/* harmony export */ });\n/* harmony import */ var _google_ai_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./google-ai-server */ \"(rsc)/./lib/google-ai-server.ts\");\n\n// Implementation of Progressive Generator\nclass ProgressiveGeneratorImpl {\n    getGoogleAI() {\n        if (!this.googleAI) {\n            this.googleAI = (0,_google_ai_server__WEBPACK_IMPORTED_MODULE_0__.createGoogleAIServerService)();\n        }\n        return this.googleAI;\n    }\n    /**\r\n   * Build shared context that will be reused across all lesson sections\r\n   */ async buildSharedContext(sourceText, lessonType, studentLevel, targetLanguage) {\n        console.log(\"\\uD83C\\uDFD7️ Building shared context for progressive generation...\");\n        try {\n            // Extract key vocabulary using AI optimization\n            const keyVocabulary = await this.extractKeyVocabulary(sourceText, studentLevel);\n            // Extract main themes\n            const mainThemes = await this.extractMainThemes(sourceText, studentLevel);\n            // Create content summary\n            const contentSummary = await this.createContentSummary(sourceText, studentLevel);\n            const sharedContext = {\n                keyVocabulary,\n                mainThemes,\n                difficultyLevel: studentLevel,\n                contentSummary,\n                sourceText: sourceText.substring(0, 1000),\n                lessonType,\n                targetLanguage\n            };\n            console.log(\"✅ Shared context built:\", {\n                vocabularyCount: keyVocabulary.length,\n                themesCount: mainThemes.length,\n                summaryLength: contentSummary.length\n            });\n            return sharedContext;\n        } catch (error) {\n            console.error(\"❌ Failed to build shared context:\", error);\n            throw new Error(\"Failed to build shared context: \" + error.message);\n        }\n    }\n    /**\r\n   * Generate a specific lesson section using shared context\r\n   */ async generateSection(section, sharedContext, previousSections) {\n        console.log(`🎯 Generating section: ${section.name}`);\n        const startTime = Date.now();\n        let content;\n        let tokensUsed = 0;\n        let generationStrategy = \"progressive\";\n        try {\n            switch(section.name){\n                case \"warmup\":\n                    content = await this.generateWarmupWithContext(sharedContext, previousSections);\n                    break;\n                case \"vocabulary\":\n                    content = await this.generateVocabularyWithContext(sharedContext, previousSections);\n                    break;\n                case \"reading\":\n                    content = await this.generateReadingWithContext(sharedContext, previousSections);\n                    break;\n                case \"comprehension\":\n                    content = await this.generateComprehensionWithContext(sharedContext, previousSections);\n                    break;\n                case \"discussion\":\n                    content = await this.generateDiscussionWithContext(sharedContext, previousSections);\n                    break;\n                case \"grammar\":\n                    content = await this.generateGrammarWithContext(sharedContext, previousSections);\n                    break;\n                case \"pronunciation\":\n                    content = await this.generatePronunciationWithContext(sharedContext, previousSections);\n                    break;\n                case \"wrapup\":\n                    content = await this.generateWrapupWithContext(sharedContext, previousSections);\n                    break;\n                default:\n                    throw new Error(`Unknown section: ${section.name}`);\n            }\n            const generationTime = Date.now() - startTime;\n            console.log(`✅ Section ${section.name} generated in ${generationTime}ms`);\n            return {\n                sectionName: section.name,\n                content,\n                tokensUsed,\n                generationStrategy\n            };\n        } catch (error) {\n            console.error(`❌ Failed to generate section ${section.name}:`, error);\n            throw new Error(`Failed to generate ${section.name} section: ${error.message}`);\n        }\n    }\n    /**\r\n   * Update shared context with information from newly generated section\r\n   */ updateContext(context, newSection) {\n        console.log(`🔄 Updating context with ${newSection.sectionName} section`);\n        const updatedContext = {\n            ...context\n        };\n        // Update vocabulary if new words were introduced\n        if (newSection.sectionName === \"vocabulary\" && Array.isArray(newSection.content)) {\n            const newWords = newSection.content.filter((item)=>item.word && item.word !== \"INSTRUCTION\").map((item)=>item.word.toLowerCase());\n            updatedContext.keyVocabulary = [\n                ...new Set([\n                    ...updatedContext.keyVocabulary,\n                    ...newWords\n                ])\n            ];\n        }\n        // Update themes if new ones were identified\n        if (newSection.sectionName === \"reading\" && typeof newSection.content === \"string\") {\n            // Extract any new themes from the reading passage\n            const newThemes = this.extractThemesFromText(newSection.content);\n            updatedContext.mainThemes = [\n                ...new Set([\n                    ...updatedContext.mainThemes,\n                    ...newThemes\n                ])\n            ];\n        }\n        console.log(`✅ Context updated for ${newSection.sectionName}`);\n        return updatedContext;\n    }\n    // Private helper methods for extracting shared context\n    async extractKeyVocabulary(sourceText, studentLevel) {\n        const prompt = `Extract 8-12 key vocabulary words from this text for ${studentLevel} level students. Return only the words, one per line:\r\n\r\n${sourceText.substring(0, 500)}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const words = response.split(\"\\n\").map((line)=>line.trim().toLowerCase()).filter((word)=>word.length > 2 && word.length < 20).slice(0, 12);\n            return words.length >= 6 ? words : this.extractVocabularyFallback(sourceText, studentLevel);\n        } catch (error) {\n            console.log(\"⚠️ AI vocabulary extraction failed, using fallback\");\n            return this.extractVocabularyFallback(sourceText, studentLevel);\n        }\n    }\n    async extractMainThemes(sourceText, studentLevel) {\n        const prompt = `Identify 3-5 main themes or topics in this text for ${studentLevel} level students. Return only the themes, one per line:\r\n\r\n${sourceText.substring(0, 400)}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const themes = response.split(\"\\n\").map((line)=>line.trim().toLowerCase()).filter((theme)=>theme.length > 3 && theme.length < 50).slice(0, 5);\n            return themes.length >= 2 ? themes : this.extractThemesFallback(sourceText);\n        } catch (error) {\n            console.log(\"⚠️ AI theme extraction failed, using fallback\");\n            return this.extractThemesFallback(sourceText);\n        }\n    }\n    async createContentSummary(sourceText, studentLevel) {\n        const prompt = `Summarize this text in 2-3 sentences for ${studentLevel} level students:\r\n\r\n${sourceText.substring(0, 600)}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            return response.trim().substring(0, 300);\n        } catch (error) {\n            console.log(\"⚠️ AI summary failed, using truncation\");\n            return sourceText.substring(0, 200) + \"...\";\n        }\n    }\n    // Section generation methods using shared context\n    async generateWarmupWithContext(context, previousSections) {\n        const mainTheme = context.mainThemes[0] || \"this topic\";\n        const prompt = `Create 3 ${context.difficultyLevel} warm-up questions about ${mainTheme}. \r\nContext: ${context.contentSummary}\r\nReturn only questions, one per line:`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.endsWith(\"?\") && line.length > 10).slice(0, 3);\n            if (questions.length < 3) {\n                throw new Error(\"Insufficient questions generated\");\n            }\n            const instruction = \"Have the following conversations or discussions with your tutor before reading the text:\";\n            return [\n                instruction,\n                ...questions\n            ];\n        } catch (error) {\n            throw new Error(\"Failed to generate warmup questions: \" + error.message);\n        }\n    }\n    async generateVocabularyWithContext(context, previousSections) {\n        const vocabulary = [];\n        for (const word of context.keyVocabulary.slice(0, 8)){\n            try {\n                const definitionPrompt = `Define \"${word}\" simply for ${context.difficultyLevel} level. Context: ${context.contentSummary}. Give only the definition:`;\n                const meaning = await this.getGoogleAI().prompt(definitionPrompt);\n                const examplePrompt = `Create a simple example sentence using \"${word}\" for ${context.difficultyLevel} level students:`;\n                const example = await this.getGoogleAI().prompt(examplePrompt);\n                vocabulary.push({\n                    word: this.capitalizeWord(word),\n                    meaning: meaning.trim().substring(0, 150),\n                    example: example.trim().substring(0, 100)\n                });\n            } catch (error) {\n                console.log(`⚠️ Failed to generate vocabulary for ${word}`);\n            }\n        }\n        const instruction = {\n            word: \"INSTRUCTION\",\n            meaning: \"Study the following words with your tutor before reading the text:\",\n            example: \"\"\n        };\n        return [\n            instruction,\n            ...vocabulary\n        ];\n    }\n    async generateReadingWithContext(context, previousSections) {\n        // Use vocabulary from previous sections if available\n        const vocabularySection = previousSections.find((s)=>s.sectionName === \"vocabulary\");\n        const vocabularyWords = vocabularySection ? vocabularySection.content.filter((item)=>item.word !== \"INSTRUCTION\").map((item)=>item.word).slice(0, 5) : context.keyVocabulary.slice(0, 5);\n        const prompt = `Rewrite this text for ${context.difficultyLevel} level students. \r\nUse these vocabulary words: ${vocabularyWords.join(\", \")}\r\nKeep it 200-400 words:\r\n\r\n${context.sourceText}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const instruction = \"Read the following text carefully. Your tutor will help you with any difficult words or concepts:\";\n            return `${instruction}\\n\\n${response.trim()}`;\n        } catch (error) {\n            throw new Error(\"Failed to generate reading passage: \" + error.message);\n        }\n    }\n    async generateComprehensionWithContext(context, previousSections) {\n        const prompt = `Create 5 ${context.difficultyLevel} comprehension questions about this content:\r\n${context.contentSummary}\r\nReturn only questions, one per line:`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.endsWith(\"?\") && line.length > 10).slice(0, 5);\n            if (questions.length < 5) {\n                throw new Error(\"Insufficient comprehension questions generated\");\n            }\n            const instruction = \"After reading the text, answer these comprehension questions:\";\n            return [\n                instruction,\n                ...questions\n            ];\n        } catch (error) {\n            throw new Error(\"Failed to generate comprehension questions: \" + error.message);\n        }\n    }\n    async generateDiscussionWithContext(context, previousSections) {\n        const themes = context.mainThemes.slice(0, 2).join(\" and \");\n        const prompt = `Create 3 ${context.difficultyLevel} discussion questions about ${themes}.\r\nContext: ${context.contentSummary}\r\nReturn only questions, one per line:`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.endsWith(\"?\") && line.length > 10).slice(0, 3);\n            if (questions.length < 3) {\n                throw new Error(\"Insufficient discussion questions generated\");\n            }\n            const instruction = \"Discuss these questions with your tutor to explore the topic in depth:\";\n            return [\n                instruction,\n                ...questions\n            ];\n        } catch (error) {\n            throw new Error(\"Failed to generate discussion questions: \" + error.message);\n        }\n    }\n    async generateGrammarWithContext(context, previousSections) {\n        const prompt = `Create a grammar lesson for ${context.difficultyLevel} level based on this content:\r\n${context.contentSummary}\r\n\r\nReturn JSON with: focus (grammar point), examples (3 examples), exercise (3 practice sentences)`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            return JSON.parse(response);\n        } catch (error) {\n            // Fallback grammar structure\n            return {\n                focus: \"Present Simple Tense\",\n                examples: [\n                    \"I read the news every day.\",\n                    \"She works in an office.\",\n                    \"They play sports on weekends.\"\n                ],\n                exercise: [\n                    \"Complete: He _____ (work) in London.\",\n                    \"Complete: We _____ (study) English.\",\n                    \"Complete: She _____ (like) coffee.\"\n                ]\n            };\n        }\n    }\n    async generatePronunciationWithContext(context, previousSections) {\n        const word = context.keyVocabulary[0] || \"communication\";\n        const prompt = `Create pronunciation practice for \"${word}\". \r\nReturn JSON with: word, ipa (phonetic transcription), practice (pronunciation tip)`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            return JSON.parse(response);\n        } catch (error) {\n            // Fallback pronunciation structure\n            return {\n                word: word,\n                ipa: `/kəˌmjuːnɪˈkeɪʃən/`,\n                practice: `Break it down: com-mu-ni-ca-tion. Stress on the 4th syllable: ca-TION.`\n            };\n        }\n    }\n    async generateWrapupWithContext(context, previousSections) {\n        const prompt = `Create 3 ${context.difficultyLevel} wrap-up questions about this lesson:\r\n${context.contentSummary}\r\nReturn only questions, one per line:`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.endsWith(\"?\") && line.length > 10).slice(0, 3);\n            if (questions.length < 3) {\n                throw new Error(\"Insufficient wrapup questions generated\");\n            }\n            const instruction = \"Reflect on your learning by discussing these wrap-up questions:\";\n            return [\n                instruction,\n                ...questions\n            ];\n        } catch (error) {\n            throw new Error(\"Failed to generate wrapup questions: \" + error.message);\n        }\n    }\n    // Fallback methods for when AI extraction fails\n    extractVocabularyFallback(sourceText, studentLevel) {\n        const words = sourceText.toLowerCase().match(/\\b[a-z]{4,12}\\b/g) || [];\n        const commonWords = [\n            \"the\",\n            \"and\",\n            \"that\",\n            \"have\",\n            \"for\",\n            \"not\",\n            \"with\",\n            \"you\",\n            \"this\",\n            \"but\",\n            \"his\",\n            \"from\",\n            \"they\"\n        ];\n        const filteredWords = words.filter((word)=>!commonWords.includes(word)).filter((word, index, arr)=>arr.indexOf(word) === index).slice(0, 8);\n        return filteredWords.length >= 4 ? filteredWords : [\n            \"communication\",\n            \"important\",\n            \"different\",\n            \"example\",\n            \"information\",\n            \"situation\"\n        ];\n    }\n    extractThemesFallback(sourceText) {\n        const text = sourceText.toLowerCase();\n        const themes = [];\n        // Look for common themes\n        if (text.includes(\"sport\") || text.includes(\"game\") || text.includes(\"team\")) themes.push(\"sports\");\n        if (text.includes(\"business\") || text.includes(\"company\") || text.includes(\"work\")) themes.push(\"business\");\n        if (text.includes(\"travel\") || text.includes(\"country\") || text.includes(\"culture\")) themes.push(\"travel\");\n        if (text.includes(\"technology\") || text.includes(\"computer\") || text.includes(\"internet\")) themes.push(\"technology\");\n        if (text.includes(\"health\") || text.includes(\"medical\") || text.includes(\"doctor\")) themes.push(\"health\");\n        return themes.length > 0 ? themes : [\n            \"general topic\",\n            \"communication\",\n            \"daily life\"\n        ];\n    }\n    extractThemesFromText(text) {\n        return this.extractThemesFallback(text);\n    }\n    capitalizeWord(word) {\n        return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();\n    }\n    constructor(){\n        this.googleAI = null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDLGNBQWNJLEtBQUtKLFFBQVEsQ0FBQyxXQUFXN0IsT0FBT1ksSUFBSSxDQUFDO1FBRWhHLE9BQU9aLE9BQU9qRCxNQUFNLEdBQUcsSUFBSWlELFNBQVM7WUFBQztZQUFpQjtZQUFpQjtTQUFhO0lBQ3RGO0lBRVFULHNCQUFzQjBDLElBQVksRUFBWTtRQUNwRCxPQUFPLElBQUksQ0FBQy9CLHFCQUFxQixDQUFDK0I7SUFDcEM7SUFFUXBCLGVBQWUzQixJQUFZLEVBQVU7UUFDM0MsT0FBT0EsS0FBS2dELE1BQU0sQ0FBQyxHQUFHQyxXQUFXLEtBQUtqRCxLQUFLWSxLQUFLLENBQUMsR0FBR1YsV0FBVztJQUNqRTs7YUEzY1F2RCxXQUFrRTs7QUE0YzVFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktdjAtcHJvamVjdC8uL2xpYi9wcm9ncmVzc2l2ZS1nZW5lcmF0b3IudHM/ZTk2YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVHb29nbGVBSVNlcnZlclNlcnZpY2UgfSBmcm9tIFwiLi9nb29nbGUtYWktc2VydmVyXCJcclxuXHJcbi8vIFR5cGVzIGZvciBwcm9ncmVzc2l2ZSBnZW5lcmF0aW9uXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2hhcmVkQ29udGV4dCB7XHJcbiAga2V5Vm9jYWJ1bGFyeTogc3RyaW5nW11cclxuICBtYWluVGhlbWVzOiBzdHJpbmdbXVxyXG4gIGRpZmZpY3VsdHlMZXZlbDogQ0VGUkxldmVsXHJcbiAgY29udGVudFN1bW1hcnk6IHN0cmluZ1xyXG4gIHNvdXJjZVRleHQ6IHN0cmluZ1xyXG4gIGxlc3NvblR5cGU6IHN0cmluZ1xyXG4gIHRhcmdldExhbmd1YWdlOiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBHZW5lcmF0ZWRTZWN0aW9uIHtcclxuICBzZWN0aW9uTmFtZTogc3RyaW5nXHJcbiAgY29udGVudDogYW55XHJcbiAgdG9rZW5zVXNlZDogbnVtYmVyXHJcbiAgZ2VuZXJhdGlvblN0cmF0ZWd5OiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBMZXNzb25TZWN0aW9uIHtcclxuICBuYW1lOiBzdHJpbmdcclxuICBwcmlvcml0eTogbnVtYmVyXHJcbiAgZGVwZW5kZW5jaWVzOiBzdHJpbmdbXVxyXG59XHJcblxyXG5leHBvcnQgdHlwZSBDRUZSTGV2ZWwgPSAnQTEnIHwgJ0EyJyB8ICdCMScgfCAnQjInIHwgJ0MxJ1xyXG5cclxuLy8gUHJvZ3Jlc3NpdmUgR2VuZXJhdG9yIEludGVyZmFjZVxyXG5leHBvcnQgaW50ZXJmYWNlIFByb2dyZXNzaXZlR2VuZXJhdG9yIHtcclxuICBnZW5lcmF0ZVNlY3Rpb24oXHJcbiAgICBzZWN0aW9uOiBMZXNzb25TZWN0aW9uLFxyXG4gICAgc2hhcmVkQ29udGV4dDogU2hhcmVkQ29udGV4dCxcclxuICAgIHByZXZpb3VzU2VjdGlvbnM6IEdlbmVyYXRlZFNlY3Rpb25bXVxyXG4gICk6IFByb21pc2U8R2VuZXJhdGVkU2VjdGlvbj5cclxuICBcclxuICBidWlsZFNoYXJlZENvbnRleHQoXHJcbiAgICBzb3VyY2VUZXh0OiBzdHJpbmcsXHJcbiAgICBsZXNzb25UeXBlOiBzdHJpbmcsXHJcbiAgICBzdHVkZW50TGV2ZWw6IENFRlJMZXZlbCxcclxuICAgIHRhcmdldExhbmd1YWdlOiBzdHJpbmdcclxuICApOiBQcm9taXNlPFNoYXJlZENvbnRleHQ+XHJcbiAgXHJcbiAgdXBkYXRlQ29udGV4dChcclxuICAgIGNvbnRleHQ6IFNoYXJlZENvbnRleHQsXHJcbiAgICBuZXdTZWN0aW9uOiBHZW5lcmF0ZWRTZWN0aW9uXHJcbiAgKTogU2hhcmVkQ29udGV4dFxyXG59XHJcblxyXG4vLyBJbXBsZW1lbnRhdGlvbiBvZiBQcm9ncmVzc2l2ZSBHZW5lcmF0b3JcclxuZXhwb3J0IGNsYXNzIFByb2dyZXNzaXZlR2VuZXJhdG9ySW1wbCBpbXBsZW1lbnRzIFByb2dyZXNzaXZlR2VuZXJhdG9yIHtcclxuICBwcml2YXRlIGdvb2dsZUFJOiBSZXR1cm5UeXBlPHR5cGVvZiBjcmVhdGVHb29nbGVBSVNlcnZlclNlcnZpY2U+IHwgbnVsbCA9IG51bGxcclxuXHJcbiAgcHJpdmF0ZSBnZXRHb29nbGVBSSgpIHtcclxuICAgIGlmICghdGhpcy5nb29nbGVBSSkge1xyXG4gICAgICB0aGlzLmdvb2dsZUFJID0gY3JlYXRlR29vZ2xlQUlTZXJ2ZXJTZXJ2aWNlKClcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLmdvb2dsZUFJXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBCdWlsZCBzaGFyZWQgY29udGV4dCB0aGF0IHdpbGwgYmUgcmV1c2VkIGFjcm9zcyBhbGwgbGVzc29uIHNlY3Rpb25zXHJcbiAgICovXHJcbiAgYXN5bmMgYnVpbGRTaGFyZWRDb250ZXh0KFxyXG4gICAgc291cmNlVGV4dDogc3RyaW5nLFxyXG4gICAgbGVzc29uVHlwZTogc3RyaW5nLFxyXG4gICAgc3R1ZGVudExldmVsOiBDRUZSTGV2ZWwsXHJcbiAgICB0YXJnZXRMYW5ndWFnZTogc3RyaW5nXHJcbiAgKTogUHJvbWlzZTxTaGFyZWRDb250ZXh0PiB7XHJcbiAgICBjb25zb2xlLmxvZyhcIvCfj5fvuI8gQnVpbGRpbmcgc2hhcmVkIGNvbnRleHQgZm9yIHByb2dyZXNzaXZlIGdlbmVyYXRpb24uLi5cIilcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBFeHRyYWN0IGtleSB2b2NhYnVsYXJ5IHVzaW5nIEFJIG9wdGltaXphdGlvblxyXG4gICAgICBjb25zdCBrZXlWb2NhYnVsYXJ5ID0gYXdhaXQgdGhpcy5leHRyYWN0S2V5Vm9jYWJ1bGFyeShzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpXHJcbiAgICAgIFxyXG4gICAgICAvLyBFeHRyYWN0IG1haW4gdGhlbWVzXHJcbiAgICAgIGNvbnN0IG1haW5UaGVtZXMgPSBhd2FpdCB0aGlzLmV4dHJhY3RNYWluVGhlbWVzKHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbClcclxuICAgICAgXHJcbiAgICAgIC8vIENyZWF0ZSBjb250ZW50IHN1bW1hcnlcclxuICAgICAgY29uc3QgY29udGVudFN1bW1hcnkgPSBhd2FpdCB0aGlzLmNyZWF0ZUNvbnRlbnRTdW1tYXJ5KHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbClcclxuXHJcbiAgICAgIGNvbnN0IHNoYXJlZENvbnRleHQ6IFNoYXJlZENvbnRleHQgPSB7XHJcbiAgICAgICAga2V5Vm9jYWJ1bGFyeSxcclxuICAgICAgICBtYWluVGhlbWVzLFxyXG4gICAgICAgIGRpZmZpY3VsdHlMZXZlbDogc3R1ZGVudExldmVsLFxyXG4gICAgICAgIGNvbnRlbnRTdW1tYXJ5LFxyXG4gICAgICAgIHNvdXJjZVRleHQ6IHNvdXJjZVRleHQuc3Vic3RyaW5nKDAsIDEwMDApLCAvLyBMaW1pdCBmb3IgdG9rZW4gb3B0aW1pemF0aW9uXHJcbiAgICAgICAgbGVzc29uVHlwZSxcclxuICAgICAgICB0YXJnZXRMYW5ndWFnZVxyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhcIuKchSBTaGFyZWQgY29udGV4dCBidWlsdDpcIiwge1xyXG4gICAgICAgIHZvY2FidWxhcnlDb3VudDoga2V5Vm9jYWJ1bGFyeS5sZW5ndGgsXHJcbiAgICAgICAgdGhlbWVzQ291bnQ6IG1haW5UaGVtZXMubGVuZ3RoLFxyXG4gICAgICAgIHN1bW1hcnlMZW5ndGg6IGNvbnRlbnRTdW1tYXJ5Lmxlbmd0aFxyXG4gICAgICB9KVxyXG5cclxuICAgICAgcmV0dXJuIHNoYXJlZENvbnRleHRcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgRmFpbGVkIHRvIGJ1aWxkIHNoYXJlZCBjb250ZXh0OlwiLCBlcnJvcilcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGJ1aWxkIHNoYXJlZCBjb250ZXh0OiBcIiArIGVycm9yLm1lc3NhZ2UpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZW5lcmF0ZSBhIHNwZWNpZmljIGxlc3NvbiBzZWN0aW9uIHVzaW5nIHNoYXJlZCBjb250ZXh0XHJcbiAgICovXHJcbiAgYXN5bmMgZ2VuZXJhdGVTZWN0aW9uKFxyXG4gICAgc2VjdGlvbjogTGVzc29uU2VjdGlvbixcclxuICAgIHNoYXJlZENvbnRleHQ6IFNoYXJlZENvbnRleHQsXHJcbiAgICBwcmV2aW91c1NlY3Rpb25zOiBHZW5lcmF0ZWRTZWN0aW9uW11cclxuICApOiBQcm9taXNlPEdlbmVyYXRlZFNlY3Rpb24+IHtcclxuICAgIGNvbnNvbGUubG9nKGDwn46vIEdlbmVyYXRpbmcgc2VjdGlvbjogJHtzZWN0aW9uLm5hbWV9YClcclxuXHJcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpXHJcbiAgICBsZXQgY29udGVudDogYW55XHJcbiAgICBsZXQgdG9rZW5zVXNlZCA9IDBcclxuICAgIGxldCBnZW5lcmF0aW9uU3RyYXRlZ3kgPSAncHJvZ3Jlc3NpdmUnXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgc3dpdGNoIChzZWN0aW9uLm5hbWUpIHtcclxuICAgICAgICBjYXNlICd3YXJtdXAnOlxyXG4gICAgICAgICAgY29udGVudCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVXYXJtdXBXaXRoQ29udGV4dChzaGFyZWRDb250ZXh0LCBwcmV2aW91c1NlY3Rpb25zKVxyXG4gICAgICAgICAgYnJlYWtcclxuICAgICAgICBjYXNlICd2b2NhYnVsYXJ5JzpcclxuICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB0aGlzLmdlbmVyYXRlVm9jYWJ1bGFyeVdpdGhDb250ZXh0KHNoYXJlZENvbnRleHQsIHByZXZpb3VzU2VjdGlvbnMpXHJcbiAgICAgICAgICBicmVha1xyXG4gICAgICAgIGNhc2UgJ3JlYWRpbmcnOlxyXG4gICAgICAgICAgY29udGVudCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVSZWFkaW5nV2l0aENvbnRleHQoc2hhcmVkQ29udGV4dCwgcHJldmlvdXNTZWN0aW9ucylcclxuICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgY2FzZSAnY29tcHJlaGVuc2lvbic6XHJcbiAgICAgICAgICBjb250ZW50ID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUNvbXByZWhlbnNpb25XaXRoQ29udGV4dChzaGFyZWRDb250ZXh0LCBwcmV2aW91c1NlY3Rpb25zKVxyXG4gICAgICAgICAgYnJlYWtcclxuICAgICAgICBjYXNlICdkaXNjdXNzaW9uJzpcclxuICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB0aGlzLmdlbmVyYXRlRGlzY3Vzc2lvbldpdGhDb250ZXh0KHNoYXJlZENvbnRleHQsIHByZXZpb3VzU2VjdGlvbnMpXHJcbiAgICAgICAgICBicmVha1xyXG4gICAgICAgIGNhc2UgJ2dyYW1tYXInOlxyXG4gICAgICAgICAgY29udGVudCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVHcmFtbWFyV2l0aENvbnRleHQoc2hhcmVkQ29udGV4dCwgcHJldmlvdXNTZWN0aW9ucylcclxuICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgY2FzZSAncHJvbnVuY2lhdGlvbic6XHJcbiAgICAgICAgICBjb250ZW50ID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVByb251bmNpYXRpb25XaXRoQ29udGV4dChzaGFyZWRDb250ZXh0LCBwcmV2aW91c1NlY3Rpb25zKVxyXG4gICAgICAgICAgYnJlYWtcclxuICAgICAgICBjYXNlICd3cmFwdXAnOlxyXG4gICAgICAgICAgY29udGVudCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVXcmFwdXBXaXRoQ29udGV4dChzaGFyZWRDb250ZXh0LCBwcmV2aW91c1NlY3Rpb25zKVxyXG4gICAgICAgICAgYnJlYWtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHNlY3Rpb246ICR7c2VjdGlvbi5uYW1lfWApXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGdlbmVyYXRpb25UaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZVxyXG4gICAgICBjb25zb2xlLmxvZyhg4pyFIFNlY3Rpb24gJHtzZWN0aW9uLm5hbWV9IGdlbmVyYXRlZCBpbiAke2dlbmVyYXRpb25UaW1lfW1zYClcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc2VjdGlvbk5hbWU6IHNlY3Rpb24ubmFtZSxcclxuICAgICAgICBjb250ZW50LFxyXG4gICAgICAgIHRva2Vuc1VzZWQsXHJcbiAgICAgICAgZ2VuZXJhdGlvblN0cmF0ZWd5XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBGYWlsZWQgdG8gZ2VuZXJhdGUgc2VjdGlvbiAke3NlY3Rpb24ubmFtZX06YCwgZXJyb3IpXHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGdlbmVyYXRlICR7c2VjdGlvbi5uYW1lfSBzZWN0aW9uOiAke2Vycm9yLm1lc3NhZ2V9YClcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZSBzaGFyZWQgY29udGV4dCB3aXRoIGluZm9ybWF0aW9uIGZyb20gbmV3bHkgZ2VuZXJhdGVkIHNlY3Rpb25cclxuICAgKi9cclxuICB1cGRhdGVDb250ZXh0KFxyXG4gICAgY29udGV4dDogU2hhcmVkQ29udGV4dCxcclxuICAgIG5ld1NlY3Rpb246IEdlbmVyYXRlZFNlY3Rpb25cclxuICApOiBTaGFyZWRDb250ZXh0IHtcclxuICAgIGNvbnNvbGUubG9nKGDwn5SEIFVwZGF0aW5nIGNvbnRleHQgd2l0aCAke25ld1NlY3Rpb24uc2VjdGlvbk5hbWV9IHNlY3Rpb25gKVxyXG5cclxuICAgIGNvbnN0IHVwZGF0ZWRDb250ZXh0ID0geyAuLi5jb250ZXh0IH1cclxuXHJcbiAgICAvLyBVcGRhdGUgdm9jYWJ1bGFyeSBpZiBuZXcgd29yZHMgd2VyZSBpbnRyb2R1Y2VkXHJcbiAgICBpZiAobmV3U2VjdGlvbi5zZWN0aW9uTmFtZSA9PT0gJ3ZvY2FidWxhcnknICYmIEFycmF5LmlzQXJyYXkobmV3U2VjdGlvbi5jb250ZW50KSkge1xyXG4gICAgICBjb25zdCBuZXdXb3JkcyA9IG5ld1NlY3Rpb24uY29udGVudFxyXG4gICAgICAgIC5maWx0ZXIoaXRlbSA9PiBpdGVtLndvcmQgJiYgaXRlbS53b3JkICE9PSAnSU5TVFJVQ1RJT04nKVxyXG4gICAgICAgIC5tYXAoaXRlbSA9PiBpdGVtLndvcmQudG9Mb3dlckNhc2UoKSlcclxuICAgICAgXHJcbiAgICAgIHVwZGF0ZWRDb250ZXh0LmtleVZvY2FidWxhcnkgPSBbXHJcbiAgICAgICAgLi4ubmV3IFNldChbLi4udXBkYXRlZENvbnRleHQua2V5Vm9jYWJ1bGFyeSwgLi4ubmV3V29yZHNdKVxyXG4gICAgICBdXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXBkYXRlIHRoZW1lcyBpZiBuZXcgb25lcyB3ZXJlIGlkZW50aWZpZWRcclxuICAgIGlmIChuZXdTZWN0aW9uLnNlY3Rpb25OYW1lID09PSAncmVhZGluZycgJiYgdHlwZW9mIG5ld1NlY3Rpb24uY29udGVudCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgLy8gRXh0cmFjdCBhbnkgbmV3IHRoZW1lcyBmcm9tIHRoZSByZWFkaW5nIHBhc3NhZ2VcclxuICAgICAgY29uc3QgbmV3VGhlbWVzID0gdGhpcy5leHRyYWN0VGhlbWVzRnJvbVRleHQobmV3U2VjdGlvbi5jb250ZW50KVxyXG4gICAgICB1cGRhdGVkQ29udGV4dC5tYWluVGhlbWVzID0gW1xyXG4gICAgICAgIC4uLm5ldyBTZXQoWy4uLnVwZGF0ZWRDb250ZXh0Lm1haW5UaGVtZXMsIC4uLm5ld1RoZW1lc10pXHJcbiAgICAgIF1cclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZyhg4pyFIENvbnRleHQgdXBkYXRlZCBmb3IgJHtuZXdTZWN0aW9uLnNlY3Rpb25OYW1lfWApXHJcbiAgICByZXR1cm4gdXBkYXRlZENvbnRleHRcclxuICB9XHJcblxyXG4gIC8vIFByaXZhdGUgaGVscGVyIG1ldGhvZHMgZm9yIGV4dHJhY3Rpbmcgc2hhcmVkIGNvbnRleHRcclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBleHRyYWN0S2V5Vm9jYWJ1bGFyeShzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogQ0VGUkxldmVsKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gICAgY29uc3QgcHJvbXB0ID0gYEV4dHJhY3QgOC0xMiBrZXkgdm9jYWJ1bGFyeSB3b3JkcyBmcm9tIHRoaXMgdGV4dCBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsIHN0dWRlbnRzLiBSZXR1cm4gb25seSB0aGUgd29yZHMsIG9uZSBwZXIgbGluZTpcclxuXHJcbiR7c291cmNlVGV4dC5zdWJzdHJpbmcoMCwgNTAwKX1gXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcclxuICAgICAgY29uc3Qgd29yZHMgPSByZXNwb25zZS5zcGxpdCgnXFxuJylcclxuICAgICAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkudG9Mb3dlckNhc2UoKSlcclxuICAgICAgICAuZmlsdGVyKHdvcmQgPT4gd29yZC5sZW5ndGggPiAyICYmIHdvcmQubGVuZ3RoIDwgMjApXHJcbiAgICAgICAgLnNsaWNlKDAsIDEyKVxyXG5cclxuICAgICAgcmV0dXJuIHdvcmRzLmxlbmd0aCA+PSA2ID8gd29yZHMgOiB0aGlzLmV4dHJhY3RWb2NhYnVsYXJ5RmFsbGJhY2soc291cmNlVGV4dCwgc3R1ZGVudExldmVsKVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5sb2coXCLimqDvuI8gQUkgdm9jYWJ1bGFyeSBleHRyYWN0aW9uIGZhaWxlZCwgdXNpbmcgZmFsbGJhY2tcIilcclxuICAgICAgcmV0dXJuIHRoaXMuZXh0cmFjdFZvY2FidWxhcnlGYWxsYmFjayhzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGV4dHJhY3RNYWluVGhlbWVzKHNvdXJjZVRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBDRUZSTGV2ZWwpOiBQcm9taXNlPHN0cmluZ1tdPiB7XHJcbiAgICBjb25zdCBwcm9tcHQgPSBgSWRlbnRpZnkgMy01IG1haW4gdGhlbWVzIG9yIHRvcGljcyBpbiB0aGlzIHRleHQgZm9yICR7c3R1ZGVudExldmVsfSBsZXZlbCBzdHVkZW50cy4gUmV0dXJuIG9ubHkgdGhlIHRoZW1lcywgb25lIHBlciBsaW5lOlxyXG5cclxuJHtzb3VyY2VUZXh0LnN1YnN0cmluZygwLCA0MDApfWBcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQocHJvbXB0KVxyXG4gICAgICBjb25zdCB0aGVtZXMgPSByZXNwb25zZS5zcGxpdCgnXFxuJylcclxuICAgICAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkudG9Mb3dlckNhc2UoKSlcclxuICAgICAgICAuZmlsdGVyKHRoZW1lID0+IHRoZW1lLmxlbmd0aCA+IDMgJiYgdGhlbWUubGVuZ3RoIDwgNTApXHJcbiAgICAgICAgLnNsaWNlKDAsIDUpXHJcblxyXG4gICAgICByZXR1cm4gdGhlbWVzLmxlbmd0aCA+PSAyID8gdGhlbWVzIDogdGhpcy5leHRyYWN0VGhlbWVzRmFsbGJhY2soc291cmNlVGV4dClcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwi4pqg77iPIEFJIHRoZW1lIGV4dHJhY3Rpb24gZmFpbGVkLCB1c2luZyBmYWxsYmFja1wiKVxyXG4gICAgICByZXR1cm4gdGhpcy5leHRyYWN0VGhlbWVzRmFsbGJhY2soc291cmNlVGV4dClcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgY3JlYXRlQ29udGVudFN1bW1hcnkoc291cmNlVGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IENFRlJMZXZlbCk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgICBjb25zdCBwcm9tcHQgPSBgU3VtbWFyaXplIHRoaXMgdGV4dCBpbiAyLTMgc2VudGVuY2VzIGZvciAke3N0dWRlbnRMZXZlbH0gbGV2ZWwgc3R1ZGVudHM6XHJcblxyXG4ke3NvdXJjZVRleHQuc3Vic3RyaW5nKDAsIDYwMCl9YFxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQpXHJcbiAgICAgIHJldHVybiByZXNwb25zZS50cmltKCkuc3Vic3RyaW5nKDAsIDMwMClcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwi4pqg77iPIEFJIHN1bW1hcnkgZmFpbGVkLCB1c2luZyB0cnVuY2F0aW9uXCIpXHJcbiAgICAgIHJldHVybiBzb3VyY2VUZXh0LnN1YnN0cmluZygwLCAyMDApICsgXCIuLi5cIlxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gU2VjdGlvbiBnZW5lcmF0aW9uIG1ldGhvZHMgdXNpbmcgc2hhcmVkIGNvbnRleHRcclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVdhcm11cFdpdGhDb250ZXh0KFxyXG4gICAgY29udGV4dDogU2hhcmVkQ29udGV4dCxcclxuICAgIHByZXZpb3VzU2VjdGlvbnM6IEdlbmVyYXRlZFNlY3Rpb25bXVxyXG4gICk6IFByb21pc2U8c3RyaW5nW10+IHtcclxuICAgIGNvbnN0IG1haW5UaGVtZSA9IGNvbnRleHQubWFpblRoZW1lc1swXSB8fCAndGhpcyB0b3BpYydcclxuICAgIFxyXG4gICAgY29uc3QgcHJvbXB0ID0gYENyZWF0ZSAzICR7Y29udGV4dC5kaWZmaWN1bHR5TGV2ZWx9IHdhcm0tdXAgcXVlc3Rpb25zIGFib3V0ICR7bWFpblRoZW1lfS4gXHJcbkNvbnRleHQ6ICR7Y29udGV4dC5jb250ZW50U3VtbWFyeX1cclxuUmV0dXJuIG9ubHkgcXVlc3Rpb25zLCBvbmUgcGVyIGxpbmU6YFxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQpXHJcbiAgICAgIGNvbnN0IHF1ZXN0aW9ucyA9IHJlc3BvbnNlLnNwbGl0KCdcXG4nKVxyXG4gICAgICAgIC5tYXAobGluZSA9PiBsaW5lLnRyaW0oKSlcclxuICAgICAgICAuZmlsdGVyKGxpbmUgPT4gbGluZS5lbmRzV2l0aCgnPycpICYmIGxpbmUubGVuZ3RoID4gMTApXHJcbiAgICAgICAgLnNsaWNlKDAsIDMpXHJcblxyXG4gICAgICBpZiAocXVlc3Rpb25zLmxlbmd0aCA8IDMpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnN1ZmZpY2llbnQgcXVlc3Rpb25zIGdlbmVyYXRlZFwiKVxyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBpbnN0cnVjdGlvbiA9IFwiSGF2ZSB0aGUgZm9sbG93aW5nIGNvbnZlcnNhdGlvbnMgb3IgZGlzY3Vzc2lvbnMgd2l0aCB5b3VyIHR1dG9yIGJlZm9yZSByZWFkaW5nIHRoZSB0ZXh0OlwiXHJcbiAgICAgIHJldHVybiBbaW5zdHJ1Y3Rpb24sIC4uLnF1ZXN0aW9uc11cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBnZW5lcmF0ZSB3YXJtdXAgcXVlc3Rpb25zOiBcIiArIGVycm9yLm1lc3NhZ2UpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlVm9jYWJ1bGFyeVdpdGhDb250ZXh0KFxyXG4gICAgY29udGV4dDogU2hhcmVkQ29udGV4dCxcclxuICAgIHByZXZpb3VzU2VjdGlvbnM6IEdlbmVyYXRlZFNlY3Rpb25bXVxyXG4gICk6IFByb21pc2U8QXJyYXk8eyB3b3JkOiBzdHJpbmcsIG1lYW5pbmc6IHN0cmluZywgZXhhbXBsZTogc3RyaW5nIH0+PiB7XHJcbiAgICBjb25zdCB2b2NhYnVsYXJ5ID0gW11cclxuICAgIFxyXG4gICAgZm9yIChjb25zdCB3b3JkIG9mIGNvbnRleHQua2V5Vm9jYWJ1bGFyeS5zbGljZSgwLCA4KSkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRlZmluaXRpb25Qcm9tcHQgPSBgRGVmaW5lIFwiJHt3b3JkfVwiIHNpbXBseSBmb3IgJHtjb250ZXh0LmRpZmZpY3VsdHlMZXZlbH0gbGV2ZWwuIENvbnRleHQ6ICR7Y29udGV4dC5jb250ZW50U3VtbWFyeX0uIEdpdmUgb25seSB0aGUgZGVmaW5pdGlvbjpgXHJcbiAgICAgICAgY29uc3QgbWVhbmluZyA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQoZGVmaW5pdGlvblByb21wdClcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBleGFtcGxlUHJvbXB0ID0gYENyZWF0ZSBhIHNpbXBsZSBleGFtcGxlIHNlbnRlbmNlIHVzaW5nIFwiJHt3b3JkfVwiIGZvciAke2NvbnRleHQuZGlmZmljdWx0eUxldmVsfSBsZXZlbCBzdHVkZW50czpgXHJcbiAgICAgICAgY29uc3QgZXhhbXBsZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQoZXhhbXBsZVByb21wdClcclxuXHJcbiAgICAgICAgdm9jYWJ1bGFyeS5wdXNoKHtcclxuICAgICAgICAgIHdvcmQ6IHRoaXMuY2FwaXRhbGl6ZVdvcmQod29yZCksXHJcbiAgICAgICAgICBtZWFuaW5nOiBtZWFuaW5nLnRyaW0oKS5zdWJzdHJpbmcoMCwgMTUwKSxcclxuICAgICAgICAgIGV4YW1wbGU6IGV4YW1wbGUudHJpbSgpLnN1YnN0cmluZygwLCAxMDApXHJcbiAgICAgICAgfSlcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIEZhaWxlZCB0byBnZW5lcmF0ZSB2b2NhYnVsYXJ5IGZvciAke3dvcmR9YClcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGluc3RydWN0aW9uID0ge1xyXG4gICAgICB3b3JkOiBcIklOU1RSVUNUSU9OXCIsXHJcbiAgICAgIG1lYW5pbmc6IFwiU3R1ZHkgdGhlIGZvbGxvd2luZyB3b3JkcyB3aXRoIHlvdXIgdHV0b3IgYmVmb3JlIHJlYWRpbmcgdGhlIHRleHQ6XCIsXHJcbiAgICAgIGV4YW1wbGU6IFwiXCJcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gW2luc3RydWN0aW9uLCAuLi52b2NhYnVsYXJ5XVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVJlYWRpbmdXaXRoQ29udGV4dChcclxuICAgIGNvbnRleHQ6IFNoYXJlZENvbnRleHQsXHJcbiAgICBwcmV2aW91c1NlY3Rpb25zOiBHZW5lcmF0ZWRTZWN0aW9uW11cclxuICApOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gICAgLy8gVXNlIHZvY2FidWxhcnkgZnJvbSBwcmV2aW91cyBzZWN0aW9ucyBpZiBhdmFpbGFibGVcclxuICAgIGNvbnN0IHZvY2FidWxhcnlTZWN0aW9uID0gcHJldmlvdXNTZWN0aW9ucy5maW5kKHMgPT4gcy5zZWN0aW9uTmFtZSA9PT0gJ3ZvY2FidWxhcnknKVxyXG4gICAgY29uc3Qgdm9jYWJ1bGFyeVdvcmRzID0gdm9jYWJ1bGFyeVNlY3Rpb24gPyBcclxuICAgICAgdm9jYWJ1bGFyeVNlY3Rpb24uY29udGVudFxyXG4gICAgICAgIC5maWx0ZXIoKGl0ZW06IGFueSkgPT4gaXRlbS53b3JkICE9PSAnSU5TVFJVQ1RJT04nKVxyXG4gICAgICAgIC5tYXAoKGl0ZW06IGFueSkgPT4gaXRlbS53b3JkKVxyXG4gICAgICAgIC5zbGljZSgwLCA1KSA6IGNvbnRleHQua2V5Vm9jYWJ1bGFyeS5zbGljZSgwLCA1KVxyXG5cclxuICAgIGNvbnN0IHByb21wdCA9IGBSZXdyaXRlIHRoaXMgdGV4dCBmb3IgJHtjb250ZXh0LmRpZmZpY3VsdHlMZXZlbH0gbGV2ZWwgc3R1ZGVudHMuIFxyXG5Vc2UgdGhlc2Ugdm9jYWJ1bGFyeSB3b3JkczogJHt2b2NhYnVsYXJ5V29yZHMuam9pbignLCAnKX1cclxuS2VlcCBpdCAyMDAtNDAwIHdvcmRzOlxyXG5cclxuJHtjb250ZXh0LnNvdXJjZVRleHR9YFxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQpXHJcbiAgICAgIGNvbnN0IGluc3RydWN0aW9uID0gXCJSZWFkIHRoZSBmb2xsb3dpbmcgdGV4dCBjYXJlZnVsbHkuIFlvdXIgdHV0b3Igd2lsbCBoZWxwIHlvdSB3aXRoIGFueSBkaWZmaWN1bHQgd29yZHMgb3IgY29uY2VwdHM6XCJcclxuICAgICAgcmV0dXJuIGAke2luc3RydWN0aW9ufVxcblxcbiR7cmVzcG9uc2UudHJpbSgpfWBcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBnZW5lcmF0ZSByZWFkaW5nIHBhc3NhZ2U6IFwiICsgZXJyb3IubWVzc2FnZSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVDb21wcmVoZW5zaW9uV2l0aENvbnRleHQoXHJcbiAgICBjb250ZXh0OiBTaGFyZWRDb250ZXh0LFxyXG4gICAgcHJldmlvdXNTZWN0aW9uczogR2VuZXJhdGVkU2VjdGlvbltdXHJcbiAgKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gICAgY29uc3QgcHJvbXB0ID0gYENyZWF0ZSA1ICR7Y29udGV4dC5kaWZmaWN1bHR5TGV2ZWx9IGNvbXByZWhlbnNpb24gcXVlc3Rpb25zIGFib3V0IHRoaXMgY29udGVudDpcclxuJHtjb250ZXh0LmNvbnRlbnRTdW1tYXJ5fVxyXG5SZXR1cm4gb25seSBxdWVzdGlvbnMsIG9uZSBwZXIgbGluZTpgXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcclxuICAgICAgY29uc3QgcXVlc3Rpb25zID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpXHJcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKVxyXG4gICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLmVuZHNXaXRoKCc/JykgJiYgbGluZS5sZW5ndGggPiAxMClcclxuICAgICAgICAuc2xpY2UoMCwgNSlcclxuXHJcbiAgICAgIGlmIChxdWVzdGlvbnMubGVuZ3RoIDwgNSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluc3VmZmljaWVudCBjb21wcmVoZW5zaW9uIHF1ZXN0aW9ucyBnZW5lcmF0ZWRcIilcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgaW5zdHJ1Y3Rpb24gPSBcIkFmdGVyIHJlYWRpbmcgdGhlIHRleHQsIGFuc3dlciB0aGVzZSBjb21wcmVoZW5zaW9uIHF1ZXN0aW9uczpcIlxyXG4gICAgICByZXR1cm4gW2luc3RydWN0aW9uLCAuLi5xdWVzdGlvbnNdXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2VuZXJhdGUgY29tcHJlaGVuc2lvbiBxdWVzdGlvbnM6IFwiICsgZXJyb3IubWVzc2FnZSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVEaXNjdXNzaW9uV2l0aENvbnRleHQoXHJcbiAgICBjb250ZXh0OiBTaGFyZWRDb250ZXh0LFxyXG4gICAgcHJldmlvdXNTZWN0aW9uczogR2VuZXJhdGVkU2VjdGlvbltdXHJcbiAgKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gICAgY29uc3QgdGhlbWVzID0gY29udGV4dC5tYWluVGhlbWVzLnNsaWNlKDAsIDIpLmpvaW4oJyBhbmQgJylcclxuICAgIFxyXG4gICAgY29uc3QgcHJvbXB0ID0gYENyZWF0ZSAzICR7Y29udGV4dC5kaWZmaWN1bHR5TGV2ZWx9IGRpc2N1c3Npb24gcXVlc3Rpb25zIGFib3V0ICR7dGhlbWVzfS5cclxuQ29udGV4dDogJHtjb250ZXh0LmNvbnRlbnRTdW1tYXJ5fVxyXG5SZXR1cm4gb25seSBxdWVzdGlvbnMsIG9uZSBwZXIgbGluZTpgXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcclxuICAgICAgY29uc3QgcXVlc3Rpb25zID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpXHJcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKVxyXG4gICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLmVuZHNXaXRoKCc/JykgJiYgbGluZS5sZW5ndGggPiAxMClcclxuICAgICAgICAuc2xpY2UoMCwgMylcclxuXHJcbiAgICAgIGlmIChxdWVzdGlvbnMubGVuZ3RoIDwgMykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluc3VmZmljaWVudCBkaXNjdXNzaW9uIHF1ZXN0aW9ucyBnZW5lcmF0ZWRcIilcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgaW5zdHJ1Y3Rpb24gPSBcIkRpc2N1c3MgdGhlc2UgcXVlc3Rpb25zIHdpdGggeW91ciB0dXRvciB0byBleHBsb3JlIHRoZSB0b3BpYyBpbiBkZXB0aDpcIlxyXG4gICAgICByZXR1cm4gW2luc3RydWN0aW9uLCAuLi5xdWVzdGlvbnNdXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2VuZXJhdGUgZGlzY3Vzc2lvbiBxdWVzdGlvbnM6IFwiICsgZXJyb3IubWVzc2FnZSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVHcmFtbWFyV2l0aENvbnRleHQoXHJcbiAgICBjb250ZXh0OiBTaGFyZWRDb250ZXh0LFxyXG4gICAgcHJldmlvdXNTZWN0aW9uczogR2VuZXJhdGVkU2VjdGlvbltdXHJcbiAgKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIGNvbnN0IHByb21wdCA9IGBDcmVhdGUgYSBncmFtbWFyIGxlc3NvbiBmb3IgJHtjb250ZXh0LmRpZmZpY3VsdHlMZXZlbH0gbGV2ZWwgYmFzZWQgb24gdGhpcyBjb250ZW50OlxyXG4ke2NvbnRleHQuY29udGVudFN1bW1hcnl9XHJcblxyXG5SZXR1cm4gSlNPTiB3aXRoOiBmb2N1cyAoZ3JhbW1hciBwb2ludCksIGV4YW1wbGVzICgzIGV4YW1wbGVzKSwgZXhlcmNpc2UgKDMgcHJhY3RpY2Ugc2VudGVuY2VzKWBcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQocHJvbXB0KVxyXG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShyZXNwb25zZSlcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIC8vIEZhbGxiYWNrIGdyYW1tYXIgc3RydWN0dXJlXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgZm9jdXM6IFwiUHJlc2VudCBTaW1wbGUgVGVuc2VcIixcclxuICAgICAgICBleGFtcGxlczogW1xyXG4gICAgICAgICAgXCJJIHJlYWQgdGhlIG5ld3MgZXZlcnkgZGF5LlwiLFxyXG4gICAgICAgICAgXCJTaGUgd29ya3MgaW4gYW4gb2ZmaWNlLlwiLFxyXG4gICAgICAgICAgXCJUaGV5IHBsYXkgc3BvcnRzIG9uIHdlZWtlbmRzLlwiXHJcbiAgICAgICAgXSxcclxuICAgICAgICBleGVyY2lzZTogW1xyXG4gICAgICAgICAgXCJDb21wbGV0ZTogSGUgX19fX18gKHdvcmspIGluIExvbmRvbi5cIixcclxuICAgICAgICAgIFwiQ29tcGxldGU6IFdlIF9fX19fIChzdHVkeSkgRW5nbGlzaC5cIixcclxuICAgICAgICAgIFwiQ29tcGxldGU6IFNoZSBfX19fXyAobGlrZSkgY29mZmVlLlwiXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlUHJvbnVuY2lhdGlvbldpdGhDb250ZXh0KFxyXG4gICAgY29udGV4dDogU2hhcmVkQ29udGV4dCxcclxuICAgIHByZXZpb3VzU2VjdGlvbnM6IEdlbmVyYXRlZFNlY3Rpb25bXVxyXG4gICk6IFByb21pc2U8YW55PiB7XHJcbiAgICBjb25zdCB3b3JkID0gY29udGV4dC5rZXlWb2NhYnVsYXJ5WzBdIHx8ICdjb21tdW5pY2F0aW9uJ1xyXG4gICAgXHJcbiAgICBjb25zdCBwcm9tcHQgPSBgQ3JlYXRlIHByb251bmNpYXRpb24gcHJhY3RpY2UgZm9yIFwiJHt3b3JkfVwiLiBcclxuUmV0dXJuIEpTT04gd2l0aDogd29yZCwgaXBhIChwaG9uZXRpYyB0cmFuc2NyaXB0aW9uKSwgcHJhY3RpY2UgKHByb251bmNpYXRpb24gdGlwKWBcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQocHJvbXB0KVxyXG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShyZXNwb25zZSlcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIC8vIEZhbGxiYWNrIHByb251bmNpYXRpb24gc3RydWN0dXJlXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgd29yZDogd29yZCxcclxuICAgICAgICBpcGE6IGAva8mZy4xtanXLkG7JqsuIa2XJqsqDyZluL2AsXHJcbiAgICAgICAgcHJhY3RpY2U6IGBCcmVhayBpdCBkb3duOiBjb20tbXUtbmktY2EtdGlvbi4gU3RyZXNzIG9uIHRoZSA0dGggc3lsbGFibGU6IGNhLVRJT04uYFxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlV3JhcHVwV2l0aENvbnRleHQoXHJcbiAgICBjb250ZXh0OiBTaGFyZWRDb250ZXh0LFxyXG4gICAgcHJldmlvdXNTZWN0aW9uczogR2VuZXJhdGVkU2VjdGlvbltdXHJcbiAgKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gICAgY29uc3QgcHJvbXB0ID0gYENyZWF0ZSAzICR7Y29udGV4dC5kaWZmaWN1bHR5TGV2ZWx9IHdyYXAtdXAgcXVlc3Rpb25zIGFib3V0IHRoaXMgbGVzc29uOlxyXG4ke2NvbnRleHQuY29udGVudFN1bW1hcnl9XHJcblJldHVybiBvbmx5IHF1ZXN0aW9ucywgb25lIHBlciBsaW5lOmBcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQocHJvbXB0KVxyXG4gICAgICBjb25zdCBxdWVzdGlvbnMgPSByZXNwb25zZS5zcGxpdCgnXFxuJylcclxuICAgICAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkpXHJcbiAgICAgICAgLmZpbHRlcihsaW5lID0+IGxpbmUuZW5kc1dpdGgoJz8nKSAmJiBsaW5lLmxlbmd0aCA+IDEwKVxyXG4gICAgICAgIC5zbGljZSgwLCAzKVxyXG5cclxuICAgICAgaWYgKHF1ZXN0aW9ucy5sZW5ndGggPCAzKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5zdWZmaWNpZW50IHdyYXB1cCBxdWVzdGlvbnMgZ2VuZXJhdGVkXCIpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGluc3RydWN0aW9uID0gXCJSZWZsZWN0IG9uIHlvdXIgbGVhcm5pbmcgYnkgZGlzY3Vzc2luZyB0aGVzZSB3cmFwLXVwIHF1ZXN0aW9uczpcIlxyXG4gICAgICByZXR1cm4gW2luc3RydWN0aW9uLCAuLi5xdWVzdGlvbnNdXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2VuZXJhdGUgd3JhcHVwIHF1ZXN0aW9uczogXCIgKyBlcnJvci5tZXNzYWdlKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gRmFsbGJhY2sgbWV0aG9kcyBmb3Igd2hlbiBBSSBleHRyYWN0aW9uIGZhaWxzXHJcblxyXG4gIHByaXZhdGUgZXh0cmFjdFZvY2FidWxhcnlGYWxsYmFjayhzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogQ0VGUkxldmVsKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3Qgd29yZHMgPSBzb3VyY2VUZXh0LnRvTG93ZXJDYXNlKClcclxuICAgICAgLm1hdGNoKC9cXGJbYS16XXs0LDEyfVxcYi9nKSB8fCBbXVxyXG4gICAgXHJcbiAgICBjb25zdCBjb21tb25Xb3JkcyA9IFsndGhlJywgJ2FuZCcsICd0aGF0JywgJ2hhdmUnLCAnZm9yJywgJ25vdCcsICd3aXRoJywgJ3lvdScsICd0aGlzJywgJ2J1dCcsICdoaXMnLCAnZnJvbScsICd0aGV5J11cclxuICAgIGNvbnN0IGZpbHRlcmVkV29yZHMgPSB3b3Jkc1xyXG4gICAgICAuZmlsdGVyKHdvcmQgPT4gIWNvbW1vbldvcmRzLmluY2x1ZGVzKHdvcmQpKVxyXG4gICAgICAuZmlsdGVyKCh3b3JkLCBpbmRleCwgYXJyKSA9PiBhcnIuaW5kZXhPZih3b3JkKSA9PT0gaW5kZXgpXHJcbiAgICAgIC5zbGljZSgwLCA4KVxyXG5cclxuICAgIHJldHVybiBmaWx0ZXJlZFdvcmRzLmxlbmd0aCA+PSA0ID8gZmlsdGVyZWRXb3JkcyA6IFsnY29tbXVuaWNhdGlvbicsICdpbXBvcnRhbnQnLCAnZGlmZmVyZW50JywgJ2V4YW1wbGUnLCAnaW5mb3JtYXRpb24nLCAnc2l0dWF0aW9uJ11cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZXh0cmFjdFRoZW1lc0ZhbGxiYWNrKHNvdXJjZVRleHQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IHRleHQgPSBzb3VyY2VUZXh0LnRvTG93ZXJDYXNlKClcclxuICAgIGNvbnN0IHRoZW1lcyA9IFtdXHJcblxyXG4gICAgLy8gTG9vayBmb3IgY29tbW9uIHRoZW1lc1xyXG4gICAgaWYgKHRleHQuaW5jbHVkZXMoJ3Nwb3J0JykgfHwgdGV4dC5pbmNsdWRlcygnZ2FtZScpIHx8IHRleHQuaW5jbHVkZXMoJ3RlYW0nKSkgdGhlbWVzLnB1c2goJ3Nwb3J0cycpXHJcbiAgICBpZiAodGV4dC5pbmNsdWRlcygnYnVzaW5lc3MnKSB8fCB0ZXh0LmluY2x1ZGVzKCdjb21wYW55JykgfHwgdGV4dC5pbmNsdWRlcygnd29yaycpKSB0aGVtZXMucHVzaCgnYnVzaW5lc3MnKVxyXG4gICAgaWYgKHRleHQuaW5jbHVkZXMoJ3RyYXZlbCcpIHx8IHRleHQuaW5jbHVkZXMoJ2NvdW50cnknKSB8fCB0ZXh0LmluY2x1ZGVzKCdjdWx0dXJlJykpIHRoZW1lcy5wdXNoKCd0cmF2ZWwnKVxyXG4gICAgaWYgKHRleHQuaW5jbHVkZXMoJ3RlY2hub2xvZ3knKSB8fCB0ZXh0LmluY2x1ZGVzKCdjb21wdXRlcicpIHx8IHRleHQuaW5jbHVkZXMoJ2ludGVybmV0JykpIHRoZW1lcy5wdXNoKCd0ZWNobm9sb2d5JylcclxuICAgIGlmICh0ZXh0LmluY2x1ZGVzKCdoZWFsdGgnKSB8fCB0ZXh0LmluY2x1ZGVzKCdtZWRpY2FsJykgfHwgdGV4dC5pbmNsdWRlcygnZG9jdG9yJykpIHRoZW1lcy5wdXNoKCdoZWFsdGgnKVxyXG5cclxuICAgIHJldHVybiB0aGVtZXMubGVuZ3RoID4gMCA/IHRoZW1lcyA6IFsnZ2VuZXJhbCB0b3BpYycsICdjb21tdW5pY2F0aW9uJywgJ2RhaWx5IGxpZmUnXVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBleHRyYWN0VGhlbWVzRnJvbVRleHQodGV4dDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgcmV0dXJuIHRoaXMuZXh0cmFjdFRoZW1lc0ZhbGxiYWNrKHRleHQpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNhcGl0YWxpemVXb3JkKHdvcmQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gd29yZC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHdvcmQuc2xpY2UoMSkudG9Mb3dlckNhc2UoKVxyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJjcmVhdGVHb29nbGVBSVNlcnZlclNlcnZpY2UiLCJQcm9ncmVzc2l2ZUdlbmVyYXRvckltcGwiLCJnZXRHb29nbGVBSSIsImdvb2dsZUFJIiwiYnVpbGRTaGFyZWRDb250ZXh0Iiwic291cmNlVGV4dCIsImxlc3NvblR5cGUiLCJzdHVkZW50TGV2ZWwiLCJ0YXJnZXRMYW5ndWFnZSIsImNvbnNvbGUiLCJsb2ciLCJrZXlWb2NhYnVsYXJ5IiwiZXh0cmFjdEtleVZvY2FidWxhcnkiLCJtYWluVGhlbWVzIiwiZXh0cmFjdE1haW5UaGVtZXMiLCJjb250ZW50U3VtbWFyeSIsImNyZWF0ZUNvbnRlbnRTdW1tYXJ5Iiwic2hhcmVkQ29udGV4dCIsImRpZmZpY3VsdHlMZXZlbCIsInN1YnN0cmluZyIsInZvY2FidWxhcnlDb3VudCIsImxlbmd0aCIsInRoZW1lc0NvdW50Iiwic3VtbWFyeUxlbmd0aCIsImVycm9yIiwiRXJyb3IiLCJtZXNzYWdlIiwiZ2VuZXJhdGVTZWN0aW9uIiwic2VjdGlvbiIsInByZXZpb3VzU2VjdGlvbnMiLCJuYW1lIiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsImNvbnRlbnQiLCJ0b2tlbnNVc2VkIiwiZ2VuZXJhdGlvblN0cmF0ZWd5IiwiZ2VuZXJhdGVXYXJtdXBXaXRoQ29udGV4dCIsImdlbmVyYXRlVm9jYWJ1bGFyeVdpdGhDb250ZXh0IiwiZ2VuZXJhdGVSZWFkaW5nV2l0aENvbnRleHQiLCJnZW5lcmF0ZUNvbXByZWhlbnNpb25XaXRoQ29udGV4dCIsImdlbmVyYXRlRGlzY3Vzc2lvbldpdGhDb250ZXh0IiwiZ2VuZXJhdGVHcmFtbWFyV2l0aENvbnRleHQiLCJnZW5lcmF0ZVByb251bmNpYXRpb25XaXRoQ29udGV4dCIsImdlbmVyYXRlV3JhcHVwV2l0aENvbnRleHQiLCJnZW5lcmF0aW9uVGltZSIsInNlY3Rpb25OYW1lIiwidXBkYXRlQ29udGV4dCIsImNvbnRleHQiLCJuZXdTZWN0aW9uIiwidXBkYXRlZENvbnRleHQiLCJBcnJheSIsImlzQXJyYXkiLCJuZXdXb3JkcyIsImZpbHRlciIsIml0ZW0iLCJ3b3JkIiwibWFwIiwidG9Mb3dlckNhc2UiLCJTZXQiLCJuZXdUaGVtZXMiLCJleHRyYWN0VGhlbWVzRnJvbVRleHQiLCJwcm9tcHQiLCJyZXNwb25zZSIsIndvcmRzIiwic3BsaXQiLCJsaW5lIiwidHJpbSIsInNsaWNlIiwiZXh0cmFjdFZvY2FidWxhcnlGYWxsYmFjayIsInRoZW1lcyIsInRoZW1lIiwiZXh0cmFjdFRoZW1lc0ZhbGxiYWNrIiwibWFpblRoZW1lIiwicXVlc3Rpb25zIiwiZW5kc1dpdGgiLCJpbnN0cnVjdGlvbiIsInZvY2FidWxhcnkiLCJkZWZpbml0aW9uUHJvbXB0IiwibWVhbmluZyIsImV4YW1wbGVQcm9tcHQiLCJleGFtcGxlIiwicHVzaCIsImNhcGl0YWxpemVXb3JkIiwidm9jYWJ1bGFyeVNlY3Rpb24iLCJmaW5kIiwicyIsInZvY2FidWxhcnlXb3JkcyIsImpvaW4iLCJKU09OIiwicGFyc2UiLCJmb2N1cyIsImV4YW1wbGVzIiwiZXhlcmNpc2UiLCJpcGEiLCJwcmFjdGljZSIsIm1hdGNoIiwiY29tbW9uV29yZHMiLCJmaWx0ZXJlZFdvcmRzIiwiaW5jbHVkZXMiLCJpbmRleCIsImFyciIsImluZGV4T2YiLCJ0ZXh0IiwiY2hhckF0IiwidG9VcHBlckNhc2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/progressive-generator.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase-server.ts":
/*!********************************!*\
  !*** ./lib/supabase-server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createServerSupabaseClient: () => (/* binding */ createServerSupabaseClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n\n\nconst createServerSupabaseClient = ()=>{\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createServerClient)(\"https://jbkpnirowdvlwlgheqho.supabase.co\" || 0, \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impia3BuaXJvd2R2bHdsZ2hlcWhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5MTQ3NTEsImV4cCI6MjA3NDQ5MDc1MX0.FZhruXKDzIkZLhla5oerfs7yzjvTsGLlKTUer34N6N0\" || 0, {\n        cookies: {\n            get (name) {\n                return cookieStore.get(name)?.value;\n            },\n            set (name, value, options) {\n                cookieStore.set({\n                    name,\n                    value,\n                    ...options\n                });\n            },\n            remove (name, options) {\n                cookieStore.set({\n                    name,\n                    value: \"\",\n                    ...options\n                });\n            }\n        }\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Utc2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFrRDtBQUNaO0FBRS9CLE1BQU1FLDZCQUE2QjtJQUN4QyxNQUFNQyxjQUFjRixxREFBT0E7SUFFM0IsT0FBT0QsaUVBQWtCQSxDQUN2QkksMENBQW9DLElBQUksR0FDeENBLGtOQUF5QyxJQUFJLEdBQzdDO1FBQ0FILFNBQVM7WUFDUE8sS0FBSUMsSUFBWTtnQkFDZCxPQUFPTixZQUFZSyxHQUFHLENBQUNDLE9BQU9DO1lBQ2hDO1lBQ0FDLEtBQUlGLElBQVksRUFBRUMsS0FBYSxFQUFFRSxPQUFZO2dCQUMzQ1QsWUFBWVEsR0FBRyxDQUFDO29CQUFFRjtvQkFBTUM7b0JBQU8sR0FBR0UsT0FBTztnQkFBQztZQUM1QztZQUNBQyxRQUFPSixJQUFZLEVBQUVHLE9BQVk7Z0JBQy9CVCxZQUFZUSxHQUFHLENBQUM7b0JBQUVGO29CQUFNQyxPQUFPO29CQUFJLEdBQUdFLE9BQU87Z0JBQUM7WUFDaEQ7UUFDRjtJQUNGO0FBQ0YsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvLi9saWIvc3VwYWJhc2Utc2VydmVyLnRzPzA5NGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50IH0gZnJvbSBcIkBzdXBhYmFzZS9zc3JcIlxuaW1wb3J0IHsgY29va2llcyB9IGZyb20gXCJuZXh0L2hlYWRlcnNcIlxuXG5leHBvcnQgY29uc3QgY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQgPSAoKSA9PiB7XG4gIGNvbnN0IGNvb2tpZVN0b3JlID0gY29va2llcygpXG5cbiAgcmV0dXJuIGNyZWF0ZVNlcnZlckNsaWVudChcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgfHwgJ2h0dHBzOi8vcGxhY2Vob2xkZXIuc3VwYWJhc2UuY28nLCBcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSB8fCAncGxhY2Vob2xkZXIta2V5JywgXG4gICAge1xuICAgIGNvb2tpZXM6IHtcbiAgICAgIGdldChuYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIGNvb2tpZVN0b3JlLmdldChuYW1lKT8udmFsdWVcbiAgICAgIH0sXG4gICAgICBzZXQobmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBvcHRpb25zOiBhbnkpIHtcbiAgICAgICAgY29va2llU3RvcmUuc2V0KHsgbmFtZSwgdmFsdWUsIC4uLm9wdGlvbnMgfSlcbiAgICAgIH0sXG4gICAgICByZW1vdmUobmFtZTogc3RyaW5nLCBvcHRpb25zOiBhbnkpIHtcbiAgICAgICAgY29va2llU3RvcmUuc2V0KHsgbmFtZSwgdmFsdWU6IFwiXCIsIC4uLm9wdGlvbnMgfSlcbiAgICAgIH0sXG4gICAgfSxcbiAgfSlcbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVTZXJ2ZXJDbGllbnQiLCJjb29raWVzIiwiY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQiLCJjb29raWVTdG9yZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImdldCIsIm5hbWUiLCJ2YWx1ZSIsInNldCIsIm9wdGlvbnMiLCJyZW1vdmUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase-server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/usage-monitor.ts":
/*!******************************!*\
  !*** ./lib/usage-monitor.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   InMemoryUsageMonitor: () => (/* binding */ InMemoryUsageMonitor),\n/* harmony export */   usageMonitor: () => (/* binding */ usageMonitor)\n/* harmony export */ });\n/**\r\n * Usage Monitor System\r\n * \r\n * Provides comprehensive logging and monitoring for AI lesson generation,\r\n * tracking token usage, errors, and optimization savings.\r\n */ /**\r\n * In-Memory Usage Monitor Implementation\r\n * \r\n * Stores usage data in memory with optional persistence to console/external systems.\r\n * In production, this could be extended to use a database or external logging service.\r\n */ class InMemoryUsageMonitor {\n    /**\r\n   * Generate unique ID for log entries\r\n   */ generateId() {\n        return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n    }\n    /**\r\n   * Log token usage for a lesson section\r\n   */ logTokenUsage(section, tokens, optimization, context) {\n        const entry = {\n            id: this.generateId(),\n            timestamp: new Date(),\n            section,\n            tokens,\n            optimization,\n            userId: context?.userId,\n            lessonId: context?.lessonId\n        };\n        this.usageLogs.push(entry);\n        this.trimLogs();\n        // Console logging for development\n        console.log(`[UsageMonitor] Token usage - Section: ${section}, Tokens: ${tokens}, Optimization: ${optimization}`);\n    }\n    /**\r\n   * Log errors with context\r\n   */ logError(error, errorType, context) {\n        const entry = {\n            id: this.generateId(),\n            timestamp: new Date(),\n            errorType,\n            errorMessage: error.message,\n            context: {\n                lessonType: context.lessonType,\n                difficultyLevel: context.difficultyLevel,\n                contentLength: context.contentLength,\n                timestamp: context.timestamp\n            },\n            userId: context.userId,\n            lessonId: context.lessonId,\n            stackTrace: error.stack\n        };\n        this.errorLogs.push(entry);\n        this.trimLogs();\n        // Console logging for development\n        console.error(`[UsageMonitor] Error - Type: ${errorType}, Message: ${error.message}`, {\n            context,\n            errorId: entry.id\n        });\n    }\n    /**\r\n   * Log optimization savings\r\n   */ logOptimizationSavings(baseline, optimized, strategy, context) {\n        const savings = baseline - optimized;\n        const savingsPercentage = baseline > 0 ? savings / baseline * 100 : 0;\n        const entry = {\n            id: this.generateId(),\n            timestamp: new Date(),\n            strategy,\n            baselineTokens: baseline,\n            optimizedTokens: optimized,\n            savingsPercentage,\n            userId: context?.userId,\n            lessonId: context?.lessonId\n        };\n        this.optimizationLogs.push(entry);\n        this.trimLogs();\n        // Console logging for development\n        console.log(`[UsageMonitor] Optimization - Strategy: ${strategy}, Savings: ${savings} tokens (${savingsPercentage.toFixed(1)}%)`);\n    }\n    /**\r\n   * Generate comprehensive usage report\r\n   */ async generateUsageReport(startDate, endDate) {\n        const start = startDate || new Date(Date.now() - 30 * 24 * 60 * 60 * 1000); // Default: 30 days ago\n        const end = endDate || new Date();\n        // Filter logs by date range\n        const filteredUsageLogs = this.usageLogs.filter((log)=>log.timestamp >= start && log.timestamp <= end);\n        const filteredErrorLogs = this.errorLogs.filter((log)=>log.timestamp >= start && log.timestamp <= end);\n        const filteredOptimizationLogs = this.optimizationLogs.filter((log)=>log.timestamp >= start && log.timestamp <= end);\n        // Calculate metrics\n        const uniqueLessons = new Set(filteredUsageLogs.map((log)=>log.lessonId).filter(Boolean));\n        const totalLessons = uniqueLessons.size;\n        const totalTokens = filteredUsageLogs.reduce((sum, log)=>sum + log.tokens, 0);\n        const averageTokensPerLesson = totalLessons > 0 ? totalTokens / totalLessons : 0;\n        const totalOptimizationSavings = filteredOptimizationLogs.reduce((sum, log)=>sum + (log.baselineTokens - log.optimizedTokens), 0);\n        const errorRate = totalLessons > 0 ? filteredErrorLogs.length / totalLessons * 100 : 0;\n        // Top optimization strategies\n        const strategyStats = new Map();\n        filteredOptimizationLogs.forEach((log)=>{\n            const current = strategyStats.get(log.strategy) || {\n                usage: 0,\n                totalSavings: 0\n            };\n            current.usage++;\n            current.totalSavings += log.baselineTokens - log.optimizedTokens;\n            strategyStats.set(log.strategy, current);\n        });\n        const topOptimizationStrategies = Array.from(strategyStats.entries()).map(([strategy, stats])=>({\n                strategy,\n                usage: stats.usage,\n                averageSavings: stats.usage > 0 ? stats.totalSavings / stats.usage : 0\n            })).sort((a, b)=>b.usage - a.usage).slice(0, 5);\n        // Error breakdown\n        const errorBreakdown = {};\n        filteredErrorLogs.forEach((log)=>{\n            errorBreakdown[log.errorType] = (errorBreakdown[log.errorType] || 0) + 1;\n        });\n        // Section token breakdown\n        const sectionTokenBreakdown = {};\n        filteredUsageLogs.forEach((log)=>{\n            sectionTokenBreakdown[log.section] = (sectionTokenBreakdown[log.section] || 0) + log.tokens;\n        });\n        return {\n            period: {\n                start,\n                end\n            },\n            totalLessons,\n            totalTokens,\n            averageTokensPerLesson,\n            totalOptimizationSavings,\n            errorRate,\n            topOptimizationStrategies,\n            errorBreakdown,\n            sectionTokenBreakdown\n        };\n    }\n    /**\r\n   * Get usage metrics for a specific lesson\r\n   */ async getLessonMetrics(lessonId) {\n        const lessonLogs = this.usageLogs.filter((log)=>log.lessonId === lessonId);\n        if (lessonLogs.length === 0) {\n            return null;\n        }\n        const totalTokens = lessonLogs.reduce((sum, log)=>sum + log.tokens, 0);\n        const tokensPerSection = {};\n        lessonLogs.forEach((log)=>{\n            tokensPerSection[log.section] = (tokensPerSection[log.section] || 0) + log.tokens;\n        });\n        // Calculate optimization savings for this lesson\n        const lessonOptimizationLogs = this.optimizationLogs.filter((log)=>log.lessonId === lessonId);\n        const optimizationSavings = lessonOptimizationLogs.reduce((sum, log)=>sum + (log.baselineTokens - log.optimizedTokens), 0);\n        // Calculate generation time (time between first and last log entry)\n        const timestamps = lessonLogs.map((log)=>log.timestamp.getTime()).sort();\n        const generationTime = timestamps.length > 1 ? timestamps[timestamps.length - 1] - timestamps[0] : 0;\n        return {\n            totalTokens,\n            tokensPerSection,\n            optimizationSavings,\n            generationTime,\n            timestamp: new Date(timestamps[0])\n        };\n    }\n    /**\r\n   * Clear old logs to prevent memory overflow\r\n   */ async clearOldLogs(olderThanDays) {\n        const cutoffDate = new Date(Date.now() - olderThanDays * 24 * 60 * 60 * 1000);\n        const initialUsageCount = this.usageLogs.length;\n        const initialErrorCount = this.errorLogs.length;\n        const initialOptimizationCount = this.optimizationLogs.length;\n        this.usageLogs = this.usageLogs.filter((log)=>log.timestamp >= cutoffDate);\n        this.errorLogs = this.errorLogs.filter((log)=>log.timestamp >= cutoffDate);\n        this.optimizationLogs = this.optimizationLogs.filter((log)=>log.timestamp >= cutoffDate);\n        const clearedUsage = initialUsageCount - this.usageLogs.length;\n        const clearedErrors = initialErrorCount - this.errorLogs.length;\n        const clearedOptimizations = initialOptimizationCount - this.optimizationLogs.length;\n        console.log(`[UsageMonitor] Cleared old logs: ${clearedUsage} usage, ${clearedErrors} errors, ${clearedOptimizations} optimizations`);\n    }\n    /**\r\n   * Trim logs to prevent memory overflow\r\n   */ trimLogs() {\n        if (this.usageLogs.length > this.maxLogEntries) {\n            this.usageLogs = this.usageLogs.slice(-this.maxLogEntries);\n        }\n        if (this.errorLogs.length > this.maxLogEntries) {\n            this.errorLogs = this.errorLogs.slice(-this.maxLogEntries);\n        }\n        if (this.optimizationLogs.length > this.maxLogEntries) {\n            this.optimizationLogs = this.optimizationLogs.slice(-this.maxLogEntries);\n        }\n    }\n    /**\r\n   * Get current log counts (for debugging)\r\n   */ getLogCounts() {\n        return {\n            usage: this.usageLogs.length,\n            errors: this.errorLogs.length,\n            optimizations: this.optimizationLogs.length\n        };\n    }\n    /**\r\n   * Export logs for external analysis\r\n   */ exportLogs() {\n        return {\n            usage: [\n                ...this.usageLogs\n            ],\n            errors: [\n                ...this.errorLogs\n            ],\n            optimizations: [\n                ...this.optimizationLogs\n            ]\n        };\n    }\n    constructor(){\n        this.usageLogs = [];\n        this.errorLogs = [];\n        this.optimizationLogs = [];\n        this.maxLogEntries = 10000 // Prevent memory overflow\n        ;\n    }\n}\n// Singleton instance for global usage monitoring\nconst usageMonitor = new InMemoryUsageMonitor();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cyI6WyJ3ZWJwYWNrOi8vbXktdjAtcHJvamVjdC8uL2xpYi91c2FnZS1tb25pdG9yLnRzPzMxNTMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFVzYWdlIE1vbml0b3IgU3lzdGVtXHJcbiAqIFxyXG4gKiBQcm92aWRlcyBjb21wcmVoZW5zaXZlIGxvZ2dpbmcgYW5kIG1vbml0b3JpbmcgZm9yIEFJIGxlc3NvbiBnZW5lcmF0aW9uLFxyXG4gKiB0cmFja2luZyB0b2tlbiB1c2FnZSwgZXJyb3JzLCBhbmQgb3B0aW1pemF0aW9uIHNhdmluZ3MuXHJcbiAqL1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBVc2FnZU1ldHJpY3Mge1xyXG4gIHRvdGFsVG9rZW5zOiBudW1iZXI7XHJcbiAgdG9rZW5zUGVyU2VjdGlvbjogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcclxuICBvcHRpbWl6YXRpb25TYXZpbmdzOiBudW1iZXI7XHJcbiAgZ2VuZXJhdGlvblRpbWU6IG51bWJlcjtcclxuICB0aW1lc3RhbXA6IERhdGU7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVXNhZ2VMb2dFbnRyeSB7XHJcbiAgaWQ6IHN0cmluZztcclxuICB0aW1lc3RhbXA6IERhdGU7XHJcbiAgc2VjdGlvbjogc3RyaW5nO1xyXG4gIHRva2VuczogbnVtYmVyO1xyXG4gIG9wdGltaXphdGlvbjogc3RyaW5nO1xyXG4gIHVzZXJJZD86IHN0cmluZztcclxuICBsZXNzb25JZD86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBFcnJvckxvZ0VudHJ5IHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHRpbWVzdGFtcDogRGF0ZTtcclxuICBlcnJvclR5cGU6IHN0cmluZztcclxuICBlcnJvck1lc3NhZ2U6IHN0cmluZztcclxuICBjb250ZXh0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xyXG4gIHVzZXJJZD86IHN0cmluZztcclxuICBsZXNzb25JZD86IHN0cmluZztcclxuICBzdGFja1RyYWNlPzogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIE9wdGltaXphdGlvbkxvZ0VudHJ5IHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHRpbWVzdGFtcDogRGF0ZTtcclxuICBzdHJhdGVneTogc3RyaW5nO1xyXG4gIGJhc2VsaW5lVG9rZW5zOiBudW1iZXI7XHJcbiAgb3B0aW1pemVkVG9rZW5zOiBudW1iZXI7XHJcbiAgc2F2aW5nc1BlcmNlbnRhZ2U6IG51bWJlcjtcclxuICB1c2VySWQ/OiBzdHJpbmc7XHJcbiAgbGVzc29uSWQ/OiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVXNhZ2VSZXBvcnQge1xyXG4gIHBlcmlvZDoge1xyXG4gICAgc3RhcnQ6IERhdGU7XHJcbiAgICBlbmQ6IERhdGU7XHJcbiAgfTtcclxuICB0b3RhbExlc3NvbnM6IG51bWJlcjtcclxuICB0b3RhbFRva2VuczogbnVtYmVyO1xyXG4gIGF2ZXJhZ2VUb2tlbnNQZXJMZXNzb246IG51bWJlcjtcclxuICB0b3RhbE9wdGltaXphdGlvblNhdmluZ3M6IG51bWJlcjtcclxuICBlcnJvclJhdGU6IG51bWJlcjtcclxuICB0b3BPcHRpbWl6YXRpb25TdHJhdGVnaWVzOiBBcnJheTx7XHJcbiAgICBzdHJhdGVneTogc3RyaW5nO1xyXG4gICAgdXNhZ2U6IG51bWJlcjtcclxuICAgIGF2ZXJhZ2VTYXZpbmdzOiBudW1iZXI7XHJcbiAgfT47XHJcbiAgZXJyb3JCcmVha2Rvd246IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XHJcbiAgc2VjdGlvblRva2VuQnJlYWtkb3duOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEdlbmVyYXRpb25Db250ZXh0IHtcclxuICB1c2VySWQ/OiBzdHJpbmc7XHJcbiAgbGVzc29uSWQ/OiBzdHJpbmc7XHJcbiAgbGVzc29uVHlwZT86IHN0cmluZztcclxuICBkaWZmaWN1bHR5TGV2ZWw/OiBzdHJpbmc7XHJcbiAgY29udGVudExlbmd0aD86IG51bWJlcjtcclxuICB0aW1lc3RhbXA6IERhdGU7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVc2FnZSBNb25pdG9yIEludGVyZmFjZVxyXG4gKiBcclxuICogRGVmaW5lcyB0aGUgY29udHJhY3QgZm9yIG1vbml0b3JpbmcgQUkgdXNhZ2UsIGVycm9ycywgYW5kIG9wdGltaXphdGlvbnNcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgVXNhZ2VNb25pdG9yIHtcclxuICAvKipcclxuICAgKiBMb2cgdG9rZW4gdXNhZ2UgZm9yIGEgc3BlY2lmaWMgbGVzc29uIHNlY3Rpb25cclxuICAgKi9cclxuICBsb2dUb2tlblVzYWdlKFxyXG4gICAgc2VjdGlvbjogc3RyaW5nLCBcclxuICAgIHRva2VuczogbnVtYmVyLCBcclxuICAgIG9wdGltaXphdGlvbjogc3RyaW5nLCBcclxuICAgIGNvbnRleHQ/OiBHZW5lcmF0aW9uQ29udGV4dFxyXG4gICk6IHZvaWQ7XHJcblxyXG4gIC8qKlxyXG4gICAqIExvZyBlcnJvcnMgd2l0aCBzcGVjaWZpYyBjb250ZXh0IGZvciBkZWJ1Z2dpbmdcclxuICAgKi9cclxuICBsb2dFcnJvcihcclxuICAgIGVycm9yOiBFcnJvciwgXHJcbiAgICBlcnJvclR5cGU6IHN0cmluZywgXHJcbiAgICBjb250ZXh0OiBHZW5lcmF0aW9uQ29udGV4dFxyXG4gICk6IHZvaWQ7XHJcblxyXG4gIC8qKlxyXG4gICAqIFRyYWNrIG9wdGltaXphdGlvbiBzYXZpbmdzIGFjaGlldmVkXHJcbiAgICovXHJcbiAgbG9nT3B0aW1pemF0aW9uU2F2aW5ncyhcclxuICAgIGJhc2VsaW5lOiBudW1iZXIsIFxyXG4gICAgb3B0aW1pemVkOiBudW1iZXIsIFxyXG4gICAgc3RyYXRlZ3k6IHN0cmluZywgXHJcbiAgICBjb250ZXh0PzogR2VuZXJhdGlvbkNvbnRleHRcclxuICApOiB2b2lkO1xyXG5cclxuICAvKipcclxuICAgKiBHZW5lcmF0ZSBjb21wcmVoZW5zaXZlIHVzYWdlIHJlcG9ydFxyXG4gICAqL1xyXG4gIGdlbmVyYXRlVXNhZ2VSZXBvcnQoc3RhcnREYXRlPzogRGF0ZSwgZW5kRGF0ZT86IERhdGUpOiBQcm9taXNlPFVzYWdlUmVwb3J0PjtcclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHVzYWdlIG1ldHJpY3MgZm9yIGEgc3BlY2lmaWMgbGVzc29uXHJcbiAgICovXHJcbiAgZ2V0TGVzc29uTWV0cmljcyhsZXNzb25JZDogc3RyaW5nKTogUHJvbWlzZTxVc2FnZU1ldHJpY3MgfCBudWxsPjtcclxuXHJcbiAgLyoqXHJcbiAgICogQ2xlYXIgb2xkIGxvZ3MgKGZvciBtYWludGVuYW5jZSlcclxuICAgKi9cclxuICBjbGVhck9sZExvZ3Mob2xkZXJUaGFuRGF5czogbnVtYmVyKTogUHJvbWlzZTx2b2lkPjtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluLU1lbW9yeSBVc2FnZSBNb25pdG9yIEltcGxlbWVudGF0aW9uXHJcbiAqIFxyXG4gKiBTdG9yZXMgdXNhZ2UgZGF0YSBpbiBtZW1vcnkgd2l0aCBvcHRpb25hbCBwZXJzaXN0ZW5jZSB0byBjb25zb2xlL2V4dGVybmFsIHN5c3RlbXMuXHJcbiAqIEluIHByb2R1Y3Rpb24sIHRoaXMgY291bGQgYmUgZXh0ZW5kZWQgdG8gdXNlIGEgZGF0YWJhc2Ugb3IgZXh0ZXJuYWwgbG9nZ2luZyBzZXJ2aWNlLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEluTWVtb3J5VXNhZ2VNb25pdG9yIGltcGxlbWVudHMgVXNhZ2VNb25pdG9yIHtcclxuICBwcml2YXRlIHVzYWdlTG9nczogVXNhZ2VMb2dFbnRyeVtdID0gW107XHJcbiAgcHJpdmF0ZSBlcnJvckxvZ3M6IEVycm9yTG9nRW50cnlbXSA9IFtdO1xyXG4gIHByaXZhdGUgb3B0aW1pemF0aW9uTG9nczogT3B0aW1pemF0aW9uTG9nRW50cnlbXSA9IFtdO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgbWF4TG9nRW50cmllcyA9IDEwMDAwOyAvLyBQcmV2ZW50IG1lbW9yeSBvdmVyZmxvd1xyXG5cclxuICAvKipcclxuICAgKiBHZW5lcmF0ZSB1bmlxdWUgSUQgZm9yIGxvZyBlbnRyaWVzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZW5lcmF0ZUlkKCk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gYCR7RGF0ZS5ub3coKX0tJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIExvZyB0b2tlbiB1c2FnZSBmb3IgYSBsZXNzb24gc2VjdGlvblxyXG4gICAqL1xyXG4gIGxvZ1Rva2VuVXNhZ2UoXHJcbiAgICBzZWN0aW9uOiBzdHJpbmcsIFxyXG4gICAgdG9rZW5zOiBudW1iZXIsIFxyXG4gICAgb3B0aW1pemF0aW9uOiBzdHJpbmcsIFxyXG4gICAgY29udGV4dD86IEdlbmVyYXRpb25Db250ZXh0XHJcbiAgKTogdm9pZCB7XHJcbiAgICBjb25zdCBlbnRyeTogVXNhZ2VMb2dFbnRyeSA9IHtcclxuICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVJZCgpLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXHJcbiAgICAgIHNlY3Rpb24sXHJcbiAgICAgIHRva2VucyxcclxuICAgICAgb3B0aW1pemF0aW9uLFxyXG4gICAgICB1c2VySWQ6IGNvbnRleHQ/LnVzZXJJZCxcclxuICAgICAgbGVzc29uSWQ6IGNvbnRleHQ/Lmxlc3NvbklkXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMudXNhZ2VMb2dzLnB1c2goZW50cnkpO1xyXG4gICAgdGhpcy50cmltTG9ncygpO1xyXG5cclxuICAgIC8vIENvbnNvbGUgbG9nZ2luZyBmb3IgZGV2ZWxvcG1lbnRcclxuICAgIGNvbnNvbGUubG9nKGBbVXNhZ2VNb25pdG9yXSBUb2tlbiB1c2FnZSAtIFNlY3Rpb246ICR7c2VjdGlvbn0sIFRva2VuczogJHt0b2tlbnN9LCBPcHRpbWl6YXRpb246ICR7b3B0aW1pemF0aW9ufWApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTG9nIGVycm9ycyB3aXRoIGNvbnRleHRcclxuICAgKi9cclxuICBsb2dFcnJvcihcclxuICAgIGVycm9yOiBFcnJvciwgXHJcbiAgICBlcnJvclR5cGU6IHN0cmluZywgXHJcbiAgICBjb250ZXh0OiBHZW5lcmF0aW9uQ29udGV4dFxyXG4gICk6IHZvaWQge1xyXG4gICAgY29uc3QgZW50cnk6IEVycm9yTG9nRW50cnkgPSB7XHJcbiAgICAgIGlkOiB0aGlzLmdlbmVyYXRlSWQoKSxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxyXG4gICAgICBlcnJvclR5cGUsXHJcbiAgICAgIGVycm9yTWVzc2FnZTogZXJyb3IubWVzc2FnZSxcclxuICAgICAgY29udGV4dDoge1xyXG4gICAgICAgIGxlc3NvblR5cGU6IGNvbnRleHQubGVzc29uVHlwZSxcclxuICAgICAgICBkaWZmaWN1bHR5TGV2ZWw6IGNvbnRleHQuZGlmZmljdWx0eUxldmVsLFxyXG4gICAgICAgIGNvbnRlbnRMZW5ndGg6IGNvbnRleHQuY29udGVudExlbmd0aCxcclxuICAgICAgICB0aW1lc3RhbXA6IGNvbnRleHQudGltZXN0YW1wXHJcbiAgICAgIH0sXHJcbiAgICAgIHVzZXJJZDogY29udGV4dC51c2VySWQsXHJcbiAgICAgIGxlc3NvbklkOiBjb250ZXh0Lmxlc3NvbklkLFxyXG4gICAgICBzdGFja1RyYWNlOiBlcnJvci5zdGFja1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmVycm9yTG9ncy5wdXNoKGVudHJ5KTtcclxuICAgIHRoaXMudHJpbUxvZ3MoKTtcclxuXHJcbiAgICAvLyBDb25zb2xlIGxvZ2dpbmcgZm9yIGRldmVsb3BtZW50XHJcbiAgICBjb25zb2xlLmVycm9yKGBbVXNhZ2VNb25pdG9yXSBFcnJvciAtIFR5cGU6ICR7ZXJyb3JUeXBlfSwgTWVzc2FnZTogJHtlcnJvci5tZXNzYWdlfWAsIHtcclxuICAgICAgY29udGV4dCxcclxuICAgICAgZXJyb3JJZDogZW50cnkuaWRcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTG9nIG9wdGltaXphdGlvbiBzYXZpbmdzXHJcbiAgICovXHJcbiAgbG9nT3B0aW1pemF0aW9uU2F2aW5ncyhcclxuICAgIGJhc2VsaW5lOiBudW1iZXIsIFxyXG4gICAgb3B0aW1pemVkOiBudW1iZXIsIFxyXG4gICAgc3RyYXRlZ3k6IHN0cmluZywgXHJcbiAgICBjb250ZXh0PzogR2VuZXJhdGlvbkNvbnRleHRcclxuICApOiB2b2lkIHtcclxuICAgIGNvbnN0IHNhdmluZ3MgPSBiYXNlbGluZSAtIG9wdGltaXplZDtcclxuICAgIGNvbnN0IHNhdmluZ3NQZXJjZW50YWdlID0gYmFzZWxpbmUgPiAwID8gKHNhdmluZ3MgLyBiYXNlbGluZSkgKiAxMDAgOiAwO1xyXG5cclxuICAgIGNvbnN0IGVudHJ5OiBPcHRpbWl6YXRpb25Mb2dFbnRyeSA9IHtcclxuICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVJZCgpLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXHJcbiAgICAgIHN0cmF0ZWd5LFxyXG4gICAgICBiYXNlbGluZVRva2VuczogYmFzZWxpbmUsXHJcbiAgICAgIG9wdGltaXplZFRva2Vuczogb3B0aW1pemVkLFxyXG4gICAgICBzYXZpbmdzUGVyY2VudGFnZSxcclxuICAgICAgdXNlcklkOiBjb250ZXh0Py51c2VySWQsXHJcbiAgICAgIGxlc3NvbklkOiBjb250ZXh0Py5sZXNzb25JZFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLm9wdGltaXphdGlvbkxvZ3MucHVzaChlbnRyeSk7XHJcbiAgICB0aGlzLnRyaW1Mb2dzKCk7XHJcblxyXG4gICAgLy8gQ29uc29sZSBsb2dnaW5nIGZvciBkZXZlbG9wbWVudFxyXG4gICAgY29uc29sZS5sb2coYFtVc2FnZU1vbml0b3JdIE9wdGltaXphdGlvbiAtIFN0cmF0ZWd5OiAke3N0cmF0ZWd5fSwgU2F2aW5nczogJHtzYXZpbmdzfSB0b2tlbnMgKCR7c2F2aW5nc1BlcmNlbnRhZ2UudG9GaXhlZCgxKX0lKWApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGUgY29tcHJlaGVuc2l2ZSB1c2FnZSByZXBvcnRcclxuICAgKi9cclxuICBhc3luYyBnZW5lcmF0ZVVzYWdlUmVwb3J0KHN0YXJ0RGF0ZT86IERhdGUsIGVuZERhdGU/OiBEYXRlKTogUHJvbWlzZTxVc2FnZVJlcG9ydD4ge1xyXG4gICAgY29uc3Qgc3RhcnQgPSBzdGFydERhdGUgfHwgbmV3IERhdGUoRGF0ZS5ub3coKSAtIDMwICogMjQgKiA2MCAqIDYwICogMTAwMCk7IC8vIERlZmF1bHQ6IDMwIGRheXMgYWdvXHJcbiAgICBjb25zdCBlbmQgPSBlbmREYXRlIHx8IG5ldyBEYXRlKCk7XHJcblxyXG4gICAgLy8gRmlsdGVyIGxvZ3MgYnkgZGF0ZSByYW5nZVxyXG4gICAgY29uc3QgZmlsdGVyZWRVc2FnZUxvZ3MgPSB0aGlzLnVzYWdlTG9ncy5maWx0ZXIoXHJcbiAgICAgIGxvZyA9PiBsb2cudGltZXN0YW1wID49IHN0YXJ0ICYmIGxvZy50aW1lc3RhbXAgPD0gZW5kXHJcbiAgICApO1xyXG4gICAgY29uc3QgZmlsdGVyZWRFcnJvckxvZ3MgPSB0aGlzLmVycm9yTG9ncy5maWx0ZXIoXHJcbiAgICAgIGxvZyA9PiBsb2cudGltZXN0YW1wID49IHN0YXJ0ICYmIGxvZy50aW1lc3RhbXAgPD0gZW5kXHJcbiAgICApO1xyXG4gICAgY29uc3QgZmlsdGVyZWRPcHRpbWl6YXRpb25Mb2dzID0gdGhpcy5vcHRpbWl6YXRpb25Mb2dzLmZpbHRlcihcclxuICAgICAgbG9nID0+IGxvZy50aW1lc3RhbXAgPj0gc3RhcnQgJiYgbG9nLnRpbWVzdGFtcCA8PSBlbmRcclxuICAgICk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIG1ldHJpY3NcclxuICAgIGNvbnN0IHVuaXF1ZUxlc3NvbnMgPSBuZXcgU2V0KGZpbHRlcmVkVXNhZ2VMb2dzLm1hcChsb2cgPT4gbG9nLmxlc3NvbklkKS5maWx0ZXIoQm9vbGVhbikpO1xyXG4gICAgY29uc3QgdG90YWxMZXNzb25zID0gdW5pcXVlTGVzc29ucy5zaXplO1xyXG4gICAgY29uc3QgdG90YWxUb2tlbnMgPSBmaWx0ZXJlZFVzYWdlTG9ncy5yZWR1Y2UoKHN1bSwgbG9nKSA9PiBzdW0gKyBsb2cudG9rZW5zLCAwKTtcclxuICAgIGNvbnN0IGF2ZXJhZ2VUb2tlbnNQZXJMZXNzb24gPSB0b3RhbExlc3NvbnMgPiAwID8gdG90YWxUb2tlbnMgLyB0b3RhbExlc3NvbnMgOiAwO1xyXG5cclxuICAgIGNvbnN0IHRvdGFsT3B0aW1pemF0aW9uU2F2aW5ncyA9IGZpbHRlcmVkT3B0aW1pemF0aW9uTG9ncy5yZWR1Y2UoXHJcbiAgICAgIChzdW0sIGxvZykgPT4gc3VtICsgKGxvZy5iYXNlbGluZVRva2VucyAtIGxvZy5vcHRpbWl6ZWRUb2tlbnMpLCAwXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IGVycm9yUmF0ZSA9IHRvdGFsTGVzc29ucyA+IDAgPyAoZmlsdGVyZWRFcnJvckxvZ3MubGVuZ3RoIC8gdG90YWxMZXNzb25zKSAqIDEwMCA6IDA7XHJcblxyXG4gICAgLy8gVG9wIG9wdGltaXphdGlvbiBzdHJhdGVnaWVzXHJcbiAgICBjb25zdCBzdHJhdGVneVN0YXRzID0gbmV3IE1hcDxzdHJpbmcsIHsgdXNhZ2U6IG51bWJlcjsgdG90YWxTYXZpbmdzOiBudW1iZXIgfT4oKTtcclxuICAgIGZpbHRlcmVkT3B0aW1pemF0aW9uTG9ncy5mb3JFYWNoKGxvZyA9PiB7XHJcbiAgICAgIGNvbnN0IGN1cnJlbnQgPSBzdHJhdGVneVN0YXRzLmdldChsb2cuc3RyYXRlZ3kpIHx8IHsgdXNhZ2U6IDAsIHRvdGFsU2F2aW5nczogMCB9O1xyXG4gICAgICBjdXJyZW50LnVzYWdlKys7XHJcbiAgICAgIGN1cnJlbnQudG90YWxTYXZpbmdzICs9IChsb2cuYmFzZWxpbmVUb2tlbnMgLSBsb2cub3B0aW1pemVkVG9rZW5zKTtcclxuICAgICAgc3RyYXRlZ3lTdGF0cy5zZXQobG9nLnN0cmF0ZWd5LCBjdXJyZW50KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IHRvcE9wdGltaXphdGlvblN0cmF0ZWdpZXMgPSBBcnJheS5mcm9tKHN0cmF0ZWd5U3RhdHMuZW50cmllcygpKVxyXG4gICAgICAubWFwKChbc3RyYXRlZ3ksIHN0YXRzXSkgPT4gKHtcclxuICAgICAgICBzdHJhdGVneSxcclxuICAgICAgICB1c2FnZTogc3RhdHMudXNhZ2UsXHJcbiAgICAgICAgYXZlcmFnZVNhdmluZ3M6IHN0YXRzLnVzYWdlID4gMCA/IHN0YXRzLnRvdGFsU2F2aW5ncyAvIHN0YXRzLnVzYWdlIDogMFxyXG4gICAgICB9KSlcclxuICAgICAgLnNvcnQoKGEsIGIpID0+IGIudXNhZ2UgLSBhLnVzYWdlKVxyXG4gICAgICAuc2xpY2UoMCwgNSk7XHJcblxyXG4gICAgLy8gRXJyb3IgYnJlYWtkb3duXHJcbiAgICBjb25zdCBlcnJvckJyZWFrZG93bjogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xyXG4gICAgZmlsdGVyZWRFcnJvckxvZ3MuZm9yRWFjaChsb2cgPT4ge1xyXG4gICAgICBlcnJvckJyZWFrZG93bltsb2cuZXJyb3JUeXBlXSA9IChlcnJvckJyZWFrZG93bltsb2cuZXJyb3JUeXBlXSB8fCAwKSArIDE7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBTZWN0aW9uIHRva2VuIGJyZWFrZG93blxyXG4gICAgY29uc3Qgc2VjdGlvblRva2VuQnJlYWtkb3duOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XHJcbiAgICBmaWx0ZXJlZFVzYWdlTG9ncy5mb3JFYWNoKGxvZyA9PiB7XHJcbiAgICAgIHNlY3Rpb25Ub2tlbkJyZWFrZG93bltsb2cuc2VjdGlvbl0gPSAoc2VjdGlvblRva2VuQnJlYWtkb3duW2xvZy5zZWN0aW9uXSB8fCAwKSArIGxvZy50b2tlbnM7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBwZXJpb2Q6IHsgc3RhcnQsIGVuZCB9LFxyXG4gICAgICB0b3RhbExlc3NvbnMsXHJcbiAgICAgIHRvdGFsVG9rZW5zLFxyXG4gICAgICBhdmVyYWdlVG9rZW5zUGVyTGVzc29uLFxyXG4gICAgICB0b3RhbE9wdGltaXphdGlvblNhdmluZ3MsXHJcbiAgICAgIGVycm9yUmF0ZSxcclxuICAgICAgdG9wT3B0aW1pemF0aW9uU3RyYXRlZ2llcyxcclxuICAgICAgZXJyb3JCcmVha2Rvd24sXHJcbiAgICAgIHNlY3Rpb25Ub2tlbkJyZWFrZG93blxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB1c2FnZSBtZXRyaWNzIGZvciBhIHNwZWNpZmljIGxlc3NvblxyXG4gICAqL1xyXG4gIGFzeW5jIGdldExlc3Nvbk1ldHJpY3MobGVzc29uSWQ6IHN0cmluZyk6IFByb21pc2U8VXNhZ2VNZXRyaWNzIHwgbnVsbD4ge1xyXG4gICAgY29uc3QgbGVzc29uTG9ncyA9IHRoaXMudXNhZ2VMb2dzLmZpbHRlcihsb2cgPT4gbG9nLmxlc3NvbklkID09PSBsZXNzb25JZCk7XHJcbiAgICBcclxuICAgIGlmIChsZXNzb25Mb2dzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB0b3RhbFRva2VucyA9IGxlc3NvbkxvZ3MucmVkdWNlKChzdW0sIGxvZykgPT4gc3VtICsgbG9nLnRva2VucywgMCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHRva2Vuc1BlclNlY3Rpb246IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcclxuICAgIGxlc3NvbkxvZ3MuZm9yRWFjaChsb2cgPT4ge1xyXG4gICAgICB0b2tlbnNQZXJTZWN0aW9uW2xvZy5zZWN0aW9uXSA9ICh0b2tlbnNQZXJTZWN0aW9uW2xvZy5zZWN0aW9uXSB8fCAwKSArIGxvZy50b2tlbnM7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgb3B0aW1pemF0aW9uIHNhdmluZ3MgZm9yIHRoaXMgbGVzc29uXHJcbiAgICBjb25zdCBsZXNzb25PcHRpbWl6YXRpb25Mb2dzID0gdGhpcy5vcHRpbWl6YXRpb25Mb2dzLmZpbHRlcihsb2cgPT4gbG9nLmxlc3NvbklkID09PSBsZXNzb25JZCk7XHJcbiAgICBjb25zdCBvcHRpbWl6YXRpb25TYXZpbmdzID0gbGVzc29uT3B0aW1pemF0aW9uTG9ncy5yZWR1Y2UoXHJcbiAgICAgIChzdW0sIGxvZykgPT4gc3VtICsgKGxvZy5iYXNlbGluZVRva2VucyAtIGxvZy5vcHRpbWl6ZWRUb2tlbnMpLCAwXHJcbiAgICApO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSBnZW5lcmF0aW9uIHRpbWUgKHRpbWUgYmV0d2VlbiBmaXJzdCBhbmQgbGFzdCBsb2cgZW50cnkpXHJcbiAgICBjb25zdCB0aW1lc3RhbXBzID0gbGVzc29uTG9ncy5tYXAobG9nID0+IGxvZy50aW1lc3RhbXAuZ2V0VGltZSgpKS5zb3J0KCk7XHJcbiAgICBjb25zdCBnZW5lcmF0aW9uVGltZSA9IHRpbWVzdGFtcHMubGVuZ3RoID4gMSA/IHRpbWVzdGFtcHNbdGltZXN0YW1wcy5sZW5ndGggLSAxXSAtIHRpbWVzdGFtcHNbMF0gOiAwO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRvdGFsVG9rZW5zLFxyXG4gICAgICB0b2tlbnNQZXJTZWN0aW9uLFxyXG4gICAgICBvcHRpbWl6YXRpb25TYXZpbmdzLFxyXG4gICAgICBnZW5lcmF0aW9uVGltZSxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSh0aW1lc3RhbXBzWzBdKVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsZWFyIG9sZCBsb2dzIHRvIHByZXZlbnQgbWVtb3J5IG92ZXJmbG93XHJcbiAgICovXHJcbiAgYXN5bmMgY2xlYXJPbGRMb2dzKG9sZGVyVGhhbkRheXM6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc3QgY3V0b2ZmRGF0ZSA9IG5ldyBEYXRlKERhdGUubm93KCkgLSBvbGRlclRoYW5EYXlzICogMjQgKiA2MCAqIDYwICogMTAwMCk7XHJcbiAgICBcclxuICAgIGNvbnN0IGluaXRpYWxVc2FnZUNvdW50ID0gdGhpcy51c2FnZUxvZ3MubGVuZ3RoO1xyXG4gICAgY29uc3QgaW5pdGlhbEVycm9yQ291bnQgPSB0aGlzLmVycm9yTG9ncy5sZW5ndGg7XHJcbiAgICBjb25zdCBpbml0aWFsT3B0aW1pemF0aW9uQ291bnQgPSB0aGlzLm9wdGltaXphdGlvbkxvZ3MubGVuZ3RoO1xyXG5cclxuICAgIHRoaXMudXNhZ2VMb2dzID0gdGhpcy51c2FnZUxvZ3MuZmlsdGVyKGxvZyA9PiBsb2cudGltZXN0YW1wID49IGN1dG9mZkRhdGUpO1xyXG4gICAgdGhpcy5lcnJvckxvZ3MgPSB0aGlzLmVycm9yTG9ncy5maWx0ZXIobG9nID0+IGxvZy50aW1lc3RhbXAgPj0gY3V0b2ZmRGF0ZSk7XHJcbiAgICB0aGlzLm9wdGltaXphdGlvbkxvZ3MgPSB0aGlzLm9wdGltaXphdGlvbkxvZ3MuZmlsdGVyKGxvZyA9PiBsb2cudGltZXN0YW1wID49IGN1dG9mZkRhdGUpO1xyXG5cclxuICAgIGNvbnN0IGNsZWFyZWRVc2FnZSA9IGluaXRpYWxVc2FnZUNvdW50IC0gdGhpcy51c2FnZUxvZ3MubGVuZ3RoO1xyXG4gICAgY29uc3QgY2xlYXJlZEVycm9ycyA9IGluaXRpYWxFcnJvckNvdW50IC0gdGhpcy5lcnJvckxvZ3MubGVuZ3RoO1xyXG4gICAgY29uc3QgY2xlYXJlZE9wdGltaXphdGlvbnMgPSBpbml0aWFsT3B0aW1pemF0aW9uQ291bnQgLSB0aGlzLm9wdGltaXphdGlvbkxvZ3MubGVuZ3RoO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKGBbVXNhZ2VNb25pdG9yXSBDbGVhcmVkIG9sZCBsb2dzOiAke2NsZWFyZWRVc2FnZX0gdXNhZ2UsICR7Y2xlYXJlZEVycm9yc30gZXJyb3JzLCAke2NsZWFyZWRPcHRpbWl6YXRpb25zfSBvcHRpbWl6YXRpb25zYCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUcmltIGxvZ3MgdG8gcHJldmVudCBtZW1vcnkgb3ZlcmZsb3dcclxuICAgKi9cclxuICBwcml2YXRlIHRyaW1Mb2dzKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMudXNhZ2VMb2dzLmxlbmd0aCA+IHRoaXMubWF4TG9nRW50cmllcykge1xyXG4gICAgICB0aGlzLnVzYWdlTG9ncyA9IHRoaXMudXNhZ2VMb2dzLnNsaWNlKC10aGlzLm1heExvZ0VudHJpZXMpO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuZXJyb3JMb2dzLmxlbmd0aCA+IHRoaXMubWF4TG9nRW50cmllcykge1xyXG4gICAgICB0aGlzLmVycm9yTG9ncyA9IHRoaXMuZXJyb3JMb2dzLnNsaWNlKC10aGlzLm1heExvZ0VudHJpZXMpO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMub3B0aW1pemF0aW9uTG9ncy5sZW5ndGggPiB0aGlzLm1heExvZ0VudHJpZXMpIHtcclxuICAgICAgdGhpcy5vcHRpbWl6YXRpb25Mb2dzID0gdGhpcy5vcHRpbWl6YXRpb25Mb2dzLnNsaWNlKC10aGlzLm1heExvZ0VudHJpZXMpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGN1cnJlbnQgbG9nIGNvdW50cyAoZm9yIGRlYnVnZ2luZylcclxuICAgKi9cclxuICBnZXRMb2dDb3VudHMoKTogeyB1c2FnZTogbnVtYmVyOyBlcnJvcnM6IG51bWJlcjsgb3B0aW1pemF0aW9uczogbnVtYmVyIH0ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdXNhZ2U6IHRoaXMudXNhZ2VMb2dzLmxlbmd0aCxcclxuICAgICAgZXJyb3JzOiB0aGlzLmVycm9yTG9ncy5sZW5ndGgsXHJcbiAgICAgIG9wdGltaXphdGlvbnM6IHRoaXMub3B0aW1pemF0aW9uTG9ncy5sZW5ndGhcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFeHBvcnQgbG9ncyBmb3IgZXh0ZXJuYWwgYW5hbHlzaXNcclxuICAgKi9cclxuICBleHBvcnRMb2dzKCk6IHtcclxuICAgIHVzYWdlOiBVc2FnZUxvZ0VudHJ5W107XHJcbiAgICBlcnJvcnM6IEVycm9yTG9nRW50cnlbXTtcclxuICAgIG9wdGltaXphdGlvbnM6IE9wdGltaXphdGlvbkxvZ0VudHJ5W107XHJcbiAgfSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB1c2FnZTogWy4uLnRoaXMudXNhZ2VMb2dzXSxcclxuICAgICAgZXJyb3JzOiBbLi4udGhpcy5lcnJvckxvZ3NdLFxyXG4gICAgICBvcHRpbWl6YXRpb25zOiBbLi4udGhpcy5vcHRpbWl6YXRpb25Mb2dzXVxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8vIFNpbmdsZXRvbiBpbnN0YW5jZSBmb3IgZ2xvYmFsIHVzYWdlIG1vbml0b3JpbmdcclxuZXhwb3J0IGNvbnN0IHVzYWdlTW9uaXRvciA9IG5ldyBJbk1lbW9yeVVzYWdlTW9uaXRvcigpOyJdLCJuYW1lcyI6WyJJbk1lbW9yeVVzYWdlTW9uaXRvciIsImdlbmVyYXRlSWQiLCJEYXRlIiwibm93IiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyIiwibG9nVG9rZW5Vc2FnZSIsInNlY3Rpb24iLCJ0b2tlbnMiLCJvcHRpbWl6YXRpb24iLCJjb250ZXh0IiwiZW50cnkiLCJpZCIsInRpbWVzdGFtcCIsInVzZXJJZCIsImxlc3NvbklkIiwidXNhZ2VMb2dzIiwicHVzaCIsInRyaW1Mb2dzIiwiY29uc29sZSIsImxvZyIsImxvZ0Vycm9yIiwiZXJyb3IiLCJlcnJvclR5cGUiLCJlcnJvck1lc3NhZ2UiLCJtZXNzYWdlIiwibGVzc29uVHlwZSIsImRpZmZpY3VsdHlMZXZlbCIsImNvbnRlbnRMZW5ndGgiLCJzdGFja1RyYWNlIiwic3RhY2siLCJlcnJvckxvZ3MiLCJlcnJvcklkIiwibG9nT3B0aW1pemF0aW9uU2F2aW5ncyIsImJhc2VsaW5lIiwib3B0aW1pemVkIiwic3RyYXRlZ3kiLCJzYXZpbmdzIiwic2F2aW5nc1BlcmNlbnRhZ2UiLCJiYXNlbGluZVRva2VucyIsIm9wdGltaXplZFRva2VucyIsIm9wdGltaXphdGlvbkxvZ3MiLCJ0b0ZpeGVkIiwiZ2VuZXJhdGVVc2FnZVJlcG9ydCIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJzdGFydCIsImVuZCIsImZpbHRlcmVkVXNhZ2VMb2dzIiwiZmlsdGVyIiwiZmlsdGVyZWRFcnJvckxvZ3MiLCJmaWx0ZXJlZE9wdGltaXphdGlvbkxvZ3MiLCJ1bmlxdWVMZXNzb25zIiwiU2V0IiwibWFwIiwiQm9vbGVhbiIsInRvdGFsTGVzc29ucyIsInNpemUiLCJ0b3RhbFRva2VucyIsInJlZHVjZSIsInN1bSIsImF2ZXJhZ2VUb2tlbnNQZXJMZXNzb24iLCJ0b3RhbE9wdGltaXphdGlvblNhdmluZ3MiLCJlcnJvclJhdGUiLCJsZW5ndGgiLCJzdHJhdGVneVN0YXRzIiwiTWFwIiwiZm9yRWFjaCIsImN1cnJlbnQiLCJnZXQiLCJ1c2FnZSIsInRvdGFsU2F2aW5ncyIsInNldCIsInRvcE9wdGltaXphdGlvblN0cmF0ZWdpZXMiLCJBcnJheSIsImZyb20iLCJlbnRyaWVzIiwic3RhdHMiLCJhdmVyYWdlU2F2aW5ncyIsInNvcnQiLCJhIiwiYiIsInNsaWNlIiwiZXJyb3JCcmVha2Rvd24iLCJzZWN0aW9uVG9rZW5CcmVha2Rvd24iLCJwZXJpb2QiLCJnZXRMZXNzb25NZXRyaWNzIiwibGVzc29uTG9ncyIsInRva2Vuc1BlclNlY3Rpb24iLCJsZXNzb25PcHRpbWl6YXRpb25Mb2dzIiwib3B0aW1pemF0aW9uU2F2aW5ncyIsInRpbWVzdGFtcHMiLCJnZXRUaW1lIiwiZ2VuZXJhdGlvblRpbWUiLCJjbGVhck9sZExvZ3MiLCJvbGRlclRoYW5EYXlzIiwiY3V0b2ZmRGF0ZSIsImluaXRpYWxVc2FnZUNvdW50IiwiaW5pdGlhbEVycm9yQ291bnQiLCJpbml0aWFsT3B0aW1pemF0aW9uQ291bnQiLCJjbGVhcmVkVXNhZ2UiLCJjbGVhcmVkRXJyb3JzIiwiY2xlYXJlZE9wdGltaXphdGlvbnMiLCJtYXhMb2dFbnRyaWVzIiwiZ2V0TG9nQ291bnRzIiwiZXJyb3JzIiwib3B0aW1pemF0aW9ucyIsImV4cG9ydExvZ3MiLCJ1c2FnZU1vbml0b3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/usage-monitor.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/next","vendor-chunks/whatwg-url","vendor-chunks/tr46","vendor-chunks/webidl-conversions","vendor-chunks/cookie"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson%2Froute&page=%2Fapi%2Fgenerate-lesson%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();
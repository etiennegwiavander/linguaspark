"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/generate-lesson/route";
exports.ids = ["app/api/generate-lesson/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson%2Froute&page=%2Fapi%2Fgenerate-lesson%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson%2Froute&page=%2Fapi%2Fgenerate-lesson%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_linguaspark_app_api_generate_lesson_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/generate-lesson/route.ts */ \"(rsc)/./app/api/generate-lesson/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/generate-lesson/route\",\n        pathname: \"/api/generate-lesson\",\n        filename: \"route\",\n        bundlePath: \"app/api/generate-lesson/route\"\n    },\n    resolvedPagePath: \"D:\\\\linguaspark\\\\app\\\\api\\\\generate-lesson\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_linguaspark_app_api_generate_lesson_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/generate-lesson/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZnZW5lcmF0ZS1sZXNzb24lMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmdlbmVyYXRlLWxlc3NvbiUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmdlbmVyYXRlLWxlc3NvbiUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDbGluZ3Vhc3BhcmslNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUQlM0ElNUNsaW5ndWFzcGFyayZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDSTtBQUNqRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvPzI3ZDQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxcbGluZ3Vhc3BhcmtcXFxcYXBwXFxcXGFwaVxcXFxnZW5lcmF0ZS1sZXNzb25cXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2dlbmVyYXRlLWxlc3Nvbi9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2dlbmVyYXRlLWxlc3NvblwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvZ2VuZXJhdGUtbGVzc29uL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRDpcXFxcbGluZ3Vhc3BhcmtcXFxcYXBwXFxcXGFwaVxcXFxnZW5lcmF0ZS1sZXNzb25cXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2dlbmVyYXRlLWxlc3Nvbi9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson%2Froute&page=%2Fapi%2Fgenerate-lesson%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/generate-lesson/route.ts":
/*!******************************************!*\
  !*** ./app/api/generate-lesson/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_lesson_ai_generator_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/lesson-ai-generator-server */ \"(rsc)/./lib/lesson-ai-generator-server.ts\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/supabase-server */ \"(rsc)/./lib/supabase-server.ts\");\n\n // Updated import to use server-side generator\n\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { sourceText, lessonType, studentLevel, targetLanguage, sourceUrl, contentMetadata, structuredContent, wordCount, readingTime } = body;\n        // Validate required fields\n        if (!sourceText || !lessonType || !studentLevel || !targetLanguage) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Missing required fields\"\n            }, {\n                status: 400\n            });\n        }\n        // Validate user authentication\n        const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__.createServerSupabaseClient)();\n        const { data: { user }, error: authError } = await supabase.auth.getUser();\n        if (authError || !user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Authentication required\"\n            }, {\n                status: 401\n            });\n        }\n        // Generate lesson using enhanced AI pipeline with contextual information\n        const lesson = await _lib_lesson_ai_generator_server__WEBPACK_IMPORTED_MODULE_1__.lessonAIServerGenerator.generateLesson({\n            sourceText,\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sourceUrl,\n            contentMetadata,\n            structuredContent,\n            wordCount,\n            readingTime\n        });\n        console.log(\"\\uD83C\\uDF93 Generated lesson structure:\", {\n            hasLesson: !!lesson,\n            hasSections: !!lesson?.sections,\n            sectionKeys: lesson?.sections ? Object.keys(lesson.sections) : [],\n            lessonType: lesson?.lessonType,\n            studentLevel: lesson?.studentLevel,\n            targetLanguage: lesson?.targetLanguage,\n            warmupQuestions: lesson?.sections?.warmup?.length || 0,\n            vocabularyItems: lesson?.sections?.vocabulary?.length || 0\n        });\n        // Check if we have a valid AI-generated lesson\n        if (lesson && lesson.sections && Object.keys(lesson.sections).length > 0) {\n            console.log(\"✅ Using AI-generated lesson content\");\n            // Use AI-generated content with minimal fallbacks only for missing properties\n            const finalLesson = {\n                lessonType: lesson.lessonType || lessonType,\n                studentLevel: lesson.studentLevel || studentLevel,\n                targetLanguage: lesson.targetLanguage || targetLanguage,\n                sections: lesson.sections // Use AI-generated sections as-is\n            };\n            console.log(\"\\uD83C\\uDF89 Returning AI-generated lesson with sections:\", Object.keys(finalLesson.sections));\n            // Save and return the AI-generated lesson\n            const { data: savedLesson, error: saveError } = await supabase.from(\"lessons\").insert({\n                tutor_id: user.id,\n                title: `${lessonType} Lesson - ${new Date().toLocaleDateString()}`,\n                lesson_type: lessonType,\n                student_level: studentLevel,\n                target_language: targetLanguage,\n                source_url: sourceUrl,\n                source_text: sourceText,\n                lesson_data: finalLesson\n            }).select().single();\n            if (saveError) {\n                console.error(\"Error saving lesson:\", saveError);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    lesson: finalLesson\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                lesson: {\n                    ...finalLesson,\n                    id: savedLesson.id\n                }\n            });\n        }\n        // Only use fallback if AI generation completely failed\n        console.warn(\"⚠️ AI generation failed, using fallback lesson structure\");\n        const safeLesson = {\n            lessonType: lessonType,\n            studentLevel: studentLevel,\n            targetLanguage: targetLanguage,\n            sections: {\n                warmup: [\n                    \"What do you already know about this topic?\",\n                    \"Have you had similar experiences?\",\n                    \"What would you like to learn more about?\"\n                ],\n                vocabulary: [],\n                reading: sourceText.substring(0, 500),\n                comprehension: [\n                    \"What is the main idea of this text?\",\n                    \"What supporting details can you identify?\"\n                ],\n                discussion: [\n                    \"What is your opinion on this topic?\",\n                    \"How would you handle this situation?\"\n                ],\n                grammar: {\n                    focus: \"Present Perfect Tense\",\n                    examples: [\n                        \"I have learned many new things.\",\n                        \"She has improved her skills.\"\n                    ],\n                    exercise: [\n                        \"I _____ (learn) a lot today.\",\n                        \"They _____ (complete) the project.\"\n                    ]\n                },\n                pronunciation: {\n                    word: \"communication\",\n                    ipa: \"/kəˌmjuːnɪˈkeɪʃən/\",\n                    practice: \"Practice saying: communication in a sentence.\"\n                },\n                wrapup: [\n                    \"What new vocabulary did you learn?\",\n                    \"Which concepts need more practice?\"\n                ]\n            }\n        };\n        console.log(\"✅ Using fallback lesson structure\");\n        // Save fallback lesson to database\n        const { data: savedLesson, error: saveError } = await supabase.from(\"lessons\").insert({\n            tutor_id: user.id,\n            title: `${lessonType} Lesson - ${new Date().toLocaleDateString()}`,\n            lesson_type: lessonType,\n            student_level: studentLevel,\n            target_language: targetLanguage,\n            source_url: sourceUrl,\n            source_text: sourceText,\n            lesson_data: safeLesson\n        }).select().single();\n        if (saveError) {\n            console.error(\"Error saving lesson:\", saveError);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                lesson: safeLesson\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            lesson: {\n                ...safeLesson,\n                id: savedLesson.id\n            }\n        });\n    } catch (error) {\n        console.error(\"Error generating lesson:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to generate lesson\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWF6QztZQUNiMEMsZUFBZXpDO1lBQ2YwQyxpQkFBaUJ6QztZQUNqQjBDLFlBQVl6QztZQUNaMEMsYUFBYTlDO1lBQ2IrQyxhQUFhSTtRQUNmLEdBQ0NILE1BQU0sR0FDTkMsTUFBTTtRQUVULElBQUlmLFdBQVc7WUFDYmYsUUFBUVYsS0FBSyxDQUFDLHdCQUF3QnlCO1lBQ3RDLE9BQU96QyxxREFBWUEsQ0FBQ00sSUFBSSxDQUFDO2dCQUFFa0IsUUFBUWtDO1lBQVc7UUFDaEQ7UUFFQSxPQUFPMUQscURBQVlBLENBQUNNLElBQUksQ0FBQztZQUN2QmtCLFFBQVE7Z0JBQ04sR0FBR2tDLFVBQVU7Z0JBQ2JiLElBQUlMLFlBQVlLLEVBQUU7WUFDcEI7UUFDRjtJQUNGLEVBQUUsT0FBTzdCLE9BQU87UUFDZFUsUUFBUVYsS0FBSyxDQUFDLDRCQUE0QkE7UUFDMUMsT0FBT2hCLHFEQUFZQSxDQUFDTSxJQUFJLENBQUM7WUFBRVUsT0FBTztRQUE0QixHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUNqRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktdjAtcHJvamVjdC8uL2FwcC9hcGkvZ2VuZXJhdGUtbGVzc29uL3JvdXRlLnRzPzVhYmYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdHlwZSBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCJcbmltcG9ydCB7IGxlc3NvbkFJU2VydmVyR2VuZXJhdG9yIH0gZnJvbSBcIkAvbGliL2xlc3Nvbi1haS1nZW5lcmF0b3Itc2VydmVyXCIgLy8gVXBkYXRlZCBpbXBvcnQgdG8gdXNlIHNlcnZlci1zaWRlIGdlbmVyYXRvclxuaW1wb3J0IHsgY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQgfSBmcm9tIFwiQC9saWIvc3VwYWJhc2Utc2VydmVyXCJcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICBjb25zdCB7IFxuICAgICAgc291cmNlVGV4dCwgXG4gICAgICBsZXNzb25UeXBlLCBcbiAgICAgIHN0dWRlbnRMZXZlbCwgXG4gICAgICB0YXJnZXRMYW5ndWFnZSwgXG4gICAgICBzb3VyY2VVcmwsXG4gICAgICBjb250ZW50TWV0YWRhdGEsXG4gICAgICBzdHJ1Y3R1cmVkQ29udGVudCxcbiAgICAgIHdvcmRDb3VudCxcbiAgICAgIHJlYWRpbmdUaW1lXG4gICAgfSA9IGJvZHlcblxuICAgIC8vIFZhbGlkYXRlIHJlcXVpcmVkIGZpZWxkc1xuICAgIGlmICghc291cmNlVGV4dCB8fCAhbGVzc29uVHlwZSB8fCAhc3R1ZGVudExldmVsIHx8ICF0YXJnZXRMYW5ndWFnZSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiTWlzc2luZyByZXF1aXJlZCBmaWVsZHNcIiB9LCB7IHN0YXR1czogNDAwIH0pXG4gICAgfVxuXG4gICAgLy8gVmFsaWRhdGUgdXNlciBhdXRoZW50aWNhdGlvblxuICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQoKVxuICAgIGNvbnN0IHtcbiAgICAgIGRhdGE6IHsgdXNlciB9LFxuICAgICAgZXJyb3I6IGF1dGhFcnJvcixcbiAgICB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKClcblxuICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIkF1dGhlbnRpY2F0aW9uIHJlcXVpcmVkXCIgfSwgeyBzdGF0dXM6IDQwMSB9KVxuICAgIH1cblxuICAgIC8vIEdlbmVyYXRlIGxlc3NvbiB1c2luZyBlbmhhbmNlZCBBSSBwaXBlbGluZSB3aXRoIGNvbnRleHR1YWwgaW5mb3JtYXRpb25cbiAgICBjb25zdCBsZXNzb24gPSBhd2FpdCBsZXNzb25BSVNlcnZlckdlbmVyYXRvci5nZW5lcmF0ZUxlc3Nvbih7XG4gICAgICBzb3VyY2VUZXh0LFxuICAgICAgbGVzc29uVHlwZSxcbiAgICAgIHN0dWRlbnRMZXZlbCxcbiAgICAgIHRhcmdldExhbmd1YWdlLFxuICAgICAgc291cmNlVXJsLFxuICAgICAgY29udGVudE1ldGFkYXRhLFxuICAgICAgc3RydWN0dXJlZENvbnRlbnQsXG4gICAgICB3b3JkQ291bnQsXG4gICAgICByZWFkaW5nVGltZSxcbiAgICB9KVxuXG4gICAgY29uc29sZS5sb2coXCLwn46TIEdlbmVyYXRlZCBsZXNzb24gc3RydWN0dXJlOlwiLCB7XG4gICAgICBoYXNMZXNzb246ICEhbGVzc29uLFxuICAgICAgaGFzU2VjdGlvbnM6ICEhbGVzc29uPy5zZWN0aW9ucyxcbiAgICAgIHNlY3Rpb25LZXlzOiBsZXNzb24/LnNlY3Rpb25zID8gT2JqZWN0LmtleXMobGVzc29uLnNlY3Rpb25zKSA6IFtdLFxuICAgICAgbGVzc29uVHlwZTogbGVzc29uPy5sZXNzb25UeXBlLFxuICAgICAgc3R1ZGVudExldmVsOiBsZXNzb24/LnN0dWRlbnRMZXZlbCxcbiAgICAgIHRhcmdldExhbmd1YWdlOiBsZXNzb24/LnRhcmdldExhbmd1YWdlLFxuICAgICAgd2FybXVwUXVlc3Rpb25zOiBsZXNzb24/LnNlY3Rpb25zPy53YXJtdXA/Lmxlbmd0aCB8fCAwLFxuICAgICAgdm9jYWJ1bGFyeUl0ZW1zOiBsZXNzb24/LnNlY3Rpb25zPy52b2NhYnVsYXJ5Py5sZW5ndGggfHwgMFxuICAgIH0pXG5cbiAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIGEgdmFsaWQgQUktZ2VuZXJhdGVkIGxlc3NvblxuICAgIGlmIChsZXNzb24gJiYgbGVzc29uLnNlY3Rpb25zICYmIE9iamVjdC5rZXlzKGxlc3Nvbi5zZWN0aW9ucykubGVuZ3RoID4gMCkge1xuICAgICAgY29uc29sZS5sb2coXCLinIUgVXNpbmcgQUktZ2VuZXJhdGVkIGxlc3NvbiBjb250ZW50XCIpXG4gICAgICBcbiAgICAgIC8vIFVzZSBBSS1nZW5lcmF0ZWQgY29udGVudCB3aXRoIG1pbmltYWwgZmFsbGJhY2tzIG9ubHkgZm9yIG1pc3NpbmcgcHJvcGVydGllc1xuICAgICAgY29uc3QgZmluYWxMZXNzb24gPSB7XG4gICAgICAgIGxlc3NvblR5cGU6IGxlc3Nvbi5sZXNzb25UeXBlIHx8IGxlc3NvblR5cGUsXG4gICAgICAgIHN0dWRlbnRMZXZlbDogbGVzc29uLnN0dWRlbnRMZXZlbCB8fCBzdHVkZW50TGV2ZWwsXG4gICAgICAgIHRhcmdldExhbmd1YWdlOiBsZXNzb24udGFyZ2V0TGFuZ3VhZ2UgfHwgdGFyZ2V0TGFuZ3VhZ2UsXG4gICAgICAgIHNlY3Rpb25zOiBsZXNzb24uc2VjdGlvbnMgLy8gVXNlIEFJLWdlbmVyYXRlZCBzZWN0aW9ucyBhcy1pc1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhcIvCfjokgUmV0dXJuaW5nIEFJLWdlbmVyYXRlZCBsZXNzb24gd2l0aCBzZWN0aW9uczpcIiwgT2JqZWN0LmtleXMoZmluYWxMZXNzb24uc2VjdGlvbnMpKVxuICAgICAgXG4gICAgICAvLyBTYXZlIGFuZCByZXR1cm4gdGhlIEFJLWdlbmVyYXRlZCBsZXNzb25cbiAgICAgIGNvbnN0IHsgZGF0YTogc2F2ZWRMZXNzb24sIGVycm9yOiBzYXZlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKFwibGVzc29uc1wiKVxuICAgICAgICAuaW5zZXJ0KHtcbiAgICAgICAgICB0dXRvcl9pZDogdXNlci5pZCxcbiAgICAgICAgICB0aXRsZTogYCR7bGVzc29uVHlwZX0gTGVzc29uIC0gJHtuZXcgRGF0ZSgpLnRvTG9jYWxlRGF0ZVN0cmluZygpfWAsXG4gICAgICAgICAgbGVzc29uX3R5cGU6IGxlc3NvblR5cGUsXG4gICAgICAgICAgc3R1ZGVudF9sZXZlbDogc3R1ZGVudExldmVsLFxuICAgICAgICAgIHRhcmdldF9sYW5ndWFnZTogdGFyZ2V0TGFuZ3VhZ2UsXG4gICAgICAgICAgc291cmNlX3VybDogc291cmNlVXJsLFxuICAgICAgICAgIHNvdXJjZV90ZXh0OiBzb3VyY2VUZXh0LFxuICAgICAgICAgIGxlc3Nvbl9kYXRhOiBmaW5hbExlc3NvbixcbiAgICAgICAgfSlcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKVxuXG4gICAgICBpZiAoc2F2ZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBzYXZpbmcgbGVzc29uOlwiLCBzYXZlRXJyb3IpXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGxlc3NvbjogZmluYWxMZXNzb24gfSlcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgbGVzc29uOiB7XG4gICAgICAgICAgLi4uZmluYWxMZXNzb24sXG4gICAgICAgICAgaWQ6IHNhdmVkTGVzc29uLmlkLFxuICAgICAgICB9LFxuICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyBPbmx5IHVzZSBmYWxsYmFjayBpZiBBSSBnZW5lcmF0aW9uIGNvbXBsZXRlbHkgZmFpbGVkXG4gICAgY29uc29sZS53YXJuKFwi4pqg77iPIEFJIGdlbmVyYXRpb24gZmFpbGVkLCB1c2luZyBmYWxsYmFjayBsZXNzb24gc3RydWN0dXJlXCIpXG4gICAgY29uc3Qgc2FmZUxlc3NvbiA9IHtcbiAgICAgIGxlc3NvblR5cGU6IGxlc3NvblR5cGUsXG4gICAgICBzdHVkZW50TGV2ZWw6IHN0dWRlbnRMZXZlbCxcbiAgICAgIHRhcmdldExhbmd1YWdlOiB0YXJnZXRMYW5ndWFnZSxcbiAgICAgIHNlY3Rpb25zOiB7XG4gICAgICAgIHdhcm11cDogW1wiV2hhdCBkbyB5b3UgYWxyZWFkeSBrbm93IGFib3V0IHRoaXMgdG9waWM/XCIsIFwiSGF2ZSB5b3UgaGFkIHNpbWlsYXIgZXhwZXJpZW5jZXM/XCIsIFwiV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBsZWFybiBtb3JlIGFib3V0P1wiXSxcbiAgICAgICAgdm9jYWJ1bGFyeTogW10sXG4gICAgICAgIHJlYWRpbmc6IHNvdXJjZVRleHQuc3Vic3RyaW5nKDAsIDUwMCksXG4gICAgICAgIGNvbXByZWhlbnNpb246IFtcIldoYXQgaXMgdGhlIG1haW4gaWRlYSBvZiB0aGlzIHRleHQ/XCIsIFwiV2hhdCBzdXBwb3J0aW5nIGRldGFpbHMgY2FuIHlvdSBpZGVudGlmeT9cIl0sXG4gICAgICAgIGRpc2N1c3Npb246IFtcIldoYXQgaXMgeW91ciBvcGluaW9uIG9uIHRoaXMgdG9waWM/XCIsIFwiSG93IHdvdWxkIHlvdSBoYW5kbGUgdGhpcyBzaXR1YXRpb24/XCJdLFxuICAgICAgICBncmFtbWFyOiB7XG4gICAgICAgICAgZm9jdXM6IFwiUHJlc2VudCBQZXJmZWN0IFRlbnNlXCIsXG4gICAgICAgICAgZXhhbXBsZXM6IFtcIkkgaGF2ZSBsZWFybmVkIG1hbnkgbmV3IHRoaW5ncy5cIiwgXCJTaGUgaGFzIGltcHJvdmVkIGhlciBza2lsbHMuXCJdLFxuICAgICAgICAgIGV4ZXJjaXNlOiBbXCJJIF9fX19fIChsZWFybikgYSBsb3QgdG9kYXkuXCIsIFwiVGhleSBfX19fXyAoY29tcGxldGUpIHRoZSBwcm9qZWN0LlwiXVxuICAgICAgICB9LFxuICAgICAgICBwcm9udW5jaWF0aW9uOiB7XG4gICAgICAgICAgd29yZDogXCJjb21tdW5pY2F0aW9uXCIsXG4gICAgICAgICAgaXBhOiBcIi9ryZnLjG1qdcuQbsmqy4hrZcmqyoPJmW4vXCIsXG4gICAgICAgICAgcHJhY3RpY2U6IFwiUHJhY3RpY2Ugc2F5aW5nOiBjb21tdW5pY2F0aW9uIGluIGEgc2VudGVuY2UuXCJcbiAgICAgICAgfSxcbiAgICAgICAgd3JhcHVwOiBbXCJXaGF0IG5ldyB2b2NhYnVsYXJ5IGRpZCB5b3UgbGVhcm4/XCIsIFwiV2hpY2ggY29uY2VwdHMgbmVlZCBtb3JlIHByYWN0aWNlP1wiXVxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKFwi4pyFIFVzaW5nIGZhbGxiYWNrIGxlc3NvbiBzdHJ1Y3R1cmVcIilcblxuICAgIC8vIFNhdmUgZmFsbGJhY2sgbGVzc29uIHRvIGRhdGFiYXNlXG4gICAgY29uc3QgeyBkYXRhOiBzYXZlZExlc3NvbiwgZXJyb3I6IHNhdmVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKFwibGVzc29uc1wiKVxuICAgICAgLmluc2VydCh7XG4gICAgICAgIHR1dG9yX2lkOiB1c2VyLmlkLFxuICAgICAgICB0aXRsZTogYCR7bGVzc29uVHlwZX0gTGVzc29uIC0gJHtuZXcgRGF0ZSgpLnRvTG9jYWxlRGF0ZVN0cmluZygpfWAsXG4gICAgICAgIGxlc3Nvbl90eXBlOiBsZXNzb25UeXBlLFxuICAgICAgICBzdHVkZW50X2xldmVsOiBzdHVkZW50TGV2ZWwsXG4gICAgICAgIHRhcmdldF9sYW5ndWFnZTogdGFyZ2V0TGFuZ3VhZ2UsXG4gICAgICAgIHNvdXJjZV91cmw6IHNvdXJjZVVybCxcbiAgICAgICAgc291cmNlX3RleHQ6IHNvdXJjZVRleHQsXG4gICAgICAgIGxlc3Nvbl9kYXRhOiBzYWZlTGVzc29uLFxuICAgICAgfSlcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoc2F2ZUVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc2F2aW5nIGxlc3NvbjpcIiwgc2F2ZUVycm9yKVxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgbGVzc29uOiBzYWZlTGVzc29uIH0pXG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIGxlc3Nvbjoge1xuICAgICAgICAuLi5zYWZlTGVzc29uLFxuICAgICAgICBpZDogc2F2ZWRMZXNzb24uaWQsXG4gICAgICB9LFxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGdlbmVyYXRpbmcgbGVzc29uOlwiLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJGYWlsZWQgdG8gZ2VuZXJhdGUgbGVzc29uXCIgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwibGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3IiLCJjcmVhdGVTZXJ2ZXJTdXBhYmFzZUNsaWVudCIsIlBPU1QiLCJyZXF1ZXN0IiwiYm9keSIsImpzb24iLCJzb3VyY2VUZXh0IiwibGVzc29uVHlwZSIsInN0dWRlbnRMZXZlbCIsInRhcmdldExhbmd1YWdlIiwic291cmNlVXJsIiwiY29udGVudE1ldGFkYXRhIiwic3RydWN0dXJlZENvbnRlbnQiLCJ3b3JkQ291bnQiLCJyZWFkaW5nVGltZSIsImVycm9yIiwic3RhdHVzIiwic3VwYWJhc2UiLCJkYXRhIiwidXNlciIsImF1dGhFcnJvciIsImF1dGgiLCJnZXRVc2VyIiwibGVzc29uIiwiZ2VuZXJhdGVMZXNzb24iLCJjb25zb2xlIiwibG9nIiwiaGFzTGVzc29uIiwiaGFzU2VjdGlvbnMiLCJzZWN0aW9ucyIsInNlY3Rpb25LZXlzIiwiT2JqZWN0Iiwia2V5cyIsIndhcm11cFF1ZXN0aW9ucyIsIndhcm11cCIsImxlbmd0aCIsInZvY2FidWxhcnlJdGVtcyIsInZvY2FidWxhcnkiLCJmaW5hbExlc3NvbiIsInNhdmVkTGVzc29uIiwic2F2ZUVycm9yIiwiZnJvbSIsImluc2VydCIsInR1dG9yX2lkIiwiaWQiLCJ0aXRsZSIsIkRhdGUiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJsZXNzb25fdHlwZSIsInN0dWRlbnRfbGV2ZWwiLCJ0YXJnZXRfbGFuZ3VhZ2UiLCJzb3VyY2VfdXJsIiwic291cmNlX3RleHQiLCJsZXNzb25fZGF0YSIsInNlbGVjdCIsInNpbmdsZSIsIndhcm4iLCJzYWZlTGVzc29uIiwicmVhZGluZyIsInN1YnN0cmluZyIsImNvbXByZWhlbnNpb24iLCJkaXNjdXNzaW9uIiwiZ3JhbW1hciIsImZvY3VzIiwiZXhhbXBsZXMiLCJleGVyY2lzZSIsInByb251bmNpYXRpb24iLCJ3b3JkIiwiaXBhIiwicHJhY3RpY2UiLCJ3cmFwdXAiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/generate-lesson/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/google-ai-server.ts":
/*!*********************************!*\
  !*** ./lib/google-ai-server.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createGoogleAIServerService: () => (/* binding */ createGoogleAIServerService)\n/* harmony export */ });\n// Server-side Google AI (Gemini) APIs service layer\nclass GoogleAIServerService {\n    constructor(config){\n        this.model = \"models/gemini-2.5-flash\" // Use actual available model\n        ;\n        this.config = config;\n    }\n    async makeGeminiRequest(prompt, options = {}) {\n        // Use only the working model\n        const modelsToTry = [\n            \"models/gemini-2.5-flash\"\n        ];\n        const possibleUrls = [];\n        // Generate URLs for different combinations\n        for (const model of modelsToTry){\n            possibleUrls.push(`${this.config.baseUrl}/v1beta/models/${model}:generateContent?key=${this.config.apiKey}`);\n            possibleUrls.push(`${this.config.baseUrl}/v1/models/${model}:generateContent?key=${this.config.apiKey}`);\n        }\n        const requestBody = {\n            contents: [\n                {\n                    parts: [\n                        {\n                            text: prompt\n                        }\n                    ]\n                }\n            ],\n            generationConfig: {\n                temperature: options.temperature || 0.7,\n                maxOutputTokens: options.maxTokens || 2000,\n                topP: options.topP || 0.9\n            }\n        };\n        console.log(\"\\uD83D\\uDD17 Using working Gemini API endpoint...\");\n        // Use only the working endpoint\n        const url = `${this.config.baseUrl}/v1beta/models/gemini-2.5-flash:generateContent?key=${this.config.apiKey}`;\n        console.log(`🌐 API URL: ${url.replace(this.config.apiKey, \"API_KEY_HIDDEN\")}`);\n        try {\n            const response = await fetch(url, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(requestBody)\n            });\n            console.log(`📡 Response status: ${response.status} ${response.statusText}`);\n            if (response.ok) {\n                const result = await response.json();\n                console.log(\"✅ Successful API response received\");\n                console.log(\"\\uD83D\\uDD0D Full API response structure:\", JSON.stringify(result, null, 2));\n                // More robust response parsing with MAX_TOKENS handling\n                if (result.candidates && result.candidates.length > 0) {\n                    const candidate = result.candidates[0];\n                    // Check if we hit MAX_TOKENS limit\n                    if (candidate.finishReason === \"MAX_TOKENS\") {\n                        console.warn(\"⚠️ Hit MAX_TOKENS limit, response may be incomplete\");\n                        // Still try to extract partial content if available\n                        if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {\n                            const text = candidate.content.parts[0].text;\n                            console.log(\"⚠️ Extracted partial text due to MAX_TOKENS:\", text.substring(0, 100) + \"...\");\n                            return text;\n                        } else {\n                            console.warn(\"❌ MAX_TOKENS hit and no content available\");\n                            throw new Error(\"API response hit token limit with no usable content\");\n                        }\n                    }\n                    // Normal response processing\n                    if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {\n                        const text = candidate.content.parts[0].text;\n                        console.log(\"✅ Extracted text:\", text);\n                        return text;\n                    } else {\n                        console.warn(\"⚠️ Invalid content structure in candidate:\", candidate);\n                        throw new Error(\"Invalid content structure in API response\");\n                    }\n                } else {\n                    console.warn(\"⚠️ No candidates in response:\", result);\n                    throw new Error(\"No candidates in API response\");\n                }\n            } else {\n                const errorText = await response.text();\n                console.error(`❌ API call failed:`, response.status, errorText);\n                throw new Error(`Gemini API error: ${response.status} ${response.statusText} - ${errorText}`);\n            }\n        } catch (error) {\n            console.error(`❌ API call exception:`, error.message);\n            throw error;\n        }\n    }\n    async summarize(text, options = {}) {\n        const summaryType = options.type || \"key-points\";\n        const length = options.length || \"medium\";\n        const lengthInstructions = {\n            short: \"in 2-3 sentences\",\n            medium: \"in 4-6 sentences\",\n            long: \"in 7-10 sentences\"\n        };\n        const typeInstructions = {\n            \"key-points\": \"Extract and summarize the key points\",\n            \"tl-dr\": \"Create a TL;DR summary\",\n            \"teaser\": \"Write an engaging teaser summary\",\n            \"headline\": \"Create a headline-style summary\"\n        };\n        const prompt = `${typeInstructions[summaryType]} of the following text ${lengthInstructions[length]}:\n\n${text}\n\nSummary:`;\n        try {\n            return await this.makeGeminiRequest(prompt, {\n                temperature: 0.3\n            });\n        } catch (error) {\n            console.error(\"Summarization failed:\", error);\n            // Fallback to simple truncation\n            return text.substring(0, 500) + \"...\";\n        }\n    }\n    async translate(text, options) {\n        const targetLang = this.getLanguageName(options.targetLanguage);\n        const prompt = `Translate the following text to ${targetLang}. Maintain the original meaning and tone:\n\n${text}\n\nTranslation:`;\n        try {\n            return await this.makeGeminiRequest(prompt, {\n                temperature: 0.2\n            });\n        } catch (error) {\n            console.error(\"Translation failed:\", error);\n            // Return original text if translation fails\n            return text;\n        }\n    }\n    async prompt(prompt, options = {}) {\n        try {\n            return await this.makeGeminiRequest(prompt, options);\n        } catch (error) {\n            console.error(\"Prompt generation failed:\", error);\n            throw error;\n        }\n    }\n    async write(prompt, options = {}) {\n        const tone = options.tone || \"casual\";\n        const length = options.length || \"medium\";\n        const format = options.format || \"paragraph\";\n        const lengthInstructions = {\n            short: \"Keep it brief and concise\",\n            medium: \"Write a moderate length response\",\n            long: \"Provide a detailed and comprehensive response\"\n        };\n        const formatInstructions = {\n            paragraph: \"Write in paragraph form\",\n            \"bullet-points\": \"Format as bullet points\",\n            \"numbered-list\": \"Format as a numbered list\"\n        };\n        const enhancedPrompt = `${prompt}\n\nInstructions:\n- Tone: ${tone}\n- ${lengthInstructions[length]}\n- ${formatInstructions[format]}\n\nResponse:`;\n        try {\n            return await this.makeGeminiRequest(enhancedPrompt, {\n                temperature: 0.7\n            });\n        } catch (error) {\n            console.error(\"Writing failed:\", error);\n            throw error;\n        }\n    }\n    async rewrite(text, options = {}) {\n        const tone = options.tone || \"casual\";\n        const length = options.length || \"same\";\n        const audience = options.audience || \"general\";\n        const lengthInstructions = {\n            shorter: \"Make it more concise\",\n            longer: \"Expand and add more detail\",\n            same: \"Keep approximately the same length\"\n        };\n        const prompt = `Rewrite the following text with these requirements:\n- Tone: ${tone}\n- Audience: ${audience}\n- Length: ${lengthInstructions[length]}\n\nOriginal text:\n${text}\n\nRewritten text:`;\n        try {\n            return await this.makeGeminiRequest(prompt, {\n                temperature: 0.5\n            });\n        } catch (error) {\n            console.error(\"Rewriting failed:\", error);\n            return text // Return original if rewriting fails\n            ;\n        }\n    }\n    async proofread(text, options = {}) {\n        const checkGrammar = options.checkGrammar !== false;\n        const checkSpelling = options.checkSpelling !== false;\n        const checkStyle = options.checkStyle !== false;\n        const checks = [];\n        if (checkGrammar) checks.push(\"grammar\");\n        if (checkSpelling) checks.push(\"spelling\");\n        if (checkStyle) checks.push(\"style and clarity\");\n        const prompt = `Proofread and correct the following text for ${checks.join(\", \")}. Return only the corrected text:\n\n${text}\n\nCorrected text:`;\n        try {\n            const correctedText = await this.makeGeminiRequest(prompt, {\n                temperature: 0.2\n            });\n            return {\n                corrected_text: correctedText,\n                suggestions: [],\n                errors: []\n            };\n        } catch (error) {\n            console.error(\"Proofreading failed:\", error);\n            return {\n                corrected_text: text,\n                suggestions: [],\n                errors: []\n            };\n        }\n    }\n    getLanguageName(code) {\n        const languageMap = {\n            es: \"Spanish\",\n            fr: \"French\",\n            de: \"German\",\n            it: \"Italian\",\n            pt: \"Portuguese\",\n            ja: \"Japanese\",\n            ko: \"Korean\",\n            zh: \"Chinese\",\n            en: \"English\"\n        };\n        return languageMap[code] || \"English\";\n    }\n}\n// Server-side only initialization\nconst createGoogleAIServerService = ()=>{\n    const apiKey = \"AIzaSyAkDCpwWTPKYftoc1Fdm77P6B00Lj89Lio\";\n    const baseUrl = \"https://generativelanguage.googleapis.com\" || 0;\n    if (!apiKey) {\n        console.warn(\"Google AI API key not found. Lesson generation will use fallback templates.\");\n        // Return a service that will always throw errors, triggering fallbacks\n        return new GoogleAIServerService({\n            apiKey: \"dummy\",\n            baseUrl\n        });\n    }\n    return new GoogleAIServerService({\n        apiKey,\n        baseUrl\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O1lBQ1o7UUFDRjtJQUNGO0lBRVF0QixnQkFBZ0J1QixJQUFZLEVBQVU7UUFDNUMsTUFBTUMsY0FBYztZQUNsQkMsSUFBSTtZQUNKQyxJQUFJO1lBQ0pDLElBQUk7WUFDSkMsSUFBSTtZQUNKQyxJQUFJO1lBQ0pDLElBQUk7WUFDSkMsSUFBSTtZQUNKQyxJQUFJO1lBQ0pDLElBQUk7UUFDTjtRQUNBLE9BQU9ULFdBQVcsQ0FBQ0QsS0FBSyxJQUFJO0lBQzlCO0FBQ0Y7QUFFQSxrQ0FBa0M7QUFDM0IsTUFBTVcsOEJBQThCO0lBQ3pDLE1BQU1qRixTQUFTa0YseUNBQXlDO0lBQ3hELE1BQU1uRixVQUFVbUYsMkNBQTBDLElBQUksQ0FBMkM7SUFFekcsSUFBSSxDQUFDbEYsUUFBUTtRQUNYVSxRQUFRb0IsSUFBSSxDQUFDO1FBQ2IsdUVBQXVFO1FBQ3ZFLE9BQU8sSUFBSXpDLHNCQUFzQjtZQUFFVyxRQUFRO1lBQVNEO1FBQVE7SUFDOUQ7SUFFQSxPQUFPLElBQUlWLHNCQUFzQjtRQUFFVztRQUFRRDtJQUFRO0FBQ3JELEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL2dvb2dsZS1haS1zZXJ2ZXIudHM/NTJkNiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTZXJ2ZXItc2lkZSBHb29nbGUgQUkgKEdlbWluaSkgQVBJcyBzZXJ2aWNlIGxheWVyXG5pbnRlcmZhY2UgR29vZ2xlQUlDb25maWcge1xuICBhcGlLZXk6IHN0cmluZ1xuICBiYXNlVXJsOiBzdHJpbmdcbn1cblxuaW50ZXJmYWNlIFN1bW1hcml6ZXJPcHRpb25zIHtcbiAgdHlwZT86IFwia2V5LXBvaW50c1wiIHwgXCJ0bC1kclwiIHwgXCJ0ZWFzZXJcIiB8IFwiaGVhZGxpbmVcIlxuICBsZW5ndGg/OiBcInNob3J0XCIgfCBcIm1lZGl1bVwiIHwgXCJsb25nXCJcbiAgZm9ybWF0PzogXCJtYXJrZG93blwiIHwgXCJwbGFpbi10ZXh0XCJcbn1cblxuaW50ZXJmYWNlIFRyYW5zbGF0b3JPcHRpb25zIHtcbiAgc291cmNlTGFuZ3VhZ2U/OiBzdHJpbmdcbiAgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgUHJvbXB0T3B0aW9ucyB7XG4gIHRlbXBlcmF0dXJlPzogbnVtYmVyXG4gIG1heFRva2Vucz86IG51bWJlclxuICB0b3BQPzogbnVtYmVyXG59XG5cbmludGVyZmFjZSBXcml0ZXJPcHRpb25zIHtcbiAgdG9uZT86IFwiZm9ybWFsXCIgfCBcImNhc3VhbFwiIHwgXCJhY2FkZW1pY1wiIHwgXCJjcmVhdGl2ZVwiXG4gIGxlbmd0aD86IFwic2hvcnRcIiB8IFwibWVkaXVtXCIgfCBcImxvbmdcIlxuICBmb3JtYXQ/OiBcInBhcmFncmFwaFwiIHwgXCJidWxsZXQtcG9pbnRzXCIgfCBcIm51bWJlcmVkLWxpc3RcIlxufVxuXG5pbnRlcmZhY2UgUmV3cml0ZXJPcHRpb25zIHtcbiAgdG9uZT86IFwiZm9ybWFsXCIgfCBcImNhc3VhbFwiIHwgXCJhY2FkZW1pY1wiIHwgXCJjcmVhdGl2ZVwiXG4gIGxlbmd0aD86IFwic2hvcnRlclwiIHwgXCJsb25nZXJcIiB8IFwic2FtZVwiXG4gIGF1ZGllbmNlPzogXCJnZW5lcmFsXCIgfCBcImV4cGVydFwiIHwgXCJiZWdpbm5lclwiXG59XG5cbmludGVyZmFjZSBQcm9vZnJlYWRlck9wdGlvbnMge1xuICBjaGVja0dyYW1tYXI/OiBib29sZWFuXG4gIGNoZWNrU3BlbGxpbmc/OiBib29sZWFuXG4gIGNoZWNrU3R5bGU/OiBib29sZWFuXG4gIHN1Z2dlc3RJbXByb3ZlbWVudHM/OiBib29sZWFuXG59XG5cbmNsYXNzIEdvb2dsZUFJU2VydmVyU2VydmljZSB7XG4gIHByaXZhdGUgY29uZmlnOiBHb29nbGVBSUNvbmZpZ1xuICBwcml2YXRlIG1vZGVsOiBzdHJpbmcgPSBcIm1vZGVscy9nZW1pbmktMi41LWZsYXNoXCIgLy8gVXNlIGFjdHVhbCBhdmFpbGFibGUgbW9kZWxcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IEdvb2dsZUFJQ29uZmlnKSB7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWdcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgbWFrZUdlbWluaVJlcXVlc3QocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM6IGFueSA9IHt9KSB7XG4gICAgLy8gVXNlIG9ubHkgdGhlIHdvcmtpbmcgbW9kZWxcbiAgICBjb25zdCBtb2RlbHNUb1RyeSA9IFtcbiAgICAgICdtb2RlbHMvZ2VtaW5pLTIuNS1mbGFzaCdcbiAgICBdXG4gICAgXG4gICAgY29uc3QgcG9zc2libGVVcmxzID0gW11cbiAgICBcbiAgICAvLyBHZW5lcmF0ZSBVUkxzIGZvciBkaWZmZXJlbnQgY29tYmluYXRpb25zXG4gICAgZm9yIChjb25zdCBtb2RlbCBvZiBtb2RlbHNUb1RyeSkge1xuICAgICAgcG9zc2libGVVcmxzLnB1c2goYCR7dGhpcy5jb25maWcuYmFzZVVybH0vdjFiZXRhL21vZGVscy8ke21vZGVsfTpnZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7dGhpcy5jb25maWcuYXBpS2V5fWApXG4gICAgICBwb3NzaWJsZVVybHMucHVzaChgJHt0aGlzLmNvbmZpZy5iYXNlVXJsfS92MS9tb2RlbHMvJHttb2RlbH06Z2VuZXJhdGVDb250ZW50P2tleT0ke3RoaXMuY29uZmlnLmFwaUtleX1gKVxuICAgIH1cbiAgICBcbiAgICBjb25zdCByZXF1ZXN0Qm9keSA9IHtcbiAgICAgIGNvbnRlbnRzOiBbe1xuICAgICAgICBwYXJ0czogW3tcbiAgICAgICAgICB0ZXh0OiBwcm9tcHRcbiAgICAgICAgfV1cbiAgICAgIH1dLFxuICAgICAgZ2VuZXJhdGlvbkNvbmZpZzoge1xuICAgICAgICB0ZW1wZXJhdHVyZTogb3B0aW9ucy50ZW1wZXJhdHVyZSB8fCAwLjcsXG4gICAgICAgIG1heE91dHB1dFRva2Vuczogb3B0aW9ucy5tYXhUb2tlbnMgfHwgMjAwMCwgLy8gSW5jcmVhc2VkIGZyb20gMTAwMCB0byAyMDAwXG4gICAgICAgIHRvcFA6IG9wdGlvbnMudG9wUCB8fCAwLjksXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coXCLwn5SXIFVzaW5nIHdvcmtpbmcgR2VtaW5pIEFQSSBlbmRwb2ludC4uLlwiKVxuXG4gICAgLy8gVXNlIG9ubHkgdGhlIHdvcmtpbmcgZW5kcG9pbnRcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmNvbmZpZy5iYXNlVXJsfS92MWJldGEvbW9kZWxzL2dlbWluaS0yLjUtZmxhc2g6Z2VuZXJhdGVDb250ZW50P2tleT0ke3RoaXMuY29uZmlnLmFwaUtleX1gXG4gICAgY29uc29sZS5sb2coYPCfjJAgQVBJIFVSTDogJHt1cmwucmVwbGFjZSh0aGlzLmNvbmZpZy5hcGlLZXksICdBUElfS0VZX0hJRERFTicpfWApXG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpLFxuICAgICAgfSlcblxuICAgICAgY29uc29sZS5sb2coYPCfk6EgUmVzcG9uc2Ugc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApXG5cbiAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgICAgY29uc29sZS5sb2coXCLinIUgU3VjY2Vzc2Z1bCBBUEkgcmVzcG9uc2UgcmVjZWl2ZWRcIilcbiAgICAgICAgY29uc29sZS5sb2coXCLwn5SNIEZ1bGwgQVBJIHJlc3BvbnNlIHN0cnVjdHVyZTpcIiwgSlNPTi5zdHJpbmdpZnkocmVzdWx0LCBudWxsLCAyKSlcbiAgICAgICAgXG4gICAgICAgIC8vIE1vcmUgcm9idXN0IHJlc3BvbnNlIHBhcnNpbmcgd2l0aCBNQVhfVE9LRU5TIGhhbmRsaW5nXG4gICAgICAgIGlmIChyZXN1bHQuY2FuZGlkYXRlcyAmJiByZXN1bHQuY2FuZGlkYXRlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc3QgY2FuZGlkYXRlID0gcmVzdWx0LmNhbmRpZGF0ZXNbMF1cbiAgICAgICAgICBcbiAgICAgICAgICAvLyBDaGVjayBpZiB3ZSBoaXQgTUFYX1RPS0VOUyBsaW1pdFxuICAgICAgICAgIGlmIChjYW5kaWRhdGUuZmluaXNoUmVhc29uID09PSBcIk1BWF9UT0tFTlNcIikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEhpdCBNQVhfVE9LRU5TIGxpbWl0LCByZXNwb25zZSBtYXkgYmUgaW5jb21wbGV0ZVwiKVxuICAgICAgICAgICAgLy8gU3RpbGwgdHJ5IHRvIGV4dHJhY3QgcGFydGlhbCBjb250ZW50IGlmIGF2YWlsYWJsZVxuICAgICAgICAgICAgaWYgKGNhbmRpZGF0ZS5jb250ZW50ICYmIGNhbmRpZGF0ZS5jb250ZW50LnBhcnRzICYmIGNhbmRpZGF0ZS5jb250ZW50LnBhcnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGNhbmRpZGF0ZS5jb250ZW50LnBhcnRzWzBdLnRleHRcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLimqDvuI8gRXh0cmFjdGVkIHBhcnRpYWwgdGV4dCBkdWUgdG8gTUFYX1RPS0VOUzpcIiwgdGV4dC5zdWJzdHJpbmcoMCwgMTAwKSArIFwiLi4uXCIpXG4gICAgICAgICAgICAgIHJldHVybiB0ZXh0XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCLinYwgTUFYX1RPS0VOUyBoaXQgYW5kIG5vIGNvbnRlbnQgYXZhaWxhYmxlXCIpXG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFQSSByZXNwb25zZSBoaXQgdG9rZW4gbGltaXQgd2l0aCBubyB1c2FibGUgY29udGVudFwiKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICAvLyBOb3JtYWwgcmVzcG9uc2UgcHJvY2Vzc2luZ1xuICAgICAgICAgIGlmIChjYW5kaWRhdGUuY29udGVudCAmJiBjYW5kaWRhdGUuY29udGVudC5wYXJ0cyAmJiBjYW5kaWRhdGUuY29udGVudC5wYXJ0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gY2FuZGlkYXRlLmNvbnRlbnQucGFydHNbMF0udGV4dFxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLinIUgRXh0cmFjdGVkIHRleHQ6XCIsIHRleHQpXG4gICAgICAgICAgICByZXR1cm4gdGV4dFxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCLimqDvuI8gSW52YWxpZCBjb250ZW50IHN0cnVjdHVyZSBpbiBjYW5kaWRhdGU6XCIsIGNhbmRpZGF0ZSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgY29udGVudCBzdHJ1Y3R1cmUgaW4gQVBJIHJlc3BvbnNlXCIpXG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBObyBjYW5kaWRhdGVzIGluIHJlc3BvbnNlOlwiLCByZXN1bHQpXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gY2FuZGlkYXRlcyBpbiBBUEkgcmVzcG9uc2VcIilcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgZXJyb3JUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBBUEkgY2FsbCBmYWlsZWQ6YCwgcmVzcG9uc2Uuc3RhdHVzLCBlcnJvclRleHQpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgR2VtaW5pIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH0gLSAke2Vycm9yVGV4dH1gKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGDinYwgQVBJIGNhbGwgZXhjZXB0aW9uOmAsIGVycm9yLm1lc3NhZ2UpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHN1bW1hcml6ZSh0ZXh0OiBzdHJpbmcsIG9wdGlvbnM6IFN1bW1hcml6ZXJPcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBzdW1tYXJ5VHlwZSA9IG9wdGlvbnMudHlwZSB8fCBcImtleS1wb2ludHNcIlxuICAgIGNvbnN0IGxlbmd0aCA9IG9wdGlvbnMubGVuZ3RoIHx8IFwibWVkaXVtXCJcbiAgICBcbiAgICBjb25zdCBsZW5ndGhJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBzaG9ydDogXCJpbiAyLTMgc2VudGVuY2VzXCIsXG4gICAgICBtZWRpdW06IFwiaW4gNC02IHNlbnRlbmNlc1wiLCBcbiAgICAgIGxvbmc6IFwiaW4gNy0xMCBzZW50ZW5jZXNcIlxuICAgIH1cblxuICAgIGNvbnN0IHR5cGVJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBcImtleS1wb2ludHNcIjogXCJFeHRyYWN0IGFuZCBzdW1tYXJpemUgdGhlIGtleSBwb2ludHNcIixcbiAgICAgIFwidGwtZHJcIjogXCJDcmVhdGUgYSBUTDtEUiBzdW1tYXJ5XCIsXG4gICAgICBcInRlYXNlclwiOiBcIldyaXRlIGFuIGVuZ2FnaW5nIHRlYXNlciBzdW1tYXJ5XCIsXG4gICAgICBcImhlYWRsaW5lXCI6IFwiQ3JlYXRlIGEgaGVhZGxpbmUtc3R5bGUgc3VtbWFyeVwiXG4gICAgfVxuXG4gICAgY29uc3QgcHJvbXB0ID0gYCR7dHlwZUluc3RydWN0aW9uc1tzdW1tYXJ5VHlwZV19IG9mIHRoZSBmb2xsb3dpbmcgdGV4dCAke2xlbmd0aEluc3RydWN0aW9uc1tsZW5ndGhdfTpcblxuJHt0ZXh0fVxuXG5TdW1tYXJ5OmBcblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYWtlR2VtaW5pUmVxdWVzdChwcm9tcHQsIHsgdGVtcGVyYXR1cmU6IDAuMyB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiU3VtbWFyaXphdGlvbiBmYWlsZWQ6XCIsIGVycm9yKVxuICAgICAgLy8gRmFsbGJhY2sgdG8gc2ltcGxlIHRydW5jYXRpb25cbiAgICAgIHJldHVybiB0ZXh0LnN1YnN0cmluZygwLCA1MDApICsgXCIuLi5cIlxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHRyYW5zbGF0ZSh0ZXh0OiBzdHJpbmcsIG9wdGlvbnM6IFRyYW5zbGF0b3JPcHRpb25zKSB7XG4gICAgY29uc3QgdGFyZ2V0TGFuZyA9IHRoaXMuZ2V0TGFuZ3VhZ2VOYW1lKG9wdGlvbnMudGFyZ2V0TGFuZ3VhZ2UpXG4gICAgXG4gICAgY29uc3QgcHJvbXB0ID0gYFRyYW5zbGF0ZSB0aGUgZm9sbG93aW5nIHRleHQgdG8gJHt0YXJnZXRMYW5nfS4gTWFpbnRhaW4gdGhlIG9yaWdpbmFsIG1lYW5pbmcgYW5kIHRvbmU6XG5cbiR7dGV4dH1cblxuVHJhbnNsYXRpb246YFxuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLm1ha2VHZW1pbmlSZXF1ZXN0KHByb21wdCwgeyB0ZW1wZXJhdHVyZTogMC4yIH0pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJUcmFuc2xhdGlvbiBmYWlsZWQ6XCIsIGVycm9yKVxuICAgICAgLy8gUmV0dXJuIG9yaWdpbmFsIHRleHQgaWYgdHJhbnNsYXRpb24gZmFpbHNcbiAgICAgIHJldHVybiB0ZXh0XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcHJvbXB0KHByb21wdDogc3RyaW5nLCBvcHRpb25zOiBQcm9tcHRPcHRpb25zID0ge30pIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMubWFrZUdlbWluaVJlcXVlc3QocHJvbXB0LCBvcHRpb25zKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiUHJvbXB0IGdlbmVyYXRpb24gZmFpbGVkOlwiLCBlcnJvcilcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgd3JpdGUocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM6IFdyaXRlck9wdGlvbnMgPSB7fSkge1xuICAgIGNvbnN0IHRvbmUgPSBvcHRpb25zLnRvbmUgfHwgXCJjYXN1YWxcIlxuICAgIGNvbnN0IGxlbmd0aCA9IG9wdGlvbnMubGVuZ3RoIHx8IFwibWVkaXVtXCJcbiAgICBjb25zdCBmb3JtYXQgPSBvcHRpb25zLmZvcm1hdCB8fCBcInBhcmFncmFwaFwiXG5cbiAgICBjb25zdCBsZW5ndGhJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBzaG9ydDogXCJLZWVwIGl0IGJyaWVmIGFuZCBjb25jaXNlXCIsXG4gICAgICBtZWRpdW06IFwiV3JpdGUgYSBtb2RlcmF0ZSBsZW5ndGggcmVzcG9uc2VcIixcbiAgICAgIGxvbmc6IFwiUHJvdmlkZSBhIGRldGFpbGVkIGFuZCBjb21wcmVoZW5zaXZlIHJlc3BvbnNlXCJcbiAgICB9XG5cbiAgICBjb25zdCBmb3JtYXRJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBwYXJhZ3JhcGg6IFwiV3JpdGUgaW4gcGFyYWdyYXBoIGZvcm1cIixcbiAgICAgIFwiYnVsbGV0LXBvaW50c1wiOiBcIkZvcm1hdCBhcyBidWxsZXQgcG9pbnRzXCIsXG4gICAgICBcIm51bWJlcmVkLWxpc3RcIjogXCJGb3JtYXQgYXMgYSBudW1iZXJlZCBsaXN0XCJcbiAgICB9XG5cbiAgICBjb25zdCBlbmhhbmNlZFByb21wdCA9IGAke3Byb21wdH1cblxuSW5zdHJ1Y3Rpb25zOlxuLSBUb25lOiAke3RvbmV9XG4tICR7bGVuZ3RoSW5zdHJ1Y3Rpb25zW2xlbmd0aF19XG4tICR7Zm9ybWF0SW5zdHJ1Y3Rpb25zW2Zvcm1hdF19XG5cblJlc3BvbnNlOmBcblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYWtlR2VtaW5pUmVxdWVzdChlbmhhbmNlZFByb21wdCwgeyB0ZW1wZXJhdHVyZTogMC43IH0pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJXcml0aW5nIGZhaWxlZDpcIiwgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJld3JpdGUodGV4dDogc3RyaW5nLCBvcHRpb25zOiBSZXdyaXRlck9wdGlvbnMgPSB7fSkge1xuICAgIGNvbnN0IHRvbmUgPSBvcHRpb25zLnRvbmUgfHwgXCJjYXN1YWxcIlxuICAgIGNvbnN0IGxlbmd0aCA9IG9wdGlvbnMubGVuZ3RoIHx8IFwic2FtZVwiXG4gICAgY29uc3QgYXVkaWVuY2UgPSBvcHRpb25zLmF1ZGllbmNlIHx8IFwiZ2VuZXJhbFwiXG5cbiAgICBjb25zdCBsZW5ndGhJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBzaG9ydGVyOiBcIk1ha2UgaXQgbW9yZSBjb25jaXNlXCIsXG4gICAgICBsb25nZXI6IFwiRXhwYW5kIGFuZCBhZGQgbW9yZSBkZXRhaWxcIixcbiAgICAgIHNhbWU6IFwiS2VlcCBhcHByb3hpbWF0ZWx5IHRoZSBzYW1lIGxlbmd0aFwiXG4gICAgfVxuXG4gICAgY29uc3QgcHJvbXB0ID0gYFJld3JpdGUgdGhlIGZvbGxvd2luZyB0ZXh0IHdpdGggdGhlc2UgcmVxdWlyZW1lbnRzOlxuLSBUb25lOiAke3RvbmV9XG4tIEF1ZGllbmNlOiAke2F1ZGllbmNlfVxuLSBMZW5ndGg6ICR7bGVuZ3RoSW5zdHJ1Y3Rpb25zW2xlbmd0aF19XG5cbk9yaWdpbmFsIHRleHQ6XG4ke3RleHR9XG5cblJld3JpdHRlbiB0ZXh0OmBcblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYWtlR2VtaW5pUmVxdWVzdChwcm9tcHQsIHsgdGVtcGVyYXR1cmU6IDAuNSB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiUmV3cml0aW5nIGZhaWxlZDpcIiwgZXJyb3IpXG4gICAgICByZXR1cm4gdGV4dCAvLyBSZXR1cm4gb3JpZ2luYWwgaWYgcmV3cml0aW5nIGZhaWxzXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcHJvb2ZyZWFkKHRleHQ6IHN0cmluZywgb3B0aW9uczogUHJvb2ZyZWFkZXJPcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBjaGVja0dyYW1tYXIgPSBvcHRpb25zLmNoZWNrR3JhbW1hciAhPT0gZmFsc2VcbiAgICBjb25zdCBjaGVja1NwZWxsaW5nID0gb3B0aW9ucy5jaGVja1NwZWxsaW5nICE9PSBmYWxzZVxuICAgIGNvbnN0IGNoZWNrU3R5bGUgPSBvcHRpb25zLmNoZWNrU3R5bGUgIT09IGZhbHNlXG5cbiAgICBjb25zdCBjaGVja3MgPSBbXVxuICAgIGlmIChjaGVja0dyYW1tYXIpIGNoZWNrcy5wdXNoKFwiZ3JhbW1hclwiKVxuICAgIGlmIChjaGVja1NwZWxsaW5nKSBjaGVja3MucHVzaChcInNwZWxsaW5nXCIpXG4gICAgaWYgKGNoZWNrU3R5bGUpIGNoZWNrcy5wdXNoKFwic3R5bGUgYW5kIGNsYXJpdHlcIilcblxuICAgIGNvbnN0IHByb21wdCA9IGBQcm9vZnJlYWQgYW5kIGNvcnJlY3QgdGhlIGZvbGxvd2luZyB0ZXh0IGZvciAke2NoZWNrcy5qb2luKFwiLCBcIil9LiBSZXR1cm4gb25seSB0aGUgY29ycmVjdGVkIHRleHQ6XG5cbiR7dGV4dH1cblxuQ29ycmVjdGVkIHRleHQ6YFxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvcnJlY3RlZFRleHQgPSBhd2FpdCB0aGlzLm1ha2VHZW1pbmlSZXF1ZXN0KHByb21wdCwgeyB0ZW1wZXJhdHVyZTogMC4yIH0pXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb3JyZWN0ZWRfdGV4dDogY29ycmVjdGVkVGV4dCxcbiAgICAgICAgc3VnZ2VzdGlvbnM6IFtdLFxuICAgICAgICBlcnJvcnM6IFtdXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJQcm9vZnJlYWRpbmcgZmFpbGVkOlwiLCBlcnJvcilcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvcnJlY3RlZF90ZXh0OiB0ZXh0LFxuICAgICAgICBzdWdnZXN0aW9uczogW10sXG4gICAgICAgIGVycm9yczogW11cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldExhbmd1YWdlTmFtZShjb2RlOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGxhbmd1YWdlTWFwID0ge1xuICAgICAgZXM6IFwiU3BhbmlzaFwiLFxuICAgICAgZnI6IFwiRnJlbmNoXCIsIFxuICAgICAgZGU6IFwiR2VybWFuXCIsXG4gICAgICBpdDogXCJJdGFsaWFuXCIsXG4gICAgICBwdDogXCJQb3J0dWd1ZXNlXCIsXG4gICAgICBqYTogXCJKYXBhbmVzZVwiLFxuICAgICAga286IFwiS29yZWFuXCIsXG4gICAgICB6aDogXCJDaGluZXNlXCIsXG4gICAgICBlbjogXCJFbmdsaXNoXCJcbiAgICB9XG4gICAgcmV0dXJuIGxhbmd1YWdlTWFwW2NvZGVdIHx8IFwiRW5nbGlzaFwiXG4gIH1cbn1cblxuLy8gU2VydmVyLXNpZGUgb25seSBpbml0aWFsaXphdGlvblxuZXhwb3J0IGNvbnN0IGNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZSA9ICgpID0+IHtcbiAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfR09PR0xFX0FJX0FQSV9LRVlcbiAgY29uc3QgYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0dPT0dMRV9BSV9CQVNFX1VSTCB8fCBcImh0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tXCJcblxuICBpZiAoIWFwaUtleSkge1xuICAgIGNvbnNvbGUud2FybihcIkdvb2dsZSBBSSBBUEkga2V5IG5vdCBmb3VuZC4gTGVzc29uIGdlbmVyYXRpb24gd2lsbCB1c2UgZmFsbGJhY2sgdGVtcGxhdGVzLlwiKVxuICAgIC8vIFJldHVybiBhIHNlcnZpY2UgdGhhdCB3aWxsIGFsd2F5cyB0aHJvdyBlcnJvcnMsIHRyaWdnZXJpbmcgZmFsbGJhY2tzXG4gICAgcmV0dXJuIG5ldyBHb29nbGVBSVNlcnZlclNlcnZpY2UoeyBhcGlLZXk6IFwiZHVtbXlcIiwgYmFzZVVybCB9KVxuICB9XG5cbiAgcmV0dXJuIG5ldyBHb29nbGVBSVNlcnZlclNlcnZpY2UoeyBhcGlLZXksIGJhc2VVcmwgfSlcbn1cblxuZXhwb3J0IHR5cGUgeyBTdW1tYXJpemVyT3B0aW9ucywgVHJhbnNsYXRvck9wdGlvbnMsIFByb21wdE9wdGlvbnMsIFdyaXRlck9wdGlvbnMsIFJld3JpdGVyT3B0aW9ucywgUHJvb2ZyZWFkZXJPcHRpb25zIH1cbiJdLCJuYW1lcyI6WyJHb29nbGVBSVNlcnZlclNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImNvbmZpZyIsIm1vZGVsIiwibWFrZUdlbWluaVJlcXVlc3QiLCJwcm9tcHQiLCJvcHRpb25zIiwibW9kZWxzVG9UcnkiLCJwb3NzaWJsZVVybHMiLCJwdXNoIiwiYmFzZVVybCIsImFwaUtleSIsInJlcXVlc3RCb2R5IiwiY29udGVudHMiLCJwYXJ0cyIsInRleHQiLCJnZW5lcmF0aW9uQ29uZmlnIiwidGVtcGVyYXR1cmUiLCJtYXhPdXRwdXRUb2tlbnMiLCJtYXhUb2tlbnMiLCJ0b3BQIiwiY29uc29sZSIsImxvZyIsInVybCIsInJlcGxhY2UiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5Iiwic3RhdHVzIiwic3RhdHVzVGV4dCIsIm9rIiwicmVzdWx0IiwianNvbiIsImNhbmRpZGF0ZXMiLCJsZW5ndGgiLCJjYW5kaWRhdGUiLCJmaW5pc2hSZWFzb24iLCJ3YXJuIiwiY29udGVudCIsInN1YnN0cmluZyIsIkVycm9yIiwiZXJyb3JUZXh0IiwiZXJyb3IiLCJtZXNzYWdlIiwic3VtbWFyaXplIiwic3VtbWFyeVR5cGUiLCJ0eXBlIiwibGVuZ3RoSW5zdHJ1Y3Rpb25zIiwic2hvcnQiLCJtZWRpdW0iLCJsb25nIiwidHlwZUluc3RydWN0aW9ucyIsInRyYW5zbGF0ZSIsInRhcmdldExhbmciLCJnZXRMYW5ndWFnZU5hbWUiLCJ0YXJnZXRMYW5ndWFnZSIsIndyaXRlIiwidG9uZSIsImZvcm1hdCIsImZvcm1hdEluc3RydWN0aW9ucyIsInBhcmFncmFwaCIsImVuaGFuY2VkUHJvbXB0IiwicmV3cml0ZSIsImF1ZGllbmNlIiwic2hvcnRlciIsImxvbmdlciIsInNhbWUiLCJwcm9vZnJlYWQiLCJjaGVja0dyYW1tYXIiLCJjaGVja1NwZWxsaW5nIiwiY2hlY2tTdHlsZSIsImNoZWNrcyIsImpvaW4iLCJjb3JyZWN0ZWRUZXh0IiwiY29ycmVjdGVkX3RleHQiLCJzdWdnZXN0aW9ucyIsImVycm9ycyIsImNvZGUiLCJsYW5ndWFnZU1hcCIsImVzIiwiZnIiLCJkZSIsIml0IiwicHQiLCJqYSIsImtvIiwiemgiLCJlbiIsImNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19HT09HTEVfQUlfQVBJX0tFWSIsIk5FWFRfUFVCTElDX0dPT0dMRV9BSV9CQVNFX1VSTCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/google-ai-server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/lesson-ai-generator-server.ts":
/*!*******************************************!*\
  !*** ./lib/lesson-ai-generator-server.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LessonAIServerGenerator: () => (/* binding */ LessonAIServerGenerator),\n/* harmony export */   lessonAIServerGenerator: () => (/* binding */ lessonAIServerGenerator)\n/* harmony export */ });\n/* harmony import */ var _google_ai_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./google-ai-server */ \"(rsc)/./lib/google-ai-server.ts\");\n\nclass LessonAIServerGenerator {\n    getGoogleAI() {\n        if (!this.googleAI) {\n            this.googleAI = (0,_google_ai_server__WEBPACK_IMPORTED_MODULE_0__.createGoogleAIServerService)();\n        }\n        return this.googleAI;\n    }\n    async generateLesson(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage, sourceUrl, contentMetadata, structuredContent, wordCount, readingTime } = params;\n        console.log(\"\\uD83D\\uDE80 Starting optimized AI lesson generation with params:\", {\n            textLength: sourceText.length,\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            hasMetadata: !!contentMetadata,\n            hasStructuredContent: !!structuredContent\n        });\n        try {\n            // Use ultra-minimal AI approach to avoid MAX_TOKENS\n            console.log(\"\\uD83E\\uDD16 Step 1: Generating lesson with ultra-minimal AI prompts...\");\n            const lessonStructure = await this.generateMinimalAILesson(sourceText, lessonType, studentLevel, targetLanguage, contentMetadata);\n            console.log(\"✅ Minimal AI lesson generated:\", Object.keys(lessonStructure));\n            // Return properly structured GeneratedLesson object\n            const finalLesson = {\n                lessonType,\n                studentLevel,\n                targetLanguage,\n                sections: lessonStructure\n            };\n            console.log(\"\\uD83C\\uDFAF Returning AI-generated lesson:\", {\n                lessonType: finalLesson.lessonType,\n                studentLevel: finalLesson.studentLevel,\n                targetLanguage: finalLesson.targetLanguage,\n                sectionsCount: Object.keys(finalLesson.sections).length,\n                warmupCount: finalLesson.sections.warmup?.length || 0,\n                vocabularyCount: finalLesson.sections.vocabulary?.length || 0\n            });\n            console.log(\"\\uD83C\\uDF89 Optimized AI lesson generation complete!\");\n            return finalLesson;\n        } catch (error) {\n            console.error(\"❌ Error in AI lesson generation:\", error);\n            console.log(\"\\uD83D\\uDD04 Falling back to smart template generation...\");\n            // Fallback to smart templates if AI fails\n            return await this.generateSmartTemplateFallback(params);\n        }\n    }\n    // Ultra-minimal AI lesson generation to avoid MAX_TOKENS\n    async generateMinimalAILesson(sourceText, lessonType, studentLevel, targetLanguage, metadata) {\n        console.log(\"\\uD83C\\uDFAF Using ultra-minimal AI prompts to avoid token limits...\");\n        // Step 1: Generate just the essential parts with minimal prompts\n        const warmupQuestions = await this.generateMinimalWarmup(sourceText, studentLevel);\n        const vocabulary = await this.generateMinimalVocabulary(sourceText, studentLevel);\n        const comprehensionQuestions = await this.generateMinimalComprehension(sourceText, studentLevel);\n        // Step 2: Use hybrid approach - AI for key parts, templates for the rest\n        const vocabularyWords = vocabulary.map((v)=>v.word);\n        const readingPassage = await this.generateSmartReading(sourceText, studentLevel, vocabularyWords);\n        return {\n            warmup: this.addWarmupInstructions(warmupQuestions, studentLevel),\n            vocabulary: this.addVocabularyInstructions(vocabulary, studentLevel),\n            reading: this.addReadingInstructions(readingPassage, studentLevel),\n            comprehension: this.addComprehensionInstructions(comprehensionQuestions, studentLevel),\n            discussion: this.addDiscussionInstructions(this.generateSmartDiscussion(this.extractBetterTopics(sourceText), lessonType, studentLevel), studentLevel),\n            dialoguePractice: await this.generateDialoguePractice(sourceText, studentLevel, vocabularyWords),\n            dialogueFillGap: await this.generateDialogueFillGap(sourceText, studentLevel, vocabularyWords),\n            grammar: this.generateSmartGrammar(studentLevel, sourceText),\n            pronunciation: this.generateSmartPronunciation(vocabulary.map((v)=>v.word)),\n            wrapup: this.addWrapupInstructions(this.generateSmartWrapup(this.extractBetterTopics(sourceText), studentLevel), studentLevel)\n        };\n    }\n    // Ultra-minimal warmup generation\n    async generateMinimalWarmup(sourceText, studentLevel) {\n        // Extract better context for topic identification\n        const topics = this.extractBetterTopics(sourceText);\n        const mainTopic = topics[0] || \"this topic\";\n        // Create a more specific prompt that avoids content assumptions\n        const prompt = `Write 3 ${studentLevel} warm-up questions about ${mainTopic}. Ask about students' prior knowledge and experience. Do not mention any specific events or results. Format: just the questions, one per line:`;\n        try {\n            console.log(\"\\uD83D\\uDD25 Minimal warmup prompt:\", prompt.length, \"chars\");\n            console.log(\"\\uD83C\\uDFAF Topic identified:\", mainTopic);\n            const response = await this.getGoogleAI().prompt(prompt);\n            // Extract only actual questions (must end with ?)\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>{\n                // Must be a question (ends with ?) and not an instruction\n                return line.endsWith(\"?\") && line.length > 10 && !line.toLowerCase().includes(\"here are\") && !line.toLowerCase().includes(\"based on\") && !line.toLowerCase().includes(\"headline mentions\") && !line.toLowerCase().includes(\"the text\") && !line.toLowerCase().includes(\"the article\") && !line.toLowerCase().includes(\"according to\") && !line.toLowerCase().includes(\"the passage\");\n            }).map((line)=>line.replace(/^\\d+\\.?\\s*/, \"\").replace(/^-\\s*/, \"\").trim()).slice(0, 3);\n            console.log(\"\\uD83C\\uDFAF Extracted warmup questions:\", questions);\n            return questions.length >= 3 ? questions : this.generateSmartWarmupQuestions(topics, studentLevel, {});\n        } catch (error) {\n            console.log(\"⚠️ Minimal warmup failed, using template\");\n            return this.generateSmartWarmupQuestions(this.extractBetterTopics(sourceText), studentLevel, {});\n        }\n    }\n    // Add instructional text to sections\n    addWarmupInstructions(questions, studentLevel) {\n        const instruction = \"Have the following conversations or discussions with your tutor before reading the text:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    addComprehensionInstructions(questions, studentLevel) {\n        const instruction = \"After reading the text, answer these comprehension questions:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    addDiscussionInstructions(questions, studentLevel) {\n        const instruction = \"Discuss these questions with your tutor to explore the topic in depth:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    addWrapupInstructions(questions, studentLevel) {\n        const instruction = \"Reflect on your learning by discussing these wrap-up questions:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    addVocabularyInstructions(vocabulary, studentLevel) {\n        const instruction = {\n            word: \"INSTRUCTION\",\n            meaning: \"Study the following words with your tutor before reading the text:\",\n            example: \"\"\n        };\n        return [\n            instruction,\n            ...vocabulary\n        ];\n    }\n    addReadingInstructions(readingText, studentLevel) {\n        const instruction = \"Read the following text carefully. Your tutor will help you with any difficult words or concepts:\";\n        return `${instruction}\\n\\n${readingText}`;\n    }\n    // Better topic extraction that recognizes compound terms\n    extractBetterTopics(text) {\n        const topics = [];\n        // Look for compound terms first (like \"Ryder Cup\", \"World Cup\", etc.)\n        const compoundPatterns = [\n            /\\b(Ryder Cup|World Cup|Champions League|Premier League|Super Bowl|Olympics|World Series)\\b/gi,\n            /\\b(artificial intelligence|machine learning|climate change|social media)\\b/gi,\n            /\\b([A-Z][a-z]+ [A-Z][a-z]+)\\b/g // General compound proper nouns\n        ];\n        for (const pattern of compoundPatterns){\n            const matches = text.match(pattern);\n            if (matches) {\n                topics.push(...matches.map((m)=>m.toLowerCase()));\n            }\n        }\n        // If no compound terms found, fall back to single words\n        if (topics.length === 0) {\n            const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n            const commonWords = [\n                \"europe\",\n                \"team\",\n                \"golf\",\n                \"tournament\",\n                \"sports\",\n                \"competition\"\n            ];\n            const foundWords = words.filter((word)=>commonWords.includes(word));\n            topics.push(...foundWords.slice(0, 3));\n        }\n        return topics.length > 0 ? topics : [\n            \"sports\"\n        ];\n    }\n    // Enhanced vocabulary generation with AI-generated contextual examples\n    async generateMinimalVocabulary(sourceText, studentLevel) {\n        const words = sourceText.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words)).slice(0, 8) // 6-10 words, start with 8\n        ;\n        const vocabulary = [];\n        for (const word of uniqueWords){\n            try {\n                const capitalizedWord = this.capitalizeWord(word);\n                // Generate AI definition\n                const definitionPrompt = `Define \"${word}\" simply for ${studentLevel} level. Context: ${sourceText.substring(0, 80)}. Give only the definition, no extra text:`;\n                console.log(\"\\uD83D\\uDCDA Vocab definition prompt:\", definitionPrompt.length, \"chars\");\n                const rawMeaning = await this.getGoogleAI().prompt(definitionPrompt);\n                const meaning = this.cleanDefinition(rawMeaning, studentLevel);\n                // Generate AI contextual examples\n                const examples = await this.generateAIExampleSentences(word, studentLevel, sourceText);\n                vocabulary.push({\n                    word: capitalizedWord,\n                    meaning: meaning.trim().substring(0, 200),\n                    example: examples\n                });\n            } catch (error) {\n                console.log(`⚠️ Vocab failed for ${word}, using enhanced template`);\n                const capitalizedWord = this.capitalizeWord(word);\n                vocabulary.push({\n                    word: capitalizedWord,\n                    meaning: this.generateContextualWordMeaning(word, studentLevel, sourceText),\n                    example: await this.generateAIExampleSentences(word, studentLevel, sourceText)\n                });\n            }\n        }\n        // Ensure we have 6-10 words\n        return vocabulary.slice(0, 10).length >= 6 ? vocabulary.slice(0, 10) : vocabulary.slice(0, 6);\n    }\n    // Ultra-minimal comprehension generation\n    async generateMinimalComprehension(sourceText, studentLevel) {\n        const shortText = sourceText.substring(0, 200) // Increase context for more questions\n        ;\n        const prompt = `Write 5 ${studentLevel} reading comprehension questions about this text. Only return questions, no instructions: ${shortText}`;\n        try {\n            console.log(\"❓ Minimal comprehension prompt:\", prompt.length, \"chars\");\n            const response = await this.getGoogleAI().prompt(prompt);\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>{\n                // Must be a question and not an instruction\n                return line.endsWith(\"?\") && line.length > 10 && !line.toLowerCase().includes(\"here are\") && !line.toLowerCase().includes(\"based on\");\n            }).map((line)=>line.replace(/^\\d+\\.?\\s*/, \"\").replace(/^\\*\\*/, \"\").replace(/\\*\\*$/, \"\").trim()).slice(0, 5);\n            return questions.length >= 5 ? questions : this.generateSmartComprehension(this.extractBetterTopics(sourceText), studentLevel);\n        } catch (error) {\n            console.log(\"⚠️ Minimal comprehension failed, using template\");\n            return this.generateSmartComprehension(this.extractBetterTopics(sourceText), studentLevel);\n        }\n    }\n    // Smart template fallback with AI-generated examples\n    async generateSmartTemplateFallback(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage } = params;\n        console.log(\"\\uD83C\\uDFA8 Using smart template fallback...\");\n        const topics = this.extractBetterTopics(sourceText);\n        const vocabulary = this.extractVocabularyFromText(sourceText, studentLevel);\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: this.addWarmupInstructions(this.generateSmartWarmupQuestions(topics, studentLevel, {}), studentLevel),\n                vocabulary: this.addVocabularyInstructions(await this.generateSmartVocabulary(vocabulary, sourceText, studentLevel), studentLevel),\n                reading: this.addReadingInstructions(await this.generateSmartReading(sourceText, studentLevel, vocabulary), studentLevel),\n                comprehension: this.addComprehensionInstructions(this.generateSmartComprehension(topics, studentLevel), studentLevel),\n                discussion: this.addDiscussionInstructions(this.generateSmartDiscussion(topics, lessonType, studentLevel), studentLevel),\n                dialoguePractice: await this.generateDialoguePractice(sourceText, studentLevel, vocabulary),\n                dialogueFillGap: await this.generateDialogueFillGap(sourceText, studentLevel, vocabulary),\n                grammar: this.generateSmartGrammar(studentLevel, sourceText),\n                pronunciation: this.generateSmartPronunciation(vocabulary),\n                wrapup: this.addWrapupInstructions(this.generateSmartWrapup(topics, studentLevel), studentLevel)\n            }\n        };\n    }\n    // Content analysis without AI calls\n    analyzeContentContextNoAI(sourceText, metadata, structuredContent, studentLevel) {\n        console.log(\"\\uD83D\\uDD0D Analyzing content context without AI...\");\n        const analysis = {\n            contentType: metadata?.contentType || \"general\",\n            domain: metadata?.domain || \"\",\n            complexity: \"medium\",\n            topics: [],\n            keyVocabulary: [],\n            culturalContext: \"\",\n            learningObjectives: [],\n            difficulty: studentLevel || \"B1\",\n            title: metadata?.title || \"\",\n            sourceCountry: this.determineSourceCountry(metadata?.domain || \"\")\n        };\n        // Analyze content complexity\n        const sentences = sourceText.split(/[.!?]+/).filter((s)=>s.trim().length > 10);\n        const avgSentenceLength = sentences.length > 0 ? sentences.reduce((sum, s)=>sum + s.split(\" \").length, 0) / sentences.length : 0;\n        const complexWords = sourceText.match(/\\b\\w{8,}\\b/g)?.length || 0;\n        const totalWords = sourceText.split(/\\s+/).length;\n        if (avgSentenceLength > 20 || complexWords / totalWords > 0.15) {\n            analysis.complexity = \"high\";\n        } else if (avgSentenceLength < 12 && complexWords / totalWords < 0.08) {\n            analysis.complexity = \"low\";\n        }\n        // Extract topics using text analysis\n        analysis.topics = this.extractTopicsFromText(sourceText, structuredContent?.headings || []);\n        // Extract vocabulary using text analysis\n        analysis.keyVocabulary = this.extractVocabularyFromText(sourceText, studentLevel);\n        // Determine cultural context\n        if (metadata?.domain) {\n            analysis.culturalContext = this.determineCulturalContext(metadata.domain, sourceText);\n        }\n        // Generate learning objectives\n        analysis.learningObjectives = this.generateLearningObjectives(analysis.contentType, analysis.topics, studentLevel);\n        return analysis;\n    }\n    // New method: Analyze content context and complexity\n    async analyzeContentContext(sourceText, metadata, structuredContent, studentLevel) {\n        console.log(\"\\uD83D\\uDD0D Analyzing content context...\");\n        const analysis = {\n            contentType: metadata?.contentType || \"general\",\n            domain: metadata?.domain || \"\",\n            complexity: \"medium\",\n            topics: [],\n            keyVocabulary: [],\n            culturalContext: \"\",\n            learningObjectives: [],\n            difficulty: studentLevel || \"B1\",\n            title: metadata?.title || \"\",\n            sourceCountry: this.determineSourceCountry(metadata?.domain || \"\")\n        };\n        // Analyze content complexity based on text characteristics\n        const sentences = sourceText.split(/[.!?]+/).filter((s)=>s.trim().length > 10);\n        const avgSentenceLength = sentences.length > 0 ? sentences.reduce((sum, s)=>sum + s.split(\" \").length, 0) / sentences.length : 0;\n        const complexWords = sourceText.match(/\\b\\w{8,}\\b/g)?.length || 0;\n        const totalWords = sourceText.split(/\\s+/).length;\n        if (avgSentenceLength > 20 || complexWords / totalWords > 0.15) {\n            analysis.complexity = \"high\";\n        } else if (avgSentenceLength < 12 && complexWords / totalWords < 0.08) {\n            analysis.complexity = \"low\";\n        }\n        console.log(\"\\uD83D\\uDCC8 Text complexity analysis:\", {\n            avgSentenceLength,\n            complexWords,\n            totalWords,\n            complexity: analysis.complexity\n        });\n        // Extract key topics using simple text analysis (skip AI to avoid token limits)\n        console.log(\"\\uD83C\\uDFAF Extracting topics using text analysis...\");\n        analysis.topics = this.extractTopicsFromText(sourceText, structuredContent?.headings || []);\n        console.log(\"✅ Extracted topics:\", analysis.topics);\n        // Extract key vocabulary using text analysis (skip AI to avoid token limits)\n        console.log(\"\\uD83D\\uDCDA Extracting vocabulary using text analysis...\");\n        analysis.keyVocabulary = this.extractVocabularyFromText(sourceText, studentLevel);\n        console.log(\"✅ Extracted vocabulary:\", analysis.keyVocabulary);\n        // Determine cultural context\n        if (metadata?.domain) {\n            analysis.culturalContext = this.determineCulturalContext(metadata.domain, sourceText);\n            console.log(\"\\uD83C\\uDF0D Cultural context:\", analysis.culturalContext);\n        }\n        // Generate learning objectives based on content type and lesson type\n        analysis.learningObjectives = this.generateLearningObjectives(analysis.contentType, analysis.topics, studentLevel);\n        console.log(\"\\uD83C\\uDFAF Learning objectives:\", analysis.learningObjectives);\n        return analysis;\n    }\n    // Enhanced contextual summary creation\n    async createContextualSummary(sourceText, contentAnalysis, lessonType, studentLevel) {\n        console.log(\"\\uD83D\\uDCDD Creating contextual summary...\");\n        // Use simple prompt to avoid token limits\n        const summaryPrompt = `Summarize this text in 4-5 sentences for ${studentLevel} level students:\n\n${sourceText.substring(0, 800)}\n\nSummary:`;\n        try {\n            console.log(\"\\uD83E\\uDD16 Calling AI for contextual summary...\");\n            const summary = await this.getGoogleAI().prompt(summaryPrompt, {\n                temperature: 0.4,\n                maxTokens: 300\n            });\n            console.log(\"✅ AI contextual summary created:\", summary.substring(0, 100) + \"...\");\n            return summary;\n        } catch (error) {\n            console.warn(\"⚠️ AI contextual summary failed, using text truncation:\", error.message);\n            // Skip complex fallbacks, just use truncation\n            const truncated = sourceText.substring(0, 600) + \"...\";\n            console.log(\"\\uD83D\\uDD04 Using truncated text as summary\");\n            return truncated;\n        }\n    }\n    // Generate CEFR-adapted warm-up questions\n    async generateContextualWarmupQuestions(content, contentAnalysis, studentLevel, metadata) {\n        console.log(\"\\uD83D\\uDD25 Generating CEFR-adapted warm-up questions...\");\n        const levelInstructions = {\n            \"A1\": `\nCreate 3 warm-up questions for A1 (beginner) level:\n- Use simple present tense and basic vocabulary\n- Ask yes/no questions or simple choice questions\n- Focus on familiar, concrete concepts\n- Keep questions short and direct\n- Use vocabulary the student likely knows\nExample: \"Do you use [topic] in your daily life? Yes or No?\"`,\n            \"A2\": `\nCreate 3 warm-up questions for A2 (elementary) level:\n- Use simple past tense and personal experiences\n- Ask for short, simple answers\n- Include basic comparisons with \"different\" or \"same\"\n- Focus on personal experiences and familiar situations\n- Use simple connecting words like \"and\", \"but\"\nExample: \"Have you ever [experienced topic]? How was it?\"`,\n            \"B1\": `\nCreate 3 warm-up questions for B1 (intermediate) level:\n- Ask for opinions with \"What do you think...?\"\n- Include comparisons between countries/cultures\n- Ask students to explain reasons with \"because\" or \"why\"\n- Discuss advantages and disadvantages\n- Use more varied vocabulary but keep structure clear\nExample: \"What do you think about [topic]? How is it different in your country?\"`,\n            \"B2\": `\nCreate 3 warm-up questions for B2 (upper intermediate) level:\n- Ask students to analyze situations and predict outcomes\n- Include complex opinions and explanations\n- Discuss implications and consequences\n- Use conditional language (\"What would happen if...?\")\n- Encourage detailed responses with examples\nExample: \"What challenges do you think [specific group] face with [topic]?\"`,\n            \"C1\": `\nCreate 3 warm-up questions for C1 (advanced) level:\n- Ask students to evaluate arguments and consider multiple perspectives\n- Include abstract concepts and societal implications\n- Use sophisticated vocabulary and complex structures\n- Encourage critical thinking and nuanced discussion\n- Ask about broader cultural and social contexts\nExample: \"How do cultural attitudes toward [concept] influence [topic] in different societies?\"`\n        };\n        // Ultra-simple prompt to avoid token limits\n        const topic = contentAnalysis.topics[0] || \"this topic\";\n        const warmupPrompt = `Create 3 ${studentLevel} level warm-up questions about ${topic}. Return only the questions:`;\n        try {\n            console.log(\"\\uD83E\\uDD16 Calling AI for contextual warm-up questions...\");\n            console.log(\"\\uD83D\\uDCDD Warm-up prompt:\", warmupPrompt.substring(0, 200) + \"...\");\n            const response = await this.getGoogleAI().prompt(warmupPrompt, {\n                temperature: 0.6,\n                maxTokens: 150\n            });\n            console.log(\"✅ AI warm-up questions generated\");\n            console.log(\"\\uD83E\\uDD16 Raw AI response:\", response);\n            const questions = this.parseListFromText(response).slice(0, 3);\n            console.log(\"\\uD83D\\uDD25 Parsed warm-up questions:\", questions);\n            console.log(\"\\uD83D\\uDD0D Questions array length:\", questions.length);\n            // Ensure we have 3 questions, add fallbacks if needed\n            while(questions.length < 3){\n                const fallbackQuestion = this.getFallbackWarmupQuestion(studentLevel, contentAnalysis, questions.length);\n                console.log(`🔄 Adding fallback question ${questions.length + 1}:`, fallbackQuestion);\n                questions.push(fallbackQuestion);\n            }\n            console.log(\"✅ Final warm-up questions:\", questions);\n            // Final safety check - if still empty, use basic fallback\n            if (questions.length === 0) {\n                console.warn(\"⚠️ No questions generated, using emergency fallback\");\n                return [\n                    \"What do you know about this topic?\",\n                    \"Have you experienced something similar?\",\n                    \"What would you like to learn?\"\n                ];\n            }\n            return questions;\n        } catch (error) {\n            console.warn(\"⚠️ AI warm-up generation failed, using contextual fallbacks:\", error.message);\n            const fallbackQuestions = this.getContextualWarmupFallback(studentLevel, contentAnalysis, metadata);\n            console.log(\"\\uD83D\\uDD04 Fallback warm-up questions:\", fallbackQuestions);\n            // Final safety check for fallback\n            if (!fallbackQuestions || fallbackQuestions.length === 0) {\n                console.warn(\"⚠️ Fallback also empty, using emergency questions\");\n                return [\n                    \"What do you know about this topic?\",\n                    \"Have you experienced something similar?\",\n                    \"What would you like to learn?\"\n                ];\n            }\n            return fallbackQuestions;\n        }\n    }\n    // Enhanced contextual lesson structure generation\n    async generateContextualLessonStructure(content, contentAnalysis, lessonType, studentLevel, targetLanguage, metadata) {\n        console.log(\"\\uD83C\\uDFD7️ Generating contextual lesson structure...\");\n        // Generate contextual warm-up questions first\n        const contextualWarmup = await this.generateContextualWarmupQuestions(content, contentAnalysis, studentLevel, metadata);\n        console.log(\"\\uD83D\\uDD25 Generated contextual warm-up questions:\", contextualWarmup);\n        // Ultra-simplified prompt to avoid token limits\n        const topics = contentAnalysis.topics.slice(0, 2).join(\", \") || \"technology\";\n        const vocab = contentAnalysis.keyVocabulary.slice(0, 4).join(\", \");\n        const prompt = `Create a ${lessonType} lesson for ${studentLevel} students about: ${topics}\n\nContent: \"${content.substring(0, 400)}\"\nKey words: ${vocab}\n\nReturn JSON with: warmup (use provided), vocabulary (4 words from content), reading (simplified content), comprehension (3 questions), discussion (3 questions), grammar (focus + examples), pronunciation (1 word), wrapup (3 questions).\n\n{\n  \"warmup\": ${JSON.stringify(contextualWarmup)},\n  \"vocabulary\": [{\"word\": \"word\", \"meaning\": \"definition\", \"example\": \"sentence\"}],\n  \"reading\": \"text\",\n  \"comprehension\": [\"question\"],\n  \"discussion\": [\"question\"], \n  \"grammar\": {\"focus\": \"topic\", \"examples\": [\"example\"], \"exercise\": [\"exercise\"]},\n  \"pronunciation\": {\"word\": \"word\", \"ipa\": \"/ipa/\", \"practice\": \"sentence\"},\n  \"wrapup\": [\"question\"]\n}`;\n        try {\n            console.log(\"\\uD83E\\uDD16 Calling AI for lesson structure...\");\n            const response = await this.getGoogleAI().prompt(prompt, {\n                temperature: 0.7,\n                maxTokens: 1500\n            });\n            console.log(\"\\uD83E\\uDD16 AI lesson structure response:\", response.substring(0, 200) + \"...\");\n            try {\n                const parsed = JSON.parse(response);\n                console.log(\"✅ Successfully parsed lesson structure JSON\");\n                // Ensure our contextual warm-up questions are preserved\n                parsed.warmup = contextualWarmup;\n                console.log(\"\\uD83D\\uDD25 Preserved contextual warm-up questions in final structure\");\n                return parsed;\n            } catch (parseError) {\n                console.warn(\"⚠️ Failed to parse JSON, attempting to clean response...\");\n                // Try to extract JSON from the response\n                const jsonMatch = response.match(/\\{[\\s\\S]*\\}/);\n                if (jsonMatch) {\n                    try {\n                        const cleaned = JSON.parse(jsonMatch[0]);\n                        console.log(\"✅ Successfully parsed cleaned JSON\");\n                        // Ensure our contextual warm-up questions are preserved\n                        cleaned.warmup = contextualWarmup;\n                        console.log(\"\\uD83D\\uDD25 Preserved contextual warm-up questions in cleaned structure\");\n                        return cleaned;\n                    } catch (cleanError) {\n                        console.warn(\"⚠️ Failed to parse cleaned JSON, using fallback\");\n                    }\n                }\n                // If JSON parsing fails, return a structured fallback with contextual warm-up\n                const fallback = this.createStructuredFallback(content, lessonType, studentLevel);\n                fallback.warmup = contextualWarmup;\n                console.log(\"\\uD83D\\uDD25 Using fallback with contextual warm-up questions\");\n                return fallback;\n            }\n        } catch (error) {\n            console.warn(\"⚠️ AI lesson structure generation failed, using fallback:\", error.message);\n            const fallback = this.createStructuredFallback(content, lessonType, studentLevel);\n            fallback.warmup = contextualWarmup;\n            console.log(\"\\uD83D\\uDD25 Using error fallback with contextual warm-up questions\");\n            return fallback;\n        }\n    }\n    // Enhanced detailed content generation with context\n    async generateDetailedContextualContent(structure, content, contentAnalysis, lessonType, studentLevel, targetLanguage, structuredContent) {\n        // Use Writer API to expand each section with contextual, detailed content\n        const sections = {\n            ...structure\n        };\n        // Enhance vocabulary section with contextual examples\n        if (sections.vocabulary) {\n            for(let i = 0; i < sections.vocabulary.length; i++){\n                const vocab = sections.vocabulary[i];\n                try {\n                    const contextualExamplePrompt = `\nCreate a natural example sentence using the word \"${vocab.word}\" that relates to this content context:\nTopics: ${contentAnalysis.topics.join(\", \")}\nContent type: ${contentAnalysis.contentType}\nLevel: ${studentLevel}\n\nMake the example relevant to the source material and appropriate for ${studentLevel} level students.\n`;\n                    const enhancedExample = await this.getGoogleAI().write(contextualExamplePrompt, {\n                        tone: \"casual\",\n                        length: \"short\"\n                    });\n                    sections.vocabulary[i].example = enhancedExample;\n                    // Add contextual meaning based on source content\n                    const contextualMeaningPrompt = `\nExplain the meaning of \"${vocab.word}\" in the context of: ${contentAnalysis.topics[0] || contentAnalysis.contentType}\nKeep it simple for ${studentLevel} level students.\n`;\n                    const contextualMeaning = await this.getGoogleAI().write(contextualMeaningPrompt, {\n                        tone: \"casual\",\n                        length: \"short\"\n                    });\n                    sections.vocabulary[i].contextualMeaning = contextualMeaning;\n                } catch (error) {\n                    // Keep original if enhancement fails\n                    console.warn(`Failed to enhance vocabulary for ${vocab.word}:`, error);\n                }\n            }\n        }\n        // Enhance discussion questions with specific content references\n        if (sections.discussion) {\n            try {\n                const enhancedDiscussionPrompt = `\nEnhance these discussion questions for a ${lessonType} lesson about ${contentAnalysis.topics.join(\" and \")}:\n${sections.discussion.join(\"\\n\")}\n\nMake them more specific to the content, engaging for ${studentLevel} level students, and encourage deeper thinking about:\n- ${contentAnalysis.topics.slice(0, 3).join(\"\\n- \")}\n\nReturn 3-4 enhanced questions that reference specific aspects of the content.\n`;\n                const enhancedDiscussion = await this.getGoogleAI().write(enhancedDiscussionPrompt, {\n                    tone: \"casual\",\n                    length: \"medium\",\n                    format: \"bullet-points\"\n                });\n                sections.discussion = this.parseListFromText(enhancedDiscussion).slice(0, 4);\n            } catch (error) {\n                console.warn(\"Failed to enhance discussion questions:\", error);\n            }\n        }\n        // Enhance reading section with better structure\n        if (sections.reading && structuredContent?.headings?.length > 0) {\n            try {\n                const structuredReadingPrompt = `\nImprove this reading text by organizing it with clear structure based on these headings from the original:\n${structuredContent.headings.slice(0, 3).map((h)=>`- ${h.text}`).join(\"\\n\")}\n\nOriginal text: \"${sections.reading}\"\n\nCreate a well-structured, ${studentLevel}-appropriate reading passage that maintains the key information but improves readability.\n`;\n                const enhancedReading = await this.getGoogleAI().rewrite(sections.reading, {\n                    tone: \"casual\",\n                    length: \"same\",\n                    audience: this.getAudienceLevel(studentLevel)\n                });\n                sections.reading = enhancedReading;\n            } catch (error) {\n                console.warn(\"Failed to enhance reading section:\", error);\n            }\n        }\n        // Enhance grammar section with content-specific examples\n        if (sections.grammar && sections.grammar.focus) {\n            try {\n                const grammarExamplesPrompt = `\nCreate 3 grammar examples for \"${sections.grammar.focus}\" using vocabulary and concepts from this content:\nTopics: ${contentAnalysis.topics.join(\", \")}\nKey vocabulary: ${contentAnalysis.keyVocabulary.slice(0, 5).join(\", \")}\n\nMake examples relevant to the content and appropriate for ${studentLevel} level.\n`;\n                const contextualGrammarExamples = await this.getGoogleAI().write(grammarExamplesPrompt, {\n                    tone: \"casual\",\n                    length: \"short\",\n                    format: \"bullet-points\"\n                });\n                sections.grammar.contextualExamples = this.parseListFromText(contextualGrammarExamples);\n            } catch (error) {\n                console.warn(\"Failed to enhance grammar examples:\", error);\n            }\n        }\n        return sections;\n    }\n    async proofreadLesson(lesson) {\n        // Proofread key text sections\n        const sectionsToProofread = [\n            \"reading\",\n            \"grammar.examples\",\n            \"pronunciation.practice\"\n        ];\n        for (const sectionPath of sectionsToProofread){\n            const value = this.getNestedValue(lesson, sectionPath);\n            if (typeof value === \"string\") {\n                const proofread = await this.getGoogleAI().proofread(value, {\n                    checkGrammar: true,\n                    checkSpelling: true,\n                    checkStyle: true\n                });\n                this.setNestedValue(lesson, sectionPath, proofread.corrected_text);\n            }\n        }\n        return lesson;\n    }\n    generateFallbackLesson(params) {\n        // Template-based fallback when AI APIs fail\n        const { sourceText, lessonType, studentLevel, targetLanguage } = params;\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: this.getTemplateWarmup(lessonType, studentLevel),\n                vocabulary: this.extractVocabulary(sourceText, studentLevel),\n                reading: this.simplifyText(sourceText, studentLevel),\n                comprehension: this.getTemplateComprehension(lessonType, studentLevel),\n                dialoguePractice: this.generateTemplateDialoguePractice(\"this topic\", studentLevel, []),\n                dialogueFillGap: this.generateTemplateDialogueFillGap(\"this topic\", studentLevel, []),\n                discussion: this.getTemplateDiscussion(lessonType, studentLevel),\n                grammar: this.getTemplateGrammar(studentLevel),\n                pronunciation: this.getTemplatePronunciation(sourceText),\n                wrapup: this.getTemplateWrapup(lessonType)\n            }\n        };\n    }\n    // Helper methods\n    getSummaryLength(level) {\n        const lengthMap = {\n            A1: \"short\",\n            A2: \"short\",\n            B1: \"medium\",\n            B2: \"medium\",\n            C1: \"long\"\n        };\n        return lengthMap[level] || \"medium\";\n    }\n    getLanguageCode(language) {\n        const languageMap = {\n            spanish: \"es\",\n            french: \"fr\",\n            german: \"de\",\n            italian: \"it\",\n            portuguese: \"pt\",\n            japanese: \"ja\",\n            korean: \"ko\",\n            chinese: \"zh\"\n        };\n        return languageMap[language] || \"en\";\n    }\n    parseListFromText(text) {\n        return text.split(\"\\n\").filter((line)=>line.trim()).map((line)=>line.replace(/^[-•*]\\s*/, \"\").trim()).filter((line)=>line.length > 0).slice(0, 4) // Limit to 4 items\n        ;\n    }\n    getNestedValue(obj, path) {\n        return path.split(\".\").reduce((current, key)=>current?.[key], obj);\n    }\n    setNestedValue(obj, path, value) {\n        const keys = path.split(\".\");\n        const lastKey = keys.pop();\n        const target = keys.reduce((current, key)=>current[key], obj);\n        target[lastKey] = value;\n    }\n    createStructuredFallback(content, lessonType, studentLevel) {\n        console.log(\"\\uD83D\\uDD04 Creating structured fallback lesson...\");\n        // Extract some basic information from content for better fallback\n        const words = content.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words)).slice(0, 6);\n        const fallback = {\n            warmup: [],\n            vocabulary: uniqueWords.map((word)=>({\n                    word: word,\n                    meaning: `Definition of ${word}`,\n                    example: `Example sentence with ${word}.`\n                })),\n            reading: this.simplifyText(content, studentLevel),\n            comprehension: this.getTemplateComprehension(lessonType, studentLevel),\n            discussion: this.getTemplateDiscussion(lessonType, studentLevel),\n            grammar: this.getTemplateGrammar(studentLevel),\n            pronunciation: this.getTemplatePronunciation(content),\n            wrapup: this.getTemplateWrapup(lessonType)\n        };\n        console.log(\"✅ Structured fallback created (warmup will be set by caller)\");\n        return fallback;\n    }\n    getTemplateWarmup(lessonType, studentLevel) {\n        const templates = {\n            discussion: [\n                \"What do you already know about this topic?\",\n                \"Have you had similar experiences?\",\n                \"What would you like to learn more about?\"\n            ],\n            grammar: [\n                \"What grammar patterns do you notice?\",\n                \"Which sentences seem most complex?\",\n                \"What grammar rules do you remember?\"\n            ],\n            travel: [\n                \"Where would you like to travel next?\",\n                \"What travel experiences have you had?\",\n                \"What travel vocabulary do you know?\"\n            ],\n            business: [\n                \"What business situations are you familiar with?\",\n                \"How do you communicate professionally?\",\n                \"What business terms are challenging?\"\n            ],\n            pronunciation: [\n                \"Which sounds are difficult to pronounce?\",\n                \"How do you practice pronunciation?\",\n                \"What pronunciation goals do you have?\"\n            ]\n        };\n        return templates[lessonType] || templates.discussion;\n    }\n    extractVocabulary(text, studentLevel) {\n        // Simple vocabulary extraction based on word frequency and complexity\n        const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words));\n        const selectedWords = uniqueWords.slice(0, 6);\n        return selectedWords.map((word)=>({\n                word: word,\n                meaning: `Definition of ${word}`,\n                example: `Example sentence with ${word}.`\n            }));\n    }\n    simplifyText(text, studentLevel) {\n        // Basic text simplification based on level\n        const maxLength = {\n            A1: 200,\n            A2: 300,\n            B1: 400,\n            B2: 500,\n            C1: 600\n        };\n        const limit = maxLength[studentLevel] || 400;\n        return text.substring(0, limit) + (text.length > limit ? \"...\" : \"\");\n    }\n    getTemplateComprehension(lessonType, studentLevel) {\n        return [\n            \"What is the main idea of this text?\",\n            \"What supporting details can you identify?\",\n            \"How does this relate to your experience?\",\n            \"What conclusions can you draw?\"\n        ];\n    }\n    getTemplateDiscussion(lessonType, studentLevel) {\n        const templates = {\n            discussion: [\n                \"What is your opinion on this topic?\",\n                \"How would you handle this situation?\",\n                \"What alternative approaches exist?\"\n            ],\n            business: [\n                \"How would you apply this professionally?\",\n                \"What business challenges does this address?\",\n                \"How would you present this to colleagues?\"\n            ],\n            travel: [\n                \"How would this help while traveling?\",\n                \"What preparations would you make?\",\n                \"How would you share this experience?\"\n            ]\n        };\n        return templates[lessonType] || templates.discussion;\n    }\n    getTemplateGrammar(studentLevel) {\n        const grammarFoci = {\n            A1: \"Present Simple Tense\",\n            A2: \"Past Simple Tense\",\n            B1: \"Present Perfect Tense\",\n            B2: \"Conditional Sentences\",\n            C1: \"Advanced Grammar Structures\"\n        };\n        return {\n            focus: grammarFoci[studentLevel] || \"Present Perfect Tense\",\n            examples: [\n                \"I have learned many new things.\",\n                \"She has improved her skills.\",\n                \"We have discussed this topic.\"\n            ],\n            exercise: [\n                \"I _____ (learn) a lot today.\",\n                \"They _____ (complete) the project.\",\n                \"She _____ (improve) significantly.\"\n            ]\n        };\n    }\n    getTemplatePronunciation(text) {\n        // Extract a challenging word from the text\n        const words = text.match(/\\b[a-z]{6,}\\b/gi) || [\n            \"communication\"\n        ];\n        const selectedWord = words[0] || \"communication\";\n        return {\n            word: selectedWord.toLowerCase(),\n            ipa: \"/kəˌmjuːnɪˈkeɪʃən/\",\n            practice: `Practice saying: \"${selectedWord}\" in a sentence.`\n        };\n    }\n    getTemplateWrapup(lessonType) {\n        return [\n            \"What new vocabulary did you learn?\",\n            \"Which concepts need more practice?\",\n            \"How will you use this knowledge?\",\n            \"What questions do you still have?\"\n        ];\n    }\n    // New helper methods for enhanced contextual analysis\n    extractTopicsFromHeadings(headings) {\n        return headings.filter((h)=>h.level <= 3) // Focus on main headings\n        .map((h)=>h.text).slice(0, 5);\n    }\n    extractTopicsFromText(text, headings) {\n        // First try to get topics from headings\n        const headingTopics = this.extractTopicsFromHeadings(headings);\n        if (headingTopics.length > 0) {\n            return headingTopics;\n        }\n        // Fallback: extract key phrases from text\n        const sentences = text.split(/[.!?]+/).filter((s)=>s.trim().length > 20);\n        const topics = [];\n        // Look for common topic indicators\n        const topicPatterns = [\n            /about (.+?)(?:\\s|,|\\.)/gi,\n            /discuss (.+?)(?:\\s|,|\\.)/gi,\n            /focus on (.+?)(?:\\s|,|\\.)/gi,\n            /regarding (.+?)(?:\\s|,|\\.)/gi\n        ];\n        for (const sentence of sentences.slice(0, 5)){\n            for (const pattern of topicPatterns){\n                const matches = sentence.match(pattern);\n                if (matches) {\n                    topics.push(...matches.map((m)=>m.replace(pattern, \"$1\").trim()).slice(0, 2));\n                }\n            }\n        }\n        // If no patterns found, extract key nouns\n        if (topics.length === 0) {\n            const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n            const commonWords = [\n                \"this\",\n                \"that\",\n                \"with\",\n                \"from\",\n                \"they\",\n                \"have\",\n                \"been\",\n                \"will\",\n                \"more\",\n                \"some\",\n                \"what\",\n                \"when\",\n                \"where\",\n                \"which\",\n                \"their\",\n                \"would\",\n                \"could\",\n                \"should\"\n            ];\n            const keyWords = words.filter((word)=>!commonWords.includes(word)).filter((word, index, arr)=>arr.indexOf(word) === index) // unique\n            .slice(0, 3);\n            return keyWords.length > 0 ? keyWords : [\n                \"AI technology\",\n                \"mobile devices\",\n                \"privacy\"\n            ];\n        }\n        return topics.slice(0, 3);\n    }\n    extractVocabularyFromText(text, level) {\n        // Extract words based on complexity appropriate for the level\n        const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words));\n        // Filter by complexity based on level\n        const complexityThreshold = {\n            \"A1\": 6,\n            \"A2\": 7,\n            \"B1\": 8,\n            \"B2\": 10,\n            \"C1\": 12\n        };\n        const maxLength = complexityThreshold[level] || 8;\n        return uniqueWords.filter((word)=>word.length <= maxLength && word.length >= 4).slice(0, 8);\n    }\n    determineCulturalContext(domain, text) {\n        // Determine cultural context based on domain and content\n        const culturalIndicators = {\n            \"bbc.com\": \"British English, UK culture\",\n            \"cnn.com\": \"American English, US culture\",\n            \"wikipedia.org\": \"International, encyclopedic\",\n            \"nytimes.com\": \"American English, US perspective\",\n            \"theguardian.com\": \"British English, UK perspective\"\n        };\n        if (culturalIndicators[domain]) {\n            return culturalIndicators[domain];\n        }\n        // Analyze text for cultural markers\n        const americanMarkers = [\n            \"dollar\",\n            \"president\",\n            \"congress\",\n            \"state\",\n            \"federal\"\n        ];\n        const britishMarkers = [\n            \"pound\",\n            \"minister\",\n            \"parliament\",\n            \"council\",\n            \"government\"\n        ];\n        const americanCount = americanMarkers.filter((marker)=>text.toLowerCase().includes(marker)).length;\n        const britishCount = britishMarkers.filter((marker)=>text.toLowerCase().includes(marker)).length;\n        if (americanCount > britishCount) {\n            return \"American English context\";\n        } else if (britishCount > americanCount) {\n            return \"British English context\";\n        }\n        return \"International context\";\n    }\n    generateLearningObjectives(contentType, topics, level) {\n        const objectives = [];\n        // Base objectives on content type\n        switch(contentType){\n            case \"news\":\n                objectives.push(\"Understand current events vocabulary\");\n                objectives.push(\"Practice reading news articles\");\n                break;\n            case \"blog\":\n                objectives.push(\"Learn informal writing style\");\n                objectives.push(\"Understand personal opinions and experiences\");\n                break;\n            case \"tutorial\":\n                objectives.push(\"Follow step-by-step instructions\");\n                objectives.push(\"Learn technical vocabulary\");\n                break;\n            case \"encyclopedia\":\n                objectives.push(\"Understand factual information\");\n                objectives.push(\"Learn academic vocabulary\");\n                break;\n            default:\n                objectives.push(\"Improve reading comprehension\");\n                objectives.push(\"Expand vocabulary knowledge\");\n        }\n        // Add topic-specific objectives\n        topics.slice(0, 2).forEach((topic)=>{\n            objectives.push(`Discuss topics related to ${topic.toLowerCase()}`);\n        });\n        return objectives.slice(0, 4);\n    }\n    getAudienceLevel(cefrLevel) {\n        const levelMap = {\n            \"A1\": \"beginner\",\n            \"A2\": \"beginner\",\n            \"B1\": \"general\",\n            \"B2\": \"general\",\n            \"C1\": \"expert\"\n        };\n        return levelMap[cefrLevel] || \"general\";\n    }\n    // Enhanced fallback lesson generation with context\n    generateEnhancedFallbackLesson(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage, contentMetadata, structuredContent } = params;\n        console.log(\"\\uD83D\\uDD04 Generating enhanced fallback lesson with contextual warm-up...\");\n        // Use available context even in fallback\n        const topics = structuredContent?.headings?.map((h)=>h.text).slice(0, 3) || [];\n        const contentType = contentMetadata?.contentType || \"general\";\n        // Create mock content analysis for fallback warm-up generation\n        const mockContentAnalysis = {\n            topics: topics,\n            contentType: contentType,\n            sourceCountry: this.determineSourceCountry(contentMetadata?.domain || \"\"),\n            culturalContext: this.determineCulturalContext(contentMetadata?.domain || \"\", sourceText)\n        };\n        // Generate contextual warm-up questions even in fallback\n        const contextualWarmup = this.getContextualWarmupFallback(studentLevel, mockContentAnalysis, contentMetadata);\n        console.log(\"\\uD83D\\uDD25 Generated fallback contextual warm-up:\", contextualWarmup);\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: contextualWarmup,\n                vocabulary: this.extractContextualVocabulary(sourceText, studentLevel, topics),\n                reading: this.simplifyText(sourceText, studentLevel),\n                comprehension: this.getContextualComprehension(lessonType, studentLevel, topics),\n                dialoguePractice: this.generateTemplateDialoguePractice(topics[0] || \"this topic\", studentLevel, []),\n                dialogueFillGap: this.generateTemplateDialogueFillGap(topics[0] || \"this topic\", studentLevel, []),\n                discussion: this.getContextualDiscussion(lessonType, studentLevel, topics),\n                grammar: this.getTemplateGrammar(studentLevel),\n                pronunciation: this.getTemplatePronunciation(sourceText),\n                wrapup: this.getContextualWrapup(lessonType, topics)\n            }\n        };\n    }\n    getContextualWarmup(lessonType, studentLevel, topics, contentType) {\n        // Use the same contextual fallback logic\n        const mockAnalysis = {\n            topics: topics,\n            contentType: contentType,\n            sourceCountry: \"International\"\n        };\n        return this.getContextualWarmupFallback(studentLevel, mockAnalysis, {\n            title: topics[0] || \"Content\"\n        });\n    }\n    // Basic fallback for complete failures\n    generateBasicFallbackLesson(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage } = params;\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: [\n                    \"What do you already know about this topic?\",\n                    \"Have you had similar experiences?\",\n                    \"What would you like to learn?\"\n                ],\n                vocabulary: [],\n                reading: sourceText.substring(0, 400),\n                comprehension: [\n                    \"What is the main idea?\",\n                    \"What details can you identify?\"\n                ],\n                dialoguePractice: this.generateTemplateDialoguePractice(\"this topic\", studentLevel, []),\n                dialogueFillGap: this.generateTemplateDialogueFillGap(\"this topic\", studentLevel, []),\n                discussion: [\n                    \"What is your opinion?\",\n                    \"How would you handle this?\"\n                ],\n                grammar: this.getTemplateGrammar(studentLevel),\n                pronunciation: {\n                    word: \"example\",\n                    ipa: \"/ɪɡˈz\\xe6mpəl/\",\n                    practice: \"Practice saying example.\"\n                },\n                wrapup: [\n                    \"What did you learn?\",\n                    \"What needs more practice?\"\n                ]\n            }\n        };\n    }\n    extractContextualVocabulary(text, studentLevel, topics) {\n        const vocabulary = this.extractVocabulary(text, studentLevel);\n        // Enhance with topic context if available\n        if (topics.length > 0) {\n            return vocabulary.map((vocab, index)=>({\n                    ...vocab,\n                    context: index < topics.length ? `Related to ${topics[index].toLowerCase()}` : vocab.meaning\n                }));\n        }\n        return vocabulary;\n    }\n    getContextualComprehension(lessonType, studentLevel, topics) {\n        const baseQuestions = this.getTemplateComprehension(lessonType, studentLevel);\n        if (topics.length > 0) {\n            return [\n                `What is the main point about ${topics[0]?.toLowerCase()}?`,\n                `How does the text explain ${topics[1]?.toLowerCase() || \"the topic\"}?`,\n                \"What supporting details can you identify?\",\n                \"What conclusions can you draw from this information?\"\n            ];\n        }\n        return baseQuestions;\n    }\n    getContextualDiscussion(lessonType, studentLevel, topics) {\n        const baseQuestions = this.getTemplateDiscussion(lessonType, studentLevel);\n        if (topics.length > 0) {\n            return [\n                `What is your opinion about ${topics[0]?.toLowerCase()}?`,\n                `How would you apply this information about ${topics[1]?.toLowerCase() || \"this topic\"}?`,\n                `What are the implications of what you learned about ${topics[0]?.toLowerCase()}?`\n            ];\n        }\n        return baseQuestions;\n    }\n    getContextualWrapup(lessonType, topics) {\n        if (topics.length > 0) {\n            return [\n                `What new vocabulary did you learn about ${topics[0]?.toLowerCase()}?`,\n                `Which concepts about ${topics[1]?.toLowerCase() || \"this topic\"} need more practice?`,\n                \"How will you use this knowledge in real situations?\",\n                \"What questions do you still have about this content?\"\n            ];\n        }\n        return this.getTemplateWrapup(lessonType);\n    }\n    // Smart template-based lesson generation\n    async generateSmartTemplateLesson(sourceText, contentAnalysis, lessonType, studentLevel, targetLanguage, metadata) {\n        console.log(\"\\uD83C\\uDFA8 Generating smart template lesson...\");\n        const topics = contentAnalysis.topics;\n        const vocabulary = contentAnalysis.keyVocabulary;\n        const title = metadata?.title || \"Content\";\n        return {\n            warmup: this.generateSmartWarmupQuestions(topics, studentLevel, contentAnalysis),\n            vocabulary: await this.generateSmartVocabulary(vocabulary, sourceText, studentLevel),\n            reading: await this.generateSmartReading(sourceText, studentLevel, vocabulary),\n            comprehension: this.generateSmartComprehension(topics, studentLevel),\n            dialoguePractice: await this.generateDialoguePractice(sourceText, studentLevel, vocabulary),\n            dialogueFillGap: await this.generateDialogueFillGap(sourceText, studentLevel, vocabulary),\n            discussion: this.generateSmartDiscussion(topics, lessonType, studentLevel),\n            grammar: this.generateSmartGrammar(studentLevel, sourceText),\n            pronunciation: this.generateSmartPronunciation(vocabulary),\n            wrapup: this.generateSmartWrapup(topics, studentLevel)\n        };\n    }\n    // Smart warm-up questions based on content (prior knowledge activation)\n    generateSmartWarmupQuestions(topics, studentLevel, contentAnalysis) {\n        const topic = topics[0] || \"this topic\";\n        const secondTopic = topics[1] || \"technology\";\n        // Focus on activating prior knowledge, not assuming content knowledge\n        const levelQuestions = {\n            \"A1\": [\n                `Do you know about ${topic.toLowerCase()}?`,\n                `Is ${topic.toLowerCase()} popular in your country?`,\n                `Do you like ${topic.toLowerCase()}?`\n            ],\n            \"A2\": [\n                `Have you heard about ${topic.toLowerCase()} before?`,\n                `What do you already know about ${topic.toLowerCase()}?`,\n                `Is ${topic.toLowerCase()} common in your country?`\n            ],\n            \"B1\": [\n                `What comes to mind when you hear about ${topic.toLowerCase()}?`,\n                `Have you had any experience with ${topic.toLowerCase()}?`,\n                `What would you like to know about ${topic.toLowerCase()}?`\n            ],\n            \"B2\": [\n                `What is your general opinion about ${topic.toLowerCase()}?`,\n                `How familiar are you with ${topic.toLowerCase()}?`,\n                `What role does ${topic.toLowerCase()} play in your daily life?`\n            ],\n            \"C1\": [\n                `How would you describe the significance of ${topic.toLowerCase()} in modern society?`,\n                `What are your thoughts on the current state of ${topic.toLowerCase()}?`,\n                `How do you think ${topic.toLowerCase()} has evolved over time?`\n            ]\n        };\n        return levelQuestions[studentLevel] || levelQuestions[\"B1\"];\n    }\n    // Enhanced smart vocabulary with AI-generated contextual examples\n    async generateSmartVocabulary(vocabulary, sourceText, studentLevel) {\n        const selectedWords = vocabulary.slice(0, 8) // Start with 8 words\n        ;\n        const vocabPromises = selectedWords.map(async (word)=>{\n            const capitalizedWord = this.capitalizeWord(word);\n            return {\n                word: capitalizedWord,\n                meaning: this.generateContextualWordMeaning(word, studentLevel, sourceText),\n                example: await this.generateAIExampleSentences(word, studentLevel, sourceText)\n            };\n        });\n        const results = await Promise.all(vocabPromises);\n        // Ensure we have 6-10 words\n        return results.slice(0, 10).length >= 6 ? results.slice(0, 10) : results.slice(0, 6);\n    }\n    // Capitalize word properly\n    capitalizeWord(word) {\n        return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();\n    }\n    // Generate contextual word meanings based on level and source text\n    generateContextualWordMeaning(word, level, sourceText) {\n        const lowerWord = word.toLowerCase();\n        // Enhanced contextual definitions based on level\n        const contextualMeanings = {\n            \"efficient\": {\n                \"A1\": \"working well without wasting time\",\n                \"A2\": \"doing something well and quickly without wasting time or energy\",\n                \"B1\": \"working in a way that achieves the best results with the least waste of time and effort\",\n                \"B2\": \"achieving maximum productivity with minimum wasted effort or expense\",\n                \"C1\": \"achieving maximum productivity with minimum wasted effort, expense, or unnecessary activity\"\n            },\n            \"technology\": {\n                \"A1\": \"computers and machines that help us\",\n                \"A2\": \"machines and computer systems that make life easier\",\n                \"B1\": \"the use of scientific knowledge to create useful tools and machines\",\n                \"B2\": \"the application of scientific knowledge for practical purposes in industry and daily life\",\n                \"C1\": \"the systematic application of scientific knowledge to develop practical solutions and innovations\"\n            },\n            \"europe\": {\n                \"A1\": \"a big area with many countries\",\n                \"A2\": \"a continent with many different countries like France, Germany, and Italy\",\n                \"B1\": \"a continent consisting of many countries, known for its history and culture\",\n                \"B2\": \"a continent comprising numerous nations with diverse cultures, languages, and political systems\",\n                \"C1\": \"a geopolitical and cultural continent characterized by diverse nation-states, shared historical heritage, and economic integration\"\n            },\n            \"sensational\": {\n                \"A1\": \"very exciting and good\",\n                \"A2\": \"extremely exciting or impressive, causing strong feelings\",\n                \"B1\": \"causing great excitement, interest, or shock; extremely impressive\",\n                \"B2\": \"causing intense excitement, interest, or shock; extraordinarily impressive or remarkable\",\n                \"C1\": \"causing or designed to cause intense excitement, interest, or shock through dramatic or extraordinary qualities\"\n            },\n            \"stages\": {\n                \"A1\": \"does or makes something happen\",\n                \"A2\": \"organizes and presents an event or performance\",\n                \"B1\": \"organizes and presents an event, or refers to different parts of a process\",\n                \"B2\": \"organizes and presents an event or performance, or represents distinct phases in a process\",\n                \"C1\": \"orchestrates and presents an event or performance, or denotes sequential phases in a complex process\"\n            },\n            \"comeback\": {\n                \"A1\": \"winning after losing\",\n                \"A2\": \"returning to win after being behind in a game or competition\",\n                \"B1\": \"a return to a winning position after being behind, or a return to success\",\n                \"B2\": \"a recovery from a disadvantageous position to achieve success or victory\",\n                \"C1\": \"a strategic recovery from a disadvantageous position to achieve success, often against expectations\"\n            },\n            \"dramatic\": {\n                \"A1\": \"very exciting and surprising\",\n                \"A2\": \"very exciting, with sudden changes that surprise people\",\n                \"B1\": \"involving sudden changes or strong emotions; very noticeable or impressive\",\n                \"B2\": \"characterized by sudden, striking changes or intense emotions; highly impressive or theatrical\",\n                \"C1\": \"marked by sudden, striking developments or intense emotional impact; theatrically impressive or emotionally powerful\"\n            }\n        };\n        const levelMeanings = contextualMeanings[lowerWord];\n        if (levelMeanings && levelMeanings[level]) {\n            return levelMeanings[level];\n        }\n        // Fallback to basic level-appropriate definition\n        const isSimpleLevel = level === \"A1\" || level === \"A2\";\n        return isSimpleLevel ? `a word that means ${lowerWord}` : `a term referring to ${lowerWord} in this context`;\n    }\n    // Generate AI-powered contextual example sentences\n    async generateAIExampleSentences(word, level, sourceText) {\n        const exampleCount = this.getExampleCount(level);\n        const context = sourceText.substring(0, 120) // More context for relevance\n        ;\n        try {\n            const levelGuidance = this.getLevelGuidance(level);\n            const prompt = `Create ${exampleCount} contextual ${level} level sentences using \"${word}\" related to: ${context}. Make sentences meaningful and relevant to the topic. ${levelGuidance} Format: one sentence per line, no quotes:`;\n            console.log(\"\\uD83D\\uDCDD Contextual example sentences prompt:\", prompt.length, \"chars\");\n            const response = await this.getGoogleAI().prompt(prompt);\n            // Parse and clean AI response\n            const sentences = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.length > 5 && line.toLowerCase().includes(word.toLowerCase())).map((line)=>this.cleanSentence(line)).map((line)=>this.boldifyTargetWord(line, word)).filter((line)=>line.length > 0).slice(0, exampleCount);\n            // If AI generated enough contextual sentences, use them\n            if (sentences.length >= exampleCount) {\n                return sentences.join(\" | \");\n            }\n            // Otherwise, supplement with contextual template sentences\n            const additionalNeeded = exampleCount - sentences.length;\n            const templateSentences = this.generateContextualExamples(word, level, sourceText, additionalNeeded);\n            return [\n                ...sentences,\n                ...templateSentences\n            ].slice(0, exampleCount).join(\" | \");\n        } catch (error) {\n            console.log(`⚠️ AI example generation failed for ${word}, using contextual templates`);\n            // Fallback to contextual template examples\n            return this.generateContextualExamples(word, level, sourceText, exampleCount).join(\" | \");\n        }\n    }\n    // Get level-specific guidance for AI prompts\n    getLevelGuidance(level) {\n        const guidance = {\n            \"A1\": \"Use very simple words, short sentences (5-8 words), present tense.\",\n            \"A2\": \"Use simple words, short sentences (6-10 words), basic grammar.\",\n            \"B1\": \"Use common words, medium sentences (8-12 words), clear meaning.\",\n            \"B2\": \"Use varied vocabulary, longer sentences (10-15 words), complex ideas.\",\n            \"C1\": \"Use sophisticated vocabulary, complex sentences (12+ words), nuanced meaning.\"\n        };\n        return guidance[level] || guidance[\"B1\"];\n    }\n    // Clean sentence formatting\n    cleanSentence(sentence) {\n        return sentence.replace(/^\\d+\\.?\\s*/, \"\") // Remove numbering\n        .replace(/^-\\s*/, \"\") // Remove dashes\n        .replace(/^\\*\\s*/, \"\") // Remove asterisks\n        .replace(/^•\\s*/, \"\") // Remove bullet points\n        .trim();\n    }\n    // Clean definition formatting\n    cleanDefinition(definition, level) {\n        return definition.replace(/^For an? [A-Z]\\d+ student,?\\s*/i, \"\") // Remove level prefixes\n        .replace(/^In this context,?\\s*/i, \"\") // Remove context prefixes\n        .replace(/^Here's? (a )?definition.*?:\\s*/i, \"\") // Remove definition intros\n        .replace(/^\\*\\*(.*?)\\*\\*/g, \"$1\") // Remove bold markdown\n        .replace(/\\*\\*(.*?)\\*\\*/g, \"$1\") // Remove bold markdown\n        .trim();\n    }\n    // Make target word bold in sentence\n    boldifyTargetWord(sentence, targetWord) {\n        const regex = new RegExp(`\\\\b${targetWord}\\\\b`, \"gi\");\n        return sentence.replace(regex, `**${targetWord}**`);\n    }\n    // Generate contextual examples based on source material\n    generateContextualExamples(word, level, sourceText, count) {\n        const lowerWord = word.toLowerCase();\n        const capitalizedWord = this.capitalizeWord(word);\n        // Extract themes from source text for context\n        const themes = this.extractThemesFromText(sourceText);\n        const mainTheme = themes[0] || \"this topic\";\n        const contextualExamples = {\n            \"A1\": [\n                `**${capitalizedWord}** is in the news today.`,\n                `I read about **${lowerWord}** online.`,\n                `**${capitalizedWord}** is important for ${mainTheme}.`,\n                `People talk about **${lowerWord}**.`,\n                `**${capitalizedWord}** helps with ${mainTheme}.`\n            ],\n            \"A2\": [\n                `**${capitalizedWord}** plays a big role in ${mainTheme}.`,\n                `Many people are interested in **${lowerWord}**.`,\n                `**${capitalizedWord}** affects how we think about ${mainTheme}.`,\n                `The news often mentions **${lowerWord}**.`,\n                `**${capitalizedWord}** is becoming more important in ${mainTheme}.`\n            ],\n            \"B1\": [\n                `**${capitalizedWord}** has changed the way we approach ${mainTheme}.`,\n                `Understanding **${lowerWord}** is crucial for ${mainTheme}.`,\n                `**${capitalizedWord}** continues to influence ${mainTheme}.`,\n                `The role of **${lowerWord}** in ${mainTheme} is growing.`\n            ],\n            \"B2\": [\n                `**${capitalizedWord}** represents a significant development in ${mainTheme}.`,\n                `The implications of **${lowerWord}** for ${mainTheme} are far-reaching.`,\n                `**${capitalizedWord}** has transformed our understanding of ${mainTheme}.`\n            ],\n            \"C1\": [\n                `**${capitalizedWord}** exemplifies the complex dynamics within ${mainTheme}.`,\n                `The multifaceted nature of **${lowerWord}** requires nuanced analysis in ${mainTheme}.`,\n                `**${capitalizedWord}** represents a paradigmatic shift in contemporary ${mainTheme}.`\n            ]\n        };\n        const levelExamples = contextualExamples[level] || contextualExamples[\"B1\"];\n        return levelExamples.slice(0, count);\n    }\n    // Extract themes from source text for contextual examples\n    extractThemesFromText(text) {\n        const themes = [];\n        // Common themes based on keywords\n        const themeKeywords = {\n            \"sports\": [\n                \"team\",\n                \"game\",\n                \"win\",\n                \"play\",\n                \"match\",\n                \"competition\",\n                \"tournament\",\n                \"cup\"\n            ],\n            \"technology\": [\n                \"AI\",\n                \"computer\",\n                \"digital\",\n                \"software\",\n                \"system\",\n                \"device\",\n                \"artificial\",\n                \"intelligence\"\n            ],\n            \"environment\": [\n                \"climate\",\n                \"nature\",\n                \"earth\",\n                \"green\",\n                \"pollution\",\n                \"energy\",\n                \"change\"\n            ],\n            \"health\": [\n                \"medical\",\n                \"doctor\",\n                \"treatment\",\n                \"patient\",\n                \"medicine\",\n                \"care\",\n                \"healthcare\"\n            ],\n            \"business\": [\n                \"company\",\n                \"market\",\n                \"economy\",\n                \"finance\",\n                \"industry\",\n                \"trade\"\n            ],\n            \"education\": [\n                \"student\",\n                \"learn\",\n                \"school\",\n                \"knowledge\",\n                \"study\",\n                \"teach\"\n            ]\n        };\n        const lowerText = text.toLowerCase();\n        for (const [theme, keywords] of Object.entries(themeKeywords)){\n            const matchCount = keywords.filter((keyword)=>lowerText.includes(keyword)).length;\n            if (matchCount >= 2) {\n                themes.push(theme);\n            }\n        }\n        return themes.length > 0 ? themes : [\n            \"this topic\"\n        ];\n    }\n    // Generate truly level-appropriate example sentences\n    generateLevelAppropriateExamples(word, level, count) {\n        const lowerWord = word.toLowerCase();\n        const capitalizedWord = this.capitalizeWord(word);\n        const examples = {\n            \"A1\": [\n                `${capitalizedWord} is good.`,\n                `I like ${lowerWord}.`,\n                `This is ${lowerWord}.`,\n                `${capitalizedWord} helps us.`,\n                `We see ${lowerWord}.`\n            ],\n            \"A2\": [\n                `${capitalizedWord} is very important.`,\n                `I think ${lowerWord} is interesting.`,\n                `Many people know about ${lowerWord}.`,\n                `${capitalizedWord} is useful for us.`,\n                `We can learn about ${lowerWord}.`\n            ],\n            \"B1\": [\n                `${capitalizedWord} plays an important role today.`,\n                `People are interested in ${lowerWord}.`,\n                `${capitalizedWord} affects our daily lives.`,\n                `We should understand ${lowerWord} better.`\n            ],\n            \"B2\": [\n                `${capitalizedWord} has significant implications for society.`,\n                `The impact of ${lowerWord} continues to grow.`,\n                `Understanding ${lowerWord} requires careful consideration.`\n            ],\n            \"C1\": [\n                `${capitalizedWord} exemplifies contemporary challenges.`,\n                `The complexity of ${lowerWord} demands sophisticated analysis.`,\n                `${capitalizedWord} represents a paradigm shift in thinking.`\n            ]\n        };\n        const levelExamples = examples[level] || examples[\"B1\"];\n        return levelExamples.slice(0, count);\n    }\n    // Fallback template-based example generation\n    generateTemplateExamples(word, level, sourceText) {\n        const exampleCount = this.getExampleCount(level);\n        // Try to find the word in the source text first\n        const sentences = sourceText.split(/[.!?]+/).filter((s)=>s.trim().length > 10);\n        const contextSentence = sentences.find((s)=>s.toLowerCase().includes(word.toLowerCase()));\n        const examples = [];\n        // Add context sentence if found\n        if (contextSentence) {\n            examples.push(contextSentence.trim());\n        }\n        // Generate additional level-appropriate examples\n        const additionalExamples = this.generateAdditionalExamples(word, level, exampleCount - examples.length);\n        examples.push(...additionalExamples);\n        // Ensure we have the right number of examples\n        return examples.slice(0, exampleCount).join(\" | \");\n    }\n    // Get number of examples based on CEFR level\n    getExampleCount(level) {\n        switch(level){\n            case \"A1\":\n            case \"A2\":\n                return 5;\n            case \"B1\":\n                return 4;\n            case \"B2\":\n            case \"C1\":\n                return 3;\n            default:\n                return 4;\n        }\n    }\n    // Generate additional level-appropriate example sentences\n    generateAdditionalExamples(word, level, count) {\n        const lowerWord = word.toLowerCase();\n        const capitalizedWord = this.capitalizeWord(word);\n        const exampleTemplates = {\n            \"A1\": [\n                `${capitalizedWord} is important.`,\n                `I like ${lowerWord}.`,\n                `This is ${lowerWord}.`,\n                `${capitalizedWord} is good.`,\n                `We use ${lowerWord}.`\n            ],\n            \"A2\": [\n                `${capitalizedWord} is very important in our daily life.`,\n                `I think ${lowerWord} is interesting.`,\n                `Many people use ${lowerWord} today.`,\n                `${capitalizedWord} helps us a lot.`,\n                `We can learn about ${lowerWord}.`\n            ],\n            \"B1\": [\n                `${capitalizedWord} plays an important role in modern society.`,\n                `The concept of ${lowerWord} has evolved significantly.`,\n                `Understanding ${lowerWord} is essential for students.`,\n                `${capitalizedWord} continues to influence our daily lives.`\n            ],\n            \"B2\": [\n                `${capitalizedWord} represents a significant development in this field.`,\n                `The implications of ${lowerWord} extend beyond immediate applications.`,\n                `Experts consider ${lowerWord} to be a crucial factor in future progress.`\n            ],\n            \"C1\": [\n                `${capitalizedWord} exemplifies the complex interplay between innovation and practical application.`,\n                `The multifaceted nature of ${lowerWord} requires comprehensive analysis.`,\n                `Contemporary discourse surrounding ${lowerWord} reflects broader societal transformations.`\n            ]\n        };\n        const templates = exampleTemplates[level] || exampleTemplates[\"B1\"];\n        return templates.slice(0, count);\n    }\n    // Enhanced reading passage adaptation with AI rewriting and vocabulary bolding\n    async generateSmartReading(sourceText, studentLevel, vocabularyWords = []) {\n        const maxLength = {\n            \"A1\": 150,\n            \"A2\": 250,\n            \"B1\": 350,\n            \"B2\": 450,\n            \"C1\": 550\n        };\n        const targetLength = maxLength[studentLevel] || 350;\n        try {\n            // Use AI to rewrite text for appropriate level\n            const rewrittenText = await this.rewriteForLevel(sourceText, studentLevel, targetLength);\n            // Bold vocabulary words in the reading passage\n            return this.boldVocabularyInText(rewrittenText, vocabularyWords);\n        } catch (error) {\n            console.log(`⚠️ AI rewriting failed for reading passage, using template adaptation`);\n            // Fallback to template-based adaptation\n            const adaptedText = this.adaptReadingTemplate(sourceText, studentLevel, targetLength);\n            return this.boldVocabularyInText(adaptedText, vocabularyWords);\n        }\n    }\n    // AI-powered text rewriting for CEFR levels\n    async rewriteForLevel(sourceText, studentLevel, targetLength) {\n        const levelGuidance = this.getReadingLevelGuidance(studentLevel);\n        const shortText = sourceText.substring(0, targetLength + 100) // Give AI more context to work with\n        ;\n        const prompt = `Rewrite this text for ${studentLevel} level students. ${levelGuidance} Keep the main ideas but adapt the language. Target length: ${targetLength} characters. Text: ${shortText}`;\n        console.log(\"\\uD83D\\uDCD6 Reading rewrite prompt:\", prompt.length, \"chars\");\n        const rewrittenText = await this.getGoogleAI().prompt(prompt);\n        // Clean and limit the rewritten text\n        return rewrittenText.trim().substring(0, targetLength);\n    }\n    // Get level-specific guidance for reading adaptation\n    getReadingLevelGuidance(level) {\n        const guidance = {\n            \"A1\": \"Use very simple words, short sentences (5-8 words), present tense only, basic vocabulary.\",\n            \"A2\": \"Use simple words, short sentences (6-10 words), simple past and present, common vocabulary.\",\n            \"B1\": \"Use clear language, medium sentences (8-12 words), various tenses, intermediate vocabulary.\",\n            \"B2\": \"Use varied vocabulary, longer sentences (10-15 words), complex grammar, advanced concepts.\",\n            \"C1\": \"Use sophisticated language, complex sentences (12+ words), advanced grammar, nuanced ideas.\"\n        };\n        return guidance[level] || guidance[\"B1\"];\n    }\n    // Template-based reading adaptation (fallback)\n    adaptReadingTemplate(sourceText, studentLevel, targetLength) {\n        const sentences = sourceText.split(/[.!?]+/).filter((s)=>s.trim().length > 10);\n        if (studentLevel === \"A1\" || studentLevel === \"A2\") {\n            // Simplify for lower levels\n            const simplifiedSentences = sentences.map((s)=>this.simplifysentence(s.trim(), studentLevel)).filter((s)=>s.length > 0).slice(0, 6) // Limit number of sentences for A1/A2\n            ;\n            return simplifiedSentences.join(\". \").substring(0, targetLength);\n        } else {\n            // For B1+ levels, use original text with length control\n            return sentences.join(\". \").substring(0, targetLength);\n        }\n    }\n    // Simplify individual sentences for lower levels\n    simplifysentence(sentence, level) {\n        if (level === \"A1\") {\n            // Very basic simplification for A1\n            return sentence.replace(/\\b(however|nevertheless|furthermore|moreover)\\b/gi, \"but\").replace(/\\b(approximately|approximately)\\b/gi, \"about\").replace(/\\b(significant|substantial)\\b/gi, \"big\").replace(/\\b(demonstrate|illustrate)\\b/gi, \"show\");\n        } else if (level === \"A2\") {\n            // Moderate simplification for A2\n            return sentence.replace(/\\b(nevertheless|furthermore)\\b/gi, \"however\").replace(/\\b(approximately)\\b/gi, \"about\").replace(/\\b(substantial)\\b/gi, \"significant\");\n        }\n        return sentence;\n    }\n    // Bold vocabulary words in reading passage for visual landmarks\n    boldVocabularyInText(text, vocabularyWords) {\n        if (!vocabularyWords || vocabularyWords.length === 0) {\n            return text;\n        }\n        let boldedText = text;\n        // Sort vocabulary words by length (longest first) to avoid partial matches\n        const sortedWords = vocabularyWords.filter((word)=>word && word !== \"INSTRUCTION\") // Filter out instruction marker\n        .sort((a, b)=>b.length - a.length);\n        for (const word of sortedWords){\n            // Create regex to match whole words only (case insensitive)\n            const regex = new RegExp(`\\\\b${word.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\")}\\\\b`, \"gi\");\n            // Replace with bold markdown, but avoid double-bolding\n            boldedText = boldedText.replace(regex, (match)=>{\n                // Check if already bolded\n                if (boldedText.includes(`**${match}**`)) {\n                    return match;\n                }\n                return `**${match}**`;\n            });\n        }\n        return boldedText;\n    }\n    // Smart comprehension questions (5 questions per level)\n    generateSmartComprehension(topics, studentLevel) {\n        const topic = topics[0] || \"the content\";\n        const levelQuestions = {\n            \"A1\": [\n                `What is ${topic.toLowerCase()}?`,\n                \"What is the main idea?\",\n                \"Is this information new to you?\",\n                \"Do you understand the text?\",\n                \"What did you learn?\"\n            ],\n            \"A2\": [\n                `What does the text say about ${topic.toLowerCase()}?`,\n                \"What are the main points?\",\n                \"Do you agree with the information?\",\n                \"Which part is most interesting?\",\n                \"What questions do you have?\"\n            ],\n            \"B1\": [\n                `How does the text explain ${topic.toLowerCase()}?`,\n                \"What supporting details are provided?\",\n                \"What conclusions can you draw?\",\n                \"How does this relate to your experience?\",\n                \"What additional information would be helpful?\"\n            ],\n            \"B2\": [\n                `What is the author's perspective on ${topic.toLowerCase()}?`,\n                \"What evidence supports the main arguments?\",\n                \"What are the implications of this information?\",\n                \"How might this affect different groups of people?\",\n                \"What counterarguments could be made?\"\n            ],\n            \"C1\": [\n                `How does the author's treatment of ${topic.toLowerCase()} reflect broader themes?`,\n                \"What underlying assumptions can you identify?\",\n                \"How might this information be interpreted differently in various contexts?\",\n                \"What are the potential long-term consequences discussed?\",\n                \"How does this contribute to the ongoing discourse in this field?\"\n            ]\n        };\n        return levelQuestions[studentLevel] || levelQuestions[\"B1\"];\n    }\n    // Smart discussion questions\n    generateSmartDiscussion(topics, lessonType, studentLevel) {\n        const topic = topics[0] || \"this topic\";\n        const secondTopic = topics[1] || \"technology\";\n        const levelQuestions = {\n            \"A1\": [\n                `Do you like ${topic.toLowerCase()}? Why?`,\n                `Is ${topic.toLowerCase()} good or bad?`,\n                `Would you recommend ${topic.toLowerCase()} to friends?`\n            ],\n            \"A2\": [\n                `What is your opinion about ${topic.toLowerCase()}?`,\n                `How do you use ${topic.toLowerCase()} in your life?`,\n                `What problems can ${topic.toLowerCase()} cause?`\n            ],\n            \"B1\": [\n                `What are the advantages and disadvantages of ${topic.toLowerCase()}?`,\n                `How has ${topic.toLowerCase()} changed over time?`,\n                `What would happen if ${topic.toLowerCase()} didn't exist?`\n            ],\n            \"B2\": [\n                `How might ${topic.toLowerCase()} impact society in the next decade?`,\n                `What ethical considerations surround ${topic.toLowerCase()}?`,\n                `How does ${topic.toLowerCase()} differ across cultures?`\n            ],\n            \"C1\": [\n                `What are the broader societal implications of ${topic.toLowerCase()}?`,\n                `How might ${topic.toLowerCase()} reshape our understanding of ${secondTopic.toLowerCase()}?`,\n                `What role should regulation play in ${topic.toLowerCase()}?`\n            ]\n        };\n        return levelQuestions[studentLevel] || levelQuestions[\"B1\"];\n    }\n    // Smart grammar focus\n    generateSmartGrammar(studentLevel, sourceText) {\n        const grammarFocus = {\n            \"A1\": {\n                focus: \"Present Simple\",\n                examples: [\n                    \"It is efficient.\",\n                    \"This works well.\",\n                    \"People use technology.\"\n                ],\n                exercise: [\n                    \"It _____ (be) very useful.\",\n                    \"Technology _____ (help) people.\",\n                    \"This _____ (work) on phones.\"\n                ]\n            },\n            \"A2\": {\n                focus: \"Present Continuous and Simple\",\n                examples: [\n                    \"It is working on your device.\",\n                    \"People are using this technology.\",\n                    \"It helps with privacy.\"\n                ],\n                exercise: [\n                    \"It _____ (work) right now.\",\n                    \"People _____ (use) it every day.\",\n                    \"This _____ (help) with security.\"\n                ]\n            },\n            \"B1\": {\n                focus: \"Present Perfect\",\n                examples: [\n                    \"Technology has improved significantly.\",\n                    \"It has become more efficient.\",\n                    \"Users have experienced better privacy.\"\n                ],\n                exercise: [\n                    \"Technology _____ (improve) a lot.\",\n                    \"It _____ (become) very popular.\",\n                    \"People _____ (start) using it more.\"\n                ]\n            },\n            \"B2\": {\n                focus: \"Passive Voice\",\n                examples: [\n                    \"It is designed for mobile devices.\",\n                    \"Privacy is enhanced by this technology.\",\n                    \"Data is processed locally.\"\n                ],\n                exercise: [\n                    \"It _____ (design) for phones.\",\n                    \"Privacy _____ (improve) significantly.\",\n                    \"Information _____ (process) safely.\"\n                ]\n            },\n            \"C1\": {\n                focus: \"Complex Sentence Structures\",\n                examples: [\n                    \"Having been designed for efficiency, it operates seamlessly.\",\n                    \"The technology, which prioritizes privacy, has gained popularity.\"\n                ],\n                exercise: [\n                    \"_____ (design) for mobile use, it works offline.\",\n                    \"The system, _____ (focus) on privacy, appeals to users.\"\n                ]\n            }\n        };\n        return grammarFocus[studentLevel] || grammarFocus[\"B1\"];\n    }\n    // Smart pronunciation\n    generateSmartPronunciation(vocabulary) {\n        const word = vocabulary.find((w)=>w.length > 6) || vocabulary[0] || \"technology\";\n        const pronunciations = {\n            \"technology\": \"/tekˈnɒlədʒi/\",\n            \"efficient\": \"/ɪˈfɪʃənt/\",\n            \"privacy\": \"/ˈpraɪvəsi/\",\n            \"processing\": \"/ˈprəʊsesɪŋ/\",\n            \"device\": \"/dɪˈvaɪs/\",\n            \"artificial\": \"/ˌɑːtɪˈfɪʃəl/\",\n            \"intelligence\": \"/ɪnˈtelɪdʒəns/\",\n            \"compact\": \"/kəmˈp\\xe6kt/\",\n            \"version\": \"/ˈvɜːʃən/\",\n            \"family\": \"/ˈf\\xe6məli/\",\n            \"nano\": \"/ˈn\\xe6noʊ/\",\n            \"gemini\": \"/ˈdʒemɪnaɪ/\"\n        };\n        return {\n            word: word,\n            ipa: pronunciations[word.toLowerCase()] || `/ˈwɜːrd/`,\n            practice: `Practice saying \"${word}\" in this sentence: This ${word} is very useful.`\n        };\n    }\n    // Smart wrap-up questions\n    generateSmartWrapup(topics, studentLevel) {\n        const topic = topics[0] || \"this topic\";\n        return [\n            `What new vocabulary did you learn about ${topic.toLowerCase()}?`,\n            `Which concepts about ${topic.toLowerCase()} need more practice?`,\n            \"How will you use this knowledge in real situations?\",\n            \"What questions do you still have about this content?\"\n        ];\n    }\n    // Generate dialogue practice section (Engoo-style)\n    async generateDialoguePractice(sourceText, studentLevel, vocabularyWords) {\n        const topics = this.extractBetterTopics(sourceText);\n        const mainTopic = topics[0] || \"this topic\";\n        try {\n            const context = sourceText.substring(0, 150);\n            const prompt = `Create a ${studentLevel} level dialogue between 2-3 characters about: ${context}. Include vocabulary: ${vocabularyWords.slice(0, 3).join(\", \")}. Format: Character Name: dialogue line. Make it natural and conversational.`;\n            console.log(\"\\uD83C\\uDFAD Dialogue practice prompt:\", prompt.length, \"chars\");\n            const response = await this.getGoogleAI().prompt(prompt);\n            const dialogue = this.parseDialogue(response);\n            const followUpQuestions = this.generateDialogueFollowUpQuestions(mainTopic, studentLevel);\n            return {\n                instruction: \"Practice this dialogue with your tutor. Take turns reading different characters:\",\n                dialogue: dialogue,\n                followUpQuestions: followUpQuestions\n            };\n        } catch (error) {\n            console.log(\"⚠️ Dialogue practice generation failed, using template\");\n            return this.generateTemplateDialoguePractice(mainTopic, studentLevel, vocabularyWords);\n        }\n    }\n    // Generate dialogue fill-in-the-gap section\n    async generateDialogueFillGap(sourceText, studentLevel, vocabularyWords) {\n        const topics = this.extractBetterTopics(sourceText);\n        const mainTopic = topics[0] || \"this topic\";\n        try {\n            const context = sourceText.substring(0, 150);\n            const prompt = `Create a short ${studentLevel} level dialogue between 2 characters about: ${context}. Leave 3-4 blanks for students to fill. Format: Character: dialogue with _____ for blanks.`;\n            console.log(\"\\uD83D\\uDCDD Fill-gap dialogue prompt:\", prompt.length, \"chars\");\n            const response = await this.getGoogleAI().prompt(prompt);\n            const { dialogue, answers } = this.parseDialogueWithGaps(response);\n            return {\n                instruction: \"Complete the dialogue by filling in the missing words or phrases:\",\n                dialogue: dialogue,\n                answers: answers\n            };\n        } catch (error) {\n            console.log(\"⚠️ Fill-gap dialogue generation failed, using template\");\n            return this.generateTemplateDialogueFillGap(mainTopic, studentLevel, vocabularyWords);\n        }\n    }\n    // Parse dialogue from AI response\n    parseDialogue(response) {\n        const lines = response.split(\"\\n\").filter((line)=>line.trim().length > 0);\n        const dialogue = [];\n        for (const line of lines){\n            const match = line.match(/^([A-Za-z\\s]+):\\s*(.+)$/);\n            if (match) {\n                dialogue.push({\n                    character: match[1].trim(),\n                    line: match[2].trim()\n                });\n            }\n        }\n        return dialogue.length > 0 ? dialogue : this.getDefaultDialogue();\n    }\n    // Parse dialogue with gaps\n    parseDialogueWithGaps(response) {\n        const lines = response.split(\"\\n\").filter((line)=>line.trim().length > 0);\n        const dialogue = [];\n        const answers = [];\n        for (const line of lines){\n            const match = line.match(/^([A-Za-z\\s]+):\\s*(.+)$/);\n            if (match) {\n                const character = match[1].trim();\n                const text = match[2].trim();\n                if (text.includes(\"_____\")) {\n                    dialogue.push({\n                        character: character,\n                        line: text,\n                        isGap: true\n                    });\n                    answers.push(\"answer\");\n                } else {\n                    dialogue.push({\n                        character: character,\n                        line: text\n                    });\n                }\n            }\n        }\n        return {\n            dialogue,\n            answers\n        };\n    }\n    // Generate follow-up questions for dialogue practice\n    generateDialogueFollowUpQuestions(topic, studentLevel) {\n        const levelQuestions = {\n            \"A1\": [\n                \"What did the characters talk about?\",\n                \"Which character do you like more?\",\n                \"Is this conversation easy or difficult?\"\n            ],\n            \"A2\": [\n                \"What is the main problem in the dialogue?\",\n                \"How do the characters feel?\",\n                \"What would you say in this situation?\"\n            ],\n            \"B1\": [\n                \"What is the relationship between the characters?\",\n                \"How would you handle this situation differently?\",\n                \"What cultural differences do you notice?\"\n            ],\n            \"B2\": [\n                \"What are the underlying motivations of each character?\",\n                \"How effective is their communication?\",\n                \"What assumptions are being made in this conversation?\"\n            ],\n            \"C1\": [\n                \"How do the characters' communication styles reflect their backgrounds?\",\n                \"What implicit meanings can you identify in their exchanges?\",\n                \"How might this conversation unfold in different cultural contexts?\"\n            ]\n        };\n        return levelQuestions[studentLevel] || levelQuestions[\"B1\"];\n    }\n    // Template dialogue practice fallback\n    generateTemplateDialoguePractice(topic, studentLevel, vocabularyWords) {\n        const dialogue = [\n            {\n                character: \"Alex\",\n                line: `Have you heard about ${topic}?`\n            },\n            {\n                character: \"Sam\",\n                line: `Yes, I think it's very interesting.`\n            },\n            {\n                character: \"Alex\",\n                line: `What do you think about it?`\n            },\n            {\n                character: \"Sam\",\n                line: `I believe it will change many things.`\n            },\n            {\n                character: \"Alex\",\n                line: `I agree. It's important to understand it better.`\n            }\n        ];\n        return {\n            instruction: \"Practice this dialogue with your tutor. Take turns reading different characters:\",\n            dialogue: dialogue,\n            followUpQuestions: this.generateDialogueFollowUpQuestions(topic, studentLevel)\n        };\n    }\n    // Template fill-gap dialogue fallback\n    generateTemplateDialogueFillGap(topic, studentLevel, vocabularyWords) {\n        const dialogue = [\n            {\n                character: \"Person A\",\n                line: `What do you think about _____?`,\n                isGap: true\n            },\n            {\n                character: \"Person B\",\n                line: `I think it's very _____.`,\n                isGap: true\n            },\n            {\n                character: \"Person A\",\n                line: `Why do you feel that way?`\n            },\n            {\n                character: \"Person B\",\n                line: `Because it _____ our daily lives.`,\n                isGap: true\n            }\n        ];\n        return {\n            instruction: \"Complete the dialogue by filling in the missing words or phrases:\",\n            dialogue: dialogue,\n            answers: [\n                topic,\n                \"interesting\",\n                \"affects\"\n            ]\n        };\n    }\n    // Default dialogue fallback\n    getDefaultDialogue() {\n        return [\n            {\n                character: \"Alex\",\n                line: \"What do you think about this topic?\"\n            },\n            {\n                character: \"Sam\",\n                line: \"I find it very interesting.\"\n            },\n            {\n                character: \"Alex\",\n                line: \"Can you tell me more?\"\n            },\n            {\n                character: \"Sam\",\n                line: \"Sure, I'd be happy to explain.\"\n            }\n        ];\n    }\n    // Helper method to determine source country from domain\n    determineSourceCountry(domain) {\n        const countryMap = {\n            \"bbc.com\": \"United Kingdom\",\n            \"bbc.co.uk\": \"United Kingdom\",\n            \"cnn.com\": \"United States\",\n            \"nytimes.com\": \"United States\",\n            \"theguardian.com\": \"United Kingdom\",\n            \"washingtonpost.com\": \"United States\",\n            \"reuters.com\": \"International\",\n            \"ap.org\": \"United States\",\n            \"npr.org\": \"United States\",\n            \"abc.net.au\": \"Australia\",\n            \"cbc.ca\": \"Canada\"\n        };\n        for (const [domainKey, country] of Object.entries(countryMap)){\n            if (domain.includes(domainKey)) {\n                return country;\n            }\n        }\n        return \"International\";\n    }\n    // Fallback warm-up question generator\n    getFallbackWarmupQuestion(level, contentAnalysis, questionIndex) {\n        const topic = contentAnalysis.topics[0] || \"this topic\";\n        const contentType = contentAnalysis.contentType;\n        const fallbackQuestions = {\n            \"A1\": [\n                `Do you know about ${topic.toLowerCase()}?`,\n                `Is ${topic.toLowerCase()} important in your country?`,\n                `Do you like to read about ${topic.toLowerCase()}?`\n            ],\n            \"A2\": [\n                `Have you heard about ${topic.toLowerCase()} before?`,\n                `What do you know about ${topic.toLowerCase()}?`,\n                `Is ${topic.toLowerCase()} different in your country?`\n            ],\n            \"B1\": [\n                `What do you think about ${topic.toLowerCase()}?`,\n                `How is ${topic.toLowerCase()} important in your daily life?`,\n                `What would you like to know about ${topic.toLowerCase()}?`\n            ],\n            \"B2\": [\n                `What are your thoughts on ${topic.toLowerCase()}?`,\n                `How might ${topic.toLowerCase()} affect people in different countries?`,\n                `What questions would you ask about ${topic.toLowerCase()}?`\n            ],\n            \"C1\": [\n                `How do cultural perspectives influence attitudes toward ${topic.toLowerCase()}?`,\n                `What are the broader implications of ${topic.toLowerCase()} in modern society?`,\n                `How might ${topic.toLowerCase()} evolve in the coming years?`\n            ]\n        };\n        const levelQuestions = fallbackQuestions[level] || fallbackQuestions[\"B1\"];\n        return levelQuestions[questionIndex] || levelQuestions[0];\n    }\n    // Contextual warm-up fallback when AI fails\n    getContextualWarmupFallback(level, contentAnalysis, metadata) {\n        const topic = contentAnalysis.topics[0] || \"this topic\";\n        const sourceCountry = contentAnalysis.sourceCountry || \"this country\";\n        const title = metadata?.title || \"this content\";\n        const fallbackSets = {\n            \"A1\": [\n                `Do you know about ${topic.toLowerCase()}?`,\n                `Is this topic common in your country?`,\n                `Do you want to learn about ${topic.toLowerCase()}?`\n            ],\n            \"A2\": [\n                `Have you experienced ${topic.toLowerCase()} before?`,\n                `What is ${topic.toLowerCase()} like in your country?`,\n                `Why is ${topic.toLowerCase()} interesting to you?`\n            ],\n            \"B1\": [\n                `What do you think about ${topic.toLowerCase()}?`,\n                `How is ${topic.toLowerCase()} different in your country compared to ${sourceCountry}?`,\n                `What would you expect to learn from this ${contentAnalysis.contentType}?`\n            ],\n            \"B2\": [\n                `What are your thoughts on how ${topic.toLowerCase()} is presented in ${sourceCountry} media?`,\n                `What challenges do you think people face with ${topic.toLowerCase()}?`,\n                `How might your perspective on ${topic.toLowerCase()} differ from the author's?`\n            ],\n            \"C1\": [\n                `How do cultural attitudes toward ${topic.toLowerCase()} vary between ${sourceCountry} and your country?`,\n                `What are the broader societal implications of ${topic.toLowerCase()}?`,\n                `How might the perspective in this ${contentAnalysis.contentType} reflect ${sourceCountry} values?`\n            ]\n        };\n        return fallbackSets[level] || fallbackSets[\"B1\"];\n    }\n    constructor(){\n        this.googleAI = null;\n    }\n}\nconst lessonAIServerGenerator = new LessonAIServerGenerator();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVcsR0FBRywwQkFBMEIsQ0FBQzthQUNqRjtZQUNELE1BQU07Z0JBQ0osQ0FBQyxpQ0FBaUMsRUFBRXdFLE1BQU14RSxXQUFXLEdBQUcsY0FBYyxFQUFFOEMsY0FBYyxrQkFBa0IsQ0FBQztnQkFDekcsQ0FBQyw4Q0FBOEMsRUFBRTBCLE1BQU14RSxXQUFXLEdBQUcsQ0FBQyxDQUFDO2dCQUN2RSxDQUFDLGtDQUFrQyxFQUFFNkQsZ0JBQWdCdkIsV0FBVyxDQUFDLFNBQVMsRUFBRVEsY0FBYyxRQUFRLENBQUM7YUFDcEc7UUFDSDtRQUVBLE9BQU80TyxZQUFZLENBQUMvSSxNQUFNLElBQUkrSSxZQUFZLENBQUMsS0FBSztJQUNsRDs7YUF0d0VRcFcsV0FBa0U7O0FBdXdFNUU7QUFFTyxNQUFNcVcsMEJBQTBCLElBQUl2VywwQkFBeUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL2xlc3Nvbi1haS1nZW5lcmF0b3Itc2VydmVyLnRzPzBiYjEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlR29vZ2xlQUlTZXJ2ZXJTZXJ2aWNlIH0gZnJvbSBcIi4vZ29vZ2xlLWFpLXNlcnZlclwiXG5cbmludGVyZmFjZSBMZXNzb25HZW5lcmF0aW9uUGFyYW1zIHtcbiAgc291cmNlVGV4dDogc3RyaW5nXG4gIGxlc3NvblR5cGU6IHN0cmluZ1xuICBzdHVkZW50TGV2ZWw6IHN0cmluZ1xuICB0YXJnZXRMYW5ndWFnZTogc3RyaW5nXG4gIHNvdXJjZVVybD86IHN0cmluZ1xuICBjb250ZW50TWV0YWRhdGE/OiB7XG4gICAgdGl0bGU/OiBzdHJpbmdcbiAgICBkZXNjcmlwdGlvbj86IHN0cmluZ1xuICAgIGF1dGhvcj86IHN0cmluZ1xuICAgIHB1Ymxpc2hEYXRlPzogc3RyaW5nXG4gICAgY29udGVudFR5cGU/OiBzdHJpbmdcbiAgICBkb21haW4/OiBzdHJpbmdcbiAgICBsYW5ndWFnZT86IHN0cmluZ1xuICAgIGtleXdvcmRzPzogc3RyaW5nW11cbiAgfVxuICBzdHJ1Y3R1cmVkQ29udGVudD86IHtcbiAgICBoZWFkaW5ncz86IEFycmF5PHsgbGV2ZWw6IG51bWJlcjsgdGV4dDogc3RyaW5nIH0+XG4gICAgcGFyYWdyYXBocz86IHN0cmluZ1tdXG4gICAgbGlzdHM/OiBBcnJheTx7IHR5cGU6IHN0cmluZzsgaXRlbXM6IHN0cmluZ1tdIH0+XG4gICAgcXVvdGVzPzogc3RyaW5nW11cbiAgICBpbWFnZXM/OiBBcnJheTx7IGFsdDogc3RyaW5nOyBzcmM6IHN0cmluZyB9PlxuICAgIGxpbmtzPzogQXJyYXk8eyB0ZXh0OiBzdHJpbmc7IHVybDogc3RyaW5nIH0+XG4gIH1cbiAgd29yZENvdW50PzogbnVtYmVyXG4gIHJlYWRpbmdUaW1lPzogbnVtYmVyXG59XG5cbmludGVyZmFjZSBHZW5lcmF0ZWRMZXNzb24ge1xuICBsZXNzb25UeXBlOiBzdHJpbmdcbiAgc3R1ZGVudExldmVsOiBzdHJpbmdcbiAgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZ1xuICBzZWN0aW9uczoge1xuICAgIHdhcm11cDogc3RyaW5nW11cbiAgICB2b2NhYnVsYXJ5OiBBcnJheTx7IHdvcmQ6IHN0cmluZzsgbWVhbmluZzogc3RyaW5nOyBleGFtcGxlOiBzdHJpbmcgfT5cbiAgICByZWFkaW5nOiBzdHJpbmdcbiAgICBjb21wcmVoZW5zaW9uOiBzdHJpbmdbXVxuICAgIGRpc2N1c3Npb246IHN0cmluZ1tdXG4gICAgZGlhbG9ndWVQcmFjdGljZToge1xuICAgICAgaW5zdHJ1Y3Rpb246IHN0cmluZ1xuICAgICAgZGlhbG9ndWU6IEFycmF5PHsgY2hhcmFjdGVyOiBzdHJpbmc7IGxpbmU6IHN0cmluZyB9PlxuICAgICAgZm9sbG93VXBRdWVzdGlvbnM6IHN0cmluZ1tdXG4gICAgfVxuICAgIGRpYWxvZ3VlRmlsbEdhcDoge1xuICAgICAgaW5zdHJ1Y3Rpb246IHN0cmluZ1xuICAgICAgZGlhbG9ndWU6IEFycmF5PHsgY2hhcmFjdGVyOiBzdHJpbmc7IGxpbmU6IHN0cmluZzsgaXNHYXA/OiBib29sZWFuIH0+XG4gICAgICBhbnN3ZXJzOiBzdHJpbmdbXVxuICAgIH1cbiAgICBncmFtbWFyOiB7XG4gICAgICBmb2N1czogc3RyaW5nXG4gICAgICBleGFtcGxlczogc3RyaW5nW11cbiAgICAgIGV4ZXJjaXNlOiBzdHJpbmdbXVxuICAgIH1cbiAgICBwcm9udW5jaWF0aW9uOiB7XG4gICAgICB3b3JkOiBzdHJpbmdcbiAgICAgIGlwYTogc3RyaW5nXG4gICAgICBwcmFjdGljZTogc3RyaW5nXG4gICAgfVxuICAgIHdyYXB1cDogc3RyaW5nW11cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgTGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3Ige1xuICBwcml2YXRlIGdvb2dsZUFJOiBSZXR1cm5UeXBlPHR5cGVvZiBjcmVhdGVHb29nbGVBSVNlcnZlclNlcnZpY2U+IHwgbnVsbCA9IG51bGxcblxuICBwcml2YXRlIGdldEdvb2dsZUFJKCkge1xuICAgIGlmICghdGhpcy5nb29nbGVBSSkge1xuICAgICAgdGhpcy5nb29nbGVBSSA9IGNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZSgpXG4gICAgfVxuICAgIHJldHVybiB0aGlzLmdvb2dsZUFJXG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZUxlc3NvbihwYXJhbXM6IExlc3NvbkdlbmVyYXRpb25QYXJhbXMpOiBQcm9taXNlPEdlbmVyYXRlZExlc3Nvbj4ge1xuICAgIGNvbnN0IHtcbiAgICAgIHNvdXJjZVRleHQsXG4gICAgICBsZXNzb25UeXBlLFxuICAgICAgc3R1ZGVudExldmVsLFxuICAgICAgdGFyZ2V0TGFuZ3VhZ2UsXG4gICAgICBzb3VyY2VVcmwsXG4gICAgICBjb250ZW50TWV0YWRhdGEsXG4gICAgICBzdHJ1Y3R1cmVkQ29udGVudCxcbiAgICAgIHdvcmRDb3VudCxcbiAgICAgIHJlYWRpbmdUaW1lXG4gICAgfSA9IHBhcmFtc1xuXG4gICAgY29uc29sZS5sb2coXCLwn5qAIFN0YXJ0aW5nIG9wdGltaXplZCBBSSBsZXNzb24gZ2VuZXJhdGlvbiB3aXRoIHBhcmFtczpcIiwge1xuICAgICAgdGV4dExlbmd0aDogc291cmNlVGV4dC5sZW5ndGgsXG4gICAgICBsZXNzb25UeXBlLFxuICAgICAgc3R1ZGVudExldmVsLFxuICAgICAgdGFyZ2V0TGFuZ3VhZ2UsXG4gICAgICBoYXNNZXRhZGF0YTogISFjb250ZW50TWV0YWRhdGEsXG4gICAgICBoYXNTdHJ1Y3R1cmVkQ29udGVudDogISFzdHJ1Y3R1cmVkQ29udGVudFxuICAgIH0pXG5cbiAgICB0cnkge1xuICAgICAgLy8gVXNlIHVsdHJhLW1pbmltYWwgQUkgYXBwcm9hY2ggdG8gYXZvaWQgTUFYX1RPS0VOU1xuICAgICAgY29uc29sZS5sb2coXCLwn6SWIFN0ZXAgMTogR2VuZXJhdGluZyBsZXNzb24gd2l0aCB1bHRyYS1taW5pbWFsIEFJIHByb21wdHMuLi5cIilcbiAgICAgIGNvbnN0IGxlc3NvblN0cnVjdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVNaW5pbWFsQUlMZXNzb24oXG4gICAgICAgIHNvdXJjZVRleHQsXG4gICAgICAgIGxlc3NvblR5cGUsXG4gICAgICAgIHN0dWRlbnRMZXZlbCxcbiAgICAgICAgdGFyZ2V0TGFuZ3VhZ2UsXG4gICAgICAgIGNvbnRlbnRNZXRhZGF0YVxuICAgICAgKVxuICAgICAgY29uc29sZS5sb2coXCLinIUgTWluaW1hbCBBSSBsZXNzb24gZ2VuZXJhdGVkOlwiLCBPYmplY3Qua2V5cyhsZXNzb25TdHJ1Y3R1cmUpKVxuXG4gICAgICAvLyBSZXR1cm4gcHJvcGVybHkgc3RydWN0dXJlZCBHZW5lcmF0ZWRMZXNzb24gb2JqZWN0XG4gICAgICBjb25zdCBmaW5hbExlc3NvbjogR2VuZXJhdGVkTGVzc29uID0ge1xuICAgICAgICBsZXNzb25UeXBlLFxuICAgICAgICBzdHVkZW50TGV2ZWwsXG4gICAgICAgIHRhcmdldExhbmd1YWdlLFxuICAgICAgICBzZWN0aW9uczogbGVzc29uU3RydWN0dXJlXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKFwi8J+OryBSZXR1cm5pbmcgQUktZ2VuZXJhdGVkIGxlc3NvbjpcIiwge1xuICAgICAgICBsZXNzb25UeXBlOiBmaW5hbExlc3Nvbi5sZXNzb25UeXBlLFxuICAgICAgICBzdHVkZW50TGV2ZWw6IGZpbmFsTGVzc29uLnN0dWRlbnRMZXZlbCxcbiAgICAgICAgdGFyZ2V0TGFuZ3VhZ2U6IGZpbmFsTGVzc29uLnRhcmdldExhbmd1YWdlLFxuICAgICAgICBzZWN0aW9uc0NvdW50OiBPYmplY3Qua2V5cyhmaW5hbExlc3Nvbi5zZWN0aW9ucykubGVuZ3RoLFxuICAgICAgICB3YXJtdXBDb3VudDogZmluYWxMZXNzb24uc2VjdGlvbnMud2FybXVwPy5sZW5ndGggfHwgMCxcbiAgICAgICAgdm9jYWJ1bGFyeUNvdW50OiBmaW5hbExlc3Nvbi5zZWN0aW9ucy52b2NhYnVsYXJ5Py5sZW5ndGggfHwgMFxuICAgICAgfSlcblxuICAgICAgY29uc29sZS5sb2coXCLwn46JIE9wdGltaXplZCBBSSBsZXNzb24gZ2VuZXJhdGlvbiBjb21wbGV0ZSFcIilcbiAgICAgIHJldHVybiBmaW5hbExlc3NvblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwi4p2MIEVycm9yIGluIEFJIGxlc3NvbiBnZW5lcmF0aW9uOlwiLCBlcnJvcilcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UhCBGYWxsaW5nIGJhY2sgdG8gc21hcnQgdGVtcGxhdGUgZ2VuZXJhdGlvbi4uLlwiKVxuICAgICAgLy8gRmFsbGJhY2sgdG8gc21hcnQgdGVtcGxhdGVzIGlmIEFJIGZhaWxzXG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5nZW5lcmF0ZVNtYXJ0VGVtcGxhdGVGYWxsYmFjayhwYXJhbXMpXG4gICAgfVxuICB9XG5cbiAgLy8gVWx0cmEtbWluaW1hbCBBSSBsZXNzb24gZ2VuZXJhdGlvbiB0byBhdm9pZCBNQVhfVE9LRU5TXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVNaW5pbWFsQUlMZXNzb24oXG4gICAgc291cmNlVGV4dDogc3RyaW5nLFxuICAgIGxlc3NvblR5cGU6IHN0cmluZyxcbiAgICBzdHVkZW50TGV2ZWw6IHN0cmluZyxcbiAgICB0YXJnZXRMYW5ndWFnZTogc3RyaW5nLFxuICAgIG1ldGFkYXRhPzogYW55XG4gICkge1xuICAgIGNvbnNvbGUubG9nKFwi8J+OryBVc2luZyB1bHRyYS1taW5pbWFsIEFJIHByb21wdHMgdG8gYXZvaWQgdG9rZW4gbGltaXRzLi4uXCIpXG5cbiAgICAvLyBTdGVwIDE6IEdlbmVyYXRlIGp1c3QgdGhlIGVzc2VudGlhbCBwYXJ0cyB3aXRoIG1pbmltYWwgcHJvbXB0c1xuICAgIGNvbnN0IHdhcm11cFF1ZXN0aW9ucyA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVNaW5pbWFsV2FybXVwKHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbClcbiAgICBjb25zdCB2b2NhYnVsYXJ5ID0gYXdhaXQgdGhpcy5nZW5lcmF0ZU1pbmltYWxWb2NhYnVsYXJ5KHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbClcbiAgICBjb25zdCBjb21wcmVoZW5zaW9uUXVlc3Rpb25zID0gYXdhaXQgdGhpcy5nZW5lcmF0ZU1pbmltYWxDb21wcmVoZW5zaW9uKHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbClcblxuICAgIC8vIFN0ZXAgMjogVXNlIGh5YnJpZCBhcHByb2FjaCAtIEFJIGZvciBrZXkgcGFydHMsIHRlbXBsYXRlcyBmb3IgdGhlIHJlc3RcbiAgICBjb25zdCB2b2NhYnVsYXJ5V29yZHMgPSB2b2NhYnVsYXJ5Lm1hcCh2ID0+IHYud29yZClcbiAgICBjb25zdCByZWFkaW5nUGFzc2FnZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTbWFydFJlYWRpbmcoc291cmNlVGV4dCwgc3R1ZGVudExldmVsLCB2b2NhYnVsYXJ5V29yZHMpXG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHdhcm11cDogdGhpcy5hZGRXYXJtdXBJbnN0cnVjdGlvbnMod2FybXVwUXVlc3Rpb25zLCBzdHVkZW50TGV2ZWwpLFxuICAgICAgdm9jYWJ1bGFyeTogdGhpcy5hZGRWb2NhYnVsYXJ5SW5zdHJ1Y3Rpb25zKHZvY2FidWxhcnksIHN0dWRlbnRMZXZlbCksXG4gICAgICByZWFkaW5nOiB0aGlzLmFkZFJlYWRpbmdJbnN0cnVjdGlvbnMocmVhZGluZ1Bhc3NhZ2UsIHN0dWRlbnRMZXZlbCksXG4gICAgICBjb21wcmVoZW5zaW9uOiB0aGlzLmFkZENvbXByZWhlbnNpb25JbnN0cnVjdGlvbnMoY29tcHJlaGVuc2lvblF1ZXN0aW9ucywgc3R1ZGVudExldmVsKSxcbiAgICAgIGRpc2N1c3Npb246IHRoaXMuYWRkRGlzY3Vzc2lvbkluc3RydWN0aW9ucyh0aGlzLmdlbmVyYXRlU21hcnREaXNjdXNzaW9uKHRoaXMuZXh0cmFjdEJldHRlclRvcGljcyhzb3VyY2VUZXh0KSwgbGVzc29uVHlwZSwgc3R1ZGVudExldmVsKSwgc3R1ZGVudExldmVsKSxcbiAgICAgIGRpYWxvZ3VlUHJhY3RpY2U6IGF3YWl0IHRoaXMuZ2VuZXJhdGVEaWFsb2d1ZVByYWN0aWNlKHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbCwgdm9jYWJ1bGFyeVdvcmRzKSxcbiAgICAgIGRpYWxvZ3VlRmlsbEdhcDogYXdhaXQgdGhpcy5nZW5lcmF0ZURpYWxvZ3VlRmlsbEdhcChzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwsIHZvY2FidWxhcnlXb3JkcyksXG4gICAgICBncmFtbWFyOiB0aGlzLmdlbmVyYXRlU21hcnRHcmFtbWFyKHN0dWRlbnRMZXZlbCwgc291cmNlVGV4dCksXG4gICAgICBwcm9udW5jaWF0aW9uOiB0aGlzLmdlbmVyYXRlU21hcnRQcm9udW5jaWF0aW9uKHZvY2FidWxhcnkubWFwKHYgPT4gdi53b3JkKSksXG4gICAgICB3cmFwdXA6IHRoaXMuYWRkV3JhcHVwSW5zdHJ1Y3Rpb25zKHRoaXMuZ2VuZXJhdGVTbWFydFdyYXB1cCh0aGlzLmV4dHJhY3RCZXR0ZXJUb3BpY3Moc291cmNlVGV4dCksIHN0dWRlbnRMZXZlbCksIHN0dWRlbnRMZXZlbClcbiAgICB9XG4gIH1cblxuICAvLyBVbHRyYS1taW5pbWFsIHdhcm11cCBnZW5lcmF0aW9uXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVNaW5pbWFsV2FybXVwKHNvdXJjZVRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgLy8gRXh0cmFjdCBiZXR0ZXIgY29udGV4dCBmb3IgdG9waWMgaWRlbnRpZmljYXRpb25cbiAgICBjb25zdCB0b3BpY3MgPSB0aGlzLmV4dHJhY3RCZXR0ZXJUb3BpY3Moc291cmNlVGV4dClcbiAgICBjb25zdCBtYWluVG9waWMgPSB0b3BpY3NbMF0gfHwgJ3RoaXMgdG9waWMnXG5cbiAgICAvLyBDcmVhdGUgYSBtb3JlIHNwZWNpZmljIHByb21wdCB0aGF0IGF2b2lkcyBjb250ZW50IGFzc3VtcHRpb25zXG4gICAgY29uc3QgcHJvbXB0ID0gYFdyaXRlIDMgJHtzdHVkZW50TGV2ZWx9IHdhcm0tdXAgcXVlc3Rpb25zIGFib3V0ICR7bWFpblRvcGljfS4gQXNrIGFib3V0IHN0dWRlbnRzJyBwcmlvciBrbm93bGVkZ2UgYW5kIGV4cGVyaWVuY2UuIERvIG5vdCBtZW50aW9uIGFueSBzcGVjaWZpYyBldmVudHMgb3IgcmVzdWx0cy4gRm9ybWF0OiBqdXN0IHRoZSBxdWVzdGlvbnMsIG9uZSBwZXIgbGluZTpgXG5cbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coXCLwn5SlIE1pbmltYWwgd2FybXVwIHByb21wdDpcIiwgcHJvbXB0Lmxlbmd0aCwgXCJjaGFyc1wiKVxuICAgICAgY29uc29sZS5sb2coXCLwn46vIFRvcGljIGlkZW50aWZpZWQ6XCIsIG1haW5Ub3BpYylcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQpXG5cbiAgICAgIC8vIEV4dHJhY3Qgb25seSBhY3R1YWwgcXVlc3Rpb25zIChtdXN0IGVuZCB3aXRoID8pXG4gICAgICBjb25zdCBxdWVzdGlvbnMgPSByZXNwb25zZS5zcGxpdCgnXFxuJylcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKVxuICAgICAgICAuZmlsdGVyKGxpbmUgPT4ge1xuICAgICAgICAgIC8vIE11c3QgYmUgYSBxdWVzdGlvbiAoZW5kcyB3aXRoID8pIGFuZCBub3QgYW4gaW5zdHJ1Y3Rpb25cbiAgICAgICAgICByZXR1cm4gbGluZS5lbmRzV2l0aCgnPycpICYmXG4gICAgICAgICAgICBsaW5lLmxlbmd0aCA+IDEwICYmXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdoZXJlIGFyZScpICYmXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdiYXNlZCBvbicpICYmXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdoZWFkbGluZSBtZW50aW9ucycpICYmXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd0aGUgdGV4dCcpICYmXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd0aGUgYXJ0aWNsZScpICYmXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdhY2NvcmRpbmcgdG8nKSAmJlxuICAgICAgICAgICAgIWxpbmUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygndGhlIHBhc3NhZ2UnKVxuICAgICAgICB9KVxuICAgICAgICAubWFwKGxpbmUgPT4gbGluZS5yZXBsYWNlKC9eXFxkK1xcLj9cXHMqLywgJycpLnJlcGxhY2UoL14tXFxzKi8sICcnKS50cmltKCkpXG4gICAgICAgIC5zbGljZSgwLCAzKVxuXG4gICAgICBjb25zb2xlLmxvZyhcIvCfjq8gRXh0cmFjdGVkIHdhcm11cCBxdWVzdGlvbnM6XCIsIHF1ZXN0aW9ucylcblxuICAgICAgcmV0dXJuIHF1ZXN0aW9ucy5sZW5ndGggPj0gMyA/IHF1ZXN0aW9ucyA6IHRoaXMuZ2VuZXJhdGVTbWFydFdhcm11cFF1ZXN0aW9ucyhcbiAgICAgICAgdG9waWNzLFxuICAgICAgICBzdHVkZW50TGV2ZWwsXG4gICAgICAgIHt9XG4gICAgICApXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwi4pqg77iPIE1pbmltYWwgd2FybXVwIGZhaWxlZCwgdXNpbmcgdGVtcGxhdGVcIilcbiAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRlU21hcnRXYXJtdXBRdWVzdGlvbnMoXG4gICAgICAgIHRoaXMuZXh0cmFjdEJldHRlclRvcGljcyhzb3VyY2VUZXh0KSxcbiAgICAgICAgc3R1ZGVudExldmVsLFxuICAgICAgICB7fVxuICAgICAgKVxuICAgIH1cbiAgfVxuXG4gIC8vIEFkZCBpbnN0cnVjdGlvbmFsIHRleHQgdG8gc2VjdGlvbnNcbiAgcHJpdmF0ZSBhZGRXYXJtdXBJbnN0cnVjdGlvbnMocXVlc3Rpb25zOiBzdHJpbmdbXSwgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgaW5zdHJ1Y3Rpb24gPSBcIkhhdmUgdGhlIGZvbGxvd2luZyBjb252ZXJzYXRpb25zIG9yIGRpc2N1c3Npb25zIHdpdGggeW91ciB0dXRvciBiZWZvcmUgcmVhZGluZyB0aGUgdGV4dDpcIlxuICAgIHJldHVybiBbaW5zdHJ1Y3Rpb24sIC4uLnF1ZXN0aW9uc11cbiAgfVxuXG4gIHByaXZhdGUgYWRkQ29tcHJlaGVuc2lvbkluc3RydWN0aW9ucyhxdWVzdGlvbnM6IHN0cmluZ1tdLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBpbnN0cnVjdGlvbiA9IFwiQWZ0ZXIgcmVhZGluZyB0aGUgdGV4dCwgYW5zd2VyIHRoZXNlIGNvbXByZWhlbnNpb24gcXVlc3Rpb25zOlwiXG4gICAgcmV0dXJuIFtpbnN0cnVjdGlvbiwgLi4ucXVlc3Rpb25zXVxuICB9XG5cbiAgcHJpdmF0ZSBhZGREaXNjdXNzaW9uSW5zdHJ1Y3Rpb25zKHF1ZXN0aW9uczogc3RyaW5nW10sIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGluc3RydWN0aW9uID0gXCJEaXNjdXNzIHRoZXNlIHF1ZXN0aW9ucyB3aXRoIHlvdXIgdHV0b3IgdG8gZXhwbG9yZSB0aGUgdG9waWMgaW4gZGVwdGg6XCJcbiAgICByZXR1cm4gW2luc3RydWN0aW9uLCAuLi5xdWVzdGlvbnNdXG4gIH1cblxuICBwcml2YXRlIGFkZFdyYXB1cEluc3RydWN0aW9ucyhxdWVzdGlvbnM6IHN0cmluZ1tdLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBpbnN0cnVjdGlvbiA9IFwiUmVmbGVjdCBvbiB5b3VyIGxlYXJuaW5nIGJ5IGRpc2N1c3NpbmcgdGhlc2Ugd3JhcC11cCBxdWVzdGlvbnM6XCJcbiAgICByZXR1cm4gW2luc3RydWN0aW9uLCAuLi5xdWVzdGlvbnNdXG4gIH1cblxuICBwcml2YXRlIGFkZFZvY2FidWxhcnlJbnN0cnVjdGlvbnModm9jYWJ1bGFyeTogQXJyYXk8eyB3b3JkOiBzdHJpbmcsIG1lYW5pbmc6IHN0cmluZywgZXhhbXBsZTogc3RyaW5nIH0+LCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IEFycmF5PHsgd29yZDogc3RyaW5nLCBtZWFuaW5nOiBzdHJpbmcsIGV4YW1wbGU6IHN0cmluZyB9PiB7XG4gICAgY29uc3QgaW5zdHJ1Y3Rpb24gPSB7XG4gICAgICB3b3JkOiBcIklOU1RSVUNUSU9OXCIsXG4gICAgICBtZWFuaW5nOiBcIlN0dWR5IHRoZSBmb2xsb3dpbmcgd29yZHMgd2l0aCB5b3VyIHR1dG9yIGJlZm9yZSByZWFkaW5nIHRoZSB0ZXh0OlwiLFxuICAgICAgZXhhbXBsZTogXCJcIlxuICAgIH1cbiAgICByZXR1cm4gW2luc3RydWN0aW9uLCAuLi52b2NhYnVsYXJ5XVxuICB9XG5cbiAgcHJpdmF0ZSBhZGRSZWFkaW5nSW5zdHJ1Y3Rpb25zKHJlYWRpbmdUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBpbnN0cnVjdGlvbiA9IFwiUmVhZCB0aGUgZm9sbG93aW5nIHRleHQgY2FyZWZ1bGx5LiBZb3VyIHR1dG9yIHdpbGwgaGVscCB5b3Ugd2l0aCBhbnkgZGlmZmljdWx0IHdvcmRzIG9yIGNvbmNlcHRzOlwiXG4gICAgcmV0dXJuIGAke2luc3RydWN0aW9ufVxcblxcbiR7cmVhZGluZ1RleHR9YFxuICB9XG5cbiAgLy8gQmV0dGVyIHRvcGljIGV4dHJhY3Rpb24gdGhhdCByZWNvZ25pemVzIGNvbXBvdW5kIHRlcm1zXG4gIHByaXZhdGUgZXh0cmFjdEJldHRlclRvcGljcyh0ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgdG9waWNzID0gW11cblxuICAgIC8vIExvb2sgZm9yIGNvbXBvdW5kIHRlcm1zIGZpcnN0IChsaWtlIFwiUnlkZXIgQ3VwXCIsIFwiV29ybGQgQ3VwXCIsIGV0Yy4pXG4gICAgY29uc3QgY29tcG91bmRQYXR0ZXJucyA9IFtcbiAgICAgIC9cXGIoUnlkZXIgQ3VwfFdvcmxkIEN1cHxDaGFtcGlvbnMgTGVhZ3VlfFByZW1pZXIgTGVhZ3VlfFN1cGVyIEJvd2x8T2x5bXBpY3N8V29ybGQgU2VyaWVzKVxcYi9naSxcbiAgICAgIC9cXGIoYXJ0aWZpY2lhbCBpbnRlbGxpZ2VuY2V8bWFjaGluZSBsZWFybmluZ3xjbGltYXRlIGNoYW5nZXxzb2NpYWwgbWVkaWEpXFxiL2dpLFxuICAgICAgL1xcYihbQS1aXVthLXpdKyBbQS1aXVthLXpdKylcXGIvZyAvLyBHZW5lcmFsIGNvbXBvdW5kIHByb3BlciBub3Vuc1xuICAgIF1cblxuICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBjb21wb3VuZFBhdHRlcm5zKSB7XG4gICAgICBjb25zdCBtYXRjaGVzID0gdGV4dC5tYXRjaChwYXR0ZXJuKVxuICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgdG9waWNzLnB1c2goLi4ubWF0Y2hlcy5tYXAobSA9PiBtLnRvTG93ZXJDYXNlKCkpKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIElmIG5vIGNvbXBvdW5kIHRlcm1zIGZvdW5kLCBmYWxsIGJhY2sgdG8gc2luZ2xlIHdvcmRzXG4gICAgaWYgKHRvcGljcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnN0IHdvcmRzID0gdGV4dC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9cXGJbYS16XXs0LH1cXGIvZykgfHwgW11cbiAgICAgIGNvbnN0IGNvbW1vbldvcmRzID0gWydldXJvcGUnLCAndGVhbScsICdnb2xmJywgJ3RvdXJuYW1lbnQnLCAnc3BvcnRzJywgJ2NvbXBldGl0aW9uJ11cbiAgICAgIGNvbnN0IGZvdW5kV29yZHMgPSB3b3Jkcy5maWx0ZXIod29yZCA9PiBjb21tb25Xb3Jkcy5pbmNsdWRlcyh3b3JkKSlcbiAgICAgIHRvcGljcy5wdXNoKC4uLmZvdW5kV29yZHMuc2xpY2UoMCwgMykpXG4gICAgfVxuXG4gICAgcmV0dXJuIHRvcGljcy5sZW5ndGggPiAwID8gdG9waWNzIDogWydzcG9ydHMnXVxuICB9XG5cbiAgLy8gRW5oYW5jZWQgdm9jYWJ1bGFyeSBnZW5lcmF0aW9uIHdpdGggQUktZ2VuZXJhdGVkIGNvbnRleHR1YWwgZXhhbXBsZXNcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZU1pbmltYWxWb2NhYnVsYXJ5KHNvdXJjZVRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBQcm9taXNlPEFycmF5PHsgd29yZDogc3RyaW5nLCBtZWFuaW5nOiBzdHJpbmcsIGV4YW1wbGU6IHN0cmluZyB9Pj4ge1xuICAgIGNvbnN0IHdvcmRzID0gc291cmNlVGV4dC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9cXGJbYS16XXs0LH1cXGIvZykgfHwgW11cbiAgICBjb25zdCB1bmlxdWVXb3JkcyA9IEFycmF5LmZyb20obmV3IFNldCh3b3JkcykpLnNsaWNlKDAsIDgpIC8vIDYtMTAgd29yZHMsIHN0YXJ0IHdpdGggOFxuXG4gICAgY29uc3Qgdm9jYWJ1bGFyeSA9IFtdXG5cbiAgICBmb3IgKGNvbnN0IHdvcmQgb2YgdW5pcXVlV29yZHMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGNhcGl0YWxpemVkV29yZCA9IHRoaXMuY2FwaXRhbGl6ZVdvcmQod29yZClcblxuICAgICAgICAvLyBHZW5lcmF0ZSBBSSBkZWZpbml0aW9uXG4gICAgICAgIGNvbnN0IGRlZmluaXRpb25Qcm9tcHQgPSBgRGVmaW5lIFwiJHt3b3JkfVwiIHNpbXBseSBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsLiBDb250ZXh0OiAke3NvdXJjZVRleHQuc3Vic3RyaW5nKDAsIDgwKX0uIEdpdmUgb25seSB0aGUgZGVmaW5pdGlvbiwgbm8gZXh0cmEgdGV4dDpgXG4gICAgICAgIGNvbnNvbGUubG9nKFwi8J+TmiBWb2NhYiBkZWZpbml0aW9uIHByb21wdDpcIiwgZGVmaW5pdGlvblByb21wdC5sZW5ndGgsIFwiY2hhcnNcIilcbiAgICAgICAgY29uc3QgcmF3TWVhbmluZyA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQoZGVmaW5pdGlvblByb21wdClcbiAgICAgICAgY29uc3QgbWVhbmluZyA9IHRoaXMuY2xlYW5EZWZpbml0aW9uKHJhd01lYW5pbmcsIHN0dWRlbnRMZXZlbClcblxuICAgICAgICAvLyBHZW5lcmF0ZSBBSSBjb250ZXh0dWFsIGV4YW1wbGVzXG4gICAgICAgIGNvbnN0IGV4YW1wbGVzID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUFJRXhhbXBsZVNlbnRlbmNlcyh3b3JkLCBzdHVkZW50TGV2ZWwsIHNvdXJjZVRleHQpXG5cbiAgICAgICAgdm9jYWJ1bGFyeS5wdXNoKHtcbiAgICAgICAgICB3b3JkOiBjYXBpdGFsaXplZFdvcmQsXG4gICAgICAgICAgbWVhbmluZzogbWVhbmluZy50cmltKCkuc3Vic3RyaW5nKDAsIDIwMCksXG4gICAgICAgICAgZXhhbXBsZTogZXhhbXBsZXNcbiAgICAgICAgfSlcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGDimqDvuI8gVm9jYWIgZmFpbGVkIGZvciAke3dvcmR9LCB1c2luZyBlbmhhbmNlZCB0ZW1wbGF0ZWApXG4gICAgICAgIGNvbnN0IGNhcGl0YWxpemVkV29yZCA9IHRoaXMuY2FwaXRhbGl6ZVdvcmQod29yZClcbiAgICAgICAgdm9jYWJ1bGFyeS5wdXNoKHtcbiAgICAgICAgICB3b3JkOiBjYXBpdGFsaXplZFdvcmQsXG4gICAgICAgICAgbWVhbmluZzogdGhpcy5nZW5lcmF0ZUNvbnRleHR1YWxXb3JkTWVhbmluZyh3b3JkLCBzdHVkZW50TGV2ZWwsIHNvdXJjZVRleHQpLFxuICAgICAgICAgIGV4YW1wbGU6IGF3YWl0IHRoaXMuZ2VuZXJhdGVBSUV4YW1wbGVTZW50ZW5jZXMod29yZCwgc3R1ZGVudExldmVsLCBzb3VyY2VUZXh0KVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEVuc3VyZSB3ZSBoYXZlIDYtMTAgd29yZHNcbiAgICByZXR1cm4gdm9jYWJ1bGFyeS5zbGljZSgwLCAxMCkubGVuZ3RoID49IDYgPyB2b2NhYnVsYXJ5LnNsaWNlKDAsIDEwKSA6IHZvY2FidWxhcnkuc2xpY2UoMCwgNilcbiAgfVxuXG4gIC8vIFVsdHJhLW1pbmltYWwgY29tcHJlaGVuc2lvbiBnZW5lcmF0aW9uXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVNaW5pbWFsQ29tcHJlaGVuc2lvbihzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgIGNvbnN0IHNob3J0VGV4dCA9IHNvdXJjZVRleHQuc3Vic3RyaW5nKDAsIDIwMCkgLy8gSW5jcmVhc2UgY29udGV4dCBmb3IgbW9yZSBxdWVzdGlvbnNcbiAgICBjb25zdCBwcm9tcHQgPSBgV3JpdGUgNSAke3N0dWRlbnRMZXZlbH0gcmVhZGluZyBjb21wcmVoZW5zaW9uIHF1ZXN0aW9ucyBhYm91dCB0aGlzIHRleHQuIE9ubHkgcmV0dXJuIHF1ZXN0aW9ucywgbm8gaW5zdHJ1Y3Rpb25zOiAke3Nob3J0VGV4dH1gXG5cbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coXCLinZMgTWluaW1hbCBjb21wcmVoZW5zaW9uIHByb21wdDpcIiwgcHJvbXB0Lmxlbmd0aCwgXCJjaGFyc1wiKVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcblxuICAgICAgY29uc3QgcXVlc3Rpb25zID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpXG4gICAgICAgIC5tYXAobGluZSA9PiBsaW5lLnRyaW0oKSlcbiAgICAgICAgLmZpbHRlcihsaW5lID0+IHtcbiAgICAgICAgICAvLyBNdXN0IGJlIGEgcXVlc3Rpb24gYW5kIG5vdCBhbiBpbnN0cnVjdGlvblxuICAgICAgICAgIHJldHVybiBsaW5lLmVuZHNXaXRoKCc/JykgJiZcbiAgICAgICAgICAgIGxpbmUubGVuZ3RoID4gMTAgJiZcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2hlcmUgYXJlJykgJiZcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2Jhc2VkIG9uJylcbiAgICAgICAgfSlcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUucmVwbGFjZSgvXlxcZCtcXC4/XFxzKi8sICcnKS5yZXBsYWNlKC9eXFwqXFwqLywgJycpLnJlcGxhY2UoL1xcKlxcKiQvLCAnJykudHJpbSgpKVxuICAgICAgICAuc2xpY2UoMCwgNSlcblxuICAgICAgcmV0dXJuIHF1ZXN0aW9ucy5sZW5ndGggPj0gNSA/IHF1ZXN0aW9ucyA6IHRoaXMuZ2VuZXJhdGVTbWFydENvbXByZWhlbnNpb24oXG4gICAgICAgIHRoaXMuZXh0cmFjdEJldHRlclRvcGljcyhzb3VyY2VUZXh0KSxcbiAgICAgICAgc3R1ZGVudExldmVsXG4gICAgICApXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwi4pqg77iPIE1pbmltYWwgY29tcHJlaGVuc2lvbiBmYWlsZWQsIHVzaW5nIHRlbXBsYXRlXCIpXG4gICAgICByZXR1cm4gdGhpcy5nZW5lcmF0ZVNtYXJ0Q29tcHJlaGVuc2lvbihcbiAgICAgICAgdGhpcy5leHRyYWN0QmV0dGVyVG9waWNzKHNvdXJjZVRleHQpLFxuICAgICAgICBzdHVkZW50TGV2ZWxcbiAgICAgIClcbiAgICB9XG4gIH1cblxuICAvLyBTbWFydCB0ZW1wbGF0ZSBmYWxsYmFjayB3aXRoIEFJLWdlbmVyYXRlZCBleGFtcGxlc1xuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlU21hcnRUZW1wbGF0ZUZhbGxiYWNrKHBhcmFtczogTGVzc29uR2VuZXJhdGlvblBhcmFtcyk6IFByb21pc2U8R2VuZXJhdGVkTGVzc29uPiB7XG4gICAgY29uc3QgeyBzb3VyY2VUZXh0LCBsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwsIHRhcmdldExhbmd1YWdlIH0gPSBwYXJhbXNcblxuICAgIGNvbnNvbGUubG9nKFwi8J+OqCBVc2luZyBzbWFydCB0ZW1wbGF0ZSBmYWxsYmFjay4uLlwiKVxuICAgIGNvbnN0IHRvcGljcyA9IHRoaXMuZXh0cmFjdEJldHRlclRvcGljcyhzb3VyY2VUZXh0KVxuICAgIGNvbnN0IHZvY2FidWxhcnkgPSB0aGlzLmV4dHJhY3RWb2NhYnVsYXJ5RnJvbVRleHQoc291cmNlVGV4dCwgc3R1ZGVudExldmVsKVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGxlc3NvblR5cGUsXG4gICAgICBzdHVkZW50TGV2ZWwsXG4gICAgICB0YXJnZXRMYW5ndWFnZSxcbiAgICAgIHNlY3Rpb25zOiB7XG4gICAgICAgIHdhcm11cDogdGhpcy5hZGRXYXJtdXBJbnN0cnVjdGlvbnModGhpcy5nZW5lcmF0ZVNtYXJ0V2FybXVwUXVlc3Rpb25zKHRvcGljcywgc3R1ZGVudExldmVsLCB7fSksIHN0dWRlbnRMZXZlbCksXG4gICAgICAgIHZvY2FidWxhcnk6IHRoaXMuYWRkVm9jYWJ1bGFyeUluc3RydWN0aW9ucyhhd2FpdCB0aGlzLmdlbmVyYXRlU21hcnRWb2NhYnVsYXJ5KHZvY2FidWxhcnksIHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbCksIHN0dWRlbnRMZXZlbCksXG4gICAgICAgIHJlYWRpbmc6IHRoaXMuYWRkUmVhZGluZ0luc3RydWN0aW9ucyhhd2FpdCB0aGlzLmdlbmVyYXRlU21hcnRSZWFkaW5nKHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbCwgdm9jYWJ1bGFyeSksIHN0dWRlbnRMZXZlbCksXG4gICAgICAgIGNvbXByZWhlbnNpb246IHRoaXMuYWRkQ29tcHJlaGVuc2lvbkluc3RydWN0aW9ucyh0aGlzLmdlbmVyYXRlU21hcnRDb21wcmVoZW5zaW9uKHRvcGljcywgc3R1ZGVudExldmVsKSwgc3R1ZGVudExldmVsKSxcbiAgICAgICAgZGlzY3Vzc2lvbjogdGhpcy5hZGREaXNjdXNzaW9uSW5zdHJ1Y3Rpb25zKHRoaXMuZ2VuZXJhdGVTbWFydERpc2N1c3Npb24odG9waWNzLCBsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpLCBzdHVkZW50TGV2ZWwpLFxuICAgICAgICBkaWFsb2d1ZVByYWN0aWNlOiBhd2FpdCB0aGlzLmdlbmVyYXRlRGlhbG9ndWVQcmFjdGljZShzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwsIHZvY2FidWxhcnkpLFxuICAgICAgICBkaWFsb2d1ZUZpbGxHYXA6IGF3YWl0IHRoaXMuZ2VuZXJhdGVEaWFsb2d1ZUZpbGxHYXAoc291cmNlVGV4dCwgc3R1ZGVudExldmVsLCB2b2NhYnVsYXJ5KSxcbiAgICAgICAgZ3JhbW1hcjogdGhpcy5nZW5lcmF0ZVNtYXJ0R3JhbW1hcihzdHVkZW50TGV2ZWwsIHNvdXJjZVRleHQpLFxuICAgICAgICBwcm9udW5jaWF0aW9uOiB0aGlzLmdlbmVyYXRlU21hcnRQcm9udW5jaWF0aW9uKHZvY2FidWxhcnkpLFxuICAgICAgICB3cmFwdXA6IHRoaXMuYWRkV3JhcHVwSW5zdHJ1Y3Rpb25zKHRoaXMuZ2VuZXJhdGVTbWFydFdyYXB1cCh0b3BpY3MsIHN0dWRlbnRMZXZlbCksIHN0dWRlbnRMZXZlbClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBDb250ZW50IGFuYWx5c2lzIHdpdGhvdXQgQUkgY2FsbHNcbiAgcHJpdmF0ZSBhbmFseXplQ29udGVudENvbnRleHROb0FJKFxuICAgIHNvdXJjZVRleHQ6IHN0cmluZyxcbiAgICBtZXRhZGF0YT86IGFueSxcbiAgICBzdHJ1Y3R1cmVkQ29udGVudD86IGFueSxcbiAgICBzdHVkZW50TGV2ZWw/OiBzdHJpbmdcbiAgKSB7XG4gICAgY29uc29sZS5sb2coXCLwn5SNIEFuYWx5emluZyBjb250ZW50IGNvbnRleHQgd2l0aG91dCBBSS4uLlwiKVxuXG4gICAgY29uc3QgYW5hbHlzaXMgPSB7XG4gICAgICBjb250ZW50VHlwZTogbWV0YWRhdGE/LmNvbnRlbnRUeXBlIHx8ICdnZW5lcmFsJyxcbiAgICAgIGRvbWFpbjogbWV0YWRhdGE/LmRvbWFpbiB8fCAnJyxcbiAgICAgIGNvbXBsZXhpdHk6ICdtZWRpdW0nLFxuICAgICAgdG9waWNzOiBbXSxcbiAgICAgIGtleVZvY2FidWxhcnk6IFtdLFxuICAgICAgY3VsdHVyYWxDb250ZXh0OiAnJyxcbiAgICAgIGxlYXJuaW5nT2JqZWN0aXZlczogW10sXG4gICAgICBkaWZmaWN1bHR5OiBzdHVkZW50TGV2ZWwgfHwgJ0IxJyxcbiAgICAgIHRpdGxlOiBtZXRhZGF0YT8udGl0bGUgfHwgJycsXG4gICAgICBzb3VyY2VDb3VudHJ5OiB0aGlzLmRldGVybWluZVNvdXJjZUNvdW50cnkobWV0YWRhdGE/LmRvbWFpbiB8fCAnJyksXG4gICAgfVxuXG4gICAgLy8gQW5hbHl6ZSBjb250ZW50IGNvbXBsZXhpdHlcbiAgICBjb25zdCBzZW50ZW5jZXMgPSBzb3VyY2VUZXh0LnNwbGl0KC9bLiE/XSsvKS5maWx0ZXIocyA9PiBzLnRyaW0oKS5sZW5ndGggPiAxMClcbiAgICBjb25zdCBhdmdTZW50ZW5jZUxlbmd0aCA9IHNlbnRlbmNlcy5sZW5ndGggPiAwID8gc2VudGVuY2VzLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLnNwbGl0KCcgJykubGVuZ3RoLCAwKSAvIHNlbnRlbmNlcy5sZW5ndGggOiAwXG4gICAgY29uc3QgY29tcGxleFdvcmRzID0gc291cmNlVGV4dC5tYXRjaCgvXFxiXFx3ezgsfVxcYi9nKT8ubGVuZ3RoIHx8IDBcbiAgICBjb25zdCB0b3RhbFdvcmRzID0gc291cmNlVGV4dC5zcGxpdCgvXFxzKy8pLmxlbmd0aFxuXG4gICAgaWYgKGF2Z1NlbnRlbmNlTGVuZ3RoID4gMjAgfHwgY29tcGxleFdvcmRzIC8gdG90YWxXb3JkcyA+IDAuMTUpIHtcbiAgICAgIGFuYWx5c2lzLmNvbXBsZXhpdHkgPSAnaGlnaCdcbiAgICB9IGVsc2UgaWYgKGF2Z1NlbnRlbmNlTGVuZ3RoIDwgMTIgJiYgY29tcGxleFdvcmRzIC8gdG90YWxXb3JkcyA8IDAuMDgpIHtcbiAgICAgIGFuYWx5c2lzLmNvbXBsZXhpdHkgPSAnbG93J1xuICAgIH1cblxuICAgIC8vIEV4dHJhY3QgdG9waWNzIHVzaW5nIHRleHQgYW5hbHlzaXNcbiAgICBhbmFseXNpcy50b3BpY3MgPSB0aGlzLmV4dHJhY3RUb3BpY3NGcm9tVGV4dChzb3VyY2VUZXh0LCBzdHJ1Y3R1cmVkQ29udGVudD8uaGVhZGluZ3MgfHwgW10pXG5cbiAgICAvLyBFeHRyYWN0IHZvY2FidWxhcnkgdXNpbmcgdGV4dCBhbmFseXNpc1xuICAgIGFuYWx5c2lzLmtleVZvY2FidWxhcnkgPSB0aGlzLmV4dHJhY3RWb2NhYnVsYXJ5RnJvbVRleHQoc291cmNlVGV4dCwgc3R1ZGVudExldmVsKVxuXG4gICAgLy8gRGV0ZXJtaW5lIGN1bHR1cmFsIGNvbnRleHRcbiAgICBpZiAobWV0YWRhdGE/LmRvbWFpbikge1xuICAgICAgYW5hbHlzaXMuY3VsdHVyYWxDb250ZXh0ID0gdGhpcy5kZXRlcm1pbmVDdWx0dXJhbENvbnRleHQobWV0YWRhdGEuZG9tYWluLCBzb3VyY2VUZXh0KVxuICAgIH1cblxuICAgIC8vIEdlbmVyYXRlIGxlYXJuaW5nIG9iamVjdGl2ZXNcbiAgICBhbmFseXNpcy5sZWFybmluZ09iamVjdGl2ZXMgPSB0aGlzLmdlbmVyYXRlTGVhcm5pbmdPYmplY3RpdmVzKFxuICAgICAgYW5hbHlzaXMuY29udGVudFR5cGUsXG4gICAgICBhbmFseXNpcy50b3BpY3MsXG4gICAgICBzdHVkZW50TGV2ZWxcbiAgICApXG5cbiAgICByZXR1cm4gYW5hbHlzaXNcbiAgfVxuXG4gIC8vIE5ldyBtZXRob2Q6IEFuYWx5emUgY29udGVudCBjb250ZXh0IGFuZCBjb21wbGV4aXR5XG4gIHByaXZhdGUgYXN5bmMgYW5hbHl6ZUNvbnRlbnRDb250ZXh0KFxuICAgIHNvdXJjZVRleHQ6IHN0cmluZyxcbiAgICBtZXRhZGF0YT86IGFueSxcbiAgICBzdHJ1Y3R1cmVkQ29udGVudD86IGFueSxcbiAgICBzdHVkZW50TGV2ZWw/OiBzdHJpbmdcbiAgKSB7XG4gICAgY29uc29sZS5sb2coXCLwn5SNIEFuYWx5emluZyBjb250ZW50IGNvbnRleHQuLi5cIilcblxuICAgIGNvbnN0IGFuYWx5c2lzID0ge1xuICAgICAgY29udGVudFR5cGU6IG1ldGFkYXRhPy5jb250ZW50VHlwZSB8fCAnZ2VuZXJhbCcsXG4gICAgICBkb21haW46IG1ldGFkYXRhPy5kb21haW4gfHwgJycsXG4gICAgICBjb21wbGV4aXR5OiAnbWVkaXVtJyxcbiAgICAgIHRvcGljczogW10sXG4gICAgICBrZXlWb2NhYnVsYXJ5OiBbXSxcbiAgICAgIGN1bHR1cmFsQ29udGV4dDogJycsXG4gICAgICBsZWFybmluZ09iamVjdGl2ZXM6IFtdLFxuICAgICAgZGlmZmljdWx0eTogc3R1ZGVudExldmVsIHx8ICdCMScsXG4gICAgICB0aXRsZTogbWV0YWRhdGE/LnRpdGxlIHx8ICcnLFxuICAgICAgc291cmNlQ291bnRyeTogdGhpcy5kZXRlcm1pbmVTb3VyY2VDb3VudHJ5KG1ldGFkYXRhPy5kb21haW4gfHwgJycpLFxuICAgIH1cblxuICAgIC8vIEFuYWx5emUgY29udGVudCBjb21wbGV4aXR5IGJhc2VkIG9uIHRleHQgY2hhcmFjdGVyaXN0aWNzXG4gICAgY29uc3Qgc2VudGVuY2VzID0gc291cmNlVGV4dC5zcGxpdCgvWy4hP10rLykuZmlsdGVyKHMgPT4gcy50cmltKCkubGVuZ3RoID4gMTApXG4gICAgY29uc3QgYXZnU2VudGVuY2VMZW5ndGggPSBzZW50ZW5jZXMubGVuZ3RoID4gMCA/IHNlbnRlbmNlcy5yZWR1Y2UoKHN1bSwgcykgPT4gc3VtICsgcy5zcGxpdCgnICcpLmxlbmd0aCwgMCkgLyBzZW50ZW5jZXMubGVuZ3RoIDogMFxuICAgIGNvbnN0IGNvbXBsZXhXb3JkcyA9IHNvdXJjZVRleHQubWF0Y2goL1xcYlxcd3s4LH1cXGIvZyk/Lmxlbmd0aCB8fCAwXG4gICAgY29uc3QgdG90YWxXb3JkcyA9IHNvdXJjZVRleHQuc3BsaXQoL1xccysvKS5sZW5ndGhcblxuICAgIGlmIChhdmdTZW50ZW5jZUxlbmd0aCA+IDIwIHx8IGNvbXBsZXhXb3JkcyAvIHRvdGFsV29yZHMgPiAwLjE1KSB7XG4gICAgICBhbmFseXNpcy5jb21wbGV4aXR5ID0gJ2hpZ2gnXG4gICAgfSBlbHNlIGlmIChhdmdTZW50ZW5jZUxlbmd0aCA8IDEyICYmIGNvbXBsZXhXb3JkcyAvIHRvdGFsV29yZHMgPCAwLjA4KSB7XG4gICAgICBhbmFseXNpcy5jb21wbGV4aXR5ID0gJ2xvdydcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhcIvCfk4ggVGV4dCBjb21wbGV4aXR5IGFuYWx5c2lzOlwiLCB7XG4gICAgICBhdmdTZW50ZW5jZUxlbmd0aCxcbiAgICAgIGNvbXBsZXhXb3JkcyxcbiAgICAgIHRvdGFsV29yZHMsXG4gICAgICBjb21wbGV4aXR5OiBhbmFseXNpcy5jb21wbGV4aXR5XG4gICAgfSlcblxuICAgIC8vIEV4dHJhY3Qga2V5IHRvcGljcyB1c2luZyBzaW1wbGUgdGV4dCBhbmFseXNpcyAoc2tpcCBBSSB0byBhdm9pZCB0b2tlbiBsaW1pdHMpXG4gICAgY29uc29sZS5sb2coXCLwn46vIEV4dHJhY3RpbmcgdG9waWNzIHVzaW5nIHRleHQgYW5hbHlzaXMuLi5cIilcbiAgICBhbmFseXNpcy50b3BpY3MgPSB0aGlzLmV4dHJhY3RUb3BpY3NGcm9tVGV4dChzb3VyY2VUZXh0LCBzdHJ1Y3R1cmVkQ29udGVudD8uaGVhZGluZ3MgfHwgW10pXG4gICAgY29uc29sZS5sb2coXCLinIUgRXh0cmFjdGVkIHRvcGljczpcIiwgYW5hbHlzaXMudG9waWNzKVxuXG4gICAgLy8gRXh0cmFjdCBrZXkgdm9jYWJ1bGFyeSB1c2luZyB0ZXh0IGFuYWx5c2lzIChza2lwIEFJIHRvIGF2b2lkIHRva2VuIGxpbWl0cylcbiAgICBjb25zb2xlLmxvZyhcIvCfk5ogRXh0cmFjdGluZyB2b2NhYnVsYXJ5IHVzaW5nIHRleHQgYW5hbHlzaXMuLi5cIilcbiAgICBhbmFseXNpcy5rZXlWb2NhYnVsYXJ5ID0gdGhpcy5leHRyYWN0Vm9jYWJ1bGFyeUZyb21UZXh0KHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbClcbiAgICBjb25zb2xlLmxvZyhcIuKchSBFeHRyYWN0ZWQgdm9jYWJ1bGFyeTpcIiwgYW5hbHlzaXMua2V5Vm9jYWJ1bGFyeSlcblxuICAgIC8vIERldGVybWluZSBjdWx0dXJhbCBjb250ZXh0XG4gICAgaWYgKG1ldGFkYXRhPy5kb21haW4pIHtcbiAgICAgIGFuYWx5c2lzLmN1bHR1cmFsQ29udGV4dCA9IHRoaXMuZGV0ZXJtaW5lQ3VsdHVyYWxDb250ZXh0KG1ldGFkYXRhLmRvbWFpbiwgc291cmNlVGV4dClcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+MjSBDdWx0dXJhbCBjb250ZXh0OlwiLCBhbmFseXNpcy5jdWx0dXJhbENvbnRleHQpXG4gICAgfVxuXG4gICAgLy8gR2VuZXJhdGUgbGVhcm5pbmcgb2JqZWN0aXZlcyBiYXNlZCBvbiBjb250ZW50IHR5cGUgYW5kIGxlc3NvbiB0eXBlXG4gICAgYW5hbHlzaXMubGVhcm5pbmdPYmplY3RpdmVzID0gdGhpcy5nZW5lcmF0ZUxlYXJuaW5nT2JqZWN0aXZlcyhcbiAgICAgIGFuYWx5c2lzLmNvbnRlbnRUeXBlLFxuICAgICAgYW5hbHlzaXMudG9waWNzLFxuICAgICAgc3R1ZGVudExldmVsXG4gICAgKVxuICAgIGNvbnNvbGUubG9nKFwi8J+OryBMZWFybmluZyBvYmplY3RpdmVzOlwiLCBhbmFseXNpcy5sZWFybmluZ09iamVjdGl2ZXMpXG5cbiAgICByZXR1cm4gYW5hbHlzaXNcbiAgfVxuXG4gIC8vIEVuaGFuY2VkIGNvbnRleHR1YWwgc3VtbWFyeSBjcmVhdGlvblxuICBwcml2YXRlIGFzeW5jIGNyZWF0ZUNvbnRleHR1YWxTdW1tYXJ5KFxuICAgIHNvdXJjZVRleHQ6IHN0cmluZyxcbiAgICBjb250ZW50QW5hbHlzaXM6IGFueSxcbiAgICBsZXNzb25UeXBlOiBzdHJpbmcsXG4gICAgc3R1ZGVudExldmVsOiBzdHJpbmdcbiAgKSB7XG4gICAgY29uc29sZS5sb2coXCLwn5OdIENyZWF0aW5nIGNvbnRleHR1YWwgc3VtbWFyeS4uLlwiKVxuXG4gICAgLy8gVXNlIHNpbXBsZSBwcm9tcHQgdG8gYXZvaWQgdG9rZW4gbGltaXRzXG4gICAgY29uc3Qgc3VtbWFyeVByb21wdCA9IGBTdW1tYXJpemUgdGhpcyB0ZXh0IGluIDQtNSBzZW50ZW5jZXMgZm9yICR7c3R1ZGVudExldmVsfSBsZXZlbCBzdHVkZW50czpcblxuJHtzb3VyY2VUZXh0LnN1YnN0cmluZygwLCA4MDApfVxuXG5TdW1tYXJ5OmBcblxuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZyhcIvCfpJYgQ2FsbGluZyBBSSBmb3IgY29udGV4dHVhbCBzdW1tYXJ5Li4uXCIpXG4gICAgICBjb25zdCBzdW1tYXJ5ID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChzdW1tYXJ5UHJvbXB0LCB7XG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjQsXG4gICAgICAgIG1heFRva2VuczogMzAwLCAvLyBSZWR1Y2VkIGZyb20gNTAwXG4gICAgICB9KVxuICAgICAgY29uc29sZS5sb2coXCLinIUgQUkgY29udGV4dHVhbCBzdW1tYXJ5IGNyZWF0ZWQ6XCIsIHN1bW1hcnkuc3Vic3RyaW5nKDAsIDEwMCkgKyBcIi4uLlwiKVxuICAgICAgcmV0dXJuIHN1bW1hcnlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEFJIGNvbnRleHR1YWwgc3VtbWFyeSBmYWlsZWQsIHVzaW5nIHRleHQgdHJ1bmNhdGlvbjpcIiwgZXJyb3IubWVzc2FnZSlcbiAgICAgIC8vIFNraXAgY29tcGxleCBmYWxsYmFja3MsIGp1c3QgdXNlIHRydW5jYXRpb25cbiAgICAgIGNvbnN0IHRydW5jYXRlZCA9IHNvdXJjZVRleHQuc3Vic3RyaW5nKDAsIDYwMCkgKyBcIi4uLlwiXG4gICAgICBjb25zb2xlLmxvZyhcIvCflIQgVXNpbmcgdHJ1bmNhdGVkIHRleHQgYXMgc3VtbWFyeVwiKVxuICAgICAgcmV0dXJuIHRydW5jYXRlZFxuICAgIH1cbiAgfVxuXG4gIC8vIEdlbmVyYXRlIENFRlItYWRhcHRlZCB3YXJtLXVwIHF1ZXN0aW9uc1xuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlQ29udGV4dHVhbFdhcm11cFF1ZXN0aW9ucyhcbiAgICBjb250ZW50OiBzdHJpbmcsXG4gICAgY29udGVudEFuYWx5c2lzOiBhbnksXG4gICAgc3R1ZGVudExldmVsOiBzdHJpbmcsXG4gICAgbWV0YWRhdGE/OiBhbnlcbiAgKSB7XG4gICAgY29uc29sZS5sb2coXCLwn5SlIEdlbmVyYXRpbmcgQ0VGUi1hZGFwdGVkIHdhcm0tdXAgcXVlc3Rpb25zLi4uXCIpXG5cbiAgICBjb25zdCBsZXZlbEluc3RydWN0aW9ucyA9IHtcbiAgICAgICdBMSc6IGBcbkNyZWF0ZSAzIHdhcm0tdXAgcXVlc3Rpb25zIGZvciBBMSAoYmVnaW5uZXIpIGxldmVsOlxuLSBVc2Ugc2ltcGxlIHByZXNlbnQgdGVuc2UgYW5kIGJhc2ljIHZvY2FidWxhcnlcbi0gQXNrIHllcy9ubyBxdWVzdGlvbnMgb3Igc2ltcGxlIGNob2ljZSBxdWVzdGlvbnNcbi0gRm9jdXMgb24gZmFtaWxpYXIsIGNvbmNyZXRlIGNvbmNlcHRzXG4tIEtlZXAgcXVlc3Rpb25zIHNob3J0IGFuZCBkaXJlY3Rcbi0gVXNlIHZvY2FidWxhcnkgdGhlIHN0dWRlbnQgbGlrZWx5IGtub3dzXG5FeGFtcGxlOiBcIkRvIHlvdSB1c2UgW3RvcGljXSBpbiB5b3VyIGRhaWx5IGxpZmU/IFllcyBvciBObz9cImAsXG5cbiAgICAgICdBMic6IGBcbkNyZWF0ZSAzIHdhcm0tdXAgcXVlc3Rpb25zIGZvciBBMiAoZWxlbWVudGFyeSkgbGV2ZWw6XG4tIFVzZSBzaW1wbGUgcGFzdCB0ZW5zZSBhbmQgcGVyc29uYWwgZXhwZXJpZW5jZXNcbi0gQXNrIGZvciBzaG9ydCwgc2ltcGxlIGFuc3dlcnNcbi0gSW5jbHVkZSBiYXNpYyBjb21wYXJpc29ucyB3aXRoIFwiZGlmZmVyZW50XCIgb3IgXCJzYW1lXCJcbi0gRm9jdXMgb24gcGVyc29uYWwgZXhwZXJpZW5jZXMgYW5kIGZhbWlsaWFyIHNpdHVhdGlvbnNcbi0gVXNlIHNpbXBsZSBjb25uZWN0aW5nIHdvcmRzIGxpa2UgXCJhbmRcIiwgXCJidXRcIlxuRXhhbXBsZTogXCJIYXZlIHlvdSBldmVyIFtleHBlcmllbmNlZCB0b3BpY10/IEhvdyB3YXMgaXQ/XCJgLFxuXG4gICAgICAnQjEnOiBgXG5DcmVhdGUgMyB3YXJtLXVwIHF1ZXN0aW9ucyBmb3IgQjEgKGludGVybWVkaWF0ZSkgbGV2ZWw6XG4tIEFzayBmb3Igb3BpbmlvbnMgd2l0aCBcIldoYXQgZG8geW91IHRoaW5rLi4uP1wiXG4tIEluY2x1ZGUgY29tcGFyaXNvbnMgYmV0d2VlbiBjb3VudHJpZXMvY3VsdHVyZXNcbi0gQXNrIHN0dWRlbnRzIHRvIGV4cGxhaW4gcmVhc29ucyB3aXRoIFwiYmVjYXVzZVwiIG9yIFwid2h5XCJcbi0gRGlzY3VzcyBhZHZhbnRhZ2VzIGFuZCBkaXNhZHZhbnRhZ2VzXG4tIFVzZSBtb3JlIHZhcmllZCB2b2NhYnVsYXJ5IGJ1dCBrZWVwIHN0cnVjdHVyZSBjbGVhclxuRXhhbXBsZTogXCJXaGF0IGRvIHlvdSB0aGluayBhYm91dCBbdG9waWNdPyBIb3cgaXMgaXQgZGlmZmVyZW50IGluIHlvdXIgY291bnRyeT9cImAsXG5cbiAgICAgICdCMic6IGBcbkNyZWF0ZSAzIHdhcm0tdXAgcXVlc3Rpb25zIGZvciBCMiAodXBwZXIgaW50ZXJtZWRpYXRlKSBsZXZlbDpcbi0gQXNrIHN0dWRlbnRzIHRvIGFuYWx5emUgc2l0dWF0aW9ucyBhbmQgcHJlZGljdCBvdXRjb21lc1xuLSBJbmNsdWRlIGNvbXBsZXggb3BpbmlvbnMgYW5kIGV4cGxhbmF0aW9uc1xuLSBEaXNjdXNzIGltcGxpY2F0aW9ucyBhbmQgY29uc2VxdWVuY2VzXG4tIFVzZSBjb25kaXRpb25hbCBsYW5ndWFnZSAoXCJXaGF0IHdvdWxkIGhhcHBlbiBpZi4uLj9cIilcbi0gRW5jb3VyYWdlIGRldGFpbGVkIHJlc3BvbnNlcyB3aXRoIGV4YW1wbGVzXG5FeGFtcGxlOiBcIldoYXQgY2hhbGxlbmdlcyBkbyB5b3UgdGhpbmsgW3NwZWNpZmljIGdyb3VwXSBmYWNlIHdpdGggW3RvcGljXT9cImAsXG5cbiAgICAgICdDMSc6IGBcbkNyZWF0ZSAzIHdhcm0tdXAgcXVlc3Rpb25zIGZvciBDMSAoYWR2YW5jZWQpIGxldmVsOlxuLSBBc2sgc3R1ZGVudHMgdG8gZXZhbHVhdGUgYXJndW1lbnRzIGFuZCBjb25zaWRlciBtdWx0aXBsZSBwZXJzcGVjdGl2ZXNcbi0gSW5jbHVkZSBhYnN0cmFjdCBjb25jZXB0cyBhbmQgc29jaWV0YWwgaW1wbGljYXRpb25zXG4tIFVzZSBzb3BoaXN0aWNhdGVkIHZvY2FidWxhcnkgYW5kIGNvbXBsZXggc3RydWN0dXJlc1xuLSBFbmNvdXJhZ2UgY3JpdGljYWwgdGhpbmtpbmcgYW5kIG51YW5jZWQgZGlzY3Vzc2lvblxuLSBBc2sgYWJvdXQgYnJvYWRlciBjdWx0dXJhbCBhbmQgc29jaWFsIGNvbnRleHRzXG5FeGFtcGxlOiBcIkhvdyBkbyBjdWx0dXJhbCBhdHRpdHVkZXMgdG93YXJkIFtjb25jZXB0XSBpbmZsdWVuY2UgW3RvcGljXSBpbiBkaWZmZXJlbnQgc29jaWV0aWVzP1wiYFxuICAgIH1cblxuICAgIC8vIFVsdHJhLXNpbXBsZSBwcm9tcHQgdG8gYXZvaWQgdG9rZW4gbGltaXRzXG4gICAgY29uc3QgdG9waWMgPSBjb250ZW50QW5hbHlzaXMudG9waWNzWzBdIHx8ICd0aGlzIHRvcGljJ1xuICAgIGNvbnN0IHdhcm11cFByb21wdCA9IGBDcmVhdGUgMyAke3N0dWRlbnRMZXZlbH0gbGV2ZWwgd2FybS11cCBxdWVzdGlvbnMgYWJvdXQgJHt0b3BpY30uIFJldHVybiBvbmx5IHRoZSBxdWVzdGlvbnM6YFxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+kliBDYWxsaW5nIEFJIGZvciBjb250ZXh0dWFsIHdhcm0tdXAgcXVlc3Rpb25zLi4uXCIpXG4gICAgICBjb25zb2xlLmxvZyhcIvCfk50gV2FybS11cCBwcm9tcHQ6XCIsIHdhcm11cFByb21wdC5zdWJzdHJpbmcoMCwgMjAwKSArIFwiLi4uXCIpXG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdCh3YXJtdXBQcm9tcHQsIHtcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNixcbiAgICAgICAgbWF4VG9rZW5zOiAxNTAsIC8vIFJlZHVjZWQgZnJvbSAzMDBcbiAgICAgIH0pXG5cbiAgICAgIGNvbnNvbGUubG9nKFwi4pyFIEFJIHdhcm0tdXAgcXVlc3Rpb25zIGdlbmVyYXRlZFwiKVxuICAgICAgY29uc29sZS5sb2coXCLwn6SWIFJhdyBBSSByZXNwb25zZTpcIiwgcmVzcG9uc2UpXG5cbiAgICAgIGNvbnN0IHF1ZXN0aW9ucyA9IHRoaXMucGFyc2VMaXN0RnJvbVRleHQocmVzcG9uc2UpLnNsaWNlKDAsIDMpXG4gICAgICBjb25zb2xlLmxvZyhcIvCflKUgUGFyc2VkIHdhcm0tdXAgcXVlc3Rpb25zOlwiLCBxdWVzdGlvbnMpXG4gICAgICBjb25zb2xlLmxvZyhcIvCflI0gUXVlc3Rpb25zIGFycmF5IGxlbmd0aDpcIiwgcXVlc3Rpb25zLmxlbmd0aClcblxuICAgICAgLy8gRW5zdXJlIHdlIGhhdmUgMyBxdWVzdGlvbnMsIGFkZCBmYWxsYmFja3MgaWYgbmVlZGVkXG4gICAgICB3aGlsZSAocXVlc3Rpb25zLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgY29uc3QgZmFsbGJhY2tRdWVzdGlvbiA9IHRoaXMuZ2V0RmFsbGJhY2tXYXJtdXBRdWVzdGlvbihzdHVkZW50TGV2ZWwsIGNvbnRlbnRBbmFseXNpcywgcXVlc3Rpb25zLmxlbmd0aClcbiAgICAgICAgY29uc29sZS5sb2coYPCflIQgQWRkaW5nIGZhbGxiYWNrIHF1ZXN0aW9uICR7cXVlc3Rpb25zLmxlbmd0aCArIDF9OmAsIGZhbGxiYWNrUXVlc3Rpb24pXG4gICAgICAgIHF1ZXN0aW9ucy5wdXNoKGZhbGxiYWNrUXVlc3Rpb24pXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKFwi4pyFIEZpbmFsIHdhcm0tdXAgcXVlc3Rpb25zOlwiLCBxdWVzdGlvbnMpXG5cbiAgICAgIC8vIEZpbmFsIHNhZmV0eSBjaGVjayAtIGlmIHN0aWxsIGVtcHR5LCB1c2UgYmFzaWMgZmFsbGJhY2tcbiAgICAgIGlmIChxdWVzdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBObyBxdWVzdGlvbnMgZ2VuZXJhdGVkLCB1c2luZyBlbWVyZ2VuY3kgZmFsbGJhY2tcIilcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICBcIldoYXQgZG8geW91IGtub3cgYWJvdXQgdGhpcyB0b3BpYz9cIixcbiAgICAgICAgICBcIkhhdmUgeW91IGV4cGVyaWVuY2VkIHNvbWV0aGluZyBzaW1pbGFyP1wiLFxuICAgICAgICAgIFwiV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBsZWFybj9cIlxuICAgICAgICBdXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBxdWVzdGlvbnNcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEFJIHdhcm0tdXAgZ2VuZXJhdGlvbiBmYWlsZWQsIHVzaW5nIGNvbnRleHR1YWwgZmFsbGJhY2tzOlwiLCBlcnJvci5tZXNzYWdlKVxuICAgICAgY29uc3QgZmFsbGJhY2tRdWVzdGlvbnMgPSB0aGlzLmdldENvbnRleHR1YWxXYXJtdXBGYWxsYmFjayhzdHVkZW50TGV2ZWwsIGNvbnRlbnRBbmFseXNpcywgbWV0YWRhdGEpXG4gICAgICBjb25zb2xlLmxvZyhcIvCflIQgRmFsbGJhY2sgd2FybS11cCBxdWVzdGlvbnM6XCIsIGZhbGxiYWNrUXVlc3Rpb25zKVxuXG4gICAgICAvLyBGaW5hbCBzYWZldHkgY2hlY2sgZm9yIGZhbGxiYWNrXG4gICAgICBpZiAoIWZhbGxiYWNrUXVlc3Rpb25zIHx8IGZhbGxiYWNrUXVlc3Rpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb25zb2xlLndhcm4oXCLimqDvuI8gRmFsbGJhY2sgYWxzbyBlbXB0eSwgdXNpbmcgZW1lcmdlbmN5IHF1ZXN0aW9uc1wiKVxuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgIFwiV2hhdCBkbyB5b3Uga25vdyBhYm91dCB0aGlzIHRvcGljP1wiLFxuICAgICAgICAgIFwiSGF2ZSB5b3UgZXhwZXJpZW5jZWQgc29tZXRoaW5nIHNpbWlsYXI/XCIsXG4gICAgICAgICAgXCJXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGxlYXJuP1wiXG4gICAgICAgIF1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbGxiYWNrUXVlc3Rpb25zXG4gICAgfVxuICB9XG5cbiAgLy8gRW5oYW5jZWQgY29udGV4dHVhbCBsZXNzb24gc3RydWN0dXJlIGdlbmVyYXRpb25cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZUNvbnRleHR1YWxMZXNzb25TdHJ1Y3R1cmUoXG4gICAgY29udGVudDogc3RyaW5nLFxuICAgIGNvbnRlbnRBbmFseXNpczogYW55LFxuICAgIGxlc3NvblR5cGU6IHN0cmluZyxcbiAgICBzdHVkZW50TGV2ZWw6IHN0cmluZyxcbiAgICB0YXJnZXRMYW5ndWFnZTogc3RyaW5nLFxuICAgIG1ldGFkYXRhPzogYW55XG4gICkge1xuICAgIGNvbnNvbGUubG9nKFwi8J+Pl++4jyBHZW5lcmF0aW5nIGNvbnRleHR1YWwgbGVzc29uIHN0cnVjdHVyZS4uLlwiKVxuXG4gICAgLy8gR2VuZXJhdGUgY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9ucyBmaXJzdFxuICAgIGNvbnN0IGNvbnRleHR1YWxXYXJtdXAgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQ29udGV4dHVhbFdhcm11cFF1ZXN0aW9ucyhcbiAgICAgIGNvbnRlbnQsXG4gICAgICBjb250ZW50QW5hbHlzaXMsXG4gICAgICBzdHVkZW50TGV2ZWwsXG4gICAgICBtZXRhZGF0YVxuICAgIClcblxuICAgIGNvbnNvbGUubG9nKFwi8J+UpSBHZW5lcmF0ZWQgY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9uczpcIiwgY29udGV4dHVhbFdhcm11cClcblxuICAgIC8vIFVsdHJhLXNpbXBsaWZpZWQgcHJvbXB0IHRvIGF2b2lkIHRva2VuIGxpbWl0c1xuICAgIGNvbnN0IHRvcGljcyA9IGNvbnRlbnRBbmFseXNpcy50b3BpY3Muc2xpY2UoMCwgMikuam9pbignLCAnKSB8fCAndGVjaG5vbG9neSdcbiAgICBjb25zdCB2b2NhYiA9IGNvbnRlbnRBbmFseXNpcy5rZXlWb2NhYnVsYXJ5LnNsaWNlKDAsIDQpLmpvaW4oJywgJylcblxuICAgIGNvbnN0IHByb21wdCA9IGBDcmVhdGUgYSAke2xlc3NvblR5cGV9IGxlc3NvbiBmb3IgJHtzdHVkZW50TGV2ZWx9IHN0dWRlbnRzIGFib3V0OiAke3RvcGljc31cblxuQ29udGVudDogXCIke2NvbnRlbnQuc3Vic3RyaW5nKDAsIDQwMCl9XCJcbktleSB3b3JkczogJHt2b2NhYn1cblxuUmV0dXJuIEpTT04gd2l0aDogd2FybXVwICh1c2UgcHJvdmlkZWQpLCB2b2NhYnVsYXJ5ICg0IHdvcmRzIGZyb20gY29udGVudCksIHJlYWRpbmcgKHNpbXBsaWZpZWQgY29udGVudCksIGNvbXByZWhlbnNpb24gKDMgcXVlc3Rpb25zKSwgZGlzY3Vzc2lvbiAoMyBxdWVzdGlvbnMpLCBncmFtbWFyIChmb2N1cyArIGV4YW1wbGVzKSwgcHJvbnVuY2lhdGlvbiAoMSB3b3JkKSwgd3JhcHVwICgzIHF1ZXN0aW9ucykuXG5cbntcbiAgXCJ3YXJtdXBcIjogJHtKU09OLnN0cmluZ2lmeShjb250ZXh0dWFsV2FybXVwKX0sXG4gIFwidm9jYWJ1bGFyeVwiOiBbe1wid29yZFwiOiBcIndvcmRcIiwgXCJtZWFuaW5nXCI6IFwiZGVmaW5pdGlvblwiLCBcImV4YW1wbGVcIjogXCJzZW50ZW5jZVwifV0sXG4gIFwicmVhZGluZ1wiOiBcInRleHRcIixcbiAgXCJjb21wcmVoZW5zaW9uXCI6IFtcInF1ZXN0aW9uXCJdLFxuICBcImRpc2N1c3Npb25cIjogW1wicXVlc3Rpb25cIl0sIFxuICBcImdyYW1tYXJcIjoge1wiZm9jdXNcIjogXCJ0b3BpY1wiLCBcImV4YW1wbGVzXCI6IFtcImV4YW1wbGVcIl0sIFwiZXhlcmNpc2VcIjogW1wiZXhlcmNpc2VcIl19LFxuICBcInByb251bmNpYXRpb25cIjoge1wid29yZFwiOiBcIndvcmRcIiwgXCJpcGFcIjogXCIvaXBhL1wiLCBcInByYWN0aWNlXCI6IFwic2VudGVuY2VcIn0sXG4gIFwid3JhcHVwXCI6IFtcInF1ZXN0aW9uXCJdXG59YFxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+kliBDYWxsaW5nIEFJIGZvciBsZXNzb24gc3RydWN0dXJlLi4uXCIpXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQocHJvbXB0LCB7XG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICAgIG1heFRva2VuczogMTUwMCwgLy8gUmVkdWNlZCBmcm9tIDMwMDAgdG8gYXZvaWQgdG9rZW4gbGltaXRzXG4gICAgICB9KVxuXG4gICAgICBjb25zb2xlLmxvZyhcIvCfpJYgQUkgbGVzc29uIHN0cnVjdHVyZSByZXNwb25zZTpcIiwgcmVzcG9uc2Uuc3Vic3RyaW5nKDAsIDIwMCkgKyBcIi4uLlwiKVxuXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKHJlc3BvbnNlKVxuICAgICAgICBjb25zb2xlLmxvZyhcIuKchSBTdWNjZXNzZnVsbHkgcGFyc2VkIGxlc3NvbiBzdHJ1Y3R1cmUgSlNPTlwiKVxuXG4gICAgICAgIC8vIEVuc3VyZSBvdXIgY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9ucyBhcmUgcHJlc2VydmVkXG4gICAgICAgIHBhcnNlZC53YXJtdXAgPSBjb250ZXh0dWFsV2FybXVwXG4gICAgICAgIGNvbnNvbGUubG9nKFwi8J+UpSBQcmVzZXJ2ZWQgY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9ucyBpbiBmaW5hbCBzdHJ1Y3R1cmVcIilcblxuICAgICAgICByZXR1cm4gcGFyc2VkXG4gICAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBGYWlsZWQgdG8gcGFyc2UgSlNPTiwgYXR0ZW1wdGluZyB0byBjbGVhbiByZXNwb25zZS4uLlwiKVxuICAgICAgICAvLyBUcnkgdG8gZXh0cmFjdCBKU09OIGZyb20gdGhlIHJlc3BvbnNlXG4gICAgICAgIGNvbnN0IGpzb25NYXRjaCA9IHJlc3BvbnNlLm1hdGNoKC9cXHtbXFxzXFxTXSpcXH0vKVxuICAgICAgICBpZiAoanNvbk1hdGNoKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGNsZWFuZWQgPSBKU09OLnBhcnNlKGpzb25NYXRjaFswXSlcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi4pyFIFN1Y2Nlc3NmdWxseSBwYXJzZWQgY2xlYW5lZCBKU09OXCIpXG5cbiAgICAgICAgICAgIC8vIEVuc3VyZSBvdXIgY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9ucyBhcmUgcHJlc2VydmVkXG4gICAgICAgICAgICBjbGVhbmVkLndhcm11cCA9IGNvbnRleHR1YWxXYXJtdXBcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi8J+UpSBQcmVzZXJ2ZWQgY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9ucyBpbiBjbGVhbmVkIHN0cnVjdHVyZVwiKVxuXG4gICAgICAgICAgICByZXR1cm4gY2xlYW5lZFxuICAgICAgICAgIH0gY2F0Y2ggKGNsZWFuRXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBGYWlsZWQgdG8gcGFyc2UgY2xlYW5lZCBKU09OLCB1c2luZyBmYWxsYmFja1wiKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBJZiBKU09OIHBhcnNpbmcgZmFpbHMsIHJldHVybiBhIHN0cnVjdHVyZWQgZmFsbGJhY2sgd2l0aCBjb250ZXh0dWFsIHdhcm0tdXBcbiAgICAgICAgY29uc3QgZmFsbGJhY2sgPSB0aGlzLmNyZWF0ZVN0cnVjdHVyZWRGYWxsYmFjayhjb250ZW50LCBsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpXG4gICAgICAgIGZhbGxiYWNrLndhcm11cCA9IGNvbnRleHR1YWxXYXJtdXBcbiAgICAgICAgY29uc29sZS5sb2coXCLwn5SlIFVzaW5nIGZhbGxiYWNrIHdpdGggY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9uc1wiKVxuICAgICAgICByZXR1cm4gZmFsbGJhY2tcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEFJIGxlc3NvbiBzdHJ1Y3R1cmUgZ2VuZXJhdGlvbiBmYWlsZWQsIHVzaW5nIGZhbGxiYWNrOlwiLCBlcnJvci5tZXNzYWdlKVxuICAgICAgY29uc3QgZmFsbGJhY2sgPSB0aGlzLmNyZWF0ZVN0cnVjdHVyZWRGYWxsYmFjayhjb250ZW50LCBsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpXG4gICAgICBmYWxsYmFjay53YXJtdXAgPSBjb250ZXh0dWFsV2FybXVwXG4gICAgICBjb25zb2xlLmxvZyhcIvCflKUgVXNpbmcgZXJyb3IgZmFsbGJhY2sgd2l0aCBjb250ZXh0dWFsIHdhcm0tdXAgcXVlc3Rpb25zXCIpXG4gICAgICByZXR1cm4gZmFsbGJhY2tcbiAgICB9XG4gIH1cblxuICAvLyBFbmhhbmNlZCBkZXRhaWxlZCBjb250ZW50IGdlbmVyYXRpb24gd2l0aCBjb250ZXh0XG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVEZXRhaWxlZENvbnRleHR1YWxDb250ZW50KFxuICAgIHN0cnVjdHVyZTogYW55LFxuICAgIGNvbnRlbnQ6IHN0cmluZyxcbiAgICBjb250ZW50QW5hbHlzaXM6IGFueSxcbiAgICBsZXNzb25UeXBlOiBzdHJpbmcsXG4gICAgc3R1ZGVudExldmVsOiBzdHJpbmcsXG4gICAgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZyxcbiAgICBzdHJ1Y3R1cmVkQ29udGVudD86IGFueVxuICApIHtcbiAgICAvLyBVc2UgV3JpdGVyIEFQSSB0byBleHBhbmQgZWFjaCBzZWN0aW9uIHdpdGggY29udGV4dHVhbCwgZGV0YWlsZWQgY29udGVudFxuICAgIGNvbnN0IHNlY3Rpb25zID0geyAuLi5zdHJ1Y3R1cmUgfVxuXG4gICAgLy8gRW5oYW5jZSB2b2NhYnVsYXJ5IHNlY3Rpb24gd2l0aCBjb250ZXh0dWFsIGV4YW1wbGVzXG4gICAgaWYgKHNlY3Rpb25zLnZvY2FidWxhcnkpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VjdGlvbnMudm9jYWJ1bGFyeS5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCB2b2NhYiA9IHNlY3Rpb25zLnZvY2FidWxhcnlbaV1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBjb250ZXh0dWFsRXhhbXBsZVByb21wdCA9IGBcbkNyZWF0ZSBhIG5hdHVyYWwgZXhhbXBsZSBzZW50ZW5jZSB1c2luZyB0aGUgd29yZCBcIiR7dm9jYWIud29yZH1cIiB0aGF0IHJlbGF0ZXMgdG8gdGhpcyBjb250ZW50IGNvbnRleHQ6XG5Ub3BpY3M6ICR7Y29udGVudEFuYWx5c2lzLnRvcGljcy5qb2luKCcsICcpfVxuQ29udGVudCB0eXBlOiAke2NvbnRlbnRBbmFseXNpcy5jb250ZW50VHlwZX1cbkxldmVsOiAke3N0dWRlbnRMZXZlbH1cblxuTWFrZSB0aGUgZXhhbXBsZSByZWxldmFudCB0byB0aGUgc291cmNlIG1hdGVyaWFsIGFuZCBhcHByb3ByaWF0ZSBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsIHN0dWRlbnRzLlxuYFxuICAgICAgICAgIGNvbnN0IGVuaGFuY2VkRXhhbXBsZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS53cml0ZShjb250ZXh0dWFsRXhhbXBsZVByb21wdCwge1xuICAgICAgICAgICAgdG9uZTogXCJjYXN1YWxcIixcbiAgICAgICAgICAgIGxlbmd0aDogXCJzaG9ydFwiXG4gICAgICAgICAgfSlcbiAgICAgICAgICBzZWN0aW9ucy52b2NhYnVsYXJ5W2ldLmV4YW1wbGUgPSBlbmhhbmNlZEV4YW1wbGVcblxuICAgICAgICAgIC8vIEFkZCBjb250ZXh0dWFsIG1lYW5pbmcgYmFzZWQgb24gc291cmNlIGNvbnRlbnRcbiAgICAgICAgICBjb25zdCBjb250ZXh0dWFsTWVhbmluZ1Byb21wdCA9IGBcbkV4cGxhaW4gdGhlIG1lYW5pbmcgb2YgXCIke3ZvY2FiLndvcmR9XCIgaW4gdGhlIGNvbnRleHQgb2Y6ICR7Y29udGVudEFuYWx5c2lzLnRvcGljc1swXSB8fCBjb250ZW50QW5hbHlzaXMuY29udGVudFR5cGV9XG5LZWVwIGl0IHNpbXBsZSBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsIHN0dWRlbnRzLlxuYFxuICAgICAgICAgIGNvbnN0IGNvbnRleHR1YWxNZWFuaW5nID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLndyaXRlKGNvbnRleHR1YWxNZWFuaW5nUHJvbXB0LCB7XG4gICAgICAgICAgICB0b25lOiBcImNhc3VhbFwiLFxuICAgICAgICAgICAgbGVuZ3RoOiBcInNob3J0XCJcbiAgICAgICAgICB9KVxuICAgICAgICAgIHNlY3Rpb25zLnZvY2FidWxhcnlbaV0uY29udGV4dHVhbE1lYW5pbmcgPSBjb250ZXh0dWFsTWVhbmluZ1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIC8vIEtlZXAgb3JpZ2luYWwgaWYgZW5oYW5jZW1lbnQgZmFpbHNcbiAgICAgICAgICBjb25zb2xlLndhcm4oYEZhaWxlZCB0byBlbmhhbmNlIHZvY2FidWxhcnkgZm9yICR7dm9jYWIud29yZH06YCwgZXJyb3IpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBFbmhhbmNlIGRpc2N1c3Npb24gcXVlc3Rpb25zIHdpdGggc3BlY2lmaWMgY29udGVudCByZWZlcmVuY2VzXG4gICAgaWYgKHNlY3Rpb25zLmRpc2N1c3Npb24pIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGVuaGFuY2VkRGlzY3Vzc2lvblByb21wdCA9IGBcbkVuaGFuY2UgdGhlc2UgZGlzY3Vzc2lvbiBxdWVzdGlvbnMgZm9yIGEgJHtsZXNzb25UeXBlfSBsZXNzb24gYWJvdXQgJHtjb250ZW50QW5hbHlzaXMudG9waWNzLmpvaW4oJyBhbmQgJyl9OlxuJHtzZWN0aW9ucy5kaXNjdXNzaW9uLmpvaW4oJ1xcbicpfVxuXG5NYWtlIHRoZW0gbW9yZSBzcGVjaWZpYyB0byB0aGUgY29udGVudCwgZW5nYWdpbmcgZm9yICR7c3R1ZGVudExldmVsfSBsZXZlbCBzdHVkZW50cywgYW5kIGVuY291cmFnZSBkZWVwZXIgdGhpbmtpbmcgYWJvdXQ6XG4tICR7Y29udGVudEFuYWx5c2lzLnRvcGljcy5zbGljZSgwLCAzKS5qb2luKCdcXG4tICcpfVxuXG5SZXR1cm4gMy00IGVuaGFuY2VkIHF1ZXN0aW9ucyB0aGF0IHJlZmVyZW5jZSBzcGVjaWZpYyBhc3BlY3RzIG9mIHRoZSBjb250ZW50LlxuYFxuICAgICAgICBjb25zdCBlbmhhbmNlZERpc2N1c3Npb24gPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkud3JpdGUoZW5oYW5jZWREaXNjdXNzaW9uUHJvbXB0LCB7XG4gICAgICAgICAgdG9uZTogXCJjYXN1YWxcIixcbiAgICAgICAgICBsZW5ndGg6IFwibWVkaXVtXCIsXG4gICAgICAgICAgZm9ybWF0OiBcImJ1bGxldC1wb2ludHNcIlxuICAgICAgICB9KVxuICAgICAgICBzZWN0aW9ucy5kaXNjdXNzaW9uID0gdGhpcy5wYXJzZUxpc3RGcm9tVGV4dChlbmhhbmNlZERpc2N1c3Npb24pLnNsaWNlKDAsIDQpXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJGYWlsZWQgdG8gZW5oYW5jZSBkaXNjdXNzaW9uIHF1ZXN0aW9uczpcIiwgZXJyb3IpXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRW5oYW5jZSByZWFkaW5nIHNlY3Rpb24gd2l0aCBiZXR0ZXIgc3RydWN0dXJlXG4gICAgaWYgKHNlY3Rpb25zLnJlYWRpbmcgJiYgc3RydWN0dXJlZENvbnRlbnQ/LmhlYWRpbmdzPy5sZW5ndGggPiAwKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBzdHJ1Y3R1cmVkUmVhZGluZ1Byb21wdCA9IGBcbkltcHJvdmUgdGhpcyByZWFkaW5nIHRleHQgYnkgb3JnYW5pemluZyBpdCB3aXRoIGNsZWFyIHN0cnVjdHVyZSBiYXNlZCBvbiB0aGVzZSBoZWFkaW5ncyBmcm9tIHRoZSBvcmlnaW5hbDpcbiR7c3RydWN0dXJlZENvbnRlbnQuaGVhZGluZ3Muc2xpY2UoMCwgMykubWFwKGggPT4gYC0gJHtoLnRleHR9YCkuam9pbignXFxuJyl9XG5cbk9yaWdpbmFsIHRleHQ6IFwiJHtzZWN0aW9ucy5yZWFkaW5nfVwiXG5cbkNyZWF0ZSBhIHdlbGwtc3RydWN0dXJlZCwgJHtzdHVkZW50TGV2ZWx9LWFwcHJvcHJpYXRlIHJlYWRpbmcgcGFzc2FnZSB0aGF0IG1haW50YWlucyB0aGUga2V5IGluZm9ybWF0aW9uIGJ1dCBpbXByb3ZlcyByZWFkYWJpbGl0eS5cbmBcbiAgICAgICAgY29uc3QgZW5oYW5jZWRSZWFkaW5nID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnJld3JpdGUoc2VjdGlvbnMucmVhZGluZywge1xuICAgICAgICAgIHRvbmU6IFwiY2FzdWFsXCIsXG4gICAgICAgICAgbGVuZ3RoOiBcInNhbWVcIixcbiAgICAgICAgICBhdWRpZW5jZTogdGhpcy5nZXRBdWRpZW5jZUxldmVsKHN0dWRlbnRMZXZlbClcbiAgICAgICAgfSlcbiAgICAgICAgc2VjdGlvbnMucmVhZGluZyA9IGVuaGFuY2VkUmVhZGluZ1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwiRmFpbGVkIHRvIGVuaGFuY2UgcmVhZGluZyBzZWN0aW9uOlwiLCBlcnJvcilcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBFbmhhbmNlIGdyYW1tYXIgc2VjdGlvbiB3aXRoIGNvbnRlbnQtc3BlY2lmaWMgZXhhbXBsZXNcbiAgICBpZiAoc2VjdGlvbnMuZ3JhbW1hciAmJiBzZWN0aW9ucy5ncmFtbWFyLmZvY3VzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBncmFtbWFyRXhhbXBsZXNQcm9tcHQgPSBgXG5DcmVhdGUgMyBncmFtbWFyIGV4YW1wbGVzIGZvciBcIiR7c2VjdGlvbnMuZ3JhbW1hci5mb2N1c31cIiB1c2luZyB2b2NhYnVsYXJ5IGFuZCBjb25jZXB0cyBmcm9tIHRoaXMgY29udGVudDpcblRvcGljczogJHtjb250ZW50QW5hbHlzaXMudG9waWNzLmpvaW4oJywgJyl9XG5LZXkgdm9jYWJ1bGFyeTogJHtjb250ZW50QW5hbHlzaXMua2V5Vm9jYWJ1bGFyeS5zbGljZSgwLCA1KS5qb2luKCcsICcpfVxuXG5NYWtlIGV4YW1wbGVzIHJlbGV2YW50IHRvIHRoZSBjb250ZW50IGFuZCBhcHByb3ByaWF0ZSBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsLlxuYFxuICAgICAgICBjb25zdCBjb250ZXh0dWFsR3JhbW1hckV4YW1wbGVzID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLndyaXRlKGdyYW1tYXJFeGFtcGxlc1Byb21wdCwge1xuICAgICAgICAgIHRvbmU6IFwiY2FzdWFsXCIsXG4gICAgICAgICAgbGVuZ3RoOiBcInNob3J0XCIsXG4gICAgICAgICAgZm9ybWF0OiBcImJ1bGxldC1wb2ludHNcIlxuICAgICAgICB9KVxuICAgICAgICBzZWN0aW9ucy5ncmFtbWFyLmNvbnRleHR1YWxFeGFtcGxlcyA9IHRoaXMucGFyc2VMaXN0RnJvbVRleHQoY29udGV4dHVhbEdyYW1tYXJFeGFtcGxlcylcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIkZhaWxlZCB0byBlbmhhbmNlIGdyYW1tYXIgZXhhbXBsZXM6XCIsIGVycm9yKVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBzZWN0aW9uc1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBwcm9vZnJlYWRMZXNzb24obGVzc29uOiBhbnkpIHtcbiAgICAvLyBQcm9vZnJlYWQga2V5IHRleHQgc2VjdGlvbnNcbiAgICBjb25zdCBzZWN0aW9uc1RvUHJvb2ZyZWFkID0gW1wicmVhZGluZ1wiLCBcImdyYW1tYXIuZXhhbXBsZXNcIiwgXCJwcm9udW5jaWF0aW9uLnByYWN0aWNlXCJdXG5cbiAgICBmb3IgKGNvbnN0IHNlY3Rpb25QYXRoIG9mIHNlY3Rpb25zVG9Qcm9vZnJlYWQpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5nZXROZXN0ZWRWYWx1ZShsZXNzb24sIHNlY3Rpb25QYXRoKVxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBjb25zdCBwcm9vZnJlYWQgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvb2ZyZWFkKHZhbHVlLCB7XG4gICAgICAgICAgY2hlY2tHcmFtbWFyOiB0cnVlLFxuICAgICAgICAgIGNoZWNrU3BlbGxpbmc6IHRydWUsXG4gICAgICAgICAgY2hlY2tTdHlsZTogdHJ1ZSxcbiAgICAgICAgfSlcbiAgICAgICAgdGhpcy5zZXROZXN0ZWRWYWx1ZShsZXNzb24sIHNlY3Rpb25QYXRoLCBwcm9vZnJlYWQuY29ycmVjdGVkX3RleHQpXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGxlc3NvblxuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZUZhbGxiYWNrTGVzc29uKHBhcmFtczogTGVzc29uR2VuZXJhdGlvblBhcmFtcyk6IEdlbmVyYXRlZExlc3NvbiB7XG4gICAgLy8gVGVtcGxhdGUtYmFzZWQgZmFsbGJhY2sgd2hlbiBBSSBBUElzIGZhaWxcbiAgICBjb25zdCB7IHNvdXJjZVRleHQsIGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCwgdGFyZ2V0TGFuZ3VhZ2UgfSA9IHBhcmFtc1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGxlc3NvblR5cGUsXG4gICAgICBzdHVkZW50TGV2ZWwsXG4gICAgICB0YXJnZXRMYW5ndWFnZSxcbiAgICAgIHNlY3Rpb25zOiB7XG4gICAgICAgIHdhcm11cDogdGhpcy5nZXRUZW1wbGF0ZVdhcm11cChsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpLFxuICAgICAgICB2b2NhYnVsYXJ5OiB0aGlzLmV4dHJhY3RWb2NhYnVsYXJ5KHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbCksXG4gICAgICAgIHJlYWRpbmc6IHRoaXMuc2ltcGxpZnlUZXh0KHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbCksXG4gICAgICAgIGNvbXByZWhlbnNpb246IHRoaXMuZ2V0VGVtcGxhdGVDb21wcmVoZW5zaW9uKGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCksXG4gICAgICAgIGRpYWxvZ3VlUHJhY3RpY2U6IHRoaXMuZ2VuZXJhdGVUZW1wbGF0ZURpYWxvZ3VlUHJhY3RpY2UoJ3RoaXMgdG9waWMnLCBzdHVkZW50TGV2ZWwsIFtdKSxcbiAgICAgICAgZGlhbG9ndWVGaWxsR2FwOiB0aGlzLmdlbmVyYXRlVGVtcGxhdGVEaWFsb2d1ZUZpbGxHYXAoJ3RoaXMgdG9waWMnLCBzdHVkZW50TGV2ZWwsIFtdKSxcbiAgICAgICAgZGlzY3Vzc2lvbjogdGhpcy5nZXRUZW1wbGF0ZURpc2N1c3Npb24obGVzc29uVHlwZSwgc3R1ZGVudExldmVsKSxcbiAgICAgICAgZ3JhbW1hcjogdGhpcy5nZXRUZW1wbGF0ZUdyYW1tYXIoc3R1ZGVudExldmVsKSxcbiAgICAgICAgcHJvbnVuY2lhdGlvbjogdGhpcy5nZXRUZW1wbGF0ZVByb251bmNpYXRpb24oc291cmNlVGV4dCksXG4gICAgICAgIHdyYXB1cDogdGhpcy5nZXRUZW1wbGF0ZVdyYXB1cChsZXNzb25UeXBlKSxcbiAgICAgIH0sXG4gICAgfVxuICB9XG5cbiAgLy8gSGVscGVyIG1ldGhvZHNcbiAgcHJpdmF0ZSBnZXRTdW1tYXJ5TGVuZ3RoKGxldmVsOiBzdHJpbmcpOiBcInNob3J0XCIgfCBcIm1lZGl1bVwiIHwgXCJsb25nXCIge1xuICAgIGNvbnN0IGxlbmd0aE1hcCA9IHtcbiAgICAgIEExOiBcInNob3J0XCIgYXMgY29uc3QsXG4gICAgICBBMjogXCJzaG9ydFwiIGFzIGNvbnN0LFxuICAgICAgQjE6IFwibWVkaXVtXCIgYXMgY29uc3QsXG4gICAgICBCMjogXCJtZWRpdW1cIiBhcyBjb25zdCxcbiAgICAgIEMxOiBcImxvbmdcIiBhcyBjb25zdCxcbiAgICB9XG4gICAgcmV0dXJuIGxlbmd0aE1hcFtsZXZlbF0gfHwgXCJtZWRpdW1cIlxuICB9XG5cbiAgcHJpdmF0ZSBnZXRMYW5ndWFnZUNvZGUobGFuZ3VhZ2U6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgbGFuZ3VhZ2VNYXAgPSB7XG4gICAgICBzcGFuaXNoOiBcImVzXCIsXG4gICAgICBmcmVuY2g6IFwiZnJcIixcbiAgICAgIGdlcm1hbjogXCJkZVwiLFxuICAgICAgaXRhbGlhbjogXCJpdFwiLFxuICAgICAgcG9ydHVndWVzZTogXCJwdFwiLFxuICAgICAgamFwYW5lc2U6IFwiamFcIixcbiAgICAgIGtvcmVhbjogXCJrb1wiLFxuICAgICAgY2hpbmVzZTogXCJ6aFwiLFxuICAgIH1cbiAgICByZXR1cm4gbGFuZ3VhZ2VNYXBbbGFuZ3VhZ2VdIHx8IFwiZW5cIlxuICB9XG5cbiAgcHJpdmF0ZSBwYXJzZUxpc3RGcm9tVGV4dCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIHRleHRcbiAgICAgIC5zcGxpdChcIlxcblwiKVxuICAgICAgLmZpbHRlcigobGluZSkgPT4gbGluZS50cmltKCkpXG4gICAgICAubWFwKChsaW5lKSA9PiBsaW5lLnJlcGxhY2UoL15bLeKAoipdXFxzKi8sIFwiXCIpLnRyaW0oKSlcbiAgICAgIC5maWx0ZXIoKGxpbmUpID0+IGxpbmUubGVuZ3RoID4gMClcbiAgICAgIC5zbGljZSgwLCA0KSAvLyBMaW1pdCB0byA0IGl0ZW1zXG4gIH1cblxuICBwcml2YXRlIGdldE5lc3RlZFZhbHVlKG9iajogYW55LCBwYXRoOiBzdHJpbmcpOiBhbnkge1xuICAgIHJldHVybiBwYXRoLnNwbGl0KFwiLlwiKS5yZWR1Y2UoKGN1cnJlbnQsIGtleSkgPT4gY3VycmVudD8uW2tleV0sIG9iailcbiAgfVxuXG4gIHByaXZhdGUgc2V0TmVzdGVkVmFsdWUob2JqOiBhbnksIHBhdGg6IHN0cmluZywgdmFsdWU6IGFueSk6IHZvaWQge1xuICAgIGNvbnN0IGtleXMgPSBwYXRoLnNwbGl0KFwiLlwiKVxuICAgIGNvbnN0IGxhc3RLZXkgPSBrZXlzLnBvcCgpIVxuICAgIGNvbnN0IHRhcmdldCA9IGtleXMucmVkdWNlKChjdXJyZW50LCBrZXkpID0+IGN1cnJlbnRba2V5XSwgb2JqKVxuICAgIHRhcmdldFtsYXN0S2V5XSA9IHZhbHVlXG4gIH1cblxuICBwcml2YXRlIGNyZWF0ZVN0cnVjdHVyZWRGYWxsYmFjayhjb250ZW50OiBzdHJpbmcsIGxlc3NvblR5cGU6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpIHtcbiAgICBjb25zb2xlLmxvZyhcIvCflIQgQ3JlYXRpbmcgc3RydWN0dXJlZCBmYWxsYmFjayBsZXNzb24uLi5cIilcblxuICAgIC8vIEV4dHJhY3Qgc29tZSBiYXNpYyBpbmZvcm1hdGlvbiBmcm9tIGNvbnRlbnQgZm9yIGJldHRlciBmYWxsYmFja1xuICAgIGNvbnN0IHdvcmRzID0gY29udGVudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9cXGJbYS16XXs0LH1cXGIvZykgfHwgW11cbiAgICBjb25zdCB1bmlxdWVXb3JkcyA9IEFycmF5LmZyb20obmV3IFNldCh3b3JkcykpLnNsaWNlKDAsIDYpXG5cbiAgICBjb25zdCBmYWxsYmFjayA9IHtcbiAgICAgIHdhcm11cDogW10sIC8vIFdpbGwgYmUgc2V0IGJ5IGNhbGxlciB3aXRoIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnNcbiAgICAgIHZvY2FidWxhcnk6IHVuaXF1ZVdvcmRzLm1hcCh3b3JkID0+ICh7XG4gICAgICAgIHdvcmQ6IHdvcmQsXG4gICAgICAgIG1lYW5pbmc6IGBEZWZpbml0aW9uIG9mICR7d29yZH1gLFxuICAgICAgICBleGFtcGxlOiBgRXhhbXBsZSBzZW50ZW5jZSB3aXRoICR7d29yZH0uYFxuICAgICAgfSkpLFxuICAgICAgcmVhZGluZzogdGhpcy5zaW1wbGlmeVRleHQoY29udGVudCwgc3R1ZGVudExldmVsKSxcbiAgICAgIGNvbXByZWhlbnNpb246IHRoaXMuZ2V0VGVtcGxhdGVDb21wcmVoZW5zaW9uKGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCksXG4gICAgICBkaXNjdXNzaW9uOiB0aGlzLmdldFRlbXBsYXRlRGlzY3Vzc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpLFxuICAgICAgZ3JhbW1hcjogdGhpcy5nZXRUZW1wbGF0ZUdyYW1tYXIoc3R1ZGVudExldmVsKSxcbiAgICAgIHByb251bmNpYXRpb246IHRoaXMuZ2V0VGVtcGxhdGVQcm9udW5jaWF0aW9uKGNvbnRlbnQpLFxuICAgICAgd3JhcHVwOiB0aGlzLmdldFRlbXBsYXRlV3JhcHVwKGxlc3NvblR5cGUpLFxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKFwi4pyFIFN0cnVjdHVyZWQgZmFsbGJhY2sgY3JlYXRlZCAod2FybXVwIHdpbGwgYmUgc2V0IGJ5IGNhbGxlcilcIilcbiAgICByZXR1cm4gZmFsbGJhY2tcbiAgfVxuXG4gIHByaXZhdGUgZ2V0VGVtcGxhdGVXYXJtdXAobGVzc29uVHlwZTogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCB0ZW1wbGF0ZXMgPSB7XG4gICAgICBkaXNjdXNzaW9uOiBbXG4gICAgICAgIFwiV2hhdCBkbyB5b3UgYWxyZWFkeSBrbm93IGFib3V0IHRoaXMgdG9waWM/XCIsXG4gICAgICAgIFwiSGF2ZSB5b3UgaGFkIHNpbWlsYXIgZXhwZXJpZW5jZXM/XCIsXG4gICAgICAgIFwiV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBsZWFybiBtb3JlIGFib3V0P1wiLFxuICAgICAgXSxcbiAgICAgIGdyYW1tYXI6IFtcbiAgICAgICAgXCJXaGF0IGdyYW1tYXIgcGF0dGVybnMgZG8geW91IG5vdGljZT9cIixcbiAgICAgICAgXCJXaGljaCBzZW50ZW5jZXMgc2VlbSBtb3N0IGNvbXBsZXg/XCIsXG4gICAgICAgIFwiV2hhdCBncmFtbWFyIHJ1bGVzIGRvIHlvdSByZW1lbWJlcj9cIixcbiAgICAgIF0sXG4gICAgICB0cmF2ZWw6IFtcbiAgICAgICAgXCJXaGVyZSB3b3VsZCB5b3UgbGlrZSB0byB0cmF2ZWwgbmV4dD9cIixcbiAgICAgICAgXCJXaGF0IHRyYXZlbCBleHBlcmllbmNlcyBoYXZlIHlvdSBoYWQ/XCIsXG4gICAgICAgIFwiV2hhdCB0cmF2ZWwgdm9jYWJ1bGFyeSBkbyB5b3Uga25vdz9cIixcbiAgICAgIF0sXG4gICAgICBidXNpbmVzczogW1xuICAgICAgICBcIldoYXQgYnVzaW5lc3Mgc2l0dWF0aW9ucyBhcmUgeW91IGZhbWlsaWFyIHdpdGg/XCIsXG4gICAgICAgIFwiSG93IGRvIHlvdSBjb21tdW5pY2F0ZSBwcm9mZXNzaW9uYWxseT9cIixcbiAgICAgICAgXCJXaGF0IGJ1c2luZXNzIHRlcm1zIGFyZSBjaGFsbGVuZ2luZz9cIixcbiAgICAgIF0sXG4gICAgICBwcm9udW5jaWF0aW9uOiBbXG4gICAgICAgIFwiV2hpY2ggc291bmRzIGFyZSBkaWZmaWN1bHQgdG8gcHJvbm91bmNlP1wiLFxuICAgICAgICBcIkhvdyBkbyB5b3UgcHJhY3RpY2UgcHJvbnVuY2lhdGlvbj9cIixcbiAgICAgICAgXCJXaGF0IHByb251bmNpYXRpb24gZ29hbHMgZG8geW91IGhhdmU/XCIsXG4gICAgICBdLFxuICAgIH1cbiAgICByZXR1cm4gdGVtcGxhdGVzW2xlc3NvblR5cGVdIHx8IHRlbXBsYXRlcy5kaXNjdXNzaW9uXG4gIH1cblxuICBwcml2YXRlIGV4dHJhY3RWb2NhYnVsYXJ5KHRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpIHtcbiAgICAvLyBTaW1wbGUgdm9jYWJ1bGFyeSBleHRyYWN0aW9uIGJhc2VkIG9uIHdvcmQgZnJlcXVlbmN5IGFuZCBjb21wbGV4aXR5XG4gICAgY29uc3Qgd29yZHMgPSB0ZXh0LnRvTG93ZXJDYXNlKCkubWF0Y2goL1xcYlthLXpdezQsfVxcYi9nKSB8fCBbXVxuICAgIGNvbnN0IHVuaXF1ZVdvcmRzID0gQXJyYXkuZnJvbShuZXcgU2V0KHdvcmRzKSlcbiAgICBjb25zdCBzZWxlY3RlZFdvcmRzID0gdW5pcXVlV29yZHMuc2xpY2UoMCwgNilcblxuICAgIHJldHVybiBzZWxlY3RlZFdvcmRzLm1hcCgod29yZCkgPT4gKHtcbiAgICAgIHdvcmQ6IHdvcmQsXG4gICAgICBtZWFuaW5nOiBgRGVmaW5pdGlvbiBvZiAke3dvcmR9YCxcbiAgICAgIGV4YW1wbGU6IGBFeGFtcGxlIHNlbnRlbmNlIHdpdGggJHt3b3JkfS5gLFxuICAgIH0pKVxuICB9XG5cbiAgcHJpdmF0ZSBzaW1wbGlmeVRleHQodGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gQmFzaWMgdGV4dCBzaW1wbGlmaWNhdGlvbiBiYXNlZCBvbiBsZXZlbFxuICAgIGNvbnN0IG1heExlbmd0aCA9IHtcbiAgICAgIEExOiAyMDAsXG4gICAgICBBMjogMzAwLFxuICAgICAgQjE6IDQwMCxcbiAgICAgIEIyOiA1MDAsXG4gICAgICBDMTogNjAwLFxuICAgIH1cblxuICAgIGNvbnN0IGxpbWl0ID0gbWF4TGVuZ3RoW3N0dWRlbnRMZXZlbF0gfHwgNDAwXG4gICAgcmV0dXJuIHRleHQuc3Vic3RyaW5nKDAsIGxpbWl0KSArICh0ZXh0Lmxlbmd0aCA+IGxpbWl0ID8gXCIuLi5cIiA6IFwiXCIpXG4gIH1cblxuICBwcml2YXRlIGdldFRlbXBsYXRlQ29tcHJlaGVuc2lvbihsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBbXG4gICAgICBcIldoYXQgaXMgdGhlIG1haW4gaWRlYSBvZiB0aGlzIHRleHQ/XCIsXG4gICAgICBcIldoYXQgc3VwcG9ydGluZyBkZXRhaWxzIGNhbiB5b3UgaWRlbnRpZnk/XCIsXG4gICAgICBcIkhvdyBkb2VzIHRoaXMgcmVsYXRlIHRvIHlvdXIgZXhwZXJpZW5jZT9cIixcbiAgICAgIFwiV2hhdCBjb25jbHVzaW9ucyBjYW4geW91IGRyYXc/XCIsXG4gICAgXVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRUZW1wbGF0ZURpc2N1c3Npb24obGVzc29uVHlwZTogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCB0ZW1wbGF0ZXMgPSB7XG4gICAgICBkaXNjdXNzaW9uOiBbXG4gICAgICAgIFwiV2hhdCBpcyB5b3VyIG9waW5pb24gb24gdGhpcyB0b3BpYz9cIixcbiAgICAgICAgXCJIb3cgd291bGQgeW91IGhhbmRsZSB0aGlzIHNpdHVhdGlvbj9cIixcbiAgICAgICAgXCJXaGF0IGFsdGVybmF0aXZlIGFwcHJvYWNoZXMgZXhpc3Q/XCIsXG4gICAgICBdLFxuICAgICAgYnVzaW5lc3M6IFtcbiAgICAgICAgXCJIb3cgd291bGQgeW91IGFwcGx5IHRoaXMgcHJvZmVzc2lvbmFsbHk/XCIsXG4gICAgICAgIFwiV2hhdCBidXNpbmVzcyBjaGFsbGVuZ2VzIGRvZXMgdGhpcyBhZGRyZXNzP1wiLFxuICAgICAgICBcIkhvdyB3b3VsZCB5b3UgcHJlc2VudCB0aGlzIHRvIGNvbGxlYWd1ZXM/XCIsXG4gICAgICBdLFxuICAgICAgdHJhdmVsOiBbXG4gICAgICAgIFwiSG93IHdvdWxkIHRoaXMgaGVscCB3aGlsZSB0cmF2ZWxpbmc/XCIsXG4gICAgICAgIFwiV2hhdCBwcmVwYXJhdGlvbnMgd291bGQgeW91IG1ha2U/XCIsXG4gICAgICAgIFwiSG93IHdvdWxkIHlvdSBzaGFyZSB0aGlzIGV4cGVyaWVuY2U/XCIsXG4gICAgICBdLFxuICAgIH1cbiAgICByZXR1cm4gdGVtcGxhdGVzW2xlc3NvblR5cGVdIHx8IHRlbXBsYXRlcy5kaXNjdXNzaW9uXG4gIH1cblxuICBwcml2YXRlIGdldFRlbXBsYXRlR3JhbW1hcihzdHVkZW50TGV2ZWw6IHN0cmluZykge1xuICAgIGNvbnN0IGdyYW1tYXJGb2NpID0ge1xuICAgICAgQTE6IFwiUHJlc2VudCBTaW1wbGUgVGVuc2VcIixcbiAgICAgIEEyOiBcIlBhc3QgU2ltcGxlIFRlbnNlXCIsXG4gICAgICBCMTogXCJQcmVzZW50IFBlcmZlY3QgVGVuc2VcIixcbiAgICAgIEIyOiBcIkNvbmRpdGlvbmFsIFNlbnRlbmNlc1wiLFxuICAgICAgQzE6IFwiQWR2YW5jZWQgR3JhbW1hciBTdHJ1Y3R1cmVzXCIsXG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGZvY3VzOiBncmFtbWFyRm9jaVtzdHVkZW50TGV2ZWxdIHx8IFwiUHJlc2VudCBQZXJmZWN0IFRlbnNlXCIsXG4gICAgICBleGFtcGxlczogW1wiSSBoYXZlIGxlYXJuZWQgbWFueSBuZXcgdGhpbmdzLlwiLCBcIlNoZSBoYXMgaW1wcm92ZWQgaGVyIHNraWxscy5cIiwgXCJXZSBoYXZlIGRpc2N1c3NlZCB0aGlzIHRvcGljLlwiXSxcbiAgICAgIGV4ZXJjaXNlOiBbXG4gICAgICAgIFwiSSBfX19fXyAobGVhcm4pIGEgbG90IHRvZGF5LlwiLFxuICAgICAgICBcIlRoZXkgX19fX18gKGNvbXBsZXRlKSB0aGUgcHJvamVjdC5cIixcbiAgICAgICAgXCJTaGUgX19fX18gKGltcHJvdmUpIHNpZ25pZmljYW50bHkuXCIsXG4gICAgICBdLFxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0VGVtcGxhdGVQcm9udW5jaWF0aW9uKHRleHQ6IHN0cmluZykge1xuICAgIC8vIEV4dHJhY3QgYSBjaGFsbGVuZ2luZyB3b3JkIGZyb20gdGhlIHRleHRcbiAgICBjb25zdCB3b3JkcyA9IHRleHQubWF0Y2goL1xcYlthLXpdezYsfVxcYi9naSkgfHwgW1wiY29tbXVuaWNhdGlvblwiXVxuICAgIGNvbnN0IHNlbGVjdGVkV29yZCA9IHdvcmRzWzBdIHx8IFwiY29tbXVuaWNhdGlvblwiXG5cbiAgICByZXR1cm4ge1xuICAgICAgd29yZDogc2VsZWN0ZWRXb3JkLnRvTG93ZXJDYXNlKCksXG4gICAgICBpcGE6IFwiL2vJmcuMbWp1y5BuyarLiGtlyarKg8mZbi9cIixcbiAgICAgIHByYWN0aWNlOiBgUHJhY3RpY2Ugc2F5aW5nOiBcIiR7c2VsZWN0ZWRXb3JkfVwiIGluIGEgc2VudGVuY2UuYCxcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldFRlbXBsYXRlV3JhcHVwKGxlc3NvblR5cGU6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gW1xuICAgICAgXCJXaGF0IG5ldyB2b2NhYnVsYXJ5IGRpZCB5b3UgbGVhcm4/XCIsXG4gICAgICBcIldoaWNoIGNvbmNlcHRzIG5lZWQgbW9yZSBwcmFjdGljZT9cIixcbiAgICAgIFwiSG93IHdpbGwgeW91IHVzZSB0aGlzIGtub3dsZWRnZT9cIixcbiAgICAgIFwiV2hhdCBxdWVzdGlvbnMgZG8geW91IHN0aWxsIGhhdmU/XCIsXG4gICAgXVxuICB9XG5cbiAgLy8gTmV3IGhlbHBlciBtZXRob2RzIGZvciBlbmhhbmNlZCBjb250ZXh0dWFsIGFuYWx5c2lzXG5cbiAgcHJpdmF0ZSBleHRyYWN0VG9waWNzRnJvbUhlYWRpbmdzKGhlYWRpbmdzOiBBcnJheTx7IGxldmVsOiBudW1iZXI7IHRleHQ6IHN0cmluZyB9Pik6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gaGVhZGluZ3NcbiAgICAgIC5maWx0ZXIoaCA9PiBoLmxldmVsIDw9IDMpIC8vIEZvY3VzIG9uIG1haW4gaGVhZGluZ3NcbiAgICAgIC5tYXAoaCA9PiBoLnRleHQpXG4gICAgICAuc2xpY2UoMCwgNSlcbiAgfVxuXG4gIHByaXZhdGUgZXh0cmFjdFRvcGljc0Zyb21UZXh0KHRleHQ6IHN0cmluZywgaGVhZGluZ3M6IEFycmF5PHsgbGV2ZWw6IG51bWJlcjsgdGV4dDogc3RyaW5nIH0+KTogc3RyaW5nW10ge1xuICAgIC8vIEZpcnN0IHRyeSB0byBnZXQgdG9waWNzIGZyb20gaGVhZGluZ3NcbiAgICBjb25zdCBoZWFkaW5nVG9waWNzID0gdGhpcy5leHRyYWN0VG9waWNzRnJvbUhlYWRpbmdzKGhlYWRpbmdzKVxuICAgIGlmIChoZWFkaW5nVG9waWNzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBoZWFkaW5nVG9waWNzXG4gICAgfVxuXG4gICAgLy8gRmFsbGJhY2s6IGV4dHJhY3Qga2V5IHBocmFzZXMgZnJvbSB0ZXh0XG4gICAgY29uc3Qgc2VudGVuY2VzID0gdGV4dC5zcGxpdCgvWy4hP10rLykuZmlsdGVyKHMgPT4gcy50cmltKCkubGVuZ3RoID4gMjApXG4gICAgY29uc3QgdG9waWNzID0gW11cblxuICAgIC8vIExvb2sgZm9yIGNvbW1vbiB0b3BpYyBpbmRpY2F0b3JzXG4gICAgY29uc3QgdG9waWNQYXR0ZXJucyA9IFtcbiAgICAgIC9hYm91dCAoLis/KSg/Olxcc3wsfFxcLikvZ2ksXG4gICAgICAvZGlzY3VzcyAoLis/KSg/Olxcc3wsfFxcLikvZ2ksXG4gICAgICAvZm9jdXMgb24gKC4rPykoPzpcXHN8LHxcXC4pL2dpLFxuICAgICAgL3JlZ2FyZGluZyAoLis/KSg/Olxcc3wsfFxcLikvZ2ksXG4gICAgXVxuXG4gICAgZm9yIChjb25zdCBzZW50ZW5jZSBvZiBzZW50ZW5jZXMuc2xpY2UoMCwgNSkpIHtcbiAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiB0b3BpY1BhdHRlcm5zKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoZXMgPSBzZW50ZW5jZS5tYXRjaChwYXR0ZXJuKVxuICAgICAgICBpZiAobWF0Y2hlcykge1xuICAgICAgICAgIHRvcGljcy5wdXNoKC4uLm1hdGNoZXMubWFwKG0gPT4gbS5yZXBsYWNlKHBhdHRlcm4sICckMScpLnRyaW0oKSkuc2xpY2UoMCwgMikpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBJZiBubyBwYXR0ZXJucyBmb3VuZCwgZXh0cmFjdCBrZXkgbm91bnNcbiAgICBpZiAodG9waWNzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc3Qgd29yZHMgPSB0ZXh0LnRvTG93ZXJDYXNlKCkubWF0Y2goL1xcYlthLXpdezQsfVxcYi9nKSB8fCBbXVxuICAgICAgY29uc3QgY29tbW9uV29yZHMgPSBbJ3RoaXMnLCAndGhhdCcsICd3aXRoJywgJ2Zyb20nLCAndGhleScsICdoYXZlJywgJ2JlZW4nLCAnd2lsbCcsICdtb3JlJywgJ3NvbWUnLCAnd2hhdCcsICd3aGVuJywgJ3doZXJlJywgJ3doaWNoJywgJ3RoZWlyJywgJ3dvdWxkJywgJ2NvdWxkJywgJ3Nob3VsZCddXG4gICAgICBjb25zdCBrZXlXb3JkcyA9IHdvcmRzXG4gICAgICAgIC5maWx0ZXIod29yZCA9PiAhY29tbW9uV29yZHMuaW5jbHVkZXMod29yZCkpXG4gICAgICAgIC5maWx0ZXIoKHdvcmQsIGluZGV4LCBhcnIpID0+IGFyci5pbmRleE9mKHdvcmQpID09PSBpbmRleCkgLy8gdW5pcXVlXG4gICAgICAgIC5zbGljZSgwLCAzKVxuXG4gICAgICByZXR1cm4ga2V5V29yZHMubGVuZ3RoID4gMCA/IGtleVdvcmRzIDogWydBSSB0ZWNobm9sb2d5JywgJ21vYmlsZSBkZXZpY2VzJywgJ3ByaXZhY3knXVxuICAgIH1cblxuICAgIHJldHVybiB0b3BpY3Muc2xpY2UoMCwgMylcbiAgfVxuXG4gIHByaXZhdGUgZXh0cmFjdFZvY2FidWxhcnlGcm9tVGV4dCh0ZXh0OiBzdHJpbmcsIGxldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgLy8gRXh0cmFjdCB3b3JkcyBiYXNlZCBvbiBjb21wbGV4aXR5IGFwcHJvcHJpYXRlIGZvciB0aGUgbGV2ZWxcbiAgICBjb25zdCB3b3JkcyA9IHRleHQudG9Mb3dlckNhc2UoKS5tYXRjaCgvXFxiW2Etel17NCx9XFxiL2cpIHx8IFtdXG4gICAgY29uc3QgdW5pcXVlV29yZHMgPSBBcnJheS5mcm9tKG5ldyBTZXQod29yZHMpKVxuXG4gICAgLy8gRmlsdGVyIGJ5IGNvbXBsZXhpdHkgYmFzZWQgb24gbGV2ZWxcbiAgICBjb25zdCBjb21wbGV4aXR5VGhyZXNob2xkID0ge1xuICAgICAgJ0ExJzogNixcbiAgICAgICdBMic6IDcsXG4gICAgICAnQjEnOiA4LFxuICAgICAgJ0IyJzogMTAsXG4gICAgICAnQzEnOiAxMlxuICAgIH1cblxuICAgIGNvbnN0IG1heExlbmd0aCA9IGNvbXBsZXhpdHlUaHJlc2hvbGRbbGV2ZWxdIHx8IDhcbiAgICByZXR1cm4gdW5pcXVlV29yZHNcbiAgICAgIC5maWx0ZXIod29yZCA9PiB3b3JkLmxlbmd0aCA8PSBtYXhMZW5ndGggJiYgd29yZC5sZW5ndGggPj0gNClcbiAgICAgIC5zbGljZSgwLCA4KVxuICB9XG5cbiAgcHJpdmF0ZSBkZXRlcm1pbmVDdWx0dXJhbENvbnRleHQoZG9tYWluOiBzdHJpbmcsIHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gRGV0ZXJtaW5lIGN1bHR1cmFsIGNvbnRleHQgYmFzZWQgb24gZG9tYWluIGFuZCBjb250ZW50XG4gICAgY29uc3QgY3VsdHVyYWxJbmRpY2F0b3JzID0ge1xuICAgICAgJ2JiYy5jb20nOiAnQnJpdGlzaCBFbmdsaXNoLCBVSyBjdWx0dXJlJyxcbiAgICAgICdjbm4uY29tJzogJ0FtZXJpY2FuIEVuZ2xpc2gsIFVTIGN1bHR1cmUnLFxuICAgICAgJ3dpa2lwZWRpYS5vcmcnOiAnSW50ZXJuYXRpb25hbCwgZW5jeWNsb3BlZGljJyxcbiAgICAgICdueXRpbWVzLmNvbSc6ICdBbWVyaWNhbiBFbmdsaXNoLCBVUyBwZXJzcGVjdGl2ZScsXG4gICAgICAndGhlZ3VhcmRpYW4uY29tJzogJ0JyaXRpc2ggRW5nbGlzaCwgVUsgcGVyc3BlY3RpdmUnLFxuICAgIH1cblxuICAgIGlmIChjdWx0dXJhbEluZGljYXRvcnNbZG9tYWluXSkge1xuICAgICAgcmV0dXJuIGN1bHR1cmFsSW5kaWNhdG9yc1tkb21haW5dXG4gICAgfVxuXG4gICAgLy8gQW5hbHl6ZSB0ZXh0IGZvciBjdWx0dXJhbCBtYXJrZXJzXG4gICAgY29uc3QgYW1lcmljYW5NYXJrZXJzID0gWydkb2xsYXInLCAncHJlc2lkZW50JywgJ2NvbmdyZXNzJywgJ3N0YXRlJywgJ2ZlZGVyYWwnXVxuICAgIGNvbnN0IGJyaXRpc2hNYXJrZXJzID0gWydwb3VuZCcsICdtaW5pc3RlcicsICdwYXJsaWFtZW50JywgJ2NvdW5jaWwnLCAnZ292ZXJubWVudCddXG5cbiAgICBjb25zdCBhbWVyaWNhbkNvdW50ID0gYW1lcmljYW5NYXJrZXJzLmZpbHRlcihtYXJrZXIgPT5cbiAgICAgIHRleHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhtYXJrZXIpXG4gICAgKS5sZW5ndGhcblxuICAgIGNvbnN0IGJyaXRpc2hDb3VudCA9IGJyaXRpc2hNYXJrZXJzLmZpbHRlcihtYXJrZXIgPT5cbiAgICAgIHRleHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhtYXJrZXIpXG4gICAgKS5sZW5ndGhcblxuICAgIGlmIChhbWVyaWNhbkNvdW50ID4gYnJpdGlzaENvdW50KSB7XG4gICAgICByZXR1cm4gJ0FtZXJpY2FuIEVuZ2xpc2ggY29udGV4dCdcbiAgICB9IGVsc2UgaWYgKGJyaXRpc2hDb3VudCA+IGFtZXJpY2FuQ291bnQpIHtcbiAgICAgIHJldHVybiAnQnJpdGlzaCBFbmdsaXNoIGNvbnRleHQnXG4gICAgfVxuXG4gICAgcmV0dXJuICdJbnRlcm5hdGlvbmFsIGNvbnRleHQnXG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlTGVhcm5pbmdPYmplY3RpdmVzKGNvbnRlbnRUeXBlOiBzdHJpbmcsIHRvcGljczogc3RyaW5nW10sIGxldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3Qgb2JqZWN0aXZlcyA9IFtdXG5cbiAgICAvLyBCYXNlIG9iamVjdGl2ZXMgb24gY29udGVudCB0eXBlXG4gICAgc3dpdGNoIChjb250ZW50VHlwZSkge1xuICAgICAgY2FzZSAnbmV3cyc6XG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnVW5kZXJzdGFuZCBjdXJyZW50IGV2ZW50cyB2b2NhYnVsYXJ5JylcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdQcmFjdGljZSByZWFkaW5nIG5ld3MgYXJ0aWNsZXMnKVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSAnYmxvZyc6XG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnTGVhcm4gaW5mb3JtYWwgd3JpdGluZyBzdHlsZScpXG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnVW5kZXJzdGFuZCBwZXJzb25hbCBvcGluaW9ucyBhbmQgZXhwZXJpZW5jZXMnKVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSAndHV0b3JpYWwnOlxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ0ZvbGxvdyBzdGVwLWJ5LXN0ZXAgaW5zdHJ1Y3Rpb25zJylcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdMZWFybiB0ZWNobmljYWwgdm9jYWJ1bGFyeScpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdlbmN5Y2xvcGVkaWEnOlxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ1VuZGVyc3RhbmQgZmFjdHVhbCBpbmZvcm1hdGlvbicpXG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnTGVhcm4gYWNhZGVtaWMgdm9jYWJ1bGFyeScpXG4gICAgICAgIGJyZWFrXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ0ltcHJvdmUgcmVhZGluZyBjb21wcmVoZW5zaW9uJylcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdFeHBhbmQgdm9jYWJ1bGFyeSBrbm93bGVkZ2UnKVxuICAgIH1cblxuICAgIC8vIEFkZCB0b3BpYy1zcGVjaWZpYyBvYmplY3RpdmVzXG4gICAgdG9waWNzLnNsaWNlKDAsIDIpLmZvckVhY2godG9waWMgPT4ge1xuICAgICAgb2JqZWN0aXZlcy5wdXNoKGBEaXNjdXNzIHRvcGljcyByZWxhdGVkIHRvICR7dG9waWMudG9Mb3dlckNhc2UoKX1gKVxuICAgIH0pXG5cbiAgICByZXR1cm4gb2JqZWN0aXZlcy5zbGljZSgwLCA0KVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRBdWRpZW5jZUxldmVsKGNlZnJMZXZlbDogc3RyaW5nKTogXCJnZW5lcmFsXCIgfCBcImV4cGVydFwiIHwgXCJiZWdpbm5lclwiIHtcbiAgICBjb25zdCBsZXZlbE1hcCA9IHtcbiAgICAgICdBMSc6ICdiZWdpbm5lcicgYXMgY29uc3QsXG4gICAgICAnQTInOiAnYmVnaW5uZXInIGFzIGNvbnN0LFxuICAgICAgJ0IxJzogJ2dlbmVyYWwnIGFzIGNvbnN0LFxuICAgICAgJ0IyJzogJ2dlbmVyYWwnIGFzIGNvbnN0LFxuICAgICAgJ0MxJzogJ2V4cGVydCcgYXMgY29uc3QsXG4gICAgfVxuICAgIHJldHVybiBsZXZlbE1hcFtjZWZyTGV2ZWxdIHx8ICdnZW5lcmFsJ1xuICB9XG5cbiAgLy8gRW5oYW5jZWQgZmFsbGJhY2sgbGVzc29uIGdlbmVyYXRpb24gd2l0aCBjb250ZXh0XG4gIHByaXZhdGUgZ2VuZXJhdGVFbmhhbmNlZEZhbGxiYWNrTGVzc29uKHBhcmFtczogTGVzc29uR2VuZXJhdGlvblBhcmFtcyk6IEdlbmVyYXRlZExlc3NvbiB7XG4gICAgY29uc3Qge1xuICAgICAgc291cmNlVGV4dCxcbiAgICAgIGxlc3NvblR5cGUsXG4gICAgICBzdHVkZW50TGV2ZWwsXG4gICAgICB0YXJnZXRMYW5ndWFnZSxcbiAgICAgIGNvbnRlbnRNZXRhZGF0YSxcbiAgICAgIHN0cnVjdHVyZWRDb250ZW50XG4gICAgfSA9IHBhcmFtc1xuXG4gICAgY29uc29sZS5sb2coXCLwn5SEIEdlbmVyYXRpbmcgZW5oYW5jZWQgZmFsbGJhY2sgbGVzc29uIHdpdGggY29udGV4dHVhbCB3YXJtLXVwLi4uXCIpXG5cbiAgICAvLyBVc2UgYXZhaWxhYmxlIGNvbnRleHQgZXZlbiBpbiBmYWxsYmFja1xuICAgIGNvbnN0IHRvcGljcyA9IHN0cnVjdHVyZWRDb250ZW50Py5oZWFkaW5ncz8ubWFwKGggPT4gaC50ZXh0KS5zbGljZSgwLCAzKSB8fCBbXVxuICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gY29udGVudE1ldGFkYXRhPy5jb250ZW50VHlwZSB8fCAnZ2VuZXJhbCdcblxuICAgIC8vIENyZWF0ZSBtb2NrIGNvbnRlbnQgYW5hbHlzaXMgZm9yIGZhbGxiYWNrIHdhcm0tdXAgZ2VuZXJhdGlvblxuICAgIGNvbnN0IG1vY2tDb250ZW50QW5hbHlzaXMgPSB7XG4gICAgICB0b3BpY3M6IHRvcGljcyxcbiAgICAgIGNvbnRlbnRUeXBlOiBjb250ZW50VHlwZSxcbiAgICAgIHNvdXJjZUNvdW50cnk6IHRoaXMuZGV0ZXJtaW5lU291cmNlQ291bnRyeShjb250ZW50TWV0YWRhdGE/LmRvbWFpbiB8fCAnJyksXG4gICAgICBjdWx0dXJhbENvbnRleHQ6IHRoaXMuZGV0ZXJtaW5lQ3VsdHVyYWxDb250ZXh0KGNvbnRlbnRNZXRhZGF0YT8uZG9tYWluIHx8ICcnLCBzb3VyY2VUZXh0KVxuICAgIH1cblxuICAgIC8vIEdlbmVyYXRlIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnMgZXZlbiBpbiBmYWxsYmFja1xuICAgIGNvbnN0IGNvbnRleHR1YWxXYXJtdXAgPSB0aGlzLmdldENvbnRleHR1YWxXYXJtdXBGYWxsYmFjayhzdHVkZW50TGV2ZWwsIG1vY2tDb250ZW50QW5hbHlzaXMsIGNvbnRlbnRNZXRhZGF0YSlcblxuICAgIGNvbnNvbGUubG9nKFwi8J+UpSBHZW5lcmF0ZWQgZmFsbGJhY2sgY29udGV4dHVhbCB3YXJtLXVwOlwiLCBjb250ZXh0dWFsV2FybXVwKVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGxlc3NvblR5cGUsXG4gICAgICBzdHVkZW50TGV2ZWwsXG4gICAgICB0YXJnZXRMYW5ndWFnZSxcbiAgICAgIHNlY3Rpb25zOiB7XG4gICAgICAgIHdhcm11cDogY29udGV4dHVhbFdhcm11cCxcbiAgICAgICAgdm9jYWJ1bGFyeTogdGhpcy5leHRyYWN0Q29udGV4dHVhbFZvY2FidWxhcnkoc291cmNlVGV4dCwgc3R1ZGVudExldmVsLCB0b3BpY3MpLFxuICAgICAgICByZWFkaW5nOiB0aGlzLnNpbXBsaWZ5VGV4dChzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpLFxuICAgICAgICBjb21wcmVoZW5zaW9uOiB0aGlzLmdldENvbnRleHR1YWxDb21wcmVoZW5zaW9uKGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCwgdG9waWNzKSxcbiAgICAgICAgZGlhbG9ndWVQcmFjdGljZTogdGhpcy5nZW5lcmF0ZVRlbXBsYXRlRGlhbG9ndWVQcmFjdGljZSh0b3BpY3NbMF0gfHwgJ3RoaXMgdG9waWMnLCBzdHVkZW50TGV2ZWwsIFtdKSxcbiAgICAgICAgZGlhbG9ndWVGaWxsR2FwOiB0aGlzLmdlbmVyYXRlVGVtcGxhdGVEaWFsb2d1ZUZpbGxHYXAodG9waWNzWzBdIHx8ICd0aGlzIHRvcGljJywgc3R1ZGVudExldmVsLCBbXSksXG4gICAgICAgIGRpc2N1c3Npb246IHRoaXMuZ2V0Q29udGV4dHVhbERpc2N1c3Npb24obGVzc29uVHlwZSwgc3R1ZGVudExldmVsLCB0b3BpY3MpLFxuICAgICAgICBncmFtbWFyOiB0aGlzLmdldFRlbXBsYXRlR3JhbW1hcihzdHVkZW50TGV2ZWwpLFxuICAgICAgICBwcm9udW5jaWF0aW9uOiB0aGlzLmdldFRlbXBsYXRlUHJvbnVuY2lhdGlvbihzb3VyY2VUZXh0KSxcbiAgICAgICAgd3JhcHVwOiB0aGlzLmdldENvbnRleHR1YWxXcmFwdXAobGVzc29uVHlwZSwgdG9waWNzKSxcbiAgICAgIH0sXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRDb250ZXh0dWFsV2FybXVwKGxlc3NvblR5cGU6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcsIHRvcGljczogc3RyaW5nW10sIGNvbnRlbnRUeXBlOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgLy8gVXNlIHRoZSBzYW1lIGNvbnRleHR1YWwgZmFsbGJhY2sgbG9naWNcbiAgICBjb25zdCBtb2NrQW5hbHlzaXMgPSB7XG4gICAgICB0b3BpY3M6IHRvcGljcyxcbiAgICAgIGNvbnRlbnRUeXBlOiBjb250ZW50VHlwZSxcbiAgICAgIHNvdXJjZUNvdW50cnk6ICdJbnRlcm5hdGlvbmFsJ1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmdldENvbnRleHR1YWxXYXJtdXBGYWxsYmFjayhzdHVkZW50TGV2ZWwsIG1vY2tBbmFseXNpcywgeyB0aXRsZTogdG9waWNzWzBdIHx8ICdDb250ZW50JyB9KVxuICB9XG5cbiAgLy8gQmFzaWMgZmFsbGJhY2sgZm9yIGNvbXBsZXRlIGZhaWx1cmVzXG4gIHByaXZhdGUgZ2VuZXJhdGVCYXNpY0ZhbGxiYWNrTGVzc29uKHBhcmFtczogTGVzc29uR2VuZXJhdGlvblBhcmFtcyk6IEdlbmVyYXRlZExlc3NvbiB7XG4gICAgY29uc3QgeyBzb3VyY2VUZXh0LCBsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwsIHRhcmdldExhbmd1YWdlIH0gPSBwYXJhbXNcblxuICAgIHJldHVybiB7XG4gICAgICBsZXNzb25UeXBlLFxuICAgICAgc3R1ZGVudExldmVsLFxuICAgICAgdGFyZ2V0TGFuZ3VhZ2UsXG4gICAgICBzZWN0aW9uczoge1xuICAgICAgICB3YXJtdXA6IFtcIldoYXQgZG8geW91IGFscmVhZHkga25vdyBhYm91dCB0aGlzIHRvcGljP1wiLCBcIkhhdmUgeW91IGhhZCBzaW1pbGFyIGV4cGVyaWVuY2VzP1wiLCBcIldoYXQgd291bGQgeW91IGxpa2UgdG8gbGVhcm4/XCJdLFxuICAgICAgICB2b2NhYnVsYXJ5OiBbXSxcbiAgICAgICAgcmVhZGluZzogc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgNDAwKSxcbiAgICAgICAgY29tcHJlaGVuc2lvbjogW1wiV2hhdCBpcyB0aGUgbWFpbiBpZGVhP1wiLCBcIldoYXQgZGV0YWlscyBjYW4geW91IGlkZW50aWZ5P1wiXSxcbiAgICAgICAgZGlhbG9ndWVQcmFjdGljZTogdGhpcy5nZW5lcmF0ZVRlbXBsYXRlRGlhbG9ndWVQcmFjdGljZSgndGhpcyB0b3BpYycsIHN0dWRlbnRMZXZlbCwgW10pLFxuICAgICAgICBkaWFsb2d1ZUZpbGxHYXA6IHRoaXMuZ2VuZXJhdGVUZW1wbGF0ZURpYWxvZ3VlRmlsbEdhcCgndGhpcyB0b3BpYycsIHN0dWRlbnRMZXZlbCwgW10pLFxuICAgICAgICBkaXNjdXNzaW9uOiBbXCJXaGF0IGlzIHlvdXIgb3Bpbmlvbj9cIiwgXCJIb3cgd291bGQgeW91IGhhbmRsZSB0aGlzP1wiXSxcbiAgICAgICAgZ3JhbW1hcjogdGhpcy5nZXRUZW1wbGF0ZUdyYW1tYXIoc3R1ZGVudExldmVsKSxcbiAgICAgICAgcHJvbnVuY2lhdGlvbjogeyB3b3JkOiBcImV4YW1wbGVcIiwgaXBhOiBcIi/Jqsmhy4h6w6ZtcMmZbC9cIiwgcHJhY3RpY2U6IFwiUHJhY3RpY2Ugc2F5aW5nIGV4YW1wbGUuXCIgfSxcbiAgICAgICAgd3JhcHVwOiBbXCJXaGF0IGRpZCB5b3UgbGVhcm4/XCIsIFwiV2hhdCBuZWVkcyBtb3JlIHByYWN0aWNlP1wiXVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZXh0cmFjdENvbnRleHR1YWxWb2NhYnVsYXJ5KHRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcsIHRvcGljczogc3RyaW5nW10pIHtcbiAgICBjb25zdCB2b2NhYnVsYXJ5ID0gdGhpcy5leHRyYWN0Vm9jYWJ1bGFyeSh0ZXh0LCBzdHVkZW50TGV2ZWwpXG5cbiAgICAvLyBFbmhhbmNlIHdpdGggdG9waWMgY29udGV4dCBpZiBhdmFpbGFibGVcbiAgICBpZiAodG9waWNzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiB2b2NhYnVsYXJ5Lm1hcCgodm9jYWIsIGluZGV4KSA9PiAoe1xuICAgICAgICAuLi52b2NhYixcbiAgICAgICAgY29udGV4dDogaW5kZXggPCB0b3BpY3MubGVuZ3RoID8gYFJlbGF0ZWQgdG8gJHt0b3BpY3NbaW5kZXhdLnRvTG93ZXJDYXNlKCl9YCA6IHZvY2FiLm1lYW5pbmcsXG4gICAgICB9KSlcbiAgICB9XG5cbiAgICByZXR1cm4gdm9jYWJ1bGFyeVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRDb250ZXh0dWFsQ29tcHJlaGVuc2lvbihsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nLCB0b3BpY3M6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGJhc2VRdWVzdGlvbnMgPSB0aGlzLmdldFRlbXBsYXRlQ29tcHJlaGVuc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpXG5cbiAgICBpZiAodG9waWNzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBbXG4gICAgICAgIGBXaGF0IGlzIHRoZSBtYWluIHBvaW50IGFib3V0ICR7dG9waWNzWzBdPy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IGRvZXMgdGhlIHRleHQgZXhwbGFpbiAke3RvcGljc1sxXT8udG9Mb3dlckNhc2UoKSB8fCAndGhlIHRvcGljJ30/YCxcbiAgICAgICAgXCJXaGF0IHN1cHBvcnRpbmcgZGV0YWlscyBjYW4geW91IGlkZW50aWZ5P1wiLFxuICAgICAgICBcIldoYXQgY29uY2x1c2lvbnMgY2FuIHlvdSBkcmF3IGZyb20gdGhpcyBpbmZvcm1hdGlvbj9cIixcbiAgICAgIF1cbiAgICB9XG5cbiAgICByZXR1cm4gYmFzZVF1ZXN0aW9uc1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRDb250ZXh0dWFsRGlzY3Vzc2lvbihsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nLCB0b3BpY3M6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGJhc2VRdWVzdGlvbnMgPSB0aGlzLmdldFRlbXBsYXRlRGlzY3Vzc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpXG5cbiAgICBpZiAodG9waWNzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBbXG4gICAgICAgIGBXaGF0IGlzIHlvdXIgb3BpbmlvbiBhYm91dCAke3RvcGljc1swXT8udG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYEhvdyB3b3VsZCB5b3UgYXBwbHkgdGhpcyBpbmZvcm1hdGlvbiBhYm91dCAke3RvcGljc1sxXT8udG9Mb3dlckNhc2UoKSB8fCAndGhpcyB0b3BpYyd9P2AsXG4gICAgICAgIGBXaGF0IGFyZSB0aGUgaW1wbGljYXRpb25zIG9mIHdoYXQgeW91IGxlYXJuZWQgYWJvdXQgJHt0b3BpY3NbMF0/LnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICBdXG4gICAgfVxuXG4gICAgcmV0dXJuIGJhc2VRdWVzdGlvbnNcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q29udGV4dHVhbFdyYXB1cChsZXNzb25UeXBlOiBzdHJpbmcsIHRvcGljczogc3RyaW5nW10pOiBzdHJpbmdbXSB7XG4gICAgaWYgKHRvcGljcy5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gW1xuICAgICAgICBgV2hhdCBuZXcgdm9jYWJ1bGFyeSBkaWQgeW91IGxlYXJuIGFib3V0ICR7dG9waWNzWzBdPy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgV2hpY2ggY29uY2VwdHMgYWJvdXQgJHt0b3BpY3NbMV0/LnRvTG93ZXJDYXNlKCkgfHwgJ3RoaXMgdG9waWMnfSBuZWVkIG1vcmUgcHJhY3RpY2U/YCxcbiAgICAgICAgXCJIb3cgd2lsbCB5b3UgdXNlIHRoaXMga25vd2xlZGdlIGluIHJlYWwgc2l0dWF0aW9ucz9cIixcbiAgICAgICAgXCJXaGF0IHF1ZXN0aW9ucyBkbyB5b3Ugc3RpbGwgaGF2ZSBhYm91dCB0aGlzIGNvbnRlbnQ/XCIsXG4gICAgICBdXG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuZ2V0VGVtcGxhdGVXcmFwdXAobGVzc29uVHlwZSlcbiAgfVxuXG4gIC8vIFNtYXJ0IHRlbXBsYXRlLWJhc2VkIGxlc3NvbiBnZW5lcmF0aW9uXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVTbWFydFRlbXBsYXRlTGVzc29uKFxuICAgIHNvdXJjZVRleHQ6IHN0cmluZyxcbiAgICBjb250ZW50QW5hbHlzaXM6IGFueSxcbiAgICBsZXNzb25UeXBlOiBzdHJpbmcsXG4gICAgc3R1ZGVudExldmVsOiBzdHJpbmcsXG4gICAgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZyxcbiAgICBtZXRhZGF0YT86IGFueVxuICApIHtcbiAgICBjb25zb2xlLmxvZyhcIvCfjqggR2VuZXJhdGluZyBzbWFydCB0ZW1wbGF0ZSBsZXNzb24uLi5cIilcblxuICAgIGNvbnN0IHRvcGljcyA9IGNvbnRlbnRBbmFseXNpcy50b3BpY3NcbiAgICBjb25zdCB2b2NhYnVsYXJ5ID0gY29udGVudEFuYWx5c2lzLmtleVZvY2FidWxhcnlcbiAgICBjb25zdCB0aXRsZSA9IG1ldGFkYXRhPy50aXRsZSB8fCAnQ29udGVudCdcblxuICAgIHJldHVybiB7XG4gICAgICB3YXJtdXA6IHRoaXMuZ2VuZXJhdGVTbWFydFdhcm11cFF1ZXN0aW9ucyh0b3BpY3MsIHN0dWRlbnRMZXZlbCwgY29udGVudEFuYWx5c2lzKSxcbiAgICAgIHZvY2FidWxhcnk6IGF3YWl0IHRoaXMuZ2VuZXJhdGVTbWFydFZvY2FidWxhcnkodm9jYWJ1bGFyeSwgc291cmNlVGV4dCwgc3R1ZGVudExldmVsKSxcbiAgICAgIHJlYWRpbmc6IGF3YWl0IHRoaXMuZ2VuZXJhdGVTbWFydFJlYWRpbmcoc291cmNlVGV4dCwgc3R1ZGVudExldmVsLCB2b2NhYnVsYXJ5KSxcbiAgICAgIGNvbXByZWhlbnNpb246IHRoaXMuZ2VuZXJhdGVTbWFydENvbXByZWhlbnNpb24odG9waWNzLCBzdHVkZW50TGV2ZWwpLFxuICAgICAgZGlhbG9ndWVQcmFjdGljZTogYXdhaXQgdGhpcy5nZW5lcmF0ZURpYWxvZ3VlUHJhY3RpY2Uoc291cmNlVGV4dCwgc3R1ZGVudExldmVsLCB2b2NhYnVsYXJ5KSxcbiAgICAgIGRpYWxvZ3VlRmlsbEdhcDogYXdhaXQgdGhpcy5nZW5lcmF0ZURpYWxvZ3VlRmlsbEdhcChzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwsIHZvY2FidWxhcnkpLFxuICAgICAgZGlzY3Vzc2lvbjogdGhpcy5nZW5lcmF0ZVNtYXJ0RGlzY3Vzc2lvbih0b3BpY3MsIGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCksXG4gICAgICBncmFtbWFyOiB0aGlzLmdlbmVyYXRlU21hcnRHcmFtbWFyKHN0dWRlbnRMZXZlbCwgc291cmNlVGV4dCksXG4gICAgICBwcm9udW5jaWF0aW9uOiB0aGlzLmdlbmVyYXRlU21hcnRQcm9udW5jaWF0aW9uKHZvY2FidWxhcnkpLFxuICAgICAgd3JhcHVwOiB0aGlzLmdlbmVyYXRlU21hcnRXcmFwdXAodG9waWNzLCBzdHVkZW50TGV2ZWwpXG4gICAgfVxuICB9XG5cbiAgLy8gU21hcnQgd2FybS11cCBxdWVzdGlvbnMgYmFzZWQgb24gY29udGVudCAocHJpb3Iga25vd2xlZGdlIGFjdGl2YXRpb24pXG4gIHByaXZhdGUgZ2VuZXJhdGVTbWFydFdhcm11cFF1ZXN0aW9ucyh0b3BpY3M6IHN0cmluZ1tdLCBzdHVkZW50TGV2ZWw6IHN0cmluZywgY29udGVudEFuYWx5c2lzOiBhbnkpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgdG9waWMgPSB0b3BpY3NbMF0gfHwgJ3RoaXMgdG9waWMnXG4gICAgY29uc3Qgc2Vjb25kVG9waWMgPSB0b3BpY3NbMV0gfHwgJ3RlY2hub2xvZ3knXG5cbiAgICAvLyBGb2N1cyBvbiBhY3RpdmF0aW5nIHByaW9yIGtub3dsZWRnZSwgbm90IGFzc3VtaW5nIGNvbnRlbnQga25vd2xlZGdlXG4gICAgY29uc3QgbGV2ZWxRdWVzdGlvbnMgPSB7XG4gICAgICAnQTEnOiBbXG4gICAgICAgIGBEbyB5b3Uga25vdyBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBJcyAke3RvcGljLnRvTG93ZXJDYXNlKCl9IHBvcHVsYXIgaW4geW91ciBjb3VudHJ5P2AsXG4gICAgICAgIGBEbyB5b3UgbGlrZSAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2BcbiAgICAgIF0sXG4gICAgICAnQTInOiBbXG4gICAgICAgIGBIYXZlIHlvdSBoZWFyZCBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGJlZm9yZT9gLFxuICAgICAgICBgV2hhdCBkbyB5b3UgYWxyZWFkeSBrbm93IGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYElzICR7dG9waWMudG9Mb3dlckNhc2UoKX0gY29tbW9uIGluIHlvdXIgY291bnRyeT9gXG4gICAgICBdLFxuICAgICAgJ0IxJzogW1xuICAgICAgICBgV2hhdCBjb21lcyB0byBtaW5kIHdoZW4geW91IGhlYXIgYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSGF2ZSB5b3UgaGFkIGFueSBleHBlcmllbmNlIHdpdGggJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBrbm93IGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YFxuICAgICAgXSxcbiAgICAgICdCMic6IFtcbiAgICAgICAgYFdoYXQgaXMgeW91ciBnZW5lcmFsIG9waW5pb24gYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IGZhbWlsaWFyIGFyZSB5b3Ugd2l0aCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBXaGF0IHJvbGUgZG9lcyAke3RvcGljLnRvTG93ZXJDYXNlKCl9IHBsYXkgaW4geW91ciBkYWlseSBsaWZlP2BcbiAgICAgIF0sXG4gICAgICAnQzEnOiBbXG4gICAgICAgIGBIb3cgd291bGQgeW91IGRlc2NyaWJlIHRoZSBzaWduaWZpY2FuY2Ugb2YgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBpbiBtb2Rlcm4gc29jaWV0eT9gLFxuICAgICAgICBgV2hhdCBhcmUgeW91ciB0aG91Z2h0cyBvbiB0aGUgY3VycmVudCBzdGF0ZSBvZiAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBIb3cgZG8geW91IHRoaW5rICR7dG9waWMudG9Mb3dlckNhc2UoKX0gaGFzIGV2b2x2ZWQgb3ZlciB0aW1lP2BcbiAgICAgIF1cbiAgICB9XG5cbiAgICByZXR1cm4gbGV2ZWxRdWVzdGlvbnNbc3R1ZGVudExldmVsXSB8fCBsZXZlbFF1ZXN0aW9uc1snQjEnXVxuICB9XG5cbiAgLy8gRW5oYW5jZWQgc21hcnQgdm9jYWJ1bGFyeSB3aXRoIEFJLWdlbmVyYXRlZCBjb250ZXh0dWFsIGV4YW1wbGVzXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVTbWFydFZvY2FidWxhcnkodm9jYWJ1bGFyeTogc3RyaW5nW10sIHNvdXJjZVRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpIHtcbiAgICBjb25zdCBzZWxlY3RlZFdvcmRzID0gdm9jYWJ1bGFyeS5zbGljZSgwLCA4KSAvLyBTdGFydCB3aXRoIDggd29yZHNcbiAgICBjb25zdCB2b2NhYlByb21pc2VzID0gc2VsZWN0ZWRXb3Jkcy5tYXAoYXN5bmMgKHdvcmQpID0+IHtcbiAgICAgIGNvbnN0IGNhcGl0YWxpemVkV29yZCA9IHRoaXMuY2FwaXRhbGl6ZVdvcmQod29yZClcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgd29yZDogY2FwaXRhbGl6ZWRXb3JkLFxuICAgICAgICBtZWFuaW5nOiB0aGlzLmdlbmVyYXRlQ29udGV4dHVhbFdvcmRNZWFuaW5nKHdvcmQsIHN0dWRlbnRMZXZlbCwgc291cmNlVGV4dCksXG4gICAgICAgIGV4YW1wbGU6IGF3YWl0IHRoaXMuZ2VuZXJhdGVBSUV4YW1wbGVTZW50ZW5jZXMod29yZCwgc3R1ZGVudExldmVsLCBzb3VyY2VUZXh0KVxuICAgICAgfVxuICAgIH0pXG5cbiAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwodm9jYWJQcm9taXNlcylcbiAgICAvLyBFbnN1cmUgd2UgaGF2ZSA2LTEwIHdvcmRzXG4gICAgcmV0dXJuIHJlc3VsdHMuc2xpY2UoMCwgMTApLmxlbmd0aCA+PSA2ID8gcmVzdWx0cy5zbGljZSgwLCAxMCkgOiByZXN1bHRzLnNsaWNlKDAsIDYpXG4gIH1cblxuICAvLyBDYXBpdGFsaXplIHdvcmQgcHJvcGVybHlcbiAgcHJpdmF0ZSBjYXBpdGFsaXplV29yZCh3b3JkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiB3b3JkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgd29yZC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpXG4gIH1cblxuICAvLyBHZW5lcmF0ZSBjb250ZXh0dWFsIHdvcmQgbWVhbmluZ3MgYmFzZWQgb24gbGV2ZWwgYW5kIHNvdXJjZSB0ZXh0XG4gIHByaXZhdGUgZ2VuZXJhdGVDb250ZXh0dWFsV29yZE1lYW5pbmcod29yZDogc3RyaW5nLCBsZXZlbDogc3RyaW5nLCBzb3VyY2VUZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGxvd2VyV29yZCA9IHdvcmQudG9Mb3dlckNhc2UoKVxuXG4gICAgLy8gRW5oYW5jZWQgY29udGV4dHVhbCBkZWZpbml0aW9ucyBiYXNlZCBvbiBsZXZlbFxuICAgIGNvbnN0IGNvbnRleHR1YWxNZWFuaW5ncyA9IHtcbiAgICAgICdlZmZpY2llbnQnOiB7XG4gICAgICAgICdBMSc6ICd3b3JraW5nIHdlbGwgd2l0aG91dCB3YXN0aW5nIHRpbWUnLFxuICAgICAgICAnQTInOiAnZG9pbmcgc29tZXRoaW5nIHdlbGwgYW5kIHF1aWNrbHkgd2l0aG91dCB3YXN0aW5nIHRpbWUgb3IgZW5lcmd5JyxcbiAgICAgICAgJ0IxJzogJ3dvcmtpbmcgaW4gYSB3YXkgdGhhdCBhY2hpZXZlcyB0aGUgYmVzdCByZXN1bHRzIHdpdGggdGhlIGxlYXN0IHdhc3RlIG9mIHRpbWUgYW5kIGVmZm9ydCcsXG4gICAgICAgICdCMic6ICdhY2hpZXZpbmcgbWF4aW11bSBwcm9kdWN0aXZpdHkgd2l0aCBtaW5pbXVtIHdhc3RlZCBlZmZvcnQgb3IgZXhwZW5zZScsXG4gICAgICAgICdDMSc6ICdhY2hpZXZpbmcgbWF4aW11bSBwcm9kdWN0aXZpdHkgd2l0aCBtaW5pbXVtIHdhc3RlZCBlZmZvcnQsIGV4cGVuc2UsIG9yIHVubmVjZXNzYXJ5IGFjdGl2aXR5J1xuICAgICAgfSxcbiAgICAgICd0ZWNobm9sb2d5Jzoge1xuICAgICAgICAnQTEnOiAnY29tcHV0ZXJzIGFuZCBtYWNoaW5lcyB0aGF0IGhlbHAgdXMnLFxuICAgICAgICAnQTInOiAnbWFjaGluZXMgYW5kIGNvbXB1dGVyIHN5c3RlbXMgdGhhdCBtYWtlIGxpZmUgZWFzaWVyJyxcbiAgICAgICAgJ0IxJzogJ3RoZSB1c2Ugb2Ygc2NpZW50aWZpYyBrbm93bGVkZ2UgdG8gY3JlYXRlIHVzZWZ1bCB0b29scyBhbmQgbWFjaGluZXMnLFxuICAgICAgICAnQjInOiAndGhlIGFwcGxpY2F0aW9uIG9mIHNjaWVudGlmaWMga25vd2xlZGdlIGZvciBwcmFjdGljYWwgcHVycG9zZXMgaW4gaW5kdXN0cnkgYW5kIGRhaWx5IGxpZmUnLFxuICAgICAgICAnQzEnOiAndGhlIHN5c3RlbWF0aWMgYXBwbGljYXRpb24gb2Ygc2NpZW50aWZpYyBrbm93bGVkZ2UgdG8gZGV2ZWxvcCBwcmFjdGljYWwgc29sdXRpb25zIGFuZCBpbm5vdmF0aW9ucydcbiAgICAgIH0sXG4gICAgICAnZXVyb3BlJzoge1xuICAgICAgICAnQTEnOiAnYSBiaWcgYXJlYSB3aXRoIG1hbnkgY291bnRyaWVzJyxcbiAgICAgICAgJ0EyJzogJ2EgY29udGluZW50IHdpdGggbWFueSBkaWZmZXJlbnQgY291bnRyaWVzIGxpa2UgRnJhbmNlLCBHZXJtYW55LCBhbmQgSXRhbHknLFxuICAgICAgICAnQjEnOiAnYSBjb250aW5lbnQgY29uc2lzdGluZyBvZiBtYW55IGNvdW50cmllcywga25vd24gZm9yIGl0cyBoaXN0b3J5IGFuZCBjdWx0dXJlJyxcbiAgICAgICAgJ0IyJzogJ2EgY29udGluZW50IGNvbXByaXNpbmcgbnVtZXJvdXMgbmF0aW9ucyB3aXRoIGRpdmVyc2UgY3VsdHVyZXMsIGxhbmd1YWdlcywgYW5kIHBvbGl0aWNhbCBzeXN0ZW1zJyxcbiAgICAgICAgJ0MxJzogJ2EgZ2VvcG9saXRpY2FsIGFuZCBjdWx0dXJhbCBjb250aW5lbnQgY2hhcmFjdGVyaXplZCBieSBkaXZlcnNlIG5hdGlvbi1zdGF0ZXMsIHNoYXJlZCBoaXN0b3JpY2FsIGhlcml0YWdlLCBhbmQgZWNvbm9taWMgaW50ZWdyYXRpb24nXG4gICAgICB9LFxuICAgICAgJ3NlbnNhdGlvbmFsJzoge1xuICAgICAgICAnQTEnOiAndmVyeSBleGNpdGluZyBhbmQgZ29vZCcsXG4gICAgICAgICdBMic6ICdleHRyZW1lbHkgZXhjaXRpbmcgb3IgaW1wcmVzc2l2ZSwgY2F1c2luZyBzdHJvbmcgZmVlbGluZ3MnLFxuICAgICAgICAnQjEnOiAnY2F1c2luZyBncmVhdCBleGNpdGVtZW50LCBpbnRlcmVzdCwgb3Igc2hvY2s7IGV4dHJlbWVseSBpbXByZXNzaXZlJyxcbiAgICAgICAgJ0IyJzogJ2NhdXNpbmcgaW50ZW5zZSBleGNpdGVtZW50LCBpbnRlcmVzdCwgb3Igc2hvY2s7IGV4dHJhb3JkaW5hcmlseSBpbXByZXNzaXZlIG9yIHJlbWFya2FibGUnLFxuICAgICAgICAnQzEnOiAnY2F1c2luZyBvciBkZXNpZ25lZCB0byBjYXVzZSBpbnRlbnNlIGV4Y2l0ZW1lbnQsIGludGVyZXN0LCBvciBzaG9jayB0aHJvdWdoIGRyYW1hdGljIG9yIGV4dHJhb3JkaW5hcnkgcXVhbGl0aWVzJ1xuICAgICAgfSxcbiAgICAgICdzdGFnZXMnOiB7XG4gICAgICAgICdBMSc6ICdkb2VzIG9yIG1ha2VzIHNvbWV0aGluZyBoYXBwZW4nLFxuICAgICAgICAnQTInOiAnb3JnYW5pemVzIGFuZCBwcmVzZW50cyBhbiBldmVudCBvciBwZXJmb3JtYW5jZScsXG4gICAgICAgICdCMSc6ICdvcmdhbml6ZXMgYW5kIHByZXNlbnRzIGFuIGV2ZW50LCBvciByZWZlcnMgdG8gZGlmZmVyZW50IHBhcnRzIG9mIGEgcHJvY2VzcycsXG4gICAgICAgICdCMic6ICdvcmdhbml6ZXMgYW5kIHByZXNlbnRzIGFuIGV2ZW50IG9yIHBlcmZvcm1hbmNlLCBvciByZXByZXNlbnRzIGRpc3RpbmN0IHBoYXNlcyBpbiBhIHByb2Nlc3MnLFxuICAgICAgICAnQzEnOiAnb3JjaGVzdHJhdGVzIGFuZCBwcmVzZW50cyBhbiBldmVudCBvciBwZXJmb3JtYW5jZSwgb3IgZGVub3RlcyBzZXF1ZW50aWFsIHBoYXNlcyBpbiBhIGNvbXBsZXggcHJvY2VzcydcbiAgICAgIH0sXG4gICAgICAnY29tZWJhY2snOiB7XG4gICAgICAgICdBMSc6ICd3aW5uaW5nIGFmdGVyIGxvc2luZycsXG4gICAgICAgICdBMic6ICdyZXR1cm5pbmcgdG8gd2luIGFmdGVyIGJlaW5nIGJlaGluZCBpbiBhIGdhbWUgb3IgY29tcGV0aXRpb24nLFxuICAgICAgICAnQjEnOiAnYSByZXR1cm4gdG8gYSB3aW5uaW5nIHBvc2l0aW9uIGFmdGVyIGJlaW5nIGJlaGluZCwgb3IgYSByZXR1cm4gdG8gc3VjY2VzcycsXG4gICAgICAgICdCMic6ICdhIHJlY292ZXJ5IGZyb20gYSBkaXNhZHZhbnRhZ2VvdXMgcG9zaXRpb24gdG8gYWNoaWV2ZSBzdWNjZXNzIG9yIHZpY3RvcnknLFxuICAgICAgICAnQzEnOiAnYSBzdHJhdGVnaWMgcmVjb3ZlcnkgZnJvbSBhIGRpc2FkdmFudGFnZW91cyBwb3NpdGlvbiB0byBhY2hpZXZlIHN1Y2Nlc3MsIG9mdGVuIGFnYWluc3QgZXhwZWN0YXRpb25zJ1xuICAgICAgfSxcbiAgICAgICdkcmFtYXRpYyc6IHtcbiAgICAgICAgJ0ExJzogJ3ZlcnkgZXhjaXRpbmcgYW5kIHN1cnByaXNpbmcnLFxuICAgICAgICAnQTInOiAndmVyeSBleGNpdGluZywgd2l0aCBzdWRkZW4gY2hhbmdlcyB0aGF0IHN1cnByaXNlIHBlb3BsZScsXG4gICAgICAgICdCMSc6ICdpbnZvbHZpbmcgc3VkZGVuIGNoYW5nZXMgb3Igc3Ryb25nIGVtb3Rpb25zOyB2ZXJ5IG5vdGljZWFibGUgb3IgaW1wcmVzc2l2ZScsXG4gICAgICAgICdCMic6ICdjaGFyYWN0ZXJpemVkIGJ5IHN1ZGRlbiwgc3RyaWtpbmcgY2hhbmdlcyBvciBpbnRlbnNlIGVtb3Rpb25zOyBoaWdobHkgaW1wcmVzc2l2ZSBvciB0aGVhdHJpY2FsJyxcbiAgICAgICAgJ0MxJzogJ21hcmtlZCBieSBzdWRkZW4sIHN0cmlraW5nIGRldmVsb3BtZW50cyBvciBpbnRlbnNlIGVtb3Rpb25hbCBpbXBhY3Q7IHRoZWF0cmljYWxseSBpbXByZXNzaXZlIG9yIGVtb3Rpb25hbGx5IHBvd2VyZnVsJ1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGxldmVsTWVhbmluZ3MgPSBjb250ZXh0dWFsTWVhbmluZ3NbbG93ZXJXb3JkXVxuICAgIGlmIChsZXZlbE1lYW5pbmdzICYmIGxldmVsTWVhbmluZ3NbbGV2ZWxdKSB7XG4gICAgICByZXR1cm4gbGV2ZWxNZWFuaW5nc1tsZXZlbF1cbiAgICB9XG5cbiAgICAvLyBGYWxsYmFjayB0byBiYXNpYyBsZXZlbC1hcHByb3ByaWF0ZSBkZWZpbml0aW9uXG4gICAgY29uc3QgaXNTaW1wbGVMZXZlbCA9IGxldmVsID09PSAnQTEnIHx8IGxldmVsID09PSAnQTInXG4gICAgcmV0dXJuIGlzU2ltcGxlTGV2ZWwgP1xuICAgICAgYGEgd29yZCB0aGF0IG1lYW5zICR7bG93ZXJXb3JkfWAgOlxuICAgICAgYGEgdGVybSByZWZlcnJpbmcgdG8gJHtsb3dlcldvcmR9IGluIHRoaXMgY29udGV4dGBcbiAgfVxuXG4gIC8vIEdlbmVyYXRlIEFJLXBvd2VyZWQgY29udGV4dHVhbCBleGFtcGxlIHNlbnRlbmNlc1xuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlQUlFeGFtcGxlU2VudGVuY2VzKHdvcmQ6IHN0cmluZywgbGV2ZWw6IHN0cmluZywgc291cmNlVGV4dDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBleGFtcGxlQ291bnQgPSB0aGlzLmdldEV4YW1wbGVDb3VudChsZXZlbClcbiAgICBjb25zdCBjb250ZXh0ID0gc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgMTIwKSAvLyBNb3JlIGNvbnRleHQgZm9yIHJlbGV2YW5jZVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGxldmVsR3VpZGFuY2UgPSB0aGlzLmdldExldmVsR3VpZGFuY2UobGV2ZWwpXG4gICAgICBjb25zdCBwcm9tcHQgPSBgQ3JlYXRlICR7ZXhhbXBsZUNvdW50fSBjb250ZXh0dWFsICR7bGV2ZWx9IGxldmVsIHNlbnRlbmNlcyB1c2luZyBcIiR7d29yZH1cIiByZWxhdGVkIHRvOiAke2NvbnRleHR9LiBNYWtlIHNlbnRlbmNlcyBtZWFuaW5nZnVsIGFuZCByZWxldmFudCB0byB0aGUgdG9waWMuICR7bGV2ZWxHdWlkYW5jZX0gRm9ybWF0OiBvbmUgc2VudGVuY2UgcGVyIGxpbmUsIG5vIHF1b3RlczpgXG4gICAgICBjb25zb2xlLmxvZyhcIvCfk50gQ29udGV4dHVhbCBleGFtcGxlIHNlbnRlbmNlcyBwcm9tcHQ6XCIsIHByb21wdC5sZW5ndGgsIFwiY2hhcnNcIilcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcblxuICAgICAgLy8gUGFyc2UgYW5kIGNsZWFuIEFJIHJlc3BvbnNlXG4gICAgICBjb25zdCBzZW50ZW5jZXMgPSByZXNwb25zZS5zcGxpdCgnXFxuJylcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKVxuICAgICAgICAuZmlsdGVyKGxpbmUgPT4gbGluZS5sZW5ndGggPiA1ICYmIGxpbmUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh3b3JkLnRvTG93ZXJDYXNlKCkpKVxuICAgICAgICAubWFwKGxpbmUgPT4gdGhpcy5jbGVhblNlbnRlbmNlKGxpbmUpKVxuICAgICAgICAubWFwKGxpbmUgPT4gdGhpcy5ib2xkaWZ5VGFyZ2V0V29yZChsaW5lLCB3b3JkKSlcbiAgICAgICAgLmZpbHRlcihsaW5lID0+IGxpbmUubGVuZ3RoID4gMClcbiAgICAgICAgLnNsaWNlKDAsIGV4YW1wbGVDb3VudClcblxuICAgICAgLy8gSWYgQUkgZ2VuZXJhdGVkIGVub3VnaCBjb250ZXh0dWFsIHNlbnRlbmNlcywgdXNlIHRoZW1cbiAgICAgIGlmIChzZW50ZW5jZXMubGVuZ3RoID49IGV4YW1wbGVDb3VudCkge1xuICAgICAgICByZXR1cm4gc2VudGVuY2VzLmpvaW4oJyB8ICcpXG4gICAgICB9XG5cbiAgICAgIC8vIE90aGVyd2lzZSwgc3VwcGxlbWVudCB3aXRoIGNvbnRleHR1YWwgdGVtcGxhdGUgc2VudGVuY2VzXG4gICAgICBjb25zdCBhZGRpdGlvbmFsTmVlZGVkID0gZXhhbXBsZUNvdW50IC0gc2VudGVuY2VzLmxlbmd0aFxuICAgICAgY29uc3QgdGVtcGxhdGVTZW50ZW5jZXMgPSB0aGlzLmdlbmVyYXRlQ29udGV4dHVhbEV4YW1wbGVzKHdvcmQsIGxldmVsLCBzb3VyY2VUZXh0LCBhZGRpdGlvbmFsTmVlZGVkKVxuXG4gICAgICByZXR1cm4gWy4uLnNlbnRlbmNlcywgLi4udGVtcGxhdGVTZW50ZW5jZXNdLnNsaWNlKDAsIGV4YW1wbGVDb3VudCkuam9pbignIHwgJylcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhg4pqg77iPIEFJIGV4YW1wbGUgZ2VuZXJhdGlvbiBmYWlsZWQgZm9yICR7d29yZH0sIHVzaW5nIGNvbnRleHR1YWwgdGVtcGxhdGVzYClcbiAgICAgIC8vIEZhbGxiYWNrIHRvIGNvbnRleHR1YWwgdGVtcGxhdGUgZXhhbXBsZXNcbiAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRlQ29udGV4dHVhbEV4YW1wbGVzKHdvcmQsIGxldmVsLCBzb3VyY2VUZXh0LCBleGFtcGxlQ291bnQpLmpvaW4oJyB8ICcpXG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IGxldmVsLXNwZWNpZmljIGd1aWRhbmNlIGZvciBBSSBwcm9tcHRzXG4gIHByaXZhdGUgZ2V0TGV2ZWxHdWlkYW5jZShsZXZlbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBndWlkYW5jZSA9IHtcbiAgICAgICdBMSc6ICdVc2UgdmVyeSBzaW1wbGUgd29yZHMsIHNob3J0IHNlbnRlbmNlcyAoNS04IHdvcmRzKSwgcHJlc2VudCB0ZW5zZS4nLFxuICAgICAgJ0EyJzogJ1VzZSBzaW1wbGUgd29yZHMsIHNob3J0IHNlbnRlbmNlcyAoNi0xMCB3b3JkcyksIGJhc2ljIGdyYW1tYXIuJyxcbiAgICAgICdCMSc6ICdVc2UgY29tbW9uIHdvcmRzLCBtZWRpdW0gc2VudGVuY2VzICg4LTEyIHdvcmRzKSwgY2xlYXIgbWVhbmluZy4nLFxuICAgICAgJ0IyJzogJ1VzZSB2YXJpZWQgdm9jYWJ1bGFyeSwgbG9uZ2VyIHNlbnRlbmNlcyAoMTAtMTUgd29yZHMpLCBjb21wbGV4IGlkZWFzLicsXG4gICAgICAnQzEnOiAnVXNlIHNvcGhpc3RpY2F0ZWQgdm9jYWJ1bGFyeSwgY29tcGxleCBzZW50ZW5jZXMgKDEyKyB3b3JkcyksIG51YW5jZWQgbWVhbmluZy4nXG4gICAgfVxuICAgIHJldHVybiBndWlkYW5jZVtsZXZlbF0gfHwgZ3VpZGFuY2VbJ0IxJ11cbiAgfVxuXG4gIC8vIENsZWFuIHNlbnRlbmNlIGZvcm1hdHRpbmdcbiAgcHJpdmF0ZSBjbGVhblNlbnRlbmNlKHNlbnRlbmNlOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBzZW50ZW5jZVxuICAgICAgLnJlcGxhY2UoL15cXGQrXFwuP1xccyovLCAnJykgLy8gUmVtb3ZlIG51bWJlcmluZ1xuICAgICAgLnJlcGxhY2UoL14tXFxzKi8sICcnKSAvLyBSZW1vdmUgZGFzaGVzXG4gICAgICAucmVwbGFjZSgvXlxcKlxccyovLCAnJykgLy8gUmVtb3ZlIGFzdGVyaXNrc1xuICAgICAgLnJlcGxhY2UoL17igKJcXHMqLywgJycpIC8vIFJlbW92ZSBidWxsZXQgcG9pbnRzXG4gICAgICAudHJpbSgpXG4gIH1cblxuICAvLyBDbGVhbiBkZWZpbml0aW9uIGZvcm1hdHRpbmdcbiAgcHJpdmF0ZSBjbGVhbkRlZmluaXRpb24oZGVmaW5pdGlvbjogc3RyaW5nLCBsZXZlbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gZGVmaW5pdGlvblxuICAgICAgLnJlcGxhY2UoL15Gb3IgYW4/IFtBLVpdXFxkKyBzdHVkZW50LD9cXHMqL2ksICcnKSAvLyBSZW1vdmUgbGV2ZWwgcHJlZml4ZXNcbiAgICAgIC5yZXBsYWNlKC9eSW4gdGhpcyBjb250ZXh0LD9cXHMqL2ksICcnKSAvLyBSZW1vdmUgY29udGV4dCBwcmVmaXhlc1xuICAgICAgLnJlcGxhY2UoL15IZXJlJ3M/IChhICk/ZGVmaW5pdGlvbi4qPzpcXHMqL2ksICcnKSAvLyBSZW1vdmUgZGVmaW5pdGlvbiBpbnRyb3NcbiAgICAgIC5yZXBsYWNlKC9eXFwqXFwqKC4qPylcXCpcXCovZywgJyQxJykgLy8gUmVtb3ZlIGJvbGQgbWFya2Rvd25cbiAgICAgIC5yZXBsYWNlKC9cXCpcXCooLio/KVxcKlxcKi9nLCAnJDEnKSAvLyBSZW1vdmUgYm9sZCBtYXJrZG93blxuICAgICAgLnRyaW0oKVxuICB9XG5cbiAgLy8gTWFrZSB0YXJnZXQgd29yZCBib2xkIGluIHNlbnRlbmNlXG4gIHByaXZhdGUgYm9sZGlmeVRhcmdldFdvcmQoc2VudGVuY2U6IHN0cmluZywgdGFyZ2V0V29yZDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFxcXFxiJHt0YXJnZXRXb3JkfVxcXFxiYCwgJ2dpJylcbiAgICByZXR1cm4gc2VudGVuY2UucmVwbGFjZShyZWdleCwgYCoqJHt0YXJnZXRXb3JkfSoqYClcbiAgfVxuXG4gIC8vIEdlbmVyYXRlIGNvbnRleHR1YWwgZXhhbXBsZXMgYmFzZWQgb24gc291cmNlIG1hdGVyaWFsXG4gIHByaXZhdGUgZ2VuZXJhdGVDb250ZXh0dWFsRXhhbXBsZXMod29yZDogc3RyaW5nLCBsZXZlbDogc3RyaW5nLCBzb3VyY2VUZXh0OiBzdHJpbmcsIGNvdW50OiBudW1iZXIpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgbG93ZXJXb3JkID0gd29yZC50b0xvd2VyQ2FzZSgpXG4gICAgY29uc3QgY2FwaXRhbGl6ZWRXb3JkID0gdGhpcy5jYXBpdGFsaXplV29yZCh3b3JkKVxuXG4gICAgLy8gRXh0cmFjdCB0aGVtZXMgZnJvbSBzb3VyY2UgdGV4dCBmb3IgY29udGV4dFxuICAgIGNvbnN0IHRoZW1lcyA9IHRoaXMuZXh0cmFjdFRoZW1lc0Zyb21UZXh0KHNvdXJjZVRleHQpXG4gICAgY29uc3QgbWFpblRoZW1lID0gdGhlbWVzWzBdIHx8ICd0aGlzIHRvcGljJ1xuXG4gICAgY29uc3QgY29udGV4dHVhbEV4YW1wbGVzID0ge1xuICAgICAgJ0ExJzogW1xuICAgICAgICBgKioke2NhcGl0YWxpemVkV29yZH0qKiBpcyBpbiB0aGUgbmV3cyB0b2RheS5gLFxuICAgICAgICBgSSByZWFkIGFib3V0ICoqJHtsb3dlcldvcmR9Kiogb25saW5lLmAsXG4gICAgICAgIGAqKiR7Y2FwaXRhbGl6ZWRXb3JkfSoqIGlzIGltcG9ydGFudCBmb3IgJHttYWluVGhlbWV9LmAsXG4gICAgICAgIGBQZW9wbGUgdGFsayBhYm91dCAqKiR7bG93ZXJXb3JkfSoqLmAsXG4gICAgICAgIGAqKiR7Y2FwaXRhbGl6ZWRXb3JkfSoqIGhlbHBzIHdpdGggJHttYWluVGhlbWV9LmBcbiAgICAgIF0sXG4gICAgICAnQTInOiBbXG4gICAgICAgIGAqKiR7Y2FwaXRhbGl6ZWRXb3JkfSoqIHBsYXlzIGEgYmlnIHJvbGUgaW4gJHttYWluVGhlbWV9LmAsXG4gICAgICAgIGBNYW55IHBlb3BsZSBhcmUgaW50ZXJlc3RlZCBpbiAqKiR7bG93ZXJXb3JkfSoqLmAsXG4gICAgICAgIGAqKiR7Y2FwaXRhbGl6ZWRXb3JkfSoqIGFmZmVjdHMgaG93IHdlIHRoaW5rIGFib3V0ICR7bWFpblRoZW1lfS5gLFxuICAgICAgICBgVGhlIG5ld3Mgb2Z0ZW4gbWVudGlvbnMgKioke2xvd2VyV29yZH0qKi5gLFxuICAgICAgICBgKioke2NhcGl0YWxpemVkV29yZH0qKiBpcyBiZWNvbWluZyBtb3JlIGltcG9ydGFudCBpbiAke21haW5UaGVtZX0uYFxuICAgICAgXSxcbiAgICAgICdCMSc6IFtcbiAgICAgICAgYCoqJHtjYXBpdGFsaXplZFdvcmR9KiogaGFzIGNoYW5nZWQgdGhlIHdheSB3ZSBhcHByb2FjaCAke21haW5UaGVtZX0uYCxcbiAgICAgICAgYFVuZGVyc3RhbmRpbmcgKioke2xvd2VyV29yZH0qKiBpcyBjcnVjaWFsIGZvciAke21haW5UaGVtZX0uYCxcbiAgICAgICAgYCoqJHtjYXBpdGFsaXplZFdvcmR9KiogY29udGludWVzIHRvIGluZmx1ZW5jZSAke21haW5UaGVtZX0uYCxcbiAgICAgICAgYFRoZSByb2xlIG9mICoqJHtsb3dlcldvcmR9KiogaW4gJHttYWluVGhlbWV9IGlzIGdyb3dpbmcuYFxuICAgICAgXSxcbiAgICAgICdCMic6IFtcbiAgICAgICAgYCoqJHtjYXBpdGFsaXplZFdvcmR9KiogcmVwcmVzZW50cyBhIHNpZ25pZmljYW50IGRldmVsb3BtZW50IGluICR7bWFpblRoZW1lfS5gLFxuICAgICAgICBgVGhlIGltcGxpY2F0aW9ucyBvZiAqKiR7bG93ZXJXb3JkfSoqIGZvciAke21haW5UaGVtZX0gYXJlIGZhci1yZWFjaGluZy5gLFxuICAgICAgICBgKioke2NhcGl0YWxpemVkV29yZH0qKiBoYXMgdHJhbnNmb3JtZWQgb3VyIHVuZGVyc3RhbmRpbmcgb2YgJHttYWluVGhlbWV9LmBcbiAgICAgIF0sXG4gICAgICAnQzEnOiBbXG4gICAgICAgIGAqKiR7Y2FwaXRhbGl6ZWRXb3JkfSoqIGV4ZW1wbGlmaWVzIHRoZSBjb21wbGV4IGR5bmFtaWNzIHdpdGhpbiAke21haW5UaGVtZX0uYCxcbiAgICAgICAgYFRoZSBtdWx0aWZhY2V0ZWQgbmF0dXJlIG9mICoqJHtsb3dlcldvcmR9KiogcmVxdWlyZXMgbnVhbmNlZCBhbmFseXNpcyBpbiAke21haW5UaGVtZX0uYCxcbiAgICAgICAgYCoqJHtjYXBpdGFsaXplZFdvcmR9KiogcmVwcmVzZW50cyBhIHBhcmFkaWdtYXRpYyBzaGlmdCBpbiBjb250ZW1wb3JhcnkgJHttYWluVGhlbWV9LmBcbiAgICAgIF1cbiAgICB9XG5cbiAgICBjb25zdCBsZXZlbEV4YW1wbGVzID0gY29udGV4dHVhbEV4YW1wbGVzW2xldmVsXSB8fCBjb250ZXh0dWFsRXhhbXBsZXNbJ0IxJ11cbiAgICByZXR1cm4gbGV2ZWxFeGFtcGxlcy5zbGljZSgwLCBjb3VudClcbiAgfVxuXG4gIC8vIEV4dHJhY3QgdGhlbWVzIGZyb20gc291cmNlIHRleHQgZm9yIGNvbnRleHR1YWwgZXhhbXBsZXNcbiAgcHJpdmF0ZSBleHRyYWN0VGhlbWVzRnJvbVRleHQodGV4dDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHRoZW1lcyA9IFtdXG5cbiAgICAvLyBDb21tb24gdGhlbWVzIGJhc2VkIG9uIGtleXdvcmRzXG4gICAgY29uc3QgdGhlbWVLZXl3b3JkcyA9IHtcbiAgICAgICdzcG9ydHMnOiBbJ3RlYW0nLCAnZ2FtZScsICd3aW4nLCAncGxheScsICdtYXRjaCcsICdjb21wZXRpdGlvbicsICd0b3VybmFtZW50JywgJ2N1cCddLFxuICAgICAgJ3RlY2hub2xvZ3knOiBbJ0FJJywgJ2NvbXB1dGVyJywgJ2RpZ2l0YWwnLCAnc29mdHdhcmUnLCAnc3lzdGVtJywgJ2RldmljZScsICdhcnRpZmljaWFsJywgJ2ludGVsbGlnZW5jZSddLFxuICAgICAgJ2Vudmlyb25tZW50JzogWydjbGltYXRlJywgJ25hdHVyZScsICdlYXJ0aCcsICdncmVlbicsICdwb2xsdXRpb24nLCAnZW5lcmd5JywgJ2NoYW5nZSddLFxuICAgICAgJ2hlYWx0aCc6IFsnbWVkaWNhbCcsICdkb2N0b3InLCAndHJlYXRtZW50JywgJ3BhdGllbnQnLCAnbWVkaWNpbmUnLCAnY2FyZScsICdoZWFsdGhjYXJlJ10sXG4gICAgICAnYnVzaW5lc3MnOiBbJ2NvbXBhbnknLCAnbWFya2V0JywgJ2Vjb25vbXknLCAnZmluYW5jZScsICdpbmR1c3RyeScsICd0cmFkZSddLFxuICAgICAgJ2VkdWNhdGlvbic6IFsnc3R1ZGVudCcsICdsZWFybicsICdzY2hvb2wnLCAna25vd2xlZGdlJywgJ3N0dWR5JywgJ3RlYWNoJ11cbiAgICB9XG5cbiAgICBjb25zdCBsb3dlclRleHQgPSB0ZXh0LnRvTG93ZXJDYXNlKClcblxuICAgIGZvciAoY29uc3QgW3RoZW1lLCBrZXl3b3Jkc10gb2YgT2JqZWN0LmVudHJpZXModGhlbWVLZXl3b3JkcykpIHtcbiAgICAgIGNvbnN0IG1hdGNoQ291bnQgPSBrZXl3b3Jkcy5maWx0ZXIoa2V5d29yZCA9PiBsb3dlclRleHQuaW5jbHVkZXMoa2V5d29yZCkpLmxlbmd0aFxuICAgICAgaWYgKG1hdGNoQ291bnQgPj0gMikge1xuICAgICAgICB0aGVtZXMucHVzaCh0aGVtZSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhlbWVzLmxlbmd0aCA+IDAgPyB0aGVtZXMgOiBbJ3RoaXMgdG9waWMnXVxuICB9XG5cbiAgLy8gR2VuZXJhdGUgdHJ1bHkgbGV2ZWwtYXBwcm9wcmlhdGUgZXhhbXBsZSBzZW50ZW5jZXNcbiAgcHJpdmF0ZSBnZW5lcmF0ZUxldmVsQXBwcm9wcmlhdGVFeGFtcGxlcyh3b3JkOiBzdHJpbmcsIGxldmVsOiBzdHJpbmcsIGNvdW50OiBudW1iZXIpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgbG93ZXJXb3JkID0gd29yZC50b0xvd2VyQ2FzZSgpXG4gICAgY29uc3QgY2FwaXRhbGl6ZWRXb3JkID0gdGhpcy5jYXBpdGFsaXplV29yZCh3b3JkKVxuXG4gICAgY29uc3QgZXhhbXBsZXMgPSB7XG4gICAgICAnQTEnOiBbXG4gICAgICAgIGAke2NhcGl0YWxpemVkV29yZH0gaXMgZ29vZC5gLFxuICAgICAgICBgSSBsaWtlICR7bG93ZXJXb3JkfS5gLFxuICAgICAgICBgVGhpcyBpcyAke2xvd2VyV29yZH0uYCxcbiAgICAgICAgYCR7Y2FwaXRhbGl6ZWRXb3JkfSBoZWxwcyB1cy5gLFxuICAgICAgICBgV2Ugc2VlICR7bG93ZXJXb3JkfS5gXG4gICAgICBdLFxuICAgICAgJ0EyJzogW1xuICAgICAgICBgJHtjYXBpdGFsaXplZFdvcmR9IGlzIHZlcnkgaW1wb3J0YW50LmAsXG4gICAgICAgIGBJIHRoaW5rICR7bG93ZXJXb3JkfSBpcyBpbnRlcmVzdGluZy5gLFxuICAgICAgICBgTWFueSBwZW9wbGUga25vdyBhYm91dCAke2xvd2VyV29yZH0uYCxcbiAgICAgICAgYCR7Y2FwaXRhbGl6ZWRXb3JkfSBpcyB1c2VmdWwgZm9yIHVzLmAsXG4gICAgICAgIGBXZSBjYW4gbGVhcm4gYWJvdXQgJHtsb3dlcldvcmR9LmBcbiAgICAgIF0sXG4gICAgICAnQjEnOiBbXG4gICAgICAgIGAke2NhcGl0YWxpemVkV29yZH0gcGxheXMgYW4gaW1wb3J0YW50IHJvbGUgdG9kYXkuYCxcbiAgICAgICAgYFBlb3BsZSBhcmUgaW50ZXJlc3RlZCBpbiAke2xvd2VyV29yZH0uYCxcbiAgICAgICAgYCR7Y2FwaXRhbGl6ZWRXb3JkfSBhZmZlY3RzIG91ciBkYWlseSBsaXZlcy5gLFxuICAgICAgICBgV2Ugc2hvdWxkIHVuZGVyc3RhbmQgJHtsb3dlcldvcmR9IGJldHRlci5gXG4gICAgICBdLFxuICAgICAgJ0IyJzogW1xuICAgICAgICBgJHtjYXBpdGFsaXplZFdvcmR9IGhhcyBzaWduaWZpY2FudCBpbXBsaWNhdGlvbnMgZm9yIHNvY2lldHkuYCxcbiAgICAgICAgYFRoZSBpbXBhY3Qgb2YgJHtsb3dlcldvcmR9IGNvbnRpbnVlcyB0byBncm93LmAsXG4gICAgICAgIGBVbmRlcnN0YW5kaW5nICR7bG93ZXJXb3JkfSByZXF1aXJlcyBjYXJlZnVsIGNvbnNpZGVyYXRpb24uYFxuICAgICAgXSxcbiAgICAgICdDMSc6IFtcbiAgICAgICAgYCR7Y2FwaXRhbGl6ZWRXb3JkfSBleGVtcGxpZmllcyBjb250ZW1wb3JhcnkgY2hhbGxlbmdlcy5gLFxuICAgICAgICBgVGhlIGNvbXBsZXhpdHkgb2YgJHtsb3dlcldvcmR9IGRlbWFuZHMgc29waGlzdGljYXRlZCBhbmFseXNpcy5gLFxuICAgICAgICBgJHtjYXBpdGFsaXplZFdvcmR9IHJlcHJlc2VudHMgYSBwYXJhZGlnbSBzaGlmdCBpbiB0aGlua2luZy5gXG4gICAgICBdXG4gICAgfVxuXG4gICAgY29uc3QgbGV2ZWxFeGFtcGxlcyA9IGV4YW1wbGVzW2xldmVsXSB8fCBleGFtcGxlc1snQjEnXVxuICAgIHJldHVybiBsZXZlbEV4YW1wbGVzLnNsaWNlKDAsIGNvdW50KVxuICB9XG5cbiAgLy8gRmFsbGJhY2sgdGVtcGxhdGUtYmFzZWQgZXhhbXBsZSBnZW5lcmF0aW9uXG4gIHByaXZhdGUgZ2VuZXJhdGVUZW1wbGF0ZUV4YW1wbGVzKHdvcmQ6IHN0cmluZywgbGV2ZWw6IHN0cmluZywgc291cmNlVGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBleGFtcGxlQ291bnQgPSB0aGlzLmdldEV4YW1wbGVDb3VudChsZXZlbClcblxuICAgIC8vIFRyeSB0byBmaW5kIHRoZSB3b3JkIGluIHRoZSBzb3VyY2UgdGV4dCBmaXJzdFxuICAgIGNvbnN0IHNlbnRlbmNlcyA9IHNvdXJjZVRleHQuc3BsaXQoL1suIT9dKy8pLmZpbHRlcihzID0+IHMudHJpbSgpLmxlbmd0aCA+IDEwKVxuICAgIGNvbnN0IGNvbnRleHRTZW50ZW5jZSA9IHNlbnRlbmNlcy5maW5kKHMgPT4gcy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHdvcmQudG9Mb3dlckNhc2UoKSkpXG5cbiAgICBjb25zdCBleGFtcGxlcyA9IFtdXG5cbiAgICAvLyBBZGQgY29udGV4dCBzZW50ZW5jZSBpZiBmb3VuZFxuICAgIGlmIChjb250ZXh0U2VudGVuY2UpIHtcbiAgICAgIGV4YW1wbGVzLnB1c2goY29udGV4dFNlbnRlbmNlLnRyaW0oKSlcbiAgICB9XG5cbiAgICAvLyBHZW5lcmF0ZSBhZGRpdGlvbmFsIGxldmVsLWFwcHJvcHJpYXRlIGV4YW1wbGVzXG4gICAgY29uc3QgYWRkaXRpb25hbEV4YW1wbGVzID0gdGhpcy5nZW5lcmF0ZUFkZGl0aW9uYWxFeGFtcGxlcyh3b3JkLCBsZXZlbCwgZXhhbXBsZUNvdW50IC0gZXhhbXBsZXMubGVuZ3RoKVxuICAgIGV4YW1wbGVzLnB1c2goLi4uYWRkaXRpb25hbEV4YW1wbGVzKVxuXG4gICAgLy8gRW5zdXJlIHdlIGhhdmUgdGhlIHJpZ2h0IG51bWJlciBvZiBleGFtcGxlc1xuICAgIHJldHVybiBleGFtcGxlcy5zbGljZSgwLCBleGFtcGxlQ291bnQpLmpvaW4oJyB8ICcpXG4gIH1cblxuICAvLyBHZXQgbnVtYmVyIG9mIGV4YW1wbGVzIGJhc2VkIG9uIENFRlIgbGV2ZWxcbiAgcHJpdmF0ZSBnZXRFeGFtcGxlQ291bnQobGV2ZWw6IHN0cmluZyk6IG51bWJlciB7XG4gICAgc3dpdGNoIChsZXZlbCkge1xuICAgICAgY2FzZSAnQTEnOlxuICAgICAgY2FzZSAnQTInOlxuICAgICAgICByZXR1cm4gNVxuICAgICAgY2FzZSAnQjEnOlxuICAgICAgICByZXR1cm4gNFxuICAgICAgY2FzZSAnQjInOlxuICAgICAgY2FzZSAnQzEnOlxuICAgICAgICByZXR1cm4gM1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIDRcbiAgICB9XG4gIH1cblxuICAvLyBHZW5lcmF0ZSBhZGRpdGlvbmFsIGxldmVsLWFwcHJvcHJpYXRlIGV4YW1wbGUgc2VudGVuY2VzXG4gIHByaXZhdGUgZ2VuZXJhdGVBZGRpdGlvbmFsRXhhbXBsZXMod29yZDogc3RyaW5nLCBsZXZlbDogc3RyaW5nLCBjb3VudDogbnVtYmVyKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGxvd2VyV29yZCA9IHdvcmQudG9Mb3dlckNhc2UoKVxuICAgIGNvbnN0IGNhcGl0YWxpemVkV29yZCA9IHRoaXMuY2FwaXRhbGl6ZVdvcmQod29yZClcblxuICAgIGNvbnN0IGV4YW1wbGVUZW1wbGF0ZXMgPSB7XG4gICAgICAnQTEnOiBbXG4gICAgICAgIGAke2NhcGl0YWxpemVkV29yZH0gaXMgaW1wb3J0YW50LmAsXG4gICAgICAgIGBJIGxpa2UgJHtsb3dlcldvcmR9LmAsXG4gICAgICAgIGBUaGlzIGlzICR7bG93ZXJXb3JkfS5gLFxuICAgICAgICBgJHtjYXBpdGFsaXplZFdvcmR9IGlzIGdvb2QuYCxcbiAgICAgICAgYFdlIHVzZSAke2xvd2VyV29yZH0uYFxuICAgICAgXSxcbiAgICAgICdBMic6IFtcbiAgICAgICAgYCR7Y2FwaXRhbGl6ZWRXb3JkfSBpcyB2ZXJ5IGltcG9ydGFudCBpbiBvdXIgZGFpbHkgbGlmZS5gLFxuICAgICAgICBgSSB0aGluayAke2xvd2VyV29yZH0gaXMgaW50ZXJlc3RpbmcuYCxcbiAgICAgICAgYE1hbnkgcGVvcGxlIHVzZSAke2xvd2VyV29yZH0gdG9kYXkuYCxcbiAgICAgICAgYCR7Y2FwaXRhbGl6ZWRXb3JkfSBoZWxwcyB1cyBhIGxvdC5gLFxuICAgICAgICBgV2UgY2FuIGxlYXJuIGFib3V0ICR7bG93ZXJXb3JkfS5gXG4gICAgICBdLFxuICAgICAgJ0IxJzogW1xuICAgICAgICBgJHtjYXBpdGFsaXplZFdvcmR9IHBsYXlzIGFuIGltcG9ydGFudCByb2xlIGluIG1vZGVybiBzb2NpZXR5LmAsXG4gICAgICAgIGBUaGUgY29uY2VwdCBvZiAke2xvd2VyV29yZH0gaGFzIGV2b2x2ZWQgc2lnbmlmaWNhbnRseS5gLFxuICAgICAgICBgVW5kZXJzdGFuZGluZyAke2xvd2VyV29yZH0gaXMgZXNzZW50aWFsIGZvciBzdHVkZW50cy5gLFxuICAgICAgICBgJHtjYXBpdGFsaXplZFdvcmR9IGNvbnRpbnVlcyB0byBpbmZsdWVuY2Ugb3VyIGRhaWx5IGxpdmVzLmBcbiAgICAgIF0sXG4gICAgICAnQjInOiBbXG4gICAgICAgIGAke2NhcGl0YWxpemVkV29yZH0gcmVwcmVzZW50cyBhIHNpZ25pZmljYW50IGRldmVsb3BtZW50IGluIHRoaXMgZmllbGQuYCxcbiAgICAgICAgYFRoZSBpbXBsaWNhdGlvbnMgb2YgJHtsb3dlcldvcmR9IGV4dGVuZCBiZXlvbmQgaW1tZWRpYXRlIGFwcGxpY2F0aW9ucy5gLFxuICAgICAgICBgRXhwZXJ0cyBjb25zaWRlciAke2xvd2VyV29yZH0gdG8gYmUgYSBjcnVjaWFsIGZhY3RvciBpbiBmdXR1cmUgcHJvZ3Jlc3MuYFxuICAgICAgXSxcbiAgICAgICdDMSc6IFtcbiAgICAgICAgYCR7Y2FwaXRhbGl6ZWRXb3JkfSBleGVtcGxpZmllcyB0aGUgY29tcGxleCBpbnRlcnBsYXkgYmV0d2VlbiBpbm5vdmF0aW9uIGFuZCBwcmFjdGljYWwgYXBwbGljYXRpb24uYCxcbiAgICAgICAgYFRoZSBtdWx0aWZhY2V0ZWQgbmF0dXJlIG9mICR7bG93ZXJXb3JkfSByZXF1aXJlcyBjb21wcmVoZW5zaXZlIGFuYWx5c2lzLmAsXG4gICAgICAgIGBDb250ZW1wb3JhcnkgZGlzY291cnNlIHN1cnJvdW5kaW5nICR7bG93ZXJXb3JkfSByZWZsZWN0cyBicm9hZGVyIHNvY2lldGFsIHRyYW5zZm9ybWF0aW9ucy5gXG4gICAgICBdXG4gICAgfVxuXG4gICAgY29uc3QgdGVtcGxhdGVzID0gZXhhbXBsZVRlbXBsYXRlc1tsZXZlbF0gfHwgZXhhbXBsZVRlbXBsYXRlc1snQjEnXVxuICAgIHJldHVybiB0ZW1wbGF0ZXMuc2xpY2UoMCwgY291bnQpXG4gIH1cblxuICAvLyBFbmhhbmNlZCByZWFkaW5nIHBhc3NhZ2UgYWRhcHRhdGlvbiB3aXRoIEFJIHJld3JpdGluZyBhbmQgdm9jYWJ1bGFyeSBib2xkaW5nXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVTbWFydFJlYWRpbmcoc291cmNlVGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZywgdm9jYWJ1bGFyeVdvcmRzOiBzdHJpbmdbXSA9IFtdKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBtYXhMZW5ndGggPSB7XG4gICAgICAnQTEnOiAxNTAsXG4gICAgICAnQTInOiAyNTAsXG4gICAgICAnQjEnOiAzNTAsXG4gICAgICAnQjInOiA0NTAsXG4gICAgICAnQzEnOiA1NTBcbiAgICB9XG5cbiAgICBjb25zdCB0YXJnZXRMZW5ndGggPSBtYXhMZW5ndGhbc3R1ZGVudExldmVsXSB8fCAzNTBcblxuICAgIHRyeSB7XG4gICAgICAvLyBVc2UgQUkgdG8gcmV3cml0ZSB0ZXh0IGZvciBhcHByb3ByaWF0ZSBsZXZlbFxuICAgICAgY29uc3QgcmV3cml0dGVuVGV4dCA9IGF3YWl0IHRoaXMucmV3cml0ZUZvckxldmVsKHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbCwgdGFyZ2V0TGVuZ3RoKVxuICAgICAgLy8gQm9sZCB2b2NhYnVsYXJ5IHdvcmRzIGluIHRoZSByZWFkaW5nIHBhc3NhZ2VcbiAgICAgIHJldHVybiB0aGlzLmJvbGRWb2NhYnVsYXJ5SW5UZXh0KHJld3JpdHRlblRleHQsIHZvY2FidWxhcnlXb3JkcylcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coYOKaoO+4jyBBSSByZXdyaXRpbmcgZmFpbGVkIGZvciByZWFkaW5nIHBhc3NhZ2UsIHVzaW5nIHRlbXBsYXRlIGFkYXB0YXRpb25gKVxuICAgICAgLy8gRmFsbGJhY2sgdG8gdGVtcGxhdGUtYmFzZWQgYWRhcHRhdGlvblxuICAgICAgY29uc3QgYWRhcHRlZFRleHQgPSB0aGlzLmFkYXB0UmVhZGluZ1RlbXBsYXRlKHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbCwgdGFyZ2V0TGVuZ3RoKVxuICAgICAgcmV0dXJuIHRoaXMuYm9sZFZvY2FidWxhcnlJblRleHQoYWRhcHRlZFRleHQsIHZvY2FidWxhcnlXb3JkcylcbiAgICB9XG4gIH1cblxuICAvLyBBSS1wb3dlcmVkIHRleHQgcmV3cml0aW5nIGZvciBDRUZSIGxldmVsc1xuICBwcml2YXRlIGFzeW5jIHJld3JpdGVGb3JMZXZlbChzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nLCB0YXJnZXRMZW5ndGg6IG51bWJlcik6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgbGV2ZWxHdWlkYW5jZSA9IHRoaXMuZ2V0UmVhZGluZ0xldmVsR3VpZGFuY2Uoc3R1ZGVudExldmVsKVxuICAgIGNvbnN0IHNob3J0VGV4dCA9IHNvdXJjZVRleHQuc3Vic3RyaW5nKDAsIHRhcmdldExlbmd0aCArIDEwMCkgLy8gR2l2ZSBBSSBtb3JlIGNvbnRleHQgdG8gd29yayB3aXRoXG4gICAgXG4gICAgY29uc3QgcHJvbXB0ID0gYFJld3JpdGUgdGhpcyB0ZXh0IGZvciAke3N0dWRlbnRMZXZlbH0gbGV2ZWwgc3R1ZGVudHMuICR7bGV2ZWxHdWlkYW5jZX0gS2VlcCB0aGUgbWFpbiBpZGVhcyBidXQgYWRhcHQgdGhlIGxhbmd1YWdlLiBUYXJnZXQgbGVuZ3RoOiAke3RhcmdldExlbmd0aH0gY2hhcmFjdGVycy4gVGV4dDogJHtzaG9ydFRleHR9YFxuICAgIFxuICAgIGNvbnNvbGUubG9nKFwi8J+TliBSZWFkaW5nIHJld3JpdGUgcHJvbXB0OlwiLCBwcm9tcHQubGVuZ3RoLCBcImNoYXJzXCIpXG4gICAgXG4gICAgY29uc3QgcmV3cml0dGVuVGV4dCA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQocHJvbXB0KVxuICAgIFxuICAgIC8vIENsZWFuIGFuZCBsaW1pdCB0aGUgcmV3cml0dGVuIHRleHRcbiAgICByZXR1cm4gcmV3cml0dGVuVGV4dC50cmltKCkuc3Vic3RyaW5nKDAsIHRhcmdldExlbmd0aClcbiAgfVxuXG4gIC8vIEdldCBsZXZlbC1zcGVjaWZpYyBndWlkYW5jZSBmb3IgcmVhZGluZyBhZGFwdGF0aW9uXG4gIHByaXZhdGUgZ2V0UmVhZGluZ0xldmVsR3VpZGFuY2UobGV2ZWw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgZ3VpZGFuY2UgPSB7XG4gICAgICAnQTEnOiAnVXNlIHZlcnkgc2ltcGxlIHdvcmRzLCBzaG9ydCBzZW50ZW5jZXMgKDUtOCB3b3JkcyksIHByZXNlbnQgdGVuc2Ugb25seSwgYmFzaWMgdm9jYWJ1bGFyeS4nLFxuICAgICAgJ0EyJzogJ1VzZSBzaW1wbGUgd29yZHMsIHNob3J0IHNlbnRlbmNlcyAoNi0xMCB3b3JkcyksIHNpbXBsZSBwYXN0IGFuZCBwcmVzZW50LCBjb21tb24gdm9jYWJ1bGFyeS4nLFxuICAgICAgJ0IxJzogJ1VzZSBjbGVhciBsYW5ndWFnZSwgbWVkaXVtIHNlbnRlbmNlcyAoOC0xMiB3b3JkcyksIHZhcmlvdXMgdGVuc2VzLCBpbnRlcm1lZGlhdGUgdm9jYWJ1bGFyeS4nLFxuICAgICAgJ0IyJzogJ1VzZSB2YXJpZWQgdm9jYWJ1bGFyeSwgbG9uZ2VyIHNlbnRlbmNlcyAoMTAtMTUgd29yZHMpLCBjb21wbGV4IGdyYW1tYXIsIGFkdmFuY2VkIGNvbmNlcHRzLicsXG4gICAgICAnQzEnOiAnVXNlIHNvcGhpc3RpY2F0ZWQgbGFuZ3VhZ2UsIGNvbXBsZXggc2VudGVuY2VzICgxMisgd29yZHMpLCBhZHZhbmNlZCBncmFtbWFyLCBudWFuY2VkIGlkZWFzLidcbiAgICB9XG4gICAgcmV0dXJuIGd1aWRhbmNlW2xldmVsXSB8fCBndWlkYW5jZVsnQjEnXVxuICB9XG5cbiAgLy8gVGVtcGxhdGUtYmFzZWQgcmVhZGluZyBhZGFwdGF0aW9uIChmYWxsYmFjaylcbiAgcHJpdmF0ZSBhZGFwdFJlYWRpbmdUZW1wbGF0ZShzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nLCB0YXJnZXRMZW5ndGg6IG51bWJlcik6IHN0cmluZyB7XG4gICAgY29uc3Qgc2VudGVuY2VzID0gc291cmNlVGV4dC5zcGxpdCgvWy4hP10rLykuZmlsdGVyKHMgPT4gcy50cmltKCkubGVuZ3RoID4gMTApXG4gICAgXG4gICAgaWYgKHN0dWRlbnRMZXZlbCA9PT0gJ0ExJyB8fCBzdHVkZW50TGV2ZWwgPT09ICdBMicpIHtcbiAgICAgIC8vIFNpbXBsaWZ5IGZvciBsb3dlciBsZXZlbHNcbiAgICAgIGNvbnN0IHNpbXBsaWZpZWRTZW50ZW5jZXMgPSBzZW50ZW5jZXNcbiAgICAgICAgLm1hcChzID0+IHRoaXMuc2ltcGxpZnlzZW50ZW5jZShzLnRyaW0oKSwgc3R1ZGVudExldmVsKSlcbiAgICAgICAgLmZpbHRlcihzID0+IHMubGVuZ3RoID4gMClcbiAgICAgICAgLnNsaWNlKDAsIDYpIC8vIExpbWl0IG51bWJlciBvZiBzZW50ZW5jZXMgZm9yIEExL0EyXG4gICAgICBcbiAgICAgIHJldHVybiBzaW1wbGlmaWVkU2VudGVuY2VzLmpvaW4oJy4gJykuc3Vic3RyaW5nKDAsIHRhcmdldExlbmd0aClcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRm9yIEIxKyBsZXZlbHMsIHVzZSBvcmlnaW5hbCB0ZXh0IHdpdGggbGVuZ3RoIGNvbnRyb2xcbiAgICAgIHJldHVybiBzZW50ZW5jZXMuam9pbignLiAnKS5zdWJzdHJpbmcoMCwgdGFyZ2V0TGVuZ3RoKVxuICAgIH1cbiAgfVxuXG4gIC8vIFNpbXBsaWZ5IGluZGl2aWR1YWwgc2VudGVuY2VzIGZvciBsb3dlciBsZXZlbHNcbiAgcHJpdmF0ZSBzaW1wbGlmeXNlbnRlbmNlKHNlbnRlbmNlOiBzdHJpbmcsIGxldmVsOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGlmIChsZXZlbCA9PT0gJ0ExJykge1xuICAgICAgLy8gVmVyeSBiYXNpYyBzaW1wbGlmaWNhdGlvbiBmb3IgQTFcbiAgICAgIHJldHVybiBzZW50ZW5jZVxuICAgICAgICAucmVwbGFjZSgvXFxiKGhvd2V2ZXJ8bmV2ZXJ0aGVsZXNzfGZ1cnRoZXJtb3JlfG1vcmVvdmVyKVxcYi9naSwgJ2J1dCcpXG4gICAgICAgIC5yZXBsYWNlKC9cXGIoYXBwcm94aW1hdGVseXxhcHByb3hpbWF0ZWx5KVxcYi9naSwgJ2Fib3V0JylcbiAgICAgICAgLnJlcGxhY2UoL1xcYihzaWduaWZpY2FudHxzdWJzdGFudGlhbClcXGIvZ2ksICdiaWcnKVxuICAgICAgICAucmVwbGFjZSgvXFxiKGRlbW9uc3RyYXRlfGlsbHVzdHJhdGUpXFxiL2dpLCAnc2hvdycpXG4gICAgfSBlbHNlIGlmIChsZXZlbCA9PT0gJ0EyJykge1xuICAgICAgLy8gTW9kZXJhdGUgc2ltcGxpZmljYXRpb24gZm9yIEEyXG4gICAgICByZXR1cm4gc2VudGVuY2VcbiAgICAgICAgLnJlcGxhY2UoL1xcYihuZXZlcnRoZWxlc3N8ZnVydGhlcm1vcmUpXFxiL2dpLCAnaG93ZXZlcicpXG4gICAgICAgIC5yZXBsYWNlKC9cXGIoYXBwcm94aW1hdGVseSlcXGIvZ2ksICdhYm91dCcpXG4gICAgICAgIC5yZXBsYWNlKC9cXGIoc3Vic3RhbnRpYWwpXFxiL2dpLCAnc2lnbmlmaWNhbnQnKVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gc2VudGVuY2VcbiAgfVxuXG4gIC8vIEJvbGQgdm9jYWJ1bGFyeSB3b3JkcyBpbiByZWFkaW5nIHBhc3NhZ2UgZm9yIHZpc3VhbCBsYW5kbWFya3NcbiAgcHJpdmF0ZSBib2xkVm9jYWJ1bGFyeUluVGV4dCh0ZXh0OiBzdHJpbmcsIHZvY2FidWxhcnlXb3Jkczogc3RyaW5nW10pOiBzdHJpbmcge1xuICAgIGlmICghdm9jYWJ1bGFyeVdvcmRzIHx8IHZvY2FidWxhcnlXb3Jkcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB0ZXh0XG4gICAgfVxuXG4gICAgbGV0IGJvbGRlZFRleHQgPSB0ZXh0XG4gICAgXG4gICAgLy8gU29ydCB2b2NhYnVsYXJ5IHdvcmRzIGJ5IGxlbmd0aCAobG9uZ2VzdCBmaXJzdCkgdG8gYXZvaWQgcGFydGlhbCBtYXRjaGVzXG4gICAgY29uc3Qgc29ydGVkV29yZHMgPSB2b2NhYnVsYXJ5V29yZHNcbiAgICAgIC5maWx0ZXIod29yZCA9PiB3b3JkICYmIHdvcmQgIT09ICdJTlNUUlVDVElPTicpIC8vIEZpbHRlciBvdXQgaW5zdHJ1Y3Rpb24gbWFya2VyXG4gICAgICAuc29ydCgoYSwgYikgPT4gYi5sZW5ndGggLSBhLmxlbmd0aClcbiAgICBcbiAgICBmb3IgKGNvbnN0IHdvcmQgb2Ygc29ydGVkV29yZHMpIHtcbiAgICAgIC8vIENyZWF0ZSByZWdleCB0byBtYXRjaCB3aG9sZSB3b3JkcyBvbmx5IChjYXNlIGluc2Vuc2l0aXZlKVxuICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBcXFxcYiR7d29yZC5yZXBsYWNlKC9bLiorP14ke30oKXxbXFxdXFxcXF0vZywgJ1xcXFwkJicpfVxcXFxiYCwgJ2dpJylcbiAgICAgIFxuICAgICAgLy8gUmVwbGFjZSB3aXRoIGJvbGQgbWFya2Rvd24sIGJ1dCBhdm9pZCBkb3VibGUtYm9sZGluZ1xuICAgICAgYm9sZGVkVGV4dCA9IGJvbGRlZFRleHQucmVwbGFjZShyZWdleCwgKG1hdGNoKSA9PiB7XG4gICAgICAgIC8vIENoZWNrIGlmIGFscmVhZHkgYm9sZGVkXG4gICAgICAgIGlmIChib2xkZWRUZXh0LmluY2x1ZGVzKGAqKiR7bWF0Y2h9KipgKSkge1xuICAgICAgICAgIHJldHVybiBtYXRjaFxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBgKioke21hdGNofSoqYFxuICAgICAgfSlcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGJvbGRlZFRleHRcbiAgfVxuXG4gIC8vIFNtYXJ0IGNvbXByZWhlbnNpb24gcXVlc3Rpb25zICg1IHF1ZXN0aW9ucyBwZXIgbGV2ZWwpXG4gIHByaXZhdGUgZ2VuZXJhdGVTbWFydENvbXByZWhlbnNpb24odG9waWNzOiBzdHJpbmdbXSwgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgdG9waWMgPSB0b3BpY3NbMF0gfHwgJ3RoZSBjb250ZW50J1xuXG4gICAgY29uc3QgbGV2ZWxRdWVzdGlvbnMgPSB7XG4gICAgICAnQTEnOiBbXG4gICAgICAgIGBXaGF0IGlzICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgXCJXaGF0IGlzIHRoZSBtYWluIGlkZWE/XCIsXG4gICAgICAgIFwiSXMgdGhpcyBpbmZvcm1hdGlvbiBuZXcgdG8geW91P1wiLFxuICAgICAgICBcIkRvIHlvdSB1bmRlcnN0YW5kIHRoZSB0ZXh0P1wiLFxuICAgICAgICBcIldoYXQgZGlkIHlvdSBsZWFybj9cIlxuICAgICAgXSxcbiAgICAgICdBMic6IFtcbiAgICAgICAgYFdoYXQgZG9lcyB0aGUgdGV4dCBzYXkgYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBcIldoYXQgYXJlIHRoZSBtYWluIHBvaW50cz9cIixcbiAgICAgICAgXCJEbyB5b3UgYWdyZWUgd2l0aCB0aGUgaW5mb3JtYXRpb24/XCIsXG4gICAgICAgIFwiV2hpY2ggcGFydCBpcyBtb3N0IGludGVyZXN0aW5nP1wiLFxuICAgICAgICBcIldoYXQgcXVlc3Rpb25zIGRvIHlvdSBoYXZlP1wiXG4gICAgICBdLFxuICAgICAgJ0IxJzogW1xuICAgICAgICBgSG93IGRvZXMgdGhlIHRleHQgZXhwbGFpbiAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIFwiV2hhdCBzdXBwb3J0aW5nIGRldGFpbHMgYXJlIHByb3ZpZGVkP1wiLFxuICAgICAgICBcIldoYXQgY29uY2x1c2lvbnMgY2FuIHlvdSBkcmF3P1wiLFxuICAgICAgICBcIkhvdyBkb2VzIHRoaXMgcmVsYXRlIHRvIHlvdXIgZXhwZXJpZW5jZT9cIixcbiAgICAgICAgXCJXaGF0IGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gd291bGQgYmUgaGVscGZ1bD9cIlxuICAgICAgXSxcbiAgICAgICdCMic6IFtcbiAgICAgICAgYFdoYXQgaXMgdGhlIGF1dGhvcidzIHBlcnNwZWN0aXZlIG9uICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgXCJXaGF0IGV2aWRlbmNlIHN1cHBvcnRzIHRoZSBtYWluIGFyZ3VtZW50cz9cIixcbiAgICAgICAgXCJXaGF0IGFyZSB0aGUgaW1wbGljYXRpb25zIG9mIHRoaXMgaW5mb3JtYXRpb24/XCIsXG4gICAgICAgIFwiSG93IG1pZ2h0IHRoaXMgYWZmZWN0IGRpZmZlcmVudCBncm91cHMgb2YgcGVvcGxlP1wiLFxuICAgICAgICBcIldoYXQgY291bnRlcmFyZ3VtZW50cyBjb3VsZCBiZSBtYWRlP1wiXG4gICAgICBdLFxuICAgICAgJ0MxJzogW1xuICAgICAgICBgSG93IGRvZXMgdGhlIGF1dGhvcidzIHRyZWF0bWVudCBvZiAke3RvcGljLnRvTG93ZXJDYXNlKCl9IHJlZmxlY3QgYnJvYWRlciB0aGVtZXM/YCxcbiAgICAgICAgXCJXaGF0IHVuZGVybHlpbmcgYXNzdW1wdGlvbnMgY2FuIHlvdSBpZGVudGlmeT9cIixcbiAgICAgICAgXCJIb3cgbWlnaHQgdGhpcyBpbmZvcm1hdGlvbiBiZSBpbnRlcnByZXRlZCBkaWZmZXJlbnRseSBpbiB2YXJpb3VzIGNvbnRleHRzP1wiLFxuICAgICAgICBcIldoYXQgYXJlIHRoZSBwb3RlbnRpYWwgbG9uZy10ZXJtIGNvbnNlcXVlbmNlcyBkaXNjdXNzZWQ/XCIsXG4gICAgICAgIFwiSG93IGRvZXMgdGhpcyBjb250cmlidXRlIHRvIHRoZSBvbmdvaW5nIGRpc2NvdXJzZSBpbiB0aGlzIGZpZWxkP1wiXG4gICAgICBdXG4gICAgfVxuXG4gICAgcmV0dXJuIGxldmVsUXVlc3Rpb25zW3N0dWRlbnRMZXZlbF0gfHwgbGV2ZWxRdWVzdGlvbnNbJ0IxJ11cbiAgfVxuXG4gIC8vIFNtYXJ0IGRpc2N1c3Npb24gcXVlc3Rpb25zXG4gIHByaXZhdGUgZ2VuZXJhdGVTbWFydERpc2N1c3Npb24odG9waWNzOiBzdHJpbmdbXSwgbGVzc29uVHlwZTogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCB0b3BpYyA9IHRvcGljc1swXSB8fCAndGhpcyB0b3BpYydcbiAgICBjb25zdCBzZWNvbmRUb3BpYyA9IHRvcGljc1sxXSB8fCAndGVjaG5vbG9neSdcblxuICAgIGNvbnN0IGxldmVsUXVlc3Rpb25zID0ge1xuICAgICAgJ0ExJzogW1xuICAgICAgICBgRG8geW91IGxpa2UgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT8gV2h5P2AsXG4gICAgICAgIGBJcyAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGdvb2Qgb3IgYmFkP2AsXG4gICAgICAgIGBXb3VsZCB5b3UgcmVjb21tZW5kICR7dG9waWMudG9Mb3dlckNhc2UoKX0gdG8gZnJpZW5kcz9gXG4gICAgICBdLFxuICAgICAgJ0EyJzogW1xuICAgICAgICBgV2hhdCBpcyB5b3VyIG9waW5pb24gYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IGRvIHlvdSB1c2UgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBpbiB5b3VyIGxpZmU/YCxcbiAgICAgICAgYFdoYXQgcHJvYmxlbXMgY2FuICR7dG9waWMudG9Mb3dlckNhc2UoKX0gY2F1c2U/YFxuICAgICAgXSxcbiAgICAgICdCMSc6IFtcbiAgICAgICAgYFdoYXQgYXJlIHRoZSBhZHZhbnRhZ2VzIGFuZCBkaXNhZHZhbnRhZ2VzIG9mICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYEhvdyBoYXMgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBjaGFuZ2VkIG92ZXIgdGltZT9gLFxuICAgICAgICBgV2hhdCB3b3VsZCBoYXBwZW4gaWYgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBkaWRuJ3QgZXhpc3Q/YFxuICAgICAgXSxcbiAgICAgICdCMic6IFtcbiAgICAgICAgYEhvdyBtaWdodCAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGltcGFjdCBzb2NpZXR5IGluIHRoZSBuZXh0IGRlY2FkZT9gLFxuICAgICAgICBgV2hhdCBldGhpY2FsIGNvbnNpZGVyYXRpb25zIHN1cnJvdW5kICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYEhvdyBkb2VzICR7dG9waWMudG9Mb3dlckNhc2UoKX0gZGlmZmVyIGFjcm9zcyBjdWx0dXJlcz9gXG4gICAgICBdLFxuICAgICAgJ0MxJzogW1xuICAgICAgICBgV2hhdCBhcmUgdGhlIGJyb2FkZXIgc29jaWV0YWwgaW1wbGljYXRpb25zIG9mICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYEhvdyBtaWdodCAke3RvcGljLnRvTG93ZXJDYXNlKCl9IHJlc2hhcGUgb3VyIHVuZGVyc3RhbmRpbmcgb2YgJHtzZWNvbmRUb3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgV2hhdCByb2xlIHNob3VsZCByZWd1bGF0aW9uIHBsYXkgaW4gJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gXG4gICAgICBdXG4gICAgfVxuXG4gICAgcmV0dXJuIGxldmVsUXVlc3Rpb25zW3N0dWRlbnRMZXZlbF0gfHwgbGV2ZWxRdWVzdGlvbnNbJ0IxJ11cbiAgfVxuXG4gIC8vIFNtYXJ0IGdyYW1tYXIgZm9jdXNcbiAgcHJpdmF0ZSBnZW5lcmF0ZVNtYXJ0R3JhbW1hcihzdHVkZW50TGV2ZWw6IHN0cmluZywgc291cmNlVGV4dDogc3RyaW5nKSB7XG4gICAgY29uc3QgZ3JhbW1hckZvY3VzID0ge1xuICAgICAgJ0ExJzoge1xuICAgICAgICBmb2N1czogJ1ByZXNlbnQgU2ltcGxlJyxcbiAgICAgICAgZXhhbXBsZXM6IFsnSXQgaXMgZWZmaWNpZW50LicsICdUaGlzIHdvcmtzIHdlbGwuJywgJ1Blb3BsZSB1c2UgdGVjaG5vbG9neS4nXSxcbiAgICAgICAgZXhlcmNpc2U6IFsnSXQgX19fX18gKGJlKSB2ZXJ5IHVzZWZ1bC4nLCAnVGVjaG5vbG9neSBfX19fXyAoaGVscCkgcGVvcGxlLicsICdUaGlzIF9fX19fICh3b3JrKSBvbiBwaG9uZXMuJ11cbiAgICAgIH0sXG4gICAgICAnQTInOiB7XG4gICAgICAgIGZvY3VzOiAnUHJlc2VudCBDb250aW51b3VzIGFuZCBTaW1wbGUnLFxuICAgICAgICBleGFtcGxlczogWydJdCBpcyB3b3JraW5nIG9uIHlvdXIgZGV2aWNlLicsICdQZW9wbGUgYXJlIHVzaW5nIHRoaXMgdGVjaG5vbG9neS4nLCAnSXQgaGVscHMgd2l0aCBwcml2YWN5LiddLFxuICAgICAgICBleGVyY2lzZTogWydJdCBfX19fXyAod29yaykgcmlnaHQgbm93LicsICdQZW9wbGUgX19fX18gKHVzZSkgaXQgZXZlcnkgZGF5LicsICdUaGlzIF9fX19fIChoZWxwKSB3aXRoIHNlY3VyaXR5LiddXG4gICAgICB9LFxuICAgICAgJ0IxJzoge1xuICAgICAgICBmb2N1czogJ1ByZXNlbnQgUGVyZmVjdCcsXG4gICAgICAgIGV4YW1wbGVzOiBbJ1RlY2hub2xvZ3kgaGFzIGltcHJvdmVkIHNpZ25pZmljYW50bHkuJywgJ0l0IGhhcyBiZWNvbWUgbW9yZSBlZmZpY2llbnQuJywgJ1VzZXJzIGhhdmUgZXhwZXJpZW5jZWQgYmV0dGVyIHByaXZhY3kuJ10sXG4gICAgICAgIGV4ZXJjaXNlOiBbJ1RlY2hub2xvZ3kgX19fX18gKGltcHJvdmUpIGEgbG90LicsICdJdCBfX19fXyAoYmVjb21lKSB2ZXJ5IHBvcHVsYXIuJywgJ1Blb3BsZSBfX19fXyAoc3RhcnQpIHVzaW5nIGl0IG1vcmUuJ11cbiAgICAgIH0sXG4gICAgICAnQjInOiB7XG4gICAgICAgIGZvY3VzOiAnUGFzc2l2ZSBWb2ljZScsXG4gICAgICAgIGV4YW1wbGVzOiBbJ0l0IGlzIGRlc2lnbmVkIGZvciBtb2JpbGUgZGV2aWNlcy4nLCAnUHJpdmFjeSBpcyBlbmhhbmNlZCBieSB0aGlzIHRlY2hub2xvZ3kuJywgJ0RhdGEgaXMgcHJvY2Vzc2VkIGxvY2FsbHkuJ10sXG4gICAgICAgIGV4ZXJjaXNlOiBbJ0l0IF9fX19fIChkZXNpZ24pIGZvciBwaG9uZXMuJywgJ1ByaXZhY3kgX19fX18gKGltcHJvdmUpIHNpZ25pZmljYW50bHkuJywgJ0luZm9ybWF0aW9uIF9fX19fIChwcm9jZXNzKSBzYWZlbHkuJ11cbiAgICAgIH0sXG4gICAgICAnQzEnOiB7XG4gICAgICAgIGZvY3VzOiAnQ29tcGxleCBTZW50ZW5jZSBTdHJ1Y3R1cmVzJyxcbiAgICAgICAgZXhhbXBsZXM6IFsnSGF2aW5nIGJlZW4gZGVzaWduZWQgZm9yIGVmZmljaWVuY3ksIGl0IG9wZXJhdGVzIHNlYW1sZXNzbHkuJywgJ1RoZSB0ZWNobm9sb2d5LCB3aGljaCBwcmlvcml0aXplcyBwcml2YWN5LCBoYXMgZ2FpbmVkIHBvcHVsYXJpdHkuJ10sXG4gICAgICAgIGV4ZXJjaXNlOiBbJ19fX19fIChkZXNpZ24pIGZvciBtb2JpbGUgdXNlLCBpdCB3b3JrcyBvZmZsaW5lLicsICdUaGUgc3lzdGVtLCBfX19fXyAoZm9jdXMpIG9uIHByaXZhY3ksIGFwcGVhbHMgdG8gdXNlcnMuJ11cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZ3JhbW1hckZvY3VzW3N0dWRlbnRMZXZlbF0gfHwgZ3JhbW1hckZvY3VzWydCMSddXG4gIH1cblxuICAvLyBTbWFydCBwcm9udW5jaWF0aW9uXG4gIHByaXZhdGUgZ2VuZXJhdGVTbWFydFByb251bmNpYXRpb24odm9jYWJ1bGFyeTogc3RyaW5nW10pIHtcbiAgICBjb25zdCB3b3JkID0gdm9jYWJ1bGFyeS5maW5kKHcgPT4gdy5sZW5ndGggPiA2KSB8fCB2b2NhYnVsYXJ5WzBdIHx8ICd0ZWNobm9sb2d5J1xuXG4gICAgY29uc3QgcHJvbnVuY2lhdGlvbnMgPSB7XG4gICAgICAndGVjaG5vbG9neSc6ICcvdGVry4huyZJsyZlkypJpLycsXG4gICAgICAnZWZmaWNpZW50JzogJy/JqsuIZsmqyoPJmW50LycsXG4gICAgICAncHJpdmFjeSc6ICcvy4hwcmHJqnbJmXNpLycsXG4gICAgICAncHJvY2Vzc2luZyc6ICcvy4hwcsmZyopzZXPJqsWLLycsXG4gICAgICAnZGV2aWNlJzogJy9kyarLiHZhyapzLycsXG4gICAgICAnYXJ0aWZpY2lhbCc6ICcvy4zJkcuQdMmqy4hmyarKg8mZbC8nLFxuICAgICAgJ2ludGVsbGlnZW5jZSc6ICcvyapuy4h0ZWzJqmTKksmZbnMvJyxcbiAgICAgICdjb21wYWN0JzogJy9ryZlty4hww6ZrdC8nLFxuICAgICAgJ3ZlcnNpb24nOiAnL8uIdsmcy5DKg8mZbi8nLFxuICAgICAgJ2ZhbWlseSc6ICcvy4hmw6ZtyZlsaS8nLFxuICAgICAgJ25hbm8nOiAnL8uIbsOmbm/Kii8nLFxuICAgICAgJ2dlbWluaSc6ICcvy4hkypJlbcmqbmHJqi8nXG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHdvcmQ6IHdvcmQsXG4gICAgICBpcGE6IHByb251bmNpYXRpb25zW3dvcmQudG9Mb3dlckNhc2UoKV0gfHwgYC/LiHfJnMuQcmQvYCxcbiAgICAgIHByYWN0aWNlOiBgUHJhY3RpY2Ugc2F5aW5nIFwiJHt3b3JkfVwiIGluIHRoaXMgc2VudGVuY2U6IFRoaXMgJHt3b3JkfSBpcyB2ZXJ5IHVzZWZ1bC5gXG4gICAgfVxuICB9XG5cbiAgLy8gU21hcnQgd3JhcC11cCBxdWVzdGlvbnNcbiAgcHJpdmF0ZSBnZW5lcmF0ZVNtYXJ0V3JhcHVwKHRvcGljczogc3RyaW5nW10sIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHRvcGljID0gdG9waWNzWzBdIHx8ICd0aGlzIHRvcGljJ1xuXG4gICAgcmV0dXJuIFtcbiAgICAgIGBXaGF0IG5ldyB2b2NhYnVsYXJ5IGRpZCB5b3UgbGVhcm4gYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgYFdoaWNoIGNvbmNlcHRzIGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0gbmVlZCBtb3JlIHByYWN0aWNlP2AsXG4gICAgICBcIkhvdyB3aWxsIHlvdSB1c2UgdGhpcyBrbm93bGVkZ2UgaW4gcmVhbCBzaXR1YXRpb25zP1wiLFxuICAgICAgXCJXaGF0IHF1ZXN0aW9ucyBkbyB5b3Ugc3RpbGwgaGF2ZSBhYm91dCB0aGlzIGNvbnRlbnQ/XCJcbiAgICBdXG4gIH1cblxuICAvLyBHZW5lcmF0ZSBkaWFsb2d1ZSBwcmFjdGljZSBzZWN0aW9uIChFbmdvby1zdHlsZSlcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZURpYWxvZ3VlUHJhY3RpY2Uoc291cmNlVGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZywgdm9jYWJ1bGFyeVdvcmRzOiBzdHJpbmdbXSk6IFByb21pc2U8e2luc3RydWN0aW9uOiBzdHJpbmcsIGRpYWxvZ3VlOiBBcnJheTx7Y2hhcmFjdGVyOiBzdHJpbmcsIGxpbmU6IHN0cmluZ30+LCBmb2xsb3dVcFF1ZXN0aW9uczogc3RyaW5nW119PiB7XG4gICAgY29uc3QgdG9waWNzID0gdGhpcy5leHRyYWN0QmV0dGVyVG9waWNzKHNvdXJjZVRleHQpXG4gICAgY29uc3QgbWFpblRvcGljID0gdG9waWNzWzBdIHx8ICd0aGlzIHRvcGljJ1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb250ZXh0ID0gc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgMTUwKVxuICAgICAgY29uc3QgcHJvbXB0ID0gYENyZWF0ZSBhICR7c3R1ZGVudExldmVsfSBsZXZlbCBkaWFsb2d1ZSBiZXR3ZWVuIDItMyBjaGFyYWN0ZXJzIGFib3V0OiAke2NvbnRleHR9LiBJbmNsdWRlIHZvY2FidWxhcnk6ICR7dm9jYWJ1bGFyeVdvcmRzLnNsaWNlKDAsIDMpLmpvaW4oJywgJyl9LiBGb3JtYXQ6IENoYXJhY3RlciBOYW1lOiBkaWFsb2d1ZSBsaW5lLiBNYWtlIGl0IG5hdHVyYWwgYW5kIGNvbnZlcnNhdGlvbmFsLmBcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coXCLwn46tIERpYWxvZ3VlIHByYWN0aWNlIHByb21wdDpcIiwgcHJvbXB0Lmxlbmd0aCwgXCJjaGFyc1wiKVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcbiAgICAgIFxuICAgICAgY29uc3QgZGlhbG9ndWUgPSB0aGlzLnBhcnNlRGlhbG9ndWUocmVzcG9uc2UpXG4gICAgICBjb25zdCBmb2xsb3dVcFF1ZXN0aW9ucyA9IHRoaXMuZ2VuZXJhdGVEaWFsb2d1ZUZvbGxvd1VwUXVlc3Rpb25zKG1haW5Ub3BpYywgc3R1ZGVudExldmVsKVxuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpbnN0cnVjdGlvbjogXCJQcmFjdGljZSB0aGlzIGRpYWxvZ3VlIHdpdGggeW91ciB0dXRvci4gVGFrZSB0dXJucyByZWFkaW5nIGRpZmZlcmVudCBjaGFyYWN0ZXJzOlwiLFxuICAgICAgICBkaWFsb2d1ZTogZGlhbG9ndWUsXG4gICAgICAgIGZvbGxvd1VwUXVlc3Rpb25zOiBmb2xsb3dVcFF1ZXN0aW9uc1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIuKaoO+4jyBEaWFsb2d1ZSBwcmFjdGljZSBnZW5lcmF0aW9uIGZhaWxlZCwgdXNpbmcgdGVtcGxhdGVcIilcbiAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRlVGVtcGxhdGVEaWFsb2d1ZVByYWN0aWNlKG1haW5Ub3BpYywgc3R1ZGVudExldmVsLCB2b2NhYnVsYXJ5V29yZHMpXG4gICAgfVxuICB9XG5cbiAgLy8gR2VuZXJhdGUgZGlhbG9ndWUgZmlsbC1pbi10aGUtZ2FwIHNlY3Rpb25cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZURpYWxvZ3VlRmlsbEdhcChzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nLCB2b2NhYnVsYXJ5V29yZHM6IHN0cmluZ1tdKTogUHJvbWlzZTx7aW5zdHJ1Y3Rpb246IHN0cmluZywgZGlhbG9ndWU6IEFycmF5PHtjaGFyYWN0ZXI6IHN0cmluZywgbGluZTogc3RyaW5nLCBpc0dhcD86IGJvb2xlYW59PiwgYW5zd2Vyczogc3RyaW5nW119PiB7XG4gICAgY29uc3QgdG9waWNzID0gdGhpcy5leHRyYWN0QmV0dGVyVG9waWNzKHNvdXJjZVRleHQpXG4gICAgY29uc3QgbWFpblRvcGljID0gdG9waWNzWzBdIHx8ICd0aGlzIHRvcGljJ1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb250ZXh0ID0gc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgMTUwKVxuICAgICAgY29uc3QgcHJvbXB0ID0gYENyZWF0ZSBhIHNob3J0ICR7c3R1ZGVudExldmVsfSBsZXZlbCBkaWFsb2d1ZSBiZXR3ZWVuIDIgY2hhcmFjdGVycyBhYm91dDogJHtjb250ZXh0fS4gTGVhdmUgMy00IGJsYW5rcyBmb3Igc3R1ZGVudHMgdG8gZmlsbC4gRm9ybWF0OiBDaGFyYWN0ZXI6IGRpYWxvZ3VlIHdpdGggX19fX18gZm9yIGJsYW5rcy5gXG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+TnSBGaWxsLWdhcCBkaWFsb2d1ZSBwcm9tcHQ6XCIsIHByb21wdC5sZW5ndGgsIFwiY2hhcnNcIilcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQpXG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGlhbG9ndWUsIGFuc3dlcnMgfSA9IHRoaXMucGFyc2VEaWFsb2d1ZVdpdGhHYXBzKHJlc3BvbnNlKVxuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpbnN0cnVjdGlvbjogXCJDb21wbGV0ZSB0aGUgZGlhbG9ndWUgYnkgZmlsbGluZyBpbiB0aGUgbWlzc2luZyB3b3JkcyBvciBwaHJhc2VzOlwiLFxuICAgICAgICBkaWFsb2d1ZTogZGlhbG9ndWUsXG4gICAgICAgIGFuc3dlcnM6IGFuc3dlcnNcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coXCLimqDvuI8gRmlsbC1nYXAgZGlhbG9ndWUgZ2VuZXJhdGlvbiBmYWlsZWQsIHVzaW5nIHRlbXBsYXRlXCIpXG4gICAgICByZXR1cm4gdGhpcy5nZW5lcmF0ZVRlbXBsYXRlRGlhbG9ndWVGaWxsR2FwKG1haW5Ub3BpYywgc3R1ZGVudExldmVsLCB2b2NhYnVsYXJ5V29yZHMpXG4gICAgfVxuICB9XG5cbiAgLy8gUGFyc2UgZGlhbG9ndWUgZnJvbSBBSSByZXNwb25zZVxuICBwcml2YXRlIHBhcnNlRGlhbG9ndWUocmVzcG9uc2U6IHN0cmluZyk6IEFycmF5PHtjaGFyYWN0ZXI6IHN0cmluZywgbGluZTogc3RyaW5nfT4ge1xuICAgIGNvbnN0IGxpbmVzID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpLmxlbmd0aCA+IDApXG4gICAgY29uc3QgZGlhbG9ndWUgPSBbXVxuICAgIFxuICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgY29uc3QgbWF0Y2ggPSBsaW5lLm1hdGNoKC9eKFtBLVphLXpcXHNdKyk6XFxzKiguKykkLylcbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICBkaWFsb2d1ZS5wdXNoKHtcbiAgICAgICAgICBjaGFyYWN0ZXI6IG1hdGNoWzFdLnRyaW0oKSxcbiAgICAgICAgICBsaW5lOiBtYXRjaFsyXS50cmltKClcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGRpYWxvZ3VlLmxlbmd0aCA+IDAgPyBkaWFsb2d1ZSA6IHRoaXMuZ2V0RGVmYXVsdERpYWxvZ3VlKClcbiAgfVxuXG4gIC8vIFBhcnNlIGRpYWxvZ3VlIHdpdGggZ2Fwc1xuICBwcml2YXRlIHBhcnNlRGlhbG9ndWVXaXRoR2FwcyhyZXNwb25zZTogc3RyaW5nKToge2RpYWxvZ3VlOiBBcnJheTx7Y2hhcmFjdGVyOiBzdHJpbmcsIGxpbmU6IHN0cmluZywgaXNHYXA/OiBib29sZWFufT4sIGFuc3dlcnM6IHN0cmluZ1tdfSB7XG4gICAgY29uc3QgbGluZXMgPSByZXNwb25zZS5zcGxpdCgnXFxuJykuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkubGVuZ3RoID4gMClcbiAgICBjb25zdCBkaWFsb2d1ZSA9IFtdXG4gICAgY29uc3QgYW5zd2VycyA9IFtdXG4gICAgXG4gICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG4gICAgICBjb25zdCBtYXRjaCA9IGxpbmUubWF0Y2goL14oW0EtWmEtelxcc10rKTpcXHMqKC4rKSQvKVxuICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgIGNvbnN0IGNoYXJhY3RlciA9IG1hdGNoWzFdLnRyaW0oKVxuICAgICAgICBjb25zdCB0ZXh0ID0gbWF0Y2hbMl0udHJpbSgpXG4gICAgICAgIFxuICAgICAgICBpZiAodGV4dC5pbmNsdWRlcygnX19fX18nKSkge1xuICAgICAgICAgIGRpYWxvZ3VlLnB1c2goe1xuICAgICAgICAgICAgY2hhcmFjdGVyOiBjaGFyYWN0ZXIsXG4gICAgICAgICAgICBsaW5lOiB0ZXh0LFxuICAgICAgICAgICAgaXNHYXA6IHRydWVcbiAgICAgICAgICB9KVxuICAgICAgICAgIGFuc3dlcnMucHVzaChcImFuc3dlclwiKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRpYWxvZ3VlLnB1c2goe1xuICAgICAgICAgICAgY2hhcmFjdGVyOiBjaGFyYWN0ZXIsXG4gICAgICAgICAgICBsaW5lOiB0ZXh0XG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4geyBkaWFsb2d1ZSwgYW5zd2VycyB9XG4gIH1cblxuICAvLyBHZW5lcmF0ZSBmb2xsb3ctdXAgcXVlc3Rpb25zIGZvciBkaWFsb2d1ZSBwcmFjdGljZVxuICBwcml2YXRlIGdlbmVyYXRlRGlhbG9ndWVGb2xsb3dVcFF1ZXN0aW9ucyh0b3BpYzogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBsZXZlbFF1ZXN0aW9ucyA9IHtcbiAgICAgICdBMSc6IFtcbiAgICAgICAgXCJXaGF0IGRpZCB0aGUgY2hhcmFjdGVycyB0YWxrIGFib3V0P1wiLFxuICAgICAgICBcIldoaWNoIGNoYXJhY3RlciBkbyB5b3UgbGlrZSBtb3JlP1wiLFxuICAgICAgICBcIklzIHRoaXMgY29udmVyc2F0aW9uIGVhc3kgb3IgZGlmZmljdWx0P1wiXG4gICAgICBdLFxuICAgICAgJ0EyJzogW1xuICAgICAgICBcIldoYXQgaXMgdGhlIG1haW4gcHJvYmxlbSBpbiB0aGUgZGlhbG9ndWU/XCIsXG4gICAgICAgIFwiSG93IGRvIHRoZSBjaGFyYWN0ZXJzIGZlZWw/XCIsXG4gICAgICAgIFwiV2hhdCB3b3VsZCB5b3Ugc2F5IGluIHRoaXMgc2l0dWF0aW9uP1wiXG4gICAgICBdLFxuICAgICAgJ0IxJzogW1xuICAgICAgICBcIldoYXQgaXMgdGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIHRoZSBjaGFyYWN0ZXJzP1wiLFxuICAgICAgICBcIkhvdyB3b3VsZCB5b3UgaGFuZGxlIHRoaXMgc2l0dWF0aW9uIGRpZmZlcmVudGx5P1wiLFxuICAgICAgICBcIldoYXQgY3VsdHVyYWwgZGlmZmVyZW5jZXMgZG8geW91IG5vdGljZT9cIlxuICAgICAgXSxcbiAgICAgICdCMic6IFtcbiAgICAgICAgXCJXaGF0IGFyZSB0aGUgdW5kZXJseWluZyBtb3RpdmF0aW9ucyBvZiBlYWNoIGNoYXJhY3Rlcj9cIixcbiAgICAgICAgXCJIb3cgZWZmZWN0aXZlIGlzIHRoZWlyIGNvbW11bmljYXRpb24/XCIsXG4gICAgICAgIFwiV2hhdCBhc3N1bXB0aW9ucyBhcmUgYmVpbmcgbWFkZSBpbiB0aGlzIGNvbnZlcnNhdGlvbj9cIlxuICAgICAgXSxcbiAgICAgICdDMSc6IFtcbiAgICAgICAgXCJIb3cgZG8gdGhlIGNoYXJhY3RlcnMnIGNvbW11bmljYXRpb24gc3R5bGVzIHJlZmxlY3QgdGhlaXIgYmFja2dyb3VuZHM/XCIsXG4gICAgICAgIFwiV2hhdCBpbXBsaWNpdCBtZWFuaW5ncyBjYW4geW91IGlkZW50aWZ5IGluIHRoZWlyIGV4Y2hhbmdlcz9cIixcbiAgICAgICAgXCJIb3cgbWlnaHQgdGhpcyBjb252ZXJzYXRpb24gdW5mb2xkIGluIGRpZmZlcmVudCBjdWx0dXJhbCBjb250ZXh0cz9cIlxuICAgICAgXVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gbGV2ZWxRdWVzdGlvbnNbc3R1ZGVudExldmVsXSB8fCBsZXZlbFF1ZXN0aW9uc1snQjEnXVxuICB9XG5cbiAgLy8gVGVtcGxhdGUgZGlhbG9ndWUgcHJhY3RpY2UgZmFsbGJhY2tcbiAgcHJpdmF0ZSBnZW5lcmF0ZVRlbXBsYXRlRGlhbG9ndWVQcmFjdGljZSh0b3BpYzogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZywgdm9jYWJ1bGFyeVdvcmRzOiBzdHJpbmdbXSk6IHtpbnN0cnVjdGlvbjogc3RyaW5nLCBkaWFsb2d1ZTogQXJyYXk8e2NoYXJhY3Rlcjogc3RyaW5nLCBsaW5lOiBzdHJpbmd9PiwgZm9sbG93VXBRdWVzdGlvbnM6IHN0cmluZ1tdfSB7XG4gICAgY29uc3QgZGlhbG9ndWUgPSBbXG4gICAgICB7IGNoYXJhY3RlcjogXCJBbGV4XCIsIGxpbmU6IGBIYXZlIHlvdSBoZWFyZCBhYm91dCAke3RvcGljfT9gIH0sXG4gICAgICB7IGNoYXJhY3RlcjogXCJTYW1cIiwgbGluZTogYFllcywgSSB0aGluayBpdCdzIHZlcnkgaW50ZXJlc3RpbmcuYCB9LFxuICAgICAgeyBjaGFyYWN0ZXI6IFwiQWxleFwiLCBsaW5lOiBgV2hhdCBkbyB5b3UgdGhpbmsgYWJvdXQgaXQ/YCB9LFxuICAgICAgeyBjaGFyYWN0ZXI6IFwiU2FtXCIsIGxpbmU6IGBJIGJlbGlldmUgaXQgd2lsbCBjaGFuZ2UgbWFueSB0aGluZ3MuYCB9LFxuICAgICAgeyBjaGFyYWN0ZXI6IFwiQWxleFwiLCBsaW5lOiBgSSBhZ3JlZS4gSXQncyBpbXBvcnRhbnQgdG8gdW5kZXJzdGFuZCBpdCBiZXR0ZXIuYCB9XG4gICAgXVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBpbnN0cnVjdGlvbjogXCJQcmFjdGljZSB0aGlzIGRpYWxvZ3VlIHdpdGggeW91ciB0dXRvci4gVGFrZSB0dXJucyByZWFkaW5nIGRpZmZlcmVudCBjaGFyYWN0ZXJzOlwiLFxuICAgICAgZGlhbG9ndWU6IGRpYWxvZ3VlLFxuICAgICAgZm9sbG93VXBRdWVzdGlvbnM6IHRoaXMuZ2VuZXJhdGVEaWFsb2d1ZUZvbGxvd1VwUXVlc3Rpb25zKHRvcGljLCBzdHVkZW50TGV2ZWwpXG4gICAgfVxuICB9XG5cbiAgLy8gVGVtcGxhdGUgZmlsbC1nYXAgZGlhbG9ndWUgZmFsbGJhY2tcbiAgcHJpdmF0ZSBnZW5lcmF0ZVRlbXBsYXRlRGlhbG9ndWVGaWxsR2FwKHRvcGljOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nLCB2b2NhYnVsYXJ5V29yZHM6IHN0cmluZ1tdKToge2luc3RydWN0aW9uOiBzdHJpbmcsIGRpYWxvZ3VlOiBBcnJheTx7Y2hhcmFjdGVyOiBzdHJpbmcsIGxpbmU6IHN0cmluZywgaXNHYXA/OiBib29sZWFufT4sIGFuc3dlcnM6IHN0cmluZ1tdfSB7XG4gICAgY29uc3QgZGlhbG9ndWUgPSBbXG4gICAgICB7IGNoYXJhY3RlcjogXCJQZXJzb24gQVwiLCBsaW5lOiBgV2hhdCBkbyB5b3UgdGhpbmsgYWJvdXQgX19fX18/YCwgaXNHYXA6IHRydWUgfSxcbiAgICAgIHsgY2hhcmFjdGVyOiBcIlBlcnNvbiBCXCIsIGxpbmU6IGBJIHRoaW5rIGl0J3MgdmVyeSBfX19fXy5gLCBpc0dhcDogdHJ1ZSB9LFxuICAgICAgeyBjaGFyYWN0ZXI6IFwiUGVyc29uIEFcIiwgbGluZTogYFdoeSBkbyB5b3UgZmVlbCB0aGF0IHdheT9gIH0sXG4gICAgICB7IGNoYXJhY3RlcjogXCJQZXJzb24gQlwiLCBsaW5lOiBgQmVjYXVzZSBpdCBfX19fXyBvdXIgZGFpbHkgbGl2ZXMuYCwgaXNHYXA6IHRydWUgfVxuICAgIF1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgaW5zdHJ1Y3Rpb246IFwiQ29tcGxldGUgdGhlIGRpYWxvZ3VlIGJ5IGZpbGxpbmcgaW4gdGhlIG1pc3Npbmcgd29yZHMgb3IgcGhyYXNlczpcIixcbiAgICAgIGRpYWxvZ3VlOiBkaWFsb2d1ZSxcbiAgICAgIGFuc3dlcnM6IFt0b3BpYywgXCJpbnRlcmVzdGluZ1wiLCBcImFmZmVjdHNcIl1cbiAgICB9XG4gIH1cblxuICAvLyBEZWZhdWx0IGRpYWxvZ3VlIGZhbGxiYWNrXG4gIHByaXZhdGUgZ2V0RGVmYXVsdERpYWxvZ3VlKCk6IEFycmF5PHtjaGFyYWN0ZXI6IHN0cmluZywgbGluZTogc3RyaW5nfT4ge1xuICAgIHJldHVybiBbXG4gICAgICB7IGNoYXJhY3RlcjogXCJBbGV4XCIsIGxpbmU6IFwiV2hhdCBkbyB5b3UgdGhpbmsgYWJvdXQgdGhpcyB0b3BpYz9cIiB9LFxuICAgICAgeyBjaGFyYWN0ZXI6IFwiU2FtXCIsIGxpbmU6IFwiSSBmaW5kIGl0IHZlcnkgaW50ZXJlc3RpbmcuXCIgfSxcbiAgICAgIHsgY2hhcmFjdGVyOiBcIkFsZXhcIiwgbGluZTogXCJDYW4geW91IHRlbGwgbWUgbW9yZT9cIiB9LFxuICAgICAgeyBjaGFyYWN0ZXI6IFwiU2FtXCIsIGxpbmU6IFwiU3VyZSwgSSdkIGJlIGhhcHB5IHRvIGV4cGxhaW4uXCIgfVxuICAgIF1cbiAgfVxuXG4gIC8vIEhlbHBlciBtZXRob2QgdG8gZGV0ZXJtaW5lIHNvdXJjZSBjb3VudHJ5IGZyb20gZG9tYWluXG4gIHByaXZhdGUgZGV0ZXJtaW5lU291cmNlQ291bnRyeShkb21haW46IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgY291bnRyeU1hcCA9IHtcbiAgICAgICdiYmMuY29tJzogJ1VuaXRlZCBLaW5nZG9tJyxcbiAgICAgICdiYmMuY28udWsnOiAnVW5pdGVkIEtpbmdkb20nLFxuICAgICAgJ2Nubi5jb20nOiAnVW5pdGVkIFN0YXRlcycsXG4gICAgICAnbnl0aW1lcy5jb20nOiAnVW5pdGVkIFN0YXRlcycsXG4gICAgICAndGhlZ3VhcmRpYW4uY29tJzogJ1VuaXRlZCBLaW5nZG9tJyxcbiAgICAgICd3YXNoaW5ndG9ucG9zdC5jb20nOiAnVW5pdGVkIFN0YXRlcycsXG4gICAgICAncmV1dGVycy5jb20nOiAnSW50ZXJuYXRpb25hbCcsXG4gICAgICAnYXAub3JnJzogJ1VuaXRlZCBTdGF0ZXMnLFxuICAgICAgJ25wci5vcmcnOiAnVW5pdGVkIFN0YXRlcycsXG4gICAgICAnYWJjLm5ldC5hdSc6ICdBdXN0cmFsaWEnLFxuICAgICAgJ2NiYy5jYSc6ICdDYW5hZGEnLFxuICAgIH1cblxuICAgIGZvciAoY29uc3QgW2RvbWFpbktleSwgY291bnRyeV0gb2YgT2JqZWN0LmVudHJpZXMoY291bnRyeU1hcCkpIHtcbiAgICAgIGlmIChkb21haW4uaW5jbHVkZXMoZG9tYWluS2V5KSkge1xuICAgICAgICByZXR1cm4gY291bnRyeVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAnSW50ZXJuYXRpb25hbCdcbiAgfVxuXG4gIC8vIEZhbGxiYWNrIHdhcm0tdXAgcXVlc3Rpb24gZ2VuZXJhdG9yXG4gIHByaXZhdGUgZ2V0RmFsbGJhY2tXYXJtdXBRdWVzdGlvbihsZXZlbDogc3RyaW5nLCBjb250ZW50QW5hbHlzaXM6IGFueSwgcXVlc3Rpb25JbmRleDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCB0b3BpYyA9IGNvbnRlbnRBbmFseXNpcy50b3BpY3NbMF0gfHwgJ3RoaXMgdG9waWMnXG4gICAgY29uc3QgY29udGVudFR5cGUgPSBjb250ZW50QW5hbHlzaXMuY29udGVudFR5cGVcblxuICAgIGNvbnN0IGZhbGxiYWNrUXVlc3Rpb25zID0ge1xuICAgICAgJ0ExJzogW1xuICAgICAgICBgRG8geW91IGtub3cgYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSXMgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBpbXBvcnRhbnQgaW4geW91ciBjb3VudHJ5P2AsXG4gICAgICAgIGBEbyB5b3UgbGlrZSB0byByZWFkIGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YFxuICAgICAgXSxcbiAgICAgICdBMic6IFtcbiAgICAgICAgYEhhdmUgeW91IGhlYXJkIGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0gYmVmb3JlP2AsXG4gICAgICAgIGBXaGF0IGRvIHlvdSBrbm93IGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYElzICR7dG9waWMudG9Mb3dlckNhc2UoKX0gZGlmZmVyZW50IGluIHlvdXIgY291bnRyeT9gXG4gICAgICBdLFxuICAgICAgJ0IxJzogW1xuICAgICAgICBgV2hhdCBkbyB5b3UgdGhpbmsgYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IGlzICR7dG9waWMudG9Mb3dlckNhc2UoKX0gaW1wb3J0YW50IGluIHlvdXIgZGFpbHkgbGlmZT9gLFxuICAgICAgICBgV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBrbm93IGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YFxuICAgICAgXSxcbiAgICAgICdCMic6IFtcbiAgICAgICAgYFdoYXQgYXJlIHlvdXIgdGhvdWdodHMgb24gJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IG1pZ2h0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0gYWZmZWN0IHBlb3BsZSBpbiBkaWZmZXJlbnQgY291bnRyaWVzP2AsXG4gICAgICAgIGBXaGF0IHF1ZXN0aW9ucyB3b3VsZCB5b3UgYXNrIGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YFxuICAgICAgXSxcbiAgICAgICdDMSc6IFtcbiAgICAgICAgYEhvdyBkbyBjdWx0dXJhbCBwZXJzcGVjdGl2ZXMgaW5mbHVlbmNlIGF0dGl0dWRlcyB0b3dhcmQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgV2hhdCBhcmUgdGhlIGJyb2FkZXIgaW1wbGljYXRpb25zIG9mICR7dG9waWMudG9Mb3dlckNhc2UoKX0gaW4gbW9kZXJuIHNvY2lldHk/YCxcbiAgICAgICAgYEhvdyBtaWdodCAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGV2b2x2ZSBpbiB0aGUgY29taW5nIHllYXJzP2BcbiAgICAgIF1cbiAgICB9XG5cbiAgICBjb25zdCBsZXZlbFF1ZXN0aW9ucyA9IGZhbGxiYWNrUXVlc3Rpb25zW2xldmVsXSB8fCBmYWxsYmFja1F1ZXN0aW9uc1snQjEnXVxuICAgIHJldHVybiBsZXZlbFF1ZXN0aW9uc1txdWVzdGlvbkluZGV4XSB8fCBsZXZlbFF1ZXN0aW9uc1swXVxuICB9XG5cbiAgLy8gQ29udGV4dHVhbCB3YXJtLXVwIGZhbGxiYWNrIHdoZW4gQUkgZmFpbHNcbiAgcHJpdmF0ZSBnZXRDb250ZXh0dWFsV2FybXVwRmFsbGJhY2sobGV2ZWw6IHN0cmluZywgY29udGVudEFuYWx5c2lzOiBhbnksIG1ldGFkYXRhPzogYW55KTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHRvcGljID0gY29udGVudEFuYWx5c2lzLnRvcGljc1swXSB8fCAndGhpcyB0b3BpYydcbiAgICBjb25zdCBzb3VyY2VDb3VudHJ5ID0gY29udGVudEFuYWx5c2lzLnNvdXJjZUNvdW50cnkgfHwgJ3RoaXMgY291bnRyeSdcbiAgICBjb25zdCB0aXRsZSA9IG1ldGFkYXRhPy50aXRsZSB8fCAndGhpcyBjb250ZW50J1xuXG4gICAgY29uc3QgZmFsbGJhY2tTZXRzID0ge1xuICAgICAgJ0ExJzogW1xuICAgICAgICBgRG8geW91IGtub3cgYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSXMgdGhpcyB0b3BpYyBjb21tb24gaW4geW91ciBjb3VudHJ5P2AsXG4gICAgICAgIGBEbyB5b3Ugd2FudCB0byBsZWFybiBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2BcbiAgICAgIF0sXG4gICAgICAnQTInOiBbXG4gICAgICAgIGBIYXZlIHlvdSBleHBlcmllbmNlZCAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGJlZm9yZT9gLFxuICAgICAgICBgV2hhdCBpcyAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGxpa2UgaW4geW91ciBjb3VudHJ5P2AsXG4gICAgICAgIGBXaHkgaXMgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBpbnRlcmVzdGluZyB0byB5b3U/YFxuICAgICAgXSxcbiAgICAgICdCMSc6IFtcbiAgICAgICAgYFdoYXQgZG8geW91IHRoaW5rIGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYEhvdyBpcyAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGRpZmZlcmVudCBpbiB5b3VyIGNvdW50cnkgY29tcGFyZWQgdG8gJHtzb3VyY2VDb3VudHJ5fT9gLFxuICAgICAgICBgV2hhdCB3b3VsZCB5b3UgZXhwZWN0IHRvIGxlYXJuIGZyb20gdGhpcyAke2NvbnRlbnRBbmFseXNpcy5jb250ZW50VHlwZX0/YFxuICAgICAgXSxcbiAgICAgICdCMic6IFtcbiAgICAgICAgYFdoYXQgYXJlIHlvdXIgdGhvdWdodHMgb24gaG93ICR7dG9waWMudG9Mb3dlckNhc2UoKX0gaXMgcHJlc2VudGVkIGluICR7c291cmNlQ291bnRyeX0gbWVkaWE/YCxcbiAgICAgICAgYFdoYXQgY2hhbGxlbmdlcyBkbyB5b3UgdGhpbmsgcGVvcGxlIGZhY2Ugd2l0aCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBIb3cgbWlnaHQgeW91ciBwZXJzcGVjdGl2ZSBvbiAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGRpZmZlciBmcm9tIHRoZSBhdXRob3Incz9gXG4gICAgICBdLFxuICAgICAgJ0MxJzogW1xuICAgICAgICBgSG93IGRvIGN1bHR1cmFsIGF0dGl0dWRlcyB0b3dhcmQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSB2YXJ5IGJldHdlZW4gJHtzb3VyY2VDb3VudHJ5fSBhbmQgeW91ciBjb3VudHJ5P2AsXG4gICAgICAgIGBXaGF0IGFyZSB0aGUgYnJvYWRlciBzb2NpZXRhbCBpbXBsaWNhdGlvbnMgb2YgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IG1pZ2h0IHRoZSBwZXJzcGVjdGl2ZSBpbiB0aGlzICR7Y29udGVudEFuYWx5c2lzLmNvbnRlbnRUeXBlfSByZWZsZWN0ICR7c291cmNlQ291bnRyeX0gdmFsdWVzP2BcbiAgICAgIF1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsbGJhY2tTZXRzW2xldmVsXSB8fCBmYWxsYmFja1NldHNbJ0IxJ11cbiAgfVxufVxuXG5leHBvcnQgY29uc3QgbGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3IgPSBuZXcgTGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3IoKVxuIl0sIm5hbWVzIjpbImNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZSIsIkxlc3NvbkFJU2VydmVyR2VuZXJhdG9yIiwiZ2V0R29vZ2xlQUkiLCJnb29nbGVBSSIsImdlbmVyYXRlTGVzc29uIiwicGFyYW1zIiwic291cmNlVGV4dCIsImxlc3NvblR5cGUiLCJzdHVkZW50TGV2ZWwiLCJ0YXJnZXRMYW5ndWFnZSIsInNvdXJjZVVybCIsImNvbnRlbnRNZXRhZGF0YSIsInN0cnVjdHVyZWRDb250ZW50Iiwid29yZENvdW50IiwicmVhZGluZ1RpbWUiLCJjb25zb2xlIiwibG9nIiwidGV4dExlbmd0aCIsImxlbmd0aCIsImhhc01ldGFkYXRhIiwiaGFzU3RydWN0dXJlZENvbnRlbnQiLCJsZXNzb25TdHJ1Y3R1cmUiLCJnZW5lcmF0ZU1pbmltYWxBSUxlc3NvbiIsIk9iamVjdCIsImtleXMiLCJmaW5hbExlc3NvbiIsInNlY3Rpb25zIiwic2VjdGlvbnNDb3VudCIsIndhcm11cENvdW50Iiwid2FybXVwIiwidm9jYWJ1bGFyeUNvdW50Iiwidm9jYWJ1bGFyeSIsImVycm9yIiwiZ2VuZXJhdGVTbWFydFRlbXBsYXRlRmFsbGJhY2siLCJtZXRhZGF0YSIsIndhcm11cFF1ZXN0aW9ucyIsImdlbmVyYXRlTWluaW1hbFdhcm11cCIsImdlbmVyYXRlTWluaW1hbFZvY2FidWxhcnkiLCJjb21wcmVoZW5zaW9uUXVlc3Rpb25zIiwiZ2VuZXJhdGVNaW5pbWFsQ29tcHJlaGVuc2lvbiIsInZvY2FidWxhcnlXb3JkcyIsIm1hcCIsInYiLCJ3b3JkIiwicmVhZGluZ1Bhc3NhZ2UiLCJnZW5lcmF0ZVNtYXJ0UmVhZGluZyIsImFkZFdhcm11cEluc3RydWN0aW9ucyIsImFkZFZvY2FidWxhcnlJbnN0cnVjdGlvbnMiLCJyZWFkaW5nIiwiYWRkUmVhZGluZ0luc3RydWN0aW9ucyIsImNvbXByZWhlbnNpb24iLCJhZGRDb21wcmVoZW5zaW9uSW5zdHJ1Y3Rpb25zIiwiZGlzY3Vzc2lvbiIsImFkZERpc2N1c3Npb25JbnN0cnVjdGlvbnMiLCJnZW5lcmF0ZVNtYXJ0RGlzY3Vzc2lvbiIsImV4dHJhY3RCZXR0ZXJUb3BpY3MiLCJkaWFsb2d1ZVByYWN0aWNlIiwiZ2VuZXJhdGVEaWFsb2d1ZVByYWN0aWNlIiwiZGlhbG9ndWVGaWxsR2FwIiwiZ2VuZXJhdGVEaWFsb2d1ZUZpbGxHYXAiLCJncmFtbWFyIiwiZ2VuZXJhdGVTbWFydEdyYW1tYXIiLCJwcm9udW5jaWF0aW9uIiwiZ2VuZXJhdGVTbWFydFByb251bmNpYXRpb24iLCJ3cmFwdXAiLCJhZGRXcmFwdXBJbnN0cnVjdGlvbnMiLCJnZW5lcmF0ZVNtYXJ0V3JhcHVwIiwidG9waWNzIiwibWFpblRvcGljIiwicHJvbXB0IiwicmVzcG9uc2UiLCJxdWVzdGlvbnMiLCJzcGxpdCIsImxpbmUiLCJ0cmltIiwiZmlsdGVyIiwiZW5kc1dpdGgiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwicmVwbGFjZSIsInNsaWNlIiwiZ2VuZXJhdGVTbWFydFdhcm11cFF1ZXN0aW9ucyIsImluc3RydWN0aW9uIiwibWVhbmluZyIsImV4YW1wbGUiLCJyZWFkaW5nVGV4dCIsInRleHQiLCJjb21wb3VuZFBhdHRlcm5zIiwicGF0dGVybiIsIm1hdGNoZXMiLCJtYXRjaCIsInB1c2giLCJtIiwid29yZHMiLCJjb21tb25Xb3JkcyIsImZvdW5kV29yZHMiLCJ1bmlxdWVXb3JkcyIsIkFycmF5IiwiZnJvbSIsIlNldCIsImNhcGl0YWxpemVkV29yZCIsImNhcGl0YWxpemVXb3JkIiwiZGVmaW5pdGlvblByb21wdCIsInN1YnN0cmluZyIsInJhd01lYW5pbmciLCJjbGVhbkRlZmluaXRpb24iLCJleGFtcGxlcyIsImdlbmVyYXRlQUlFeGFtcGxlU2VudGVuY2VzIiwiZ2VuZXJhdGVDb250ZXh0dWFsV29yZE1lYW5pbmciLCJzaG9ydFRleHQiLCJnZW5lcmF0ZVNtYXJ0Q29tcHJlaGVuc2lvbiIsImV4dHJhY3RWb2NhYnVsYXJ5RnJvbVRleHQiLCJnZW5lcmF0ZVNtYXJ0Vm9jYWJ1bGFyeSIsImFuYWx5emVDb250ZW50Q29udGV4dE5vQUkiLCJhbmFseXNpcyIsImNvbnRlbnRUeXBlIiwiZG9tYWluIiwiY29tcGxleGl0eSIsImtleVZvY2FidWxhcnkiLCJjdWx0dXJhbENvbnRleHQiLCJsZWFybmluZ09iamVjdGl2ZXMiLCJkaWZmaWN1bHR5IiwidGl0bGUiLCJzb3VyY2VDb3VudHJ5IiwiZGV0ZXJtaW5lU291cmNlQ291bnRyeSIsInNlbnRlbmNlcyIsInMiLCJhdmdTZW50ZW5jZUxlbmd0aCIsInJlZHVjZSIsInN1bSIsImNvbXBsZXhXb3JkcyIsInRvdGFsV29yZHMiLCJleHRyYWN0VG9waWNzRnJvbVRleHQiLCJoZWFkaW5ncyIsImRldGVybWluZUN1bHR1cmFsQ29udGV4dCIsImdlbmVyYXRlTGVhcm5pbmdPYmplY3RpdmVzIiwiYW5hbHl6ZUNvbnRlbnRDb250ZXh0IiwiY3JlYXRlQ29udGV4dHVhbFN1bW1hcnkiLCJjb250ZW50QW5hbHlzaXMiLCJzdW1tYXJ5UHJvbXB0Iiwic3VtbWFyeSIsInRlbXBlcmF0dXJlIiwibWF4VG9rZW5zIiwid2FybiIsIm1lc3NhZ2UiLCJ0cnVuY2F0ZWQiLCJnZW5lcmF0ZUNvbnRleHR1YWxXYXJtdXBRdWVzdGlvbnMiLCJjb250ZW50IiwibGV2ZWxJbnN0cnVjdGlvbnMiLCJ0b3BpYyIsIndhcm11cFByb21wdCIsInBhcnNlTGlzdEZyb21UZXh0IiwiZmFsbGJhY2tRdWVzdGlvbiIsImdldEZhbGxiYWNrV2FybXVwUXVlc3Rpb24iLCJmYWxsYmFja1F1ZXN0aW9ucyIsImdldENvbnRleHR1YWxXYXJtdXBGYWxsYmFjayIsImdlbmVyYXRlQ29udGV4dHVhbExlc3NvblN0cnVjdHVyZSIsImNvbnRleHR1YWxXYXJtdXAiLCJqb2luIiwidm9jYWIiLCJKU09OIiwic3RyaW5naWZ5IiwicGFyc2VkIiwicGFyc2UiLCJwYXJzZUVycm9yIiwianNvbk1hdGNoIiwiY2xlYW5lZCIsImNsZWFuRXJyb3IiLCJmYWxsYmFjayIsImNyZWF0ZVN0cnVjdHVyZWRGYWxsYmFjayIsImdlbmVyYXRlRGV0YWlsZWRDb250ZXh0dWFsQ29udGVudCIsInN0cnVjdHVyZSIsImkiLCJjb250ZXh0dWFsRXhhbXBsZVByb21wdCIsImVuaGFuY2VkRXhhbXBsZSIsIndyaXRlIiwidG9uZSIsImNvbnRleHR1YWxNZWFuaW5nUHJvbXB0IiwiY29udGV4dHVhbE1lYW5pbmciLCJlbmhhbmNlZERpc2N1c3Npb25Qcm9tcHQiLCJlbmhhbmNlZERpc2N1c3Npb24iLCJmb3JtYXQiLCJzdHJ1Y3R1cmVkUmVhZGluZ1Byb21wdCIsImgiLCJlbmhhbmNlZFJlYWRpbmciLCJyZXdyaXRlIiwiYXVkaWVuY2UiLCJnZXRBdWRpZW5jZUxldmVsIiwiZm9jdXMiLCJncmFtbWFyRXhhbXBsZXNQcm9tcHQiLCJjb250ZXh0dWFsR3JhbW1hckV4YW1wbGVzIiwiY29udGV4dHVhbEV4YW1wbGVzIiwicHJvb2ZyZWFkTGVzc29uIiwibGVzc29uIiwic2VjdGlvbnNUb1Byb29mcmVhZCIsInNlY3Rpb25QYXRoIiwidmFsdWUiLCJnZXROZXN0ZWRWYWx1ZSIsInByb29mcmVhZCIsImNoZWNrR3JhbW1hciIsImNoZWNrU3BlbGxpbmciLCJjaGVja1N0eWxlIiwic2V0TmVzdGVkVmFsdWUiLCJjb3JyZWN0ZWRfdGV4dCIsImdlbmVyYXRlRmFsbGJhY2tMZXNzb24iLCJnZXRUZW1wbGF0ZVdhcm11cCIsImV4dHJhY3RWb2NhYnVsYXJ5Iiwic2ltcGxpZnlUZXh0IiwiZ2V0VGVtcGxhdGVDb21wcmVoZW5zaW9uIiwiZ2VuZXJhdGVUZW1wbGF0ZURpYWxvZ3VlUHJhY3RpY2UiLCJnZW5lcmF0ZVRlbXBsYXRlRGlhbG9ndWVGaWxsR2FwIiwiZ2V0VGVtcGxhdGVEaXNjdXNzaW9uIiwiZ2V0VGVtcGxhdGVHcmFtbWFyIiwiZ2V0VGVtcGxhdGVQcm9udW5jaWF0aW9uIiwiZ2V0VGVtcGxhdGVXcmFwdXAiLCJnZXRTdW1tYXJ5TGVuZ3RoIiwibGV2ZWwiLCJsZW5ndGhNYXAiLCJBMSIsIkEyIiwiQjEiLCJCMiIsIkMxIiwiZ2V0TGFuZ3VhZ2VDb2RlIiwibGFuZ3VhZ2UiLCJsYW5ndWFnZU1hcCIsInNwYW5pc2giLCJmcmVuY2giLCJnZXJtYW4iLCJpdGFsaWFuIiwicG9ydHVndWVzZSIsImphcGFuZXNlIiwia29yZWFuIiwiY2hpbmVzZSIsIm9iaiIsInBhdGgiLCJjdXJyZW50Iiwia2V5IiwibGFzdEtleSIsInBvcCIsInRhcmdldCIsInRlbXBsYXRlcyIsInRyYXZlbCIsImJ1c2luZXNzIiwic2VsZWN0ZWRXb3JkcyIsIm1heExlbmd0aCIsImxpbWl0IiwiZ3JhbW1hckZvY2kiLCJleGVyY2lzZSIsInNlbGVjdGVkV29yZCIsImlwYSIsInByYWN0aWNlIiwiZXh0cmFjdFRvcGljc0Zyb21IZWFkaW5ncyIsImhlYWRpbmdUb3BpY3MiLCJ0b3BpY1BhdHRlcm5zIiwic2VudGVuY2UiLCJrZXlXb3JkcyIsImluZGV4IiwiYXJyIiwiaW5kZXhPZiIsImNvbXBsZXhpdHlUaHJlc2hvbGQiLCJjdWx0dXJhbEluZGljYXRvcnMiLCJhbWVyaWNhbk1hcmtlcnMiLCJicml0aXNoTWFya2VycyIsImFtZXJpY2FuQ291bnQiLCJtYXJrZXIiLCJicml0aXNoQ291bnQiLCJvYmplY3RpdmVzIiwiZm9yRWFjaCIsImNlZnJMZXZlbCIsImxldmVsTWFwIiwiZ2VuZXJhdGVFbmhhbmNlZEZhbGxiYWNrTGVzc29uIiwibW9ja0NvbnRlbnRBbmFseXNpcyIsImV4dHJhY3RDb250ZXh0dWFsVm9jYWJ1bGFyeSIsImdldENvbnRleHR1YWxDb21wcmVoZW5zaW9uIiwiZ2V0Q29udGV4dHVhbERpc2N1c3Npb24iLCJnZXRDb250ZXh0dWFsV3JhcHVwIiwiZ2V0Q29udGV4dHVhbFdhcm11cCIsIm1vY2tBbmFseXNpcyIsImdlbmVyYXRlQmFzaWNGYWxsYmFja0xlc3NvbiIsImNvbnRleHQiLCJiYXNlUXVlc3Rpb25zIiwiZ2VuZXJhdGVTbWFydFRlbXBsYXRlTGVzc29uIiwic2Vjb25kVG9waWMiLCJsZXZlbFF1ZXN0aW9ucyIsInZvY2FiUHJvbWlzZXMiLCJyZXN1bHRzIiwiUHJvbWlzZSIsImFsbCIsImNoYXJBdCIsInRvVXBwZXJDYXNlIiwibG93ZXJXb3JkIiwiY29udGV4dHVhbE1lYW5pbmdzIiwibGV2ZWxNZWFuaW5ncyIsImlzU2ltcGxlTGV2ZWwiLCJleGFtcGxlQ291bnQiLCJnZXRFeGFtcGxlQ291bnQiLCJsZXZlbEd1aWRhbmNlIiwiZ2V0TGV2ZWxHdWlkYW5jZSIsImNsZWFuU2VudGVuY2UiLCJib2xkaWZ5VGFyZ2V0V29yZCIsImFkZGl0aW9uYWxOZWVkZWQiLCJ0ZW1wbGF0ZVNlbnRlbmNlcyIsImdlbmVyYXRlQ29udGV4dHVhbEV4YW1wbGVzIiwiZ3VpZGFuY2UiLCJkZWZpbml0aW9uIiwidGFyZ2V0V29yZCIsInJlZ2V4IiwiUmVnRXhwIiwiY291bnQiLCJ0aGVtZXMiLCJleHRyYWN0VGhlbWVzRnJvbVRleHQiLCJtYWluVGhlbWUiLCJsZXZlbEV4YW1wbGVzIiwidGhlbWVLZXl3b3JkcyIsImxvd2VyVGV4dCIsInRoZW1lIiwia2V5d29yZHMiLCJlbnRyaWVzIiwibWF0Y2hDb3VudCIsImtleXdvcmQiLCJnZW5lcmF0ZUxldmVsQXBwcm9wcmlhdGVFeGFtcGxlcyIsImdlbmVyYXRlVGVtcGxhdGVFeGFtcGxlcyIsImNvbnRleHRTZW50ZW5jZSIsImZpbmQiLCJhZGRpdGlvbmFsRXhhbXBsZXMiLCJnZW5lcmF0ZUFkZGl0aW9uYWxFeGFtcGxlcyIsImV4YW1wbGVUZW1wbGF0ZXMiLCJ0YXJnZXRMZW5ndGgiLCJyZXdyaXR0ZW5UZXh0IiwicmV3cml0ZUZvckxldmVsIiwiYm9sZFZvY2FidWxhcnlJblRleHQiLCJhZGFwdGVkVGV4dCIsImFkYXB0UmVhZGluZ1RlbXBsYXRlIiwiZ2V0UmVhZGluZ0xldmVsR3VpZGFuY2UiLCJzaW1wbGlmaWVkU2VudGVuY2VzIiwic2ltcGxpZnlzZW50ZW5jZSIsImJvbGRlZFRleHQiLCJzb3J0ZWRXb3JkcyIsInNvcnQiLCJhIiwiYiIsImdyYW1tYXJGb2N1cyIsInciLCJwcm9udW5jaWF0aW9ucyIsImRpYWxvZ3VlIiwicGFyc2VEaWFsb2d1ZSIsImZvbGxvd1VwUXVlc3Rpb25zIiwiZ2VuZXJhdGVEaWFsb2d1ZUZvbGxvd1VwUXVlc3Rpb25zIiwiYW5zd2VycyIsInBhcnNlRGlhbG9ndWVXaXRoR2FwcyIsImxpbmVzIiwiY2hhcmFjdGVyIiwiZ2V0RGVmYXVsdERpYWxvZ3VlIiwiaXNHYXAiLCJjb3VudHJ5TWFwIiwiZG9tYWluS2V5IiwiY291bnRyeSIsInF1ZXN0aW9uSW5kZXgiLCJmYWxsYmFja1NldHMiLCJsZXNzb25BSVNlcnZlckdlbmVyYXRvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/lesson-ai-generator-server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase-server.ts":
/*!********************************!*\
  !*** ./lib/supabase-server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createServerSupabaseClient: () => (/* binding */ createServerSupabaseClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n\n\nconst createServerSupabaseClient = ()=>{\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createServerClient)(\"https://jbkpnirowdvlwlgheqho.supabase.co\" || 0, \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impia3BuaXJvd2R2bHdsZ2hlcWhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5MTQ3NTEsImV4cCI6MjA3NDQ5MDc1MX0.FZhruXKDzIkZLhla5oerfs7yzjvTsGLlKTUer34N6N0\" || 0, {\n        cookies: {\n            get (name) {\n                return cookieStore.get(name)?.value;\n            },\n            set (name, value, options) {\n                cookieStore.set({\n                    name,\n                    value,\n                    ...options\n                });\n            },\n            remove (name, options) {\n                cookieStore.set({\n                    name,\n                    value: \"\",\n                    ...options\n                });\n            }\n        }\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Utc2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFrRDtBQUNaO0FBRS9CLE1BQU1FLDZCQUE2QjtJQUN4QyxNQUFNQyxjQUFjRixxREFBT0E7SUFFM0IsT0FBT0QsaUVBQWtCQSxDQUN2QkksMENBQW9DLElBQUksR0FDeENBLGtOQUF5QyxJQUFJLEdBQzdDO1FBQ0FILFNBQVM7WUFDUE8sS0FBSUMsSUFBWTtnQkFDZCxPQUFPTixZQUFZSyxHQUFHLENBQUNDLE9BQU9DO1lBQ2hDO1lBQ0FDLEtBQUlGLElBQVksRUFBRUMsS0FBYSxFQUFFRSxPQUFZO2dCQUMzQ1QsWUFBWVEsR0FBRyxDQUFDO29CQUFFRjtvQkFBTUM7b0JBQU8sR0FBR0UsT0FBTztnQkFBQztZQUM1QztZQUNBQyxRQUFPSixJQUFZLEVBQUVHLE9BQVk7Z0JBQy9CVCxZQUFZUSxHQUFHLENBQUM7b0JBQUVGO29CQUFNQyxPQUFPO29CQUFJLEdBQUdFLE9BQU87Z0JBQUM7WUFDaEQ7UUFDRjtJQUNGO0FBQ0YsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvLi9saWIvc3VwYWJhc2Utc2VydmVyLnRzPzA5NGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50IH0gZnJvbSBcIkBzdXBhYmFzZS9zc3JcIlxuaW1wb3J0IHsgY29va2llcyB9IGZyb20gXCJuZXh0L2hlYWRlcnNcIlxuXG5leHBvcnQgY29uc3QgY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQgPSAoKSA9PiB7XG4gIGNvbnN0IGNvb2tpZVN0b3JlID0gY29va2llcygpXG5cbiAgcmV0dXJuIGNyZWF0ZVNlcnZlckNsaWVudChcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgfHwgJ2h0dHBzOi8vcGxhY2Vob2xkZXIuc3VwYWJhc2UuY28nLCBcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSB8fCAncGxhY2Vob2xkZXIta2V5JywgXG4gICAge1xuICAgIGNvb2tpZXM6IHtcbiAgICAgIGdldChuYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIGNvb2tpZVN0b3JlLmdldChuYW1lKT8udmFsdWVcbiAgICAgIH0sXG4gICAgICBzZXQobmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBvcHRpb25zOiBhbnkpIHtcbiAgICAgICAgY29va2llU3RvcmUuc2V0KHsgbmFtZSwgdmFsdWUsIC4uLm9wdGlvbnMgfSlcbiAgICAgIH0sXG4gICAgICByZW1vdmUobmFtZTogc3RyaW5nLCBvcHRpb25zOiBhbnkpIHtcbiAgICAgICAgY29va2llU3RvcmUuc2V0KHsgbmFtZSwgdmFsdWU6IFwiXCIsIC4uLm9wdGlvbnMgfSlcbiAgICAgIH0sXG4gICAgfSxcbiAgfSlcbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVTZXJ2ZXJDbGllbnQiLCJjb29raWVzIiwiY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQiLCJjb29raWVTdG9yZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImdldCIsIm5hbWUiLCJ2YWx1ZSIsInNldCIsIm9wdGlvbnMiLCJyZW1vdmUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase-server.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/next","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/cookie","vendor-chunks/webidl-conversions"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson%2Froute&page=%2Fapi%2Fgenerate-lesson%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();
"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/generate-lesson/route";
exports.ids = ["app/api/generate-lesson/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson%2Froute&page=%2Fapi%2Fgenerate-lesson%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson%2Froute&page=%2Fapi%2Fgenerate-lesson%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_linguaspark_app_api_generate_lesson_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/generate-lesson/route.ts */ \"(rsc)/./app/api/generate-lesson/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/generate-lesson/route\",\n        pathname: \"/api/generate-lesson\",\n        filename: \"route\",\n        bundlePath: \"app/api/generate-lesson/route\"\n    },\n    resolvedPagePath: \"D:\\\\linguaspark\\\\app\\\\api\\\\generate-lesson\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_linguaspark_app_api_generate_lesson_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/generate-lesson/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZnZW5lcmF0ZS1sZXNzb24lMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmdlbmVyYXRlLWxlc3NvbiUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmdlbmVyYXRlLWxlc3NvbiUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDbGluZ3Vhc3BhcmslNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUQlM0ElNUNsaW5ndWFzcGFyayZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDSTtBQUNqRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvPzI3ZDQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxcbGluZ3Vhc3BhcmtcXFxcYXBwXFxcXGFwaVxcXFxnZW5lcmF0ZS1sZXNzb25cXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2dlbmVyYXRlLWxlc3Nvbi9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2dlbmVyYXRlLWxlc3NvblwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvZ2VuZXJhdGUtbGVzc29uL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRDpcXFxcbGluZ3Vhc3BhcmtcXFxcYXBwXFxcXGFwaVxcXFxnZW5lcmF0ZS1sZXNzb25cXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2dlbmVyYXRlLWxlc3Nvbi9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson%2Froute&page=%2Fapi%2Fgenerate-lesson%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/generate-lesson/route.ts":
/*!******************************************!*\
  !*** ./app/api/generate-lesson/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_lesson_ai_generator_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/lesson-ai-generator-server */ \"(rsc)/./lib/lesson-ai-generator-server.ts\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/supabase-server */ \"(rsc)/./lib/supabase-server.ts\");\n\n // Updated import to use server-side generator\n\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { sourceText, lessonType, studentLevel, targetLanguage, sourceUrl, contentMetadata, structuredContent, wordCount, readingTime } = body;\n        // Validate required fields\n        if (!sourceText || !lessonType || !studentLevel || !targetLanguage) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Missing required fields\"\n            }, {\n                status: 400\n            });\n        }\n        // Validate user authentication\n        const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__.createServerSupabaseClient)();\n        const { data: { user }, error: authError } = await supabase.auth.getUser();\n        if (authError || !user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Authentication required\"\n            }, {\n                status: 401\n            });\n        }\n        // Generate lesson using enhanced AI pipeline with contextual information\n        const lesson = await _lib_lesson_ai_generator_server__WEBPACK_IMPORTED_MODULE_1__.lessonAIServerGenerator.generateLesson({\n            sourceText,\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sourceUrl,\n            contentMetadata,\n            structuredContent,\n            wordCount,\n            readingTime\n        });\n        console.log(\"\\uD83C\\uDF93 Generated lesson structure:\", {\n            hasLesson: !!lesson,\n            hasSections: !!lesson?.sections,\n            sectionKeys: lesson?.sections ? Object.keys(lesson.sections) : [],\n            lessonType: lesson?.lessonType,\n            studentLevel: lesson?.studentLevel,\n            targetLanguage: lesson?.targetLanguage,\n            warmupQuestions: lesson?.sections?.warmup?.length || 0,\n            vocabularyItems: lesson?.sections?.vocabulary?.length || 0\n        });\n        // Check if we have a valid AI-generated lesson\n        if (lesson && lesson.sections && Object.keys(lesson.sections).length > 0) {\n            console.log(\"âœ… Using AI-generated lesson content\");\n            // Use AI-generated content with minimal fallbacks only for missing properties\n            const finalLesson = {\n                lessonType: lesson.lessonType || lessonType,\n                studentLevel: lesson.studentLevel || studentLevel,\n                targetLanguage: lesson.targetLanguage || targetLanguage,\n                sections: lesson.sections // Use AI-generated sections as-is\n            };\n            console.log(\"\\uD83C\\uDF89 Returning AI-generated lesson with sections:\", Object.keys(finalLesson.sections));\n            // Save and return the AI-generated lesson\n            const { data: savedLesson, error: saveError } = await supabase.from(\"lessons\").insert({\n                tutor_id: user.id,\n                title: `${lessonType} Lesson - ${new Date().toLocaleDateString()}`,\n                lesson_type: lessonType,\n                student_level: studentLevel,\n                target_language: targetLanguage,\n                source_url: sourceUrl,\n                source_text: sourceText,\n                lesson_data: finalLesson\n            }).select().single();\n            if (saveError) {\n                console.error(\"Error saving lesson:\", saveError);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    lesson: finalLesson\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                lesson: {\n                    ...finalLesson,\n                    id: savedLesson.id\n                }\n            });\n        }\n        // Only use fallback if AI generation completely failed\n        console.warn(\"âš ï¸ AI generation failed, using fallback lesson structure\");\n        const safeLesson = {\n            lessonType: lessonType,\n            studentLevel: studentLevel,\n            targetLanguage: targetLanguage,\n            sections: {\n                warmup: [\n                    \"What do you already know about this topic?\",\n                    \"Have you had similar experiences?\",\n                    \"What would you like to learn more about?\"\n                ],\n                vocabulary: [],\n                reading: sourceText.substring(0, 500),\n                comprehension: [\n                    \"What is the main idea of this text?\",\n                    \"What supporting details can you identify?\"\n                ],\n                discussion: [\n                    \"What is your opinion on this topic?\",\n                    \"How would you handle this situation?\"\n                ],\n                grammar: {\n                    focus: \"Present Perfect Tense\",\n                    examples: [\n                        \"I have learned many new things.\",\n                        \"She has improved her skills.\"\n                    ],\n                    exercise: [\n                        \"I _____ (learn) a lot today.\",\n                        \"They _____ (complete) the project.\"\n                    ]\n                },\n                pronunciation: {\n                    word: \"communication\",\n                    ipa: \"/kÉ™ËŒmjuËnÉªËˆkeÉªÊƒÉ™n/\",\n                    practice: \"Practice saying: communication in a sentence.\"\n                },\n                wrapup: [\n                    \"What new vocabulary did you learn?\",\n                    \"Which concepts need more practice?\"\n                ]\n            }\n        };\n        console.log(\"âœ… Using fallback lesson structure\");\n        // Save fallback lesson to database\n        const { data: savedLesson, error: saveError } = await supabase.from(\"lessons\").insert({\n            tutor_id: user.id,\n            title: `${lessonType} Lesson - ${new Date().toLocaleDateString()}`,\n            lesson_type: lessonType,\n            student_level: studentLevel,\n            target_language: targetLanguage,\n            source_url: sourceUrl,\n            source_text: sourceText,\n            lesson_data: safeLesson\n        }).select().single();\n        if (saveError) {\n            console.error(\"Error saving lesson:\", saveError);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                lesson: safeLesson\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            lesson: {\n                ...safeLesson,\n                id: savedLesson.id\n            }\n        });\n    } catch (error) {\n        console.error(\"Error generating lesson:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to generate lesson\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWF6QztZQUNiMEMsZUFBZXpDO1lBQ2YwQyxpQkFBaUJ6QztZQUNqQjBDLFlBQVl6QztZQUNaMEMsYUFBYTlDO1lBQ2IrQyxhQUFhSTtRQUNmLEdBQ0NILE1BQU0sR0FDTkMsTUFBTTtRQUVULElBQUlmLFdBQVc7WUFDYmYsUUFBUVYsS0FBSyxDQUFDLHdCQUF3QnlCO1lBQ3RDLE9BQU96QyxxREFBWUEsQ0FBQ00sSUFBSSxDQUFDO2dCQUFFa0IsUUFBUWtDO1lBQVc7UUFDaEQ7UUFFQSxPQUFPMUQscURBQVlBLENBQUNNLElBQUksQ0FBQztZQUN2QmtCLFFBQVE7Z0JBQ04sR0FBR2tDLFVBQVU7Z0JBQ2JiLElBQUlMLFlBQVlLLEVBQUU7WUFDcEI7UUFDRjtJQUNGLEVBQUUsT0FBTzdCLE9BQU87UUFDZFUsUUFBUVYsS0FBSyxDQUFDLDRCQUE0QkE7UUFDMUMsT0FBT2hCLHFEQUFZQSxDQUFDTSxJQUFJLENBQUM7WUFBRVUsT0FBTztRQUE0QixHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUNqRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktdjAtcHJvamVjdC8uL2FwcC9hcGkvZ2VuZXJhdGUtbGVzc29uL3JvdXRlLnRzPzVhYmYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdHlwZSBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCJcbmltcG9ydCB7IGxlc3NvbkFJU2VydmVyR2VuZXJhdG9yIH0gZnJvbSBcIkAvbGliL2xlc3Nvbi1haS1nZW5lcmF0b3Itc2VydmVyXCIgLy8gVXBkYXRlZCBpbXBvcnQgdG8gdXNlIHNlcnZlci1zaWRlIGdlbmVyYXRvclxuaW1wb3J0IHsgY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQgfSBmcm9tIFwiQC9saWIvc3VwYWJhc2Utc2VydmVyXCJcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICBjb25zdCB7IFxuICAgICAgc291cmNlVGV4dCwgXG4gICAgICBsZXNzb25UeXBlLCBcbiAgICAgIHN0dWRlbnRMZXZlbCwgXG4gICAgICB0YXJnZXRMYW5ndWFnZSwgXG4gICAgICBzb3VyY2VVcmwsXG4gICAgICBjb250ZW50TWV0YWRhdGEsXG4gICAgICBzdHJ1Y3R1cmVkQ29udGVudCxcbiAgICAgIHdvcmRDb3VudCxcbiAgICAgIHJlYWRpbmdUaW1lXG4gICAgfSA9IGJvZHlcblxuICAgIC8vIFZhbGlkYXRlIHJlcXVpcmVkIGZpZWxkc1xuICAgIGlmICghc291cmNlVGV4dCB8fCAhbGVzc29uVHlwZSB8fCAhc3R1ZGVudExldmVsIHx8ICF0YXJnZXRMYW5ndWFnZSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiTWlzc2luZyByZXF1aXJlZCBmaWVsZHNcIiB9LCB7IHN0YXR1czogNDAwIH0pXG4gICAgfVxuXG4gICAgLy8gVmFsaWRhdGUgdXNlciBhdXRoZW50aWNhdGlvblxuICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQoKVxuICAgIGNvbnN0IHtcbiAgICAgIGRhdGE6IHsgdXNlciB9LFxuICAgICAgZXJyb3I6IGF1dGhFcnJvcixcbiAgICB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKClcblxuICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIkF1dGhlbnRpY2F0aW9uIHJlcXVpcmVkXCIgfSwgeyBzdGF0dXM6IDQwMSB9KVxuICAgIH1cblxuICAgIC8vIEdlbmVyYXRlIGxlc3NvbiB1c2luZyBlbmhhbmNlZCBBSSBwaXBlbGluZSB3aXRoIGNvbnRleHR1YWwgaW5mb3JtYXRpb25cbiAgICBjb25zdCBsZXNzb24gPSBhd2FpdCBsZXNzb25BSVNlcnZlckdlbmVyYXRvci5nZW5lcmF0ZUxlc3Nvbih7XG4gICAgICBzb3VyY2VUZXh0LFxuICAgICAgbGVzc29uVHlwZSxcbiAgICAgIHN0dWRlbnRMZXZlbCxcbiAgICAgIHRhcmdldExhbmd1YWdlLFxuICAgICAgc291cmNlVXJsLFxuICAgICAgY29udGVudE1ldGFkYXRhLFxuICAgICAgc3RydWN0dXJlZENvbnRlbnQsXG4gICAgICB3b3JkQ291bnQsXG4gICAgICByZWFkaW5nVGltZSxcbiAgICB9KVxuXG4gICAgY29uc29sZS5sb2coXCLwn46TIEdlbmVyYXRlZCBsZXNzb24gc3RydWN0dXJlOlwiLCB7XG4gICAgICBoYXNMZXNzb246ICEhbGVzc29uLFxuICAgICAgaGFzU2VjdGlvbnM6ICEhbGVzc29uPy5zZWN0aW9ucyxcbiAgICAgIHNlY3Rpb25LZXlzOiBsZXNzb24/LnNlY3Rpb25zID8gT2JqZWN0LmtleXMobGVzc29uLnNlY3Rpb25zKSA6IFtdLFxuICAgICAgbGVzc29uVHlwZTogbGVzc29uPy5sZXNzb25UeXBlLFxuICAgICAgc3R1ZGVudExldmVsOiBsZXNzb24/LnN0dWRlbnRMZXZlbCxcbiAgICAgIHRhcmdldExhbmd1YWdlOiBsZXNzb24/LnRhcmdldExhbmd1YWdlLFxuICAgICAgd2FybXVwUXVlc3Rpb25zOiBsZXNzb24/LnNlY3Rpb25zPy53YXJtdXA/Lmxlbmd0aCB8fCAwLFxuICAgICAgdm9jYWJ1bGFyeUl0ZW1zOiBsZXNzb24/LnNlY3Rpb25zPy52b2NhYnVsYXJ5Py5sZW5ndGggfHwgMFxuICAgIH0pXG5cbiAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIGEgdmFsaWQgQUktZ2VuZXJhdGVkIGxlc3NvblxuICAgIGlmIChsZXNzb24gJiYgbGVzc29uLnNlY3Rpb25zICYmIE9iamVjdC5rZXlzKGxlc3Nvbi5zZWN0aW9ucykubGVuZ3RoID4gMCkge1xuICAgICAgY29uc29sZS5sb2coXCLinIUgVXNpbmcgQUktZ2VuZXJhdGVkIGxlc3NvbiBjb250ZW50XCIpXG4gICAgICBcbiAgICAgIC8vIFVzZSBBSS1nZW5lcmF0ZWQgY29udGVudCB3aXRoIG1pbmltYWwgZmFsbGJhY2tzIG9ubHkgZm9yIG1pc3NpbmcgcHJvcGVydGllc1xuICAgICAgY29uc3QgZmluYWxMZXNzb24gPSB7XG4gICAgICAgIGxlc3NvblR5cGU6IGxlc3Nvbi5sZXNzb25UeXBlIHx8IGxlc3NvblR5cGUsXG4gICAgICAgIHN0dWRlbnRMZXZlbDogbGVzc29uLnN0dWRlbnRMZXZlbCB8fCBzdHVkZW50TGV2ZWwsXG4gICAgICAgIHRhcmdldExhbmd1YWdlOiBsZXNzb24udGFyZ2V0TGFuZ3VhZ2UgfHwgdGFyZ2V0TGFuZ3VhZ2UsXG4gICAgICAgIHNlY3Rpb25zOiBsZXNzb24uc2VjdGlvbnMgLy8gVXNlIEFJLWdlbmVyYXRlZCBzZWN0aW9ucyBhcy1pc1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhcIvCfjokgUmV0dXJuaW5nIEFJLWdlbmVyYXRlZCBsZXNzb24gd2l0aCBzZWN0aW9uczpcIiwgT2JqZWN0LmtleXMoZmluYWxMZXNzb24uc2VjdGlvbnMpKVxuICAgICAgXG4gICAgICAvLyBTYXZlIGFuZCByZXR1cm4gdGhlIEFJLWdlbmVyYXRlZCBsZXNzb25cbiAgICAgIGNvbnN0IHsgZGF0YTogc2F2ZWRMZXNzb24sIGVycm9yOiBzYXZlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKFwibGVzc29uc1wiKVxuICAgICAgICAuaW5zZXJ0KHtcbiAgICAgICAgICB0dXRvcl9pZDogdXNlci5pZCxcbiAgICAgICAgICB0aXRsZTogYCR7bGVzc29uVHlwZX0gTGVzc29uIC0gJHtuZXcgRGF0ZSgpLnRvTG9jYWxlRGF0ZVN0cmluZygpfWAsXG4gICAgICAgICAgbGVzc29uX3R5cGU6IGxlc3NvblR5cGUsXG4gICAgICAgICAgc3R1ZGVudF9sZXZlbDogc3R1ZGVudExldmVsLFxuICAgICAgICAgIHRhcmdldF9sYW5ndWFnZTogdGFyZ2V0TGFuZ3VhZ2UsXG4gICAgICAgICAgc291cmNlX3VybDogc291cmNlVXJsLFxuICAgICAgICAgIHNvdXJjZV90ZXh0OiBzb3VyY2VUZXh0LFxuICAgICAgICAgIGxlc3Nvbl9kYXRhOiBmaW5hbExlc3NvbixcbiAgICAgICAgfSlcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKVxuXG4gICAgICBpZiAoc2F2ZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBzYXZpbmcgbGVzc29uOlwiLCBzYXZlRXJyb3IpXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGxlc3NvbjogZmluYWxMZXNzb24gfSlcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgbGVzc29uOiB7XG4gICAgICAgICAgLi4uZmluYWxMZXNzb24sXG4gICAgICAgICAgaWQ6IHNhdmVkTGVzc29uLmlkLFxuICAgICAgICB9LFxuICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyBPbmx5IHVzZSBmYWxsYmFjayBpZiBBSSBnZW5lcmF0aW9uIGNvbXBsZXRlbHkgZmFpbGVkXG4gICAgY29uc29sZS53YXJuKFwi4pqg77iPIEFJIGdlbmVyYXRpb24gZmFpbGVkLCB1c2luZyBmYWxsYmFjayBsZXNzb24gc3RydWN0dXJlXCIpXG4gICAgY29uc3Qgc2FmZUxlc3NvbiA9IHtcbiAgICAgIGxlc3NvblR5cGU6IGxlc3NvblR5cGUsXG4gICAgICBzdHVkZW50TGV2ZWw6IHN0dWRlbnRMZXZlbCxcbiAgICAgIHRhcmdldExhbmd1YWdlOiB0YXJnZXRMYW5ndWFnZSxcbiAgICAgIHNlY3Rpb25zOiB7XG4gICAgICAgIHdhcm11cDogW1wiV2hhdCBkbyB5b3UgYWxyZWFkeSBrbm93IGFib3V0IHRoaXMgdG9waWM/XCIsIFwiSGF2ZSB5b3UgaGFkIHNpbWlsYXIgZXhwZXJpZW5jZXM/XCIsIFwiV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBsZWFybiBtb3JlIGFib3V0P1wiXSxcbiAgICAgICAgdm9jYWJ1bGFyeTogW10sXG4gICAgICAgIHJlYWRpbmc6IHNvdXJjZVRleHQuc3Vic3RyaW5nKDAsIDUwMCksXG4gICAgICAgIGNvbXByZWhlbnNpb246IFtcIldoYXQgaXMgdGhlIG1haW4gaWRlYSBvZiB0aGlzIHRleHQ/XCIsIFwiV2hhdCBzdXBwb3J0aW5nIGRldGFpbHMgY2FuIHlvdSBpZGVudGlmeT9cIl0sXG4gICAgICAgIGRpc2N1c3Npb246IFtcIldoYXQgaXMgeW91ciBvcGluaW9uIG9uIHRoaXMgdG9waWM/XCIsIFwiSG93IHdvdWxkIHlvdSBoYW5kbGUgdGhpcyBzaXR1YXRpb24/XCJdLFxuICAgICAgICBncmFtbWFyOiB7XG4gICAgICAgICAgZm9jdXM6IFwiUHJlc2VudCBQZXJmZWN0IFRlbnNlXCIsXG4gICAgICAgICAgZXhhbXBsZXM6IFtcIkkgaGF2ZSBsZWFybmVkIG1hbnkgbmV3IHRoaW5ncy5cIiwgXCJTaGUgaGFzIGltcHJvdmVkIGhlciBza2lsbHMuXCJdLFxuICAgICAgICAgIGV4ZXJjaXNlOiBbXCJJIF9fX19fIChsZWFybikgYSBsb3QgdG9kYXkuXCIsIFwiVGhleSBfX19fXyAoY29tcGxldGUpIHRoZSBwcm9qZWN0LlwiXVxuICAgICAgICB9LFxuICAgICAgICBwcm9udW5jaWF0aW9uOiB7XG4gICAgICAgICAgd29yZDogXCJjb21tdW5pY2F0aW9uXCIsXG4gICAgICAgICAgaXBhOiBcIi9ryZnLjG1qdcuQbsmqy4hrZcmqyoPJmW4vXCIsXG4gICAgICAgICAgcHJhY3RpY2U6IFwiUHJhY3RpY2Ugc2F5aW5nOiBjb21tdW5pY2F0aW9uIGluIGEgc2VudGVuY2UuXCJcbiAgICAgICAgfSxcbiAgICAgICAgd3JhcHVwOiBbXCJXaGF0IG5ldyB2b2NhYnVsYXJ5IGRpZCB5b3UgbGVhcm4/XCIsIFwiV2hpY2ggY29uY2VwdHMgbmVlZCBtb3JlIHByYWN0aWNlP1wiXVxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKFwi4pyFIFVzaW5nIGZhbGxiYWNrIGxlc3NvbiBzdHJ1Y3R1cmVcIilcblxuICAgIC8vIFNhdmUgZmFsbGJhY2sgbGVzc29uIHRvIGRhdGFiYXNlXG4gICAgY29uc3QgeyBkYXRhOiBzYXZlZExlc3NvbiwgZXJyb3I6IHNhdmVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKFwibGVzc29uc1wiKVxuICAgICAgLmluc2VydCh7XG4gICAgICAgIHR1dG9yX2lkOiB1c2VyLmlkLFxuICAgICAgICB0aXRsZTogYCR7bGVzc29uVHlwZX0gTGVzc29uIC0gJHtuZXcgRGF0ZSgpLnRvTG9jYWxlRGF0ZVN0cmluZygpfWAsXG4gICAgICAgIGxlc3Nvbl90eXBlOiBsZXNzb25UeXBlLFxuICAgICAgICBzdHVkZW50X2xldmVsOiBzdHVkZW50TGV2ZWwsXG4gICAgICAgIHRhcmdldF9sYW5ndWFnZTogdGFyZ2V0TGFuZ3VhZ2UsXG4gICAgICAgIHNvdXJjZV91cmw6IHNvdXJjZVVybCxcbiAgICAgICAgc291cmNlX3RleHQ6IHNvdXJjZVRleHQsXG4gICAgICAgIGxlc3Nvbl9kYXRhOiBzYWZlTGVzc29uLFxuICAgICAgfSlcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoc2F2ZUVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc2F2aW5nIGxlc3NvbjpcIiwgc2F2ZUVycm9yKVxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgbGVzc29uOiBzYWZlTGVzc29uIH0pXG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIGxlc3Nvbjoge1xuICAgICAgICAuLi5zYWZlTGVzc29uLFxuICAgICAgICBpZDogc2F2ZWRMZXNzb24uaWQsXG4gICAgICB9LFxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGdlbmVyYXRpbmcgbGVzc29uOlwiLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJGYWlsZWQgdG8gZ2VuZXJhdGUgbGVzc29uXCIgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwibGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3IiLCJjcmVhdGVTZXJ2ZXJTdXBhYmFzZUNsaWVudCIsIlBPU1QiLCJyZXF1ZXN0IiwiYm9keSIsImpzb24iLCJzb3VyY2VUZXh0IiwibGVzc29uVHlwZSIsInN0dWRlbnRMZXZlbCIsInRhcmdldExhbmd1YWdlIiwic291cmNlVXJsIiwiY29udGVudE1ldGFkYXRhIiwic3RydWN0dXJlZENvbnRlbnQiLCJ3b3JkQ291bnQiLCJyZWFkaW5nVGltZSIsImVycm9yIiwic3RhdHVzIiwic3VwYWJhc2UiLCJkYXRhIiwidXNlciIsImF1dGhFcnJvciIsImF1dGgiLCJnZXRVc2VyIiwibGVzc29uIiwiZ2VuZXJhdGVMZXNzb24iLCJjb25zb2xlIiwibG9nIiwiaGFzTGVzc29uIiwiaGFzU2VjdGlvbnMiLCJzZWN0aW9ucyIsInNlY3Rpb25LZXlzIiwiT2JqZWN0Iiwia2V5cyIsIndhcm11cFF1ZXN0aW9ucyIsIndhcm11cCIsImxlbmd0aCIsInZvY2FidWxhcnlJdGVtcyIsInZvY2FidWxhcnkiLCJmaW5hbExlc3NvbiIsInNhdmVkTGVzc29uIiwic2F2ZUVycm9yIiwiZnJvbSIsImluc2VydCIsInR1dG9yX2lkIiwiaWQiLCJ0aXRsZSIsIkRhdGUiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJsZXNzb25fdHlwZSIsInN0dWRlbnRfbGV2ZWwiLCJ0YXJnZXRfbGFuZ3VhZ2UiLCJzb3VyY2VfdXJsIiwic291cmNlX3RleHQiLCJsZXNzb25fZGF0YSIsInNlbGVjdCIsInNpbmdsZSIsIndhcm4iLCJzYWZlTGVzc29uIiwicmVhZGluZyIsInN1YnN0cmluZyIsImNvbXByZWhlbnNpb24iLCJkaXNjdXNzaW9uIiwiZ3JhbW1hciIsImZvY3VzIiwiZXhhbXBsZXMiLCJleGVyY2lzZSIsInByb251bmNpYXRpb24iLCJ3b3JkIiwiaXBhIiwicHJhY3RpY2UiLCJ3cmFwdXAiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/generate-lesson/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/google-ai-server.ts":
/*!*********************************!*\
  !*** ./lib/google-ai-server.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createGoogleAIServerService: () => (/* binding */ createGoogleAIServerService)\n/* harmony export */ });\n// Server-side Google AI (Gemini) APIs service layer\nclass GoogleAIServerService {\n    constructor(config){\n        this.model = \"models/gemini-2.5-flash\" // Use actual available model\n        ;\n        this.config = config;\n    }\n    async makeGeminiRequest(prompt, options = {}) {\n        // Use only the working model\n        const modelsToTry = [\n            \"models/gemini-2.5-flash\"\n        ];\n        const possibleUrls = [];\n        // Generate URLs for different combinations\n        for (const model of modelsToTry){\n            possibleUrls.push(`${this.config.baseUrl}/v1beta/models/${model}:generateContent?key=${this.config.apiKey}`);\n            possibleUrls.push(`${this.config.baseUrl}/v1/models/${model}:generateContent?key=${this.config.apiKey}`);\n        }\n        const requestBody = {\n            contents: [\n                {\n                    parts: [\n                        {\n                            text: prompt\n                        }\n                    ]\n                }\n            ],\n            generationConfig: {\n                temperature: options.temperature || 0.7,\n                maxOutputTokens: options.maxTokens || 2000,\n                topP: options.topP || 0.9\n            }\n        };\n        console.log(\"\\uD83D\\uDD17 Using working Gemini API endpoint...\");\n        // Use only the working endpoint\n        const url = `${this.config.baseUrl}/v1beta/models/gemini-2.5-flash:generateContent?key=${this.config.apiKey}`;\n        console.log(`ðŸŒ API URL: ${url.replace(this.config.apiKey, \"API_KEY_HIDDEN\")}`);\n        try {\n            const response = await fetch(url, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(requestBody)\n            });\n            console.log(`ðŸ“¡ Response status: ${response.status} ${response.statusText}`);\n            if (response.ok) {\n                const result = await response.json();\n                console.log(\"âœ… Successful API response received\");\n                console.log(\"\\uD83D\\uDD0D Full API response structure:\", JSON.stringify(result, null, 2));\n                // More robust response parsing with MAX_TOKENS handling\n                if (result.candidates && result.candidates.length > 0) {\n                    const candidate = result.candidates[0];\n                    // Check if we hit MAX_TOKENS limit\n                    if (candidate.finishReason === \"MAX_TOKENS\") {\n                        console.warn(\"âš ï¸ Hit MAX_TOKENS limit, response may be incomplete\");\n                        // Still try to extract partial content if available\n                        if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {\n                            const text = candidate.content.parts[0].text;\n                            console.log(\"âš ï¸ Extracted partial text due to MAX_TOKENS:\", text.substring(0, 100) + \"...\");\n                            return text;\n                        } else {\n                            console.warn(\"âŒ MAX_TOKENS hit and no content available\");\n                            throw new Error(\"API response hit token limit with no usable content\");\n                        }\n                    }\n                    // Normal response processing\n                    if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {\n                        const text = candidate.content.parts[0].text;\n                        console.log(\"âœ… Extracted text:\", text);\n                        return text;\n                    } else {\n                        console.warn(\"âš ï¸ Invalid content structure in candidate:\", candidate);\n                        throw new Error(\"Invalid content structure in API response\");\n                    }\n                } else {\n                    console.warn(\"âš ï¸ No candidates in response:\", result);\n                    throw new Error(\"No candidates in API response\");\n                }\n            } else {\n                const errorText = await response.text();\n                console.error(`âŒ API call failed:`, response.status, errorText);\n                throw new Error(`Gemini API error: ${response.status} ${response.statusText} - ${errorText}`);\n            }\n        } catch (error) {\n            console.error(`âŒ API call exception:`, error.message);\n            throw error;\n        }\n    }\n    async summarize(text, options = {}) {\n        const summaryType = options.type || \"key-points\";\n        const length = options.length || \"medium\";\n        const lengthInstructions = {\n            short: \"in 2-3 sentences\",\n            medium: \"in 4-6 sentences\",\n            long: \"in 7-10 sentences\"\n        };\n        const typeInstructions = {\n            \"key-points\": \"Extract and summarize the key points\",\n            \"tl-dr\": \"Create a TL;DR summary\",\n            \"teaser\": \"Write an engaging teaser summary\",\n            \"headline\": \"Create a headline-style summary\"\n        };\n        const prompt = `${typeInstructions[summaryType]} of the following text ${lengthInstructions[length]}:\n\n${text}\n\nSummary:`;\n        try {\n            return await this.makeGeminiRequest(prompt, {\n                temperature: 0.3\n            });\n        } catch (error) {\n            console.error(\"Summarization failed:\", error);\n            // Fallback to simple truncation\n            return text.substring(0, 500) + \"...\";\n        }\n    }\n    async translate(text, options) {\n        const targetLang = this.getLanguageName(options.targetLanguage);\n        const prompt = `Translate the following text to ${targetLang}. Maintain the original meaning and tone:\n\n${text}\n\nTranslation:`;\n        try {\n            return await this.makeGeminiRequest(prompt, {\n                temperature: 0.2\n            });\n        } catch (error) {\n            console.error(\"Translation failed:\", error);\n            // Return original text if translation fails\n            return text;\n        }\n    }\n    async prompt(prompt, options = {}) {\n        try {\n            return await this.makeGeminiRequest(prompt, options);\n        } catch (error) {\n            console.error(\"Prompt generation failed:\", error);\n            throw error;\n        }\n    }\n    async write(prompt, options = {}) {\n        const tone = options.tone || \"casual\";\n        const length = options.length || \"medium\";\n        const format = options.format || \"paragraph\";\n        const lengthInstructions = {\n            short: \"Keep it brief and concise\",\n            medium: \"Write a moderate length response\",\n            long: \"Provide a detailed and comprehensive response\"\n        };\n        const formatInstructions = {\n            paragraph: \"Write in paragraph form\",\n            \"bullet-points\": \"Format as bullet points\",\n            \"numbered-list\": \"Format as a numbered list\"\n        };\n        const enhancedPrompt = `${prompt}\n\nInstructions:\n- Tone: ${tone}\n- ${lengthInstructions[length]}\n- ${formatInstructions[format]}\n\nResponse:`;\n        try {\n            return await this.makeGeminiRequest(enhancedPrompt, {\n                temperature: 0.7\n            });\n        } catch (error) {\n            console.error(\"Writing failed:\", error);\n            throw error;\n        }\n    }\n    async rewrite(text, options = {}) {\n        const tone = options.tone || \"casual\";\n        const length = options.length || \"same\";\n        const audience = options.audience || \"general\";\n        const lengthInstructions = {\n            shorter: \"Make it more concise\",\n            longer: \"Expand and add more detail\",\n            same: \"Keep approximately the same length\"\n        };\n        const prompt = `Rewrite the following text with these requirements:\n- Tone: ${tone}\n- Audience: ${audience}\n- Length: ${lengthInstructions[length]}\n\nOriginal text:\n${text}\n\nRewritten text:`;\n        try {\n            return await this.makeGeminiRequest(prompt, {\n                temperature: 0.5\n            });\n        } catch (error) {\n            console.error(\"Rewriting failed:\", error);\n            return text // Return original if rewriting fails\n            ;\n        }\n    }\n    async proofread(text, options = {}) {\n        const checkGrammar = options.checkGrammar !== false;\n        const checkSpelling = options.checkSpelling !== false;\n        const checkStyle = options.checkStyle !== false;\n        const checks = [];\n        if (checkGrammar) checks.push(\"grammar\");\n        if (checkSpelling) checks.push(\"spelling\");\n        if (checkStyle) checks.push(\"style and clarity\");\n        const prompt = `Proofread and correct the following text for ${checks.join(\", \")}. Return only the corrected text:\n\n${text}\n\nCorrected text:`;\n        try {\n            const correctedText = await this.makeGeminiRequest(prompt, {\n                temperature: 0.2\n            });\n            return {\n                corrected_text: correctedText,\n                suggestions: [],\n                errors: []\n            };\n        } catch (error) {\n            console.error(\"Proofreading failed:\", error);\n            return {\n                corrected_text: text,\n                suggestions: [],\n                errors: []\n            };\n        }\n    }\n    getLanguageName(code) {\n        const languageMap = {\n            es: \"Spanish\",\n            fr: \"French\",\n            de: \"German\",\n            it: \"Italian\",\n            pt: \"Portuguese\",\n            ja: \"Japanese\",\n            ko: \"Korean\",\n            zh: \"Chinese\",\n            en: \"English\"\n        };\n        return languageMap[code] || \"English\";\n    }\n}\n// Server-side only initialization\nconst createGoogleAIServerService = ()=>{\n    const apiKey = \"AIzaSyAkDCpwWTPKYftoc1Fdm77P6B00Lj89Lio\";\n    const baseUrl = \"https://generativelanguage.googleapis.com\" || 0;\n    if (!apiKey) {\n        console.warn(\"Google AI API key not found. Lesson generation will use fallback templates.\");\n        // Return a service that will always throw errors, triggering fallbacks\n        return new GoogleAIServerService({\n            apiKey: \"dummy\",\n            baseUrl\n        });\n    }\n    return new GoogleAIServerService({\n        apiKey,\n        baseUrl\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O1lBQ1o7UUFDRjtJQUNGO0lBRVF0QixnQkFBZ0J1QixJQUFZLEVBQVU7UUFDNUMsTUFBTUMsY0FBYztZQUNsQkMsSUFBSTtZQUNKQyxJQUFJO1lBQ0pDLElBQUk7WUFDSkMsSUFBSTtZQUNKQyxJQUFJO1lBQ0pDLElBQUk7WUFDSkMsSUFBSTtZQUNKQyxJQUFJO1lBQ0pDLElBQUk7UUFDTjtRQUNBLE9BQU9ULFdBQVcsQ0FBQ0QsS0FBSyxJQUFJO0lBQzlCO0FBQ0Y7QUFFQSxrQ0FBa0M7QUFDM0IsTUFBTVcsOEJBQThCO0lBQ3pDLE1BQU1qRixTQUFTa0YseUNBQXlDO0lBQ3hELE1BQU1uRixVQUFVbUYsMkNBQTBDLElBQUksQ0FBMkM7SUFFekcsSUFBSSxDQUFDbEYsUUFBUTtRQUNYVSxRQUFRb0IsSUFBSSxDQUFDO1FBQ2IsdUVBQXVFO1FBQ3ZFLE9BQU8sSUFBSXpDLHNCQUFzQjtZQUFFVyxRQUFRO1lBQVNEO1FBQVE7SUFDOUQ7SUFFQSxPQUFPLElBQUlWLHNCQUFzQjtRQUFFVztRQUFRRDtJQUFRO0FBQ3JELEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL2dvb2dsZS1haS1zZXJ2ZXIudHM/NTJkNiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTZXJ2ZXItc2lkZSBHb29nbGUgQUkgKEdlbWluaSkgQVBJcyBzZXJ2aWNlIGxheWVyXG5pbnRlcmZhY2UgR29vZ2xlQUlDb25maWcge1xuICBhcGlLZXk6IHN0cmluZ1xuICBiYXNlVXJsOiBzdHJpbmdcbn1cblxuaW50ZXJmYWNlIFN1bW1hcml6ZXJPcHRpb25zIHtcbiAgdHlwZT86IFwia2V5LXBvaW50c1wiIHwgXCJ0bC1kclwiIHwgXCJ0ZWFzZXJcIiB8IFwiaGVhZGxpbmVcIlxuICBsZW5ndGg/OiBcInNob3J0XCIgfCBcIm1lZGl1bVwiIHwgXCJsb25nXCJcbiAgZm9ybWF0PzogXCJtYXJrZG93blwiIHwgXCJwbGFpbi10ZXh0XCJcbn1cblxuaW50ZXJmYWNlIFRyYW5zbGF0b3JPcHRpb25zIHtcbiAgc291cmNlTGFuZ3VhZ2U/OiBzdHJpbmdcbiAgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgUHJvbXB0T3B0aW9ucyB7XG4gIHRlbXBlcmF0dXJlPzogbnVtYmVyXG4gIG1heFRva2Vucz86IG51bWJlclxuICB0b3BQPzogbnVtYmVyXG59XG5cbmludGVyZmFjZSBXcml0ZXJPcHRpb25zIHtcbiAgdG9uZT86IFwiZm9ybWFsXCIgfCBcImNhc3VhbFwiIHwgXCJhY2FkZW1pY1wiIHwgXCJjcmVhdGl2ZVwiXG4gIGxlbmd0aD86IFwic2hvcnRcIiB8IFwibWVkaXVtXCIgfCBcImxvbmdcIlxuICBmb3JtYXQ/OiBcInBhcmFncmFwaFwiIHwgXCJidWxsZXQtcG9pbnRzXCIgfCBcIm51bWJlcmVkLWxpc3RcIlxufVxuXG5pbnRlcmZhY2UgUmV3cml0ZXJPcHRpb25zIHtcbiAgdG9uZT86IFwiZm9ybWFsXCIgfCBcImNhc3VhbFwiIHwgXCJhY2FkZW1pY1wiIHwgXCJjcmVhdGl2ZVwiXG4gIGxlbmd0aD86IFwic2hvcnRlclwiIHwgXCJsb25nZXJcIiB8IFwic2FtZVwiXG4gIGF1ZGllbmNlPzogXCJnZW5lcmFsXCIgfCBcImV4cGVydFwiIHwgXCJiZWdpbm5lclwiXG59XG5cbmludGVyZmFjZSBQcm9vZnJlYWRlck9wdGlvbnMge1xuICBjaGVja0dyYW1tYXI/OiBib29sZWFuXG4gIGNoZWNrU3BlbGxpbmc/OiBib29sZWFuXG4gIGNoZWNrU3R5bGU/OiBib29sZWFuXG4gIHN1Z2dlc3RJbXByb3ZlbWVudHM/OiBib29sZWFuXG59XG5cbmNsYXNzIEdvb2dsZUFJU2VydmVyU2VydmljZSB7XG4gIHByaXZhdGUgY29uZmlnOiBHb29nbGVBSUNvbmZpZ1xuICBwcml2YXRlIG1vZGVsOiBzdHJpbmcgPSBcIm1vZGVscy9nZW1pbmktMi41LWZsYXNoXCIgLy8gVXNlIGFjdHVhbCBhdmFpbGFibGUgbW9kZWxcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IEdvb2dsZUFJQ29uZmlnKSB7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWdcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgbWFrZUdlbWluaVJlcXVlc3QocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM6IGFueSA9IHt9KSB7XG4gICAgLy8gVXNlIG9ubHkgdGhlIHdvcmtpbmcgbW9kZWxcbiAgICBjb25zdCBtb2RlbHNUb1RyeSA9IFtcbiAgICAgICdtb2RlbHMvZ2VtaW5pLTIuNS1mbGFzaCdcbiAgICBdXG4gICAgXG4gICAgY29uc3QgcG9zc2libGVVcmxzID0gW11cbiAgICBcbiAgICAvLyBHZW5lcmF0ZSBVUkxzIGZvciBkaWZmZXJlbnQgY29tYmluYXRpb25zXG4gICAgZm9yIChjb25zdCBtb2RlbCBvZiBtb2RlbHNUb1RyeSkge1xuICAgICAgcG9zc2libGVVcmxzLnB1c2goYCR7dGhpcy5jb25maWcuYmFzZVVybH0vdjFiZXRhL21vZGVscy8ke21vZGVsfTpnZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7dGhpcy5jb25maWcuYXBpS2V5fWApXG4gICAgICBwb3NzaWJsZVVybHMucHVzaChgJHt0aGlzLmNvbmZpZy5iYXNlVXJsfS92MS9tb2RlbHMvJHttb2RlbH06Z2VuZXJhdGVDb250ZW50P2tleT0ke3RoaXMuY29uZmlnLmFwaUtleX1gKVxuICAgIH1cbiAgICBcbiAgICBjb25zdCByZXF1ZXN0Qm9keSA9IHtcbiAgICAgIGNvbnRlbnRzOiBbe1xuICAgICAgICBwYXJ0czogW3tcbiAgICAgICAgICB0ZXh0OiBwcm9tcHRcbiAgICAgICAgfV1cbiAgICAgIH1dLFxuICAgICAgZ2VuZXJhdGlvbkNvbmZpZzoge1xuICAgICAgICB0ZW1wZXJhdHVyZTogb3B0aW9ucy50ZW1wZXJhdHVyZSB8fCAwLjcsXG4gICAgICAgIG1heE91dHB1dFRva2Vuczogb3B0aW9ucy5tYXhUb2tlbnMgfHwgMjAwMCwgLy8gSW5jcmVhc2VkIGZyb20gMTAwMCB0byAyMDAwXG4gICAgICAgIHRvcFA6IG9wdGlvbnMudG9wUCB8fCAwLjksXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coXCLwn5SXIFVzaW5nIHdvcmtpbmcgR2VtaW5pIEFQSSBlbmRwb2ludC4uLlwiKVxuXG4gICAgLy8gVXNlIG9ubHkgdGhlIHdvcmtpbmcgZW5kcG9pbnRcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmNvbmZpZy5iYXNlVXJsfS92MWJldGEvbW9kZWxzL2dlbWluaS0yLjUtZmxhc2g6Z2VuZXJhdGVDb250ZW50P2tleT0ke3RoaXMuY29uZmlnLmFwaUtleX1gXG4gICAgY29uc29sZS5sb2coYPCfjJAgQVBJIFVSTDogJHt1cmwucmVwbGFjZSh0aGlzLmNvbmZpZy5hcGlLZXksICdBUElfS0VZX0hJRERFTicpfWApXG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpLFxuICAgICAgfSlcblxuICAgICAgY29uc29sZS5sb2coYPCfk6EgUmVzcG9uc2Ugc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApXG5cbiAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgICAgY29uc29sZS5sb2coXCLinIUgU3VjY2Vzc2Z1bCBBUEkgcmVzcG9uc2UgcmVjZWl2ZWRcIilcbiAgICAgICAgY29uc29sZS5sb2coXCLwn5SNIEZ1bGwgQVBJIHJlc3BvbnNlIHN0cnVjdHVyZTpcIiwgSlNPTi5zdHJpbmdpZnkocmVzdWx0LCBudWxsLCAyKSlcbiAgICAgICAgXG4gICAgICAgIC8vIE1vcmUgcm9idXN0IHJlc3BvbnNlIHBhcnNpbmcgd2l0aCBNQVhfVE9LRU5TIGhhbmRsaW5nXG4gICAgICAgIGlmIChyZXN1bHQuY2FuZGlkYXRlcyAmJiByZXN1bHQuY2FuZGlkYXRlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc3QgY2FuZGlkYXRlID0gcmVzdWx0LmNhbmRpZGF0ZXNbMF1cbiAgICAgICAgICBcbiAgICAgICAgICAvLyBDaGVjayBpZiB3ZSBoaXQgTUFYX1RPS0VOUyBsaW1pdFxuICAgICAgICAgIGlmIChjYW5kaWRhdGUuZmluaXNoUmVhc29uID09PSBcIk1BWF9UT0tFTlNcIikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEhpdCBNQVhfVE9LRU5TIGxpbWl0LCByZXNwb25zZSBtYXkgYmUgaW5jb21wbGV0ZVwiKVxuICAgICAgICAgICAgLy8gU3RpbGwgdHJ5IHRvIGV4dHJhY3QgcGFydGlhbCBjb250ZW50IGlmIGF2YWlsYWJsZVxuICAgICAgICAgICAgaWYgKGNhbmRpZGF0ZS5jb250ZW50ICYmIGNhbmRpZGF0ZS5jb250ZW50LnBhcnRzICYmIGNhbmRpZGF0ZS5jb250ZW50LnBhcnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGNhbmRpZGF0ZS5jb250ZW50LnBhcnRzWzBdLnRleHRcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLimqDvuI8gRXh0cmFjdGVkIHBhcnRpYWwgdGV4dCBkdWUgdG8gTUFYX1RPS0VOUzpcIiwgdGV4dC5zdWJzdHJpbmcoMCwgMTAwKSArIFwiLi4uXCIpXG4gICAgICAgICAgICAgIHJldHVybiB0ZXh0XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCLinYwgTUFYX1RPS0VOUyBoaXQgYW5kIG5vIGNvbnRlbnQgYXZhaWxhYmxlXCIpXG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFQSSByZXNwb25zZSBoaXQgdG9rZW4gbGltaXQgd2l0aCBubyB1c2FibGUgY29udGVudFwiKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICAvLyBOb3JtYWwgcmVzcG9uc2UgcHJvY2Vzc2luZ1xuICAgICAgICAgIGlmIChjYW5kaWRhdGUuY29udGVudCAmJiBjYW5kaWRhdGUuY29udGVudC5wYXJ0cyAmJiBjYW5kaWRhdGUuY29udGVudC5wYXJ0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gY2FuZGlkYXRlLmNvbnRlbnQucGFydHNbMF0udGV4dFxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLinIUgRXh0cmFjdGVkIHRleHQ6XCIsIHRleHQpXG4gICAgICAgICAgICByZXR1cm4gdGV4dFxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCLimqDvuI8gSW52YWxpZCBjb250ZW50IHN0cnVjdHVyZSBpbiBjYW5kaWRhdGU6XCIsIGNhbmRpZGF0ZSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgY29udGVudCBzdHJ1Y3R1cmUgaW4gQVBJIHJlc3BvbnNlXCIpXG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBObyBjYW5kaWRhdGVzIGluIHJlc3BvbnNlOlwiLCByZXN1bHQpXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gY2FuZGlkYXRlcyBpbiBBUEkgcmVzcG9uc2VcIilcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgZXJyb3JUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBBUEkgY2FsbCBmYWlsZWQ6YCwgcmVzcG9uc2Uuc3RhdHVzLCBlcnJvclRleHQpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgR2VtaW5pIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH0gLSAke2Vycm9yVGV4dH1gKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGDinYwgQVBJIGNhbGwgZXhjZXB0aW9uOmAsIGVycm9yLm1lc3NhZ2UpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHN1bW1hcml6ZSh0ZXh0OiBzdHJpbmcsIG9wdGlvbnM6IFN1bW1hcml6ZXJPcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBzdW1tYXJ5VHlwZSA9IG9wdGlvbnMudHlwZSB8fCBcImtleS1wb2ludHNcIlxuICAgIGNvbnN0IGxlbmd0aCA9IG9wdGlvbnMubGVuZ3RoIHx8IFwibWVkaXVtXCJcbiAgICBcbiAgICBjb25zdCBsZW5ndGhJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBzaG9ydDogXCJpbiAyLTMgc2VudGVuY2VzXCIsXG4gICAgICBtZWRpdW06IFwiaW4gNC02IHNlbnRlbmNlc1wiLCBcbiAgICAgIGxvbmc6IFwiaW4gNy0xMCBzZW50ZW5jZXNcIlxuICAgIH1cblxuICAgIGNvbnN0IHR5cGVJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBcImtleS1wb2ludHNcIjogXCJFeHRyYWN0IGFuZCBzdW1tYXJpemUgdGhlIGtleSBwb2ludHNcIixcbiAgICAgIFwidGwtZHJcIjogXCJDcmVhdGUgYSBUTDtEUiBzdW1tYXJ5XCIsXG4gICAgICBcInRlYXNlclwiOiBcIldyaXRlIGFuIGVuZ2FnaW5nIHRlYXNlciBzdW1tYXJ5XCIsXG4gICAgICBcImhlYWRsaW5lXCI6IFwiQ3JlYXRlIGEgaGVhZGxpbmUtc3R5bGUgc3VtbWFyeVwiXG4gICAgfVxuXG4gICAgY29uc3QgcHJvbXB0ID0gYCR7dHlwZUluc3RydWN0aW9uc1tzdW1tYXJ5VHlwZV19IG9mIHRoZSBmb2xsb3dpbmcgdGV4dCAke2xlbmd0aEluc3RydWN0aW9uc1tsZW5ndGhdfTpcblxuJHt0ZXh0fVxuXG5TdW1tYXJ5OmBcblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYWtlR2VtaW5pUmVxdWVzdChwcm9tcHQsIHsgdGVtcGVyYXR1cmU6IDAuMyB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiU3VtbWFyaXphdGlvbiBmYWlsZWQ6XCIsIGVycm9yKVxuICAgICAgLy8gRmFsbGJhY2sgdG8gc2ltcGxlIHRydW5jYXRpb25cbiAgICAgIHJldHVybiB0ZXh0LnN1YnN0cmluZygwLCA1MDApICsgXCIuLi5cIlxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHRyYW5zbGF0ZSh0ZXh0OiBzdHJpbmcsIG9wdGlvbnM6IFRyYW5zbGF0b3JPcHRpb25zKSB7XG4gICAgY29uc3QgdGFyZ2V0TGFuZyA9IHRoaXMuZ2V0TGFuZ3VhZ2VOYW1lKG9wdGlvbnMudGFyZ2V0TGFuZ3VhZ2UpXG4gICAgXG4gICAgY29uc3QgcHJvbXB0ID0gYFRyYW5zbGF0ZSB0aGUgZm9sbG93aW5nIHRleHQgdG8gJHt0YXJnZXRMYW5nfS4gTWFpbnRhaW4gdGhlIG9yaWdpbmFsIG1lYW5pbmcgYW5kIHRvbmU6XG5cbiR7dGV4dH1cblxuVHJhbnNsYXRpb246YFxuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLm1ha2VHZW1pbmlSZXF1ZXN0KHByb21wdCwgeyB0ZW1wZXJhdHVyZTogMC4yIH0pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJUcmFuc2xhdGlvbiBmYWlsZWQ6XCIsIGVycm9yKVxuICAgICAgLy8gUmV0dXJuIG9yaWdpbmFsIHRleHQgaWYgdHJhbnNsYXRpb24gZmFpbHNcbiAgICAgIHJldHVybiB0ZXh0XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcHJvbXB0KHByb21wdDogc3RyaW5nLCBvcHRpb25zOiBQcm9tcHRPcHRpb25zID0ge30pIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMubWFrZUdlbWluaVJlcXVlc3QocHJvbXB0LCBvcHRpb25zKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiUHJvbXB0IGdlbmVyYXRpb24gZmFpbGVkOlwiLCBlcnJvcilcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgd3JpdGUocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM6IFdyaXRlck9wdGlvbnMgPSB7fSkge1xuICAgIGNvbnN0IHRvbmUgPSBvcHRpb25zLnRvbmUgfHwgXCJjYXN1YWxcIlxuICAgIGNvbnN0IGxlbmd0aCA9IG9wdGlvbnMubGVuZ3RoIHx8IFwibWVkaXVtXCJcbiAgICBjb25zdCBmb3JtYXQgPSBvcHRpb25zLmZvcm1hdCB8fCBcInBhcmFncmFwaFwiXG5cbiAgICBjb25zdCBsZW5ndGhJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBzaG9ydDogXCJLZWVwIGl0IGJyaWVmIGFuZCBjb25jaXNlXCIsXG4gICAgICBtZWRpdW06IFwiV3JpdGUgYSBtb2RlcmF0ZSBsZW5ndGggcmVzcG9uc2VcIixcbiAgICAgIGxvbmc6IFwiUHJvdmlkZSBhIGRldGFpbGVkIGFuZCBjb21wcmVoZW5zaXZlIHJlc3BvbnNlXCJcbiAgICB9XG5cbiAgICBjb25zdCBmb3JtYXRJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBwYXJhZ3JhcGg6IFwiV3JpdGUgaW4gcGFyYWdyYXBoIGZvcm1cIixcbiAgICAgIFwiYnVsbGV0LXBvaW50c1wiOiBcIkZvcm1hdCBhcyBidWxsZXQgcG9pbnRzXCIsXG4gICAgICBcIm51bWJlcmVkLWxpc3RcIjogXCJGb3JtYXQgYXMgYSBudW1iZXJlZCBsaXN0XCJcbiAgICB9XG5cbiAgICBjb25zdCBlbmhhbmNlZFByb21wdCA9IGAke3Byb21wdH1cblxuSW5zdHJ1Y3Rpb25zOlxuLSBUb25lOiAke3RvbmV9XG4tICR7bGVuZ3RoSW5zdHJ1Y3Rpb25zW2xlbmd0aF19XG4tICR7Zm9ybWF0SW5zdHJ1Y3Rpb25zW2Zvcm1hdF19XG5cblJlc3BvbnNlOmBcblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYWtlR2VtaW5pUmVxdWVzdChlbmhhbmNlZFByb21wdCwgeyB0ZW1wZXJhdHVyZTogMC43IH0pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJXcml0aW5nIGZhaWxlZDpcIiwgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJld3JpdGUodGV4dDogc3RyaW5nLCBvcHRpb25zOiBSZXdyaXRlck9wdGlvbnMgPSB7fSkge1xuICAgIGNvbnN0IHRvbmUgPSBvcHRpb25zLnRvbmUgfHwgXCJjYXN1YWxcIlxuICAgIGNvbnN0IGxlbmd0aCA9IG9wdGlvbnMubGVuZ3RoIHx8IFwic2FtZVwiXG4gICAgY29uc3QgYXVkaWVuY2UgPSBvcHRpb25zLmF1ZGllbmNlIHx8IFwiZ2VuZXJhbFwiXG5cbiAgICBjb25zdCBsZW5ndGhJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBzaG9ydGVyOiBcIk1ha2UgaXQgbW9yZSBjb25jaXNlXCIsXG4gICAgICBsb25nZXI6IFwiRXhwYW5kIGFuZCBhZGQgbW9yZSBkZXRhaWxcIixcbiAgICAgIHNhbWU6IFwiS2VlcCBhcHByb3hpbWF0ZWx5IHRoZSBzYW1lIGxlbmd0aFwiXG4gICAgfVxuXG4gICAgY29uc3QgcHJvbXB0ID0gYFJld3JpdGUgdGhlIGZvbGxvd2luZyB0ZXh0IHdpdGggdGhlc2UgcmVxdWlyZW1lbnRzOlxuLSBUb25lOiAke3RvbmV9XG4tIEF1ZGllbmNlOiAke2F1ZGllbmNlfVxuLSBMZW5ndGg6ICR7bGVuZ3RoSW5zdHJ1Y3Rpb25zW2xlbmd0aF19XG5cbk9yaWdpbmFsIHRleHQ6XG4ke3RleHR9XG5cblJld3JpdHRlbiB0ZXh0OmBcblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYWtlR2VtaW5pUmVxdWVzdChwcm9tcHQsIHsgdGVtcGVyYXR1cmU6IDAuNSB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiUmV3cml0aW5nIGZhaWxlZDpcIiwgZXJyb3IpXG4gICAgICByZXR1cm4gdGV4dCAvLyBSZXR1cm4gb3JpZ2luYWwgaWYgcmV3cml0aW5nIGZhaWxzXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcHJvb2ZyZWFkKHRleHQ6IHN0cmluZywgb3B0aW9uczogUHJvb2ZyZWFkZXJPcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBjaGVja0dyYW1tYXIgPSBvcHRpb25zLmNoZWNrR3JhbW1hciAhPT0gZmFsc2VcbiAgICBjb25zdCBjaGVja1NwZWxsaW5nID0gb3B0aW9ucy5jaGVja1NwZWxsaW5nICE9PSBmYWxzZVxuICAgIGNvbnN0IGNoZWNrU3R5bGUgPSBvcHRpb25zLmNoZWNrU3R5bGUgIT09IGZhbHNlXG5cbiAgICBjb25zdCBjaGVja3MgPSBbXVxuICAgIGlmIChjaGVja0dyYW1tYXIpIGNoZWNrcy5wdXNoKFwiZ3JhbW1hclwiKVxuICAgIGlmIChjaGVja1NwZWxsaW5nKSBjaGVja3MucHVzaChcInNwZWxsaW5nXCIpXG4gICAgaWYgKGNoZWNrU3R5bGUpIGNoZWNrcy5wdXNoKFwic3R5bGUgYW5kIGNsYXJpdHlcIilcblxuICAgIGNvbnN0IHByb21wdCA9IGBQcm9vZnJlYWQgYW5kIGNvcnJlY3QgdGhlIGZvbGxvd2luZyB0ZXh0IGZvciAke2NoZWNrcy5qb2luKFwiLCBcIil9LiBSZXR1cm4gb25seSB0aGUgY29ycmVjdGVkIHRleHQ6XG5cbiR7dGV4dH1cblxuQ29ycmVjdGVkIHRleHQ6YFxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvcnJlY3RlZFRleHQgPSBhd2FpdCB0aGlzLm1ha2VHZW1pbmlSZXF1ZXN0KHByb21wdCwgeyB0ZW1wZXJhdHVyZTogMC4yIH0pXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb3JyZWN0ZWRfdGV4dDogY29ycmVjdGVkVGV4dCxcbiAgICAgICAgc3VnZ2VzdGlvbnM6IFtdLFxuICAgICAgICBlcnJvcnM6IFtdXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJQcm9vZnJlYWRpbmcgZmFpbGVkOlwiLCBlcnJvcilcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvcnJlY3RlZF90ZXh0OiB0ZXh0LFxuICAgICAgICBzdWdnZXN0aW9uczogW10sXG4gICAgICAgIGVycm9yczogW11cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldExhbmd1YWdlTmFtZShjb2RlOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGxhbmd1YWdlTWFwID0ge1xuICAgICAgZXM6IFwiU3BhbmlzaFwiLFxuICAgICAgZnI6IFwiRnJlbmNoXCIsIFxuICAgICAgZGU6IFwiR2VybWFuXCIsXG4gICAgICBpdDogXCJJdGFsaWFuXCIsXG4gICAgICBwdDogXCJQb3J0dWd1ZXNlXCIsXG4gICAgICBqYTogXCJKYXBhbmVzZVwiLFxuICAgICAga286IFwiS29yZWFuXCIsXG4gICAgICB6aDogXCJDaGluZXNlXCIsXG4gICAgICBlbjogXCJFbmdsaXNoXCJcbiAgICB9XG4gICAgcmV0dXJuIGxhbmd1YWdlTWFwW2NvZGVdIHx8IFwiRW5nbGlzaFwiXG4gIH1cbn1cblxuLy8gU2VydmVyLXNpZGUgb25seSBpbml0aWFsaXphdGlvblxuZXhwb3J0IGNvbnN0IGNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZSA9ICgpID0+IHtcbiAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfR09PR0xFX0FJX0FQSV9LRVlcbiAgY29uc3QgYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0dPT0dMRV9BSV9CQVNFX1VSTCB8fCBcImh0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tXCJcblxuICBpZiAoIWFwaUtleSkge1xuICAgIGNvbnNvbGUud2FybihcIkdvb2dsZSBBSSBBUEkga2V5IG5vdCBmb3VuZC4gTGVzc29uIGdlbmVyYXRpb24gd2lsbCB1c2UgZmFsbGJhY2sgdGVtcGxhdGVzLlwiKVxuICAgIC8vIFJldHVybiBhIHNlcnZpY2UgdGhhdCB3aWxsIGFsd2F5cyB0aHJvdyBlcnJvcnMsIHRyaWdnZXJpbmcgZmFsbGJhY2tzXG4gICAgcmV0dXJuIG5ldyBHb29nbGVBSVNlcnZlclNlcnZpY2UoeyBhcGlLZXk6IFwiZHVtbXlcIiwgYmFzZVVybCB9KVxuICB9XG5cbiAgcmV0dXJuIG5ldyBHb29nbGVBSVNlcnZlclNlcnZpY2UoeyBhcGlLZXksIGJhc2VVcmwgfSlcbn1cblxuZXhwb3J0IHR5cGUgeyBTdW1tYXJpemVyT3B0aW9ucywgVHJhbnNsYXRvck9wdGlvbnMsIFByb21wdE9wdGlvbnMsIFdyaXRlck9wdGlvbnMsIFJld3JpdGVyT3B0aW9ucywgUHJvb2ZyZWFkZXJPcHRpb25zIH1cbiJdLCJuYW1lcyI6WyJHb29nbGVBSVNlcnZlclNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImNvbmZpZyIsIm1vZGVsIiwibWFrZUdlbWluaVJlcXVlc3QiLCJwcm9tcHQiLCJvcHRpb25zIiwibW9kZWxzVG9UcnkiLCJwb3NzaWJsZVVybHMiLCJwdXNoIiwiYmFzZVVybCIsImFwaUtleSIsInJlcXVlc3RCb2R5IiwiY29udGVudHMiLCJwYXJ0cyIsInRleHQiLCJnZW5lcmF0aW9uQ29uZmlnIiwidGVtcGVyYXR1cmUiLCJtYXhPdXRwdXRUb2tlbnMiLCJtYXhUb2tlbnMiLCJ0b3BQIiwiY29uc29sZSIsImxvZyIsInVybCIsInJlcGxhY2UiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5Iiwic3RhdHVzIiwic3RhdHVzVGV4dCIsIm9rIiwicmVzdWx0IiwianNvbiIsImNhbmRpZGF0ZXMiLCJsZW5ndGgiLCJjYW5kaWRhdGUiLCJmaW5pc2hSZWFzb24iLCJ3YXJuIiwiY29udGVudCIsInN1YnN0cmluZyIsIkVycm9yIiwiZXJyb3JUZXh0IiwiZXJyb3IiLCJtZXNzYWdlIiwic3VtbWFyaXplIiwic3VtbWFyeVR5cGUiLCJ0eXBlIiwibGVuZ3RoSW5zdHJ1Y3Rpb25zIiwic2hvcnQiLCJtZWRpdW0iLCJsb25nIiwidHlwZUluc3RydWN0aW9ucyIsInRyYW5zbGF0ZSIsInRhcmdldExhbmciLCJnZXRMYW5ndWFnZU5hbWUiLCJ0YXJnZXRMYW5ndWFnZSIsIndyaXRlIiwidG9uZSIsImZvcm1hdCIsImZvcm1hdEluc3RydWN0aW9ucyIsInBhcmFncmFwaCIsImVuaGFuY2VkUHJvbXB0IiwicmV3cml0ZSIsImF1ZGllbmNlIiwic2hvcnRlciIsImxvbmdlciIsInNhbWUiLCJwcm9vZnJlYWQiLCJjaGVja0dyYW1tYXIiLCJjaGVja1NwZWxsaW5nIiwiY2hlY2tTdHlsZSIsImNoZWNrcyIsImpvaW4iLCJjb3JyZWN0ZWRUZXh0IiwiY29ycmVjdGVkX3RleHQiLCJzdWdnZXN0aW9ucyIsImVycm9ycyIsImNvZGUiLCJsYW5ndWFnZU1hcCIsImVzIiwiZnIiLCJkZSIsIml0IiwicHQiLCJqYSIsImtvIiwiemgiLCJlbiIsImNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19HT09HTEVfQUlfQVBJX0tFWSIsIk5FWFRfUFVCTElDX0dPT0dMRV9BSV9CQVNFX1VSTCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/google-ai-server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/lesson-ai-generator-server.ts":
/*!*******************************************!*\
  !*** ./lib/lesson-ai-generator-server.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LessonAIServerGenerator: () => (/* binding */ LessonAIServerGenerator),\n/* harmony export */   lessonAIServerGenerator: () => (/* binding */ lessonAIServerGenerator)\n/* harmony export */ });\n/* harmony import */ var _google_ai_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./google-ai-server */ \"(rsc)/./lib/google-ai-server.ts\");\n\nclass LessonAIServerGenerator {\n    getGoogleAI() {\n        if (!this.googleAI) {\n            this.googleAI = (0,_google_ai_server__WEBPACK_IMPORTED_MODULE_0__.createGoogleAIServerService)();\n        }\n        return this.googleAI;\n    }\n    async generateLesson(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage, sourceUrl, contentMetadata, structuredContent, wordCount, readingTime } = params;\n        console.log(\"\\uD83D\\uDE80 Starting optimized AI lesson generation with params:\", {\n            textLength: sourceText.length,\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            hasMetadata: !!contentMetadata,\n            hasStructuredContent: !!structuredContent\n        });\n        try {\n            // Use ultra-minimal AI approach to avoid MAX_TOKENS\n            console.log(\"\\uD83E\\uDD16 Step 1: Generating lesson with ultra-minimal AI prompts...\");\n            const lessonStructure = await this.generateMinimalAILesson(sourceText, lessonType, studentLevel, targetLanguage, contentMetadata);\n            console.log(\"âœ… Minimal AI lesson generated:\", Object.keys(lessonStructure));\n            // Return properly structured GeneratedLesson object\n            const finalLesson = {\n                lessonType,\n                studentLevel,\n                targetLanguage,\n                sections: lessonStructure\n            };\n            console.log(\"\\uD83C\\uDFAF Returning AI-generated lesson:\", {\n                lessonType: finalLesson.lessonType,\n                studentLevel: finalLesson.studentLevel,\n                targetLanguage: finalLesson.targetLanguage,\n                sectionsCount: Object.keys(finalLesson.sections).length,\n                warmupCount: finalLesson.sections.warmup?.length || 0,\n                vocabularyCount: finalLesson.sections.vocabulary?.length || 0\n            });\n            console.log(\"\\uD83C\\uDF89 Optimized AI lesson generation complete!\");\n            return finalLesson;\n        } catch (error) {\n            console.error(\"âŒ Error in AI lesson generation:\", error);\n            console.log(\"\\uD83D\\uDD04 Falling back to smart template generation...\");\n            // Fallback to smart templates if AI fails\n            return this.generateSmartTemplateFallback(params);\n        }\n    }\n    // Ultra-minimal AI lesson generation to avoid MAX_TOKENS\n    async generateMinimalAILesson(sourceText, lessonType, studentLevel, targetLanguage, metadata) {\n        console.log(\"\\uD83C\\uDFAF Using ultra-minimal AI prompts to avoid token limits...\");\n        // Step 1: Generate just the essential parts with minimal prompts\n        const warmupQuestions = await this.generateMinimalWarmup(sourceText, studentLevel);\n        const vocabulary = await this.generateMinimalVocabulary(sourceText, studentLevel);\n        const comprehensionQuestions = await this.generateMinimalComprehension(sourceText, studentLevel);\n        // Step 2: Use hybrid approach - AI for key parts, templates for the rest\n        return {\n            warmup: warmupQuestions,\n            vocabulary: vocabulary,\n            reading: this.generateSmartReading(sourceText, studentLevel),\n            comprehension: comprehensionQuestions,\n            discussion: this.generateSmartDiscussion(this.extractBetterTopics(sourceText), lessonType, studentLevel),\n            grammar: this.generateSmartGrammar(studentLevel, sourceText),\n            pronunciation: this.generateSmartPronunciation(vocabulary.map((v)=>v.word)),\n            wrapup: this.generateSmartWrapup(this.extractBetterTopics(sourceText), studentLevel)\n        };\n    }\n    // Ultra-minimal warmup generation\n    async generateMinimalWarmup(sourceText, studentLevel) {\n        // Extract better context for topic identification\n        const topics = this.extractBetterTopics(sourceText);\n        const mainTopic = topics[0] || \"this topic\";\n        // Create a more specific prompt that avoids content assumptions\n        const prompt = `Write 3 ${studentLevel} warm-up questions about ${mainTopic}. Ask about students' prior knowledge and experience. Do not mention any specific events or results. Format: just the questions, one per line:`;\n        try {\n            console.log(\"\\uD83D\\uDD25 Minimal warmup prompt:\", prompt.length, \"chars\");\n            console.log(\"\\uD83C\\uDFAF Topic identified:\", mainTopic);\n            const response = await this.getGoogleAI().prompt(prompt);\n            // Extract only actual questions (must end with ?)\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>{\n                // Must be a question (ends with ?) and not an instruction\n                return line.endsWith(\"?\") && line.length > 10 && !line.toLowerCase().includes(\"here are\") && !line.toLowerCase().includes(\"based on\") && !line.toLowerCase().includes(\"headline mentions\") && !line.toLowerCase().includes(\"the text\") && !line.toLowerCase().includes(\"the article\") && !line.toLowerCase().includes(\"according to\") && !line.toLowerCase().includes(\"the passage\");\n            }).map((line)=>line.replace(/^\\d+\\.?\\s*/, \"\").replace(/^-\\s*/, \"\").trim()).slice(0, 3);\n            console.log(\"\\uD83C\\uDFAF Extracted warmup questions:\", questions);\n            return questions.length >= 3 ? questions : this.generateSmartWarmupQuestions(topics, studentLevel, {});\n        } catch (error) {\n            console.log(\"âš ï¸ Minimal warmup failed, using template\");\n            return this.generateSmartWarmupQuestions(this.extractBetterTopics(sourceText), studentLevel, {});\n        }\n    }\n    // Better topic extraction that recognizes compound terms\n    extractBetterTopics(text) {\n        const topics = [];\n        // Look for compound terms first (like \"Ryder Cup\", \"World Cup\", etc.)\n        const compoundPatterns = [\n            /\\b(Ryder Cup|World Cup|Champions League|Premier League|Super Bowl|Olympics|World Series)\\b/gi,\n            /\\b(artificial intelligence|machine learning|climate change|social media)\\b/gi,\n            /\\b([A-Z][a-z]+ [A-Z][a-z]+)\\b/g // General compound proper nouns\n        ];\n        for (const pattern of compoundPatterns){\n            const matches = text.match(pattern);\n            if (matches) {\n                topics.push(...matches.map((m)=>m.toLowerCase()));\n            }\n        }\n        // If no compound terms found, fall back to single words\n        if (topics.length === 0) {\n            const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n            const commonWords = [\n                \"europe\",\n                \"team\",\n                \"golf\",\n                \"tournament\",\n                \"sports\",\n                \"competition\"\n            ];\n            const foundWords = words.filter((word)=>commonWords.includes(word));\n            topics.push(...foundWords.slice(0, 3));\n        }\n        return topics.length > 0 ? topics : [\n            \"sports\"\n        ];\n    }\n    // Ultra-minimal vocabulary generation\n    async generateMinimalVocabulary(sourceText, studentLevel) {\n        const words = sourceText.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words)).slice(0, 4) // Only 4 words\n        ;\n        const vocabulary = [];\n        for (const word of uniqueWords){\n            try {\n                const prompt = `Define \"${word}\" for ${studentLevel} student:`;\n                console.log(\"\\uD83D\\uDCDA Minimal vocab prompt:\", prompt.length, \"chars\");\n                const meaning = await this.getGoogleAI().prompt(prompt);\n                // Find example sentence from source\n                const sentences = sourceText.split(/[.!?]+/);\n                const example = sentences.find((s)=>s.toLowerCase().includes(word.toLowerCase())) || `Example with ${word}.`;\n                vocabulary.push({\n                    word: word,\n                    meaning: meaning.trim().substring(0, 100),\n                    example: example.trim().substring(0, 100)\n                });\n            } catch (error) {\n                console.log(`âš ï¸ Vocab failed for ${word}, using template`);\n                vocabulary.push({\n                    word: word,\n                    meaning: this.generateWordMeaning(word, studentLevel),\n                    example: `Example sentence with ${word}.`\n                });\n            }\n        }\n        return vocabulary;\n    }\n    // Ultra-minimal comprehension generation\n    async generateMinimalComprehension(sourceText, studentLevel) {\n        const shortText = sourceText.substring(0, 150) // Use only first 150 chars\n        ;\n        const prompt = `Write 3 ${studentLevel} reading comprehension questions about this text. Only return questions, no instructions: ${shortText}`;\n        try {\n            console.log(\"â“ Minimal comprehension prompt:\", prompt.length, \"chars\");\n            const response = await this.getGoogleAI().prompt(prompt);\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>{\n                // Must be a question and not an instruction\n                return line.endsWith(\"?\") && line.length > 10 && !line.toLowerCase().includes(\"here are\") && !line.toLowerCase().includes(\"based on\");\n            }).map((line)=>line.replace(/^\\d+\\.?\\s*/, \"\").replace(/^\\*\\*/, \"\").replace(/\\*\\*$/, \"\").trim()).slice(0, 3);\n            return questions.length >= 3 ? questions : this.generateSmartComprehension(this.extractBetterTopics(sourceText), studentLevel);\n        } catch (error) {\n            console.log(\"âš ï¸ Minimal comprehension failed, using template\");\n            return this.generateSmartComprehension(this.extractBetterTopics(sourceText), studentLevel);\n        }\n    }\n    // Smart template fallback\n    generateSmartTemplateFallback(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage } = params;\n        console.log(\"\\uD83C\\uDFA8 Using smart template fallback...\");\n        const topics = this.extractTopicsFromText(sourceText, []);\n        const vocabulary = this.extractVocabularyFromText(sourceText, studentLevel);\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: this.generateSmartWarmupQuestions(topics, studentLevel, {}),\n                vocabulary: this.generateSmartVocabulary(vocabulary, sourceText, studentLevel),\n                reading: this.generateSmartReading(sourceText, studentLevel),\n                comprehension: this.generateSmartComprehension(topics, studentLevel),\n                discussion: this.generateSmartDiscussion(topics, lessonType, studentLevel),\n                grammar: this.generateSmartGrammar(studentLevel, sourceText),\n                pronunciation: this.generateSmartPronunciation(vocabulary),\n                wrapup: this.generateSmartWrapup(topics, studentLevel)\n            }\n        };\n    }\n    // Content analysis without AI calls\n    analyzeContentContextNoAI(sourceText, metadata, structuredContent, studentLevel) {\n        console.log(\"\\uD83D\\uDD0D Analyzing content context without AI...\");\n        const analysis = {\n            contentType: metadata?.contentType || \"general\",\n            domain: metadata?.domain || \"\",\n            complexity: \"medium\",\n            topics: [],\n            keyVocabulary: [],\n            culturalContext: \"\",\n            learningObjectives: [],\n            difficulty: studentLevel || \"B1\",\n            title: metadata?.title || \"\",\n            sourceCountry: this.determineSourceCountry(metadata?.domain || \"\")\n        };\n        // Analyze content complexity\n        const sentences = sourceText.split(/[.!?]+/).filter((s)=>s.trim().length > 10);\n        const avgSentenceLength = sentences.length > 0 ? sentences.reduce((sum, s)=>sum + s.split(\" \").length, 0) / sentences.length : 0;\n        const complexWords = sourceText.match(/\\b\\w{8,}\\b/g)?.length || 0;\n        const totalWords = sourceText.split(/\\s+/).length;\n        if (avgSentenceLength > 20 || complexWords / totalWords > 0.15) {\n            analysis.complexity = \"high\";\n        } else if (avgSentenceLength < 12 && complexWords / totalWords < 0.08) {\n            analysis.complexity = \"low\";\n        }\n        // Extract topics using text analysis\n        analysis.topics = this.extractTopicsFromText(sourceText, structuredContent?.headings || []);\n        // Extract vocabulary using text analysis\n        analysis.keyVocabulary = this.extractVocabularyFromText(sourceText, studentLevel);\n        // Determine cultural context\n        if (metadata?.domain) {\n            analysis.culturalContext = this.determineCulturalContext(metadata.domain, sourceText);\n        }\n        // Generate learning objectives\n        analysis.learningObjectives = this.generateLearningObjectives(analysis.contentType, analysis.topics, studentLevel);\n        return analysis;\n    }\n    // New method: Analyze content context and complexity\n    async analyzeContentContext(sourceText, metadata, structuredContent, studentLevel) {\n        console.log(\"\\uD83D\\uDD0D Analyzing content context...\");\n        const analysis = {\n            contentType: metadata?.contentType || \"general\",\n            domain: metadata?.domain || \"\",\n            complexity: \"medium\",\n            topics: [],\n            keyVocabulary: [],\n            culturalContext: \"\",\n            learningObjectives: [],\n            difficulty: studentLevel || \"B1\",\n            title: metadata?.title || \"\",\n            sourceCountry: this.determineSourceCountry(metadata?.domain || \"\")\n        };\n        // Analyze content complexity based on text characteristics\n        const sentences = sourceText.split(/[.!?]+/).filter((s)=>s.trim().length > 10);\n        const avgSentenceLength = sentences.length > 0 ? sentences.reduce((sum, s)=>sum + s.split(\" \").length, 0) / sentences.length : 0;\n        const complexWords = sourceText.match(/\\b\\w{8,}\\b/g)?.length || 0;\n        const totalWords = sourceText.split(/\\s+/).length;\n        if (avgSentenceLength > 20 || complexWords / totalWords > 0.15) {\n            analysis.complexity = \"high\";\n        } else if (avgSentenceLength < 12 && complexWords / totalWords < 0.08) {\n            analysis.complexity = \"low\";\n        }\n        console.log(\"\\uD83D\\uDCC8 Text complexity analysis:\", {\n            avgSentenceLength,\n            complexWords,\n            totalWords,\n            complexity: analysis.complexity\n        });\n        // Extract key topics using simple text analysis (skip AI to avoid token limits)\n        console.log(\"\\uD83C\\uDFAF Extracting topics using text analysis...\");\n        analysis.topics = this.extractTopicsFromText(sourceText, structuredContent?.headings || []);\n        console.log(\"âœ… Extracted topics:\", analysis.topics);\n        // Extract key vocabulary using text analysis (skip AI to avoid token limits)\n        console.log(\"\\uD83D\\uDCDA Extracting vocabulary using text analysis...\");\n        analysis.keyVocabulary = this.extractVocabularyFromText(sourceText, studentLevel);\n        console.log(\"âœ… Extracted vocabulary:\", analysis.keyVocabulary);\n        // Determine cultural context\n        if (metadata?.domain) {\n            analysis.culturalContext = this.determineCulturalContext(metadata.domain, sourceText);\n            console.log(\"\\uD83C\\uDF0D Cultural context:\", analysis.culturalContext);\n        }\n        // Generate learning objectives based on content type and lesson type\n        analysis.learningObjectives = this.generateLearningObjectives(analysis.contentType, analysis.topics, studentLevel);\n        console.log(\"\\uD83C\\uDFAF Learning objectives:\", analysis.learningObjectives);\n        return analysis;\n    }\n    // Enhanced contextual summary creation\n    async createContextualSummary(sourceText, contentAnalysis, lessonType, studentLevel) {\n        console.log(\"\\uD83D\\uDCDD Creating contextual summary...\");\n        // Use simple prompt to avoid token limits\n        const summaryPrompt = `Summarize this text in 4-5 sentences for ${studentLevel} level students:\n\n${sourceText.substring(0, 800)}\n\nSummary:`;\n        try {\n            console.log(\"\\uD83E\\uDD16 Calling AI for contextual summary...\");\n            const summary = await this.getGoogleAI().prompt(summaryPrompt, {\n                temperature: 0.4,\n                maxTokens: 300\n            });\n            console.log(\"âœ… AI contextual summary created:\", summary.substring(0, 100) + \"...\");\n            return summary;\n        } catch (error) {\n            console.warn(\"âš ï¸ AI contextual summary failed, using text truncation:\", error.message);\n            // Skip complex fallbacks, just use truncation\n            const truncated = sourceText.substring(0, 600) + \"...\";\n            console.log(\"\\uD83D\\uDD04 Using truncated text as summary\");\n            return truncated;\n        }\n    }\n    // Generate CEFR-adapted warm-up questions\n    async generateContextualWarmupQuestions(content, contentAnalysis, studentLevel, metadata) {\n        console.log(\"\\uD83D\\uDD25 Generating CEFR-adapted warm-up questions...\");\n        const levelInstructions = {\n            \"A1\": `\nCreate 3 warm-up questions for A1 (beginner) level:\n- Use simple present tense and basic vocabulary\n- Ask yes/no questions or simple choice questions\n- Focus on familiar, concrete concepts\n- Keep questions short and direct\n- Use vocabulary the student likely knows\nExample: \"Do you use [topic] in your daily life? Yes or No?\"`,\n            \"A2\": `\nCreate 3 warm-up questions for A2 (elementary) level:\n- Use simple past tense and personal experiences\n- Ask for short, simple answers\n- Include basic comparisons with \"different\" or \"same\"\n- Focus on personal experiences and familiar situations\n- Use simple connecting words like \"and\", \"but\"\nExample: \"Have you ever [experienced topic]? How was it?\"`,\n            \"B1\": `\nCreate 3 warm-up questions for B1 (intermediate) level:\n- Ask for opinions with \"What do you think...?\"\n- Include comparisons between countries/cultures\n- Ask students to explain reasons with \"because\" or \"why\"\n- Discuss advantages and disadvantages\n- Use more varied vocabulary but keep structure clear\nExample: \"What do you think about [topic]? How is it different in your country?\"`,\n            \"B2\": `\nCreate 3 warm-up questions for B2 (upper intermediate) level:\n- Ask students to analyze situations and predict outcomes\n- Include complex opinions and explanations\n- Discuss implications and consequences\n- Use conditional language (\"What would happen if...?\")\n- Encourage detailed responses with examples\nExample: \"What challenges do you think [specific group] face with [topic]?\"`,\n            \"C1\": `\nCreate 3 warm-up questions for C1 (advanced) level:\n- Ask students to evaluate arguments and consider multiple perspectives\n- Include abstract concepts and societal implications\n- Use sophisticated vocabulary and complex structures\n- Encourage critical thinking and nuanced discussion\n- Ask about broader cultural and social contexts\nExample: \"How do cultural attitudes toward [concept] influence [topic] in different societies?\"`\n        };\n        // Ultra-simple prompt to avoid token limits\n        const topic = contentAnalysis.topics[0] || \"this topic\";\n        const warmupPrompt = `Create 3 ${studentLevel} level warm-up questions about ${topic}. Return only the questions:`;\n        try {\n            console.log(\"\\uD83E\\uDD16 Calling AI for contextual warm-up questions...\");\n            console.log(\"\\uD83D\\uDCDD Warm-up prompt:\", warmupPrompt.substring(0, 200) + \"...\");\n            const response = await this.getGoogleAI().prompt(warmupPrompt, {\n                temperature: 0.6,\n                maxTokens: 150\n            });\n            console.log(\"âœ… AI warm-up questions generated\");\n            console.log(\"\\uD83E\\uDD16 Raw AI response:\", response);\n            const questions = this.parseListFromText(response).slice(0, 3);\n            console.log(\"\\uD83D\\uDD25 Parsed warm-up questions:\", questions);\n            console.log(\"\\uD83D\\uDD0D Questions array length:\", questions.length);\n            // Ensure we have 3 questions, add fallbacks if needed\n            while(questions.length < 3){\n                const fallbackQuestion = this.getFallbackWarmupQuestion(studentLevel, contentAnalysis, questions.length);\n                console.log(`ðŸ”„ Adding fallback question ${questions.length + 1}:`, fallbackQuestion);\n                questions.push(fallbackQuestion);\n            }\n            console.log(\"âœ… Final warm-up questions:\", questions);\n            // Final safety check - if still empty, use basic fallback\n            if (questions.length === 0) {\n                console.warn(\"âš ï¸ No questions generated, using emergency fallback\");\n                return [\n                    \"What do you know about this topic?\",\n                    \"Have you experienced something similar?\",\n                    \"What would you like to learn?\"\n                ];\n            }\n            return questions;\n        } catch (error) {\n            console.warn(\"âš ï¸ AI warm-up generation failed, using contextual fallbacks:\", error.message);\n            const fallbackQuestions = this.getContextualWarmupFallback(studentLevel, contentAnalysis, metadata);\n            console.log(\"\\uD83D\\uDD04 Fallback warm-up questions:\", fallbackQuestions);\n            // Final safety check for fallback\n            if (!fallbackQuestions || fallbackQuestions.length === 0) {\n                console.warn(\"âš ï¸ Fallback also empty, using emergency questions\");\n                return [\n                    \"What do you know about this topic?\",\n                    \"Have you experienced something similar?\",\n                    \"What would you like to learn?\"\n                ];\n            }\n            return fallbackQuestions;\n        }\n    }\n    // Enhanced contextual lesson structure generation\n    async generateContextualLessonStructure(content, contentAnalysis, lessonType, studentLevel, targetLanguage, metadata) {\n        console.log(\"\\uD83C\\uDFD7ï¸ Generating contextual lesson structure...\");\n        // Generate contextual warm-up questions first\n        const contextualWarmup = await this.generateContextualWarmupQuestions(content, contentAnalysis, studentLevel, metadata);\n        console.log(\"\\uD83D\\uDD25 Generated contextual warm-up questions:\", contextualWarmup);\n        // Ultra-simplified prompt to avoid token limits\n        const topics = contentAnalysis.topics.slice(0, 2).join(\", \") || \"technology\";\n        const vocab = contentAnalysis.keyVocabulary.slice(0, 4).join(\", \");\n        const prompt = `Create a ${lessonType} lesson for ${studentLevel} students about: ${topics}\n\nContent: \"${content.substring(0, 400)}\"\nKey words: ${vocab}\n\nReturn JSON with: warmup (use provided), vocabulary (4 words from content), reading (simplified content), comprehension (3 questions), discussion (3 questions), grammar (focus + examples), pronunciation (1 word), wrapup (3 questions).\n\n{\n  \"warmup\": ${JSON.stringify(contextualWarmup)},\n  \"vocabulary\": [{\"word\": \"word\", \"meaning\": \"definition\", \"example\": \"sentence\"}],\n  \"reading\": \"text\",\n  \"comprehension\": [\"question\"],\n  \"discussion\": [\"question\"], \n  \"grammar\": {\"focus\": \"topic\", \"examples\": [\"example\"], \"exercise\": [\"exercise\"]},\n  \"pronunciation\": {\"word\": \"word\", \"ipa\": \"/ipa/\", \"practice\": \"sentence\"},\n  \"wrapup\": [\"question\"]\n}`;\n        try {\n            console.log(\"\\uD83E\\uDD16 Calling AI for lesson structure...\");\n            const response = await this.getGoogleAI().prompt(prompt, {\n                temperature: 0.7,\n                maxTokens: 1500\n            });\n            console.log(\"\\uD83E\\uDD16 AI lesson structure response:\", response.substring(0, 200) + \"...\");\n            try {\n                const parsed = JSON.parse(response);\n                console.log(\"âœ… Successfully parsed lesson structure JSON\");\n                // Ensure our contextual warm-up questions are preserved\n                parsed.warmup = contextualWarmup;\n                console.log(\"\\uD83D\\uDD25 Preserved contextual warm-up questions in final structure\");\n                return parsed;\n            } catch (parseError) {\n                console.warn(\"âš ï¸ Failed to parse JSON, attempting to clean response...\");\n                // Try to extract JSON from the response\n                const jsonMatch = response.match(/\\{[\\s\\S]*\\}/);\n                if (jsonMatch) {\n                    try {\n                        const cleaned = JSON.parse(jsonMatch[0]);\n                        console.log(\"âœ… Successfully parsed cleaned JSON\");\n                        // Ensure our contextual warm-up questions are preserved\n                        cleaned.warmup = contextualWarmup;\n                        console.log(\"\\uD83D\\uDD25 Preserved contextual warm-up questions in cleaned structure\");\n                        return cleaned;\n                    } catch (cleanError) {\n                        console.warn(\"âš ï¸ Failed to parse cleaned JSON, using fallback\");\n                    }\n                }\n                // If JSON parsing fails, return a structured fallback with contextual warm-up\n                const fallback = this.createStructuredFallback(content, lessonType, studentLevel);\n                fallback.warmup = contextualWarmup;\n                console.log(\"\\uD83D\\uDD25 Using fallback with contextual warm-up questions\");\n                return fallback;\n            }\n        } catch (error) {\n            console.warn(\"âš ï¸ AI lesson structure generation failed, using fallback:\", error.message);\n            const fallback = this.createStructuredFallback(content, lessonType, studentLevel);\n            fallback.warmup = contextualWarmup;\n            console.log(\"\\uD83D\\uDD25 Using error fallback with contextual warm-up questions\");\n            return fallback;\n        }\n    }\n    // Enhanced detailed content generation with context\n    async generateDetailedContextualContent(structure, content, contentAnalysis, lessonType, studentLevel, targetLanguage, structuredContent) {\n        // Use Writer API to expand each section with contextual, detailed content\n        const sections = {\n            ...structure\n        };\n        // Enhance vocabulary section with contextual examples\n        if (sections.vocabulary) {\n            for(let i = 0; i < sections.vocabulary.length; i++){\n                const vocab = sections.vocabulary[i];\n                try {\n                    const contextualExamplePrompt = `\nCreate a natural example sentence using the word \"${vocab.word}\" that relates to this content context:\nTopics: ${contentAnalysis.topics.join(\", \")}\nContent type: ${contentAnalysis.contentType}\nLevel: ${studentLevel}\n\nMake the example relevant to the source material and appropriate for ${studentLevel} level students.\n`;\n                    const enhancedExample = await this.getGoogleAI().write(contextualExamplePrompt, {\n                        tone: \"casual\",\n                        length: \"short\"\n                    });\n                    sections.vocabulary[i].example = enhancedExample;\n                    // Add contextual meaning based on source content\n                    const contextualMeaningPrompt = `\nExplain the meaning of \"${vocab.word}\" in the context of: ${contentAnalysis.topics[0] || contentAnalysis.contentType}\nKeep it simple for ${studentLevel} level students.\n`;\n                    const contextualMeaning = await this.getGoogleAI().write(contextualMeaningPrompt, {\n                        tone: \"casual\",\n                        length: \"short\"\n                    });\n                    sections.vocabulary[i].contextualMeaning = contextualMeaning;\n                } catch (error) {\n                    // Keep original if enhancement fails\n                    console.warn(`Failed to enhance vocabulary for ${vocab.word}:`, error);\n                }\n            }\n        }\n        // Enhance discussion questions with specific content references\n        if (sections.discussion) {\n            try {\n                const enhancedDiscussionPrompt = `\nEnhance these discussion questions for a ${lessonType} lesson about ${contentAnalysis.topics.join(\" and \")}:\n${sections.discussion.join(\"\\n\")}\n\nMake them more specific to the content, engaging for ${studentLevel} level students, and encourage deeper thinking about:\n- ${contentAnalysis.topics.slice(0, 3).join(\"\\n- \")}\n\nReturn 3-4 enhanced questions that reference specific aspects of the content.\n`;\n                const enhancedDiscussion = await this.getGoogleAI().write(enhancedDiscussionPrompt, {\n                    tone: \"casual\",\n                    length: \"medium\",\n                    format: \"bullet-points\"\n                });\n                sections.discussion = this.parseListFromText(enhancedDiscussion).slice(0, 4);\n            } catch (error) {\n                console.warn(\"Failed to enhance discussion questions:\", error);\n            }\n        }\n        // Enhance reading section with better structure\n        if (sections.reading && structuredContent?.headings?.length > 0) {\n            try {\n                const structuredReadingPrompt = `\nImprove this reading text by organizing it with clear structure based on these headings from the original:\n${structuredContent.headings.slice(0, 3).map((h)=>`- ${h.text}`).join(\"\\n\")}\n\nOriginal text: \"${sections.reading}\"\n\nCreate a well-structured, ${studentLevel}-appropriate reading passage that maintains the key information but improves readability.\n`;\n                const enhancedReading = await this.getGoogleAI().rewrite(sections.reading, {\n                    tone: \"casual\",\n                    length: \"same\",\n                    audience: this.getAudienceLevel(studentLevel)\n                });\n                sections.reading = enhancedReading;\n            } catch (error) {\n                console.warn(\"Failed to enhance reading section:\", error);\n            }\n        }\n        // Enhance grammar section with content-specific examples\n        if (sections.grammar && sections.grammar.focus) {\n            try {\n                const grammarExamplesPrompt = `\nCreate 3 grammar examples for \"${sections.grammar.focus}\" using vocabulary and concepts from this content:\nTopics: ${contentAnalysis.topics.join(\", \")}\nKey vocabulary: ${contentAnalysis.keyVocabulary.slice(0, 5).join(\", \")}\n\nMake examples relevant to the content and appropriate for ${studentLevel} level.\n`;\n                const contextualGrammarExamples = await this.getGoogleAI().write(grammarExamplesPrompt, {\n                    tone: \"casual\",\n                    length: \"short\",\n                    format: \"bullet-points\"\n                });\n                sections.grammar.contextualExamples = this.parseListFromText(contextualGrammarExamples);\n            } catch (error) {\n                console.warn(\"Failed to enhance grammar examples:\", error);\n            }\n        }\n        return sections;\n    }\n    async proofreadLesson(lesson) {\n        // Proofread key text sections\n        const sectionsToProofread = [\n            \"reading\",\n            \"grammar.examples\",\n            \"pronunciation.practice\"\n        ];\n        for (const sectionPath of sectionsToProofread){\n            const value = this.getNestedValue(lesson, sectionPath);\n            if (typeof value === \"string\") {\n                const proofread = await this.getGoogleAI().proofread(value, {\n                    checkGrammar: true,\n                    checkSpelling: true,\n                    checkStyle: true\n                });\n                this.setNestedValue(lesson, sectionPath, proofread.corrected_text);\n            }\n        }\n        return lesson;\n    }\n    generateFallbackLesson(params) {\n        // Template-based fallback when AI APIs fail\n        const { sourceText, lessonType, studentLevel, targetLanguage } = params;\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: this.getTemplateWarmup(lessonType, studentLevel),\n                vocabulary: this.extractVocabulary(sourceText, studentLevel),\n                reading: this.simplifyText(sourceText, studentLevel),\n                comprehension: this.getTemplateComprehension(lessonType, studentLevel),\n                discussion: this.getTemplateDiscussion(lessonType, studentLevel),\n                grammar: this.getTemplateGrammar(studentLevel),\n                pronunciation: this.getTemplatePronunciation(sourceText),\n                wrapup: this.getTemplateWrapup(lessonType)\n            }\n        };\n    }\n    // Helper methods\n    getSummaryLength(level) {\n        const lengthMap = {\n            A1: \"short\",\n            A2: \"short\",\n            B1: \"medium\",\n            B2: \"medium\",\n            C1: \"long\"\n        };\n        return lengthMap[level] || \"medium\";\n    }\n    getLanguageCode(language) {\n        const languageMap = {\n            spanish: \"es\",\n            french: \"fr\",\n            german: \"de\",\n            italian: \"it\",\n            portuguese: \"pt\",\n            japanese: \"ja\",\n            korean: \"ko\",\n            chinese: \"zh\"\n        };\n        return languageMap[language] || \"en\";\n    }\n    parseListFromText(text) {\n        return text.split(\"\\n\").filter((line)=>line.trim()).map((line)=>line.replace(/^[-â€¢*]\\s*/, \"\").trim()).filter((line)=>line.length > 0).slice(0, 4) // Limit to 4 items\n        ;\n    }\n    getNestedValue(obj, path) {\n        return path.split(\".\").reduce((current, key)=>current?.[key], obj);\n    }\n    setNestedValue(obj, path, value) {\n        const keys = path.split(\".\");\n        const lastKey = keys.pop();\n        const target = keys.reduce((current, key)=>current[key], obj);\n        target[lastKey] = value;\n    }\n    createStructuredFallback(content, lessonType, studentLevel) {\n        console.log(\"\\uD83D\\uDD04 Creating structured fallback lesson...\");\n        // Extract some basic information from content for better fallback\n        const words = content.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words)).slice(0, 6);\n        const fallback = {\n            warmup: [],\n            vocabulary: uniqueWords.map((word)=>({\n                    word: word,\n                    meaning: `Definition of ${word}`,\n                    example: `Example sentence with ${word}.`\n                })),\n            reading: this.simplifyText(content, studentLevel),\n            comprehension: this.getTemplateComprehension(lessonType, studentLevel),\n            discussion: this.getTemplateDiscussion(lessonType, studentLevel),\n            grammar: this.getTemplateGrammar(studentLevel),\n            pronunciation: this.getTemplatePronunciation(content),\n            wrapup: this.getTemplateWrapup(lessonType)\n        };\n        console.log(\"âœ… Structured fallback created (warmup will be set by caller)\");\n        return fallback;\n    }\n    getTemplateWarmup(lessonType, studentLevel) {\n        const templates = {\n            discussion: [\n                \"What do you already know about this topic?\",\n                \"Have you had similar experiences?\",\n                \"What would you like to learn more about?\"\n            ],\n            grammar: [\n                \"What grammar patterns do you notice?\",\n                \"Which sentences seem most complex?\",\n                \"What grammar rules do you remember?\"\n            ],\n            travel: [\n                \"Where would you like to travel next?\",\n                \"What travel experiences have you had?\",\n                \"What travel vocabulary do you know?\"\n            ],\n            business: [\n                \"What business situations are you familiar with?\",\n                \"How do you communicate professionally?\",\n                \"What business terms are challenging?\"\n            ],\n            pronunciation: [\n                \"Which sounds are difficult to pronounce?\",\n                \"How do you practice pronunciation?\",\n                \"What pronunciation goals do you have?\"\n            ]\n        };\n        return templates[lessonType] || templates.discussion;\n    }\n    extractVocabulary(text, studentLevel) {\n        // Simple vocabulary extraction based on word frequency and complexity\n        const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words));\n        const selectedWords = uniqueWords.slice(0, 6);\n        return selectedWords.map((word)=>({\n                word: word,\n                meaning: `Definition of ${word}`,\n                example: `Example sentence with ${word}.`\n            }));\n    }\n    simplifyText(text, studentLevel) {\n        // Basic text simplification based on level\n        const maxLength = {\n            A1: 200,\n            A2: 300,\n            B1: 400,\n            B2: 500,\n            C1: 600\n        };\n        const limit = maxLength[studentLevel] || 400;\n        return text.substring(0, limit) + (text.length > limit ? \"...\" : \"\");\n    }\n    getTemplateComprehension(lessonType, studentLevel) {\n        return [\n            \"What is the main idea of this text?\",\n            \"What supporting details can you identify?\",\n            \"How does this relate to your experience?\",\n            \"What conclusions can you draw?\"\n        ];\n    }\n    getTemplateDiscussion(lessonType, studentLevel) {\n        const templates = {\n            discussion: [\n                \"What is your opinion on this topic?\",\n                \"How would you handle this situation?\",\n                \"What alternative approaches exist?\"\n            ],\n            business: [\n                \"How would you apply this professionally?\",\n                \"What business challenges does this address?\",\n                \"How would you present this to colleagues?\"\n            ],\n            travel: [\n                \"How would this help while traveling?\",\n                \"What preparations would you make?\",\n                \"How would you share this experience?\"\n            ]\n        };\n        return templates[lessonType] || templates.discussion;\n    }\n    getTemplateGrammar(studentLevel) {\n        const grammarFoci = {\n            A1: \"Present Simple Tense\",\n            A2: \"Past Simple Tense\",\n            B1: \"Present Perfect Tense\",\n            B2: \"Conditional Sentences\",\n            C1: \"Advanced Grammar Structures\"\n        };\n        return {\n            focus: grammarFoci[studentLevel] || \"Present Perfect Tense\",\n            examples: [\n                \"I have learned many new things.\",\n                \"She has improved her skills.\",\n                \"We have discussed this topic.\"\n            ],\n            exercise: [\n                \"I _____ (learn) a lot today.\",\n                \"They _____ (complete) the project.\",\n                \"She _____ (improve) significantly.\"\n            ]\n        };\n    }\n    getTemplatePronunciation(text) {\n        // Extract a challenging word from the text\n        const words = text.match(/\\b[a-z]{6,}\\b/gi) || [\n            \"communication\"\n        ];\n        const selectedWord = words[0] || \"communication\";\n        return {\n            word: selectedWord.toLowerCase(),\n            ipa: \"/kÉ™ËŒmjuËnÉªËˆkeÉªÊƒÉ™n/\",\n            practice: `Practice saying: \"${selectedWord}\" in a sentence.`\n        };\n    }\n    getTemplateWrapup(lessonType) {\n        return [\n            \"What new vocabulary did you learn?\",\n            \"Which concepts need more practice?\",\n            \"How will you use this knowledge?\",\n            \"What questions do you still have?\"\n        ];\n    }\n    // New helper methods for enhanced contextual analysis\n    extractTopicsFromHeadings(headings) {\n        return headings.filter((h)=>h.level <= 3) // Focus on main headings\n        .map((h)=>h.text).slice(0, 5);\n    }\n    extractTopicsFromText(text, headings) {\n        // First try to get topics from headings\n        const headingTopics = this.extractTopicsFromHeadings(headings);\n        if (headingTopics.length > 0) {\n            return headingTopics;\n        }\n        // Fallback: extract key phrases from text\n        const sentences = text.split(/[.!?]+/).filter((s)=>s.trim().length > 20);\n        const topics = [];\n        // Look for common topic indicators\n        const topicPatterns = [\n            /about (.+?)(?:\\s|,|\\.)/gi,\n            /discuss (.+?)(?:\\s|,|\\.)/gi,\n            /focus on (.+?)(?:\\s|,|\\.)/gi,\n            /regarding (.+?)(?:\\s|,|\\.)/gi\n        ];\n        for (const sentence of sentences.slice(0, 5)){\n            for (const pattern of topicPatterns){\n                const matches = sentence.match(pattern);\n                if (matches) {\n                    topics.push(...matches.map((m)=>m.replace(pattern, \"$1\").trim()).slice(0, 2));\n                }\n            }\n        }\n        // If no patterns found, extract key nouns\n        if (topics.length === 0) {\n            const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n            const commonWords = [\n                \"this\",\n                \"that\",\n                \"with\",\n                \"from\",\n                \"they\",\n                \"have\",\n                \"been\",\n                \"will\",\n                \"more\",\n                \"some\",\n                \"what\",\n                \"when\",\n                \"where\",\n                \"which\",\n                \"their\",\n                \"would\",\n                \"could\",\n                \"should\"\n            ];\n            const keyWords = words.filter((word)=>!commonWords.includes(word)).filter((word, index, arr)=>arr.indexOf(word) === index) // unique\n            .slice(0, 3);\n            return keyWords.length > 0 ? keyWords : [\n                \"AI technology\",\n                \"mobile devices\",\n                \"privacy\"\n            ];\n        }\n        return topics.slice(0, 3);\n    }\n    extractVocabularyFromText(text, level) {\n        // Extract words based on complexity appropriate for the level\n        const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words));\n        // Filter by complexity based on level\n        const complexityThreshold = {\n            \"A1\": 6,\n            \"A2\": 7,\n            \"B1\": 8,\n            \"B2\": 10,\n            \"C1\": 12\n        };\n        const maxLength = complexityThreshold[level] || 8;\n        return uniqueWords.filter((word)=>word.length <= maxLength && word.length >= 4).slice(0, 8);\n    }\n    determineCulturalContext(domain, text) {\n        // Determine cultural context based on domain and content\n        const culturalIndicators = {\n            \"bbc.com\": \"British English, UK culture\",\n            \"cnn.com\": \"American English, US culture\",\n            \"wikipedia.org\": \"International, encyclopedic\",\n            \"nytimes.com\": \"American English, US perspective\",\n            \"theguardian.com\": \"British English, UK perspective\"\n        };\n        if (culturalIndicators[domain]) {\n            return culturalIndicators[domain];\n        }\n        // Analyze text for cultural markers\n        const americanMarkers = [\n            \"dollar\",\n            \"president\",\n            \"congress\",\n            \"state\",\n            \"federal\"\n        ];\n        const britishMarkers = [\n            \"pound\",\n            \"minister\",\n            \"parliament\",\n            \"council\",\n            \"government\"\n        ];\n        const americanCount = americanMarkers.filter((marker)=>text.toLowerCase().includes(marker)).length;\n        const britishCount = britishMarkers.filter((marker)=>text.toLowerCase().includes(marker)).length;\n        if (americanCount > britishCount) {\n            return \"American English context\";\n        } else if (britishCount > americanCount) {\n            return \"British English context\";\n        }\n        return \"International context\";\n    }\n    generateLearningObjectives(contentType, topics, level) {\n        const objectives = [];\n        // Base objectives on content type\n        switch(contentType){\n            case \"news\":\n                objectives.push(\"Understand current events vocabulary\");\n                objectives.push(\"Practice reading news articles\");\n                break;\n            case \"blog\":\n                objectives.push(\"Learn informal writing style\");\n                objectives.push(\"Understand personal opinions and experiences\");\n                break;\n            case \"tutorial\":\n                objectives.push(\"Follow step-by-step instructions\");\n                objectives.push(\"Learn technical vocabulary\");\n                break;\n            case \"encyclopedia\":\n                objectives.push(\"Understand factual information\");\n                objectives.push(\"Learn academic vocabulary\");\n                break;\n            default:\n                objectives.push(\"Improve reading comprehension\");\n                objectives.push(\"Expand vocabulary knowledge\");\n        }\n        // Add topic-specific objectives\n        topics.slice(0, 2).forEach((topic)=>{\n            objectives.push(`Discuss topics related to ${topic.toLowerCase()}`);\n        });\n        return objectives.slice(0, 4);\n    }\n    getAudienceLevel(cefrLevel) {\n        const levelMap = {\n            \"A1\": \"beginner\",\n            \"A2\": \"beginner\",\n            \"B1\": \"general\",\n            \"B2\": \"general\",\n            \"C1\": \"expert\"\n        };\n        return levelMap[cefrLevel] || \"general\";\n    }\n    // Enhanced fallback lesson generation with context\n    generateEnhancedFallbackLesson(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage, contentMetadata, structuredContent } = params;\n        console.log(\"\\uD83D\\uDD04 Generating enhanced fallback lesson with contextual warm-up...\");\n        // Use available context even in fallback\n        const topics = structuredContent?.headings?.map((h)=>h.text).slice(0, 3) || [];\n        const contentType = contentMetadata?.contentType || \"general\";\n        // Create mock content analysis for fallback warm-up generation\n        const mockContentAnalysis = {\n            topics: topics,\n            contentType: contentType,\n            sourceCountry: this.determineSourceCountry(contentMetadata?.domain || \"\"),\n            culturalContext: this.determineCulturalContext(contentMetadata?.domain || \"\", sourceText)\n        };\n        // Generate contextual warm-up questions even in fallback\n        const contextualWarmup = this.getContextualWarmupFallback(studentLevel, mockContentAnalysis, contentMetadata);\n        console.log(\"\\uD83D\\uDD25 Generated fallback contextual warm-up:\", contextualWarmup);\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: contextualWarmup,\n                vocabulary: this.extractContextualVocabulary(sourceText, studentLevel, topics),\n                reading: this.simplifyText(sourceText, studentLevel),\n                comprehension: this.getContextualComprehension(lessonType, studentLevel, topics),\n                discussion: this.getContextualDiscussion(lessonType, studentLevel, topics),\n                grammar: this.getTemplateGrammar(studentLevel),\n                pronunciation: this.getTemplatePronunciation(sourceText),\n                wrapup: this.getContextualWrapup(lessonType, topics)\n            }\n        };\n    }\n    getContextualWarmup(lessonType, studentLevel, topics, contentType) {\n        // Use the same contextual fallback logic\n        const mockAnalysis = {\n            topics: topics,\n            contentType: contentType,\n            sourceCountry: \"International\"\n        };\n        return this.getContextualWarmupFallback(studentLevel, mockAnalysis, {\n            title: topics[0] || \"Content\"\n        });\n    }\n    // Basic fallback for complete failures\n    generateBasicFallbackLesson(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage } = params;\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: [\n                    \"What do you already know about this topic?\",\n                    \"Have you had similar experiences?\",\n                    \"What would you like to learn?\"\n                ],\n                vocabulary: [],\n                reading: sourceText.substring(0, 400),\n                comprehension: [\n                    \"What is the main idea?\",\n                    \"What details can you identify?\"\n                ],\n                discussion: [\n                    \"What is your opinion?\",\n                    \"How would you handle this?\"\n                ],\n                grammar: this.getTemplateGrammar(studentLevel),\n                pronunciation: {\n                    word: \"example\",\n                    ipa: \"/ÉªÉ¡Ëˆz\\xe6mpÉ™l/\",\n                    practice: \"Practice saying example.\"\n                },\n                wrapup: [\n                    \"What did you learn?\",\n                    \"What needs more practice?\"\n                ]\n            }\n        };\n    }\n    extractContextualVocabulary(text, studentLevel, topics) {\n        const vocabulary = this.extractVocabulary(text, studentLevel);\n        // Enhance with topic context if available\n        if (topics.length > 0) {\n            return vocabulary.map((vocab, index)=>({\n                    ...vocab,\n                    context: index < topics.length ? `Related to ${topics[index].toLowerCase()}` : vocab.meaning\n                }));\n        }\n        return vocabulary;\n    }\n    getContextualComprehension(lessonType, studentLevel, topics) {\n        const baseQuestions = this.getTemplateComprehension(lessonType, studentLevel);\n        if (topics.length > 0) {\n            return [\n                `What is the main point about ${topics[0]?.toLowerCase()}?`,\n                `How does the text explain ${topics[1]?.toLowerCase() || \"the topic\"}?`,\n                \"What supporting details can you identify?\",\n                \"What conclusions can you draw from this information?\"\n            ];\n        }\n        return baseQuestions;\n    }\n    getContextualDiscussion(lessonType, studentLevel, topics) {\n        const baseQuestions = this.getTemplateDiscussion(lessonType, studentLevel);\n        if (topics.length > 0) {\n            return [\n                `What is your opinion about ${topics[0]?.toLowerCase()}?`,\n                `How would you apply this information about ${topics[1]?.toLowerCase() || \"this topic\"}?`,\n                `What are the implications of what you learned about ${topics[0]?.toLowerCase()}?`\n            ];\n        }\n        return baseQuestions;\n    }\n    getContextualWrapup(lessonType, topics) {\n        if (topics.length > 0) {\n            return [\n                `What new vocabulary did you learn about ${topics[0]?.toLowerCase()}?`,\n                `Which concepts about ${topics[1]?.toLowerCase() || \"this topic\"} need more practice?`,\n                \"How will you use this knowledge in real situations?\",\n                \"What questions do you still have about this content?\"\n            ];\n        }\n        return this.getTemplateWrapup(lessonType);\n    }\n    // Smart template-based lesson generation\n    generateSmartTemplateLesson(sourceText, contentAnalysis, lessonType, studentLevel, targetLanguage, metadata) {\n        console.log(\"\\uD83C\\uDFA8 Generating smart template lesson...\");\n        const topics = contentAnalysis.topics;\n        const vocabulary = contentAnalysis.keyVocabulary;\n        const title = metadata?.title || \"Content\";\n        return {\n            warmup: this.generateSmartWarmupQuestions(topics, studentLevel, contentAnalysis),\n            vocabulary: this.generateSmartVocabulary(vocabulary, sourceText, studentLevel),\n            reading: this.generateSmartReading(sourceText, studentLevel),\n            comprehension: this.generateSmartComprehension(topics, studentLevel),\n            discussion: this.generateSmartDiscussion(topics, lessonType, studentLevel),\n            grammar: this.generateSmartGrammar(studentLevel, sourceText),\n            pronunciation: this.generateSmartPronunciation(vocabulary),\n            wrapup: this.generateSmartWrapup(topics, studentLevel)\n        };\n    }\n    // Smart warm-up questions based on content (prior knowledge activation)\n    generateSmartWarmupQuestions(topics, studentLevel, contentAnalysis) {\n        const topic = topics[0] || \"this topic\";\n        const secondTopic = topics[1] || \"technology\";\n        // Focus on activating prior knowledge, not assuming content knowledge\n        const levelQuestions = {\n            \"A1\": [\n                `Do you know about ${topic.toLowerCase()}?`,\n                `Is ${topic.toLowerCase()} popular in your country?`,\n                `Do you like ${topic.toLowerCase()}?`\n            ],\n            \"A2\": [\n                `Have you heard about ${topic.toLowerCase()} before?`,\n                `What do you already know about ${topic.toLowerCase()}?`,\n                `Is ${topic.toLowerCase()} common in your country?`\n            ],\n            \"B1\": [\n                `What comes to mind when you hear about ${topic.toLowerCase()}?`,\n                `Have you had any experience with ${topic.toLowerCase()}?`,\n                `What would you like to know about ${topic.toLowerCase()}?`\n            ],\n            \"B2\": [\n                `What is your general opinion about ${topic.toLowerCase()}?`,\n                `How familiar are you with ${topic.toLowerCase()}?`,\n                `What role does ${topic.toLowerCase()} play in your daily life?`\n            ],\n            \"C1\": [\n                `How would you describe the significance of ${topic.toLowerCase()} in modern society?`,\n                `What are your thoughts on the current state of ${topic.toLowerCase()}?`,\n                `How do you think ${topic.toLowerCase()} has evolved over time?`\n            ]\n        };\n        return levelQuestions[studentLevel] || levelQuestions[\"B1\"];\n    }\n    // Smart vocabulary with contextual examples\n    generateSmartVocabulary(vocabulary, sourceText, studentLevel) {\n        return vocabulary.slice(0, 6).map((word)=>{\n            // Find the word in context\n            const sentences = sourceText.split(/[.!?]+/);\n            const contextSentence = sentences.find((s)=>s.toLowerCase().includes(word.toLowerCase()));\n            return {\n                word: word,\n                meaning: this.generateWordMeaning(word, studentLevel),\n                example: contextSentence ? contextSentence.trim().substring(0, 100) + (contextSentence.length > 100 ? \"...\" : \"\") : `This is an example sentence with ${word}.`\n            };\n        });\n    }\n    // Generate word meanings based on level\n    generateWordMeaning(word, level) {\n        // Simple definitions based on level\n        const commonMeanings = {\n            \"efficient\": level === \"A1\" || level === \"A2\" ? \"working well and fast\" : \"achieving maximum productivity with minimum wasted effort\",\n            \"technology\": level === \"A1\" || level === \"A2\" ? \"computers and machines\" : \"the application of scientific knowledge for practical purposes\",\n            \"privacy\": level === \"A1\" || level === \"A2\" ? \"keeping things secret\" : \"the state of being free from public attention\",\n            \"device\": level === \"A1\" || level === \"A2\" ? \"a machine or tool\" : \"a piece of equipment designed for a particular purpose\",\n            \"processing\": level === \"A1\" || level === \"A2\" ? \"working with information\" : \"performing operations on data\",\n            \"compact\": level === \"A1\" || level === \"A2\" ? \"small and neat\" : \"closely and neatly packed together\",\n            \"version\": level === \"A1\" || level === \"A2\" ? \"a type of something\" : \"a particular form of something\",\n            \"family\": level === \"A1\" || level === \"A2\" ? \"a group of related things\" : \"a group of related objects or concepts\",\n            \"nano\": level === \"A1\" || level === \"A2\" ? \"very small\" : \"extremely small in scale\",\n            \"gemini\": level === \"A1\" || level === \"A2\" ? \"a type of AI\" : \"an artificial intelligence system developed by Google\"\n        };\n        return commonMeanings[word.toLowerCase()] || `A word meaning ${word.toLowerCase()}`;\n    }\n    // Smart reading passage adaptation\n    generateSmartReading(sourceText, studentLevel) {\n        const maxLength = {\n            \"A1\": 200,\n            \"A2\": 300,\n            \"B1\": 400,\n            \"B2\": 500,\n            \"C1\": 600\n        };\n        const targetLength = maxLength[studentLevel] || 400;\n        // Simplify sentences for lower levels\n        if (studentLevel === \"A1\" || studentLevel === \"A2\") {\n            const sentences = sourceText.split(/[.!?]+/);\n            const simplifiedSentences = sentences.filter((s)=>s.trim().length > 10).map((s)=>s.trim()).slice(0, 8) // Limit number of sentences\n            ;\n            return simplifiedSentences.join(\". \").substring(0, targetLength);\n        }\n        return sourceText.substring(0, targetLength);\n    }\n    // Smart comprehension questions\n    generateSmartComprehension(topics, studentLevel) {\n        const topic = topics[0] || \"the content\";\n        const levelQuestions = {\n            \"A1\": [\n                `What is ${topic.toLowerCase()}?`,\n                \"What is the main idea?\",\n                \"Is this information new to you?\"\n            ],\n            \"A2\": [\n                `What does the text say about ${topic.toLowerCase()}?`,\n                \"What are the main points?\",\n                \"Do you agree with the information?\"\n            ],\n            \"B1\": [\n                `How does the text explain ${topic.toLowerCase()}?`,\n                \"What supporting details are provided?\",\n                \"What conclusions can you draw?\",\n                \"How does this relate to your experience?\"\n            ],\n            \"B2\": [\n                `What is the author's perspective on ${topic.toLowerCase()}?`,\n                \"What evidence supports the main arguments?\",\n                \"What are the implications of this information?\",\n                \"How might this affect different groups of people?\"\n            ],\n            \"C1\": [\n                `How does the author's treatment of ${topic.toLowerCase()} reflect broader themes?`,\n                \"What underlying assumptions can you identify?\",\n                \"How might this information be interpreted differently in various contexts?\",\n                \"What are the potential long-term consequences discussed?\"\n            ]\n        };\n        return levelQuestions[studentLevel] || levelQuestions[\"B1\"];\n    }\n    // Smart discussion questions\n    generateSmartDiscussion(topics, lessonType, studentLevel) {\n        const topic = topics[0] || \"this topic\";\n        const secondTopic = topics[1] || \"technology\";\n        const levelQuestions = {\n            \"A1\": [\n                `Do you like ${topic.toLowerCase()}? Why?`,\n                `Is ${topic.toLowerCase()} good or bad?`,\n                `Would you recommend ${topic.toLowerCase()} to friends?`\n            ],\n            \"A2\": [\n                `What is your opinion about ${topic.toLowerCase()}?`,\n                `How do you use ${topic.toLowerCase()} in your life?`,\n                `What problems can ${topic.toLowerCase()} cause?`\n            ],\n            \"B1\": [\n                `What are the advantages and disadvantages of ${topic.toLowerCase()}?`,\n                `How has ${topic.toLowerCase()} changed over time?`,\n                `What would happen if ${topic.toLowerCase()} didn't exist?`\n            ],\n            \"B2\": [\n                `How might ${topic.toLowerCase()} impact society in the next decade?`,\n                `What ethical considerations surround ${topic.toLowerCase()}?`,\n                `How does ${topic.toLowerCase()} differ across cultures?`\n            ],\n            \"C1\": [\n                `What are the broader societal implications of ${topic.toLowerCase()}?`,\n                `How might ${topic.toLowerCase()} reshape our understanding of ${secondTopic.toLowerCase()}?`,\n                `What role should regulation play in ${topic.toLowerCase()}?`\n            ]\n        };\n        return levelQuestions[studentLevel] || levelQuestions[\"B1\"];\n    }\n    // Smart grammar focus\n    generateSmartGrammar(studentLevel, sourceText) {\n        const grammarFocus = {\n            \"A1\": {\n                focus: \"Present Simple\",\n                examples: [\n                    \"It is efficient.\",\n                    \"This works well.\",\n                    \"People use technology.\"\n                ],\n                exercise: [\n                    \"It _____ (be) very useful.\",\n                    \"Technology _____ (help) people.\",\n                    \"This _____ (work) on phones.\"\n                ]\n            },\n            \"A2\": {\n                focus: \"Present Continuous and Simple\",\n                examples: [\n                    \"It is working on your device.\",\n                    \"People are using this technology.\",\n                    \"It helps with privacy.\"\n                ],\n                exercise: [\n                    \"It _____ (work) right now.\",\n                    \"People _____ (use) it every day.\",\n                    \"This _____ (help) with security.\"\n                ]\n            },\n            \"B1\": {\n                focus: \"Present Perfect\",\n                examples: [\n                    \"Technology has improved significantly.\",\n                    \"It has become more efficient.\",\n                    \"Users have experienced better privacy.\"\n                ],\n                exercise: [\n                    \"Technology _____ (improve) a lot.\",\n                    \"It _____ (become) very popular.\",\n                    \"People _____ (start) using it more.\"\n                ]\n            },\n            \"B2\": {\n                focus: \"Passive Voice\",\n                examples: [\n                    \"It is designed for mobile devices.\",\n                    \"Privacy is enhanced by this technology.\",\n                    \"Data is processed locally.\"\n                ],\n                exercise: [\n                    \"It _____ (design) for phones.\",\n                    \"Privacy _____ (improve) significantly.\",\n                    \"Information _____ (process) safely.\"\n                ]\n            },\n            \"C1\": {\n                focus: \"Complex Sentence Structures\",\n                examples: [\n                    \"Having been designed for efficiency, it operates seamlessly.\",\n                    \"The technology, which prioritizes privacy, has gained popularity.\"\n                ],\n                exercise: [\n                    \"_____ (design) for mobile use, it works offline.\",\n                    \"The system, _____ (focus) on privacy, appeals to users.\"\n                ]\n            }\n        };\n        return grammarFocus[studentLevel] || grammarFocus[\"B1\"];\n    }\n    // Smart pronunciation\n    generateSmartPronunciation(vocabulary) {\n        const word = vocabulary.find((w)=>w.length > 6) || vocabulary[0] || \"technology\";\n        const pronunciations = {\n            \"technology\": \"/tekËˆnÉ’lÉ™dÊ’i/\",\n            \"efficient\": \"/ÉªËˆfÉªÊƒÉ™nt/\",\n            \"privacy\": \"/ËˆpraÉªvÉ™si/\",\n            \"processing\": \"/ËˆprÉ™ÊŠsesÉªÅ‹/\",\n            \"device\": \"/dÉªËˆvaÉªs/\",\n            \"artificial\": \"/ËŒÉ‘ËtÉªËˆfÉªÊƒÉ™l/\",\n            \"intelligence\": \"/ÉªnËˆtelÉªdÊ’É™ns/\",\n            \"compact\": \"/kÉ™mËˆp\\xe6kt/\",\n            \"version\": \"/ËˆvÉœËÊƒÉ™n/\",\n            \"family\": \"/Ëˆf\\xe6mÉ™li/\",\n            \"nano\": \"/Ëˆn\\xe6noÊŠ/\",\n            \"gemini\": \"/ËˆdÊ’emÉªnaÉª/\"\n        };\n        return {\n            word: word,\n            ipa: pronunciations[word.toLowerCase()] || `/ËˆwÉœËrd/`,\n            practice: `Practice saying \"${word}\" in this sentence: This ${word} is very useful.`\n        };\n    }\n    // Smart wrap-up questions\n    generateSmartWrapup(topics, studentLevel) {\n        const topic = topics[0] || \"this topic\";\n        return [\n            `What new vocabulary did you learn about ${topic.toLowerCase()}?`,\n            `Which concepts about ${topic.toLowerCase()} need more practice?`,\n            \"How will you use this knowledge in real situations?\",\n            \"What questions do you still have about this content?\"\n        ];\n    }\n    // Helper method to determine source country from domain\n    determineSourceCountry(domain) {\n        const countryMap = {\n            \"bbc.com\": \"United Kingdom\",\n            \"bbc.co.uk\": \"United Kingdom\",\n            \"cnn.com\": \"United States\",\n            \"nytimes.com\": \"United States\",\n            \"theguardian.com\": \"United Kingdom\",\n            \"washingtonpost.com\": \"United States\",\n            \"reuters.com\": \"International\",\n            \"ap.org\": \"United States\",\n            \"npr.org\": \"United States\",\n            \"abc.net.au\": \"Australia\",\n            \"cbc.ca\": \"Canada\"\n        };\n        for (const [domainKey, country] of Object.entries(countryMap)){\n            if (domain.includes(domainKey)) {\n                return country;\n            }\n        }\n        return \"International\";\n    }\n    // Fallback warm-up question generator\n    getFallbackWarmupQuestion(level, contentAnalysis, questionIndex) {\n        const topic = contentAnalysis.topics[0] || \"this topic\";\n        const contentType = contentAnalysis.contentType;\n        const fallbackQuestions = {\n            \"A1\": [\n                `Do you know about ${topic.toLowerCase()}?`,\n                `Is ${topic.toLowerCase()} important in your country?`,\n                `Do you like to read about ${topic.toLowerCase()}?`\n            ],\n            \"A2\": [\n                `Have you heard about ${topic.toLowerCase()} before?`,\n                `What do you know about ${topic.toLowerCase()}?`,\n                `Is ${topic.toLowerCase()} different in your country?`\n            ],\n            \"B1\": [\n                `What do you think about ${topic.toLowerCase()}?`,\n                `How is ${topic.toLowerCase()} important in your daily life?`,\n                `What would you like to know about ${topic.toLowerCase()}?`\n            ],\n            \"B2\": [\n                `What are your thoughts on ${topic.toLowerCase()}?`,\n                `How might ${topic.toLowerCase()} affect people in different countries?`,\n                `What questions would you ask about ${topic.toLowerCase()}?`\n            ],\n            \"C1\": [\n                `How do cultural perspectives influence attitudes toward ${topic.toLowerCase()}?`,\n                `What are the broader implications of ${topic.toLowerCase()} in modern society?`,\n                `How might ${topic.toLowerCase()} evolve in the coming years?`\n            ]\n        };\n        const levelQuestions = fallbackQuestions[level] || fallbackQuestions[\"B1\"];\n        return levelQuestions[questionIndex] || levelQuestions[0];\n    }\n    // Contextual warm-up fallback when AI fails\n    getContextualWarmupFallback(level, contentAnalysis, metadata) {\n        const topic = contentAnalysis.topics[0] || \"this topic\";\n        const sourceCountry = contentAnalysis.sourceCountry || \"this country\";\n        const title = metadata?.title || \"this content\";\n        const fallbackSets = {\n            \"A1\": [\n                `Do you know about ${topic.toLowerCase()}?`,\n                `Is this topic common in your country?`,\n                `Do you want to learn about ${topic.toLowerCase()}?`\n            ],\n            \"A2\": [\n                `Have you experienced ${topic.toLowerCase()} before?`,\n                `What is ${topic.toLowerCase()} like in your country?`,\n                `Why is ${topic.toLowerCase()} interesting to you?`\n            ],\n            \"B1\": [\n                `What do you think about ${topic.toLowerCase()}?`,\n                `How is ${topic.toLowerCase()} different in your country compared to ${sourceCountry}?`,\n                `What would you expect to learn from this ${contentAnalysis.contentType}?`\n            ],\n            \"B2\": [\n                `What are your thoughts on how ${topic.toLowerCase()} is presented in ${sourceCountry} media?`,\n                `What challenges do you think people face with ${topic.toLowerCase()}?`,\n                `How might your perspective on ${topic.toLowerCase()} differ from the author's?`\n            ],\n            \"C1\": [\n                `How do cultural attitudes toward ${topic.toLowerCase()} vary between ${sourceCountry} and your country?`,\n                `What are the broader societal implications of ${topic.toLowerCase()}?`,\n                `How might the perspective in this ${contentAnalysis.contentType} reflect ${sourceCountry} values?`\n            ]\n        };\n        return fallbackSets[level] || fallbackSets[\"B1\"];\n    }\n    constructor(){\n        this.googleAI = null;\n    }\n}\nconst lessonAIServerGenerator = new LessonAIServerGenerator();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O2dCQUNqRCxDQUFDLE9BQU8sRUFBRWdFLE1BQU1oRSxXQUFXLEdBQUcsdUNBQXVDLEVBQUV5QyxjQUFjLENBQUMsQ0FBQztnQkFDdkYsQ0FBQyx5Q0FBeUMsRUFBRVksZ0JBQWdCcEIsV0FBVyxDQUFDLENBQUMsQ0FBQzthQUMzRTtZQUNELE1BQU07Z0JBQ0osQ0FBQyw4QkFBOEIsRUFBRStCLE1BQU1oRSxXQUFXLEdBQUcsaUJBQWlCLEVBQUV5QyxjQUFjLE9BQU8sQ0FBQztnQkFDOUYsQ0FBQyw4Q0FBOEMsRUFBRXVCLE1BQU1oRSxXQUFXLEdBQUcsQ0FBQyxDQUFDO2dCQUN2RSxDQUFDLDhCQUE4QixFQUFFZ0UsTUFBTWhFLFdBQVcsR0FBRywwQkFBMEIsQ0FBQzthQUNqRjtZQUNELE1BQU07Z0JBQ0osQ0FBQyxpQ0FBaUMsRUFBRWdFLE1BQU1oRSxXQUFXLEdBQUcsY0FBYyxFQUFFeUMsY0FBYyxrQkFBa0IsQ0FBQztnQkFDekcsQ0FBQyw4Q0FBOEMsRUFBRXVCLE1BQU1oRSxXQUFXLEdBQUcsQ0FBQyxDQUFDO2dCQUN2RSxDQUFDLGtDQUFrQyxFQUFFcUQsZ0JBQWdCcEIsV0FBVyxDQUFDLFNBQVMsRUFBRVEsY0FBYyxRQUFRLENBQUM7YUFDcEc7UUFDSDtRQUVBLE9BQU8wSyxZQUFZLENBQUNsRixNQUFNLElBQUlrRixZQUFZLENBQUMsS0FBSztJQUNsRDs7YUFqbkRRalIsV0FBa0U7O0FBa25ENUU7QUFFTyxNQUFNa1IsMEJBQTBCLElBQUlwUiwwQkFBeUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL2xlc3Nvbi1haS1nZW5lcmF0b3Itc2VydmVyLnRzPzBiYjEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlR29vZ2xlQUlTZXJ2ZXJTZXJ2aWNlIH0gZnJvbSBcIi4vZ29vZ2xlLWFpLXNlcnZlclwiXG5cbmludGVyZmFjZSBMZXNzb25HZW5lcmF0aW9uUGFyYW1zIHtcbiAgc291cmNlVGV4dDogc3RyaW5nXG4gIGxlc3NvblR5cGU6IHN0cmluZ1xuICBzdHVkZW50TGV2ZWw6IHN0cmluZ1xuICB0YXJnZXRMYW5ndWFnZTogc3RyaW5nXG4gIHNvdXJjZVVybD86IHN0cmluZ1xuICBjb250ZW50TWV0YWRhdGE/OiB7XG4gICAgdGl0bGU/OiBzdHJpbmdcbiAgICBkZXNjcmlwdGlvbj86IHN0cmluZ1xuICAgIGF1dGhvcj86IHN0cmluZ1xuICAgIHB1Ymxpc2hEYXRlPzogc3RyaW5nXG4gICAgY29udGVudFR5cGU/OiBzdHJpbmdcbiAgICBkb21haW4/OiBzdHJpbmdcbiAgICBsYW5ndWFnZT86IHN0cmluZ1xuICAgIGtleXdvcmRzPzogc3RyaW5nW11cbiAgfVxuICBzdHJ1Y3R1cmVkQ29udGVudD86IHtcbiAgICBoZWFkaW5ncz86IEFycmF5PHsgbGV2ZWw6IG51bWJlcjsgdGV4dDogc3RyaW5nIH0+XG4gICAgcGFyYWdyYXBocz86IHN0cmluZ1tdXG4gICAgbGlzdHM/OiBBcnJheTx7IHR5cGU6IHN0cmluZzsgaXRlbXM6IHN0cmluZ1tdIH0+XG4gICAgcXVvdGVzPzogc3RyaW5nW11cbiAgICBpbWFnZXM/OiBBcnJheTx7IGFsdDogc3RyaW5nOyBzcmM6IHN0cmluZyB9PlxuICAgIGxpbmtzPzogQXJyYXk8eyB0ZXh0OiBzdHJpbmc7IHVybDogc3RyaW5nIH0+XG4gIH1cbiAgd29yZENvdW50PzogbnVtYmVyXG4gIHJlYWRpbmdUaW1lPzogbnVtYmVyXG59XG5cbmludGVyZmFjZSBHZW5lcmF0ZWRMZXNzb24ge1xuICBsZXNzb25UeXBlOiBzdHJpbmdcbiAgc3R1ZGVudExldmVsOiBzdHJpbmdcbiAgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZ1xuICBzZWN0aW9uczoge1xuICAgIHdhcm11cDogc3RyaW5nW11cbiAgICB2b2NhYnVsYXJ5OiBBcnJheTx7IHdvcmQ6IHN0cmluZzsgbWVhbmluZzogc3RyaW5nOyBleGFtcGxlOiBzdHJpbmcgfT5cbiAgICByZWFkaW5nOiBzdHJpbmdcbiAgICBjb21wcmVoZW5zaW9uOiBzdHJpbmdbXVxuICAgIGRpc2N1c3Npb246IHN0cmluZ1tdXG4gICAgZ3JhbW1hcjoge1xuICAgICAgZm9jdXM6IHN0cmluZ1xuICAgICAgZXhhbXBsZXM6IHN0cmluZ1tdXG4gICAgICBleGVyY2lzZTogc3RyaW5nW11cbiAgICB9XG4gICAgcHJvbnVuY2lhdGlvbjoge1xuICAgICAgd29yZDogc3RyaW5nXG4gICAgICBpcGE6IHN0cmluZ1xuICAgICAgcHJhY3RpY2U6IHN0cmluZ1xuICAgIH1cbiAgICB3cmFwdXA6IHN0cmluZ1tdXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIExlc3NvbkFJU2VydmVyR2VuZXJhdG9yIHtcbiAgcHJpdmF0ZSBnb29nbGVBSTogUmV0dXJuVHlwZTx0eXBlb2YgY3JlYXRlR29vZ2xlQUlTZXJ2ZXJTZXJ2aWNlPiB8IG51bGwgPSBudWxsXG5cbiAgcHJpdmF0ZSBnZXRHb29nbGVBSSgpIHtcbiAgICBpZiAoIXRoaXMuZ29vZ2xlQUkpIHtcbiAgICAgIHRoaXMuZ29vZ2xlQUkgPSBjcmVhdGVHb29nbGVBSVNlcnZlclNlcnZpY2UoKVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5nb29nbGVBSVxuICB9XG5cbiAgYXN5bmMgZ2VuZXJhdGVMZXNzb24ocGFyYW1zOiBMZXNzb25HZW5lcmF0aW9uUGFyYW1zKTogUHJvbWlzZTxHZW5lcmF0ZWRMZXNzb24+IHtcbiAgICBjb25zdCB7XG4gICAgICBzb3VyY2VUZXh0LFxuICAgICAgbGVzc29uVHlwZSxcbiAgICAgIHN0dWRlbnRMZXZlbCxcbiAgICAgIHRhcmdldExhbmd1YWdlLFxuICAgICAgc291cmNlVXJsLFxuICAgICAgY29udGVudE1ldGFkYXRhLFxuICAgICAgc3RydWN0dXJlZENvbnRlbnQsXG4gICAgICB3b3JkQ291bnQsXG4gICAgICByZWFkaW5nVGltZVxuICAgIH0gPSBwYXJhbXNcblxuICAgIGNvbnNvbGUubG9nKFwi8J+agCBTdGFydGluZyBvcHRpbWl6ZWQgQUkgbGVzc29uIGdlbmVyYXRpb24gd2l0aCBwYXJhbXM6XCIsIHtcbiAgICAgIHRleHRMZW5ndGg6IHNvdXJjZVRleHQubGVuZ3RoLFxuICAgICAgbGVzc29uVHlwZSxcbiAgICAgIHN0dWRlbnRMZXZlbCxcbiAgICAgIHRhcmdldExhbmd1YWdlLFxuICAgICAgaGFzTWV0YWRhdGE6ICEhY29udGVudE1ldGFkYXRhLFxuICAgICAgaGFzU3RydWN0dXJlZENvbnRlbnQ6ICEhc3RydWN0dXJlZENvbnRlbnRcbiAgICB9KVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFVzZSB1bHRyYS1taW5pbWFsIEFJIGFwcHJvYWNoIHRvIGF2b2lkIE1BWF9UT0tFTlNcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+kliBTdGVwIDE6IEdlbmVyYXRpbmcgbGVzc29uIHdpdGggdWx0cmEtbWluaW1hbCBBSSBwcm9tcHRzLi4uXCIpXG4gICAgICBjb25zdCBsZXNzb25TdHJ1Y3R1cmUgPSBhd2FpdCB0aGlzLmdlbmVyYXRlTWluaW1hbEFJTGVzc29uKFxuICAgICAgICBzb3VyY2VUZXh0LFxuICAgICAgICBsZXNzb25UeXBlLFxuICAgICAgICBzdHVkZW50TGV2ZWwsXG4gICAgICAgIHRhcmdldExhbmd1YWdlLFxuICAgICAgICBjb250ZW50TWV0YWRhdGFcbiAgICAgIClcbiAgICAgIGNvbnNvbGUubG9nKFwi4pyFIE1pbmltYWwgQUkgbGVzc29uIGdlbmVyYXRlZDpcIiwgT2JqZWN0LmtleXMobGVzc29uU3RydWN0dXJlKSlcblxuICAgICAgLy8gUmV0dXJuIHByb3Blcmx5IHN0cnVjdHVyZWQgR2VuZXJhdGVkTGVzc29uIG9iamVjdFxuICAgICAgY29uc3QgZmluYWxMZXNzb246IEdlbmVyYXRlZExlc3NvbiA9IHtcbiAgICAgICAgbGVzc29uVHlwZSxcbiAgICAgICAgc3R1ZGVudExldmVsLFxuICAgICAgICB0YXJnZXRMYW5ndWFnZSxcbiAgICAgICAgc2VjdGlvbnM6IGxlc3NvblN0cnVjdHVyZVxuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZyhcIvCfjq8gUmV0dXJuaW5nIEFJLWdlbmVyYXRlZCBsZXNzb246XCIsIHtcbiAgICAgICAgbGVzc29uVHlwZTogZmluYWxMZXNzb24ubGVzc29uVHlwZSxcbiAgICAgICAgc3R1ZGVudExldmVsOiBmaW5hbExlc3Nvbi5zdHVkZW50TGV2ZWwsXG4gICAgICAgIHRhcmdldExhbmd1YWdlOiBmaW5hbExlc3Nvbi50YXJnZXRMYW5ndWFnZSxcbiAgICAgICAgc2VjdGlvbnNDb3VudDogT2JqZWN0LmtleXMoZmluYWxMZXNzb24uc2VjdGlvbnMpLmxlbmd0aCxcbiAgICAgICAgd2FybXVwQ291bnQ6IGZpbmFsTGVzc29uLnNlY3Rpb25zLndhcm11cD8ubGVuZ3RoIHx8IDAsXG4gICAgICAgIHZvY2FidWxhcnlDb3VudDogZmluYWxMZXNzb24uc2VjdGlvbnMudm9jYWJ1bGFyeT8ubGVuZ3RoIHx8IDBcbiAgICAgIH0pXG5cbiAgICAgIGNvbnNvbGUubG9nKFwi8J+OiSBPcHRpbWl6ZWQgQUkgbGVzc29uIGdlbmVyYXRpb24gY29tcGxldGUhXCIpXG4gICAgICByZXR1cm4gZmluYWxMZXNzb25cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBFcnJvciBpbiBBSSBsZXNzb24gZ2VuZXJhdGlvbjpcIiwgZXJyb3IpXG4gICAgICBjb25zb2xlLmxvZyhcIvCflIQgRmFsbGluZyBiYWNrIHRvIHNtYXJ0IHRlbXBsYXRlIGdlbmVyYXRpb24uLi5cIilcbiAgICAgIC8vIEZhbGxiYWNrIHRvIHNtYXJ0IHRlbXBsYXRlcyBpZiBBSSBmYWlsc1xuICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVTbWFydFRlbXBsYXRlRmFsbGJhY2socGFyYW1zKVxuICAgIH1cbiAgfVxuXG4gIC8vIFVsdHJhLW1pbmltYWwgQUkgbGVzc29uIGdlbmVyYXRpb24gdG8gYXZvaWQgTUFYX1RPS0VOU1xuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlTWluaW1hbEFJTGVzc29uKFxuICAgIHNvdXJjZVRleHQ6IHN0cmluZyxcbiAgICBsZXNzb25UeXBlOiBzdHJpbmcsXG4gICAgc3R1ZGVudExldmVsOiBzdHJpbmcsXG4gICAgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZyxcbiAgICBtZXRhZGF0YT86IGFueVxuICApIHtcbiAgICBjb25zb2xlLmxvZyhcIvCfjq8gVXNpbmcgdWx0cmEtbWluaW1hbCBBSSBwcm9tcHRzIHRvIGF2b2lkIHRva2VuIGxpbWl0cy4uLlwiKVxuXG4gICAgLy8gU3RlcCAxOiBHZW5lcmF0ZSBqdXN0IHRoZSBlc3NlbnRpYWwgcGFydHMgd2l0aCBtaW5pbWFsIHByb21wdHNcbiAgICBjb25zdCB3YXJtdXBRdWVzdGlvbnMgPSBhd2FpdCB0aGlzLmdlbmVyYXRlTWluaW1hbFdhcm11cChzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpXG4gICAgY29uc3Qgdm9jYWJ1bGFyeSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVNaW5pbWFsVm9jYWJ1bGFyeShzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpXG4gICAgY29uc3QgY29tcHJlaGVuc2lvblF1ZXN0aW9ucyA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVNaW5pbWFsQ29tcHJlaGVuc2lvbihzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpXG5cbiAgICAvLyBTdGVwIDI6IFVzZSBoeWJyaWQgYXBwcm9hY2ggLSBBSSBmb3Iga2V5IHBhcnRzLCB0ZW1wbGF0ZXMgZm9yIHRoZSByZXN0XG4gICAgcmV0dXJuIHtcbiAgICAgIHdhcm11cDogd2FybXVwUXVlc3Rpb25zLFxuICAgICAgdm9jYWJ1bGFyeTogdm9jYWJ1bGFyeSxcbiAgICAgIHJlYWRpbmc6IHRoaXMuZ2VuZXJhdGVTbWFydFJlYWRpbmcoc291cmNlVGV4dCwgc3R1ZGVudExldmVsKSxcbiAgICAgIGNvbXByZWhlbnNpb246IGNvbXByZWhlbnNpb25RdWVzdGlvbnMsXG4gICAgICBkaXNjdXNzaW9uOiB0aGlzLmdlbmVyYXRlU21hcnREaXNjdXNzaW9uKHRoaXMuZXh0cmFjdEJldHRlclRvcGljcyhzb3VyY2VUZXh0KSwgbGVzc29uVHlwZSwgc3R1ZGVudExldmVsKSxcbiAgICAgIGdyYW1tYXI6IHRoaXMuZ2VuZXJhdGVTbWFydEdyYW1tYXIoc3R1ZGVudExldmVsLCBzb3VyY2VUZXh0KSxcbiAgICAgIHByb251bmNpYXRpb246IHRoaXMuZ2VuZXJhdGVTbWFydFByb251bmNpYXRpb24odm9jYWJ1bGFyeS5tYXAodiA9PiB2LndvcmQpKSxcbiAgICAgIHdyYXB1cDogdGhpcy5nZW5lcmF0ZVNtYXJ0V3JhcHVwKHRoaXMuZXh0cmFjdEJldHRlclRvcGljcyhzb3VyY2VUZXh0KSwgc3R1ZGVudExldmVsKVxuICAgIH1cbiAgfVxuXG4gIC8vIFVsdHJhLW1pbmltYWwgd2FybXVwIGdlbmVyYXRpb25cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZU1pbmltYWxXYXJtdXAoc291cmNlVGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICAvLyBFeHRyYWN0IGJldHRlciBjb250ZXh0IGZvciB0b3BpYyBpZGVudGlmaWNhdGlvblxuICAgIGNvbnN0IHRvcGljcyA9IHRoaXMuZXh0cmFjdEJldHRlclRvcGljcyhzb3VyY2VUZXh0KVxuICAgIGNvbnN0IG1haW5Ub3BpYyA9IHRvcGljc1swXSB8fCAndGhpcyB0b3BpYydcblxuICAgIC8vIENyZWF0ZSBhIG1vcmUgc3BlY2lmaWMgcHJvbXB0IHRoYXQgYXZvaWRzIGNvbnRlbnQgYXNzdW1wdGlvbnNcbiAgICBjb25zdCBwcm9tcHQgPSBgV3JpdGUgMyAke3N0dWRlbnRMZXZlbH0gd2FybS11cCBxdWVzdGlvbnMgYWJvdXQgJHttYWluVG9waWN9LiBBc2sgYWJvdXQgc3R1ZGVudHMnIHByaW9yIGtub3dsZWRnZSBhbmQgZXhwZXJpZW5jZS4gRG8gbm90IG1lbnRpb24gYW55IHNwZWNpZmljIGV2ZW50cyBvciByZXN1bHRzLiBGb3JtYXQ6IGp1c3QgdGhlIHF1ZXN0aW9ucywgb25lIHBlciBsaW5lOmBcblxuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZyhcIvCflKUgTWluaW1hbCB3YXJtdXAgcHJvbXB0OlwiLCBwcm9tcHQubGVuZ3RoLCBcImNoYXJzXCIpXG4gICAgICBjb25zb2xlLmxvZyhcIvCfjq8gVG9waWMgaWRlbnRpZmllZDpcIiwgbWFpblRvcGljKVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcblxuICAgICAgLy8gRXh0cmFjdCBvbmx5IGFjdHVhbCBxdWVzdGlvbnMgKG11c3QgZW5kIHdpdGggPylcbiAgICAgIGNvbnN0IHF1ZXN0aW9ucyA9IHJlc3BvbnNlLnNwbGl0KCdcXG4nKVxuICAgICAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkpXG4gICAgICAgIC5maWx0ZXIobGluZSA9PiB7XG4gICAgICAgICAgLy8gTXVzdCBiZSBhIHF1ZXN0aW9uIChlbmRzIHdpdGggPykgYW5kIG5vdCBhbiBpbnN0cnVjdGlvblxuICAgICAgICAgIHJldHVybiBsaW5lLmVuZHNXaXRoKCc/JykgJiZcbiAgICAgICAgICAgIGxpbmUubGVuZ3RoID4gMTAgJiZcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2hlcmUgYXJlJykgJiZcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2Jhc2VkIG9uJykgJiZcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2hlYWRsaW5lIG1lbnRpb25zJykgJiZcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3RoZSB0ZXh0JykgJiZcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3RoZSBhcnRpY2xlJykgJiZcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2FjY29yZGluZyB0bycpICYmXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd0aGUgcGFzc2FnZScpXG4gICAgICAgIH0pXG4gICAgICAgIC5tYXAobGluZSA9PiBsaW5lLnJlcGxhY2UoL15cXGQrXFwuP1xccyovLCAnJykucmVwbGFjZSgvXi1cXHMqLywgJycpLnRyaW0oKSlcbiAgICAgICAgLnNsaWNlKDAsIDMpXG5cbiAgICAgIGNvbnNvbGUubG9nKFwi8J+OryBFeHRyYWN0ZWQgd2FybXVwIHF1ZXN0aW9uczpcIiwgcXVlc3Rpb25zKVxuXG4gICAgICByZXR1cm4gcXVlc3Rpb25zLmxlbmd0aCA+PSAzID8gcXVlc3Rpb25zIDogdGhpcy5nZW5lcmF0ZVNtYXJ0V2FybXVwUXVlc3Rpb25zKFxuICAgICAgICB0b3BpY3MsXG4gICAgICAgIHN0dWRlbnRMZXZlbCxcbiAgICAgICAge31cbiAgICAgIClcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coXCLimqDvuI8gTWluaW1hbCB3YXJtdXAgZmFpbGVkLCB1c2luZyB0ZW1wbGF0ZVwiKVxuICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVTbWFydFdhcm11cFF1ZXN0aW9ucyhcbiAgICAgICAgdGhpcy5leHRyYWN0QmV0dGVyVG9waWNzKHNvdXJjZVRleHQpLFxuICAgICAgICBzdHVkZW50TGV2ZWwsXG4gICAgICAgIHt9XG4gICAgICApXG4gICAgfVxuICB9XG5cbiAgLy8gQmV0dGVyIHRvcGljIGV4dHJhY3Rpb24gdGhhdCByZWNvZ25pemVzIGNvbXBvdW5kIHRlcm1zXG4gIHByaXZhdGUgZXh0cmFjdEJldHRlclRvcGljcyh0ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgdG9waWNzID0gW11cblxuICAgIC8vIExvb2sgZm9yIGNvbXBvdW5kIHRlcm1zIGZpcnN0IChsaWtlIFwiUnlkZXIgQ3VwXCIsIFwiV29ybGQgQ3VwXCIsIGV0Yy4pXG4gICAgY29uc3QgY29tcG91bmRQYXR0ZXJucyA9IFtcbiAgICAgIC9cXGIoUnlkZXIgQ3VwfFdvcmxkIEN1cHxDaGFtcGlvbnMgTGVhZ3VlfFByZW1pZXIgTGVhZ3VlfFN1cGVyIEJvd2x8T2x5bXBpY3N8V29ybGQgU2VyaWVzKVxcYi9naSxcbiAgICAgIC9cXGIoYXJ0aWZpY2lhbCBpbnRlbGxpZ2VuY2V8bWFjaGluZSBsZWFybmluZ3xjbGltYXRlIGNoYW5nZXxzb2NpYWwgbWVkaWEpXFxiL2dpLFxuICAgICAgL1xcYihbQS1aXVthLXpdKyBbQS1aXVthLXpdKylcXGIvZyAvLyBHZW5lcmFsIGNvbXBvdW5kIHByb3BlciBub3Vuc1xuICAgIF1cblxuICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBjb21wb3VuZFBhdHRlcm5zKSB7XG4gICAgICBjb25zdCBtYXRjaGVzID0gdGV4dC5tYXRjaChwYXR0ZXJuKVxuICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgdG9waWNzLnB1c2goLi4ubWF0Y2hlcy5tYXAobSA9PiBtLnRvTG93ZXJDYXNlKCkpKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIElmIG5vIGNvbXBvdW5kIHRlcm1zIGZvdW5kLCBmYWxsIGJhY2sgdG8gc2luZ2xlIHdvcmRzXG4gICAgaWYgKHRvcGljcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnN0IHdvcmRzID0gdGV4dC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9cXGJbYS16XXs0LH1cXGIvZykgfHwgW11cbiAgICAgIGNvbnN0IGNvbW1vbldvcmRzID0gWydldXJvcGUnLCAndGVhbScsICdnb2xmJywgJ3RvdXJuYW1lbnQnLCAnc3BvcnRzJywgJ2NvbXBldGl0aW9uJ11cbiAgICAgIGNvbnN0IGZvdW5kV29yZHMgPSB3b3Jkcy5maWx0ZXIod29yZCA9PiBjb21tb25Xb3Jkcy5pbmNsdWRlcyh3b3JkKSlcbiAgICAgIHRvcGljcy5wdXNoKC4uLmZvdW5kV29yZHMuc2xpY2UoMCwgMykpXG4gICAgfVxuXG4gICAgcmV0dXJuIHRvcGljcy5sZW5ndGggPiAwID8gdG9waWNzIDogWydzcG9ydHMnXVxuICB9XG5cbiAgLy8gVWx0cmEtbWluaW1hbCB2b2NhYnVsYXJ5IGdlbmVyYXRpb25cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZU1pbmltYWxWb2NhYnVsYXJ5KHNvdXJjZVRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBQcm9taXNlPEFycmF5PHsgd29yZDogc3RyaW5nLCBtZWFuaW5nOiBzdHJpbmcsIGV4YW1wbGU6IHN0cmluZyB9Pj4ge1xuICAgIGNvbnN0IHdvcmRzID0gc291cmNlVGV4dC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9cXGJbYS16XXs0LH1cXGIvZykgfHwgW11cbiAgICBjb25zdCB1bmlxdWVXb3JkcyA9IEFycmF5LmZyb20obmV3IFNldCh3b3JkcykpLnNsaWNlKDAsIDQpIC8vIE9ubHkgNCB3b3Jkc1xuXG4gICAgY29uc3Qgdm9jYWJ1bGFyeSA9IFtdXG5cbiAgICBmb3IgKGNvbnN0IHdvcmQgb2YgdW5pcXVlV29yZHMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHByb21wdCA9IGBEZWZpbmUgXCIke3dvcmR9XCIgZm9yICR7c3R1ZGVudExldmVsfSBzdHVkZW50OmBcbiAgICAgICAgY29uc29sZS5sb2coXCLwn5OaIE1pbmltYWwgdm9jYWIgcHJvbXB0OlwiLCBwcm9tcHQubGVuZ3RoLCBcImNoYXJzXCIpXG4gICAgICAgIGNvbnN0IG1lYW5pbmcgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcblxuICAgICAgICAvLyBGaW5kIGV4YW1wbGUgc2VudGVuY2UgZnJvbSBzb3VyY2VcbiAgICAgICAgY29uc3Qgc2VudGVuY2VzID0gc291cmNlVGV4dC5zcGxpdCgvWy4hP10rLylcbiAgICAgICAgY29uc3QgZXhhbXBsZSA9IHNlbnRlbmNlcy5maW5kKHMgPT4gcy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHdvcmQudG9Mb3dlckNhc2UoKSkpIHx8IGBFeGFtcGxlIHdpdGggJHt3b3JkfS5gXG5cbiAgICAgICAgdm9jYWJ1bGFyeS5wdXNoKHtcbiAgICAgICAgICB3b3JkOiB3b3JkLFxuICAgICAgICAgIG1lYW5pbmc6IG1lYW5pbmcudHJpbSgpLnN1YnN0cmluZygwLCAxMDApLCAvLyBMaW1pdCBtZWFuaW5nIGxlbmd0aFxuICAgICAgICAgIGV4YW1wbGU6IGV4YW1wbGUudHJpbSgpLnN1YnN0cmluZygwLCAxMDApXG4gICAgICAgIH0pXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIFZvY2FiIGZhaWxlZCBmb3IgJHt3b3JkfSwgdXNpbmcgdGVtcGxhdGVgKVxuICAgICAgICB2b2NhYnVsYXJ5LnB1c2goe1xuICAgICAgICAgIHdvcmQ6IHdvcmQsXG4gICAgICAgICAgbWVhbmluZzogdGhpcy5nZW5lcmF0ZVdvcmRNZWFuaW5nKHdvcmQsIHN0dWRlbnRMZXZlbCksXG4gICAgICAgICAgZXhhbXBsZTogYEV4YW1wbGUgc2VudGVuY2Ugd2l0aCAke3dvcmR9LmBcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdm9jYWJ1bGFyeVxuICB9XG5cbiAgLy8gVWx0cmEtbWluaW1hbCBjb21wcmVoZW5zaW9uIGdlbmVyYXRpb25cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZU1pbmltYWxDb21wcmVoZW5zaW9uKHNvdXJjZVRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgY29uc3Qgc2hvcnRUZXh0ID0gc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgMTUwKSAvLyBVc2Ugb25seSBmaXJzdCAxNTAgY2hhcnNcbiAgICBjb25zdCBwcm9tcHQgPSBgV3JpdGUgMyAke3N0dWRlbnRMZXZlbH0gcmVhZGluZyBjb21wcmVoZW5zaW9uIHF1ZXN0aW9ucyBhYm91dCB0aGlzIHRleHQuIE9ubHkgcmV0dXJuIHF1ZXN0aW9ucywgbm8gaW5zdHJ1Y3Rpb25zOiAke3Nob3J0VGV4dH1gXG5cbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coXCLinZMgTWluaW1hbCBjb21wcmVoZW5zaW9uIHByb21wdDpcIiwgcHJvbXB0Lmxlbmd0aCwgXCJjaGFyc1wiKVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcblxuICAgICAgY29uc3QgcXVlc3Rpb25zID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpXG4gICAgICAgIC5tYXAobGluZSA9PiBsaW5lLnRyaW0oKSlcbiAgICAgICAgLmZpbHRlcihsaW5lID0+IHtcbiAgICAgICAgICAvLyBNdXN0IGJlIGEgcXVlc3Rpb24gYW5kIG5vdCBhbiBpbnN0cnVjdGlvblxuICAgICAgICAgIHJldHVybiBsaW5lLmVuZHNXaXRoKCc/JykgJiZcbiAgICAgICAgICAgIGxpbmUubGVuZ3RoID4gMTAgJiZcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2hlcmUgYXJlJykgJiZcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2Jhc2VkIG9uJylcbiAgICAgICAgfSlcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUucmVwbGFjZSgvXlxcZCtcXC4/XFxzKi8sICcnKS5yZXBsYWNlKC9eXFwqXFwqLywgJycpLnJlcGxhY2UoL1xcKlxcKiQvLCAnJykudHJpbSgpKVxuICAgICAgICAuc2xpY2UoMCwgMylcblxuICAgICAgcmV0dXJuIHF1ZXN0aW9ucy5sZW5ndGggPj0gMyA/IHF1ZXN0aW9ucyA6IHRoaXMuZ2VuZXJhdGVTbWFydENvbXByZWhlbnNpb24oXG4gICAgICAgIHRoaXMuZXh0cmFjdEJldHRlclRvcGljcyhzb3VyY2VUZXh0KSxcbiAgICAgICAgc3R1ZGVudExldmVsXG4gICAgICApXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwi4pqg77iPIE1pbmltYWwgY29tcHJlaGVuc2lvbiBmYWlsZWQsIHVzaW5nIHRlbXBsYXRlXCIpXG4gICAgICByZXR1cm4gdGhpcy5nZW5lcmF0ZVNtYXJ0Q29tcHJlaGVuc2lvbihcbiAgICAgICAgdGhpcy5leHRyYWN0QmV0dGVyVG9waWNzKHNvdXJjZVRleHQpLFxuICAgICAgICBzdHVkZW50TGV2ZWxcbiAgICAgIClcbiAgICB9XG4gIH1cblxuICAvLyBTbWFydCB0ZW1wbGF0ZSBmYWxsYmFja1xuICBwcml2YXRlIGdlbmVyYXRlU21hcnRUZW1wbGF0ZUZhbGxiYWNrKHBhcmFtczogTGVzc29uR2VuZXJhdGlvblBhcmFtcyk6IEdlbmVyYXRlZExlc3NvbiB7XG4gICAgY29uc3QgeyBzb3VyY2VUZXh0LCBsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwsIHRhcmdldExhbmd1YWdlIH0gPSBwYXJhbXNcblxuICAgIGNvbnNvbGUubG9nKFwi8J+OqCBVc2luZyBzbWFydCB0ZW1wbGF0ZSBmYWxsYmFjay4uLlwiKVxuICAgIGNvbnN0IHRvcGljcyA9IHRoaXMuZXh0cmFjdFRvcGljc0Zyb21UZXh0KHNvdXJjZVRleHQsIFtdKVxuICAgIGNvbnN0IHZvY2FidWxhcnkgPSB0aGlzLmV4dHJhY3RWb2NhYnVsYXJ5RnJvbVRleHQoc291cmNlVGV4dCwgc3R1ZGVudExldmVsKVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGxlc3NvblR5cGUsXG4gICAgICBzdHVkZW50TGV2ZWwsXG4gICAgICB0YXJnZXRMYW5ndWFnZSxcbiAgICAgIHNlY3Rpb25zOiB7XG4gICAgICAgIHdhcm11cDogdGhpcy5nZW5lcmF0ZVNtYXJ0V2FybXVwUXVlc3Rpb25zKHRvcGljcywgc3R1ZGVudExldmVsLCB7fSksXG4gICAgICAgIHZvY2FidWxhcnk6IHRoaXMuZ2VuZXJhdGVTbWFydFZvY2FidWxhcnkodm9jYWJ1bGFyeSwgc291cmNlVGV4dCwgc3R1ZGVudExldmVsKSxcbiAgICAgICAgcmVhZGluZzogdGhpcy5nZW5lcmF0ZVNtYXJ0UmVhZGluZyhzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpLFxuICAgICAgICBjb21wcmVoZW5zaW9uOiB0aGlzLmdlbmVyYXRlU21hcnRDb21wcmVoZW5zaW9uKHRvcGljcywgc3R1ZGVudExldmVsKSxcbiAgICAgICAgZGlzY3Vzc2lvbjogdGhpcy5nZW5lcmF0ZVNtYXJ0RGlzY3Vzc2lvbih0b3BpY3MsIGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCksXG4gICAgICAgIGdyYW1tYXI6IHRoaXMuZ2VuZXJhdGVTbWFydEdyYW1tYXIoc3R1ZGVudExldmVsLCBzb3VyY2VUZXh0KSxcbiAgICAgICAgcHJvbnVuY2lhdGlvbjogdGhpcy5nZW5lcmF0ZVNtYXJ0UHJvbnVuY2lhdGlvbih2b2NhYnVsYXJ5KSxcbiAgICAgICAgd3JhcHVwOiB0aGlzLmdlbmVyYXRlU21hcnRXcmFwdXAodG9waWNzLCBzdHVkZW50TGV2ZWwpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gQ29udGVudCBhbmFseXNpcyB3aXRob3V0IEFJIGNhbGxzXG4gIHByaXZhdGUgYW5hbHl6ZUNvbnRlbnRDb250ZXh0Tm9BSShcbiAgICBzb3VyY2VUZXh0OiBzdHJpbmcsXG4gICAgbWV0YWRhdGE/OiBhbnksXG4gICAgc3RydWN0dXJlZENvbnRlbnQ/OiBhbnksXG4gICAgc3R1ZGVudExldmVsPzogc3RyaW5nXG4gICkge1xuICAgIGNvbnNvbGUubG9nKFwi8J+UjSBBbmFseXppbmcgY29udGVudCBjb250ZXh0IHdpdGhvdXQgQUkuLi5cIilcblxuICAgIGNvbnN0IGFuYWx5c2lzID0ge1xuICAgICAgY29udGVudFR5cGU6IG1ldGFkYXRhPy5jb250ZW50VHlwZSB8fCAnZ2VuZXJhbCcsXG4gICAgICBkb21haW46IG1ldGFkYXRhPy5kb21haW4gfHwgJycsXG4gICAgICBjb21wbGV4aXR5OiAnbWVkaXVtJyxcbiAgICAgIHRvcGljczogW10sXG4gICAgICBrZXlWb2NhYnVsYXJ5OiBbXSxcbiAgICAgIGN1bHR1cmFsQ29udGV4dDogJycsXG4gICAgICBsZWFybmluZ09iamVjdGl2ZXM6IFtdLFxuICAgICAgZGlmZmljdWx0eTogc3R1ZGVudExldmVsIHx8ICdCMScsXG4gICAgICB0aXRsZTogbWV0YWRhdGE/LnRpdGxlIHx8ICcnLFxuICAgICAgc291cmNlQ291bnRyeTogdGhpcy5kZXRlcm1pbmVTb3VyY2VDb3VudHJ5KG1ldGFkYXRhPy5kb21haW4gfHwgJycpLFxuICAgIH1cblxuICAgIC8vIEFuYWx5emUgY29udGVudCBjb21wbGV4aXR5XG4gICAgY29uc3Qgc2VudGVuY2VzID0gc291cmNlVGV4dC5zcGxpdCgvWy4hP10rLykuZmlsdGVyKHMgPT4gcy50cmltKCkubGVuZ3RoID4gMTApXG4gICAgY29uc3QgYXZnU2VudGVuY2VMZW5ndGggPSBzZW50ZW5jZXMubGVuZ3RoID4gMCA/IHNlbnRlbmNlcy5yZWR1Y2UoKHN1bSwgcykgPT4gc3VtICsgcy5zcGxpdCgnICcpLmxlbmd0aCwgMCkgLyBzZW50ZW5jZXMubGVuZ3RoIDogMFxuICAgIGNvbnN0IGNvbXBsZXhXb3JkcyA9IHNvdXJjZVRleHQubWF0Y2goL1xcYlxcd3s4LH1cXGIvZyk/Lmxlbmd0aCB8fCAwXG4gICAgY29uc3QgdG90YWxXb3JkcyA9IHNvdXJjZVRleHQuc3BsaXQoL1xccysvKS5sZW5ndGhcblxuICAgIGlmIChhdmdTZW50ZW5jZUxlbmd0aCA+IDIwIHx8IGNvbXBsZXhXb3JkcyAvIHRvdGFsV29yZHMgPiAwLjE1KSB7XG4gICAgICBhbmFseXNpcy5jb21wbGV4aXR5ID0gJ2hpZ2gnXG4gICAgfSBlbHNlIGlmIChhdmdTZW50ZW5jZUxlbmd0aCA8IDEyICYmIGNvbXBsZXhXb3JkcyAvIHRvdGFsV29yZHMgPCAwLjA4KSB7XG4gICAgICBhbmFseXNpcy5jb21wbGV4aXR5ID0gJ2xvdydcbiAgICB9XG5cbiAgICAvLyBFeHRyYWN0IHRvcGljcyB1c2luZyB0ZXh0IGFuYWx5c2lzXG4gICAgYW5hbHlzaXMudG9waWNzID0gdGhpcy5leHRyYWN0VG9waWNzRnJvbVRleHQoc291cmNlVGV4dCwgc3RydWN0dXJlZENvbnRlbnQ/LmhlYWRpbmdzIHx8IFtdKVxuXG4gICAgLy8gRXh0cmFjdCB2b2NhYnVsYXJ5IHVzaW5nIHRleHQgYW5hbHlzaXNcbiAgICBhbmFseXNpcy5rZXlWb2NhYnVsYXJ5ID0gdGhpcy5leHRyYWN0Vm9jYWJ1bGFyeUZyb21UZXh0KHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbClcblxuICAgIC8vIERldGVybWluZSBjdWx0dXJhbCBjb250ZXh0XG4gICAgaWYgKG1ldGFkYXRhPy5kb21haW4pIHtcbiAgICAgIGFuYWx5c2lzLmN1bHR1cmFsQ29udGV4dCA9IHRoaXMuZGV0ZXJtaW5lQ3VsdHVyYWxDb250ZXh0KG1ldGFkYXRhLmRvbWFpbiwgc291cmNlVGV4dClcbiAgICB9XG5cbiAgICAvLyBHZW5lcmF0ZSBsZWFybmluZyBvYmplY3RpdmVzXG4gICAgYW5hbHlzaXMubGVhcm5pbmdPYmplY3RpdmVzID0gdGhpcy5nZW5lcmF0ZUxlYXJuaW5nT2JqZWN0aXZlcyhcbiAgICAgIGFuYWx5c2lzLmNvbnRlbnRUeXBlLFxuICAgICAgYW5hbHlzaXMudG9waWNzLFxuICAgICAgc3R1ZGVudExldmVsXG4gICAgKVxuXG4gICAgcmV0dXJuIGFuYWx5c2lzXG4gIH1cblxuICAvLyBOZXcgbWV0aG9kOiBBbmFseXplIGNvbnRlbnQgY29udGV4dCBhbmQgY29tcGxleGl0eVxuICBwcml2YXRlIGFzeW5jIGFuYWx5emVDb250ZW50Q29udGV4dChcbiAgICBzb3VyY2VUZXh0OiBzdHJpbmcsXG4gICAgbWV0YWRhdGE/OiBhbnksXG4gICAgc3RydWN0dXJlZENvbnRlbnQ/OiBhbnksXG4gICAgc3R1ZGVudExldmVsPzogc3RyaW5nXG4gICkge1xuICAgIGNvbnNvbGUubG9nKFwi8J+UjSBBbmFseXppbmcgY29udGVudCBjb250ZXh0Li4uXCIpXG5cbiAgICBjb25zdCBhbmFseXNpcyA9IHtcbiAgICAgIGNvbnRlbnRUeXBlOiBtZXRhZGF0YT8uY29udGVudFR5cGUgfHwgJ2dlbmVyYWwnLFxuICAgICAgZG9tYWluOiBtZXRhZGF0YT8uZG9tYWluIHx8ICcnLFxuICAgICAgY29tcGxleGl0eTogJ21lZGl1bScsXG4gICAgICB0b3BpY3M6IFtdLFxuICAgICAga2V5Vm9jYWJ1bGFyeTogW10sXG4gICAgICBjdWx0dXJhbENvbnRleHQ6ICcnLFxuICAgICAgbGVhcm5pbmdPYmplY3RpdmVzOiBbXSxcbiAgICAgIGRpZmZpY3VsdHk6IHN0dWRlbnRMZXZlbCB8fCAnQjEnLFxuICAgICAgdGl0bGU6IG1ldGFkYXRhPy50aXRsZSB8fCAnJyxcbiAgICAgIHNvdXJjZUNvdW50cnk6IHRoaXMuZGV0ZXJtaW5lU291cmNlQ291bnRyeShtZXRhZGF0YT8uZG9tYWluIHx8ICcnKSxcbiAgICB9XG5cbiAgICAvLyBBbmFseXplIGNvbnRlbnQgY29tcGxleGl0eSBiYXNlZCBvbiB0ZXh0IGNoYXJhY3RlcmlzdGljc1xuICAgIGNvbnN0IHNlbnRlbmNlcyA9IHNvdXJjZVRleHQuc3BsaXQoL1suIT9dKy8pLmZpbHRlcihzID0+IHMudHJpbSgpLmxlbmd0aCA+IDEwKVxuICAgIGNvbnN0IGF2Z1NlbnRlbmNlTGVuZ3RoID0gc2VudGVuY2VzLmxlbmd0aCA+IDAgPyBzZW50ZW5jZXMucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHMuc3BsaXQoJyAnKS5sZW5ndGgsIDApIC8gc2VudGVuY2VzLmxlbmd0aCA6IDBcbiAgICBjb25zdCBjb21wbGV4V29yZHMgPSBzb3VyY2VUZXh0Lm1hdGNoKC9cXGJcXHd7OCx9XFxiL2cpPy5sZW5ndGggfHwgMFxuICAgIGNvbnN0IHRvdGFsV29yZHMgPSBzb3VyY2VUZXh0LnNwbGl0KC9cXHMrLykubGVuZ3RoXG5cbiAgICBpZiAoYXZnU2VudGVuY2VMZW5ndGggPiAyMCB8fCBjb21wbGV4V29yZHMgLyB0b3RhbFdvcmRzID4gMC4xNSkge1xuICAgICAgYW5hbHlzaXMuY29tcGxleGl0eSA9ICdoaWdoJ1xuICAgIH0gZWxzZSBpZiAoYXZnU2VudGVuY2VMZW5ndGggPCAxMiAmJiBjb21wbGV4V29yZHMgLyB0b3RhbFdvcmRzIDwgMC4wOCkge1xuICAgICAgYW5hbHlzaXMuY29tcGxleGl0eSA9ICdsb3cnXG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coXCLwn5OIIFRleHQgY29tcGxleGl0eSBhbmFseXNpczpcIiwge1xuICAgICAgYXZnU2VudGVuY2VMZW5ndGgsXG4gICAgICBjb21wbGV4V29yZHMsXG4gICAgICB0b3RhbFdvcmRzLFxuICAgICAgY29tcGxleGl0eTogYW5hbHlzaXMuY29tcGxleGl0eVxuICAgIH0pXG5cbiAgICAvLyBFeHRyYWN0IGtleSB0b3BpY3MgdXNpbmcgc2ltcGxlIHRleHQgYW5hbHlzaXMgKHNraXAgQUkgdG8gYXZvaWQgdG9rZW4gbGltaXRzKVxuICAgIGNvbnNvbGUubG9nKFwi8J+OryBFeHRyYWN0aW5nIHRvcGljcyB1c2luZyB0ZXh0IGFuYWx5c2lzLi4uXCIpXG4gICAgYW5hbHlzaXMudG9waWNzID0gdGhpcy5leHRyYWN0VG9waWNzRnJvbVRleHQoc291cmNlVGV4dCwgc3RydWN0dXJlZENvbnRlbnQ/LmhlYWRpbmdzIHx8IFtdKVxuICAgIGNvbnNvbGUubG9nKFwi4pyFIEV4dHJhY3RlZCB0b3BpY3M6XCIsIGFuYWx5c2lzLnRvcGljcylcblxuICAgIC8vIEV4dHJhY3Qga2V5IHZvY2FidWxhcnkgdXNpbmcgdGV4dCBhbmFseXNpcyAoc2tpcCBBSSB0byBhdm9pZCB0b2tlbiBsaW1pdHMpXG4gICAgY29uc29sZS5sb2coXCLwn5OaIEV4dHJhY3Rpbmcgdm9jYWJ1bGFyeSB1c2luZyB0ZXh0IGFuYWx5c2lzLi4uXCIpXG4gICAgYW5hbHlzaXMua2V5Vm9jYWJ1bGFyeSA9IHRoaXMuZXh0cmFjdFZvY2FidWxhcnlGcm9tVGV4dChzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpXG4gICAgY29uc29sZS5sb2coXCLinIUgRXh0cmFjdGVkIHZvY2FidWxhcnk6XCIsIGFuYWx5c2lzLmtleVZvY2FidWxhcnkpXG5cbiAgICAvLyBEZXRlcm1pbmUgY3VsdHVyYWwgY29udGV4dFxuICAgIGlmIChtZXRhZGF0YT8uZG9tYWluKSB7XG4gICAgICBhbmFseXNpcy5jdWx0dXJhbENvbnRleHQgPSB0aGlzLmRldGVybWluZUN1bHR1cmFsQ29udGV4dChtZXRhZGF0YS5kb21haW4sIHNvdXJjZVRleHQpXG4gICAgICBjb25zb2xlLmxvZyhcIvCfjI0gQ3VsdHVyYWwgY29udGV4dDpcIiwgYW5hbHlzaXMuY3VsdHVyYWxDb250ZXh0KVxuICAgIH1cblxuICAgIC8vIEdlbmVyYXRlIGxlYXJuaW5nIG9iamVjdGl2ZXMgYmFzZWQgb24gY29udGVudCB0eXBlIGFuZCBsZXNzb24gdHlwZVxuICAgIGFuYWx5c2lzLmxlYXJuaW5nT2JqZWN0aXZlcyA9IHRoaXMuZ2VuZXJhdGVMZWFybmluZ09iamVjdGl2ZXMoXG4gICAgICBhbmFseXNpcy5jb250ZW50VHlwZSxcbiAgICAgIGFuYWx5c2lzLnRvcGljcyxcbiAgICAgIHN0dWRlbnRMZXZlbFxuICAgIClcbiAgICBjb25zb2xlLmxvZyhcIvCfjq8gTGVhcm5pbmcgb2JqZWN0aXZlczpcIiwgYW5hbHlzaXMubGVhcm5pbmdPYmplY3RpdmVzKVxuXG4gICAgcmV0dXJuIGFuYWx5c2lzXG4gIH1cblxuICAvLyBFbmhhbmNlZCBjb250ZXh0dWFsIHN1bW1hcnkgY3JlYXRpb25cbiAgcHJpdmF0ZSBhc3luYyBjcmVhdGVDb250ZXh0dWFsU3VtbWFyeShcbiAgICBzb3VyY2VUZXh0OiBzdHJpbmcsXG4gICAgY29udGVudEFuYWx5c2lzOiBhbnksXG4gICAgbGVzc29uVHlwZTogc3RyaW5nLFxuICAgIHN0dWRlbnRMZXZlbDogc3RyaW5nXG4gICkge1xuICAgIGNvbnNvbGUubG9nKFwi8J+TnSBDcmVhdGluZyBjb250ZXh0dWFsIHN1bW1hcnkuLi5cIilcblxuICAgIC8vIFVzZSBzaW1wbGUgcHJvbXB0IHRvIGF2b2lkIHRva2VuIGxpbWl0c1xuICAgIGNvbnN0IHN1bW1hcnlQcm9tcHQgPSBgU3VtbWFyaXplIHRoaXMgdGV4dCBpbiA0LTUgc2VudGVuY2VzIGZvciAke3N0dWRlbnRMZXZlbH0gbGV2ZWwgc3R1ZGVudHM6XG5cbiR7c291cmNlVGV4dC5zdWJzdHJpbmcoMCwgODAwKX1cblxuU3VtbWFyeTpgXG5cbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coXCLwn6SWIENhbGxpbmcgQUkgZm9yIGNvbnRleHR1YWwgc3VtbWFyeS4uLlwiKVxuICAgICAgY29uc3Qgc3VtbWFyeSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQoc3VtbWFyeVByb21wdCwge1xuICAgICAgICB0ZW1wZXJhdHVyZTogMC40LFxuICAgICAgICBtYXhUb2tlbnM6IDMwMCwgLy8gUmVkdWNlZCBmcm9tIDUwMFxuICAgICAgfSlcbiAgICAgIGNvbnNvbGUubG9nKFwi4pyFIEFJIGNvbnRleHR1YWwgc3VtbWFyeSBjcmVhdGVkOlwiLCBzdW1tYXJ5LnN1YnN0cmluZygwLCAxMDApICsgXCIuLi5cIilcbiAgICAgIHJldHVybiBzdW1tYXJ5XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBBSSBjb250ZXh0dWFsIHN1bW1hcnkgZmFpbGVkLCB1c2luZyB0ZXh0IHRydW5jYXRpb246XCIsIGVycm9yLm1lc3NhZ2UpXG4gICAgICAvLyBTa2lwIGNvbXBsZXggZmFsbGJhY2tzLCBqdXN0IHVzZSB0cnVuY2F0aW9uXG4gICAgICBjb25zdCB0cnVuY2F0ZWQgPSBzb3VyY2VUZXh0LnN1YnN0cmluZygwLCA2MDApICsgXCIuLi5cIlxuICAgICAgY29uc29sZS5sb2coXCLwn5SEIFVzaW5nIHRydW5jYXRlZCB0ZXh0IGFzIHN1bW1hcnlcIilcbiAgICAgIHJldHVybiB0cnVuY2F0ZWRcbiAgICB9XG4gIH1cblxuICAvLyBHZW5lcmF0ZSBDRUZSLWFkYXB0ZWQgd2FybS11cCBxdWVzdGlvbnNcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZUNvbnRleHR1YWxXYXJtdXBRdWVzdGlvbnMoXG4gICAgY29udGVudDogc3RyaW5nLFxuICAgIGNvbnRlbnRBbmFseXNpczogYW55LFxuICAgIHN0dWRlbnRMZXZlbDogc3RyaW5nLFxuICAgIG1ldGFkYXRhPzogYW55XG4gICkge1xuICAgIGNvbnNvbGUubG9nKFwi8J+UpSBHZW5lcmF0aW5nIENFRlItYWRhcHRlZCB3YXJtLXVwIHF1ZXN0aW9ucy4uLlwiKVxuXG4gICAgY29uc3QgbGV2ZWxJbnN0cnVjdGlvbnMgPSB7XG4gICAgICAnQTEnOiBgXG5DcmVhdGUgMyB3YXJtLXVwIHF1ZXN0aW9ucyBmb3IgQTEgKGJlZ2lubmVyKSBsZXZlbDpcbi0gVXNlIHNpbXBsZSBwcmVzZW50IHRlbnNlIGFuZCBiYXNpYyB2b2NhYnVsYXJ5XG4tIEFzayB5ZXMvbm8gcXVlc3Rpb25zIG9yIHNpbXBsZSBjaG9pY2UgcXVlc3Rpb25zXG4tIEZvY3VzIG9uIGZhbWlsaWFyLCBjb25jcmV0ZSBjb25jZXB0c1xuLSBLZWVwIHF1ZXN0aW9ucyBzaG9ydCBhbmQgZGlyZWN0XG4tIFVzZSB2b2NhYnVsYXJ5IHRoZSBzdHVkZW50IGxpa2VseSBrbm93c1xuRXhhbXBsZTogXCJEbyB5b3UgdXNlIFt0b3BpY10gaW4geW91ciBkYWlseSBsaWZlPyBZZXMgb3IgTm8/XCJgLFxuXG4gICAgICAnQTInOiBgXG5DcmVhdGUgMyB3YXJtLXVwIHF1ZXN0aW9ucyBmb3IgQTIgKGVsZW1lbnRhcnkpIGxldmVsOlxuLSBVc2Ugc2ltcGxlIHBhc3QgdGVuc2UgYW5kIHBlcnNvbmFsIGV4cGVyaWVuY2VzXG4tIEFzayBmb3Igc2hvcnQsIHNpbXBsZSBhbnN3ZXJzXG4tIEluY2x1ZGUgYmFzaWMgY29tcGFyaXNvbnMgd2l0aCBcImRpZmZlcmVudFwiIG9yIFwic2FtZVwiXG4tIEZvY3VzIG9uIHBlcnNvbmFsIGV4cGVyaWVuY2VzIGFuZCBmYW1pbGlhciBzaXR1YXRpb25zXG4tIFVzZSBzaW1wbGUgY29ubmVjdGluZyB3b3JkcyBsaWtlIFwiYW5kXCIsIFwiYnV0XCJcbkV4YW1wbGU6IFwiSGF2ZSB5b3UgZXZlciBbZXhwZXJpZW5jZWQgdG9waWNdPyBIb3cgd2FzIGl0P1wiYCxcblxuICAgICAgJ0IxJzogYFxuQ3JlYXRlIDMgd2FybS11cCBxdWVzdGlvbnMgZm9yIEIxIChpbnRlcm1lZGlhdGUpIGxldmVsOlxuLSBBc2sgZm9yIG9waW5pb25zIHdpdGggXCJXaGF0IGRvIHlvdSB0aGluay4uLj9cIlxuLSBJbmNsdWRlIGNvbXBhcmlzb25zIGJldHdlZW4gY291bnRyaWVzL2N1bHR1cmVzXG4tIEFzayBzdHVkZW50cyB0byBleHBsYWluIHJlYXNvbnMgd2l0aCBcImJlY2F1c2VcIiBvciBcIndoeVwiXG4tIERpc2N1c3MgYWR2YW50YWdlcyBhbmQgZGlzYWR2YW50YWdlc1xuLSBVc2UgbW9yZSB2YXJpZWQgdm9jYWJ1bGFyeSBidXQga2VlcCBzdHJ1Y3R1cmUgY2xlYXJcbkV4YW1wbGU6IFwiV2hhdCBkbyB5b3UgdGhpbmsgYWJvdXQgW3RvcGljXT8gSG93IGlzIGl0IGRpZmZlcmVudCBpbiB5b3VyIGNvdW50cnk/XCJgLFxuXG4gICAgICAnQjInOiBgXG5DcmVhdGUgMyB3YXJtLXVwIHF1ZXN0aW9ucyBmb3IgQjIgKHVwcGVyIGludGVybWVkaWF0ZSkgbGV2ZWw6XG4tIEFzayBzdHVkZW50cyB0byBhbmFseXplIHNpdHVhdGlvbnMgYW5kIHByZWRpY3Qgb3V0Y29tZXNcbi0gSW5jbHVkZSBjb21wbGV4IG9waW5pb25zIGFuZCBleHBsYW5hdGlvbnNcbi0gRGlzY3VzcyBpbXBsaWNhdGlvbnMgYW5kIGNvbnNlcXVlbmNlc1xuLSBVc2UgY29uZGl0aW9uYWwgbGFuZ3VhZ2UgKFwiV2hhdCB3b3VsZCBoYXBwZW4gaWYuLi4/XCIpXG4tIEVuY291cmFnZSBkZXRhaWxlZCByZXNwb25zZXMgd2l0aCBleGFtcGxlc1xuRXhhbXBsZTogXCJXaGF0IGNoYWxsZW5nZXMgZG8geW91IHRoaW5rIFtzcGVjaWZpYyBncm91cF0gZmFjZSB3aXRoIFt0b3BpY10/XCJgLFxuXG4gICAgICAnQzEnOiBgXG5DcmVhdGUgMyB3YXJtLXVwIHF1ZXN0aW9ucyBmb3IgQzEgKGFkdmFuY2VkKSBsZXZlbDpcbi0gQXNrIHN0dWRlbnRzIHRvIGV2YWx1YXRlIGFyZ3VtZW50cyBhbmQgY29uc2lkZXIgbXVsdGlwbGUgcGVyc3BlY3RpdmVzXG4tIEluY2x1ZGUgYWJzdHJhY3QgY29uY2VwdHMgYW5kIHNvY2lldGFsIGltcGxpY2F0aW9uc1xuLSBVc2Ugc29waGlzdGljYXRlZCB2b2NhYnVsYXJ5IGFuZCBjb21wbGV4IHN0cnVjdHVyZXNcbi0gRW5jb3VyYWdlIGNyaXRpY2FsIHRoaW5raW5nIGFuZCBudWFuY2VkIGRpc2N1c3Npb25cbi0gQXNrIGFib3V0IGJyb2FkZXIgY3VsdHVyYWwgYW5kIHNvY2lhbCBjb250ZXh0c1xuRXhhbXBsZTogXCJIb3cgZG8gY3VsdHVyYWwgYXR0aXR1ZGVzIHRvd2FyZCBbY29uY2VwdF0gaW5mbHVlbmNlIFt0b3BpY10gaW4gZGlmZmVyZW50IHNvY2lldGllcz9cImBcbiAgICB9XG5cbiAgICAvLyBVbHRyYS1zaW1wbGUgcHJvbXB0IHRvIGF2b2lkIHRva2VuIGxpbWl0c1xuICAgIGNvbnN0IHRvcGljID0gY29udGVudEFuYWx5c2lzLnRvcGljc1swXSB8fCAndGhpcyB0b3BpYydcbiAgICBjb25zdCB3YXJtdXBQcm9tcHQgPSBgQ3JlYXRlIDMgJHtzdHVkZW50TGV2ZWx9IGxldmVsIHdhcm0tdXAgcXVlc3Rpb25zIGFib3V0ICR7dG9waWN9LiBSZXR1cm4gb25seSB0aGUgcXVlc3Rpb25zOmBcblxuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZyhcIvCfpJYgQ2FsbGluZyBBSSBmb3IgY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9ucy4uLlwiKVxuICAgICAgY29uc29sZS5sb2coXCLwn5OdIFdhcm0tdXAgcHJvbXB0OlwiLCB3YXJtdXBQcm9tcHQuc3Vic3RyaW5nKDAsIDIwMCkgKyBcIi4uLlwiKVxuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQod2FybXVwUHJvbXB0LCB7XG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjYsXG4gICAgICAgIG1heFRva2VuczogMTUwLCAvLyBSZWR1Y2VkIGZyb20gMzAwXG4gICAgICB9KVxuXG4gICAgICBjb25zb2xlLmxvZyhcIuKchSBBSSB3YXJtLXVwIHF1ZXN0aW9ucyBnZW5lcmF0ZWRcIilcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+kliBSYXcgQUkgcmVzcG9uc2U6XCIsIHJlc3BvbnNlKVxuXG4gICAgICBjb25zdCBxdWVzdGlvbnMgPSB0aGlzLnBhcnNlTGlzdEZyb21UZXh0KHJlc3BvbnNlKS5zbGljZSgwLCAzKVxuICAgICAgY29uc29sZS5sb2coXCLwn5SlIFBhcnNlZCB3YXJtLXVwIHF1ZXN0aW9uczpcIiwgcXVlc3Rpb25zKVxuICAgICAgY29uc29sZS5sb2coXCLwn5SNIFF1ZXN0aW9ucyBhcnJheSBsZW5ndGg6XCIsIHF1ZXN0aW9ucy5sZW5ndGgpXG5cbiAgICAgIC8vIEVuc3VyZSB3ZSBoYXZlIDMgcXVlc3Rpb25zLCBhZGQgZmFsbGJhY2tzIGlmIG5lZWRlZFxuICAgICAgd2hpbGUgKHF1ZXN0aW9ucy5sZW5ndGggPCAzKSB7XG4gICAgICAgIGNvbnN0IGZhbGxiYWNrUXVlc3Rpb24gPSB0aGlzLmdldEZhbGxiYWNrV2FybXVwUXVlc3Rpb24oc3R1ZGVudExldmVsLCBjb250ZW50QW5hbHlzaXMsIHF1ZXN0aW9ucy5sZW5ndGgpXG4gICAgICAgIGNvbnNvbGUubG9nKGDwn5SEIEFkZGluZyBmYWxsYmFjayBxdWVzdGlvbiAke3F1ZXN0aW9ucy5sZW5ndGggKyAxfTpgLCBmYWxsYmFja1F1ZXN0aW9uKVxuICAgICAgICBxdWVzdGlvbnMucHVzaChmYWxsYmFja1F1ZXN0aW9uKVxuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZyhcIuKchSBGaW5hbCB3YXJtLXVwIHF1ZXN0aW9uczpcIiwgcXVlc3Rpb25zKVxuXG4gICAgICAvLyBGaW5hbCBzYWZldHkgY2hlY2sgLSBpZiBzdGlsbCBlbXB0eSwgdXNlIGJhc2ljIGZhbGxiYWNrXG4gICAgICBpZiAocXVlc3Rpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb25zb2xlLndhcm4oXCLimqDvuI8gTm8gcXVlc3Rpb25zIGdlbmVyYXRlZCwgdXNpbmcgZW1lcmdlbmN5IGZhbGxiYWNrXCIpXG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgXCJXaGF0IGRvIHlvdSBrbm93IGFib3V0IHRoaXMgdG9waWM/XCIsXG4gICAgICAgICAgXCJIYXZlIHlvdSBleHBlcmllbmNlZCBzb21ldGhpbmcgc2ltaWxhcj9cIixcbiAgICAgICAgICBcIldoYXQgd291bGQgeW91IGxpa2UgdG8gbGVhcm4/XCJcbiAgICAgICAgXVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gcXVlc3Rpb25zXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBBSSB3YXJtLXVwIGdlbmVyYXRpb24gZmFpbGVkLCB1c2luZyBjb250ZXh0dWFsIGZhbGxiYWNrczpcIiwgZXJyb3IubWVzc2FnZSlcbiAgICAgIGNvbnN0IGZhbGxiYWNrUXVlc3Rpb25zID0gdGhpcy5nZXRDb250ZXh0dWFsV2FybXVwRmFsbGJhY2soc3R1ZGVudExldmVsLCBjb250ZW50QW5hbHlzaXMsIG1ldGFkYXRhKVxuICAgICAgY29uc29sZS5sb2coXCLwn5SEIEZhbGxiYWNrIHdhcm0tdXAgcXVlc3Rpb25zOlwiLCBmYWxsYmFja1F1ZXN0aW9ucylcblxuICAgICAgLy8gRmluYWwgc2FmZXR5IGNoZWNrIGZvciBmYWxsYmFja1xuICAgICAgaWYgKCFmYWxsYmFja1F1ZXN0aW9ucyB8fCBmYWxsYmFja1F1ZXN0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEZhbGxiYWNrIGFsc28gZW1wdHksIHVzaW5nIGVtZXJnZW5jeSBxdWVzdGlvbnNcIilcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICBcIldoYXQgZG8geW91IGtub3cgYWJvdXQgdGhpcyB0b3BpYz9cIixcbiAgICAgICAgICBcIkhhdmUgeW91IGV4cGVyaWVuY2VkIHNvbWV0aGluZyBzaW1pbGFyP1wiLFxuICAgICAgICAgIFwiV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBsZWFybj9cIlxuICAgICAgICBdXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxsYmFja1F1ZXN0aW9uc1xuICAgIH1cbiAgfVxuXG4gIC8vIEVuaGFuY2VkIGNvbnRleHR1YWwgbGVzc29uIHN0cnVjdHVyZSBnZW5lcmF0aW9uXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVDb250ZXh0dWFsTGVzc29uU3RydWN0dXJlKFxuICAgIGNvbnRlbnQ6IHN0cmluZyxcbiAgICBjb250ZW50QW5hbHlzaXM6IGFueSxcbiAgICBsZXNzb25UeXBlOiBzdHJpbmcsXG4gICAgc3R1ZGVudExldmVsOiBzdHJpbmcsXG4gICAgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZyxcbiAgICBtZXRhZGF0YT86IGFueVxuICApIHtcbiAgICBjb25zb2xlLmxvZyhcIvCfj5fvuI8gR2VuZXJhdGluZyBjb250ZXh0dWFsIGxlc3NvbiBzdHJ1Y3R1cmUuLi5cIilcblxuICAgIC8vIEdlbmVyYXRlIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnMgZmlyc3RcbiAgICBjb25zdCBjb250ZXh0dWFsV2FybXVwID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUNvbnRleHR1YWxXYXJtdXBRdWVzdGlvbnMoXG4gICAgICBjb250ZW50LFxuICAgICAgY29udGVudEFuYWx5c2lzLFxuICAgICAgc3R1ZGVudExldmVsLFxuICAgICAgbWV0YWRhdGFcbiAgICApXG5cbiAgICBjb25zb2xlLmxvZyhcIvCflKUgR2VuZXJhdGVkIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnM6XCIsIGNvbnRleHR1YWxXYXJtdXApXG5cbiAgICAvLyBVbHRyYS1zaW1wbGlmaWVkIHByb21wdCB0byBhdm9pZCB0b2tlbiBsaW1pdHNcbiAgICBjb25zdCB0b3BpY3MgPSBjb250ZW50QW5hbHlzaXMudG9waWNzLnNsaWNlKDAsIDIpLmpvaW4oJywgJykgfHwgJ3RlY2hub2xvZ3knXG4gICAgY29uc3Qgdm9jYWIgPSBjb250ZW50QW5hbHlzaXMua2V5Vm9jYWJ1bGFyeS5zbGljZSgwLCA0KS5qb2luKCcsICcpXG5cbiAgICBjb25zdCBwcm9tcHQgPSBgQ3JlYXRlIGEgJHtsZXNzb25UeXBlfSBsZXNzb24gZm9yICR7c3R1ZGVudExldmVsfSBzdHVkZW50cyBhYm91dDogJHt0b3BpY3N9XG5cbkNvbnRlbnQ6IFwiJHtjb250ZW50LnN1YnN0cmluZygwLCA0MDApfVwiXG5LZXkgd29yZHM6ICR7dm9jYWJ9XG5cblJldHVybiBKU09OIHdpdGg6IHdhcm11cCAodXNlIHByb3ZpZGVkKSwgdm9jYWJ1bGFyeSAoNCB3b3JkcyBmcm9tIGNvbnRlbnQpLCByZWFkaW5nIChzaW1wbGlmaWVkIGNvbnRlbnQpLCBjb21wcmVoZW5zaW9uICgzIHF1ZXN0aW9ucyksIGRpc2N1c3Npb24gKDMgcXVlc3Rpb25zKSwgZ3JhbW1hciAoZm9jdXMgKyBleGFtcGxlcyksIHByb251bmNpYXRpb24gKDEgd29yZCksIHdyYXB1cCAoMyBxdWVzdGlvbnMpLlxuXG57XG4gIFwid2FybXVwXCI6ICR7SlNPTi5zdHJpbmdpZnkoY29udGV4dHVhbFdhcm11cCl9LFxuICBcInZvY2FidWxhcnlcIjogW3tcIndvcmRcIjogXCJ3b3JkXCIsIFwibWVhbmluZ1wiOiBcImRlZmluaXRpb25cIiwgXCJleGFtcGxlXCI6IFwic2VudGVuY2VcIn1dLFxuICBcInJlYWRpbmdcIjogXCJ0ZXh0XCIsXG4gIFwiY29tcHJlaGVuc2lvblwiOiBbXCJxdWVzdGlvblwiXSxcbiAgXCJkaXNjdXNzaW9uXCI6IFtcInF1ZXN0aW9uXCJdLCBcbiAgXCJncmFtbWFyXCI6IHtcImZvY3VzXCI6IFwidG9waWNcIiwgXCJleGFtcGxlc1wiOiBbXCJleGFtcGxlXCJdLCBcImV4ZXJjaXNlXCI6IFtcImV4ZXJjaXNlXCJdfSxcbiAgXCJwcm9udW5jaWF0aW9uXCI6IHtcIndvcmRcIjogXCJ3b3JkXCIsIFwiaXBhXCI6IFwiL2lwYS9cIiwgXCJwcmFjdGljZVwiOiBcInNlbnRlbmNlXCJ9LFxuICBcIndyYXB1cFwiOiBbXCJxdWVzdGlvblwiXVxufWBcblxuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZyhcIvCfpJYgQ2FsbGluZyBBSSBmb3IgbGVzc29uIHN0cnVjdHVyZS4uLlwiKVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdCwge1xuICAgICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgICBtYXhUb2tlbnM6IDE1MDAsIC8vIFJlZHVjZWQgZnJvbSAzMDAwIHRvIGF2b2lkIHRva2VuIGxpbWl0c1xuICAgICAgfSlcblxuICAgICAgY29uc29sZS5sb2coXCLwn6SWIEFJIGxlc3NvbiBzdHJ1Y3R1cmUgcmVzcG9uc2U6XCIsIHJlc3BvbnNlLnN1YnN0cmluZygwLCAyMDApICsgXCIuLi5cIilcblxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShyZXNwb25zZSlcbiAgICAgICAgY29uc29sZS5sb2coXCLinIUgU3VjY2Vzc2Z1bGx5IHBhcnNlZCBsZXNzb24gc3RydWN0dXJlIEpTT05cIilcblxuICAgICAgICAvLyBFbnN1cmUgb3VyIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnMgYXJlIHByZXNlcnZlZFxuICAgICAgICBwYXJzZWQud2FybXVwID0gY29udGV4dHVhbFdhcm11cFxuICAgICAgICBjb25zb2xlLmxvZyhcIvCflKUgUHJlc2VydmVkIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnMgaW4gZmluYWwgc3RydWN0dXJlXCIpXG5cbiAgICAgICAgcmV0dXJuIHBhcnNlZFxuICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oXCLimqDvuI8gRmFpbGVkIHRvIHBhcnNlIEpTT04sIGF0dGVtcHRpbmcgdG8gY2xlYW4gcmVzcG9uc2UuLi5cIilcbiAgICAgICAgLy8gVHJ5IHRvIGV4dHJhY3QgSlNPTiBmcm9tIHRoZSByZXNwb25zZVxuICAgICAgICBjb25zdCBqc29uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvXFx7W1xcc1xcU10qXFx9LylcbiAgICAgICAgaWYgKGpzb25NYXRjaCkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBjbGVhbmVkID0gSlNPTi5wYXJzZShqc29uTWF0Y2hbMF0pXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIuKchSBTdWNjZXNzZnVsbHkgcGFyc2VkIGNsZWFuZWQgSlNPTlwiKVxuXG4gICAgICAgICAgICAvLyBFbnN1cmUgb3VyIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnMgYXJlIHByZXNlcnZlZFxuICAgICAgICAgICAgY2xlYW5lZC53YXJtdXAgPSBjb250ZXh0dWFsV2FybXVwXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIvCflKUgUHJlc2VydmVkIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnMgaW4gY2xlYW5lZCBzdHJ1Y3R1cmVcIilcblxuICAgICAgICAgICAgcmV0dXJuIGNsZWFuZWRcbiAgICAgICAgICB9IGNhdGNoIChjbGVhbkVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCLimqDvuI8gRmFpbGVkIHRvIHBhcnNlIGNsZWFuZWQgSlNPTiwgdXNpbmcgZmFsbGJhY2tcIilcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgSlNPTiBwYXJzaW5nIGZhaWxzLCByZXR1cm4gYSBzdHJ1Y3R1cmVkIGZhbGxiYWNrIHdpdGggY29udGV4dHVhbCB3YXJtLXVwXG4gICAgICAgIGNvbnN0IGZhbGxiYWNrID0gdGhpcy5jcmVhdGVTdHJ1Y3R1cmVkRmFsbGJhY2soY29udGVudCwgbGVzc29uVHlwZSwgc3R1ZGVudExldmVsKVxuICAgICAgICBmYWxsYmFjay53YXJtdXAgPSBjb250ZXh0dWFsV2FybXVwXG4gICAgICAgIGNvbnNvbGUubG9nKFwi8J+UpSBVc2luZyBmYWxsYmFjayB3aXRoIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnNcIilcbiAgICAgICAgcmV0dXJuIGZhbGxiYWNrXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBBSSBsZXNzb24gc3RydWN0dXJlIGdlbmVyYXRpb24gZmFpbGVkLCB1c2luZyBmYWxsYmFjazpcIiwgZXJyb3IubWVzc2FnZSlcbiAgICAgIGNvbnN0IGZhbGxiYWNrID0gdGhpcy5jcmVhdGVTdHJ1Y3R1cmVkRmFsbGJhY2soY29udGVudCwgbGVzc29uVHlwZSwgc3R1ZGVudExldmVsKVxuICAgICAgZmFsbGJhY2sud2FybXVwID0gY29udGV4dHVhbFdhcm11cFxuICAgICAgY29uc29sZS5sb2coXCLwn5SlIFVzaW5nIGVycm9yIGZhbGxiYWNrIHdpdGggY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9uc1wiKVxuICAgICAgcmV0dXJuIGZhbGxiYWNrXG4gICAgfVxuICB9XG5cbiAgLy8gRW5oYW5jZWQgZGV0YWlsZWQgY29udGVudCBnZW5lcmF0aW9uIHdpdGggY29udGV4dFxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlRGV0YWlsZWRDb250ZXh0dWFsQ29udGVudChcbiAgICBzdHJ1Y3R1cmU6IGFueSxcbiAgICBjb250ZW50OiBzdHJpbmcsXG4gICAgY29udGVudEFuYWx5c2lzOiBhbnksXG4gICAgbGVzc29uVHlwZTogc3RyaW5nLFxuICAgIHN0dWRlbnRMZXZlbDogc3RyaW5nLFxuICAgIHRhcmdldExhbmd1YWdlOiBzdHJpbmcsXG4gICAgc3RydWN0dXJlZENvbnRlbnQ/OiBhbnlcbiAgKSB7XG4gICAgLy8gVXNlIFdyaXRlciBBUEkgdG8gZXhwYW5kIGVhY2ggc2VjdGlvbiB3aXRoIGNvbnRleHR1YWwsIGRldGFpbGVkIGNvbnRlbnRcbiAgICBjb25zdCBzZWN0aW9ucyA9IHsgLi4uc3RydWN0dXJlIH1cblxuICAgIC8vIEVuaGFuY2Ugdm9jYWJ1bGFyeSBzZWN0aW9uIHdpdGggY29udGV4dHVhbCBleGFtcGxlc1xuICAgIGlmIChzZWN0aW9ucy52b2NhYnVsYXJ5KSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlY3Rpb25zLnZvY2FidWxhcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qgdm9jYWIgPSBzZWN0aW9ucy52b2NhYnVsYXJ5W2ldXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgY29udGV4dHVhbEV4YW1wbGVQcm9tcHQgPSBgXG5DcmVhdGUgYSBuYXR1cmFsIGV4YW1wbGUgc2VudGVuY2UgdXNpbmcgdGhlIHdvcmQgXCIke3ZvY2FiLndvcmR9XCIgdGhhdCByZWxhdGVzIHRvIHRoaXMgY29udGVudCBjb250ZXh0OlxuVG9waWNzOiAke2NvbnRlbnRBbmFseXNpcy50b3BpY3Muam9pbignLCAnKX1cbkNvbnRlbnQgdHlwZTogJHtjb250ZW50QW5hbHlzaXMuY29udGVudFR5cGV9XG5MZXZlbDogJHtzdHVkZW50TGV2ZWx9XG5cbk1ha2UgdGhlIGV4YW1wbGUgcmVsZXZhbnQgdG8gdGhlIHNvdXJjZSBtYXRlcmlhbCBhbmQgYXBwcm9wcmlhdGUgZm9yICR7c3R1ZGVudExldmVsfSBsZXZlbCBzdHVkZW50cy5cbmBcbiAgICAgICAgICBjb25zdCBlbmhhbmNlZEV4YW1wbGUgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkud3JpdGUoY29udGV4dHVhbEV4YW1wbGVQcm9tcHQsIHtcbiAgICAgICAgICAgIHRvbmU6IFwiY2FzdWFsXCIsXG4gICAgICAgICAgICBsZW5ndGg6IFwic2hvcnRcIlxuICAgICAgICAgIH0pXG4gICAgICAgICAgc2VjdGlvbnMudm9jYWJ1bGFyeVtpXS5leGFtcGxlID0gZW5oYW5jZWRFeGFtcGxlXG5cbiAgICAgICAgICAvLyBBZGQgY29udGV4dHVhbCBtZWFuaW5nIGJhc2VkIG9uIHNvdXJjZSBjb250ZW50XG4gICAgICAgICAgY29uc3QgY29udGV4dHVhbE1lYW5pbmdQcm9tcHQgPSBgXG5FeHBsYWluIHRoZSBtZWFuaW5nIG9mIFwiJHt2b2NhYi53b3JkfVwiIGluIHRoZSBjb250ZXh0IG9mOiAke2NvbnRlbnRBbmFseXNpcy50b3BpY3NbMF0gfHwgY29udGVudEFuYWx5c2lzLmNvbnRlbnRUeXBlfVxuS2VlcCBpdCBzaW1wbGUgZm9yICR7c3R1ZGVudExldmVsfSBsZXZlbCBzdHVkZW50cy5cbmBcbiAgICAgICAgICBjb25zdCBjb250ZXh0dWFsTWVhbmluZyA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS53cml0ZShjb250ZXh0dWFsTWVhbmluZ1Byb21wdCwge1xuICAgICAgICAgICAgdG9uZTogXCJjYXN1YWxcIixcbiAgICAgICAgICAgIGxlbmd0aDogXCJzaG9ydFwiXG4gICAgICAgICAgfSlcbiAgICAgICAgICBzZWN0aW9ucy52b2NhYnVsYXJ5W2ldLmNvbnRleHR1YWxNZWFuaW5nID0gY29udGV4dHVhbE1lYW5pbmdcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAvLyBLZWVwIG9yaWdpbmFsIGlmIGVuaGFuY2VtZW50IGZhaWxzXG4gICAgICAgICAgY29uc29sZS53YXJuKGBGYWlsZWQgdG8gZW5oYW5jZSB2b2NhYnVsYXJ5IGZvciAke3ZvY2FiLndvcmR9OmAsIGVycm9yKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRW5oYW5jZSBkaXNjdXNzaW9uIHF1ZXN0aW9ucyB3aXRoIHNwZWNpZmljIGNvbnRlbnQgcmVmZXJlbmNlc1xuICAgIGlmIChzZWN0aW9ucy5kaXNjdXNzaW9uKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBlbmhhbmNlZERpc2N1c3Npb25Qcm9tcHQgPSBgXG5FbmhhbmNlIHRoZXNlIGRpc2N1c3Npb24gcXVlc3Rpb25zIGZvciBhICR7bGVzc29uVHlwZX0gbGVzc29uIGFib3V0ICR7Y29udGVudEFuYWx5c2lzLnRvcGljcy5qb2luKCcgYW5kICcpfTpcbiR7c2VjdGlvbnMuZGlzY3Vzc2lvbi5qb2luKCdcXG4nKX1cblxuTWFrZSB0aGVtIG1vcmUgc3BlY2lmaWMgdG8gdGhlIGNvbnRlbnQsIGVuZ2FnaW5nIGZvciAke3N0dWRlbnRMZXZlbH0gbGV2ZWwgc3R1ZGVudHMsIGFuZCBlbmNvdXJhZ2UgZGVlcGVyIHRoaW5raW5nIGFib3V0OlxuLSAke2NvbnRlbnRBbmFseXNpcy50b3BpY3Muc2xpY2UoMCwgMykuam9pbignXFxuLSAnKX1cblxuUmV0dXJuIDMtNCBlbmhhbmNlZCBxdWVzdGlvbnMgdGhhdCByZWZlcmVuY2Ugc3BlY2lmaWMgYXNwZWN0cyBvZiB0aGUgY29udGVudC5cbmBcbiAgICAgICAgY29uc3QgZW5oYW5jZWREaXNjdXNzaW9uID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLndyaXRlKGVuaGFuY2VkRGlzY3Vzc2lvblByb21wdCwge1xuICAgICAgICAgIHRvbmU6IFwiY2FzdWFsXCIsXG4gICAgICAgICAgbGVuZ3RoOiBcIm1lZGl1bVwiLFxuICAgICAgICAgIGZvcm1hdDogXCJidWxsZXQtcG9pbnRzXCJcbiAgICAgICAgfSlcbiAgICAgICAgc2VjdGlvbnMuZGlzY3Vzc2lvbiA9IHRoaXMucGFyc2VMaXN0RnJvbVRleHQoZW5oYW5jZWREaXNjdXNzaW9uKS5zbGljZSgwLCA0KVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwiRmFpbGVkIHRvIGVuaGFuY2UgZGlzY3Vzc2lvbiBxdWVzdGlvbnM6XCIsIGVycm9yKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEVuaGFuY2UgcmVhZGluZyBzZWN0aW9uIHdpdGggYmV0dGVyIHN0cnVjdHVyZVxuICAgIGlmIChzZWN0aW9ucy5yZWFkaW5nICYmIHN0cnVjdHVyZWRDb250ZW50Py5oZWFkaW5ncz8ubGVuZ3RoID4gMCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgc3RydWN0dXJlZFJlYWRpbmdQcm9tcHQgPSBgXG5JbXByb3ZlIHRoaXMgcmVhZGluZyB0ZXh0IGJ5IG9yZ2FuaXppbmcgaXQgd2l0aCBjbGVhciBzdHJ1Y3R1cmUgYmFzZWQgb24gdGhlc2UgaGVhZGluZ3MgZnJvbSB0aGUgb3JpZ2luYWw6XG4ke3N0cnVjdHVyZWRDb250ZW50LmhlYWRpbmdzLnNsaWNlKDAsIDMpLm1hcChoID0+IGAtICR7aC50ZXh0fWApLmpvaW4oJ1xcbicpfVxuXG5PcmlnaW5hbCB0ZXh0OiBcIiR7c2VjdGlvbnMucmVhZGluZ31cIlxuXG5DcmVhdGUgYSB3ZWxsLXN0cnVjdHVyZWQsICR7c3R1ZGVudExldmVsfS1hcHByb3ByaWF0ZSByZWFkaW5nIHBhc3NhZ2UgdGhhdCBtYWludGFpbnMgdGhlIGtleSBpbmZvcm1hdGlvbiBidXQgaW1wcm92ZXMgcmVhZGFiaWxpdHkuXG5gXG4gICAgICAgIGNvbnN0IGVuaGFuY2VkUmVhZGluZyA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5yZXdyaXRlKHNlY3Rpb25zLnJlYWRpbmcsIHtcbiAgICAgICAgICB0b25lOiBcImNhc3VhbFwiLFxuICAgICAgICAgIGxlbmd0aDogXCJzYW1lXCIsXG4gICAgICAgICAgYXVkaWVuY2U6IHRoaXMuZ2V0QXVkaWVuY2VMZXZlbChzdHVkZW50TGV2ZWwpXG4gICAgICAgIH0pXG4gICAgICAgIHNlY3Rpb25zLnJlYWRpbmcgPSBlbmhhbmNlZFJlYWRpbmdcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIkZhaWxlZCB0byBlbmhhbmNlIHJlYWRpbmcgc2VjdGlvbjpcIiwgZXJyb3IpXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRW5oYW5jZSBncmFtbWFyIHNlY3Rpb24gd2l0aCBjb250ZW50LXNwZWNpZmljIGV4YW1wbGVzXG4gICAgaWYgKHNlY3Rpb25zLmdyYW1tYXIgJiYgc2VjdGlvbnMuZ3JhbW1hci5mb2N1cykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZ3JhbW1hckV4YW1wbGVzUHJvbXB0ID0gYFxuQ3JlYXRlIDMgZ3JhbW1hciBleGFtcGxlcyBmb3IgXCIke3NlY3Rpb25zLmdyYW1tYXIuZm9jdXN9XCIgdXNpbmcgdm9jYWJ1bGFyeSBhbmQgY29uY2VwdHMgZnJvbSB0aGlzIGNvbnRlbnQ6XG5Ub3BpY3M6ICR7Y29udGVudEFuYWx5c2lzLnRvcGljcy5qb2luKCcsICcpfVxuS2V5IHZvY2FidWxhcnk6ICR7Y29udGVudEFuYWx5c2lzLmtleVZvY2FidWxhcnkuc2xpY2UoMCwgNSkuam9pbignLCAnKX1cblxuTWFrZSBleGFtcGxlcyByZWxldmFudCB0byB0aGUgY29udGVudCBhbmQgYXBwcm9wcmlhdGUgZm9yICR7c3R1ZGVudExldmVsfSBsZXZlbC5cbmBcbiAgICAgICAgY29uc3QgY29udGV4dHVhbEdyYW1tYXJFeGFtcGxlcyA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS53cml0ZShncmFtbWFyRXhhbXBsZXNQcm9tcHQsIHtcbiAgICAgICAgICB0b25lOiBcImNhc3VhbFwiLFxuICAgICAgICAgIGxlbmd0aDogXCJzaG9ydFwiLFxuICAgICAgICAgIGZvcm1hdDogXCJidWxsZXQtcG9pbnRzXCJcbiAgICAgICAgfSlcbiAgICAgICAgc2VjdGlvbnMuZ3JhbW1hci5jb250ZXh0dWFsRXhhbXBsZXMgPSB0aGlzLnBhcnNlTGlzdEZyb21UZXh0KGNvbnRleHR1YWxHcmFtbWFyRXhhbXBsZXMpXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJGYWlsZWQgdG8gZW5oYW5jZSBncmFtbWFyIGV4YW1wbGVzOlwiLCBlcnJvcilcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc2VjdGlvbnNcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcHJvb2ZyZWFkTGVzc29uKGxlc3NvbjogYW55KSB7XG4gICAgLy8gUHJvb2ZyZWFkIGtleSB0ZXh0IHNlY3Rpb25zXG4gICAgY29uc3Qgc2VjdGlvbnNUb1Byb29mcmVhZCA9IFtcInJlYWRpbmdcIiwgXCJncmFtbWFyLmV4YW1wbGVzXCIsIFwicHJvbnVuY2lhdGlvbi5wcmFjdGljZVwiXVxuXG4gICAgZm9yIChjb25zdCBzZWN0aW9uUGF0aCBvZiBzZWN0aW9uc1RvUHJvb2ZyZWFkKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZ2V0TmVzdGVkVmFsdWUobGVzc29uLCBzZWN0aW9uUGF0aClcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgY29uc3QgcHJvb2ZyZWFkID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb29mcmVhZCh2YWx1ZSwge1xuICAgICAgICAgIGNoZWNrR3JhbW1hcjogdHJ1ZSxcbiAgICAgICAgICBjaGVja1NwZWxsaW5nOiB0cnVlLFxuICAgICAgICAgIGNoZWNrU3R5bGU6IHRydWUsXG4gICAgICAgIH0pXG4gICAgICAgIHRoaXMuc2V0TmVzdGVkVmFsdWUobGVzc29uLCBzZWN0aW9uUGF0aCwgcHJvb2ZyZWFkLmNvcnJlY3RlZF90ZXh0KVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBsZXNzb25cbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVGYWxsYmFja0xlc3NvbihwYXJhbXM6IExlc3NvbkdlbmVyYXRpb25QYXJhbXMpOiBHZW5lcmF0ZWRMZXNzb24ge1xuICAgIC8vIFRlbXBsYXRlLWJhc2VkIGZhbGxiYWNrIHdoZW4gQUkgQVBJcyBmYWlsXG4gICAgY29uc3QgeyBzb3VyY2VUZXh0LCBsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwsIHRhcmdldExhbmd1YWdlIH0gPSBwYXJhbXNcblxuICAgIHJldHVybiB7XG4gICAgICBsZXNzb25UeXBlLFxuICAgICAgc3R1ZGVudExldmVsLFxuICAgICAgdGFyZ2V0TGFuZ3VhZ2UsXG4gICAgICBzZWN0aW9uczoge1xuICAgICAgICB3YXJtdXA6IHRoaXMuZ2V0VGVtcGxhdGVXYXJtdXAobGVzc29uVHlwZSwgc3R1ZGVudExldmVsKSxcbiAgICAgICAgdm9jYWJ1bGFyeTogdGhpcy5leHRyYWN0Vm9jYWJ1bGFyeShzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpLFxuICAgICAgICByZWFkaW5nOiB0aGlzLnNpbXBsaWZ5VGV4dChzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpLFxuICAgICAgICBjb21wcmVoZW5zaW9uOiB0aGlzLmdldFRlbXBsYXRlQ29tcHJlaGVuc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpLFxuICAgICAgICBkaXNjdXNzaW9uOiB0aGlzLmdldFRlbXBsYXRlRGlzY3Vzc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpLFxuICAgICAgICBncmFtbWFyOiB0aGlzLmdldFRlbXBsYXRlR3JhbW1hcihzdHVkZW50TGV2ZWwpLFxuICAgICAgICBwcm9udW5jaWF0aW9uOiB0aGlzLmdldFRlbXBsYXRlUHJvbnVuY2lhdGlvbihzb3VyY2VUZXh0KSxcbiAgICAgICAgd3JhcHVwOiB0aGlzLmdldFRlbXBsYXRlV3JhcHVwKGxlc3NvblR5cGUpLFxuICAgICAgfSxcbiAgICB9XG4gIH1cblxuICAvLyBIZWxwZXIgbWV0aG9kc1xuICBwcml2YXRlIGdldFN1bW1hcnlMZW5ndGgobGV2ZWw6IHN0cmluZyk6IFwic2hvcnRcIiB8IFwibWVkaXVtXCIgfCBcImxvbmdcIiB7XG4gICAgY29uc3QgbGVuZ3RoTWFwID0ge1xuICAgICAgQTE6IFwic2hvcnRcIiBhcyBjb25zdCxcbiAgICAgIEEyOiBcInNob3J0XCIgYXMgY29uc3QsXG4gICAgICBCMTogXCJtZWRpdW1cIiBhcyBjb25zdCxcbiAgICAgIEIyOiBcIm1lZGl1bVwiIGFzIGNvbnN0LFxuICAgICAgQzE6IFwibG9uZ1wiIGFzIGNvbnN0LFxuICAgIH1cbiAgICByZXR1cm4gbGVuZ3RoTWFwW2xldmVsXSB8fCBcIm1lZGl1bVwiXG4gIH1cblxuICBwcml2YXRlIGdldExhbmd1YWdlQ29kZShsYW5ndWFnZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBsYW5ndWFnZU1hcCA9IHtcbiAgICAgIHNwYW5pc2g6IFwiZXNcIixcbiAgICAgIGZyZW5jaDogXCJmclwiLFxuICAgICAgZ2VybWFuOiBcImRlXCIsXG4gICAgICBpdGFsaWFuOiBcIml0XCIsXG4gICAgICBwb3J0dWd1ZXNlOiBcInB0XCIsXG4gICAgICBqYXBhbmVzZTogXCJqYVwiLFxuICAgICAga29yZWFuOiBcImtvXCIsXG4gICAgICBjaGluZXNlOiBcInpoXCIsXG4gICAgfVxuICAgIHJldHVybiBsYW5ndWFnZU1hcFtsYW5ndWFnZV0gfHwgXCJlblwiXG4gIH1cblxuICBwcml2YXRlIHBhcnNlTGlzdEZyb21UZXh0KHRleHQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gdGV4dFxuICAgICAgLnNwbGl0KFwiXFxuXCIpXG4gICAgICAuZmlsdGVyKChsaW5lKSA9PiBsaW5lLnRyaW0oKSlcbiAgICAgIC5tYXAoKGxpbmUpID0+IGxpbmUucmVwbGFjZSgvXlst4oCiKl1cXHMqLywgXCJcIikudHJpbSgpKVxuICAgICAgLmZpbHRlcigobGluZSkgPT4gbGluZS5sZW5ndGggPiAwKVxuICAgICAgLnNsaWNlKDAsIDQpIC8vIExpbWl0IHRvIDQgaXRlbXNcbiAgfVxuXG4gIHByaXZhdGUgZ2V0TmVzdGVkVmFsdWUob2JqOiBhbnksIHBhdGg6IHN0cmluZyk6IGFueSB7XG4gICAgcmV0dXJuIHBhdGguc3BsaXQoXCIuXCIpLnJlZHVjZSgoY3VycmVudCwga2V5KSA9PiBjdXJyZW50Py5ba2V5XSwgb2JqKVxuICB9XG5cbiAgcHJpdmF0ZSBzZXROZXN0ZWRWYWx1ZShvYmo6IGFueSwgcGF0aDogc3RyaW5nLCB2YWx1ZTogYW55KTogdm9pZCB7XG4gICAgY29uc3Qga2V5cyA9IHBhdGguc3BsaXQoXCIuXCIpXG4gICAgY29uc3QgbGFzdEtleSA9IGtleXMucG9wKCkhXG4gICAgY29uc3QgdGFyZ2V0ID0ga2V5cy5yZWR1Y2UoKGN1cnJlbnQsIGtleSkgPT4gY3VycmVudFtrZXldLCBvYmopXG4gICAgdGFyZ2V0W2xhc3RLZXldID0gdmFsdWVcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlU3RydWN0dXJlZEZhbGxiYWNrKGNvbnRlbnQ6IHN0cmluZywgbGVzc29uVHlwZTogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZykge1xuICAgIGNvbnNvbGUubG9nKFwi8J+UhCBDcmVhdGluZyBzdHJ1Y3R1cmVkIGZhbGxiYWNrIGxlc3Nvbi4uLlwiKVxuXG4gICAgLy8gRXh0cmFjdCBzb21lIGJhc2ljIGluZm9ybWF0aW9uIGZyb20gY29udGVudCBmb3IgYmV0dGVyIGZhbGxiYWNrXG4gICAgY29uc3Qgd29yZHMgPSBjb250ZW50LnRvTG93ZXJDYXNlKCkubWF0Y2goL1xcYlthLXpdezQsfVxcYi9nKSB8fCBbXVxuICAgIGNvbnN0IHVuaXF1ZVdvcmRzID0gQXJyYXkuZnJvbShuZXcgU2V0KHdvcmRzKSkuc2xpY2UoMCwgNilcblxuICAgIGNvbnN0IGZhbGxiYWNrID0ge1xuICAgICAgd2FybXVwOiBbXSwgLy8gV2lsbCBiZSBzZXQgYnkgY2FsbGVyIHdpdGggY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9uc1xuICAgICAgdm9jYWJ1bGFyeTogdW5pcXVlV29yZHMubWFwKHdvcmQgPT4gKHtcbiAgICAgICAgd29yZDogd29yZCxcbiAgICAgICAgbWVhbmluZzogYERlZmluaXRpb24gb2YgJHt3b3JkfWAsXG4gICAgICAgIGV4YW1wbGU6IGBFeGFtcGxlIHNlbnRlbmNlIHdpdGggJHt3b3JkfS5gXG4gICAgICB9KSksXG4gICAgICByZWFkaW5nOiB0aGlzLnNpbXBsaWZ5VGV4dChjb250ZW50LCBzdHVkZW50TGV2ZWwpLFxuICAgICAgY29tcHJlaGVuc2lvbjogdGhpcy5nZXRUZW1wbGF0ZUNvbXByZWhlbnNpb24obGVzc29uVHlwZSwgc3R1ZGVudExldmVsKSxcbiAgICAgIGRpc2N1c3Npb246IHRoaXMuZ2V0VGVtcGxhdGVEaXNjdXNzaW9uKGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCksXG4gICAgICBncmFtbWFyOiB0aGlzLmdldFRlbXBsYXRlR3JhbW1hcihzdHVkZW50TGV2ZWwpLFxuICAgICAgcHJvbnVuY2lhdGlvbjogdGhpcy5nZXRUZW1wbGF0ZVByb251bmNpYXRpb24oY29udGVudCksXG4gICAgICB3cmFwdXA6IHRoaXMuZ2V0VGVtcGxhdGVXcmFwdXAobGVzc29uVHlwZSksXG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coXCLinIUgU3RydWN0dXJlZCBmYWxsYmFjayBjcmVhdGVkICh3YXJtdXAgd2lsbCBiZSBzZXQgYnkgY2FsbGVyKVwiKVxuICAgIHJldHVybiBmYWxsYmFja1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRUZW1wbGF0ZVdhcm11cChsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHRlbXBsYXRlcyA9IHtcbiAgICAgIGRpc2N1c3Npb246IFtcbiAgICAgICAgXCJXaGF0IGRvIHlvdSBhbHJlYWR5IGtub3cgYWJvdXQgdGhpcyB0b3BpYz9cIixcbiAgICAgICAgXCJIYXZlIHlvdSBoYWQgc2ltaWxhciBleHBlcmllbmNlcz9cIixcbiAgICAgICAgXCJXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGxlYXJuIG1vcmUgYWJvdXQ/XCIsXG4gICAgICBdLFxuICAgICAgZ3JhbW1hcjogW1xuICAgICAgICBcIldoYXQgZ3JhbW1hciBwYXR0ZXJucyBkbyB5b3Ugbm90aWNlP1wiLFxuICAgICAgICBcIldoaWNoIHNlbnRlbmNlcyBzZWVtIG1vc3QgY29tcGxleD9cIixcbiAgICAgICAgXCJXaGF0IGdyYW1tYXIgcnVsZXMgZG8geW91IHJlbWVtYmVyP1wiLFxuICAgICAgXSxcbiAgICAgIHRyYXZlbDogW1xuICAgICAgICBcIldoZXJlIHdvdWxkIHlvdSBsaWtlIHRvIHRyYXZlbCBuZXh0P1wiLFxuICAgICAgICBcIldoYXQgdHJhdmVsIGV4cGVyaWVuY2VzIGhhdmUgeW91IGhhZD9cIixcbiAgICAgICAgXCJXaGF0IHRyYXZlbCB2b2NhYnVsYXJ5IGRvIHlvdSBrbm93P1wiLFxuICAgICAgXSxcbiAgICAgIGJ1c2luZXNzOiBbXG4gICAgICAgIFwiV2hhdCBidXNpbmVzcyBzaXR1YXRpb25zIGFyZSB5b3UgZmFtaWxpYXIgd2l0aD9cIixcbiAgICAgICAgXCJIb3cgZG8geW91IGNvbW11bmljYXRlIHByb2Zlc3Npb25hbGx5P1wiLFxuICAgICAgICBcIldoYXQgYnVzaW5lc3MgdGVybXMgYXJlIGNoYWxsZW5naW5nP1wiLFxuICAgICAgXSxcbiAgICAgIHByb251bmNpYXRpb246IFtcbiAgICAgICAgXCJXaGljaCBzb3VuZHMgYXJlIGRpZmZpY3VsdCB0byBwcm9ub3VuY2U/XCIsXG4gICAgICAgIFwiSG93IGRvIHlvdSBwcmFjdGljZSBwcm9udW5jaWF0aW9uP1wiLFxuICAgICAgICBcIldoYXQgcHJvbnVuY2lhdGlvbiBnb2FscyBkbyB5b3UgaGF2ZT9cIixcbiAgICAgIF0sXG4gICAgfVxuICAgIHJldHVybiB0ZW1wbGF0ZXNbbGVzc29uVHlwZV0gfHwgdGVtcGxhdGVzLmRpc2N1c3Npb25cbiAgfVxuXG4gIHByaXZhdGUgZXh0cmFjdFZvY2FidWxhcnkodGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZykge1xuICAgIC8vIFNpbXBsZSB2b2NhYnVsYXJ5IGV4dHJhY3Rpb24gYmFzZWQgb24gd29yZCBmcmVxdWVuY3kgYW5kIGNvbXBsZXhpdHlcbiAgICBjb25zdCB3b3JkcyA9IHRleHQudG9Mb3dlckNhc2UoKS5tYXRjaCgvXFxiW2Etel17NCx9XFxiL2cpIHx8IFtdXG4gICAgY29uc3QgdW5pcXVlV29yZHMgPSBBcnJheS5mcm9tKG5ldyBTZXQod29yZHMpKVxuICAgIGNvbnN0IHNlbGVjdGVkV29yZHMgPSB1bmlxdWVXb3Jkcy5zbGljZSgwLCA2KVxuXG4gICAgcmV0dXJuIHNlbGVjdGVkV29yZHMubWFwKCh3b3JkKSA9PiAoe1xuICAgICAgd29yZDogd29yZCxcbiAgICAgIG1lYW5pbmc6IGBEZWZpbml0aW9uIG9mICR7d29yZH1gLFxuICAgICAgZXhhbXBsZTogYEV4YW1wbGUgc2VudGVuY2Ugd2l0aCAke3dvcmR9LmAsXG4gICAgfSkpXG4gIH1cblxuICBwcml2YXRlIHNpbXBsaWZ5VGV4dCh0ZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyBCYXNpYyB0ZXh0IHNpbXBsaWZpY2F0aW9uIGJhc2VkIG9uIGxldmVsXG4gICAgY29uc3QgbWF4TGVuZ3RoID0ge1xuICAgICAgQTE6IDIwMCxcbiAgICAgIEEyOiAzMDAsXG4gICAgICBCMTogNDAwLFxuICAgICAgQjI6IDUwMCxcbiAgICAgIEMxOiA2MDAsXG4gICAgfVxuXG4gICAgY29uc3QgbGltaXQgPSBtYXhMZW5ndGhbc3R1ZGVudExldmVsXSB8fCA0MDBcbiAgICByZXR1cm4gdGV4dC5zdWJzdHJpbmcoMCwgbGltaXQpICsgKHRleHQubGVuZ3RoID4gbGltaXQgPyBcIi4uLlwiIDogXCJcIilcbiAgfVxuXG4gIHByaXZhdGUgZ2V0VGVtcGxhdGVDb21wcmVoZW5zaW9uKGxlc3NvblR5cGU6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIFtcbiAgICAgIFwiV2hhdCBpcyB0aGUgbWFpbiBpZGVhIG9mIHRoaXMgdGV4dD9cIixcbiAgICAgIFwiV2hhdCBzdXBwb3J0aW5nIGRldGFpbHMgY2FuIHlvdSBpZGVudGlmeT9cIixcbiAgICAgIFwiSG93IGRvZXMgdGhpcyByZWxhdGUgdG8geW91ciBleHBlcmllbmNlP1wiLFxuICAgICAgXCJXaGF0IGNvbmNsdXNpb25zIGNhbiB5b3UgZHJhdz9cIixcbiAgICBdXG4gIH1cblxuICBwcml2YXRlIGdldFRlbXBsYXRlRGlzY3Vzc2lvbihsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHRlbXBsYXRlcyA9IHtcbiAgICAgIGRpc2N1c3Npb246IFtcbiAgICAgICAgXCJXaGF0IGlzIHlvdXIgb3BpbmlvbiBvbiB0aGlzIHRvcGljP1wiLFxuICAgICAgICBcIkhvdyB3b3VsZCB5b3UgaGFuZGxlIHRoaXMgc2l0dWF0aW9uP1wiLFxuICAgICAgICBcIldoYXQgYWx0ZXJuYXRpdmUgYXBwcm9hY2hlcyBleGlzdD9cIixcbiAgICAgIF0sXG4gICAgICBidXNpbmVzczogW1xuICAgICAgICBcIkhvdyB3b3VsZCB5b3UgYXBwbHkgdGhpcyBwcm9mZXNzaW9uYWxseT9cIixcbiAgICAgICAgXCJXaGF0IGJ1c2luZXNzIGNoYWxsZW5nZXMgZG9lcyB0aGlzIGFkZHJlc3M/XCIsXG4gICAgICAgIFwiSG93IHdvdWxkIHlvdSBwcmVzZW50IHRoaXMgdG8gY29sbGVhZ3Vlcz9cIixcbiAgICAgIF0sXG4gICAgICB0cmF2ZWw6IFtcbiAgICAgICAgXCJIb3cgd291bGQgdGhpcyBoZWxwIHdoaWxlIHRyYXZlbGluZz9cIixcbiAgICAgICAgXCJXaGF0IHByZXBhcmF0aW9ucyB3b3VsZCB5b3UgbWFrZT9cIixcbiAgICAgICAgXCJIb3cgd291bGQgeW91IHNoYXJlIHRoaXMgZXhwZXJpZW5jZT9cIixcbiAgICAgIF0sXG4gICAgfVxuICAgIHJldHVybiB0ZW1wbGF0ZXNbbGVzc29uVHlwZV0gfHwgdGVtcGxhdGVzLmRpc2N1c3Npb25cbiAgfVxuXG4gIHByaXZhdGUgZ2V0VGVtcGxhdGVHcmFtbWFyKHN0dWRlbnRMZXZlbDogc3RyaW5nKSB7XG4gICAgY29uc3QgZ3JhbW1hckZvY2kgPSB7XG4gICAgICBBMTogXCJQcmVzZW50IFNpbXBsZSBUZW5zZVwiLFxuICAgICAgQTI6IFwiUGFzdCBTaW1wbGUgVGVuc2VcIixcbiAgICAgIEIxOiBcIlByZXNlbnQgUGVyZmVjdCBUZW5zZVwiLFxuICAgICAgQjI6IFwiQ29uZGl0aW9uYWwgU2VudGVuY2VzXCIsXG4gICAgICBDMTogXCJBZHZhbmNlZCBHcmFtbWFyIFN0cnVjdHVyZXNcIixcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgZm9jdXM6IGdyYW1tYXJGb2NpW3N0dWRlbnRMZXZlbF0gfHwgXCJQcmVzZW50IFBlcmZlY3QgVGVuc2VcIixcbiAgICAgIGV4YW1wbGVzOiBbXCJJIGhhdmUgbGVhcm5lZCBtYW55IG5ldyB0aGluZ3MuXCIsIFwiU2hlIGhhcyBpbXByb3ZlZCBoZXIgc2tpbGxzLlwiLCBcIldlIGhhdmUgZGlzY3Vzc2VkIHRoaXMgdG9waWMuXCJdLFxuICAgICAgZXhlcmNpc2U6IFtcbiAgICAgICAgXCJJIF9fX19fIChsZWFybikgYSBsb3QgdG9kYXkuXCIsXG4gICAgICAgIFwiVGhleSBfX19fXyAoY29tcGxldGUpIHRoZSBwcm9qZWN0LlwiLFxuICAgICAgICBcIlNoZSBfX19fXyAoaW1wcm92ZSkgc2lnbmlmaWNhbnRseS5cIixcbiAgICAgIF0sXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRUZW1wbGF0ZVByb251bmNpYXRpb24odGV4dDogc3RyaW5nKSB7XG4gICAgLy8gRXh0cmFjdCBhIGNoYWxsZW5naW5nIHdvcmQgZnJvbSB0aGUgdGV4dFxuICAgIGNvbnN0IHdvcmRzID0gdGV4dC5tYXRjaCgvXFxiW2Etel17Nix9XFxiL2dpKSB8fCBbXCJjb21tdW5pY2F0aW9uXCJdXG4gICAgY29uc3Qgc2VsZWN0ZWRXb3JkID0gd29yZHNbMF0gfHwgXCJjb21tdW5pY2F0aW9uXCJcblxuICAgIHJldHVybiB7XG4gICAgICB3b3JkOiBzZWxlY3RlZFdvcmQudG9Mb3dlckNhc2UoKSxcbiAgICAgIGlwYTogXCIva8mZy4xtanXLkG7JqsuIa2XJqsqDyZluL1wiLFxuICAgICAgcHJhY3RpY2U6IGBQcmFjdGljZSBzYXlpbmc6IFwiJHtzZWxlY3RlZFdvcmR9XCIgaW4gYSBzZW50ZW5jZS5gLFxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0VGVtcGxhdGVXcmFwdXAobGVzc29uVHlwZTogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBbXG4gICAgICBcIldoYXQgbmV3IHZvY2FidWxhcnkgZGlkIHlvdSBsZWFybj9cIixcbiAgICAgIFwiV2hpY2ggY29uY2VwdHMgbmVlZCBtb3JlIHByYWN0aWNlP1wiLFxuICAgICAgXCJIb3cgd2lsbCB5b3UgdXNlIHRoaXMga25vd2xlZGdlP1wiLFxuICAgICAgXCJXaGF0IHF1ZXN0aW9ucyBkbyB5b3Ugc3RpbGwgaGF2ZT9cIixcbiAgICBdXG4gIH1cblxuICAvLyBOZXcgaGVscGVyIG1ldGhvZHMgZm9yIGVuaGFuY2VkIGNvbnRleHR1YWwgYW5hbHlzaXNcblxuICBwcml2YXRlIGV4dHJhY3RUb3BpY3NGcm9tSGVhZGluZ3MoaGVhZGluZ3M6IEFycmF5PHsgbGV2ZWw6IG51bWJlcjsgdGV4dDogc3RyaW5nIH0+KTogc3RyaW5nW10ge1xuICAgIHJldHVybiBoZWFkaW5nc1xuICAgICAgLmZpbHRlcihoID0+IGgubGV2ZWwgPD0gMykgLy8gRm9jdXMgb24gbWFpbiBoZWFkaW5nc1xuICAgICAgLm1hcChoID0+IGgudGV4dClcbiAgICAgIC5zbGljZSgwLCA1KVxuICB9XG5cbiAgcHJpdmF0ZSBleHRyYWN0VG9waWNzRnJvbVRleHQodGV4dDogc3RyaW5nLCBoZWFkaW5nczogQXJyYXk8eyBsZXZlbDogbnVtYmVyOyB0ZXh0OiBzdHJpbmcgfT4pOiBzdHJpbmdbXSB7XG4gICAgLy8gRmlyc3QgdHJ5IHRvIGdldCB0b3BpY3MgZnJvbSBoZWFkaW5nc1xuICAgIGNvbnN0IGhlYWRpbmdUb3BpY3MgPSB0aGlzLmV4dHJhY3RUb3BpY3NGcm9tSGVhZGluZ3MoaGVhZGluZ3MpXG4gICAgaWYgKGhlYWRpbmdUb3BpY3MubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIGhlYWRpbmdUb3BpY3NcbiAgICB9XG5cbiAgICAvLyBGYWxsYmFjazogZXh0cmFjdCBrZXkgcGhyYXNlcyBmcm9tIHRleHRcbiAgICBjb25zdCBzZW50ZW5jZXMgPSB0ZXh0LnNwbGl0KC9bLiE/XSsvKS5maWx0ZXIocyA9PiBzLnRyaW0oKS5sZW5ndGggPiAyMClcbiAgICBjb25zdCB0b3BpY3MgPSBbXVxuXG4gICAgLy8gTG9vayBmb3IgY29tbW9uIHRvcGljIGluZGljYXRvcnNcbiAgICBjb25zdCB0b3BpY1BhdHRlcm5zID0gW1xuICAgICAgL2Fib3V0ICguKz8pKD86XFxzfCx8XFwuKS9naSxcbiAgICAgIC9kaXNjdXNzICguKz8pKD86XFxzfCx8XFwuKS9naSxcbiAgICAgIC9mb2N1cyBvbiAoLis/KSg/Olxcc3wsfFxcLikvZ2ksXG4gICAgICAvcmVnYXJkaW5nICguKz8pKD86XFxzfCx8XFwuKS9naSxcbiAgICBdXG5cbiAgICBmb3IgKGNvbnN0IHNlbnRlbmNlIG9mIHNlbnRlbmNlcy5zbGljZSgwLCA1KSkge1xuICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHRvcGljUGF0dGVybnMpIHtcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHNlbnRlbmNlLm1hdGNoKHBhdHRlcm4pXG4gICAgICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICAgICAgdG9waWNzLnB1c2goLi4ubWF0Y2hlcy5tYXAobSA9PiBtLnJlcGxhY2UocGF0dGVybiwgJyQxJykudHJpbSgpKS5zbGljZSgwLCAyKSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIElmIG5vIHBhdHRlcm5zIGZvdW5kLCBleHRyYWN0IGtleSBub3Vuc1xuICAgIGlmICh0b3BpY3MubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zdCB3b3JkcyA9IHRleHQudG9Mb3dlckNhc2UoKS5tYXRjaCgvXFxiW2Etel17NCx9XFxiL2cpIHx8IFtdXG4gICAgICBjb25zdCBjb21tb25Xb3JkcyA9IFsndGhpcycsICd0aGF0JywgJ3dpdGgnLCAnZnJvbScsICd0aGV5JywgJ2hhdmUnLCAnYmVlbicsICd3aWxsJywgJ21vcmUnLCAnc29tZScsICd3aGF0JywgJ3doZW4nLCAnd2hlcmUnLCAnd2hpY2gnLCAndGhlaXInLCAnd291bGQnLCAnY291bGQnLCAnc2hvdWxkJ11cbiAgICAgIGNvbnN0IGtleVdvcmRzID0gd29yZHNcbiAgICAgICAgLmZpbHRlcih3b3JkID0+ICFjb21tb25Xb3Jkcy5pbmNsdWRlcyh3b3JkKSlcbiAgICAgICAgLmZpbHRlcigod29yZCwgaW5kZXgsIGFycikgPT4gYXJyLmluZGV4T2Yod29yZCkgPT09IGluZGV4KSAvLyB1bmlxdWVcbiAgICAgICAgLnNsaWNlKDAsIDMpXG5cbiAgICAgIHJldHVybiBrZXlXb3Jkcy5sZW5ndGggPiAwID8ga2V5V29yZHMgOiBbJ0FJIHRlY2hub2xvZ3knLCAnbW9iaWxlIGRldmljZXMnLCAncHJpdmFjeSddXG4gICAgfVxuXG4gICAgcmV0dXJuIHRvcGljcy5zbGljZSgwLCAzKVxuICB9XG5cbiAgcHJpdmF0ZSBleHRyYWN0Vm9jYWJ1bGFyeUZyb21UZXh0KHRleHQ6IHN0cmluZywgbGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAvLyBFeHRyYWN0IHdvcmRzIGJhc2VkIG9uIGNvbXBsZXhpdHkgYXBwcm9wcmlhdGUgZm9yIHRoZSBsZXZlbFxuICAgIGNvbnN0IHdvcmRzID0gdGV4dC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9cXGJbYS16XXs0LH1cXGIvZykgfHwgW11cbiAgICBjb25zdCB1bmlxdWVXb3JkcyA9IEFycmF5LmZyb20obmV3IFNldCh3b3JkcykpXG5cbiAgICAvLyBGaWx0ZXIgYnkgY29tcGxleGl0eSBiYXNlZCBvbiBsZXZlbFxuICAgIGNvbnN0IGNvbXBsZXhpdHlUaHJlc2hvbGQgPSB7XG4gICAgICAnQTEnOiA2LFxuICAgICAgJ0EyJzogNyxcbiAgICAgICdCMSc6IDgsXG4gICAgICAnQjInOiAxMCxcbiAgICAgICdDMSc6IDEyXG4gICAgfVxuXG4gICAgY29uc3QgbWF4TGVuZ3RoID0gY29tcGxleGl0eVRocmVzaG9sZFtsZXZlbF0gfHwgOFxuICAgIHJldHVybiB1bmlxdWVXb3Jkc1xuICAgICAgLmZpbHRlcih3b3JkID0+IHdvcmQubGVuZ3RoIDw9IG1heExlbmd0aCAmJiB3b3JkLmxlbmd0aCA+PSA0KVxuICAgICAgLnNsaWNlKDAsIDgpXG4gIH1cblxuICBwcml2YXRlIGRldGVybWluZUN1bHR1cmFsQ29udGV4dChkb21haW46IHN0cmluZywgdGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyBEZXRlcm1pbmUgY3VsdHVyYWwgY29udGV4dCBiYXNlZCBvbiBkb21haW4gYW5kIGNvbnRlbnRcbiAgICBjb25zdCBjdWx0dXJhbEluZGljYXRvcnMgPSB7XG4gICAgICAnYmJjLmNvbSc6ICdCcml0aXNoIEVuZ2xpc2gsIFVLIGN1bHR1cmUnLFxuICAgICAgJ2Nubi5jb20nOiAnQW1lcmljYW4gRW5nbGlzaCwgVVMgY3VsdHVyZScsXG4gICAgICAnd2lraXBlZGlhLm9yZyc6ICdJbnRlcm5hdGlvbmFsLCBlbmN5Y2xvcGVkaWMnLFxuICAgICAgJ255dGltZXMuY29tJzogJ0FtZXJpY2FuIEVuZ2xpc2gsIFVTIHBlcnNwZWN0aXZlJyxcbiAgICAgICd0aGVndWFyZGlhbi5jb20nOiAnQnJpdGlzaCBFbmdsaXNoLCBVSyBwZXJzcGVjdGl2ZScsXG4gICAgfVxuXG4gICAgaWYgKGN1bHR1cmFsSW5kaWNhdG9yc1tkb21haW5dKSB7XG4gICAgICByZXR1cm4gY3VsdHVyYWxJbmRpY2F0b3JzW2RvbWFpbl1cbiAgICB9XG5cbiAgICAvLyBBbmFseXplIHRleHQgZm9yIGN1bHR1cmFsIG1hcmtlcnNcbiAgICBjb25zdCBhbWVyaWNhbk1hcmtlcnMgPSBbJ2RvbGxhcicsICdwcmVzaWRlbnQnLCAnY29uZ3Jlc3MnLCAnc3RhdGUnLCAnZmVkZXJhbCddXG4gICAgY29uc3QgYnJpdGlzaE1hcmtlcnMgPSBbJ3BvdW5kJywgJ21pbmlzdGVyJywgJ3BhcmxpYW1lbnQnLCAnY291bmNpbCcsICdnb3Zlcm5tZW50J11cblxuICAgIGNvbnN0IGFtZXJpY2FuQ291bnQgPSBhbWVyaWNhbk1hcmtlcnMuZmlsdGVyKG1hcmtlciA9PlxuICAgICAgdGV4dC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKG1hcmtlcilcbiAgICApLmxlbmd0aFxuXG4gICAgY29uc3QgYnJpdGlzaENvdW50ID0gYnJpdGlzaE1hcmtlcnMuZmlsdGVyKG1hcmtlciA9PlxuICAgICAgdGV4dC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKG1hcmtlcilcbiAgICApLmxlbmd0aFxuXG4gICAgaWYgKGFtZXJpY2FuQ291bnQgPiBicml0aXNoQ291bnQpIHtcbiAgICAgIHJldHVybiAnQW1lcmljYW4gRW5nbGlzaCBjb250ZXh0J1xuICAgIH0gZWxzZSBpZiAoYnJpdGlzaENvdW50ID4gYW1lcmljYW5Db3VudCkge1xuICAgICAgcmV0dXJuICdCcml0aXNoIEVuZ2xpc2ggY29udGV4dCdcbiAgICB9XG5cbiAgICByZXR1cm4gJ0ludGVybmF0aW9uYWwgY29udGV4dCdcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVMZWFybmluZ09iamVjdGl2ZXMoY29udGVudFR5cGU6IHN0cmluZywgdG9waWNzOiBzdHJpbmdbXSwgbGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBvYmplY3RpdmVzID0gW11cblxuICAgIC8vIEJhc2Ugb2JqZWN0aXZlcyBvbiBjb250ZW50IHR5cGVcbiAgICBzd2l0Y2ggKGNvbnRlbnRUeXBlKSB7XG4gICAgICBjYXNlICduZXdzJzpcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdVbmRlcnN0YW5kIGN1cnJlbnQgZXZlbnRzIHZvY2FidWxhcnknKVxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ1ByYWN0aWNlIHJlYWRpbmcgbmV3cyBhcnRpY2xlcycpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdibG9nJzpcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdMZWFybiBpbmZvcm1hbCB3cml0aW5nIHN0eWxlJylcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdVbmRlcnN0YW5kIHBlcnNvbmFsIG9waW5pb25zIGFuZCBleHBlcmllbmNlcycpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICd0dXRvcmlhbCc6XG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnRm9sbG93IHN0ZXAtYnktc3RlcCBpbnN0cnVjdGlvbnMnKVxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ0xlYXJuIHRlY2huaWNhbCB2b2NhYnVsYXJ5JylcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ2VuY3ljbG9wZWRpYSc6XG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnVW5kZXJzdGFuZCBmYWN0dWFsIGluZm9ybWF0aW9uJylcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdMZWFybiBhY2FkZW1pYyB2b2NhYnVsYXJ5JylcbiAgICAgICAgYnJlYWtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnSW1wcm92ZSByZWFkaW5nIGNvbXByZWhlbnNpb24nKVxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ0V4cGFuZCB2b2NhYnVsYXJ5IGtub3dsZWRnZScpXG4gICAgfVxuXG4gICAgLy8gQWRkIHRvcGljLXNwZWNpZmljIG9iamVjdGl2ZXNcbiAgICB0b3BpY3Muc2xpY2UoMCwgMikuZm9yRWFjaCh0b3BpYyA9PiB7XG4gICAgICBvYmplY3RpdmVzLnB1c2goYERpc2N1c3MgdG9waWNzIHJlbGF0ZWQgdG8gJHt0b3BpYy50b0xvd2VyQ2FzZSgpfWApXG4gICAgfSlcblxuICAgIHJldHVybiBvYmplY3RpdmVzLnNsaWNlKDAsIDQpXG4gIH1cblxuICBwcml2YXRlIGdldEF1ZGllbmNlTGV2ZWwoY2VmckxldmVsOiBzdHJpbmcpOiBcImdlbmVyYWxcIiB8IFwiZXhwZXJ0XCIgfCBcImJlZ2lubmVyXCIge1xuICAgIGNvbnN0IGxldmVsTWFwID0ge1xuICAgICAgJ0ExJzogJ2JlZ2lubmVyJyBhcyBjb25zdCxcbiAgICAgICdBMic6ICdiZWdpbm5lcicgYXMgY29uc3QsXG4gICAgICAnQjEnOiAnZ2VuZXJhbCcgYXMgY29uc3QsXG4gICAgICAnQjInOiAnZ2VuZXJhbCcgYXMgY29uc3QsXG4gICAgICAnQzEnOiAnZXhwZXJ0JyBhcyBjb25zdCxcbiAgICB9XG4gICAgcmV0dXJuIGxldmVsTWFwW2NlZnJMZXZlbF0gfHwgJ2dlbmVyYWwnXG4gIH1cblxuICAvLyBFbmhhbmNlZCBmYWxsYmFjayBsZXNzb24gZ2VuZXJhdGlvbiB3aXRoIGNvbnRleHRcbiAgcHJpdmF0ZSBnZW5lcmF0ZUVuaGFuY2VkRmFsbGJhY2tMZXNzb24ocGFyYW1zOiBMZXNzb25HZW5lcmF0aW9uUGFyYW1zKTogR2VuZXJhdGVkTGVzc29uIHtcbiAgICBjb25zdCB7XG4gICAgICBzb3VyY2VUZXh0LFxuICAgICAgbGVzc29uVHlwZSxcbiAgICAgIHN0dWRlbnRMZXZlbCxcbiAgICAgIHRhcmdldExhbmd1YWdlLFxuICAgICAgY29udGVudE1ldGFkYXRhLFxuICAgICAgc3RydWN0dXJlZENvbnRlbnRcbiAgICB9ID0gcGFyYW1zXG5cbiAgICBjb25zb2xlLmxvZyhcIvCflIQgR2VuZXJhdGluZyBlbmhhbmNlZCBmYWxsYmFjayBsZXNzb24gd2l0aCBjb250ZXh0dWFsIHdhcm0tdXAuLi5cIilcblxuICAgIC8vIFVzZSBhdmFpbGFibGUgY29udGV4dCBldmVuIGluIGZhbGxiYWNrXG4gICAgY29uc3QgdG9waWNzID0gc3RydWN0dXJlZENvbnRlbnQ/LmhlYWRpbmdzPy5tYXAoaCA9PiBoLnRleHQpLnNsaWNlKDAsIDMpIHx8IFtdXG4gICAgY29uc3QgY29udGVudFR5cGUgPSBjb250ZW50TWV0YWRhdGE/LmNvbnRlbnRUeXBlIHx8ICdnZW5lcmFsJ1xuXG4gICAgLy8gQ3JlYXRlIG1vY2sgY29udGVudCBhbmFseXNpcyBmb3IgZmFsbGJhY2sgd2FybS11cCBnZW5lcmF0aW9uXG4gICAgY29uc3QgbW9ja0NvbnRlbnRBbmFseXNpcyA9IHtcbiAgICAgIHRvcGljczogdG9waWNzLFxuICAgICAgY29udGVudFR5cGU6IGNvbnRlbnRUeXBlLFxuICAgICAgc291cmNlQ291bnRyeTogdGhpcy5kZXRlcm1pbmVTb3VyY2VDb3VudHJ5KGNvbnRlbnRNZXRhZGF0YT8uZG9tYWluIHx8ICcnKSxcbiAgICAgIGN1bHR1cmFsQ29udGV4dDogdGhpcy5kZXRlcm1pbmVDdWx0dXJhbENvbnRleHQoY29udGVudE1ldGFkYXRhPy5kb21haW4gfHwgJycsIHNvdXJjZVRleHQpXG4gICAgfVxuXG4gICAgLy8gR2VuZXJhdGUgY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9ucyBldmVuIGluIGZhbGxiYWNrXG4gICAgY29uc3QgY29udGV4dHVhbFdhcm11cCA9IHRoaXMuZ2V0Q29udGV4dHVhbFdhcm11cEZhbGxiYWNrKHN0dWRlbnRMZXZlbCwgbW9ja0NvbnRlbnRBbmFseXNpcywgY29udGVudE1ldGFkYXRhKVxuXG4gICAgY29uc29sZS5sb2coXCLwn5SlIEdlbmVyYXRlZCBmYWxsYmFjayBjb250ZXh0dWFsIHdhcm0tdXA6XCIsIGNvbnRleHR1YWxXYXJtdXApXG5cbiAgICByZXR1cm4ge1xuICAgICAgbGVzc29uVHlwZSxcbiAgICAgIHN0dWRlbnRMZXZlbCxcbiAgICAgIHRhcmdldExhbmd1YWdlLFxuICAgICAgc2VjdGlvbnM6IHtcbiAgICAgICAgd2FybXVwOiBjb250ZXh0dWFsV2FybXVwLFxuICAgICAgICB2b2NhYnVsYXJ5OiB0aGlzLmV4dHJhY3RDb250ZXh0dWFsVm9jYWJ1bGFyeShzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwsIHRvcGljcyksXG4gICAgICAgIHJlYWRpbmc6IHRoaXMuc2ltcGxpZnlUZXh0KHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbCksXG4gICAgICAgIGNvbXByZWhlbnNpb246IHRoaXMuZ2V0Q29udGV4dHVhbENvbXByZWhlbnNpb24obGVzc29uVHlwZSwgc3R1ZGVudExldmVsLCB0b3BpY3MpLFxuICAgICAgICBkaXNjdXNzaW9uOiB0aGlzLmdldENvbnRleHR1YWxEaXNjdXNzaW9uKGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCwgdG9waWNzKSxcbiAgICAgICAgZ3JhbW1hcjogdGhpcy5nZXRUZW1wbGF0ZUdyYW1tYXIoc3R1ZGVudExldmVsKSxcbiAgICAgICAgcHJvbnVuY2lhdGlvbjogdGhpcy5nZXRUZW1wbGF0ZVByb251bmNpYXRpb24oc291cmNlVGV4dCksXG4gICAgICAgIHdyYXB1cDogdGhpcy5nZXRDb250ZXh0dWFsV3JhcHVwKGxlc3NvblR5cGUsIHRvcGljcyksXG4gICAgICB9LFxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q29udGV4dHVhbFdhcm11cChsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nLCB0b3BpY3M6IHN0cmluZ1tdLCBjb250ZW50VHlwZTogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIC8vIFVzZSB0aGUgc2FtZSBjb250ZXh0dWFsIGZhbGxiYWNrIGxvZ2ljXG4gICAgY29uc3QgbW9ja0FuYWx5c2lzID0ge1xuICAgICAgdG9waWNzOiB0b3BpY3MsXG4gICAgICBjb250ZW50VHlwZTogY29udGVudFR5cGUsXG4gICAgICBzb3VyY2VDb3VudHJ5OiAnSW50ZXJuYXRpb25hbCdcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5nZXRDb250ZXh0dWFsV2FybXVwRmFsbGJhY2soc3R1ZGVudExldmVsLCBtb2NrQW5hbHlzaXMsIHsgdGl0bGU6IHRvcGljc1swXSB8fCAnQ29udGVudCcgfSlcbiAgfVxuXG4gIC8vIEJhc2ljIGZhbGxiYWNrIGZvciBjb21wbGV0ZSBmYWlsdXJlc1xuICBwcml2YXRlIGdlbmVyYXRlQmFzaWNGYWxsYmFja0xlc3NvbihwYXJhbXM6IExlc3NvbkdlbmVyYXRpb25QYXJhbXMpOiBHZW5lcmF0ZWRMZXNzb24ge1xuICAgIGNvbnN0IHsgc291cmNlVGV4dCwgbGVzc29uVHlwZSwgc3R1ZGVudExldmVsLCB0YXJnZXRMYW5ndWFnZSB9ID0gcGFyYW1zXG5cbiAgICByZXR1cm4ge1xuICAgICAgbGVzc29uVHlwZSxcbiAgICAgIHN0dWRlbnRMZXZlbCxcbiAgICAgIHRhcmdldExhbmd1YWdlLFxuICAgICAgc2VjdGlvbnM6IHtcbiAgICAgICAgd2FybXVwOiBbXCJXaGF0IGRvIHlvdSBhbHJlYWR5IGtub3cgYWJvdXQgdGhpcyB0b3BpYz9cIiwgXCJIYXZlIHlvdSBoYWQgc2ltaWxhciBleHBlcmllbmNlcz9cIiwgXCJXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGxlYXJuP1wiXSxcbiAgICAgICAgdm9jYWJ1bGFyeTogW10sXG4gICAgICAgIHJlYWRpbmc6IHNvdXJjZVRleHQuc3Vic3RyaW5nKDAsIDQwMCksXG4gICAgICAgIGNvbXByZWhlbnNpb246IFtcIldoYXQgaXMgdGhlIG1haW4gaWRlYT9cIiwgXCJXaGF0IGRldGFpbHMgY2FuIHlvdSBpZGVudGlmeT9cIl0sXG4gICAgICAgIGRpc2N1c3Npb246IFtcIldoYXQgaXMgeW91ciBvcGluaW9uP1wiLCBcIkhvdyB3b3VsZCB5b3UgaGFuZGxlIHRoaXM/XCJdLFxuICAgICAgICBncmFtbWFyOiB0aGlzLmdldFRlbXBsYXRlR3JhbW1hcihzdHVkZW50TGV2ZWwpLFxuICAgICAgICBwcm9udW5jaWF0aW9uOiB7IHdvcmQ6IFwiZXhhbXBsZVwiLCBpcGE6IFwiL8mqyaHLiHrDpm1wyZlsL1wiLCBwcmFjdGljZTogXCJQcmFjdGljZSBzYXlpbmcgZXhhbXBsZS5cIiB9LFxuICAgICAgICB3cmFwdXA6IFtcIldoYXQgZGlkIHlvdSBsZWFybj9cIiwgXCJXaGF0IG5lZWRzIG1vcmUgcHJhY3RpY2U/XCJdXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBleHRyYWN0Q29udGV4dHVhbFZvY2FidWxhcnkodGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZywgdG9waWNzOiBzdHJpbmdbXSkge1xuICAgIGNvbnN0IHZvY2FidWxhcnkgPSB0aGlzLmV4dHJhY3RWb2NhYnVsYXJ5KHRleHQsIHN0dWRlbnRMZXZlbClcblxuICAgIC8vIEVuaGFuY2Ugd2l0aCB0b3BpYyBjb250ZXh0IGlmIGF2YWlsYWJsZVxuICAgIGlmICh0b3BpY3MubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIHZvY2FidWxhcnkubWFwKCh2b2NhYiwgaW5kZXgpID0+ICh7XG4gICAgICAgIC4uLnZvY2FiLFxuICAgICAgICBjb250ZXh0OiBpbmRleCA8IHRvcGljcy5sZW5ndGggPyBgUmVsYXRlZCB0byAke3RvcGljc1tpbmRleF0udG9Mb3dlckNhc2UoKX1gIDogdm9jYWIubWVhbmluZyxcbiAgICAgIH0pKVxuICAgIH1cblxuICAgIHJldHVybiB2b2NhYnVsYXJ5XG4gIH1cblxuICBwcml2YXRlIGdldENvbnRleHR1YWxDb21wcmVoZW5zaW9uKGxlc3NvblR5cGU6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcsIHRvcGljczogc3RyaW5nW10pOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgYmFzZVF1ZXN0aW9ucyA9IHRoaXMuZ2V0VGVtcGxhdGVDb21wcmVoZW5zaW9uKGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbClcblxuICAgIGlmICh0b3BpY3MubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIFtcbiAgICAgICAgYFdoYXQgaXMgdGhlIG1haW4gcG9pbnQgYWJvdXQgJHt0b3BpY3NbMF0/LnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBIb3cgZG9lcyB0aGUgdGV4dCBleHBsYWluICR7dG9waWNzWzFdPy50b0xvd2VyQ2FzZSgpIHx8ICd0aGUgdG9waWMnfT9gLFxuICAgICAgICBcIldoYXQgc3VwcG9ydGluZyBkZXRhaWxzIGNhbiB5b3UgaWRlbnRpZnk/XCIsXG4gICAgICAgIFwiV2hhdCBjb25jbHVzaW9ucyBjYW4geW91IGRyYXcgZnJvbSB0aGlzIGluZm9ybWF0aW9uP1wiLFxuICAgICAgXVxuICAgIH1cblxuICAgIHJldHVybiBiYXNlUXVlc3Rpb25zXG4gIH1cblxuICBwcml2YXRlIGdldENvbnRleHR1YWxEaXNjdXNzaW9uKGxlc3NvblR5cGU6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcsIHRvcGljczogc3RyaW5nW10pOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgYmFzZVF1ZXN0aW9ucyA9IHRoaXMuZ2V0VGVtcGxhdGVEaXNjdXNzaW9uKGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbClcblxuICAgIGlmICh0b3BpY3MubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIFtcbiAgICAgICAgYFdoYXQgaXMgeW91ciBvcGluaW9uIGFib3V0ICR7dG9waWNzWzBdPy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IHdvdWxkIHlvdSBhcHBseSB0aGlzIGluZm9ybWF0aW9uIGFib3V0ICR7dG9waWNzWzFdPy50b0xvd2VyQ2FzZSgpIHx8ICd0aGlzIHRvcGljJ30/YCxcbiAgICAgICAgYFdoYXQgYXJlIHRoZSBpbXBsaWNhdGlvbnMgb2Ygd2hhdCB5b3UgbGVhcm5lZCBhYm91dCAke3RvcGljc1swXT8udG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgIF1cbiAgICB9XG5cbiAgICByZXR1cm4gYmFzZVF1ZXN0aW9uc1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRDb250ZXh0dWFsV3JhcHVwKGxlc3NvblR5cGU6IHN0cmluZywgdG9waWNzOiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcbiAgICBpZiAodG9waWNzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBbXG4gICAgICAgIGBXaGF0IG5ldyB2b2NhYnVsYXJ5IGRpZCB5b3UgbGVhcm4gYWJvdXQgJHt0b3BpY3NbMF0/LnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBXaGljaCBjb25jZXB0cyBhYm91dCAke3RvcGljc1sxXT8udG9Mb3dlckNhc2UoKSB8fCAndGhpcyB0b3BpYyd9IG5lZWQgbW9yZSBwcmFjdGljZT9gLFxuICAgICAgICBcIkhvdyB3aWxsIHlvdSB1c2UgdGhpcyBrbm93bGVkZ2UgaW4gcmVhbCBzaXR1YXRpb25zP1wiLFxuICAgICAgICBcIldoYXQgcXVlc3Rpb25zIGRvIHlvdSBzdGlsbCBoYXZlIGFib3V0IHRoaXMgY29udGVudD9cIixcbiAgICAgIF1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5nZXRUZW1wbGF0ZVdyYXB1cChsZXNzb25UeXBlKVxuICB9XG5cbiAgLy8gU21hcnQgdGVtcGxhdGUtYmFzZWQgbGVzc29uIGdlbmVyYXRpb25cbiAgcHJpdmF0ZSBnZW5lcmF0ZVNtYXJ0VGVtcGxhdGVMZXNzb24oXG4gICAgc291cmNlVGV4dDogc3RyaW5nLFxuICAgIGNvbnRlbnRBbmFseXNpczogYW55LFxuICAgIGxlc3NvblR5cGU6IHN0cmluZyxcbiAgICBzdHVkZW50TGV2ZWw6IHN0cmluZyxcbiAgICB0YXJnZXRMYW5ndWFnZTogc3RyaW5nLFxuICAgIG1ldGFkYXRhPzogYW55XG4gICkge1xuICAgIGNvbnNvbGUubG9nKFwi8J+OqCBHZW5lcmF0aW5nIHNtYXJ0IHRlbXBsYXRlIGxlc3Nvbi4uLlwiKVxuXG4gICAgY29uc3QgdG9waWNzID0gY29udGVudEFuYWx5c2lzLnRvcGljc1xuICAgIGNvbnN0IHZvY2FidWxhcnkgPSBjb250ZW50QW5hbHlzaXMua2V5Vm9jYWJ1bGFyeVxuICAgIGNvbnN0IHRpdGxlID0gbWV0YWRhdGE/LnRpdGxlIHx8ICdDb250ZW50J1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHdhcm11cDogdGhpcy5nZW5lcmF0ZVNtYXJ0V2FybXVwUXVlc3Rpb25zKHRvcGljcywgc3R1ZGVudExldmVsLCBjb250ZW50QW5hbHlzaXMpLFxuICAgICAgdm9jYWJ1bGFyeTogdGhpcy5nZW5lcmF0ZVNtYXJ0Vm9jYWJ1bGFyeSh2b2NhYnVsYXJ5LCBzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpLFxuICAgICAgcmVhZGluZzogdGhpcy5nZW5lcmF0ZVNtYXJ0UmVhZGluZyhzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpLFxuICAgICAgY29tcHJlaGVuc2lvbjogdGhpcy5nZW5lcmF0ZVNtYXJ0Q29tcHJlaGVuc2lvbih0b3BpY3MsIHN0dWRlbnRMZXZlbCksXG4gICAgICBkaXNjdXNzaW9uOiB0aGlzLmdlbmVyYXRlU21hcnREaXNjdXNzaW9uKHRvcGljcywgbGVzc29uVHlwZSwgc3R1ZGVudExldmVsKSxcbiAgICAgIGdyYW1tYXI6IHRoaXMuZ2VuZXJhdGVTbWFydEdyYW1tYXIoc3R1ZGVudExldmVsLCBzb3VyY2VUZXh0KSxcbiAgICAgIHByb251bmNpYXRpb246IHRoaXMuZ2VuZXJhdGVTbWFydFByb251bmNpYXRpb24odm9jYWJ1bGFyeSksXG4gICAgICB3cmFwdXA6IHRoaXMuZ2VuZXJhdGVTbWFydFdyYXB1cCh0b3BpY3MsIHN0dWRlbnRMZXZlbClcbiAgICB9XG4gIH1cblxuICAvLyBTbWFydCB3YXJtLXVwIHF1ZXN0aW9ucyBiYXNlZCBvbiBjb250ZW50IChwcmlvciBrbm93bGVkZ2UgYWN0aXZhdGlvbilcbiAgcHJpdmF0ZSBnZW5lcmF0ZVNtYXJ0V2FybXVwUXVlc3Rpb25zKHRvcGljczogc3RyaW5nW10sIHN0dWRlbnRMZXZlbDogc3RyaW5nLCBjb250ZW50QW5hbHlzaXM6IGFueSk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCB0b3BpYyA9IHRvcGljc1swXSB8fCAndGhpcyB0b3BpYydcbiAgICBjb25zdCBzZWNvbmRUb3BpYyA9IHRvcGljc1sxXSB8fCAndGVjaG5vbG9neSdcblxuICAgIC8vIEZvY3VzIG9uIGFjdGl2YXRpbmcgcHJpb3Iga25vd2xlZGdlLCBub3QgYXNzdW1pbmcgY29udGVudCBrbm93bGVkZ2VcbiAgICBjb25zdCBsZXZlbFF1ZXN0aW9ucyA9IHtcbiAgICAgICdBMSc6IFtcbiAgICAgICAgYERvIHlvdSBrbm93IGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYElzICR7dG9waWMudG9Mb3dlckNhc2UoKX0gcG9wdWxhciBpbiB5b3VyIGNvdW50cnk/YCxcbiAgICAgICAgYERvIHlvdSBsaWtlICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YFxuICAgICAgXSxcbiAgICAgICdBMic6IFtcbiAgICAgICAgYEhhdmUgeW91IGhlYXJkIGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0gYmVmb3JlP2AsXG4gICAgICAgIGBXaGF0IGRvIHlvdSBhbHJlYWR5IGtub3cgYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSXMgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBjb21tb24gaW4geW91ciBjb3VudHJ5P2BcbiAgICAgIF0sXG4gICAgICAnQjEnOiBbXG4gICAgICAgIGBXaGF0IGNvbWVzIHRvIG1pbmQgd2hlbiB5b3UgaGVhciBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBIYXZlIHlvdSBoYWQgYW55IGV4cGVyaWVuY2Ugd2l0aCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGtub3cgYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gXG4gICAgICBdLFxuICAgICAgJ0IyJzogW1xuICAgICAgICBgV2hhdCBpcyB5b3VyIGdlbmVyYWwgb3BpbmlvbiBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBIb3cgZmFtaWxpYXIgYXJlIHlvdSB3aXRoICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYFdoYXQgcm9sZSBkb2VzICR7dG9waWMudG9Mb3dlckNhc2UoKX0gcGxheSBpbiB5b3VyIGRhaWx5IGxpZmU/YFxuICAgICAgXSxcbiAgICAgICdDMSc6IFtcbiAgICAgICAgYEhvdyB3b3VsZCB5b3UgZGVzY3JpYmUgdGhlIHNpZ25pZmljYW5jZSBvZiAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGluIG1vZGVybiBzb2NpZXR5P2AsXG4gICAgICAgIGBXaGF0IGFyZSB5b3VyIHRob3VnaHRzIG9uIHRoZSBjdXJyZW50IHN0YXRlIG9mICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYEhvdyBkbyB5b3UgdGhpbmsgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBoYXMgZXZvbHZlZCBvdmVyIHRpbWU/YFxuICAgICAgXVxuICAgIH1cblxuICAgIHJldHVybiBsZXZlbFF1ZXN0aW9uc1tzdHVkZW50TGV2ZWxdIHx8IGxldmVsUXVlc3Rpb25zWydCMSddXG4gIH1cblxuICAvLyBTbWFydCB2b2NhYnVsYXJ5IHdpdGggY29udGV4dHVhbCBleGFtcGxlc1xuICBwcml2YXRlIGdlbmVyYXRlU21hcnRWb2NhYnVsYXJ5KHZvY2FidWxhcnk6IHN0cmluZ1tdLCBzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHZvY2FidWxhcnkuc2xpY2UoMCwgNikubWFwKHdvcmQgPT4ge1xuICAgICAgLy8gRmluZCB0aGUgd29yZCBpbiBjb250ZXh0XG4gICAgICBjb25zdCBzZW50ZW5jZXMgPSBzb3VyY2VUZXh0LnNwbGl0KC9bLiE/XSsvKVxuICAgICAgY29uc3QgY29udGV4dFNlbnRlbmNlID0gc2VudGVuY2VzLmZpbmQocyA9PiBzLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMod29yZC50b0xvd2VyQ2FzZSgpKSlcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgd29yZDogd29yZCxcbiAgICAgICAgbWVhbmluZzogdGhpcy5nZW5lcmF0ZVdvcmRNZWFuaW5nKHdvcmQsIHN0dWRlbnRMZXZlbCksXG4gICAgICAgIGV4YW1wbGU6IGNvbnRleHRTZW50ZW5jZSA/XG4gICAgICAgICAgY29udGV4dFNlbnRlbmNlLnRyaW0oKS5zdWJzdHJpbmcoMCwgMTAwKSArIChjb250ZXh0U2VudGVuY2UubGVuZ3RoID4gMTAwID8gJy4uLicgOiAnJykgOlxuICAgICAgICAgIGBUaGlzIGlzIGFuIGV4YW1wbGUgc2VudGVuY2Ugd2l0aCAke3dvcmR9LmBcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgLy8gR2VuZXJhdGUgd29yZCBtZWFuaW5ncyBiYXNlZCBvbiBsZXZlbFxuICBwcml2YXRlIGdlbmVyYXRlV29yZE1lYW5pbmcod29yZDogc3RyaW5nLCBsZXZlbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyBTaW1wbGUgZGVmaW5pdGlvbnMgYmFzZWQgb24gbGV2ZWxcbiAgICBjb25zdCBjb21tb25NZWFuaW5ncyA9IHtcbiAgICAgICdlZmZpY2llbnQnOiBsZXZlbCA9PT0gJ0ExJyB8fCBsZXZlbCA9PT0gJ0EyJyA/ICd3b3JraW5nIHdlbGwgYW5kIGZhc3QnIDogJ2FjaGlldmluZyBtYXhpbXVtIHByb2R1Y3Rpdml0eSB3aXRoIG1pbmltdW0gd2FzdGVkIGVmZm9ydCcsXG4gICAgICAndGVjaG5vbG9neSc6IGxldmVsID09PSAnQTEnIHx8IGxldmVsID09PSAnQTInID8gJ2NvbXB1dGVycyBhbmQgbWFjaGluZXMnIDogJ3RoZSBhcHBsaWNhdGlvbiBvZiBzY2llbnRpZmljIGtub3dsZWRnZSBmb3IgcHJhY3RpY2FsIHB1cnBvc2VzJyxcbiAgICAgICdwcml2YWN5JzogbGV2ZWwgPT09ICdBMScgfHwgbGV2ZWwgPT09ICdBMicgPyAna2VlcGluZyB0aGluZ3Mgc2VjcmV0JyA6ICd0aGUgc3RhdGUgb2YgYmVpbmcgZnJlZSBmcm9tIHB1YmxpYyBhdHRlbnRpb24nLFxuICAgICAgJ2RldmljZSc6IGxldmVsID09PSAnQTEnIHx8IGxldmVsID09PSAnQTInID8gJ2EgbWFjaGluZSBvciB0b29sJyA6ICdhIHBpZWNlIG9mIGVxdWlwbWVudCBkZXNpZ25lZCBmb3IgYSBwYXJ0aWN1bGFyIHB1cnBvc2UnLFxuICAgICAgJ3Byb2Nlc3NpbmcnOiBsZXZlbCA9PT0gJ0ExJyB8fCBsZXZlbCA9PT0gJ0EyJyA/ICd3b3JraW5nIHdpdGggaW5mb3JtYXRpb24nIDogJ3BlcmZvcm1pbmcgb3BlcmF0aW9ucyBvbiBkYXRhJyxcbiAgICAgICdjb21wYWN0JzogbGV2ZWwgPT09ICdBMScgfHwgbGV2ZWwgPT09ICdBMicgPyAnc21hbGwgYW5kIG5lYXQnIDogJ2Nsb3NlbHkgYW5kIG5lYXRseSBwYWNrZWQgdG9nZXRoZXInLFxuICAgICAgJ3ZlcnNpb24nOiBsZXZlbCA9PT0gJ0ExJyB8fCBsZXZlbCA9PT0gJ0EyJyA/ICdhIHR5cGUgb2Ygc29tZXRoaW5nJyA6ICdhIHBhcnRpY3VsYXIgZm9ybSBvZiBzb21ldGhpbmcnLFxuICAgICAgJ2ZhbWlseSc6IGxldmVsID09PSAnQTEnIHx8IGxldmVsID09PSAnQTInID8gJ2EgZ3JvdXAgb2YgcmVsYXRlZCB0aGluZ3MnIDogJ2EgZ3JvdXAgb2YgcmVsYXRlZCBvYmplY3RzIG9yIGNvbmNlcHRzJyxcbiAgICAgICduYW5vJzogbGV2ZWwgPT09ICdBMScgfHwgbGV2ZWwgPT09ICdBMicgPyAndmVyeSBzbWFsbCcgOiAnZXh0cmVtZWx5IHNtYWxsIGluIHNjYWxlJyxcbiAgICAgICdnZW1pbmknOiBsZXZlbCA9PT0gJ0ExJyB8fCBsZXZlbCA9PT0gJ0EyJyA/ICdhIHR5cGUgb2YgQUknIDogJ2FuIGFydGlmaWNpYWwgaW50ZWxsaWdlbmNlIHN5c3RlbSBkZXZlbG9wZWQgYnkgR29vZ2xlJ1xuICAgIH1cblxuICAgIHJldHVybiBjb21tb25NZWFuaW5nc1t3b3JkLnRvTG93ZXJDYXNlKCldIHx8IGBBIHdvcmQgbWVhbmluZyAke3dvcmQudG9Mb3dlckNhc2UoKX1gXG4gIH1cblxuICAvLyBTbWFydCByZWFkaW5nIHBhc3NhZ2UgYWRhcHRhdGlvblxuICBwcml2YXRlIGdlbmVyYXRlU21hcnRSZWFkaW5nKHNvdXJjZVRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IG1heExlbmd0aCA9IHtcbiAgICAgICdBMSc6IDIwMCxcbiAgICAgICdBMic6IDMwMCxcbiAgICAgICdCMSc6IDQwMCxcbiAgICAgICdCMic6IDUwMCxcbiAgICAgICdDMSc6IDYwMFxuICAgIH1cblxuICAgIGNvbnN0IHRhcmdldExlbmd0aCA9IG1heExlbmd0aFtzdHVkZW50TGV2ZWxdIHx8IDQwMFxuXG4gICAgLy8gU2ltcGxpZnkgc2VudGVuY2VzIGZvciBsb3dlciBsZXZlbHNcbiAgICBpZiAoc3R1ZGVudExldmVsID09PSAnQTEnIHx8IHN0dWRlbnRMZXZlbCA9PT0gJ0EyJykge1xuICAgICAgY29uc3Qgc2VudGVuY2VzID0gc291cmNlVGV4dC5zcGxpdCgvWy4hP10rLylcbiAgICAgIGNvbnN0IHNpbXBsaWZpZWRTZW50ZW5jZXMgPSBzZW50ZW5jZXNcbiAgICAgICAgLmZpbHRlcihzID0+IHMudHJpbSgpLmxlbmd0aCA+IDEwKVxuICAgICAgICAubWFwKHMgPT4gcy50cmltKCkpXG4gICAgICAgIC5zbGljZSgwLCA4KSAvLyBMaW1pdCBudW1iZXIgb2Ygc2VudGVuY2VzXG5cbiAgICAgIHJldHVybiBzaW1wbGlmaWVkU2VudGVuY2VzLmpvaW4oJy4gJykuc3Vic3RyaW5nKDAsIHRhcmdldExlbmd0aClcbiAgICB9XG5cbiAgICByZXR1cm4gc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgdGFyZ2V0TGVuZ3RoKVxuICB9XG5cbiAgLy8gU21hcnQgY29tcHJlaGVuc2lvbiBxdWVzdGlvbnNcbiAgcHJpdmF0ZSBnZW5lcmF0ZVNtYXJ0Q29tcHJlaGVuc2lvbih0b3BpY3M6IHN0cmluZ1tdLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCB0b3BpYyA9IHRvcGljc1swXSB8fCAndGhlIGNvbnRlbnQnXG5cbiAgICBjb25zdCBsZXZlbFF1ZXN0aW9ucyA9IHtcbiAgICAgICdBMSc6IFtcbiAgICAgICAgYFdoYXQgaXMgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBcIldoYXQgaXMgdGhlIG1haW4gaWRlYT9cIixcbiAgICAgICAgXCJJcyB0aGlzIGluZm9ybWF0aW9uIG5ldyB0byB5b3U/XCJcbiAgICAgIF0sXG4gICAgICAnQTInOiBbXG4gICAgICAgIGBXaGF0IGRvZXMgdGhlIHRleHQgc2F5IGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgXCJXaGF0IGFyZSB0aGUgbWFpbiBwb2ludHM/XCIsXG4gICAgICAgIFwiRG8geW91IGFncmVlIHdpdGggdGhlIGluZm9ybWF0aW9uP1wiXG4gICAgICBdLFxuICAgICAgJ0IxJzogW1xuICAgICAgICBgSG93IGRvZXMgdGhlIHRleHQgZXhwbGFpbiAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIFwiV2hhdCBzdXBwb3J0aW5nIGRldGFpbHMgYXJlIHByb3ZpZGVkP1wiLFxuICAgICAgICBcIldoYXQgY29uY2x1c2lvbnMgY2FuIHlvdSBkcmF3P1wiLFxuICAgICAgICBcIkhvdyBkb2VzIHRoaXMgcmVsYXRlIHRvIHlvdXIgZXhwZXJpZW5jZT9cIlxuICAgICAgXSxcbiAgICAgICdCMic6IFtcbiAgICAgICAgYFdoYXQgaXMgdGhlIGF1dGhvcidzIHBlcnNwZWN0aXZlIG9uICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgXCJXaGF0IGV2aWRlbmNlIHN1cHBvcnRzIHRoZSBtYWluIGFyZ3VtZW50cz9cIixcbiAgICAgICAgXCJXaGF0IGFyZSB0aGUgaW1wbGljYXRpb25zIG9mIHRoaXMgaW5mb3JtYXRpb24/XCIsXG4gICAgICAgIFwiSG93IG1pZ2h0IHRoaXMgYWZmZWN0IGRpZmZlcmVudCBncm91cHMgb2YgcGVvcGxlP1wiXG4gICAgICBdLFxuICAgICAgJ0MxJzogW1xuICAgICAgICBgSG93IGRvZXMgdGhlIGF1dGhvcidzIHRyZWF0bWVudCBvZiAke3RvcGljLnRvTG93ZXJDYXNlKCl9IHJlZmxlY3QgYnJvYWRlciB0aGVtZXM/YCxcbiAgICAgICAgXCJXaGF0IHVuZGVybHlpbmcgYXNzdW1wdGlvbnMgY2FuIHlvdSBpZGVudGlmeT9cIixcbiAgICAgICAgXCJIb3cgbWlnaHQgdGhpcyBpbmZvcm1hdGlvbiBiZSBpbnRlcnByZXRlZCBkaWZmZXJlbnRseSBpbiB2YXJpb3VzIGNvbnRleHRzP1wiLFxuICAgICAgICBcIldoYXQgYXJlIHRoZSBwb3RlbnRpYWwgbG9uZy10ZXJtIGNvbnNlcXVlbmNlcyBkaXNjdXNzZWQ/XCJcbiAgICAgIF1cbiAgICB9XG5cbiAgICByZXR1cm4gbGV2ZWxRdWVzdGlvbnNbc3R1ZGVudExldmVsXSB8fCBsZXZlbFF1ZXN0aW9uc1snQjEnXVxuICB9XG5cbiAgLy8gU21hcnQgZGlzY3Vzc2lvbiBxdWVzdGlvbnNcbiAgcHJpdmF0ZSBnZW5lcmF0ZVNtYXJ0RGlzY3Vzc2lvbih0b3BpY3M6IHN0cmluZ1tdLCBsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHRvcGljID0gdG9waWNzWzBdIHx8ICd0aGlzIHRvcGljJ1xuICAgIGNvbnN0IHNlY29uZFRvcGljID0gdG9waWNzWzFdIHx8ICd0ZWNobm9sb2d5J1xuXG4gICAgY29uc3QgbGV2ZWxRdWVzdGlvbnMgPSB7XG4gICAgICAnQTEnOiBbXG4gICAgICAgIGBEbyB5b3UgbGlrZSAke3RvcGljLnRvTG93ZXJDYXNlKCl9PyBXaHk/YCxcbiAgICAgICAgYElzICR7dG9waWMudG9Mb3dlckNhc2UoKX0gZ29vZCBvciBiYWQ/YCxcbiAgICAgICAgYFdvdWxkIHlvdSByZWNvbW1lbmQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSB0byBmcmllbmRzP2BcbiAgICAgIF0sXG4gICAgICAnQTInOiBbXG4gICAgICAgIGBXaGF0IGlzIHlvdXIgb3BpbmlvbiBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBIb3cgZG8geW91IHVzZSAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGluIHlvdXIgbGlmZT9gLFxuICAgICAgICBgV2hhdCBwcm9ibGVtcyBjYW4gJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBjYXVzZT9gXG4gICAgICBdLFxuICAgICAgJ0IxJzogW1xuICAgICAgICBgV2hhdCBhcmUgdGhlIGFkdmFudGFnZXMgYW5kIGRpc2FkdmFudGFnZXMgb2YgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IGhhcyAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGNoYW5nZWQgb3ZlciB0aW1lP2AsXG4gICAgICAgIGBXaGF0IHdvdWxkIGhhcHBlbiBpZiAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGRpZG4ndCBleGlzdD9gXG4gICAgICBdLFxuICAgICAgJ0IyJzogW1xuICAgICAgICBgSG93IG1pZ2h0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0gaW1wYWN0IHNvY2lldHkgaW4gdGhlIG5leHQgZGVjYWRlP2AsXG4gICAgICAgIGBXaGF0IGV0aGljYWwgY29uc2lkZXJhdGlvbnMgc3Vycm91bmQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IGRvZXMgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBkaWZmZXIgYWNyb3NzIGN1bHR1cmVzP2BcbiAgICAgIF0sXG4gICAgICAnQzEnOiBbXG4gICAgICAgIGBXaGF0IGFyZSB0aGUgYnJvYWRlciBzb2NpZXRhbCBpbXBsaWNhdGlvbnMgb2YgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IG1pZ2h0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0gcmVzaGFwZSBvdXIgdW5kZXJzdGFuZGluZyBvZiAke3NlY29uZFRvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBXaGF0IHJvbGUgc2hvdWxkIHJlZ3VsYXRpb24gcGxheSBpbiAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2BcbiAgICAgIF1cbiAgICB9XG5cbiAgICByZXR1cm4gbGV2ZWxRdWVzdGlvbnNbc3R1ZGVudExldmVsXSB8fCBsZXZlbFF1ZXN0aW9uc1snQjEnXVxuICB9XG5cbiAgLy8gU21hcnQgZ3JhbW1hciBmb2N1c1xuICBwcml2YXRlIGdlbmVyYXRlU21hcnRHcmFtbWFyKHN0dWRlbnRMZXZlbDogc3RyaW5nLCBzb3VyY2VUZXh0OiBzdHJpbmcpIHtcbiAgICBjb25zdCBncmFtbWFyRm9jdXMgPSB7XG4gICAgICAnQTEnOiB7XG4gICAgICAgIGZvY3VzOiAnUHJlc2VudCBTaW1wbGUnLFxuICAgICAgICBleGFtcGxlczogWydJdCBpcyBlZmZpY2llbnQuJywgJ1RoaXMgd29ya3Mgd2VsbC4nLCAnUGVvcGxlIHVzZSB0ZWNobm9sb2d5LiddLFxuICAgICAgICBleGVyY2lzZTogWydJdCBfX19fXyAoYmUpIHZlcnkgdXNlZnVsLicsICdUZWNobm9sb2d5IF9fX19fIChoZWxwKSBwZW9wbGUuJywgJ1RoaXMgX19fX18gKHdvcmspIG9uIHBob25lcy4nXVxuICAgICAgfSxcbiAgICAgICdBMic6IHtcbiAgICAgICAgZm9jdXM6ICdQcmVzZW50IENvbnRpbnVvdXMgYW5kIFNpbXBsZScsXG4gICAgICAgIGV4YW1wbGVzOiBbJ0l0IGlzIHdvcmtpbmcgb24geW91ciBkZXZpY2UuJywgJ1Blb3BsZSBhcmUgdXNpbmcgdGhpcyB0ZWNobm9sb2d5LicsICdJdCBoZWxwcyB3aXRoIHByaXZhY3kuJ10sXG4gICAgICAgIGV4ZXJjaXNlOiBbJ0l0IF9fX19fICh3b3JrKSByaWdodCBub3cuJywgJ1Blb3BsZSBfX19fXyAodXNlKSBpdCBldmVyeSBkYXkuJywgJ1RoaXMgX19fX18gKGhlbHApIHdpdGggc2VjdXJpdHkuJ11cbiAgICAgIH0sXG4gICAgICAnQjEnOiB7XG4gICAgICAgIGZvY3VzOiAnUHJlc2VudCBQZXJmZWN0JyxcbiAgICAgICAgZXhhbXBsZXM6IFsnVGVjaG5vbG9neSBoYXMgaW1wcm92ZWQgc2lnbmlmaWNhbnRseS4nLCAnSXQgaGFzIGJlY29tZSBtb3JlIGVmZmljaWVudC4nLCAnVXNlcnMgaGF2ZSBleHBlcmllbmNlZCBiZXR0ZXIgcHJpdmFjeS4nXSxcbiAgICAgICAgZXhlcmNpc2U6IFsnVGVjaG5vbG9neSBfX19fXyAoaW1wcm92ZSkgYSBsb3QuJywgJ0l0IF9fX19fIChiZWNvbWUpIHZlcnkgcG9wdWxhci4nLCAnUGVvcGxlIF9fX19fIChzdGFydCkgdXNpbmcgaXQgbW9yZS4nXVxuICAgICAgfSxcbiAgICAgICdCMic6IHtcbiAgICAgICAgZm9jdXM6ICdQYXNzaXZlIFZvaWNlJyxcbiAgICAgICAgZXhhbXBsZXM6IFsnSXQgaXMgZGVzaWduZWQgZm9yIG1vYmlsZSBkZXZpY2VzLicsICdQcml2YWN5IGlzIGVuaGFuY2VkIGJ5IHRoaXMgdGVjaG5vbG9neS4nLCAnRGF0YSBpcyBwcm9jZXNzZWQgbG9jYWxseS4nXSxcbiAgICAgICAgZXhlcmNpc2U6IFsnSXQgX19fX18gKGRlc2lnbikgZm9yIHBob25lcy4nLCAnUHJpdmFjeSBfX19fXyAoaW1wcm92ZSkgc2lnbmlmaWNhbnRseS4nLCAnSW5mb3JtYXRpb24gX19fX18gKHByb2Nlc3MpIHNhZmVseS4nXVxuICAgICAgfSxcbiAgICAgICdDMSc6IHtcbiAgICAgICAgZm9jdXM6ICdDb21wbGV4IFNlbnRlbmNlIFN0cnVjdHVyZXMnLFxuICAgICAgICBleGFtcGxlczogWydIYXZpbmcgYmVlbiBkZXNpZ25lZCBmb3IgZWZmaWNpZW5jeSwgaXQgb3BlcmF0ZXMgc2VhbWxlc3NseS4nLCAnVGhlIHRlY2hub2xvZ3ksIHdoaWNoIHByaW9yaXRpemVzIHByaXZhY3ksIGhhcyBnYWluZWQgcG9wdWxhcml0eS4nXSxcbiAgICAgICAgZXhlcmNpc2U6IFsnX19fX18gKGRlc2lnbikgZm9yIG1vYmlsZSB1c2UsIGl0IHdvcmtzIG9mZmxpbmUuJywgJ1RoZSBzeXN0ZW0sIF9fX19fIChmb2N1cykgb24gcHJpdmFjeSwgYXBwZWFscyB0byB1c2Vycy4nXVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBncmFtbWFyRm9jdXNbc3R1ZGVudExldmVsXSB8fCBncmFtbWFyRm9jdXNbJ0IxJ11cbiAgfVxuXG4gIC8vIFNtYXJ0IHByb251bmNpYXRpb25cbiAgcHJpdmF0ZSBnZW5lcmF0ZVNtYXJ0UHJvbnVuY2lhdGlvbih2b2NhYnVsYXJ5OiBzdHJpbmdbXSkge1xuICAgIGNvbnN0IHdvcmQgPSB2b2NhYnVsYXJ5LmZpbmQodyA9PiB3Lmxlbmd0aCA+IDYpIHx8IHZvY2FidWxhcnlbMF0gfHwgJ3RlY2hub2xvZ3knXG5cbiAgICBjb25zdCBwcm9udW5jaWF0aW9ucyA9IHtcbiAgICAgICd0ZWNobm9sb2d5JzogJy90ZWvLiG7JkmzJmWTKkmkvJyxcbiAgICAgICdlZmZpY2llbnQnOiAnL8mqy4hmyarKg8mZbnQvJyxcbiAgICAgICdwcml2YWN5JzogJy/LiHByYcmqdsmZc2kvJyxcbiAgICAgICdwcm9jZXNzaW5nJzogJy/LiHByyZnKinNlc8mqxYsvJyxcbiAgICAgICdkZXZpY2UnOiAnL2TJqsuIdmHJqnMvJyxcbiAgICAgICdhcnRpZmljaWFsJzogJy/LjMmRy5B0yarLiGbJqsqDyZlsLycsXG4gICAgICAnaW50ZWxsaWdlbmNlJzogJy/Jqm7LiHRlbMmqZMqSyZlucy8nLFxuICAgICAgJ2NvbXBhY3QnOiAnL2vJmW3LiHDDpmt0LycsXG4gICAgICAndmVyc2lvbic6ICcvy4h2yZzLkMqDyZluLycsXG4gICAgICAnZmFtaWx5JzogJy/LiGbDpm3JmWxpLycsXG4gICAgICAnbmFubyc6ICcvy4huw6Zub8qKLycsXG4gICAgICAnZ2VtaW5pJzogJy/LiGTKkmVtyapuYcmqLydcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgd29yZDogd29yZCxcbiAgICAgIGlwYTogcHJvbnVuY2lhdGlvbnNbd29yZC50b0xvd2VyQ2FzZSgpXSB8fCBgL8uId8mcy5ByZC9gLFxuICAgICAgcHJhY3RpY2U6IGBQcmFjdGljZSBzYXlpbmcgXCIke3dvcmR9XCIgaW4gdGhpcyBzZW50ZW5jZTogVGhpcyAke3dvcmR9IGlzIHZlcnkgdXNlZnVsLmBcbiAgICB9XG4gIH1cblxuICAvLyBTbWFydCB3cmFwLXVwIHF1ZXN0aW9uc1xuICBwcml2YXRlIGdlbmVyYXRlU21hcnRXcmFwdXAodG9waWNzOiBzdHJpbmdbXSwgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgdG9waWMgPSB0b3BpY3NbMF0gfHwgJ3RoaXMgdG9waWMnXG5cbiAgICByZXR1cm4gW1xuICAgICAgYFdoYXQgbmV3IHZvY2FidWxhcnkgZGlkIHlvdSBsZWFybiBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICBgV2hpY2ggY29uY2VwdHMgYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBuZWVkIG1vcmUgcHJhY3RpY2U/YCxcbiAgICAgIFwiSG93IHdpbGwgeW91IHVzZSB0aGlzIGtub3dsZWRnZSBpbiByZWFsIHNpdHVhdGlvbnM/XCIsXG4gICAgICBcIldoYXQgcXVlc3Rpb25zIGRvIHlvdSBzdGlsbCBoYXZlIGFib3V0IHRoaXMgY29udGVudD9cIlxuICAgIF1cbiAgfVxuXG4gIC8vIEhlbHBlciBtZXRob2QgdG8gZGV0ZXJtaW5lIHNvdXJjZSBjb3VudHJ5IGZyb20gZG9tYWluXG4gIHByaXZhdGUgZGV0ZXJtaW5lU291cmNlQ291bnRyeShkb21haW46IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgY291bnRyeU1hcCA9IHtcbiAgICAgICdiYmMuY29tJzogJ1VuaXRlZCBLaW5nZG9tJyxcbiAgICAgICdiYmMuY28udWsnOiAnVW5pdGVkIEtpbmdkb20nLFxuICAgICAgJ2Nubi5jb20nOiAnVW5pdGVkIFN0YXRlcycsXG4gICAgICAnbnl0aW1lcy5jb20nOiAnVW5pdGVkIFN0YXRlcycsXG4gICAgICAndGhlZ3VhcmRpYW4uY29tJzogJ1VuaXRlZCBLaW5nZG9tJyxcbiAgICAgICd3YXNoaW5ndG9ucG9zdC5jb20nOiAnVW5pdGVkIFN0YXRlcycsXG4gICAgICAncmV1dGVycy5jb20nOiAnSW50ZXJuYXRpb25hbCcsXG4gICAgICAnYXAub3JnJzogJ1VuaXRlZCBTdGF0ZXMnLFxuICAgICAgJ25wci5vcmcnOiAnVW5pdGVkIFN0YXRlcycsXG4gICAgICAnYWJjLm5ldC5hdSc6ICdBdXN0cmFsaWEnLFxuICAgICAgJ2NiYy5jYSc6ICdDYW5hZGEnLFxuICAgIH1cblxuICAgIGZvciAoY29uc3QgW2RvbWFpbktleSwgY291bnRyeV0gb2YgT2JqZWN0LmVudHJpZXMoY291bnRyeU1hcCkpIHtcbiAgICAgIGlmIChkb21haW4uaW5jbHVkZXMoZG9tYWluS2V5KSkge1xuICAgICAgICByZXR1cm4gY291bnRyeVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAnSW50ZXJuYXRpb25hbCdcbiAgfVxuXG4gIC8vIEZhbGxiYWNrIHdhcm0tdXAgcXVlc3Rpb24gZ2VuZXJhdG9yXG4gIHByaXZhdGUgZ2V0RmFsbGJhY2tXYXJtdXBRdWVzdGlvbihsZXZlbDogc3RyaW5nLCBjb250ZW50QW5hbHlzaXM6IGFueSwgcXVlc3Rpb25JbmRleDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCB0b3BpYyA9IGNvbnRlbnRBbmFseXNpcy50b3BpY3NbMF0gfHwgJ3RoaXMgdG9waWMnXG4gICAgY29uc3QgY29udGVudFR5cGUgPSBjb250ZW50QW5hbHlzaXMuY29udGVudFR5cGVcblxuICAgIGNvbnN0IGZhbGxiYWNrUXVlc3Rpb25zID0ge1xuICAgICAgJ0ExJzogW1xuICAgICAgICBgRG8geW91IGtub3cgYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSXMgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBpbXBvcnRhbnQgaW4geW91ciBjb3VudHJ5P2AsXG4gICAgICAgIGBEbyB5b3UgbGlrZSB0byByZWFkIGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YFxuICAgICAgXSxcbiAgICAgICdBMic6IFtcbiAgICAgICAgYEhhdmUgeW91IGhlYXJkIGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0gYmVmb3JlP2AsXG4gICAgICAgIGBXaGF0IGRvIHlvdSBrbm93IGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYElzICR7dG9waWMudG9Mb3dlckNhc2UoKX0gZGlmZmVyZW50IGluIHlvdXIgY291bnRyeT9gXG4gICAgICBdLFxuICAgICAgJ0IxJzogW1xuICAgICAgICBgV2hhdCBkbyB5b3UgdGhpbmsgYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IGlzICR7dG9waWMudG9Mb3dlckNhc2UoKX0gaW1wb3J0YW50IGluIHlvdXIgZGFpbHkgbGlmZT9gLFxuICAgICAgICBgV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBrbm93IGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YFxuICAgICAgXSxcbiAgICAgICdCMic6IFtcbiAgICAgICAgYFdoYXQgYXJlIHlvdXIgdGhvdWdodHMgb24gJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IG1pZ2h0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0gYWZmZWN0IHBlb3BsZSBpbiBkaWZmZXJlbnQgY291bnRyaWVzP2AsXG4gICAgICAgIGBXaGF0IHF1ZXN0aW9ucyB3b3VsZCB5b3UgYXNrIGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YFxuICAgICAgXSxcbiAgICAgICdDMSc6IFtcbiAgICAgICAgYEhvdyBkbyBjdWx0dXJhbCBwZXJzcGVjdGl2ZXMgaW5mbHVlbmNlIGF0dGl0dWRlcyB0b3dhcmQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgV2hhdCBhcmUgdGhlIGJyb2FkZXIgaW1wbGljYXRpb25zIG9mICR7dG9waWMudG9Mb3dlckNhc2UoKX0gaW4gbW9kZXJuIHNvY2lldHk/YCxcbiAgICAgICAgYEhvdyBtaWdodCAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGV2b2x2ZSBpbiB0aGUgY29taW5nIHllYXJzP2BcbiAgICAgIF1cbiAgICB9XG5cbiAgICBjb25zdCBsZXZlbFF1ZXN0aW9ucyA9IGZhbGxiYWNrUXVlc3Rpb25zW2xldmVsXSB8fCBmYWxsYmFja1F1ZXN0aW9uc1snQjEnXVxuICAgIHJldHVybiBsZXZlbFF1ZXN0aW9uc1txdWVzdGlvbkluZGV4XSB8fCBsZXZlbFF1ZXN0aW9uc1swXVxuICB9XG5cbiAgLy8gQ29udGV4dHVhbCB3YXJtLXVwIGZhbGxiYWNrIHdoZW4gQUkgZmFpbHNcbiAgcHJpdmF0ZSBnZXRDb250ZXh0dWFsV2FybXVwRmFsbGJhY2sobGV2ZWw6IHN0cmluZywgY29udGVudEFuYWx5c2lzOiBhbnksIG1ldGFkYXRhPzogYW55KTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHRvcGljID0gY29udGVudEFuYWx5c2lzLnRvcGljc1swXSB8fCAndGhpcyB0b3BpYydcbiAgICBjb25zdCBzb3VyY2VDb3VudHJ5ID0gY29udGVudEFuYWx5c2lzLnNvdXJjZUNvdW50cnkgfHwgJ3RoaXMgY291bnRyeSdcbiAgICBjb25zdCB0aXRsZSA9IG1ldGFkYXRhPy50aXRsZSB8fCAndGhpcyBjb250ZW50J1xuXG4gICAgY29uc3QgZmFsbGJhY2tTZXRzID0ge1xuICAgICAgJ0ExJzogW1xuICAgICAgICBgRG8geW91IGtub3cgYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSXMgdGhpcyB0b3BpYyBjb21tb24gaW4geW91ciBjb3VudHJ5P2AsXG4gICAgICAgIGBEbyB5b3Ugd2FudCB0byBsZWFybiBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2BcbiAgICAgIF0sXG4gICAgICAnQTInOiBbXG4gICAgICAgIGBIYXZlIHlvdSBleHBlcmllbmNlZCAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGJlZm9yZT9gLFxuICAgICAgICBgV2hhdCBpcyAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGxpa2UgaW4geW91ciBjb3VudHJ5P2AsXG4gICAgICAgIGBXaHkgaXMgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBpbnRlcmVzdGluZyB0byB5b3U/YFxuICAgICAgXSxcbiAgICAgICdCMSc6IFtcbiAgICAgICAgYFdoYXQgZG8geW91IHRoaW5rIGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYEhvdyBpcyAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGRpZmZlcmVudCBpbiB5b3VyIGNvdW50cnkgY29tcGFyZWQgdG8gJHtzb3VyY2VDb3VudHJ5fT9gLFxuICAgICAgICBgV2hhdCB3b3VsZCB5b3UgZXhwZWN0IHRvIGxlYXJuIGZyb20gdGhpcyAke2NvbnRlbnRBbmFseXNpcy5jb250ZW50VHlwZX0/YFxuICAgICAgXSxcbiAgICAgICdCMic6IFtcbiAgICAgICAgYFdoYXQgYXJlIHlvdXIgdGhvdWdodHMgb24gaG93ICR7dG9waWMudG9Mb3dlckNhc2UoKX0gaXMgcHJlc2VudGVkIGluICR7c291cmNlQ291bnRyeX0gbWVkaWE/YCxcbiAgICAgICAgYFdoYXQgY2hhbGxlbmdlcyBkbyB5b3UgdGhpbmsgcGVvcGxlIGZhY2Ugd2l0aCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBIb3cgbWlnaHQgeW91ciBwZXJzcGVjdGl2ZSBvbiAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGRpZmZlciBmcm9tIHRoZSBhdXRob3Incz9gXG4gICAgICBdLFxuICAgICAgJ0MxJzogW1xuICAgICAgICBgSG93IGRvIGN1bHR1cmFsIGF0dGl0dWRlcyB0b3dhcmQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSB2YXJ5IGJldHdlZW4gJHtzb3VyY2VDb3VudHJ5fSBhbmQgeW91ciBjb3VudHJ5P2AsXG4gICAgICAgIGBXaGF0IGFyZSB0aGUgYnJvYWRlciBzb2NpZXRhbCBpbXBsaWNhdGlvbnMgb2YgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IG1pZ2h0IHRoZSBwZXJzcGVjdGl2ZSBpbiB0aGlzICR7Y29udGVudEFuYWx5c2lzLmNvbnRlbnRUeXBlfSByZWZsZWN0ICR7c291cmNlQ291bnRyeX0gdmFsdWVzP2BcbiAgICAgIF1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsbGJhY2tTZXRzW2xldmVsXSB8fCBmYWxsYmFja1NldHNbJ0IxJ11cbiAgfVxufVxuXG5leHBvcnQgY29uc3QgbGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3IgPSBuZXcgTGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3IoKVxuIl0sIm5hbWVzIjpbImNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZSIsIkxlc3NvbkFJU2VydmVyR2VuZXJhdG9yIiwiZ2V0R29vZ2xlQUkiLCJnb29nbGVBSSIsImdlbmVyYXRlTGVzc29uIiwicGFyYW1zIiwic291cmNlVGV4dCIsImxlc3NvblR5cGUiLCJzdHVkZW50TGV2ZWwiLCJ0YXJnZXRMYW5ndWFnZSIsInNvdXJjZVVybCIsImNvbnRlbnRNZXRhZGF0YSIsInN0cnVjdHVyZWRDb250ZW50Iiwid29yZENvdW50IiwicmVhZGluZ1RpbWUiLCJjb25zb2xlIiwibG9nIiwidGV4dExlbmd0aCIsImxlbmd0aCIsImhhc01ldGFkYXRhIiwiaGFzU3RydWN0dXJlZENvbnRlbnQiLCJsZXNzb25TdHJ1Y3R1cmUiLCJnZW5lcmF0ZU1pbmltYWxBSUxlc3NvbiIsIk9iamVjdCIsImtleXMiLCJmaW5hbExlc3NvbiIsInNlY3Rpb25zIiwic2VjdGlvbnNDb3VudCIsIndhcm11cENvdW50Iiwid2FybXVwIiwidm9jYWJ1bGFyeUNvdW50Iiwidm9jYWJ1bGFyeSIsImVycm9yIiwiZ2VuZXJhdGVTbWFydFRlbXBsYXRlRmFsbGJhY2siLCJtZXRhZGF0YSIsIndhcm11cFF1ZXN0aW9ucyIsImdlbmVyYXRlTWluaW1hbFdhcm11cCIsImdlbmVyYXRlTWluaW1hbFZvY2FidWxhcnkiLCJjb21wcmVoZW5zaW9uUXVlc3Rpb25zIiwiZ2VuZXJhdGVNaW5pbWFsQ29tcHJlaGVuc2lvbiIsInJlYWRpbmciLCJnZW5lcmF0ZVNtYXJ0UmVhZGluZyIsImNvbXByZWhlbnNpb24iLCJkaXNjdXNzaW9uIiwiZ2VuZXJhdGVTbWFydERpc2N1c3Npb24iLCJleHRyYWN0QmV0dGVyVG9waWNzIiwiZ3JhbW1hciIsImdlbmVyYXRlU21hcnRHcmFtbWFyIiwicHJvbnVuY2lhdGlvbiIsImdlbmVyYXRlU21hcnRQcm9udW5jaWF0aW9uIiwibWFwIiwidiIsIndvcmQiLCJ3cmFwdXAiLCJnZW5lcmF0ZVNtYXJ0V3JhcHVwIiwidG9waWNzIiwibWFpblRvcGljIiwicHJvbXB0IiwicmVzcG9uc2UiLCJxdWVzdGlvbnMiLCJzcGxpdCIsImxpbmUiLCJ0cmltIiwiZmlsdGVyIiwiZW5kc1dpdGgiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwicmVwbGFjZSIsInNsaWNlIiwiZ2VuZXJhdGVTbWFydFdhcm11cFF1ZXN0aW9ucyIsInRleHQiLCJjb21wb3VuZFBhdHRlcm5zIiwicGF0dGVybiIsIm1hdGNoZXMiLCJtYXRjaCIsInB1c2giLCJtIiwid29yZHMiLCJjb21tb25Xb3JkcyIsImZvdW5kV29yZHMiLCJ1bmlxdWVXb3JkcyIsIkFycmF5IiwiZnJvbSIsIlNldCIsIm1lYW5pbmciLCJzZW50ZW5jZXMiLCJleGFtcGxlIiwiZmluZCIsInMiLCJzdWJzdHJpbmciLCJnZW5lcmF0ZVdvcmRNZWFuaW5nIiwic2hvcnRUZXh0IiwiZ2VuZXJhdGVTbWFydENvbXByZWhlbnNpb24iLCJleHRyYWN0VG9waWNzRnJvbVRleHQiLCJleHRyYWN0Vm9jYWJ1bGFyeUZyb21UZXh0IiwiZ2VuZXJhdGVTbWFydFZvY2FidWxhcnkiLCJhbmFseXplQ29udGVudENvbnRleHROb0FJIiwiYW5hbHlzaXMiLCJjb250ZW50VHlwZSIsImRvbWFpbiIsImNvbXBsZXhpdHkiLCJrZXlWb2NhYnVsYXJ5IiwiY3VsdHVyYWxDb250ZXh0IiwibGVhcm5pbmdPYmplY3RpdmVzIiwiZGlmZmljdWx0eSIsInRpdGxlIiwic291cmNlQ291bnRyeSIsImRldGVybWluZVNvdXJjZUNvdW50cnkiLCJhdmdTZW50ZW5jZUxlbmd0aCIsInJlZHVjZSIsInN1bSIsImNvbXBsZXhXb3JkcyIsInRvdGFsV29yZHMiLCJoZWFkaW5ncyIsImRldGVybWluZUN1bHR1cmFsQ29udGV4dCIsImdlbmVyYXRlTGVhcm5pbmdPYmplY3RpdmVzIiwiYW5hbHl6ZUNvbnRlbnRDb250ZXh0IiwiY3JlYXRlQ29udGV4dHVhbFN1bW1hcnkiLCJjb250ZW50QW5hbHlzaXMiLCJzdW1tYXJ5UHJvbXB0Iiwic3VtbWFyeSIsInRlbXBlcmF0dXJlIiwibWF4VG9rZW5zIiwid2FybiIsIm1lc3NhZ2UiLCJ0cnVuY2F0ZWQiLCJnZW5lcmF0ZUNvbnRleHR1YWxXYXJtdXBRdWVzdGlvbnMiLCJjb250ZW50IiwibGV2ZWxJbnN0cnVjdGlvbnMiLCJ0b3BpYyIsIndhcm11cFByb21wdCIsInBhcnNlTGlzdEZyb21UZXh0IiwiZmFsbGJhY2tRdWVzdGlvbiIsImdldEZhbGxiYWNrV2FybXVwUXVlc3Rpb24iLCJmYWxsYmFja1F1ZXN0aW9ucyIsImdldENvbnRleHR1YWxXYXJtdXBGYWxsYmFjayIsImdlbmVyYXRlQ29udGV4dHVhbExlc3NvblN0cnVjdHVyZSIsImNvbnRleHR1YWxXYXJtdXAiLCJqb2luIiwidm9jYWIiLCJKU09OIiwic3RyaW5naWZ5IiwicGFyc2VkIiwicGFyc2UiLCJwYXJzZUVycm9yIiwianNvbk1hdGNoIiwiY2xlYW5lZCIsImNsZWFuRXJyb3IiLCJmYWxsYmFjayIsImNyZWF0ZVN0cnVjdHVyZWRGYWxsYmFjayIsImdlbmVyYXRlRGV0YWlsZWRDb250ZXh0dWFsQ29udGVudCIsInN0cnVjdHVyZSIsImkiLCJjb250ZXh0dWFsRXhhbXBsZVByb21wdCIsImVuaGFuY2VkRXhhbXBsZSIsIndyaXRlIiwidG9uZSIsImNvbnRleHR1YWxNZWFuaW5nUHJvbXB0IiwiY29udGV4dHVhbE1lYW5pbmciLCJlbmhhbmNlZERpc2N1c3Npb25Qcm9tcHQiLCJlbmhhbmNlZERpc2N1c3Npb24iLCJmb3JtYXQiLCJzdHJ1Y3R1cmVkUmVhZGluZ1Byb21wdCIsImgiLCJlbmhhbmNlZFJlYWRpbmciLCJyZXdyaXRlIiwiYXVkaWVuY2UiLCJnZXRBdWRpZW5jZUxldmVsIiwiZm9jdXMiLCJncmFtbWFyRXhhbXBsZXNQcm9tcHQiLCJjb250ZXh0dWFsR3JhbW1hckV4YW1wbGVzIiwiY29udGV4dHVhbEV4YW1wbGVzIiwicHJvb2ZyZWFkTGVzc29uIiwibGVzc29uIiwic2VjdGlvbnNUb1Byb29mcmVhZCIsInNlY3Rpb25QYXRoIiwidmFsdWUiLCJnZXROZXN0ZWRWYWx1ZSIsInByb29mcmVhZCIsImNoZWNrR3JhbW1hciIsImNoZWNrU3BlbGxpbmciLCJjaGVja1N0eWxlIiwic2V0TmVzdGVkVmFsdWUiLCJjb3JyZWN0ZWRfdGV4dCIsImdlbmVyYXRlRmFsbGJhY2tMZXNzb24iLCJnZXRUZW1wbGF0ZVdhcm11cCIsImV4dHJhY3RWb2NhYnVsYXJ5Iiwic2ltcGxpZnlUZXh0IiwiZ2V0VGVtcGxhdGVDb21wcmVoZW5zaW9uIiwiZ2V0VGVtcGxhdGVEaXNjdXNzaW9uIiwiZ2V0VGVtcGxhdGVHcmFtbWFyIiwiZ2V0VGVtcGxhdGVQcm9udW5jaWF0aW9uIiwiZ2V0VGVtcGxhdGVXcmFwdXAiLCJnZXRTdW1tYXJ5TGVuZ3RoIiwibGV2ZWwiLCJsZW5ndGhNYXAiLCJBMSIsIkEyIiwiQjEiLCJCMiIsIkMxIiwiZ2V0TGFuZ3VhZ2VDb2RlIiwibGFuZ3VhZ2UiLCJsYW5ndWFnZU1hcCIsInNwYW5pc2giLCJmcmVuY2giLCJnZXJtYW4iLCJpdGFsaWFuIiwicG9ydHVndWVzZSIsImphcGFuZXNlIiwia29yZWFuIiwiY2hpbmVzZSIsIm9iaiIsInBhdGgiLCJjdXJyZW50Iiwia2V5IiwibGFzdEtleSIsInBvcCIsInRhcmdldCIsInRlbXBsYXRlcyIsInRyYXZlbCIsImJ1c2luZXNzIiwic2VsZWN0ZWRXb3JkcyIsIm1heExlbmd0aCIsImxpbWl0IiwiZ3JhbW1hckZvY2kiLCJleGFtcGxlcyIsImV4ZXJjaXNlIiwic2VsZWN0ZWRXb3JkIiwiaXBhIiwicHJhY3RpY2UiLCJleHRyYWN0VG9waWNzRnJvbUhlYWRpbmdzIiwiaGVhZGluZ1RvcGljcyIsInRvcGljUGF0dGVybnMiLCJzZW50ZW5jZSIsImtleVdvcmRzIiwiaW5kZXgiLCJhcnIiLCJpbmRleE9mIiwiY29tcGxleGl0eVRocmVzaG9sZCIsImN1bHR1cmFsSW5kaWNhdG9ycyIsImFtZXJpY2FuTWFya2VycyIsImJyaXRpc2hNYXJrZXJzIiwiYW1lcmljYW5Db3VudCIsIm1hcmtlciIsImJyaXRpc2hDb3VudCIsIm9iamVjdGl2ZXMiLCJmb3JFYWNoIiwiY2VmckxldmVsIiwibGV2ZWxNYXAiLCJnZW5lcmF0ZUVuaGFuY2VkRmFsbGJhY2tMZXNzb24iLCJtb2NrQ29udGVudEFuYWx5c2lzIiwiZXh0cmFjdENvbnRleHR1YWxWb2NhYnVsYXJ5IiwiZ2V0Q29udGV4dHVhbENvbXByZWhlbnNpb24iLCJnZXRDb250ZXh0dWFsRGlzY3Vzc2lvbiIsImdldENvbnRleHR1YWxXcmFwdXAiLCJnZXRDb250ZXh0dWFsV2FybXVwIiwibW9ja0FuYWx5c2lzIiwiZ2VuZXJhdGVCYXNpY0ZhbGxiYWNrTGVzc29uIiwiY29udGV4dCIsImJhc2VRdWVzdGlvbnMiLCJnZW5lcmF0ZVNtYXJ0VGVtcGxhdGVMZXNzb24iLCJzZWNvbmRUb3BpYyIsImxldmVsUXVlc3Rpb25zIiwiY29udGV4dFNlbnRlbmNlIiwiY29tbW9uTWVhbmluZ3MiLCJ0YXJnZXRMZW5ndGgiLCJzaW1wbGlmaWVkU2VudGVuY2VzIiwiZ3JhbW1hckZvY3VzIiwidyIsInByb251bmNpYXRpb25zIiwiY291bnRyeU1hcCIsImRvbWFpbktleSIsImNvdW50cnkiLCJlbnRyaWVzIiwicXVlc3Rpb25JbmRleCIsImZhbGxiYWNrU2V0cyIsImxlc3NvbkFJU2VydmVyR2VuZXJhdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/lesson-ai-generator-server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase-server.ts":
/*!********************************!*\
  !*** ./lib/supabase-server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createServerSupabaseClient: () => (/* binding */ createServerSupabaseClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n\n\nconst createServerSupabaseClient = ()=>{\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createServerClient)(\"https://jbkpnirowdvlwlgheqho.supabase.co\" || 0, \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impia3BuaXJvd2R2bHdsZ2hlcWhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5MTQ3NTEsImV4cCI6MjA3NDQ5MDc1MX0.FZhruXKDzIkZLhla5oerfs7yzjvTsGLlKTUer34N6N0\" || 0, {\n        cookies: {\n            get (name) {\n                return cookieStore.get(name)?.value;\n            },\n            set (name, value, options) {\n                cookieStore.set({\n                    name,\n                    value,\n                    ...options\n                });\n            },\n            remove (name, options) {\n                cookieStore.set({\n                    name,\n                    value: \"\",\n                    ...options\n                });\n            }\n        }\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Utc2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFrRDtBQUNaO0FBRS9CLE1BQU1FLDZCQUE2QjtJQUN4QyxNQUFNQyxjQUFjRixxREFBT0E7SUFFM0IsT0FBT0QsaUVBQWtCQSxDQUN2QkksMENBQW9DLElBQUksR0FDeENBLGtOQUF5QyxJQUFJLEdBQzdDO1FBQ0FILFNBQVM7WUFDUE8sS0FBSUMsSUFBWTtnQkFDZCxPQUFPTixZQUFZSyxHQUFHLENBQUNDLE9BQU9DO1lBQ2hDO1lBQ0FDLEtBQUlGLElBQVksRUFBRUMsS0FBYSxFQUFFRSxPQUFZO2dCQUMzQ1QsWUFBWVEsR0FBRyxDQUFDO29CQUFFRjtvQkFBTUM7b0JBQU8sR0FBR0UsT0FBTztnQkFBQztZQUM1QztZQUNBQyxRQUFPSixJQUFZLEVBQUVHLE9BQVk7Z0JBQy9CVCxZQUFZUSxHQUFHLENBQUM7b0JBQUVGO29CQUFNQyxPQUFPO29CQUFJLEdBQUdFLE9BQU87Z0JBQUM7WUFDaEQ7UUFDRjtJQUNGO0FBQ0YsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvLi9saWIvc3VwYWJhc2Utc2VydmVyLnRzPzA5NGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50IH0gZnJvbSBcIkBzdXBhYmFzZS9zc3JcIlxuaW1wb3J0IHsgY29va2llcyB9IGZyb20gXCJuZXh0L2hlYWRlcnNcIlxuXG5leHBvcnQgY29uc3QgY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQgPSAoKSA9PiB7XG4gIGNvbnN0IGNvb2tpZVN0b3JlID0gY29va2llcygpXG5cbiAgcmV0dXJuIGNyZWF0ZVNlcnZlckNsaWVudChcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgfHwgJ2h0dHBzOi8vcGxhY2Vob2xkZXIuc3VwYWJhc2UuY28nLCBcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSB8fCAncGxhY2Vob2xkZXIta2V5JywgXG4gICAge1xuICAgIGNvb2tpZXM6IHtcbiAgICAgIGdldChuYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIGNvb2tpZVN0b3JlLmdldChuYW1lKT8udmFsdWVcbiAgICAgIH0sXG4gICAgICBzZXQobmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBvcHRpb25zOiBhbnkpIHtcbiAgICAgICAgY29va2llU3RvcmUuc2V0KHsgbmFtZSwgdmFsdWUsIC4uLm9wdGlvbnMgfSlcbiAgICAgIH0sXG4gICAgICByZW1vdmUobmFtZTogc3RyaW5nLCBvcHRpb25zOiBhbnkpIHtcbiAgICAgICAgY29va2llU3RvcmUuc2V0KHsgbmFtZSwgdmFsdWU6IFwiXCIsIC4uLm9wdGlvbnMgfSlcbiAgICAgIH0sXG4gICAgfSxcbiAgfSlcbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVTZXJ2ZXJDbGllbnQiLCJjb29raWVzIiwiY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQiLCJjb29raWVTdG9yZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImdldCIsIm5hbWUiLCJ2YWx1ZSIsInNldCIsIm9wdGlvbnMiLCJyZW1vdmUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase-server.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/next","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/cookie","vendor-chunks/webidl-conversions"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson%2Froute&page=%2Fapi%2Fgenerate-lesson%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();
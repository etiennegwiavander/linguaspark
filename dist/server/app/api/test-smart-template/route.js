"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/test-smart-template/route";
exports.ids = ["app/api/test-smart-template/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftest-smart-template%2Froute&page=%2Fapi%2Ftest-smart-template%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftest-smart-template%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftest-smart-template%2Froute&page=%2Fapi%2Ftest-smart-template%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftest-smart-template%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_linguaspark_app_api_test_smart_template_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/test-smart-template/route.ts */ \"(rsc)/./app/api/test-smart-template/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/test-smart-template/route\",\n        pathname: \"/api/test-smart-template\",\n        filename: \"route\",\n        bundlePath: \"app/api/test-smart-template/route\"\n    },\n    resolvedPagePath: \"D:\\\\linguaspark\\\\app\\\\api\\\\test-smart-template\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_linguaspark_app_api_test_smart_template_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/test-smart-template/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ0ZXN0LXNtYXJ0LXRlbXBsYXRlJTJGcm91dGUmcGFnZT0lMkZhcGklMkZ0ZXN0LXNtYXJ0LXRlbXBsYXRlJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGdGVzdC1zbWFydC10ZW1wbGF0ZSUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDbGluZ3Vhc3BhcmslNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUQlM0ElNUNsaW5ndWFzcGFyayZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDUTtBQUNyRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvPzI3MWEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxcbGluZ3Vhc3BhcmtcXFxcYXBwXFxcXGFwaVxcXFx0ZXN0LXNtYXJ0LXRlbXBsYXRlXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS90ZXN0LXNtYXJ0LXRlbXBsYXRlL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdGVzdC1zbWFydC10ZW1wbGF0ZVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvdGVzdC1zbWFydC10ZW1wbGF0ZS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkQ6XFxcXGxpbmd1YXNwYXJrXFxcXGFwcFxcXFxhcGlcXFxcdGVzdC1zbWFydC10ZW1wbGF0ZVxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvdGVzdC1zbWFydC10ZW1wbGF0ZS9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftest-smart-template%2Froute&page=%2Fapi%2Ftest-smart-template%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftest-smart-template%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/test-smart-template/route.ts":
/*!**********************************************!*\
  !*** ./app/api/test-smart-template/route.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_lesson_ai_generator_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/lesson-ai-generator-server */ \"(rsc)/./lib/lesson-ai-generator-server.ts\");\n\n\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { sourceText, lessonType = \"discussion\", studentLevel = \"A2\", targetLanguage = \"english\" } = body;\n        console.log(\"\\uD83E\\uDDEA Testing smart template generation...\");\n        // Generate lesson using smart template system\n        const lesson = await _lib_lesson_ai_generator_server__WEBPACK_IMPORTED_MODULE_1__.lessonAIServerGenerator.generateLesson({\n            sourceText,\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sourceUrl: \"test\",\n            contentMetadata: undefined,\n            structuredContent: undefined,\n            wordCount: sourceText.split(\" \").length,\n            readingTime: Math.ceil(sourceText.split(\" \").length / 200)\n        });\n        console.log(\"âœ… Smart template test complete!\");\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            lesson: lesson,\n            message: \"Smart template generation successful\"\n        });\n    } catch (error) {\n        console.error(\"âŒ Smart template test failed:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: error.message\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3Rlc3Qtc21hcnQtdGVtcGxhdGUvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTREO0FBQ2M7QUFFbkUsZUFBZUUsS0FBS0MsT0FBb0I7SUFDN0MsSUFBSTtRQUNGLE1BQU1DLE9BQU8sTUFBTUQsUUFBUUUsSUFBSTtRQUMvQixNQUFNLEVBQ0pDLFVBQVUsRUFDVkMsYUFBYSxZQUFZLEVBQ3pCQyxlQUFlLElBQUksRUFDbkJDLGlCQUFpQixTQUFTLEVBQzNCLEdBQUdMO1FBRUpNLFFBQVFDLEdBQUcsQ0FBQztRQUVaLDhDQUE4QztRQUM5QyxNQUFNQyxTQUFTLE1BQU1YLG9GQUF1QkEsQ0FBQ1ksY0FBYyxDQUFDO1lBQzFEUDtZQUNBQztZQUNBQztZQUNBQztZQUNBSyxXQUFXO1lBQ1hDLGlCQUFpQkM7WUFDakJDLG1CQUFtQkQ7WUFDbkJFLFdBQVdaLFdBQVdhLEtBQUssQ0FBQyxLQUFLQyxNQUFNO1lBQ3ZDQyxhQUFhQyxLQUFLQyxJQUFJLENBQUNqQixXQUFXYSxLQUFLLENBQUMsS0FBS0MsTUFBTSxHQUFHO1FBQ3hEO1FBRUFWLFFBQVFDLEdBQUcsQ0FBQztRQUVaLE9BQU9YLHFEQUFZQSxDQUFDSyxJQUFJLENBQUM7WUFDdkJtQixTQUFTO1lBQ1RaLFFBQVFBO1lBQ1JhLFNBQVM7UUFDWDtJQUNGLEVBQUUsT0FBT0MsT0FBTztRQUNkaEIsUUFBUWdCLEtBQUssQ0FBQyxpQ0FBaUNBO1FBQy9DLE9BQU8xQixxREFBWUEsQ0FBQ0ssSUFBSSxDQUFDO1lBQ3ZCbUIsU0FBUztZQUNURSxPQUFPQSxNQUFNRCxPQUFPO1FBQ3RCLEdBQUc7WUFBRUUsUUFBUTtRQUFJO0lBQ25CO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vYXBwL2FwaS90ZXN0LXNtYXJ0LXRlbXBsYXRlL3JvdXRlLnRzPzQ5NGEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdHlwZSBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCJcclxuaW1wb3J0IHsgbGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3IgfSBmcm9tIFwiQC9saWIvbGVzc29uLWFpLWdlbmVyYXRvci1zZXJ2ZXJcIlxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXHJcbiAgICBjb25zdCB7IFxyXG4gICAgICBzb3VyY2VUZXh0LCBcclxuICAgICAgbGVzc29uVHlwZSA9IFwiZGlzY3Vzc2lvblwiLCBcclxuICAgICAgc3R1ZGVudExldmVsID0gXCJBMlwiLCBcclxuICAgICAgdGFyZ2V0TGFuZ3VhZ2UgPSBcImVuZ2xpc2hcIlxyXG4gICAgfSA9IGJvZHlcclxuXHJcbiAgICBjb25zb2xlLmxvZyhcIvCfp6ogVGVzdGluZyBzbWFydCB0ZW1wbGF0ZSBnZW5lcmF0aW9uLi4uXCIpXHJcblxyXG4gICAgLy8gR2VuZXJhdGUgbGVzc29uIHVzaW5nIHNtYXJ0IHRlbXBsYXRlIHN5c3RlbVxyXG4gICAgY29uc3QgbGVzc29uID0gYXdhaXQgbGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3IuZ2VuZXJhdGVMZXNzb24oe1xyXG4gICAgICBzb3VyY2VUZXh0LFxyXG4gICAgICBsZXNzb25UeXBlLFxyXG4gICAgICBzdHVkZW50TGV2ZWwsXHJcbiAgICAgIHRhcmdldExhbmd1YWdlLFxyXG4gICAgICBzb3VyY2VVcmw6IFwidGVzdFwiLFxyXG4gICAgICBjb250ZW50TWV0YWRhdGE6IHVuZGVmaW5lZCxcclxuICAgICAgc3RydWN0dXJlZENvbnRlbnQ6IHVuZGVmaW5lZCxcclxuICAgICAgd29yZENvdW50OiBzb3VyY2VUZXh0LnNwbGl0KCcgJykubGVuZ3RoLFxyXG4gICAgICByZWFkaW5nVGltZTogTWF0aC5jZWlsKHNvdXJjZVRleHQuc3BsaXQoJyAnKS5sZW5ndGggLyAyMDApXHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnNvbGUubG9nKFwi4pyFIFNtYXJ0IHRlbXBsYXRlIHRlc3QgY29tcGxldGUhXCIpXHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgbGVzc29uOiBsZXNzb24sXHJcbiAgICAgIG1lc3NhZ2U6IFwiU21hcnQgdGVtcGxhdGUgZ2VuZXJhdGlvbiBzdWNjZXNzZnVsXCJcclxuICAgIH0pXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgU21hcnQgdGVtcGxhdGUgdGVzdCBmYWlsZWQ6XCIsIGVycm9yKVxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcclxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UgXHJcbiAgICB9LCB7IHN0YXR1czogNTAwIH0pXHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImxlc3NvbkFJU2VydmVyR2VuZXJhdG9yIiwiUE9TVCIsInJlcXVlc3QiLCJib2R5IiwianNvbiIsInNvdXJjZVRleHQiLCJsZXNzb25UeXBlIiwic3R1ZGVudExldmVsIiwidGFyZ2V0TGFuZ3VhZ2UiLCJjb25zb2xlIiwibG9nIiwibGVzc29uIiwiZ2VuZXJhdGVMZXNzb24iLCJzb3VyY2VVcmwiLCJjb250ZW50TWV0YWRhdGEiLCJ1bmRlZmluZWQiLCJzdHJ1Y3R1cmVkQ29udGVudCIsIndvcmRDb3VudCIsInNwbGl0IiwibGVuZ3RoIiwicmVhZGluZ1RpbWUiLCJNYXRoIiwiY2VpbCIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwiZXJyb3IiLCJzdGF0dXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/test-smart-template/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/google-ai-server.ts":
/*!*********************************!*\
  !*** ./lib/google-ai-server.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createGoogleAIServerService: () => (/* binding */ createGoogleAIServerService)\n/* harmony export */ });\n// Server-side Google AI (Gemini) APIs service layer\nclass GoogleAIServerService {\n    constructor(config){\n        this.model = \"models/gemini-2.5-flash\" // Use actual available model\n        ;\n        this.config = config;\n    }\n    async makeGeminiRequest(prompt, options = {}) {\n        // Use only the working model\n        const modelsToTry = [\n            \"models/gemini-2.5-flash\"\n        ];\n        const possibleUrls = [];\n        // Generate URLs for different combinations\n        for (const model of modelsToTry){\n            possibleUrls.push(`${this.config.baseUrl}/v1beta/models/${model}:generateContent?key=${this.config.apiKey}`);\n            possibleUrls.push(`${this.config.baseUrl}/v1/models/${model}:generateContent?key=${this.config.apiKey}`);\n        }\n        const requestBody = {\n            contents: [\n                {\n                    parts: [\n                        {\n                            text: prompt\n                        }\n                    ]\n                }\n            ],\n            generationConfig: {\n                temperature: options.temperature || 0.7,\n                maxOutputTokens: options.maxTokens || 2000,\n                topP: options.topP || 0.9\n            }\n        };\n        console.log(\"\\uD83D\\uDD17 Using working Gemini API endpoint...\");\n        // Use only the working endpoint\n        const url = `${this.config.baseUrl}/v1beta/models/gemini-2.5-flash:generateContent?key=${this.config.apiKey}`;\n        console.log(`ðŸŒ API URL: ${url.replace(this.config.apiKey, \"API_KEY_HIDDEN\")}`);\n        try {\n            const response = await fetch(url, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(requestBody)\n            });\n            console.log(`ðŸ“¡ Response status: ${response.status} ${response.statusText}`);\n            if (response.ok) {\n                const result = await response.json();\n                console.log(\"âœ… Successful API response received\");\n                console.log(\"\\uD83D\\uDD0D Full API response structure:\", JSON.stringify(result, null, 2));\n                // More robust response parsing with MAX_TOKENS handling\n                if (result.candidates && result.candidates.length > 0) {\n                    const candidate = result.candidates[0];\n                    // Check if we hit MAX_TOKENS limit\n                    if (candidate.finishReason === \"MAX_TOKENS\") {\n                        console.warn(\"âš ï¸ Hit MAX_TOKENS limit, response may be incomplete\");\n                        // Still try to extract partial content if available\n                        if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {\n                            const text = candidate.content.parts[0].text;\n                            console.log(\"âš ï¸ Extracted partial text due to MAX_TOKENS:\", text.substring(0, 100) + \"...\");\n                            return text;\n                        } else {\n                            console.warn(\"âŒ MAX_TOKENS hit and no content available\");\n                            throw new Error(\"API response hit token limit with no usable content\");\n                        }\n                    }\n                    // Normal response processing\n                    if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {\n                        const text = candidate.content.parts[0].text;\n                        console.log(\"âœ… Extracted text:\", text);\n                        return text;\n                    } else {\n                        console.warn(\"âš ï¸ Invalid content structure in candidate:\", candidate);\n                        throw new Error(\"Invalid content structure in API response\");\n                    }\n                } else {\n                    console.warn(\"âš ï¸ No candidates in response:\", result);\n                    throw new Error(\"No candidates in API response\");\n                }\n            } else {\n                const errorText = await response.text();\n                console.error(`âŒ API call failed:`, response.status, errorText);\n                throw new Error(`Gemini API error: ${response.status} ${response.statusText} - ${errorText}`);\n            }\n        } catch (error) {\n            console.error(`âŒ API call exception:`, error.message);\n            throw error;\n        }\n    }\n    async summarize(text, options = {}) {\n        const summaryType = options.type || \"key-points\";\n        const length = options.length || \"medium\";\n        const lengthInstructions = {\n            short: \"in 2-3 sentences\",\n            medium: \"in 4-6 sentences\",\n            long: \"in 7-10 sentences\"\n        };\n        const typeInstructions = {\n            \"key-points\": \"Extract and summarize the key points\",\n            \"tl-dr\": \"Create a TL;DR summary\",\n            \"teaser\": \"Write an engaging teaser summary\",\n            \"headline\": \"Create a headline-style summary\"\n        };\n        const prompt = `${typeInstructions[summaryType]} of the following text ${lengthInstructions[length]}:\n\n${text}\n\nSummary:`;\n        try {\n            return await this.makeGeminiRequest(prompt, {\n                temperature: 0.3\n            });\n        } catch (error) {\n            console.error(\"Summarization failed:\", error);\n            // Fallback to simple truncation\n            return text.substring(0, 500) + \"...\";\n        }\n    }\n    async translate(text, options) {\n        const targetLang = this.getLanguageName(options.targetLanguage);\n        const prompt = `Translate the following text to ${targetLang}. Maintain the original meaning and tone:\n\n${text}\n\nTranslation:`;\n        try {\n            return await this.makeGeminiRequest(prompt, {\n                temperature: 0.2\n            });\n        } catch (error) {\n            console.error(\"Translation failed:\", error);\n            // Return original text if translation fails\n            return text;\n        }\n    }\n    async prompt(prompt, options = {}) {\n        try {\n            return await this.makeGeminiRequest(prompt, options);\n        } catch (error) {\n            console.error(\"Prompt generation failed:\", error);\n            throw error;\n        }\n    }\n    async write(prompt, options = {}) {\n        const tone = options.tone || \"casual\";\n        const length = options.length || \"medium\";\n        const format = options.format || \"paragraph\";\n        const lengthInstructions = {\n            short: \"Keep it brief and concise\",\n            medium: \"Write a moderate length response\",\n            long: \"Provide a detailed and comprehensive response\"\n        };\n        const formatInstructions = {\n            paragraph: \"Write in paragraph form\",\n            \"bullet-points\": \"Format as bullet points\",\n            \"numbered-list\": \"Format as a numbered list\"\n        };\n        const enhancedPrompt = `${prompt}\n\nInstructions:\n- Tone: ${tone}\n- ${lengthInstructions[length]}\n- ${formatInstructions[format]}\n\nResponse:`;\n        try {\n            return await this.makeGeminiRequest(enhancedPrompt, {\n                temperature: 0.7\n            });\n        } catch (error) {\n            console.error(\"Writing failed:\", error);\n            throw error;\n        }\n    }\n    async rewrite(text, options = {}) {\n        const tone = options.tone || \"casual\";\n        const length = options.length || \"same\";\n        const audience = options.audience || \"general\";\n        const lengthInstructions = {\n            shorter: \"Make it more concise\",\n            longer: \"Expand and add more detail\",\n            same: \"Keep approximately the same length\"\n        };\n        const prompt = `Rewrite the following text with these requirements:\n- Tone: ${tone}\n- Audience: ${audience}\n- Length: ${lengthInstructions[length]}\n\nOriginal text:\n${text}\n\nRewritten text:`;\n        try {\n            return await this.makeGeminiRequest(prompt, {\n                temperature: 0.5\n            });\n        } catch (error) {\n            console.error(\"Rewriting failed:\", error);\n            return text // Return original if rewriting fails\n            ;\n        }\n    }\n    async proofread(text, options = {}) {\n        const checkGrammar = options.checkGrammar !== false;\n        const checkSpelling = options.checkSpelling !== false;\n        const checkStyle = options.checkStyle !== false;\n        const checks = [];\n        if (checkGrammar) checks.push(\"grammar\");\n        if (checkSpelling) checks.push(\"spelling\");\n        if (checkStyle) checks.push(\"style and clarity\");\n        const prompt = `Proofread and correct the following text for ${checks.join(\", \")}. Return only the corrected text:\n\n${text}\n\nCorrected text:`;\n        try {\n            const correctedText = await this.makeGeminiRequest(prompt, {\n                temperature: 0.2\n            });\n            return {\n                corrected_text: correctedText,\n                suggestions: [],\n                errors: []\n            };\n        } catch (error) {\n            console.error(\"Proofreading failed:\", error);\n            return {\n                corrected_text: text,\n                suggestions: [],\n                errors: []\n            };\n        }\n    }\n    getLanguageName(code) {\n        const languageMap = {\n            es: \"Spanish\",\n            fr: \"French\",\n            de: \"German\",\n            it: \"Italian\",\n            pt: \"Portuguese\",\n            ja: \"Japanese\",\n            ko: \"Korean\",\n            zh: \"Chinese\",\n            en: \"English\"\n        };\n        return languageMap[code] || \"English\";\n    }\n}\n// Server-side only initialization\nconst createGoogleAIServerService = ()=>{\n    const apiKey = \"AIzaSyAkDCpwWTPKYftoc1Fdm77P6B00Lj89Lio\";\n    const baseUrl = \"https://generativelanguage.googleapis.com\" || 0;\n    if (!apiKey) {\n        console.warn(\"Google AI API key not found. Lesson generation will use fallback templates.\");\n        // Return a service that will always throw errors, triggering fallbacks\n        return new GoogleAIServerService({\n            apiKey: \"dummy\",\n            baseUrl\n        });\n    }\n    return new GoogleAIServerService({\n        apiKey,\n        baseUrl\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O1lBQ1o7UUFDRjtJQUNGO0lBRVF0QixnQkFBZ0J1QixJQUFZLEVBQVU7UUFDNUMsTUFBTUMsY0FBYztZQUNsQkMsSUFBSTtZQUNKQyxJQUFJO1lBQ0pDLElBQUk7WUFDSkMsSUFBSTtZQUNKQyxJQUFJO1lBQ0pDLElBQUk7WUFDSkMsSUFBSTtZQUNKQyxJQUFJO1lBQ0pDLElBQUk7UUFDTjtRQUNBLE9BQU9ULFdBQVcsQ0FBQ0QsS0FBSyxJQUFJO0lBQzlCO0FBQ0Y7QUFFQSxrQ0FBa0M7QUFDM0IsTUFBTVcsOEJBQThCO0lBQ3pDLE1BQU1qRixTQUFTa0YseUNBQXlDO0lBQ3hELE1BQU1uRixVQUFVbUYsMkNBQTBDLElBQUksQ0FBMkM7SUFFekcsSUFBSSxDQUFDbEYsUUFBUTtRQUNYVSxRQUFRb0IsSUFBSSxDQUFDO1FBQ2IsdUVBQXVFO1FBQ3ZFLE9BQU8sSUFBSXpDLHNCQUFzQjtZQUFFVyxRQUFRO1lBQVNEO1FBQVE7SUFDOUQ7SUFFQSxPQUFPLElBQUlWLHNCQUFzQjtRQUFFVztRQUFRRDtJQUFRO0FBQ3JELEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL2dvb2dsZS1haS1zZXJ2ZXIudHM/NTJkNiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTZXJ2ZXItc2lkZSBHb29nbGUgQUkgKEdlbWluaSkgQVBJcyBzZXJ2aWNlIGxheWVyXG5pbnRlcmZhY2UgR29vZ2xlQUlDb25maWcge1xuICBhcGlLZXk6IHN0cmluZ1xuICBiYXNlVXJsOiBzdHJpbmdcbn1cblxuaW50ZXJmYWNlIFN1bW1hcml6ZXJPcHRpb25zIHtcbiAgdHlwZT86IFwia2V5LXBvaW50c1wiIHwgXCJ0bC1kclwiIHwgXCJ0ZWFzZXJcIiB8IFwiaGVhZGxpbmVcIlxuICBsZW5ndGg/OiBcInNob3J0XCIgfCBcIm1lZGl1bVwiIHwgXCJsb25nXCJcbiAgZm9ybWF0PzogXCJtYXJrZG93blwiIHwgXCJwbGFpbi10ZXh0XCJcbn1cblxuaW50ZXJmYWNlIFRyYW5zbGF0b3JPcHRpb25zIHtcbiAgc291cmNlTGFuZ3VhZ2U/OiBzdHJpbmdcbiAgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgUHJvbXB0T3B0aW9ucyB7XG4gIHRlbXBlcmF0dXJlPzogbnVtYmVyXG4gIG1heFRva2Vucz86IG51bWJlclxuICB0b3BQPzogbnVtYmVyXG59XG5cbmludGVyZmFjZSBXcml0ZXJPcHRpb25zIHtcbiAgdG9uZT86IFwiZm9ybWFsXCIgfCBcImNhc3VhbFwiIHwgXCJhY2FkZW1pY1wiIHwgXCJjcmVhdGl2ZVwiXG4gIGxlbmd0aD86IFwic2hvcnRcIiB8IFwibWVkaXVtXCIgfCBcImxvbmdcIlxuICBmb3JtYXQ/OiBcInBhcmFncmFwaFwiIHwgXCJidWxsZXQtcG9pbnRzXCIgfCBcIm51bWJlcmVkLWxpc3RcIlxufVxuXG5pbnRlcmZhY2UgUmV3cml0ZXJPcHRpb25zIHtcbiAgdG9uZT86IFwiZm9ybWFsXCIgfCBcImNhc3VhbFwiIHwgXCJhY2FkZW1pY1wiIHwgXCJjcmVhdGl2ZVwiXG4gIGxlbmd0aD86IFwic2hvcnRlclwiIHwgXCJsb25nZXJcIiB8IFwic2FtZVwiXG4gIGF1ZGllbmNlPzogXCJnZW5lcmFsXCIgfCBcImV4cGVydFwiIHwgXCJiZWdpbm5lclwiXG59XG5cbmludGVyZmFjZSBQcm9vZnJlYWRlck9wdGlvbnMge1xuICBjaGVja0dyYW1tYXI/OiBib29sZWFuXG4gIGNoZWNrU3BlbGxpbmc/OiBib29sZWFuXG4gIGNoZWNrU3R5bGU/OiBib29sZWFuXG4gIHN1Z2dlc3RJbXByb3ZlbWVudHM/OiBib29sZWFuXG59XG5cbmNsYXNzIEdvb2dsZUFJU2VydmVyU2VydmljZSB7XG4gIHByaXZhdGUgY29uZmlnOiBHb29nbGVBSUNvbmZpZ1xuICBwcml2YXRlIG1vZGVsOiBzdHJpbmcgPSBcIm1vZGVscy9nZW1pbmktMi41LWZsYXNoXCIgLy8gVXNlIGFjdHVhbCBhdmFpbGFibGUgbW9kZWxcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IEdvb2dsZUFJQ29uZmlnKSB7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWdcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgbWFrZUdlbWluaVJlcXVlc3QocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM6IGFueSA9IHt9KSB7XG4gICAgLy8gVXNlIG9ubHkgdGhlIHdvcmtpbmcgbW9kZWxcbiAgICBjb25zdCBtb2RlbHNUb1RyeSA9IFtcbiAgICAgICdtb2RlbHMvZ2VtaW5pLTIuNS1mbGFzaCdcbiAgICBdXG4gICAgXG4gICAgY29uc3QgcG9zc2libGVVcmxzID0gW11cbiAgICBcbiAgICAvLyBHZW5lcmF0ZSBVUkxzIGZvciBkaWZmZXJlbnQgY29tYmluYXRpb25zXG4gICAgZm9yIChjb25zdCBtb2RlbCBvZiBtb2RlbHNUb1RyeSkge1xuICAgICAgcG9zc2libGVVcmxzLnB1c2goYCR7dGhpcy5jb25maWcuYmFzZVVybH0vdjFiZXRhL21vZGVscy8ke21vZGVsfTpnZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7dGhpcy5jb25maWcuYXBpS2V5fWApXG4gICAgICBwb3NzaWJsZVVybHMucHVzaChgJHt0aGlzLmNvbmZpZy5iYXNlVXJsfS92MS9tb2RlbHMvJHttb2RlbH06Z2VuZXJhdGVDb250ZW50P2tleT0ke3RoaXMuY29uZmlnLmFwaUtleX1gKVxuICAgIH1cbiAgICBcbiAgICBjb25zdCByZXF1ZXN0Qm9keSA9IHtcbiAgICAgIGNvbnRlbnRzOiBbe1xuICAgICAgICBwYXJ0czogW3tcbiAgICAgICAgICB0ZXh0OiBwcm9tcHRcbiAgICAgICAgfV1cbiAgICAgIH1dLFxuICAgICAgZ2VuZXJhdGlvbkNvbmZpZzoge1xuICAgICAgICB0ZW1wZXJhdHVyZTogb3B0aW9ucy50ZW1wZXJhdHVyZSB8fCAwLjcsXG4gICAgICAgIG1heE91dHB1dFRva2Vuczogb3B0aW9ucy5tYXhUb2tlbnMgfHwgMjAwMCwgLy8gSW5jcmVhc2VkIGZyb20gMTAwMCB0byAyMDAwXG4gICAgICAgIHRvcFA6IG9wdGlvbnMudG9wUCB8fCAwLjksXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coXCLwn5SXIFVzaW5nIHdvcmtpbmcgR2VtaW5pIEFQSSBlbmRwb2ludC4uLlwiKVxuXG4gICAgLy8gVXNlIG9ubHkgdGhlIHdvcmtpbmcgZW5kcG9pbnRcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmNvbmZpZy5iYXNlVXJsfS92MWJldGEvbW9kZWxzL2dlbWluaS0yLjUtZmxhc2g6Z2VuZXJhdGVDb250ZW50P2tleT0ke3RoaXMuY29uZmlnLmFwaUtleX1gXG4gICAgY29uc29sZS5sb2coYPCfjJAgQVBJIFVSTDogJHt1cmwucmVwbGFjZSh0aGlzLmNvbmZpZy5hcGlLZXksICdBUElfS0VZX0hJRERFTicpfWApXG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpLFxuICAgICAgfSlcblxuICAgICAgY29uc29sZS5sb2coYPCfk6EgUmVzcG9uc2Ugc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApXG5cbiAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgICAgY29uc29sZS5sb2coXCLinIUgU3VjY2Vzc2Z1bCBBUEkgcmVzcG9uc2UgcmVjZWl2ZWRcIilcbiAgICAgICAgY29uc29sZS5sb2coXCLwn5SNIEZ1bGwgQVBJIHJlc3BvbnNlIHN0cnVjdHVyZTpcIiwgSlNPTi5zdHJpbmdpZnkocmVzdWx0LCBudWxsLCAyKSlcbiAgICAgICAgXG4gICAgICAgIC8vIE1vcmUgcm9idXN0IHJlc3BvbnNlIHBhcnNpbmcgd2l0aCBNQVhfVE9LRU5TIGhhbmRsaW5nXG4gICAgICAgIGlmIChyZXN1bHQuY2FuZGlkYXRlcyAmJiByZXN1bHQuY2FuZGlkYXRlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc3QgY2FuZGlkYXRlID0gcmVzdWx0LmNhbmRpZGF0ZXNbMF1cbiAgICAgICAgICBcbiAgICAgICAgICAvLyBDaGVjayBpZiB3ZSBoaXQgTUFYX1RPS0VOUyBsaW1pdFxuICAgICAgICAgIGlmIChjYW5kaWRhdGUuZmluaXNoUmVhc29uID09PSBcIk1BWF9UT0tFTlNcIikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEhpdCBNQVhfVE9LRU5TIGxpbWl0LCByZXNwb25zZSBtYXkgYmUgaW5jb21wbGV0ZVwiKVxuICAgICAgICAgICAgLy8gU3RpbGwgdHJ5IHRvIGV4dHJhY3QgcGFydGlhbCBjb250ZW50IGlmIGF2YWlsYWJsZVxuICAgICAgICAgICAgaWYgKGNhbmRpZGF0ZS5jb250ZW50ICYmIGNhbmRpZGF0ZS5jb250ZW50LnBhcnRzICYmIGNhbmRpZGF0ZS5jb250ZW50LnBhcnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGNhbmRpZGF0ZS5jb250ZW50LnBhcnRzWzBdLnRleHRcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLimqDvuI8gRXh0cmFjdGVkIHBhcnRpYWwgdGV4dCBkdWUgdG8gTUFYX1RPS0VOUzpcIiwgdGV4dC5zdWJzdHJpbmcoMCwgMTAwKSArIFwiLi4uXCIpXG4gICAgICAgICAgICAgIHJldHVybiB0ZXh0XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCLinYwgTUFYX1RPS0VOUyBoaXQgYW5kIG5vIGNvbnRlbnQgYXZhaWxhYmxlXCIpXG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFQSSByZXNwb25zZSBoaXQgdG9rZW4gbGltaXQgd2l0aCBubyB1c2FibGUgY29udGVudFwiKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICAvLyBOb3JtYWwgcmVzcG9uc2UgcHJvY2Vzc2luZ1xuICAgICAgICAgIGlmIChjYW5kaWRhdGUuY29udGVudCAmJiBjYW5kaWRhdGUuY29udGVudC5wYXJ0cyAmJiBjYW5kaWRhdGUuY29udGVudC5wYXJ0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gY2FuZGlkYXRlLmNvbnRlbnQucGFydHNbMF0udGV4dFxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLinIUgRXh0cmFjdGVkIHRleHQ6XCIsIHRleHQpXG4gICAgICAgICAgICByZXR1cm4gdGV4dFxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCLimqDvuI8gSW52YWxpZCBjb250ZW50IHN0cnVjdHVyZSBpbiBjYW5kaWRhdGU6XCIsIGNhbmRpZGF0ZSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgY29udGVudCBzdHJ1Y3R1cmUgaW4gQVBJIHJlc3BvbnNlXCIpXG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBObyBjYW5kaWRhdGVzIGluIHJlc3BvbnNlOlwiLCByZXN1bHQpXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gY2FuZGlkYXRlcyBpbiBBUEkgcmVzcG9uc2VcIilcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgZXJyb3JUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBBUEkgY2FsbCBmYWlsZWQ6YCwgcmVzcG9uc2Uuc3RhdHVzLCBlcnJvclRleHQpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgR2VtaW5pIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH0gLSAke2Vycm9yVGV4dH1gKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGDinYwgQVBJIGNhbGwgZXhjZXB0aW9uOmAsIGVycm9yLm1lc3NhZ2UpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHN1bW1hcml6ZSh0ZXh0OiBzdHJpbmcsIG9wdGlvbnM6IFN1bW1hcml6ZXJPcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBzdW1tYXJ5VHlwZSA9IG9wdGlvbnMudHlwZSB8fCBcImtleS1wb2ludHNcIlxuICAgIGNvbnN0IGxlbmd0aCA9IG9wdGlvbnMubGVuZ3RoIHx8IFwibWVkaXVtXCJcbiAgICBcbiAgICBjb25zdCBsZW5ndGhJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBzaG9ydDogXCJpbiAyLTMgc2VudGVuY2VzXCIsXG4gICAgICBtZWRpdW06IFwiaW4gNC02IHNlbnRlbmNlc1wiLCBcbiAgICAgIGxvbmc6IFwiaW4gNy0xMCBzZW50ZW5jZXNcIlxuICAgIH1cblxuICAgIGNvbnN0IHR5cGVJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBcImtleS1wb2ludHNcIjogXCJFeHRyYWN0IGFuZCBzdW1tYXJpemUgdGhlIGtleSBwb2ludHNcIixcbiAgICAgIFwidGwtZHJcIjogXCJDcmVhdGUgYSBUTDtEUiBzdW1tYXJ5XCIsXG4gICAgICBcInRlYXNlclwiOiBcIldyaXRlIGFuIGVuZ2FnaW5nIHRlYXNlciBzdW1tYXJ5XCIsXG4gICAgICBcImhlYWRsaW5lXCI6IFwiQ3JlYXRlIGEgaGVhZGxpbmUtc3R5bGUgc3VtbWFyeVwiXG4gICAgfVxuXG4gICAgY29uc3QgcHJvbXB0ID0gYCR7dHlwZUluc3RydWN0aW9uc1tzdW1tYXJ5VHlwZV19IG9mIHRoZSBmb2xsb3dpbmcgdGV4dCAke2xlbmd0aEluc3RydWN0aW9uc1tsZW5ndGhdfTpcblxuJHt0ZXh0fVxuXG5TdW1tYXJ5OmBcblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYWtlR2VtaW5pUmVxdWVzdChwcm9tcHQsIHsgdGVtcGVyYXR1cmU6IDAuMyB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiU3VtbWFyaXphdGlvbiBmYWlsZWQ6XCIsIGVycm9yKVxuICAgICAgLy8gRmFsbGJhY2sgdG8gc2ltcGxlIHRydW5jYXRpb25cbiAgICAgIHJldHVybiB0ZXh0LnN1YnN0cmluZygwLCA1MDApICsgXCIuLi5cIlxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHRyYW5zbGF0ZSh0ZXh0OiBzdHJpbmcsIG9wdGlvbnM6IFRyYW5zbGF0b3JPcHRpb25zKSB7XG4gICAgY29uc3QgdGFyZ2V0TGFuZyA9IHRoaXMuZ2V0TGFuZ3VhZ2VOYW1lKG9wdGlvbnMudGFyZ2V0TGFuZ3VhZ2UpXG4gICAgXG4gICAgY29uc3QgcHJvbXB0ID0gYFRyYW5zbGF0ZSB0aGUgZm9sbG93aW5nIHRleHQgdG8gJHt0YXJnZXRMYW5nfS4gTWFpbnRhaW4gdGhlIG9yaWdpbmFsIG1lYW5pbmcgYW5kIHRvbmU6XG5cbiR7dGV4dH1cblxuVHJhbnNsYXRpb246YFxuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLm1ha2VHZW1pbmlSZXF1ZXN0KHByb21wdCwgeyB0ZW1wZXJhdHVyZTogMC4yIH0pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJUcmFuc2xhdGlvbiBmYWlsZWQ6XCIsIGVycm9yKVxuICAgICAgLy8gUmV0dXJuIG9yaWdpbmFsIHRleHQgaWYgdHJhbnNsYXRpb24gZmFpbHNcbiAgICAgIHJldHVybiB0ZXh0XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcHJvbXB0KHByb21wdDogc3RyaW5nLCBvcHRpb25zOiBQcm9tcHRPcHRpb25zID0ge30pIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMubWFrZUdlbWluaVJlcXVlc3QocHJvbXB0LCBvcHRpb25zKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiUHJvbXB0IGdlbmVyYXRpb24gZmFpbGVkOlwiLCBlcnJvcilcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgd3JpdGUocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM6IFdyaXRlck9wdGlvbnMgPSB7fSkge1xuICAgIGNvbnN0IHRvbmUgPSBvcHRpb25zLnRvbmUgfHwgXCJjYXN1YWxcIlxuICAgIGNvbnN0IGxlbmd0aCA9IG9wdGlvbnMubGVuZ3RoIHx8IFwibWVkaXVtXCJcbiAgICBjb25zdCBmb3JtYXQgPSBvcHRpb25zLmZvcm1hdCB8fCBcInBhcmFncmFwaFwiXG5cbiAgICBjb25zdCBsZW5ndGhJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBzaG9ydDogXCJLZWVwIGl0IGJyaWVmIGFuZCBjb25jaXNlXCIsXG4gICAgICBtZWRpdW06IFwiV3JpdGUgYSBtb2RlcmF0ZSBsZW5ndGggcmVzcG9uc2VcIixcbiAgICAgIGxvbmc6IFwiUHJvdmlkZSBhIGRldGFpbGVkIGFuZCBjb21wcmVoZW5zaXZlIHJlc3BvbnNlXCJcbiAgICB9XG5cbiAgICBjb25zdCBmb3JtYXRJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBwYXJhZ3JhcGg6IFwiV3JpdGUgaW4gcGFyYWdyYXBoIGZvcm1cIixcbiAgICAgIFwiYnVsbGV0LXBvaW50c1wiOiBcIkZvcm1hdCBhcyBidWxsZXQgcG9pbnRzXCIsXG4gICAgICBcIm51bWJlcmVkLWxpc3RcIjogXCJGb3JtYXQgYXMgYSBudW1iZXJlZCBsaXN0XCJcbiAgICB9XG5cbiAgICBjb25zdCBlbmhhbmNlZFByb21wdCA9IGAke3Byb21wdH1cblxuSW5zdHJ1Y3Rpb25zOlxuLSBUb25lOiAke3RvbmV9XG4tICR7bGVuZ3RoSW5zdHJ1Y3Rpb25zW2xlbmd0aF19XG4tICR7Zm9ybWF0SW5zdHJ1Y3Rpb25zW2Zvcm1hdF19XG5cblJlc3BvbnNlOmBcblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYWtlR2VtaW5pUmVxdWVzdChlbmhhbmNlZFByb21wdCwgeyB0ZW1wZXJhdHVyZTogMC43IH0pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJXcml0aW5nIGZhaWxlZDpcIiwgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJld3JpdGUodGV4dDogc3RyaW5nLCBvcHRpb25zOiBSZXdyaXRlck9wdGlvbnMgPSB7fSkge1xuICAgIGNvbnN0IHRvbmUgPSBvcHRpb25zLnRvbmUgfHwgXCJjYXN1YWxcIlxuICAgIGNvbnN0IGxlbmd0aCA9IG9wdGlvbnMubGVuZ3RoIHx8IFwic2FtZVwiXG4gICAgY29uc3QgYXVkaWVuY2UgPSBvcHRpb25zLmF1ZGllbmNlIHx8IFwiZ2VuZXJhbFwiXG5cbiAgICBjb25zdCBsZW5ndGhJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBzaG9ydGVyOiBcIk1ha2UgaXQgbW9yZSBjb25jaXNlXCIsXG4gICAgICBsb25nZXI6IFwiRXhwYW5kIGFuZCBhZGQgbW9yZSBkZXRhaWxcIixcbiAgICAgIHNhbWU6IFwiS2VlcCBhcHByb3hpbWF0ZWx5IHRoZSBzYW1lIGxlbmd0aFwiXG4gICAgfVxuXG4gICAgY29uc3QgcHJvbXB0ID0gYFJld3JpdGUgdGhlIGZvbGxvd2luZyB0ZXh0IHdpdGggdGhlc2UgcmVxdWlyZW1lbnRzOlxuLSBUb25lOiAke3RvbmV9XG4tIEF1ZGllbmNlOiAke2F1ZGllbmNlfVxuLSBMZW5ndGg6ICR7bGVuZ3RoSW5zdHJ1Y3Rpb25zW2xlbmd0aF19XG5cbk9yaWdpbmFsIHRleHQ6XG4ke3RleHR9XG5cblJld3JpdHRlbiB0ZXh0OmBcblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYWtlR2VtaW5pUmVxdWVzdChwcm9tcHQsIHsgdGVtcGVyYXR1cmU6IDAuNSB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiUmV3cml0aW5nIGZhaWxlZDpcIiwgZXJyb3IpXG4gICAgICByZXR1cm4gdGV4dCAvLyBSZXR1cm4gb3JpZ2luYWwgaWYgcmV3cml0aW5nIGZhaWxzXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcHJvb2ZyZWFkKHRleHQ6IHN0cmluZywgb3B0aW9uczogUHJvb2ZyZWFkZXJPcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBjaGVja0dyYW1tYXIgPSBvcHRpb25zLmNoZWNrR3JhbW1hciAhPT0gZmFsc2VcbiAgICBjb25zdCBjaGVja1NwZWxsaW5nID0gb3B0aW9ucy5jaGVja1NwZWxsaW5nICE9PSBmYWxzZVxuICAgIGNvbnN0IGNoZWNrU3R5bGUgPSBvcHRpb25zLmNoZWNrU3R5bGUgIT09IGZhbHNlXG5cbiAgICBjb25zdCBjaGVja3MgPSBbXVxuICAgIGlmIChjaGVja0dyYW1tYXIpIGNoZWNrcy5wdXNoKFwiZ3JhbW1hclwiKVxuICAgIGlmIChjaGVja1NwZWxsaW5nKSBjaGVja3MucHVzaChcInNwZWxsaW5nXCIpXG4gICAgaWYgKGNoZWNrU3R5bGUpIGNoZWNrcy5wdXNoKFwic3R5bGUgYW5kIGNsYXJpdHlcIilcblxuICAgIGNvbnN0IHByb21wdCA9IGBQcm9vZnJlYWQgYW5kIGNvcnJlY3QgdGhlIGZvbGxvd2luZyB0ZXh0IGZvciAke2NoZWNrcy5qb2luKFwiLCBcIil9LiBSZXR1cm4gb25seSB0aGUgY29ycmVjdGVkIHRleHQ6XG5cbiR7dGV4dH1cblxuQ29ycmVjdGVkIHRleHQ6YFxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvcnJlY3RlZFRleHQgPSBhd2FpdCB0aGlzLm1ha2VHZW1pbmlSZXF1ZXN0KHByb21wdCwgeyB0ZW1wZXJhdHVyZTogMC4yIH0pXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb3JyZWN0ZWRfdGV4dDogY29ycmVjdGVkVGV4dCxcbiAgICAgICAgc3VnZ2VzdGlvbnM6IFtdLFxuICAgICAgICBlcnJvcnM6IFtdXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJQcm9vZnJlYWRpbmcgZmFpbGVkOlwiLCBlcnJvcilcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvcnJlY3RlZF90ZXh0OiB0ZXh0LFxuICAgICAgICBzdWdnZXN0aW9uczogW10sXG4gICAgICAgIGVycm9yczogW11cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldExhbmd1YWdlTmFtZShjb2RlOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGxhbmd1YWdlTWFwID0ge1xuICAgICAgZXM6IFwiU3BhbmlzaFwiLFxuICAgICAgZnI6IFwiRnJlbmNoXCIsIFxuICAgICAgZGU6IFwiR2VybWFuXCIsXG4gICAgICBpdDogXCJJdGFsaWFuXCIsXG4gICAgICBwdDogXCJQb3J0dWd1ZXNlXCIsXG4gICAgICBqYTogXCJKYXBhbmVzZVwiLFxuICAgICAga286IFwiS29yZWFuXCIsXG4gICAgICB6aDogXCJDaGluZXNlXCIsXG4gICAgICBlbjogXCJFbmdsaXNoXCJcbiAgICB9XG4gICAgcmV0dXJuIGxhbmd1YWdlTWFwW2NvZGVdIHx8IFwiRW5nbGlzaFwiXG4gIH1cbn1cblxuLy8gU2VydmVyLXNpZGUgb25seSBpbml0aWFsaXphdGlvblxuZXhwb3J0IGNvbnN0IGNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZSA9ICgpID0+IHtcbiAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfR09PR0xFX0FJX0FQSV9LRVlcbiAgY29uc3QgYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0dPT0dMRV9BSV9CQVNFX1VSTCB8fCBcImh0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tXCJcblxuICBpZiAoIWFwaUtleSkge1xuICAgIGNvbnNvbGUud2FybihcIkdvb2dsZSBBSSBBUEkga2V5IG5vdCBmb3VuZC4gTGVzc29uIGdlbmVyYXRpb24gd2lsbCB1c2UgZmFsbGJhY2sgdGVtcGxhdGVzLlwiKVxuICAgIC8vIFJldHVybiBhIHNlcnZpY2UgdGhhdCB3aWxsIGFsd2F5cyB0aHJvdyBlcnJvcnMsIHRyaWdnZXJpbmcgZmFsbGJhY2tzXG4gICAgcmV0dXJuIG5ldyBHb29nbGVBSVNlcnZlclNlcnZpY2UoeyBhcGlLZXk6IFwiZHVtbXlcIiwgYmFzZVVybCB9KVxuICB9XG5cbiAgcmV0dXJuIG5ldyBHb29nbGVBSVNlcnZlclNlcnZpY2UoeyBhcGlLZXksIGJhc2VVcmwgfSlcbn1cblxuZXhwb3J0IHR5cGUgeyBTdW1tYXJpemVyT3B0aW9ucywgVHJhbnNsYXRvck9wdGlvbnMsIFByb21wdE9wdGlvbnMsIFdyaXRlck9wdGlvbnMsIFJld3JpdGVyT3B0aW9ucywgUHJvb2ZyZWFkZXJPcHRpb25zIH1cbiJdLCJuYW1lcyI6WyJHb29nbGVBSVNlcnZlclNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImNvbmZpZyIsIm1vZGVsIiwibWFrZUdlbWluaVJlcXVlc3QiLCJwcm9tcHQiLCJvcHRpb25zIiwibW9kZWxzVG9UcnkiLCJwb3NzaWJsZVVybHMiLCJwdXNoIiwiYmFzZVVybCIsImFwaUtleSIsInJlcXVlc3RCb2R5IiwiY29udGVudHMiLCJwYXJ0cyIsInRleHQiLCJnZW5lcmF0aW9uQ29uZmlnIiwidGVtcGVyYXR1cmUiLCJtYXhPdXRwdXRUb2tlbnMiLCJtYXhUb2tlbnMiLCJ0b3BQIiwiY29uc29sZSIsImxvZyIsInVybCIsInJlcGxhY2UiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5Iiwic3RhdHVzIiwic3RhdHVzVGV4dCIsIm9rIiwicmVzdWx0IiwianNvbiIsImNhbmRpZGF0ZXMiLCJsZW5ndGgiLCJjYW5kaWRhdGUiLCJmaW5pc2hSZWFzb24iLCJ3YXJuIiwiY29udGVudCIsInN1YnN0cmluZyIsIkVycm9yIiwiZXJyb3JUZXh0IiwiZXJyb3IiLCJtZXNzYWdlIiwic3VtbWFyaXplIiwic3VtbWFyeVR5cGUiLCJ0eXBlIiwibGVuZ3RoSW5zdHJ1Y3Rpb25zIiwic2hvcnQiLCJtZWRpdW0iLCJsb25nIiwidHlwZUluc3RydWN0aW9ucyIsInRyYW5zbGF0ZSIsInRhcmdldExhbmciLCJnZXRMYW5ndWFnZU5hbWUiLCJ0YXJnZXRMYW5ndWFnZSIsIndyaXRlIiwidG9uZSIsImZvcm1hdCIsImZvcm1hdEluc3RydWN0aW9ucyIsInBhcmFncmFwaCIsImVuaGFuY2VkUHJvbXB0IiwicmV3cml0ZSIsImF1ZGllbmNlIiwic2hvcnRlciIsImxvbmdlciIsInNhbWUiLCJwcm9vZnJlYWQiLCJjaGVja0dyYW1tYXIiLCJjaGVja1NwZWxsaW5nIiwiY2hlY2tTdHlsZSIsImNoZWNrcyIsImpvaW4iLCJjb3JyZWN0ZWRUZXh0IiwiY29ycmVjdGVkX3RleHQiLCJzdWdnZXN0aW9ucyIsImVycm9ycyIsImNvZGUiLCJsYW5ndWFnZU1hcCIsImVzIiwiZnIiLCJkZSIsIml0IiwicHQiLCJqYSIsImtvIiwiemgiLCJlbiIsImNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19HT09HTEVfQUlfQVBJX0tFWSIsIk5FWFRfUFVCTElDX0dPT0dMRV9BSV9CQVNFX1VSTCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/google-ai-server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/lesson-ai-generator-server.ts":
/*!*******************************************!*\
  !*** ./lib/lesson-ai-generator-server.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LessonAIServerGenerator: () => (/* binding */ LessonAIServerGenerator),\n/* harmony export */   lessonAIServerGenerator: () => (/* binding */ lessonAIServerGenerator)\n/* harmony export */ });\n/* harmony import */ var _google_ai_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./google-ai-server */ \"(rsc)/./lib/google-ai-server.ts\");\n\nclass LessonAIServerGenerator {\n    getGoogleAI() {\n        if (!this.googleAI) {\n            this.googleAI = (0,_google_ai_server__WEBPACK_IMPORTED_MODULE_0__.createGoogleAIServerService)();\n        }\n        return this.googleAI;\n    }\n    async generateLesson(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage, sourceUrl, contentMetadata, structuredContent, wordCount, readingTime } = params;\n        console.log(\"\\uD83D\\uDE80 Starting optimized AI lesson generation with params:\", {\n            textLength: sourceText.length,\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            hasMetadata: !!contentMetadata,\n            hasStructuredContent: !!structuredContent\n        });\n        try {\n            // Use ultra-minimal AI approach to avoid MAX_TOKENS\n            console.log(\"\\uD83E\\uDD16 Step 1: Generating lesson with ultra-minimal AI prompts...\");\n            const lessonStructure = await this.generateMinimalAILesson(sourceText, lessonType, studentLevel, targetLanguage, contentMetadata);\n            console.log(\"âœ… Minimal AI lesson generated:\", Object.keys(lessonStructure));\n            // Return properly structured GeneratedLesson object\n            const finalLesson = {\n                lessonType,\n                studentLevel,\n                targetLanguage,\n                sections: lessonStructure\n            };\n            console.log(\"\\uD83C\\uDFAF Returning AI-generated lesson:\", {\n                lessonType: finalLesson.lessonType,\n                studentLevel: finalLesson.studentLevel,\n                targetLanguage: finalLesson.targetLanguage,\n                sectionsCount: Object.keys(finalLesson.sections).length,\n                warmupCount: finalLesson.sections.warmup?.length || 0,\n                vocabularyCount: finalLesson.sections.vocabulary?.length || 0\n            });\n            console.log(\"\\uD83C\\uDF89 Optimized AI lesson generation complete!\");\n            return finalLesson;\n        } catch (error) {\n            console.error(\"âŒ Error in AI lesson generation:\", error);\n            console.log(\"\\uD83D\\uDD04 Falling back to smart template generation...\");\n            // Fallback to smart templates if AI fails\n            return this.generateSmartTemplateFallback(params);\n        }\n    }\n    // Ultra-minimal AI lesson generation to avoid MAX_TOKENS\n    async generateMinimalAILesson(sourceText, lessonType, studentLevel, targetLanguage, metadata) {\n        console.log(\"\\uD83C\\uDFAF Using ultra-minimal AI prompts to avoid token limits...\");\n        // Step 1: Generate just the essential parts with minimal prompts\n        const warmupQuestions = await this.generateMinimalWarmup(sourceText, studentLevel);\n        const vocabulary = await this.generateMinimalVocabulary(sourceText, studentLevel);\n        const comprehensionQuestions = await this.generateMinimalComprehension(sourceText, studentLevel);\n        // Step 2: Use hybrid approach - AI for key parts, templates for the rest\n        return {\n            warmup: this.addWarmupInstructions(warmupQuestions, studentLevel),\n            vocabulary: vocabulary,\n            reading: this.generateSmartReading(sourceText, studentLevel),\n            comprehension: this.addComprehensionInstructions(comprehensionQuestions, studentLevel),\n            discussion: this.addDiscussionInstructions(this.generateSmartDiscussion(this.extractBetterTopics(sourceText), lessonType, studentLevel), studentLevel),\n            grammar: this.generateSmartGrammar(studentLevel, sourceText),\n            pronunciation: this.generateSmartPronunciation(vocabulary.map((v)=>v.word)),\n            wrapup: this.addWrapupInstructions(this.generateSmartWrapup(this.extractBetterTopics(sourceText), studentLevel), studentLevel)\n        };\n    }\n    // Ultra-minimal warmup generation\n    async generateMinimalWarmup(sourceText, studentLevel) {\n        // Extract better context for topic identification\n        const topics = this.extractBetterTopics(sourceText);\n        const mainTopic = topics[0] || \"this topic\";\n        // Create a more specific prompt that avoids content assumptions\n        const prompt = `Write 3 ${studentLevel} warm-up questions about ${mainTopic}. Ask about students' prior knowledge and experience. Do not mention any specific events or results. Format: just the questions, one per line:`;\n        try {\n            console.log(\"\\uD83D\\uDD25 Minimal warmup prompt:\", prompt.length, \"chars\");\n            console.log(\"\\uD83C\\uDFAF Topic identified:\", mainTopic);\n            const response = await this.getGoogleAI().prompt(prompt);\n            // Extract only actual questions (must end with ?)\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>{\n                // Must be a question (ends with ?) and not an instruction\n                return line.endsWith(\"?\") && line.length > 10 && !line.toLowerCase().includes(\"here are\") && !line.toLowerCase().includes(\"based on\") && !line.toLowerCase().includes(\"headline mentions\") && !line.toLowerCase().includes(\"the text\") && !line.toLowerCase().includes(\"the article\") && !line.toLowerCase().includes(\"according to\") && !line.toLowerCase().includes(\"the passage\");\n            }).map((line)=>line.replace(/^\\d+\\.?\\s*/, \"\").replace(/^-\\s*/, \"\").trim()).slice(0, 3);\n            console.log(\"\\uD83C\\uDFAF Extracted warmup questions:\", questions);\n            return questions.length >= 3 ? questions : this.generateSmartWarmupQuestions(topics, studentLevel, {});\n        } catch (error) {\n            console.log(\"âš ï¸ Minimal warmup failed, using template\");\n            return this.generateSmartWarmupQuestions(this.extractBetterTopics(sourceText), studentLevel, {});\n        }\n    }\n    // Add instructional text to sections\n    addWarmupInstructions(questions, studentLevel) {\n        const instruction = \"Have the following conversations or discussions with your tutor before reading the text:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    addComprehensionInstructions(questions, studentLevel) {\n        const instruction = \"After reading the text, answer these comprehension questions:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    addDiscussionInstructions(questions, studentLevel) {\n        const instruction = \"Discuss these questions with your tutor to explore the topic in depth:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    addWrapupInstructions(questions, studentLevel) {\n        const instruction = \"Reflect on your learning by discussing these wrap-up questions:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    // Better topic extraction that recognizes compound terms\n    extractBetterTopics(text) {\n        const topics = [];\n        // Look for compound terms first (like \"Ryder Cup\", \"World Cup\", etc.)\n        const compoundPatterns = [\n            /\\b(Ryder Cup|World Cup|Champions League|Premier League|Super Bowl|Olympics|World Series)\\b/gi,\n            /\\b(artificial intelligence|machine learning|climate change|social media)\\b/gi,\n            /\\b([A-Z][a-z]+ [A-Z][a-z]+)\\b/g // General compound proper nouns\n        ];\n        for (const pattern of compoundPatterns){\n            const matches = text.match(pattern);\n            if (matches) {\n                topics.push(...matches.map((m)=>m.toLowerCase()));\n            }\n        }\n        // If no compound terms found, fall back to single words\n        if (topics.length === 0) {\n            const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n            const commonWords = [\n                \"europe\",\n                \"team\",\n                \"golf\",\n                \"tournament\",\n                \"sports\",\n                \"competition\"\n            ];\n            const foundWords = words.filter((word)=>commonWords.includes(word));\n            topics.push(...foundWords.slice(0, 3));\n        }\n        return topics.length > 0 ? topics : [\n            \"sports\"\n        ];\n    }\n    // Ultra-minimal vocabulary generation\n    async generateMinimalVocabulary(sourceText, studentLevel) {\n        const words = sourceText.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words)).slice(0, 4) // Only 4 words\n        ;\n        const vocabulary = [];\n        for (const word of uniqueWords){\n            try {\n                const prompt = `Define \"${word}\" for ${studentLevel} student:`;\n                console.log(\"\\uD83D\\uDCDA Minimal vocab prompt:\", prompt.length, \"chars\");\n                const meaning = await this.getGoogleAI().prompt(prompt);\n                // Find example sentence from source\n                const sentences = sourceText.split(/[.!?]+/);\n                const example = sentences.find((s)=>s.toLowerCase().includes(word.toLowerCase())) || `Example with ${word}.`;\n                vocabulary.push({\n                    word: word,\n                    meaning: meaning.trim().substring(0, 100),\n                    example: example.trim().substring(0, 100)\n                });\n            } catch (error) {\n                console.log(`âš ï¸ Vocab failed for ${word}, using template`);\n                vocabulary.push({\n                    word: word,\n                    meaning: this.generateWordMeaning(word, studentLevel),\n                    example: `Example sentence with ${word}.`\n                });\n            }\n        }\n        return vocabulary;\n    }\n    // Ultra-minimal comprehension generation\n    async generateMinimalComprehension(sourceText, studentLevel) {\n        const shortText = sourceText.substring(0, 150) // Use only first 150 chars\n        ;\n        const prompt = `Write 3 ${studentLevel} reading comprehension questions about this text. Only return questions, no instructions: ${shortText}`;\n        try {\n            console.log(\"â“ Minimal comprehension prompt:\", prompt.length, \"chars\");\n            const response = await this.getGoogleAI().prompt(prompt);\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>{\n                // Must be a question and not an instruction\n                return line.endsWith(\"?\") && line.length > 10 && !line.toLowerCase().includes(\"here are\") && !line.toLowerCase().includes(\"based on\");\n            }).map((line)=>line.replace(/^\\d+\\.?\\s*/, \"\").replace(/^\\*\\*/, \"\").replace(/\\*\\*$/, \"\").trim()).slice(0, 3);\n            return questions.length >= 3 ? questions : this.generateSmartComprehension(this.extractBetterTopics(sourceText), studentLevel);\n        } catch (error) {\n            console.log(\"âš ï¸ Minimal comprehension failed, using template\");\n            return this.generateSmartComprehension(this.extractBetterTopics(sourceText), studentLevel);\n        }\n    }\n    // Smart template fallback\n    generateSmartTemplateFallback(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage } = params;\n        console.log(\"\\uD83C\\uDFA8 Using smart template fallback...\");\n        const topics = this.extractTopicsFromText(sourceText, []);\n        const vocabulary = this.extractVocabularyFromText(sourceText, studentLevel);\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: this.addWarmupInstructions(this.generateSmartWarmupQuestions(topics, studentLevel, {}), studentLevel),\n                vocabulary: this.generateSmartVocabulary(vocabulary, sourceText, studentLevel),\n                reading: this.generateSmartReading(sourceText, studentLevel),\n                comprehension: this.addComprehensionInstructions(this.generateSmartComprehension(topics, studentLevel), studentLevel),\n                discussion: this.addDiscussionInstructions(this.generateSmartDiscussion(topics, lessonType, studentLevel), studentLevel),\n                grammar: this.generateSmartGrammar(studentLevel, sourceText),\n                pronunciation: this.generateSmartPronunciation(vocabulary),\n                wrapup: this.addWrapupInstructions(this.generateSmartWrapup(topics, studentLevel), studentLevel)\n            }\n        };\n    }\n    // Content analysis without AI calls\n    analyzeContentContextNoAI(sourceText, metadata, structuredContent, studentLevel) {\n        console.log(\"\\uD83D\\uDD0D Analyzing content context without AI...\");\n        const analysis = {\n            contentType: metadata?.contentType || \"general\",\n            domain: metadata?.domain || \"\",\n            complexity: \"medium\",\n            topics: [],\n            keyVocabulary: [],\n            culturalContext: \"\",\n            learningObjectives: [],\n            difficulty: studentLevel || \"B1\",\n            title: metadata?.title || \"\",\n            sourceCountry: this.determineSourceCountry(metadata?.domain || \"\")\n        };\n        // Analyze content complexity\n        const sentences = sourceText.split(/[.!?]+/).filter((s)=>s.trim().length > 10);\n        const avgSentenceLength = sentences.length > 0 ? sentences.reduce((sum, s)=>sum + s.split(\" \").length, 0) / sentences.length : 0;\n        const complexWords = sourceText.match(/\\b\\w{8,}\\b/g)?.length || 0;\n        const totalWords = sourceText.split(/\\s+/).length;\n        if (avgSentenceLength > 20 || complexWords / totalWords > 0.15) {\n            analysis.complexity = \"high\";\n        } else if (avgSentenceLength < 12 && complexWords / totalWords < 0.08) {\n            analysis.complexity = \"low\";\n        }\n        // Extract topics using text analysis\n        analysis.topics = this.extractTopicsFromText(sourceText, structuredContent?.headings || []);\n        // Extract vocabulary using text analysis\n        analysis.keyVocabulary = this.extractVocabularyFromText(sourceText, studentLevel);\n        // Determine cultural context\n        if (metadata?.domain) {\n            analysis.culturalContext = this.determineCulturalContext(metadata.domain, sourceText);\n        }\n        // Generate learning objectives\n        analysis.learningObjectives = this.generateLearningObjectives(analysis.contentType, analysis.topics, studentLevel);\n        return analysis;\n    }\n    // New method: Analyze content context and complexity\n    async analyzeContentContext(sourceText, metadata, structuredContent, studentLevel) {\n        console.log(\"\\uD83D\\uDD0D Analyzing content context...\");\n        const analysis = {\n            contentType: metadata?.contentType || \"general\",\n            domain: metadata?.domain || \"\",\n            complexity: \"medium\",\n            topics: [],\n            keyVocabulary: [],\n            culturalContext: \"\",\n            learningObjectives: [],\n            difficulty: studentLevel || \"B1\",\n            title: metadata?.title || \"\",\n            sourceCountry: this.determineSourceCountry(metadata?.domain || \"\")\n        };\n        // Analyze content complexity based on text characteristics\n        const sentences = sourceText.split(/[.!?]+/).filter((s)=>s.trim().length > 10);\n        const avgSentenceLength = sentences.length > 0 ? sentences.reduce((sum, s)=>sum + s.split(\" \").length, 0) / sentences.length : 0;\n        const complexWords = sourceText.match(/\\b\\w{8,}\\b/g)?.length || 0;\n        const totalWords = sourceText.split(/\\s+/).length;\n        if (avgSentenceLength > 20 || complexWords / totalWords > 0.15) {\n            analysis.complexity = \"high\";\n        } else if (avgSentenceLength < 12 && complexWords / totalWords < 0.08) {\n            analysis.complexity = \"low\";\n        }\n        console.log(\"\\uD83D\\uDCC8 Text complexity analysis:\", {\n            avgSentenceLength,\n            complexWords,\n            totalWords,\n            complexity: analysis.complexity\n        });\n        // Extract key topics using simple text analysis (skip AI to avoid token limits)\n        console.log(\"\\uD83C\\uDFAF Extracting topics using text analysis...\");\n        analysis.topics = this.extractTopicsFromText(sourceText, structuredContent?.headings || []);\n        console.log(\"âœ… Extracted topics:\", analysis.topics);\n        // Extract key vocabulary using text analysis (skip AI to avoid token limits)\n        console.log(\"\\uD83D\\uDCDA Extracting vocabulary using text analysis...\");\n        analysis.keyVocabulary = this.extractVocabularyFromText(sourceText, studentLevel);\n        console.log(\"âœ… Extracted vocabulary:\", analysis.keyVocabulary);\n        // Determine cultural context\n        if (metadata?.domain) {\n            analysis.culturalContext = this.determineCulturalContext(metadata.domain, sourceText);\n            console.log(\"\\uD83C\\uDF0D Cultural context:\", analysis.culturalContext);\n        }\n        // Generate learning objectives based on content type and lesson type\n        analysis.learningObjectives = this.generateLearningObjectives(analysis.contentType, analysis.topics, studentLevel);\n        console.log(\"\\uD83C\\uDFAF Learning objectives:\", analysis.learningObjectives);\n        return analysis;\n    }\n    // Enhanced contextual summary creation\n    async createContextualSummary(sourceText, contentAnalysis, lessonType, studentLevel) {\n        console.log(\"\\uD83D\\uDCDD Creating contextual summary...\");\n        // Use simple prompt to avoid token limits\n        const summaryPrompt = `Summarize this text in 4-5 sentences for ${studentLevel} level students:\n\n${sourceText.substring(0, 800)}\n\nSummary:`;\n        try {\n            console.log(\"\\uD83E\\uDD16 Calling AI for contextual summary...\");\n            const summary = await this.getGoogleAI().prompt(summaryPrompt, {\n                temperature: 0.4,\n                maxTokens: 300\n            });\n            console.log(\"âœ… AI contextual summary created:\", summary.substring(0, 100) + \"...\");\n            return summary;\n        } catch (error) {\n            console.warn(\"âš ï¸ AI contextual summary failed, using text truncation:\", error.message);\n            // Skip complex fallbacks, just use truncation\n            const truncated = sourceText.substring(0, 600) + \"...\";\n            console.log(\"\\uD83D\\uDD04 Using truncated text as summary\");\n            return truncated;\n        }\n    }\n    // Generate CEFR-adapted warm-up questions\n    async generateContextualWarmupQuestions(content, contentAnalysis, studentLevel, metadata) {\n        console.log(\"\\uD83D\\uDD25 Generating CEFR-adapted warm-up questions...\");\n        const levelInstructions = {\n            \"A1\": `\nCreate 3 warm-up questions for A1 (beginner) level:\n- Use simple present tense and basic vocabulary\n- Ask yes/no questions or simple choice questions\n- Focus on familiar, concrete concepts\n- Keep questions short and direct\n- Use vocabulary the student likely knows\nExample: \"Do you use [topic] in your daily life? Yes or No?\"`,\n            \"A2\": `\nCreate 3 warm-up questions for A2 (elementary) level:\n- Use simple past tense and personal experiences\n- Ask for short, simple answers\n- Include basic comparisons with \"different\" or \"same\"\n- Focus on personal experiences and familiar situations\n- Use simple connecting words like \"and\", \"but\"\nExample: \"Have you ever [experienced topic]? How was it?\"`,\n            \"B1\": `\nCreate 3 warm-up questions for B1 (intermediate) level:\n- Ask for opinions with \"What do you think...?\"\n- Include comparisons between countries/cultures\n- Ask students to explain reasons with \"because\" or \"why\"\n- Discuss advantages and disadvantages\n- Use more varied vocabulary but keep structure clear\nExample: \"What do you think about [topic]? How is it different in your country?\"`,\n            \"B2\": `\nCreate 3 warm-up questions for B2 (upper intermediate) level:\n- Ask students to analyze situations and predict outcomes\n- Include complex opinions and explanations\n- Discuss implications and consequences\n- Use conditional language (\"What would happen if...?\")\n- Encourage detailed responses with examples\nExample: \"What challenges do you think [specific group] face with [topic]?\"`,\n            \"C1\": `\nCreate 3 warm-up questions for C1 (advanced) level:\n- Ask students to evaluate arguments and consider multiple perspectives\n- Include abstract concepts and societal implications\n- Use sophisticated vocabulary and complex structures\n- Encourage critical thinking and nuanced discussion\n- Ask about broader cultural and social contexts\nExample: \"How do cultural attitudes toward [concept] influence [topic] in different societies?\"`\n        };\n        // Ultra-simple prompt to avoid token limits\n        const topic = contentAnalysis.topics[0] || \"this topic\";\n        const warmupPrompt = `Create 3 ${studentLevel} level warm-up questions about ${topic}. Return only the questions:`;\n        try {\n            console.log(\"\\uD83E\\uDD16 Calling AI for contextual warm-up questions...\");\n            console.log(\"\\uD83D\\uDCDD Warm-up prompt:\", warmupPrompt.substring(0, 200) + \"...\");\n            const response = await this.getGoogleAI().prompt(warmupPrompt, {\n                temperature: 0.6,\n                maxTokens: 150\n            });\n            console.log(\"âœ… AI warm-up questions generated\");\n            console.log(\"\\uD83E\\uDD16 Raw AI response:\", response);\n            const questions = this.parseListFromText(response).slice(0, 3);\n            console.log(\"\\uD83D\\uDD25 Parsed warm-up questions:\", questions);\n            console.log(\"\\uD83D\\uDD0D Questions array length:\", questions.length);\n            // Ensure we have 3 questions, add fallbacks if needed\n            while(questions.length < 3){\n                const fallbackQuestion = this.getFallbackWarmupQuestion(studentLevel, contentAnalysis, questions.length);\n                console.log(`ðŸ”„ Adding fallback question ${questions.length + 1}:`, fallbackQuestion);\n                questions.push(fallbackQuestion);\n            }\n            console.log(\"âœ… Final warm-up questions:\", questions);\n            // Final safety check - if still empty, use basic fallback\n            if (questions.length === 0) {\n                console.warn(\"âš ï¸ No questions generated, using emergency fallback\");\n                return [\n                    \"What do you know about this topic?\",\n                    \"Have you experienced something similar?\",\n                    \"What would you like to learn?\"\n                ];\n            }\n            return questions;\n        } catch (error) {\n            console.warn(\"âš ï¸ AI warm-up generation failed, using contextual fallbacks:\", error.message);\n            const fallbackQuestions = this.getContextualWarmupFallback(studentLevel, contentAnalysis, metadata);\n            console.log(\"\\uD83D\\uDD04 Fallback warm-up questions:\", fallbackQuestions);\n            // Final safety check for fallback\n            if (!fallbackQuestions || fallbackQuestions.length === 0) {\n                console.warn(\"âš ï¸ Fallback also empty, using emergency questions\");\n                return [\n                    \"What do you know about this topic?\",\n                    \"Have you experienced something similar?\",\n                    \"What would you like to learn?\"\n                ];\n            }\n            return fallbackQuestions;\n        }\n    }\n    // Enhanced contextual lesson structure generation\n    async generateContextualLessonStructure(content, contentAnalysis, lessonType, studentLevel, targetLanguage, metadata) {\n        console.log(\"\\uD83C\\uDFD7ï¸ Generating contextual lesson structure...\");\n        // Generate contextual warm-up questions first\n        const contextualWarmup = await this.generateContextualWarmupQuestions(content, contentAnalysis, studentLevel, metadata);\n        console.log(\"\\uD83D\\uDD25 Generated contextual warm-up questions:\", contextualWarmup);\n        // Ultra-simplified prompt to avoid token limits\n        const topics = contentAnalysis.topics.slice(0, 2).join(\", \") || \"technology\";\n        const vocab = contentAnalysis.keyVocabulary.slice(0, 4).join(\", \");\n        const prompt = `Create a ${lessonType} lesson for ${studentLevel} students about: ${topics}\n\nContent: \"${content.substring(0, 400)}\"\nKey words: ${vocab}\n\nReturn JSON with: warmup (use provided), vocabulary (4 words from content), reading (simplified content), comprehension (3 questions), discussion (3 questions), grammar (focus + examples), pronunciation (1 word), wrapup (3 questions).\n\n{\n  \"warmup\": ${JSON.stringify(contextualWarmup)},\n  \"vocabulary\": [{\"word\": \"word\", \"meaning\": \"definition\", \"example\": \"sentence\"}],\n  \"reading\": \"text\",\n  \"comprehension\": [\"question\"],\n  \"discussion\": [\"question\"], \n  \"grammar\": {\"focus\": \"topic\", \"examples\": [\"example\"], \"exercise\": [\"exercise\"]},\n  \"pronunciation\": {\"word\": \"word\", \"ipa\": \"/ipa/\", \"practice\": \"sentence\"},\n  \"wrapup\": [\"question\"]\n}`;\n        try {\n            console.log(\"\\uD83E\\uDD16 Calling AI for lesson structure...\");\n            const response = await this.getGoogleAI().prompt(prompt, {\n                temperature: 0.7,\n                maxTokens: 1500\n            });\n            console.log(\"\\uD83E\\uDD16 AI lesson structure response:\", response.substring(0, 200) + \"...\");\n            try {\n                const parsed = JSON.parse(response);\n                console.log(\"âœ… Successfully parsed lesson structure JSON\");\n                // Ensure our contextual warm-up questions are preserved\n                parsed.warmup = contextualWarmup;\n                console.log(\"\\uD83D\\uDD25 Preserved contextual warm-up questions in final structure\");\n                return parsed;\n            } catch (parseError) {\n                console.warn(\"âš ï¸ Failed to parse JSON, attempting to clean response...\");\n                // Try to extract JSON from the response\n                const jsonMatch = response.match(/\\{[\\s\\S]*\\}/);\n                if (jsonMatch) {\n                    try {\n                        const cleaned = JSON.parse(jsonMatch[0]);\n                        console.log(\"âœ… Successfully parsed cleaned JSON\");\n                        // Ensure our contextual warm-up questions are preserved\n                        cleaned.warmup = contextualWarmup;\n                        console.log(\"\\uD83D\\uDD25 Preserved contextual warm-up questions in cleaned structure\");\n                        return cleaned;\n                    } catch (cleanError) {\n                        console.warn(\"âš ï¸ Failed to parse cleaned JSON, using fallback\");\n                    }\n                }\n                // If JSON parsing fails, return a structured fallback with contextual warm-up\n                const fallback = this.createStructuredFallback(content, lessonType, studentLevel);\n                fallback.warmup = contextualWarmup;\n                console.log(\"\\uD83D\\uDD25 Using fallback with contextual warm-up questions\");\n                return fallback;\n            }\n        } catch (error) {\n            console.warn(\"âš ï¸ AI lesson structure generation failed, using fallback:\", error.message);\n            const fallback = this.createStructuredFallback(content, lessonType, studentLevel);\n            fallback.warmup = contextualWarmup;\n            console.log(\"\\uD83D\\uDD25 Using error fallback with contextual warm-up questions\");\n            return fallback;\n        }\n    }\n    // Enhanced detailed content generation with context\n    async generateDetailedContextualContent(structure, content, contentAnalysis, lessonType, studentLevel, targetLanguage, structuredContent) {\n        // Use Writer API to expand each section with contextual, detailed content\n        const sections = {\n            ...structure\n        };\n        // Enhance vocabulary section with contextual examples\n        if (sections.vocabulary) {\n            for(let i = 0; i < sections.vocabulary.length; i++){\n                const vocab = sections.vocabulary[i];\n                try {\n                    const contextualExamplePrompt = `\nCreate a natural example sentence using the word \"${vocab.word}\" that relates to this content context:\nTopics: ${contentAnalysis.topics.join(\", \")}\nContent type: ${contentAnalysis.contentType}\nLevel: ${studentLevel}\n\nMake the example relevant to the source material and appropriate for ${studentLevel} level students.\n`;\n                    const enhancedExample = await this.getGoogleAI().write(contextualExamplePrompt, {\n                        tone: \"casual\",\n                        length: \"short\"\n                    });\n                    sections.vocabulary[i].example = enhancedExample;\n                    // Add contextual meaning based on source content\n                    const contextualMeaningPrompt = `\nExplain the meaning of \"${vocab.word}\" in the context of: ${contentAnalysis.topics[0] || contentAnalysis.contentType}\nKeep it simple for ${studentLevel} level students.\n`;\n                    const contextualMeaning = await this.getGoogleAI().write(contextualMeaningPrompt, {\n                        tone: \"casual\",\n                        length: \"short\"\n                    });\n                    sections.vocabulary[i].contextualMeaning = contextualMeaning;\n                } catch (error) {\n                    // Keep original if enhancement fails\n                    console.warn(`Failed to enhance vocabulary for ${vocab.word}:`, error);\n                }\n            }\n        }\n        // Enhance discussion questions with specific content references\n        if (sections.discussion) {\n            try {\n                const enhancedDiscussionPrompt = `\nEnhance these discussion questions for a ${lessonType} lesson about ${contentAnalysis.topics.join(\" and \")}:\n${sections.discussion.join(\"\\n\")}\n\nMake them more specific to the content, engaging for ${studentLevel} level students, and encourage deeper thinking about:\n- ${contentAnalysis.topics.slice(0, 3).join(\"\\n- \")}\n\nReturn 3-4 enhanced questions that reference specific aspects of the content.\n`;\n                const enhancedDiscussion = await this.getGoogleAI().write(enhancedDiscussionPrompt, {\n                    tone: \"casual\",\n                    length: \"medium\",\n                    format: \"bullet-points\"\n                });\n                sections.discussion = this.parseListFromText(enhancedDiscussion).slice(0, 4);\n            } catch (error) {\n                console.warn(\"Failed to enhance discussion questions:\", error);\n            }\n        }\n        // Enhance reading section with better structure\n        if (sections.reading && structuredContent?.headings?.length > 0) {\n            try {\n                const structuredReadingPrompt = `\nImprove this reading text by organizing it with clear structure based on these headings from the original:\n${structuredContent.headings.slice(0, 3).map((h)=>`- ${h.text}`).join(\"\\n\")}\n\nOriginal text: \"${sections.reading}\"\n\nCreate a well-structured, ${studentLevel}-appropriate reading passage that maintains the key information but improves readability.\n`;\n                const enhancedReading = await this.getGoogleAI().rewrite(sections.reading, {\n                    tone: \"casual\",\n                    length: \"same\",\n                    audience: this.getAudienceLevel(studentLevel)\n                });\n                sections.reading = enhancedReading;\n            } catch (error) {\n                console.warn(\"Failed to enhance reading section:\", error);\n            }\n        }\n        // Enhance grammar section with content-specific examples\n        if (sections.grammar && sections.grammar.focus) {\n            try {\n                const grammarExamplesPrompt = `\nCreate 3 grammar examples for \"${sections.grammar.focus}\" using vocabulary and concepts from this content:\nTopics: ${contentAnalysis.topics.join(\", \")}\nKey vocabulary: ${contentAnalysis.keyVocabulary.slice(0, 5).join(\", \")}\n\nMake examples relevant to the content and appropriate for ${studentLevel} level.\n`;\n                const contextualGrammarExamples = await this.getGoogleAI().write(grammarExamplesPrompt, {\n                    tone: \"casual\",\n                    length: \"short\",\n                    format: \"bullet-points\"\n                });\n                sections.grammar.contextualExamples = this.parseListFromText(contextualGrammarExamples);\n            } catch (error) {\n                console.warn(\"Failed to enhance grammar examples:\", error);\n            }\n        }\n        return sections;\n    }\n    async proofreadLesson(lesson) {\n        // Proofread key text sections\n        const sectionsToProofread = [\n            \"reading\",\n            \"grammar.examples\",\n            \"pronunciation.practice\"\n        ];\n        for (const sectionPath of sectionsToProofread){\n            const value = this.getNestedValue(lesson, sectionPath);\n            if (typeof value === \"string\") {\n                const proofread = await this.getGoogleAI().proofread(value, {\n                    checkGrammar: true,\n                    checkSpelling: true,\n                    checkStyle: true\n                });\n                this.setNestedValue(lesson, sectionPath, proofread.corrected_text);\n            }\n        }\n        return lesson;\n    }\n    generateFallbackLesson(params) {\n        // Template-based fallback when AI APIs fail\n        const { sourceText, lessonType, studentLevel, targetLanguage } = params;\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: this.getTemplateWarmup(lessonType, studentLevel),\n                vocabulary: this.extractVocabulary(sourceText, studentLevel),\n                reading: this.simplifyText(sourceText, studentLevel),\n                comprehension: this.getTemplateComprehension(lessonType, studentLevel),\n                discussion: this.getTemplateDiscussion(lessonType, studentLevel),\n                grammar: this.getTemplateGrammar(studentLevel),\n                pronunciation: this.getTemplatePronunciation(sourceText),\n                wrapup: this.getTemplateWrapup(lessonType)\n            }\n        };\n    }\n    // Helper methods\n    getSummaryLength(level) {\n        const lengthMap = {\n            A1: \"short\",\n            A2: \"short\",\n            B1: \"medium\",\n            B2: \"medium\",\n            C1: \"long\"\n        };\n        return lengthMap[level] || \"medium\";\n    }\n    getLanguageCode(language) {\n        const languageMap = {\n            spanish: \"es\",\n            french: \"fr\",\n            german: \"de\",\n            italian: \"it\",\n            portuguese: \"pt\",\n            japanese: \"ja\",\n            korean: \"ko\",\n            chinese: \"zh\"\n        };\n        return languageMap[language] || \"en\";\n    }\n    parseListFromText(text) {\n        return text.split(\"\\n\").filter((line)=>line.trim()).map((line)=>line.replace(/^[-â€¢*]\\s*/, \"\").trim()).filter((line)=>line.length > 0).slice(0, 4) // Limit to 4 items\n        ;\n    }\n    getNestedValue(obj, path) {\n        return path.split(\".\").reduce((current, key)=>current?.[key], obj);\n    }\n    setNestedValue(obj, path, value) {\n        const keys = path.split(\".\");\n        const lastKey = keys.pop();\n        const target = keys.reduce((current, key)=>current[key], obj);\n        target[lastKey] = value;\n    }\n    createStructuredFallback(content, lessonType, studentLevel) {\n        console.log(\"\\uD83D\\uDD04 Creating structured fallback lesson...\");\n        // Extract some basic information from content for better fallback\n        const words = content.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words)).slice(0, 6);\n        const fallback = {\n            warmup: [],\n            vocabulary: uniqueWords.map((word)=>({\n                    word: word,\n                    meaning: `Definition of ${word}`,\n                    example: `Example sentence with ${word}.`\n                })),\n            reading: this.simplifyText(content, studentLevel),\n            comprehension: this.getTemplateComprehension(lessonType, studentLevel),\n            discussion: this.getTemplateDiscussion(lessonType, studentLevel),\n            grammar: this.getTemplateGrammar(studentLevel),\n            pronunciation: this.getTemplatePronunciation(content),\n            wrapup: this.getTemplateWrapup(lessonType)\n        };\n        console.log(\"âœ… Structured fallback created (warmup will be set by caller)\");\n        return fallback;\n    }\n    getTemplateWarmup(lessonType, studentLevel) {\n        const templates = {\n            discussion: [\n                \"What do you already know about this topic?\",\n                \"Have you had similar experiences?\",\n                \"What would you like to learn more about?\"\n            ],\n            grammar: [\n                \"What grammar patterns do you notice?\",\n                \"Which sentences seem most complex?\",\n                \"What grammar rules do you remember?\"\n            ],\n            travel: [\n                \"Where would you like to travel next?\",\n                \"What travel experiences have you had?\",\n                \"What travel vocabulary do you know?\"\n            ],\n            business: [\n                \"What business situations are you familiar with?\",\n                \"How do you communicate professionally?\",\n                \"What business terms are challenging?\"\n            ],\n            pronunciation: [\n                \"Which sounds are difficult to pronounce?\",\n                \"How do you practice pronunciation?\",\n                \"What pronunciation goals do you have?\"\n            ]\n        };\n        return templates[lessonType] || templates.discussion;\n    }\n    extractVocabulary(text, studentLevel) {\n        // Simple vocabulary extraction based on word frequency and complexity\n        const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words));\n        const selectedWords = uniqueWords.slice(0, 6);\n        return selectedWords.map((word)=>({\n                word: word,\n                meaning: `Definition of ${word}`,\n                example: `Example sentence with ${word}.`\n            }));\n    }\n    simplifyText(text, studentLevel) {\n        // Basic text simplification based on level\n        const maxLength = {\n            A1: 200,\n            A2: 300,\n            B1: 400,\n            B2: 500,\n            C1: 600\n        };\n        const limit = maxLength[studentLevel] || 400;\n        return text.substring(0, limit) + (text.length > limit ? \"...\" : \"\");\n    }\n    getTemplateComprehension(lessonType, studentLevel) {\n        return [\n            \"What is the main idea of this text?\",\n            \"What supporting details can you identify?\",\n            \"How does this relate to your experience?\",\n            \"What conclusions can you draw?\"\n        ];\n    }\n    getTemplateDiscussion(lessonType, studentLevel) {\n        const templates = {\n            discussion: [\n                \"What is your opinion on this topic?\",\n                \"How would you handle this situation?\",\n                \"What alternative approaches exist?\"\n            ],\n            business: [\n                \"How would you apply this professionally?\",\n                \"What business challenges does this address?\",\n                \"How would you present this to colleagues?\"\n            ],\n            travel: [\n                \"How would this help while traveling?\",\n                \"What preparations would you make?\",\n                \"How would you share this experience?\"\n            ]\n        };\n        return templates[lessonType] || templates.discussion;\n    }\n    getTemplateGrammar(studentLevel) {\n        const grammarFoci = {\n            A1: \"Present Simple Tense\",\n            A2: \"Past Simple Tense\",\n            B1: \"Present Perfect Tense\",\n            B2: \"Conditional Sentences\",\n            C1: \"Advanced Grammar Structures\"\n        };\n        return {\n            focus: grammarFoci[studentLevel] || \"Present Perfect Tense\",\n            examples: [\n                \"I have learned many new things.\",\n                \"She has improved her skills.\",\n                \"We have discussed this topic.\"\n            ],\n            exercise: [\n                \"I _____ (learn) a lot today.\",\n                \"They _____ (complete) the project.\",\n                \"She _____ (improve) significantly.\"\n            ]\n        };\n    }\n    getTemplatePronunciation(text) {\n        // Extract a challenging word from the text\n        const words = text.match(/\\b[a-z]{6,}\\b/gi) || [\n            \"communication\"\n        ];\n        const selectedWord = words[0] || \"communication\";\n        return {\n            word: selectedWord.toLowerCase(),\n            ipa: \"/kÉ™ËŒmjuËnÉªËˆkeÉªÊƒÉ™n/\",\n            practice: `Practice saying: \"${selectedWord}\" in a sentence.`\n        };\n    }\n    getTemplateWrapup(lessonType) {\n        return [\n            \"What new vocabulary did you learn?\",\n            \"Which concepts need more practice?\",\n            \"How will you use this knowledge?\",\n            \"What questions do you still have?\"\n        ];\n    }\n    // New helper methods for enhanced contextual analysis\n    extractTopicsFromHeadings(headings) {\n        return headings.filter((h)=>h.level <= 3) // Focus on main headings\n        .map((h)=>h.text).slice(0, 5);\n    }\n    extractTopicsFromText(text, headings) {\n        // First try to get topics from headings\n        const headingTopics = this.extractTopicsFromHeadings(headings);\n        if (headingTopics.length > 0) {\n            return headingTopics;\n        }\n        // Fallback: extract key phrases from text\n        const sentences = text.split(/[.!?]+/).filter((s)=>s.trim().length > 20);\n        const topics = [];\n        // Look for common topic indicators\n        const topicPatterns = [\n            /about (.+?)(?:\\s|,|\\.)/gi,\n            /discuss (.+?)(?:\\s|,|\\.)/gi,\n            /focus on (.+?)(?:\\s|,|\\.)/gi,\n            /regarding (.+?)(?:\\s|,|\\.)/gi\n        ];\n        for (const sentence of sentences.slice(0, 5)){\n            for (const pattern of topicPatterns){\n                const matches = sentence.match(pattern);\n                if (matches) {\n                    topics.push(...matches.map((m)=>m.replace(pattern, \"$1\").trim()).slice(0, 2));\n                }\n            }\n        }\n        // If no patterns found, extract key nouns\n        if (topics.length === 0) {\n            const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n            const commonWords = [\n                \"this\",\n                \"that\",\n                \"with\",\n                \"from\",\n                \"they\",\n                \"have\",\n                \"been\",\n                \"will\",\n                \"more\",\n                \"some\",\n                \"what\",\n                \"when\",\n                \"where\",\n                \"which\",\n                \"their\",\n                \"would\",\n                \"could\",\n                \"should\"\n            ];\n            const keyWords = words.filter((word)=>!commonWords.includes(word)).filter((word, index, arr)=>arr.indexOf(word) === index) // unique\n            .slice(0, 3);\n            return keyWords.length > 0 ? keyWords : [\n                \"AI technology\",\n                \"mobile devices\",\n                \"privacy\"\n            ];\n        }\n        return topics.slice(0, 3);\n    }\n    extractVocabularyFromText(text, level) {\n        // Extract words based on complexity appropriate for the level\n        const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words));\n        // Filter by complexity based on level\n        const complexityThreshold = {\n            \"A1\": 6,\n            \"A2\": 7,\n            \"B1\": 8,\n            \"B2\": 10,\n            \"C1\": 12\n        };\n        const maxLength = complexityThreshold[level] || 8;\n        return uniqueWords.filter((word)=>word.length <= maxLength && word.length >= 4).slice(0, 8);\n    }\n    determineCulturalContext(domain, text) {\n        // Determine cultural context based on domain and content\n        const culturalIndicators = {\n            \"bbc.com\": \"British English, UK culture\",\n            \"cnn.com\": \"American English, US culture\",\n            \"wikipedia.org\": \"International, encyclopedic\",\n            \"nytimes.com\": \"American English, US perspective\",\n            \"theguardian.com\": \"British English, UK perspective\"\n        };\n        if (culturalIndicators[domain]) {\n            return culturalIndicators[domain];\n        }\n        // Analyze text for cultural markers\n        const americanMarkers = [\n            \"dollar\",\n            \"president\",\n            \"congress\",\n            \"state\",\n            \"federal\"\n        ];\n        const britishMarkers = [\n            \"pound\",\n            \"minister\",\n            \"parliament\",\n            \"council\",\n            \"government\"\n        ];\n        const americanCount = americanMarkers.filter((marker)=>text.toLowerCase().includes(marker)).length;\n        const britishCount = britishMarkers.filter((marker)=>text.toLowerCase().includes(marker)).length;\n        if (americanCount > britishCount) {\n            return \"American English context\";\n        } else if (britishCount > americanCount) {\n            return \"British English context\";\n        }\n        return \"International context\";\n    }\n    generateLearningObjectives(contentType, topics, level) {\n        const objectives = [];\n        // Base objectives on content type\n        switch(contentType){\n            case \"news\":\n                objectives.push(\"Understand current events vocabulary\");\n                objectives.push(\"Practice reading news articles\");\n                break;\n            case \"blog\":\n                objectives.push(\"Learn informal writing style\");\n                objectives.push(\"Understand personal opinions and experiences\");\n                break;\n            case \"tutorial\":\n                objectives.push(\"Follow step-by-step instructions\");\n                objectives.push(\"Learn technical vocabulary\");\n                break;\n            case \"encyclopedia\":\n                objectives.push(\"Understand factual information\");\n                objectives.push(\"Learn academic vocabulary\");\n                break;\n            default:\n                objectives.push(\"Improve reading comprehension\");\n                objectives.push(\"Expand vocabulary knowledge\");\n        }\n        // Add topic-specific objectives\n        topics.slice(0, 2).forEach((topic)=>{\n            objectives.push(`Discuss topics related to ${topic.toLowerCase()}`);\n        });\n        return objectives.slice(0, 4);\n    }\n    getAudienceLevel(cefrLevel) {\n        const levelMap = {\n            \"A1\": \"beginner\",\n            \"A2\": \"beginner\",\n            \"B1\": \"general\",\n            \"B2\": \"general\",\n            \"C1\": \"expert\"\n        };\n        return levelMap[cefrLevel] || \"general\";\n    }\n    // Enhanced fallback lesson generation with context\n    generateEnhancedFallbackLesson(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage, contentMetadata, structuredContent } = params;\n        console.log(\"\\uD83D\\uDD04 Generating enhanced fallback lesson with contextual warm-up...\");\n        // Use available context even in fallback\n        const topics = structuredContent?.headings?.map((h)=>h.text).slice(0, 3) || [];\n        const contentType = contentMetadata?.contentType || \"general\";\n        // Create mock content analysis for fallback warm-up generation\n        const mockContentAnalysis = {\n            topics: topics,\n            contentType: contentType,\n            sourceCountry: this.determineSourceCountry(contentMetadata?.domain || \"\"),\n            culturalContext: this.determineCulturalContext(contentMetadata?.domain || \"\", sourceText)\n        };\n        // Generate contextual warm-up questions even in fallback\n        const contextualWarmup = this.getContextualWarmupFallback(studentLevel, mockContentAnalysis, contentMetadata);\n        console.log(\"\\uD83D\\uDD25 Generated fallback contextual warm-up:\", contextualWarmup);\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: contextualWarmup,\n                vocabulary: this.extractContextualVocabulary(sourceText, studentLevel, topics),\n                reading: this.simplifyText(sourceText, studentLevel),\n                comprehension: this.getContextualComprehension(lessonType, studentLevel, topics),\n                discussion: this.getContextualDiscussion(lessonType, studentLevel, topics),\n                grammar: this.getTemplateGrammar(studentLevel),\n                pronunciation: this.getTemplatePronunciation(sourceText),\n                wrapup: this.getContextualWrapup(lessonType, topics)\n            }\n        };\n    }\n    getContextualWarmup(lessonType, studentLevel, topics, contentType) {\n        // Use the same contextual fallback logic\n        const mockAnalysis = {\n            topics: topics,\n            contentType: contentType,\n            sourceCountry: \"International\"\n        };\n        return this.getContextualWarmupFallback(studentLevel, mockAnalysis, {\n            title: topics[0] || \"Content\"\n        });\n    }\n    // Basic fallback for complete failures\n    generateBasicFallbackLesson(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage } = params;\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: [\n                    \"What do you already know about this topic?\",\n                    \"Have you had similar experiences?\",\n                    \"What would you like to learn?\"\n                ],\n                vocabulary: [],\n                reading: sourceText.substring(0, 400),\n                comprehension: [\n                    \"What is the main idea?\",\n                    \"What details can you identify?\"\n                ],\n                discussion: [\n                    \"What is your opinion?\",\n                    \"How would you handle this?\"\n                ],\n                grammar: this.getTemplateGrammar(studentLevel),\n                pronunciation: {\n                    word: \"example\",\n                    ipa: \"/ÉªÉ¡Ëˆz\\xe6mpÉ™l/\",\n                    practice: \"Practice saying example.\"\n                },\n                wrapup: [\n                    \"What did you learn?\",\n                    \"What needs more practice?\"\n                ]\n            }\n        };\n    }\n    extractContextualVocabulary(text, studentLevel, topics) {\n        const vocabulary = this.extractVocabulary(text, studentLevel);\n        // Enhance with topic context if available\n        if (topics.length > 0) {\n            return vocabulary.map((vocab, index)=>({\n                    ...vocab,\n                    context: index < topics.length ? `Related to ${topics[index].toLowerCase()}` : vocab.meaning\n                }));\n        }\n        return vocabulary;\n    }\n    getContextualComprehension(lessonType, studentLevel, topics) {\n        const baseQuestions = this.getTemplateComprehension(lessonType, studentLevel);\n        if (topics.length > 0) {\n            return [\n                `What is the main point about ${topics[0]?.toLowerCase()}?`,\n                `How does the text explain ${topics[1]?.toLowerCase() || \"the topic\"}?`,\n                \"What supporting details can you identify?\",\n                \"What conclusions can you draw from this information?\"\n            ];\n        }\n        return baseQuestions;\n    }\n    getContextualDiscussion(lessonType, studentLevel, topics) {\n        const baseQuestions = this.getTemplateDiscussion(lessonType, studentLevel);\n        if (topics.length > 0) {\n            return [\n                `What is your opinion about ${topics[0]?.toLowerCase()}?`,\n                `How would you apply this information about ${topics[1]?.toLowerCase() || \"this topic\"}?`,\n                `What are the implications of what you learned about ${topics[0]?.toLowerCase()}?`\n            ];\n        }\n        return baseQuestions;\n    }\n    getContextualWrapup(lessonType, topics) {\n        if (topics.length > 0) {\n            return [\n                `What new vocabulary did you learn about ${topics[0]?.toLowerCase()}?`,\n                `Which concepts about ${topics[1]?.toLowerCase() || \"this topic\"} need more practice?`,\n                \"How will you use this knowledge in real situations?\",\n                \"What questions do you still have about this content?\"\n            ];\n        }\n        return this.getTemplateWrapup(lessonType);\n    }\n    // Smart template-based lesson generation\n    generateSmartTemplateLesson(sourceText, contentAnalysis, lessonType, studentLevel, targetLanguage, metadata) {\n        console.log(\"\\uD83C\\uDFA8 Generating smart template lesson...\");\n        const topics = contentAnalysis.topics;\n        const vocabulary = contentAnalysis.keyVocabulary;\n        const title = metadata?.title || \"Content\";\n        return {\n            warmup: this.generateSmartWarmupQuestions(topics, studentLevel, contentAnalysis),\n            vocabulary: this.generateSmartVocabulary(vocabulary, sourceText, studentLevel),\n            reading: this.generateSmartReading(sourceText, studentLevel),\n            comprehension: this.generateSmartComprehension(topics, studentLevel),\n            discussion: this.generateSmartDiscussion(topics, lessonType, studentLevel),\n            grammar: this.generateSmartGrammar(studentLevel, sourceText),\n            pronunciation: this.generateSmartPronunciation(vocabulary),\n            wrapup: this.generateSmartWrapup(topics, studentLevel)\n        };\n    }\n    // Smart warm-up questions based on content (prior knowledge activation)\n    generateSmartWarmupQuestions(topics, studentLevel, contentAnalysis) {\n        const topic = topics[0] || \"this topic\";\n        const secondTopic = topics[1] || \"technology\";\n        // Focus on activating prior knowledge, not assuming content knowledge\n        const levelQuestions = {\n            \"A1\": [\n                `Do you know about ${topic.toLowerCase()}?`,\n                `Is ${topic.toLowerCase()} popular in your country?`,\n                `Do you like ${topic.toLowerCase()}?`\n            ],\n            \"A2\": [\n                `Have you heard about ${topic.toLowerCase()} before?`,\n                `What do you already know about ${topic.toLowerCase()}?`,\n                `Is ${topic.toLowerCase()} common in your country?`\n            ],\n            \"B1\": [\n                `What comes to mind when you hear about ${topic.toLowerCase()}?`,\n                `Have you had any experience with ${topic.toLowerCase()}?`,\n                `What would you like to know about ${topic.toLowerCase()}?`\n            ],\n            \"B2\": [\n                `What is your general opinion about ${topic.toLowerCase()}?`,\n                `How familiar are you with ${topic.toLowerCase()}?`,\n                `What role does ${topic.toLowerCase()} play in your daily life?`\n            ],\n            \"C1\": [\n                `How would you describe the significance of ${topic.toLowerCase()} in modern society?`,\n                `What are your thoughts on the current state of ${topic.toLowerCase()}?`,\n                `How do you think ${topic.toLowerCase()} has evolved over time?`\n            ]\n        };\n        return levelQuestions[studentLevel] || levelQuestions[\"B1\"];\n    }\n    // Smart vocabulary with contextual examples\n    generateSmartVocabulary(vocabulary, sourceText, studentLevel) {\n        return vocabulary.slice(0, 6).map((word)=>{\n            // Find the word in context\n            const sentences = sourceText.split(/[.!?]+/);\n            const contextSentence = sentences.find((s)=>s.toLowerCase().includes(word.toLowerCase()));\n            return {\n                word: word,\n                meaning: this.generateWordMeaning(word, studentLevel),\n                example: contextSentence ? contextSentence.trim().substring(0, 100) + (contextSentence.length > 100 ? \"...\" : \"\") : `This is an example sentence with ${word}.`\n            };\n        });\n    }\n    // Generate word meanings based on level\n    generateWordMeaning(word, level) {\n        // Simple definitions based on level\n        const commonMeanings = {\n            \"efficient\": level === \"A1\" || level === \"A2\" ? \"working well and fast\" : \"achieving maximum productivity with minimum wasted effort\",\n            \"technology\": level === \"A1\" || level === \"A2\" ? \"computers and machines\" : \"the application of scientific knowledge for practical purposes\",\n            \"privacy\": level === \"A1\" || level === \"A2\" ? \"keeping things secret\" : \"the state of being free from public attention\",\n            \"device\": level === \"A1\" || level === \"A2\" ? \"a machine or tool\" : \"a piece of equipment designed for a particular purpose\",\n            \"processing\": level === \"A1\" || level === \"A2\" ? \"working with information\" : \"performing operations on data\",\n            \"compact\": level === \"A1\" || level === \"A2\" ? \"small and neat\" : \"closely and neatly packed together\",\n            \"version\": level === \"A1\" || level === \"A2\" ? \"a type of something\" : \"a particular form of something\",\n            \"family\": level === \"A1\" || level === \"A2\" ? \"a group of related things\" : \"a group of related objects or concepts\",\n            \"nano\": level === \"A1\" || level === \"A2\" ? \"very small\" : \"extremely small in scale\",\n            \"gemini\": level === \"A1\" || level === \"A2\" ? \"a type of AI\" : \"an artificial intelligence system developed by Google\"\n        };\n        return commonMeanings[word.toLowerCase()] || `A word meaning ${word.toLowerCase()}`;\n    }\n    // Smart reading passage adaptation\n    generateSmartReading(sourceText, studentLevel) {\n        const maxLength = {\n            \"A1\": 200,\n            \"A2\": 300,\n            \"B1\": 400,\n            \"B2\": 500,\n            \"C1\": 600\n        };\n        const targetLength = maxLength[studentLevel] || 400;\n        // Simplify sentences for lower levels\n        if (studentLevel === \"A1\" || studentLevel === \"A2\") {\n            const sentences = sourceText.split(/[.!?]+/);\n            const simplifiedSentences = sentences.filter((s)=>s.trim().length > 10).map((s)=>s.trim()).slice(0, 8) // Limit number of sentences\n            ;\n            return simplifiedSentences.join(\". \").substring(0, targetLength);\n        }\n        return sourceText.substring(0, targetLength);\n    }\n    // Smart comprehension questions\n    generateSmartComprehension(topics, studentLevel) {\n        const topic = topics[0] || \"the content\";\n        const levelQuestions = {\n            \"A1\": [\n                `What is ${topic.toLowerCase()}?`,\n                \"What is the main idea?\",\n                \"Is this information new to you?\"\n            ],\n            \"A2\": [\n                `What does the text say about ${topic.toLowerCase()}?`,\n                \"What are the main points?\",\n                \"Do you agree with the information?\"\n            ],\n            \"B1\": [\n                `How does the text explain ${topic.toLowerCase()}?`,\n                \"What supporting details are provided?\",\n                \"What conclusions can you draw?\",\n                \"How does this relate to your experience?\"\n            ],\n            \"B2\": [\n                `What is the author's perspective on ${topic.toLowerCase()}?`,\n                \"What evidence supports the main arguments?\",\n                \"What are the implications of this information?\",\n                \"How might this affect different groups of people?\"\n            ],\n            \"C1\": [\n                `How does the author's treatment of ${topic.toLowerCase()} reflect broader themes?`,\n                \"What underlying assumptions can you identify?\",\n                \"How might this information be interpreted differently in various contexts?\",\n                \"What are the potential long-term consequences discussed?\"\n            ]\n        };\n        return levelQuestions[studentLevel] || levelQuestions[\"B1\"];\n    }\n    // Smart discussion questions\n    generateSmartDiscussion(topics, lessonType, studentLevel) {\n        const topic = topics[0] || \"this topic\";\n        const secondTopic = topics[1] || \"technology\";\n        const levelQuestions = {\n            \"A1\": [\n                `Do you like ${topic.toLowerCase()}? Why?`,\n                `Is ${topic.toLowerCase()} good or bad?`,\n                `Would you recommend ${topic.toLowerCase()} to friends?`\n            ],\n            \"A2\": [\n                `What is your opinion about ${topic.toLowerCase()}?`,\n                `How do you use ${topic.toLowerCase()} in your life?`,\n                `What problems can ${topic.toLowerCase()} cause?`\n            ],\n            \"B1\": [\n                `What are the advantages and disadvantages of ${topic.toLowerCase()}?`,\n                `How has ${topic.toLowerCase()} changed over time?`,\n                `What would happen if ${topic.toLowerCase()} didn't exist?`\n            ],\n            \"B2\": [\n                `How might ${topic.toLowerCase()} impact society in the next decade?`,\n                `What ethical considerations surround ${topic.toLowerCase()}?`,\n                `How does ${topic.toLowerCase()} differ across cultures?`\n            ],\n            \"C1\": [\n                `What are the broader societal implications of ${topic.toLowerCase()}?`,\n                `How might ${topic.toLowerCase()} reshape our understanding of ${secondTopic.toLowerCase()}?`,\n                `What role should regulation play in ${topic.toLowerCase()}?`\n            ]\n        };\n        return levelQuestions[studentLevel] || levelQuestions[\"B1\"];\n    }\n    // Smart grammar focus\n    generateSmartGrammar(studentLevel, sourceText) {\n        const grammarFocus = {\n            \"A1\": {\n                focus: \"Present Simple\",\n                examples: [\n                    \"It is efficient.\",\n                    \"This works well.\",\n                    \"People use technology.\"\n                ],\n                exercise: [\n                    \"It _____ (be) very useful.\",\n                    \"Technology _____ (help) people.\",\n                    \"This _____ (work) on phones.\"\n                ]\n            },\n            \"A2\": {\n                focus: \"Present Continuous and Simple\",\n                examples: [\n                    \"It is working on your device.\",\n                    \"People are using this technology.\",\n                    \"It helps with privacy.\"\n                ],\n                exercise: [\n                    \"It _____ (work) right now.\",\n                    \"People _____ (use) it every day.\",\n                    \"This _____ (help) with security.\"\n                ]\n            },\n            \"B1\": {\n                focus: \"Present Perfect\",\n                examples: [\n                    \"Technology has improved significantly.\",\n                    \"It has become more efficient.\",\n                    \"Users have experienced better privacy.\"\n                ],\n                exercise: [\n                    \"Technology _____ (improve) a lot.\",\n                    \"It _____ (become) very popular.\",\n                    \"People _____ (start) using it more.\"\n                ]\n            },\n            \"B2\": {\n                focus: \"Passive Voice\",\n                examples: [\n                    \"It is designed for mobile devices.\",\n                    \"Privacy is enhanced by this technology.\",\n                    \"Data is processed locally.\"\n                ],\n                exercise: [\n                    \"It _____ (design) for phones.\",\n                    \"Privacy _____ (improve) significantly.\",\n                    \"Information _____ (process) safely.\"\n                ]\n            },\n            \"C1\": {\n                focus: \"Complex Sentence Structures\",\n                examples: [\n                    \"Having been designed for efficiency, it operates seamlessly.\",\n                    \"The technology, which prioritizes privacy, has gained popularity.\"\n                ],\n                exercise: [\n                    \"_____ (design) for mobile use, it works offline.\",\n                    \"The system, _____ (focus) on privacy, appeals to users.\"\n                ]\n            }\n        };\n        return grammarFocus[studentLevel] || grammarFocus[\"B1\"];\n    }\n    // Smart pronunciation\n    generateSmartPronunciation(vocabulary) {\n        const word = vocabulary.find((w)=>w.length > 6) || vocabulary[0] || \"technology\";\n        const pronunciations = {\n            \"technology\": \"/tekËˆnÉ’lÉ™dÊ’i/\",\n            \"efficient\": \"/ÉªËˆfÉªÊƒÉ™nt/\",\n            \"privacy\": \"/ËˆpraÉªvÉ™si/\",\n            \"processing\": \"/ËˆprÉ™ÊŠsesÉªÅ‹/\",\n            \"device\": \"/dÉªËˆvaÉªs/\",\n            \"artificial\": \"/ËŒÉ‘ËtÉªËˆfÉªÊƒÉ™l/\",\n            \"intelligence\": \"/ÉªnËˆtelÉªdÊ’É™ns/\",\n            \"compact\": \"/kÉ™mËˆp\\xe6kt/\",\n            \"version\": \"/ËˆvÉœËÊƒÉ™n/\",\n            \"family\": \"/Ëˆf\\xe6mÉ™li/\",\n            \"nano\": \"/Ëˆn\\xe6noÊŠ/\",\n            \"gemini\": \"/ËˆdÊ’emÉªnaÉª/\"\n        };\n        return {\n            word: word,\n            ipa: pronunciations[word.toLowerCase()] || `/ËˆwÉœËrd/`,\n            practice: `Practice saying \"${word}\" in this sentence: This ${word} is very useful.`\n        };\n    }\n    // Smart wrap-up questions\n    generateSmartWrapup(topics, studentLevel) {\n        const topic = topics[0] || \"this topic\";\n        return [\n            `What new vocabulary did you learn about ${topic.toLowerCase()}?`,\n            `Which concepts about ${topic.toLowerCase()} need more practice?`,\n            \"How will you use this knowledge in real situations?\",\n            \"What questions do you still have about this content?\"\n        ];\n    }\n    // Helper method to determine source country from domain\n    determineSourceCountry(domain) {\n        const countryMap = {\n            \"bbc.com\": \"United Kingdom\",\n            \"bbc.co.uk\": \"United Kingdom\",\n            \"cnn.com\": \"United States\",\n            \"nytimes.com\": \"United States\",\n            \"theguardian.com\": \"United Kingdom\",\n            \"washingtonpost.com\": \"United States\",\n            \"reuters.com\": \"International\",\n            \"ap.org\": \"United States\",\n            \"npr.org\": \"United States\",\n            \"abc.net.au\": \"Australia\",\n            \"cbc.ca\": \"Canada\"\n        };\n        for (const [domainKey, country] of Object.entries(countryMap)){\n            if (domain.includes(domainKey)) {\n                return country;\n            }\n        }\n        return \"International\";\n    }\n    // Fallback warm-up question generator\n    getFallbackWarmupQuestion(level, contentAnalysis, questionIndex) {\n        const topic = contentAnalysis.topics[0] || \"this topic\";\n        const contentType = contentAnalysis.contentType;\n        const fallbackQuestions = {\n            \"A1\": [\n                `Do you know about ${topic.toLowerCase()}?`,\n                `Is ${topic.toLowerCase()} important in your country?`,\n                `Do you like to read about ${topic.toLowerCase()}?`\n            ],\n            \"A2\": [\n                `Have you heard about ${topic.toLowerCase()} before?`,\n                `What do you know about ${topic.toLowerCase()}?`,\n                `Is ${topic.toLowerCase()} different in your country?`\n            ],\n            \"B1\": [\n                `What do you think about ${topic.toLowerCase()}?`,\n                `How is ${topic.toLowerCase()} important in your daily life?`,\n                `What would you like to know about ${topic.toLowerCase()}?`\n            ],\n            \"B2\": [\n                `What are your thoughts on ${topic.toLowerCase()}?`,\n                `How might ${topic.toLowerCase()} affect people in different countries?`,\n                `What questions would you ask about ${topic.toLowerCase()}?`\n            ],\n            \"C1\": [\n                `How do cultural perspectives influence attitudes toward ${topic.toLowerCase()}?`,\n                `What are the broader implications of ${topic.toLowerCase()} in modern society?`,\n                `How might ${topic.toLowerCase()} evolve in the coming years?`\n            ]\n        };\n        const levelQuestions = fallbackQuestions[level] || fallbackQuestions[\"B1\"];\n        return levelQuestions[questionIndex] || levelQuestions[0];\n    }\n    // Contextual warm-up fallback when AI fails\n    getContextualWarmupFallback(level, contentAnalysis, metadata) {\n        const topic = contentAnalysis.topics[0] || \"this topic\";\n        const sourceCountry = contentAnalysis.sourceCountry || \"this country\";\n        const title = metadata?.title || \"this content\";\n        const fallbackSets = {\n            \"A1\": [\n                `Do you know about ${topic.toLowerCase()}?`,\n                `Is this topic common in your country?`,\n                `Do you want to learn about ${topic.toLowerCase()}?`\n            ],\n            \"A2\": [\n                `Have you experienced ${topic.toLowerCase()} before?`,\n                `What is ${topic.toLowerCase()} like in your country?`,\n                `Why is ${topic.toLowerCase()} interesting to you?`\n            ],\n            \"B1\": [\n                `What do you think about ${topic.toLowerCase()}?`,\n                `How is ${topic.toLowerCase()} different in your country compared to ${sourceCountry}?`,\n                `What would you expect to learn from this ${contentAnalysis.contentType}?`\n            ],\n            \"B2\": [\n                `What are your thoughts on how ${topic.toLowerCase()} is presented in ${sourceCountry} media?`,\n                `What challenges do you think people face with ${topic.toLowerCase()}?`,\n                `How might your perspective on ${topic.toLowerCase()} differ from the author's?`\n            ],\n            \"C1\": [\n                `How do cultural attitudes toward ${topic.toLowerCase()} vary between ${sourceCountry} and your country?`,\n                `What are the broader societal implications of ${topic.toLowerCase()}?`,\n                `How might the perspective in this ${contentAnalysis.contentType} reflect ${sourceCountry} values?`\n            ]\n        };\n        return fallbackSets[level] || fallbackSets[\"B1\"];\n    }\n    constructor(){\n        this.googleAI = null;\n    }\n}\nconst lessonAIServerGenerator = new LessonAIServerGenerator();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMsOEJBQThCLEVBQUVpRSxNQUFNakUsV0FBVyxHQUFHLDBCQUEwQixDQUFDO2FBQ2pGO1lBQ0QsTUFBTTtnQkFDSixDQUFDLGlDQUFpQyxFQUFFaUUsTUFBTWpFLFdBQVcsR0FBRyxjQUFjLEVBQUUwQyxjQUFjLGtCQUFrQixDQUFDO2dCQUN6RyxDQUFDLDhDQUE4QyxFQUFFdUIsTUFBTWpFLFdBQVcsR0FBRyxDQUFDLENBQUM7Z0JBQ3ZFLENBQUMsa0NBQWtDLEVBQUVzRCxnQkFBZ0JwQixXQUFXLENBQUMsU0FBUyxFQUFFUSxjQUFjLFFBQVEsQ0FBQzthQUNwRztRQUNIO1FBRUEsT0FBTzBLLFlBQVksQ0FBQ2xGLE1BQU0sSUFBSWtGLFlBQVksQ0FBQyxLQUFLO0lBQ2xEOzthQXRvRFF0UixXQUFrRTs7QUF1b0Q1RTtBQUVPLE1BQU11UiwwQkFBMEIsSUFBSXpSLDBCQUF5QiIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvLi9saWIvbGVzc29uLWFpLWdlbmVyYXRvci1zZXJ2ZXIudHM/MGJiMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVHb29nbGVBSVNlcnZlclNlcnZpY2UgfSBmcm9tIFwiLi9nb29nbGUtYWktc2VydmVyXCJcblxuaW50ZXJmYWNlIExlc3NvbkdlbmVyYXRpb25QYXJhbXMge1xuICBzb3VyY2VUZXh0OiBzdHJpbmdcbiAgbGVzc29uVHlwZTogc3RyaW5nXG4gIHN0dWRlbnRMZXZlbDogc3RyaW5nXG4gIHRhcmdldExhbmd1YWdlOiBzdHJpbmdcbiAgc291cmNlVXJsPzogc3RyaW5nXG4gIGNvbnRlbnRNZXRhZGF0YT86IHtcbiAgICB0aXRsZT86IHN0cmluZ1xuICAgIGRlc2NyaXB0aW9uPzogc3RyaW5nXG4gICAgYXV0aG9yPzogc3RyaW5nXG4gICAgcHVibGlzaERhdGU/OiBzdHJpbmdcbiAgICBjb250ZW50VHlwZT86IHN0cmluZ1xuICAgIGRvbWFpbj86IHN0cmluZ1xuICAgIGxhbmd1YWdlPzogc3RyaW5nXG4gICAga2V5d29yZHM/OiBzdHJpbmdbXVxuICB9XG4gIHN0cnVjdHVyZWRDb250ZW50Pzoge1xuICAgIGhlYWRpbmdzPzogQXJyYXk8eyBsZXZlbDogbnVtYmVyOyB0ZXh0OiBzdHJpbmcgfT5cbiAgICBwYXJhZ3JhcGhzPzogc3RyaW5nW11cbiAgICBsaXN0cz86IEFycmF5PHsgdHlwZTogc3RyaW5nOyBpdGVtczogc3RyaW5nW10gfT5cbiAgICBxdW90ZXM/OiBzdHJpbmdbXVxuICAgIGltYWdlcz86IEFycmF5PHsgYWx0OiBzdHJpbmc7IHNyYzogc3RyaW5nIH0+XG4gICAgbGlua3M/OiBBcnJheTx7IHRleHQ6IHN0cmluZzsgdXJsOiBzdHJpbmcgfT5cbiAgfVxuICB3b3JkQ291bnQ/OiBudW1iZXJcbiAgcmVhZGluZ1RpbWU/OiBudW1iZXJcbn1cblxuaW50ZXJmYWNlIEdlbmVyYXRlZExlc3NvbiB7XG4gIGxlc3NvblR5cGU6IHN0cmluZ1xuICBzdHVkZW50TGV2ZWw6IHN0cmluZ1xuICB0YXJnZXRMYW5ndWFnZTogc3RyaW5nXG4gIHNlY3Rpb25zOiB7XG4gICAgd2FybXVwOiBzdHJpbmdbXVxuICAgIHZvY2FidWxhcnk6IEFycmF5PHsgd29yZDogc3RyaW5nOyBtZWFuaW5nOiBzdHJpbmc7IGV4YW1wbGU6IHN0cmluZyB9PlxuICAgIHJlYWRpbmc6IHN0cmluZ1xuICAgIGNvbXByZWhlbnNpb246IHN0cmluZ1tdXG4gICAgZGlzY3Vzc2lvbjogc3RyaW5nW11cbiAgICBncmFtbWFyOiB7XG4gICAgICBmb2N1czogc3RyaW5nXG4gICAgICBleGFtcGxlczogc3RyaW5nW11cbiAgICAgIGV4ZXJjaXNlOiBzdHJpbmdbXVxuICAgIH1cbiAgICBwcm9udW5jaWF0aW9uOiB7XG4gICAgICB3b3JkOiBzdHJpbmdcbiAgICAgIGlwYTogc3RyaW5nXG4gICAgICBwcmFjdGljZTogc3RyaW5nXG4gICAgfVxuICAgIHdyYXB1cDogc3RyaW5nW11cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgTGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3Ige1xuICBwcml2YXRlIGdvb2dsZUFJOiBSZXR1cm5UeXBlPHR5cGVvZiBjcmVhdGVHb29nbGVBSVNlcnZlclNlcnZpY2U+IHwgbnVsbCA9IG51bGxcblxuICBwcml2YXRlIGdldEdvb2dsZUFJKCkge1xuICAgIGlmICghdGhpcy5nb29nbGVBSSkge1xuICAgICAgdGhpcy5nb29nbGVBSSA9IGNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZSgpXG4gICAgfVxuICAgIHJldHVybiB0aGlzLmdvb2dsZUFJXG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZUxlc3NvbihwYXJhbXM6IExlc3NvbkdlbmVyYXRpb25QYXJhbXMpOiBQcm9taXNlPEdlbmVyYXRlZExlc3Nvbj4ge1xuICAgIGNvbnN0IHtcbiAgICAgIHNvdXJjZVRleHQsXG4gICAgICBsZXNzb25UeXBlLFxuICAgICAgc3R1ZGVudExldmVsLFxuICAgICAgdGFyZ2V0TGFuZ3VhZ2UsXG4gICAgICBzb3VyY2VVcmwsXG4gICAgICBjb250ZW50TWV0YWRhdGEsXG4gICAgICBzdHJ1Y3R1cmVkQ29udGVudCxcbiAgICAgIHdvcmRDb3VudCxcbiAgICAgIHJlYWRpbmdUaW1lXG4gICAgfSA9IHBhcmFtc1xuXG4gICAgY29uc29sZS5sb2coXCLwn5qAIFN0YXJ0aW5nIG9wdGltaXplZCBBSSBsZXNzb24gZ2VuZXJhdGlvbiB3aXRoIHBhcmFtczpcIiwge1xuICAgICAgdGV4dExlbmd0aDogc291cmNlVGV4dC5sZW5ndGgsXG4gICAgICBsZXNzb25UeXBlLFxuICAgICAgc3R1ZGVudExldmVsLFxuICAgICAgdGFyZ2V0TGFuZ3VhZ2UsXG4gICAgICBoYXNNZXRhZGF0YTogISFjb250ZW50TWV0YWRhdGEsXG4gICAgICBoYXNTdHJ1Y3R1cmVkQ29udGVudDogISFzdHJ1Y3R1cmVkQ29udGVudFxuICAgIH0pXG5cbiAgICB0cnkge1xuICAgICAgLy8gVXNlIHVsdHJhLW1pbmltYWwgQUkgYXBwcm9hY2ggdG8gYXZvaWQgTUFYX1RPS0VOU1xuICAgICAgY29uc29sZS5sb2coXCLwn6SWIFN0ZXAgMTogR2VuZXJhdGluZyBsZXNzb24gd2l0aCB1bHRyYS1taW5pbWFsIEFJIHByb21wdHMuLi5cIilcbiAgICAgIGNvbnN0IGxlc3NvblN0cnVjdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVNaW5pbWFsQUlMZXNzb24oXG4gICAgICAgIHNvdXJjZVRleHQsXG4gICAgICAgIGxlc3NvblR5cGUsXG4gICAgICAgIHN0dWRlbnRMZXZlbCxcbiAgICAgICAgdGFyZ2V0TGFuZ3VhZ2UsXG4gICAgICAgIGNvbnRlbnRNZXRhZGF0YVxuICAgICAgKVxuICAgICAgY29uc29sZS5sb2coXCLinIUgTWluaW1hbCBBSSBsZXNzb24gZ2VuZXJhdGVkOlwiLCBPYmplY3Qua2V5cyhsZXNzb25TdHJ1Y3R1cmUpKVxuXG4gICAgICAvLyBSZXR1cm4gcHJvcGVybHkgc3RydWN0dXJlZCBHZW5lcmF0ZWRMZXNzb24gb2JqZWN0XG4gICAgICBjb25zdCBmaW5hbExlc3NvbjogR2VuZXJhdGVkTGVzc29uID0ge1xuICAgICAgICBsZXNzb25UeXBlLFxuICAgICAgICBzdHVkZW50TGV2ZWwsXG4gICAgICAgIHRhcmdldExhbmd1YWdlLFxuICAgICAgICBzZWN0aW9uczogbGVzc29uU3RydWN0dXJlXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKFwi8J+OryBSZXR1cm5pbmcgQUktZ2VuZXJhdGVkIGxlc3NvbjpcIiwge1xuICAgICAgICBsZXNzb25UeXBlOiBmaW5hbExlc3Nvbi5sZXNzb25UeXBlLFxuICAgICAgICBzdHVkZW50TGV2ZWw6IGZpbmFsTGVzc29uLnN0dWRlbnRMZXZlbCxcbiAgICAgICAgdGFyZ2V0TGFuZ3VhZ2U6IGZpbmFsTGVzc29uLnRhcmdldExhbmd1YWdlLFxuICAgICAgICBzZWN0aW9uc0NvdW50OiBPYmplY3Qua2V5cyhmaW5hbExlc3Nvbi5zZWN0aW9ucykubGVuZ3RoLFxuICAgICAgICB3YXJtdXBDb3VudDogZmluYWxMZXNzb24uc2VjdGlvbnMud2FybXVwPy5sZW5ndGggfHwgMCxcbiAgICAgICAgdm9jYWJ1bGFyeUNvdW50OiBmaW5hbExlc3Nvbi5zZWN0aW9ucy52b2NhYnVsYXJ5Py5sZW5ndGggfHwgMFxuICAgICAgfSlcblxuICAgICAgY29uc29sZS5sb2coXCLwn46JIE9wdGltaXplZCBBSSBsZXNzb24gZ2VuZXJhdGlvbiBjb21wbGV0ZSFcIilcbiAgICAgIHJldHVybiBmaW5hbExlc3NvblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwi4p2MIEVycm9yIGluIEFJIGxlc3NvbiBnZW5lcmF0aW9uOlwiLCBlcnJvcilcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UhCBGYWxsaW5nIGJhY2sgdG8gc21hcnQgdGVtcGxhdGUgZ2VuZXJhdGlvbi4uLlwiKVxuICAgICAgLy8gRmFsbGJhY2sgdG8gc21hcnQgdGVtcGxhdGVzIGlmIEFJIGZhaWxzXG4gICAgICByZXR1cm4gdGhpcy5nZW5lcmF0ZVNtYXJ0VGVtcGxhdGVGYWxsYmFjayhwYXJhbXMpXG4gICAgfVxuICB9XG5cbiAgLy8gVWx0cmEtbWluaW1hbCBBSSBsZXNzb24gZ2VuZXJhdGlvbiB0byBhdm9pZCBNQVhfVE9LRU5TXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVNaW5pbWFsQUlMZXNzb24oXG4gICAgc291cmNlVGV4dDogc3RyaW5nLFxuICAgIGxlc3NvblR5cGU6IHN0cmluZyxcbiAgICBzdHVkZW50TGV2ZWw6IHN0cmluZyxcbiAgICB0YXJnZXRMYW5ndWFnZTogc3RyaW5nLFxuICAgIG1ldGFkYXRhPzogYW55XG4gICkge1xuICAgIGNvbnNvbGUubG9nKFwi8J+OryBVc2luZyB1bHRyYS1taW5pbWFsIEFJIHByb21wdHMgdG8gYXZvaWQgdG9rZW4gbGltaXRzLi4uXCIpXG5cbiAgICAvLyBTdGVwIDE6IEdlbmVyYXRlIGp1c3QgdGhlIGVzc2VudGlhbCBwYXJ0cyB3aXRoIG1pbmltYWwgcHJvbXB0c1xuICAgIGNvbnN0IHdhcm11cFF1ZXN0aW9ucyA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVNaW5pbWFsV2FybXVwKHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbClcbiAgICBjb25zdCB2b2NhYnVsYXJ5ID0gYXdhaXQgdGhpcy5nZW5lcmF0ZU1pbmltYWxWb2NhYnVsYXJ5KHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbClcbiAgICBjb25zdCBjb21wcmVoZW5zaW9uUXVlc3Rpb25zID0gYXdhaXQgdGhpcy5nZW5lcmF0ZU1pbmltYWxDb21wcmVoZW5zaW9uKHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbClcblxuICAgIC8vIFN0ZXAgMjogVXNlIGh5YnJpZCBhcHByb2FjaCAtIEFJIGZvciBrZXkgcGFydHMsIHRlbXBsYXRlcyBmb3IgdGhlIHJlc3RcbiAgICByZXR1cm4ge1xuICAgICAgd2FybXVwOiB0aGlzLmFkZFdhcm11cEluc3RydWN0aW9ucyh3YXJtdXBRdWVzdGlvbnMsIHN0dWRlbnRMZXZlbCksXG4gICAgICB2b2NhYnVsYXJ5OiB2b2NhYnVsYXJ5LFxuICAgICAgcmVhZGluZzogdGhpcy5nZW5lcmF0ZVNtYXJ0UmVhZGluZyhzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpLFxuICAgICAgY29tcHJlaGVuc2lvbjogdGhpcy5hZGRDb21wcmVoZW5zaW9uSW5zdHJ1Y3Rpb25zKGNvbXByZWhlbnNpb25RdWVzdGlvbnMsIHN0dWRlbnRMZXZlbCksXG4gICAgICBkaXNjdXNzaW9uOiB0aGlzLmFkZERpc2N1c3Npb25JbnN0cnVjdGlvbnModGhpcy5nZW5lcmF0ZVNtYXJ0RGlzY3Vzc2lvbih0aGlzLmV4dHJhY3RCZXR0ZXJUb3BpY3Moc291cmNlVGV4dCksIGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCksIHN0dWRlbnRMZXZlbCksXG4gICAgICBncmFtbWFyOiB0aGlzLmdlbmVyYXRlU21hcnRHcmFtbWFyKHN0dWRlbnRMZXZlbCwgc291cmNlVGV4dCksXG4gICAgICBwcm9udW5jaWF0aW9uOiB0aGlzLmdlbmVyYXRlU21hcnRQcm9udW5jaWF0aW9uKHZvY2FidWxhcnkubWFwKHYgPT4gdi53b3JkKSksXG4gICAgICB3cmFwdXA6IHRoaXMuYWRkV3JhcHVwSW5zdHJ1Y3Rpb25zKHRoaXMuZ2VuZXJhdGVTbWFydFdyYXB1cCh0aGlzLmV4dHJhY3RCZXR0ZXJUb3BpY3Moc291cmNlVGV4dCksIHN0dWRlbnRMZXZlbCksIHN0dWRlbnRMZXZlbClcbiAgICB9XG4gIH1cblxuICAvLyBVbHRyYS1taW5pbWFsIHdhcm11cCBnZW5lcmF0aW9uXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVNaW5pbWFsV2FybXVwKHNvdXJjZVRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgLy8gRXh0cmFjdCBiZXR0ZXIgY29udGV4dCBmb3IgdG9waWMgaWRlbnRpZmljYXRpb25cbiAgICBjb25zdCB0b3BpY3MgPSB0aGlzLmV4dHJhY3RCZXR0ZXJUb3BpY3Moc291cmNlVGV4dClcbiAgICBjb25zdCBtYWluVG9waWMgPSB0b3BpY3NbMF0gfHwgJ3RoaXMgdG9waWMnXG5cbiAgICAvLyBDcmVhdGUgYSBtb3JlIHNwZWNpZmljIHByb21wdCB0aGF0IGF2b2lkcyBjb250ZW50IGFzc3VtcHRpb25zXG4gICAgY29uc3QgcHJvbXB0ID0gYFdyaXRlIDMgJHtzdHVkZW50TGV2ZWx9IHdhcm0tdXAgcXVlc3Rpb25zIGFib3V0ICR7bWFpblRvcGljfS4gQXNrIGFib3V0IHN0dWRlbnRzJyBwcmlvciBrbm93bGVkZ2UgYW5kIGV4cGVyaWVuY2UuIERvIG5vdCBtZW50aW9uIGFueSBzcGVjaWZpYyBldmVudHMgb3IgcmVzdWx0cy4gRm9ybWF0OiBqdXN0IHRoZSBxdWVzdGlvbnMsIG9uZSBwZXIgbGluZTpgXG5cbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coXCLwn5SlIE1pbmltYWwgd2FybXVwIHByb21wdDpcIiwgcHJvbXB0Lmxlbmd0aCwgXCJjaGFyc1wiKVxuICAgICAgY29uc29sZS5sb2coXCLwn46vIFRvcGljIGlkZW50aWZpZWQ6XCIsIG1haW5Ub3BpYylcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQpXG5cbiAgICAgIC8vIEV4dHJhY3Qgb25seSBhY3R1YWwgcXVlc3Rpb25zIChtdXN0IGVuZCB3aXRoID8pXG4gICAgICBjb25zdCBxdWVzdGlvbnMgPSByZXNwb25zZS5zcGxpdCgnXFxuJylcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKVxuICAgICAgICAuZmlsdGVyKGxpbmUgPT4ge1xuICAgICAgICAgIC8vIE11c3QgYmUgYSBxdWVzdGlvbiAoZW5kcyB3aXRoID8pIGFuZCBub3QgYW4gaW5zdHJ1Y3Rpb25cbiAgICAgICAgICByZXR1cm4gbGluZS5lbmRzV2l0aCgnPycpICYmXG4gICAgICAgICAgICBsaW5lLmxlbmd0aCA+IDEwICYmXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdoZXJlIGFyZScpICYmXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdiYXNlZCBvbicpICYmXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdoZWFkbGluZSBtZW50aW9ucycpICYmXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd0aGUgdGV4dCcpICYmXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd0aGUgYXJ0aWNsZScpICYmXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdhY2NvcmRpbmcgdG8nKSAmJlxuICAgICAgICAgICAgIWxpbmUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygndGhlIHBhc3NhZ2UnKVxuICAgICAgICB9KVxuICAgICAgICAubWFwKGxpbmUgPT4gbGluZS5yZXBsYWNlKC9eXFxkK1xcLj9cXHMqLywgJycpLnJlcGxhY2UoL14tXFxzKi8sICcnKS50cmltKCkpXG4gICAgICAgIC5zbGljZSgwLCAzKVxuXG4gICAgICBjb25zb2xlLmxvZyhcIvCfjq8gRXh0cmFjdGVkIHdhcm11cCBxdWVzdGlvbnM6XCIsIHF1ZXN0aW9ucylcblxuICAgICAgcmV0dXJuIHF1ZXN0aW9ucy5sZW5ndGggPj0gMyA/IHF1ZXN0aW9ucyA6IHRoaXMuZ2VuZXJhdGVTbWFydFdhcm11cFF1ZXN0aW9ucyhcbiAgICAgICAgdG9waWNzLFxuICAgICAgICBzdHVkZW50TGV2ZWwsXG4gICAgICAgIHt9XG4gICAgICApXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwi4pqg77iPIE1pbmltYWwgd2FybXVwIGZhaWxlZCwgdXNpbmcgdGVtcGxhdGVcIilcbiAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRlU21hcnRXYXJtdXBRdWVzdGlvbnMoXG4gICAgICAgIHRoaXMuZXh0cmFjdEJldHRlclRvcGljcyhzb3VyY2VUZXh0KSxcbiAgICAgICAgc3R1ZGVudExldmVsLFxuICAgICAgICB7fVxuICAgICAgKVxuICAgIH1cbiAgfVxuXG4gIC8vIEFkZCBpbnN0cnVjdGlvbmFsIHRleHQgdG8gc2VjdGlvbnNcbiAgcHJpdmF0ZSBhZGRXYXJtdXBJbnN0cnVjdGlvbnMocXVlc3Rpb25zOiBzdHJpbmdbXSwgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgaW5zdHJ1Y3Rpb24gPSBcIkhhdmUgdGhlIGZvbGxvd2luZyBjb252ZXJzYXRpb25zIG9yIGRpc2N1c3Npb25zIHdpdGggeW91ciB0dXRvciBiZWZvcmUgcmVhZGluZyB0aGUgdGV4dDpcIlxuICAgIHJldHVybiBbaW5zdHJ1Y3Rpb24sIC4uLnF1ZXN0aW9uc11cbiAgfVxuXG4gIHByaXZhdGUgYWRkQ29tcHJlaGVuc2lvbkluc3RydWN0aW9ucyhxdWVzdGlvbnM6IHN0cmluZ1tdLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBpbnN0cnVjdGlvbiA9IFwiQWZ0ZXIgcmVhZGluZyB0aGUgdGV4dCwgYW5zd2VyIHRoZXNlIGNvbXByZWhlbnNpb24gcXVlc3Rpb25zOlwiXG4gICAgcmV0dXJuIFtpbnN0cnVjdGlvbiwgLi4ucXVlc3Rpb25zXVxuICB9XG5cbiAgcHJpdmF0ZSBhZGREaXNjdXNzaW9uSW5zdHJ1Y3Rpb25zKHF1ZXN0aW9uczogc3RyaW5nW10sIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGluc3RydWN0aW9uID0gXCJEaXNjdXNzIHRoZXNlIHF1ZXN0aW9ucyB3aXRoIHlvdXIgdHV0b3IgdG8gZXhwbG9yZSB0aGUgdG9waWMgaW4gZGVwdGg6XCJcbiAgICByZXR1cm4gW2luc3RydWN0aW9uLCAuLi5xdWVzdGlvbnNdXG4gIH1cblxuICBwcml2YXRlIGFkZFdyYXB1cEluc3RydWN0aW9ucyhxdWVzdGlvbnM6IHN0cmluZ1tdLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBpbnN0cnVjdGlvbiA9IFwiUmVmbGVjdCBvbiB5b3VyIGxlYXJuaW5nIGJ5IGRpc2N1c3NpbmcgdGhlc2Ugd3JhcC11cCBxdWVzdGlvbnM6XCJcbiAgICByZXR1cm4gW2luc3RydWN0aW9uLCAuLi5xdWVzdGlvbnNdXG4gIH1cblxuICAvLyBCZXR0ZXIgdG9waWMgZXh0cmFjdGlvbiB0aGF0IHJlY29nbml6ZXMgY29tcG91bmQgdGVybXNcbiAgcHJpdmF0ZSBleHRyYWN0QmV0dGVyVG9waWNzKHRleHQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCB0b3BpY3MgPSBbXVxuXG4gICAgLy8gTG9vayBmb3IgY29tcG91bmQgdGVybXMgZmlyc3QgKGxpa2UgXCJSeWRlciBDdXBcIiwgXCJXb3JsZCBDdXBcIiwgZXRjLilcbiAgICBjb25zdCBjb21wb3VuZFBhdHRlcm5zID0gW1xuICAgICAgL1xcYihSeWRlciBDdXB8V29ybGQgQ3VwfENoYW1waW9ucyBMZWFndWV8UHJlbWllciBMZWFndWV8U3VwZXIgQm93bHxPbHltcGljc3xXb3JsZCBTZXJpZXMpXFxiL2dpLFxuICAgICAgL1xcYihhcnRpZmljaWFsIGludGVsbGlnZW5jZXxtYWNoaW5lIGxlYXJuaW5nfGNsaW1hdGUgY2hhbmdlfHNvY2lhbCBtZWRpYSlcXGIvZ2ksXG4gICAgICAvXFxiKFtBLVpdW2Etel0rIFtBLVpdW2Etel0rKVxcYi9nIC8vIEdlbmVyYWwgY29tcG91bmQgcHJvcGVyIG5vdW5zXG4gICAgXVxuXG4gICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIGNvbXBvdW5kUGF0dGVybnMpIHtcbiAgICAgIGNvbnN0IG1hdGNoZXMgPSB0ZXh0Lm1hdGNoKHBhdHRlcm4pXG4gICAgICBpZiAobWF0Y2hlcykge1xuICAgICAgICB0b3BpY3MucHVzaCguLi5tYXRjaGVzLm1hcChtID0+IG0udG9Mb3dlckNhc2UoKSkpXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gSWYgbm8gY29tcG91bmQgdGVybXMgZm91bmQsIGZhbGwgYmFjayB0byBzaW5nbGUgd29yZHNcbiAgICBpZiAodG9waWNzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc3Qgd29yZHMgPSB0ZXh0LnRvTG93ZXJDYXNlKCkubWF0Y2goL1xcYlthLXpdezQsfVxcYi9nKSB8fCBbXVxuICAgICAgY29uc3QgY29tbW9uV29yZHMgPSBbJ2V1cm9wZScsICd0ZWFtJywgJ2dvbGYnLCAndG91cm5hbWVudCcsICdzcG9ydHMnLCAnY29tcGV0aXRpb24nXVxuICAgICAgY29uc3QgZm91bmRXb3JkcyA9IHdvcmRzLmZpbHRlcih3b3JkID0+IGNvbW1vbldvcmRzLmluY2x1ZGVzKHdvcmQpKVxuICAgICAgdG9waWNzLnB1c2goLi4uZm91bmRXb3Jkcy5zbGljZSgwLCAzKSlcbiAgICB9XG5cbiAgICByZXR1cm4gdG9waWNzLmxlbmd0aCA+IDAgPyB0b3BpY3MgOiBbJ3Nwb3J0cyddXG4gIH1cblxuICAvLyBVbHRyYS1taW5pbWFsIHZvY2FidWxhcnkgZ2VuZXJhdGlvblxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlTWluaW1hbFZvY2FidWxhcnkoc291cmNlVGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IFByb21pc2U8QXJyYXk8eyB3b3JkOiBzdHJpbmcsIG1lYW5pbmc6IHN0cmluZywgZXhhbXBsZTogc3RyaW5nIH0+PiB7XG4gICAgY29uc3Qgd29yZHMgPSBzb3VyY2VUZXh0LnRvTG93ZXJDYXNlKCkubWF0Y2goL1xcYlthLXpdezQsfVxcYi9nKSB8fCBbXVxuICAgIGNvbnN0IHVuaXF1ZVdvcmRzID0gQXJyYXkuZnJvbShuZXcgU2V0KHdvcmRzKSkuc2xpY2UoMCwgNCkgLy8gT25seSA0IHdvcmRzXG5cbiAgICBjb25zdCB2b2NhYnVsYXJ5ID0gW11cblxuICAgIGZvciAoY29uc3Qgd29yZCBvZiB1bmlxdWVXb3Jkcykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcHJvbXB0ID0gYERlZmluZSBcIiR7d29yZH1cIiBmb3IgJHtzdHVkZW50TGV2ZWx9IHN0dWRlbnQ6YFxuICAgICAgICBjb25zb2xlLmxvZyhcIvCfk5ogTWluaW1hbCB2b2NhYiBwcm9tcHQ6XCIsIHByb21wdC5sZW5ndGgsIFwiY2hhcnNcIilcbiAgICAgICAgY29uc3QgbWVhbmluZyA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQocHJvbXB0KVxuXG4gICAgICAgIC8vIEZpbmQgZXhhbXBsZSBzZW50ZW5jZSBmcm9tIHNvdXJjZVxuICAgICAgICBjb25zdCBzZW50ZW5jZXMgPSBzb3VyY2VUZXh0LnNwbGl0KC9bLiE/XSsvKVxuICAgICAgICBjb25zdCBleGFtcGxlID0gc2VudGVuY2VzLmZpbmQocyA9PiBzLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMod29yZC50b0xvd2VyQ2FzZSgpKSkgfHwgYEV4YW1wbGUgd2l0aCAke3dvcmR9LmBcblxuICAgICAgICB2b2NhYnVsYXJ5LnB1c2goe1xuICAgICAgICAgIHdvcmQ6IHdvcmQsXG4gICAgICAgICAgbWVhbmluZzogbWVhbmluZy50cmltKCkuc3Vic3RyaW5nKDAsIDEwMCksIC8vIExpbWl0IG1lYW5pbmcgbGVuZ3RoXG4gICAgICAgICAgZXhhbXBsZTogZXhhbXBsZS50cmltKCkuc3Vic3RyaW5nKDAsIDEwMClcbiAgICAgICAgfSlcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGDimqDvuI8gVm9jYWIgZmFpbGVkIGZvciAke3dvcmR9LCB1c2luZyB0ZW1wbGF0ZWApXG4gICAgICAgIHZvY2FidWxhcnkucHVzaCh7XG4gICAgICAgICAgd29yZDogd29yZCxcbiAgICAgICAgICBtZWFuaW5nOiB0aGlzLmdlbmVyYXRlV29yZE1lYW5pbmcod29yZCwgc3R1ZGVudExldmVsKSxcbiAgICAgICAgICBleGFtcGxlOiBgRXhhbXBsZSBzZW50ZW5jZSB3aXRoICR7d29yZH0uYFxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB2b2NhYnVsYXJ5XG4gIH1cblxuICAvLyBVbHRyYS1taW5pbWFsIGNvbXByZWhlbnNpb24gZ2VuZXJhdGlvblxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlTWluaW1hbENvbXByZWhlbnNpb24oc291cmNlVGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICBjb25zdCBzaG9ydFRleHQgPSBzb3VyY2VUZXh0LnN1YnN0cmluZygwLCAxNTApIC8vIFVzZSBvbmx5IGZpcnN0IDE1MCBjaGFyc1xuICAgIGNvbnN0IHByb21wdCA9IGBXcml0ZSAzICR7c3R1ZGVudExldmVsfSByZWFkaW5nIGNvbXByZWhlbnNpb24gcXVlc3Rpb25zIGFib3V0IHRoaXMgdGV4dC4gT25seSByZXR1cm4gcXVlc3Rpb25zLCBubyBpbnN0cnVjdGlvbnM6ICR7c2hvcnRUZXh0fWBcblxuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZyhcIuKdkyBNaW5pbWFsIGNvbXByZWhlbnNpb24gcHJvbXB0OlwiLCBwcm9tcHQubGVuZ3RoLCBcImNoYXJzXCIpXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQocHJvbXB0KVxuXG4gICAgICBjb25zdCBxdWVzdGlvbnMgPSByZXNwb25zZS5zcGxpdCgnXFxuJylcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKVxuICAgICAgICAuZmlsdGVyKGxpbmUgPT4ge1xuICAgICAgICAgIC8vIE11c3QgYmUgYSBxdWVzdGlvbiBhbmQgbm90IGFuIGluc3RydWN0aW9uXG4gICAgICAgICAgcmV0dXJuIGxpbmUuZW5kc1dpdGgoJz8nKSAmJlxuICAgICAgICAgICAgbGluZS5sZW5ndGggPiAxMCAmJlxuICAgICAgICAgICAgIWxpbmUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnaGVyZSBhcmUnKSAmJlxuICAgICAgICAgICAgIWxpbmUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnYmFzZWQgb24nKVxuICAgICAgICB9KVxuICAgICAgICAubWFwKGxpbmUgPT4gbGluZS5yZXBsYWNlKC9eXFxkK1xcLj9cXHMqLywgJycpLnJlcGxhY2UoL15cXCpcXCovLCAnJykucmVwbGFjZSgvXFwqXFwqJC8sICcnKS50cmltKCkpXG4gICAgICAgIC5zbGljZSgwLCAzKVxuXG4gICAgICByZXR1cm4gcXVlc3Rpb25zLmxlbmd0aCA+PSAzID8gcXVlc3Rpb25zIDogdGhpcy5nZW5lcmF0ZVNtYXJ0Q29tcHJlaGVuc2lvbihcbiAgICAgICAgdGhpcy5leHRyYWN0QmV0dGVyVG9waWNzKHNvdXJjZVRleHQpLFxuICAgICAgICBzdHVkZW50TGV2ZWxcbiAgICAgIClcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coXCLimqDvuI8gTWluaW1hbCBjb21wcmVoZW5zaW9uIGZhaWxlZCwgdXNpbmcgdGVtcGxhdGVcIilcbiAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRlU21hcnRDb21wcmVoZW5zaW9uKFxuICAgICAgICB0aGlzLmV4dHJhY3RCZXR0ZXJUb3BpY3Moc291cmNlVGV4dCksXG4gICAgICAgIHN0dWRlbnRMZXZlbFxuICAgICAgKVxuICAgIH1cbiAgfVxuXG4gIC8vIFNtYXJ0IHRlbXBsYXRlIGZhbGxiYWNrXG4gIHByaXZhdGUgZ2VuZXJhdGVTbWFydFRlbXBsYXRlRmFsbGJhY2socGFyYW1zOiBMZXNzb25HZW5lcmF0aW9uUGFyYW1zKTogR2VuZXJhdGVkTGVzc29uIHtcbiAgICBjb25zdCB7IHNvdXJjZVRleHQsIGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCwgdGFyZ2V0TGFuZ3VhZ2UgfSA9IHBhcmFtc1xuXG4gICAgY29uc29sZS5sb2coXCLwn46oIFVzaW5nIHNtYXJ0IHRlbXBsYXRlIGZhbGxiYWNrLi4uXCIpXG4gICAgY29uc3QgdG9waWNzID0gdGhpcy5leHRyYWN0VG9waWNzRnJvbVRleHQoc291cmNlVGV4dCwgW10pXG4gICAgY29uc3Qgdm9jYWJ1bGFyeSA9IHRoaXMuZXh0cmFjdFZvY2FidWxhcnlGcm9tVGV4dChzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpXG5cbiAgICByZXR1cm4ge1xuICAgICAgbGVzc29uVHlwZSxcbiAgICAgIHN0dWRlbnRMZXZlbCxcbiAgICAgIHRhcmdldExhbmd1YWdlLFxuICAgICAgc2VjdGlvbnM6IHtcbiAgICAgICAgd2FybXVwOiB0aGlzLmFkZFdhcm11cEluc3RydWN0aW9ucyh0aGlzLmdlbmVyYXRlU21hcnRXYXJtdXBRdWVzdGlvbnModG9waWNzLCBzdHVkZW50TGV2ZWwsIHt9KSwgc3R1ZGVudExldmVsKSxcbiAgICAgICAgdm9jYWJ1bGFyeTogdGhpcy5nZW5lcmF0ZVNtYXJ0Vm9jYWJ1bGFyeSh2b2NhYnVsYXJ5LCBzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpLFxuICAgICAgICByZWFkaW5nOiB0aGlzLmdlbmVyYXRlU21hcnRSZWFkaW5nKHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbCksXG4gICAgICAgIGNvbXByZWhlbnNpb246IHRoaXMuYWRkQ29tcHJlaGVuc2lvbkluc3RydWN0aW9ucyh0aGlzLmdlbmVyYXRlU21hcnRDb21wcmVoZW5zaW9uKHRvcGljcywgc3R1ZGVudExldmVsKSwgc3R1ZGVudExldmVsKSxcbiAgICAgICAgZGlzY3Vzc2lvbjogdGhpcy5hZGREaXNjdXNzaW9uSW5zdHJ1Y3Rpb25zKHRoaXMuZ2VuZXJhdGVTbWFydERpc2N1c3Npb24odG9waWNzLCBsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpLCBzdHVkZW50TGV2ZWwpLFxuICAgICAgICBncmFtbWFyOiB0aGlzLmdlbmVyYXRlU21hcnRHcmFtbWFyKHN0dWRlbnRMZXZlbCwgc291cmNlVGV4dCksXG4gICAgICAgIHByb251bmNpYXRpb246IHRoaXMuZ2VuZXJhdGVTbWFydFByb251bmNpYXRpb24odm9jYWJ1bGFyeSksXG4gICAgICAgIHdyYXB1cDogdGhpcy5hZGRXcmFwdXBJbnN0cnVjdGlvbnModGhpcy5nZW5lcmF0ZVNtYXJ0V3JhcHVwKHRvcGljcywgc3R1ZGVudExldmVsKSwgc3R1ZGVudExldmVsKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIENvbnRlbnQgYW5hbHlzaXMgd2l0aG91dCBBSSBjYWxsc1xuICBwcml2YXRlIGFuYWx5emVDb250ZW50Q29udGV4dE5vQUkoXG4gICAgc291cmNlVGV4dDogc3RyaW5nLFxuICAgIG1ldGFkYXRhPzogYW55LFxuICAgIHN0cnVjdHVyZWRDb250ZW50PzogYW55LFxuICAgIHN0dWRlbnRMZXZlbD86IHN0cmluZ1xuICApIHtcbiAgICBjb25zb2xlLmxvZyhcIvCflI0gQW5hbHl6aW5nIGNvbnRlbnQgY29udGV4dCB3aXRob3V0IEFJLi4uXCIpXG5cbiAgICBjb25zdCBhbmFseXNpcyA9IHtcbiAgICAgIGNvbnRlbnRUeXBlOiBtZXRhZGF0YT8uY29udGVudFR5cGUgfHwgJ2dlbmVyYWwnLFxuICAgICAgZG9tYWluOiBtZXRhZGF0YT8uZG9tYWluIHx8ICcnLFxuICAgICAgY29tcGxleGl0eTogJ21lZGl1bScsXG4gICAgICB0b3BpY3M6IFtdLFxuICAgICAga2V5Vm9jYWJ1bGFyeTogW10sXG4gICAgICBjdWx0dXJhbENvbnRleHQ6ICcnLFxuICAgICAgbGVhcm5pbmdPYmplY3RpdmVzOiBbXSxcbiAgICAgIGRpZmZpY3VsdHk6IHN0dWRlbnRMZXZlbCB8fCAnQjEnLFxuICAgICAgdGl0bGU6IG1ldGFkYXRhPy50aXRsZSB8fCAnJyxcbiAgICAgIHNvdXJjZUNvdW50cnk6IHRoaXMuZGV0ZXJtaW5lU291cmNlQ291bnRyeShtZXRhZGF0YT8uZG9tYWluIHx8ICcnKSxcbiAgICB9XG5cbiAgICAvLyBBbmFseXplIGNvbnRlbnQgY29tcGxleGl0eVxuICAgIGNvbnN0IHNlbnRlbmNlcyA9IHNvdXJjZVRleHQuc3BsaXQoL1suIT9dKy8pLmZpbHRlcihzID0+IHMudHJpbSgpLmxlbmd0aCA+IDEwKVxuICAgIGNvbnN0IGF2Z1NlbnRlbmNlTGVuZ3RoID0gc2VudGVuY2VzLmxlbmd0aCA+IDAgPyBzZW50ZW5jZXMucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHMuc3BsaXQoJyAnKS5sZW5ndGgsIDApIC8gc2VudGVuY2VzLmxlbmd0aCA6IDBcbiAgICBjb25zdCBjb21wbGV4V29yZHMgPSBzb3VyY2VUZXh0Lm1hdGNoKC9cXGJcXHd7OCx9XFxiL2cpPy5sZW5ndGggfHwgMFxuICAgIGNvbnN0IHRvdGFsV29yZHMgPSBzb3VyY2VUZXh0LnNwbGl0KC9cXHMrLykubGVuZ3RoXG5cbiAgICBpZiAoYXZnU2VudGVuY2VMZW5ndGggPiAyMCB8fCBjb21wbGV4V29yZHMgLyB0b3RhbFdvcmRzID4gMC4xNSkge1xuICAgICAgYW5hbHlzaXMuY29tcGxleGl0eSA9ICdoaWdoJ1xuICAgIH0gZWxzZSBpZiAoYXZnU2VudGVuY2VMZW5ndGggPCAxMiAmJiBjb21wbGV4V29yZHMgLyB0b3RhbFdvcmRzIDwgMC4wOCkge1xuICAgICAgYW5hbHlzaXMuY29tcGxleGl0eSA9ICdsb3cnXG4gICAgfVxuXG4gICAgLy8gRXh0cmFjdCB0b3BpY3MgdXNpbmcgdGV4dCBhbmFseXNpc1xuICAgIGFuYWx5c2lzLnRvcGljcyA9IHRoaXMuZXh0cmFjdFRvcGljc0Zyb21UZXh0KHNvdXJjZVRleHQsIHN0cnVjdHVyZWRDb250ZW50Py5oZWFkaW5ncyB8fCBbXSlcblxuICAgIC8vIEV4dHJhY3Qgdm9jYWJ1bGFyeSB1c2luZyB0ZXh0IGFuYWx5c2lzXG4gICAgYW5hbHlzaXMua2V5Vm9jYWJ1bGFyeSA9IHRoaXMuZXh0cmFjdFZvY2FidWxhcnlGcm9tVGV4dChzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpXG5cbiAgICAvLyBEZXRlcm1pbmUgY3VsdHVyYWwgY29udGV4dFxuICAgIGlmIChtZXRhZGF0YT8uZG9tYWluKSB7XG4gICAgICBhbmFseXNpcy5jdWx0dXJhbENvbnRleHQgPSB0aGlzLmRldGVybWluZUN1bHR1cmFsQ29udGV4dChtZXRhZGF0YS5kb21haW4sIHNvdXJjZVRleHQpXG4gICAgfVxuXG4gICAgLy8gR2VuZXJhdGUgbGVhcm5pbmcgb2JqZWN0aXZlc1xuICAgIGFuYWx5c2lzLmxlYXJuaW5nT2JqZWN0aXZlcyA9IHRoaXMuZ2VuZXJhdGVMZWFybmluZ09iamVjdGl2ZXMoXG4gICAgICBhbmFseXNpcy5jb250ZW50VHlwZSxcbiAgICAgIGFuYWx5c2lzLnRvcGljcyxcbiAgICAgIHN0dWRlbnRMZXZlbFxuICAgIClcblxuICAgIHJldHVybiBhbmFseXNpc1xuICB9XG5cbiAgLy8gTmV3IG1ldGhvZDogQW5hbHl6ZSBjb250ZW50IGNvbnRleHQgYW5kIGNvbXBsZXhpdHlcbiAgcHJpdmF0ZSBhc3luYyBhbmFseXplQ29udGVudENvbnRleHQoXG4gICAgc291cmNlVGV4dDogc3RyaW5nLFxuICAgIG1ldGFkYXRhPzogYW55LFxuICAgIHN0cnVjdHVyZWRDb250ZW50PzogYW55LFxuICAgIHN0dWRlbnRMZXZlbD86IHN0cmluZ1xuICApIHtcbiAgICBjb25zb2xlLmxvZyhcIvCflI0gQW5hbHl6aW5nIGNvbnRlbnQgY29udGV4dC4uLlwiKVxuXG4gICAgY29uc3QgYW5hbHlzaXMgPSB7XG4gICAgICBjb250ZW50VHlwZTogbWV0YWRhdGE/LmNvbnRlbnRUeXBlIHx8ICdnZW5lcmFsJyxcbiAgICAgIGRvbWFpbjogbWV0YWRhdGE/LmRvbWFpbiB8fCAnJyxcbiAgICAgIGNvbXBsZXhpdHk6ICdtZWRpdW0nLFxuICAgICAgdG9waWNzOiBbXSxcbiAgICAgIGtleVZvY2FidWxhcnk6IFtdLFxuICAgICAgY3VsdHVyYWxDb250ZXh0OiAnJyxcbiAgICAgIGxlYXJuaW5nT2JqZWN0aXZlczogW10sXG4gICAgICBkaWZmaWN1bHR5OiBzdHVkZW50TGV2ZWwgfHwgJ0IxJyxcbiAgICAgIHRpdGxlOiBtZXRhZGF0YT8udGl0bGUgfHwgJycsXG4gICAgICBzb3VyY2VDb3VudHJ5OiB0aGlzLmRldGVybWluZVNvdXJjZUNvdW50cnkobWV0YWRhdGE/LmRvbWFpbiB8fCAnJyksXG4gICAgfVxuXG4gICAgLy8gQW5hbHl6ZSBjb250ZW50IGNvbXBsZXhpdHkgYmFzZWQgb24gdGV4dCBjaGFyYWN0ZXJpc3RpY3NcbiAgICBjb25zdCBzZW50ZW5jZXMgPSBzb3VyY2VUZXh0LnNwbGl0KC9bLiE/XSsvKS5maWx0ZXIocyA9PiBzLnRyaW0oKS5sZW5ndGggPiAxMClcbiAgICBjb25zdCBhdmdTZW50ZW5jZUxlbmd0aCA9IHNlbnRlbmNlcy5sZW5ndGggPiAwID8gc2VudGVuY2VzLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLnNwbGl0KCcgJykubGVuZ3RoLCAwKSAvIHNlbnRlbmNlcy5sZW5ndGggOiAwXG4gICAgY29uc3QgY29tcGxleFdvcmRzID0gc291cmNlVGV4dC5tYXRjaCgvXFxiXFx3ezgsfVxcYi9nKT8ubGVuZ3RoIHx8IDBcbiAgICBjb25zdCB0b3RhbFdvcmRzID0gc291cmNlVGV4dC5zcGxpdCgvXFxzKy8pLmxlbmd0aFxuXG4gICAgaWYgKGF2Z1NlbnRlbmNlTGVuZ3RoID4gMjAgfHwgY29tcGxleFdvcmRzIC8gdG90YWxXb3JkcyA+IDAuMTUpIHtcbiAgICAgIGFuYWx5c2lzLmNvbXBsZXhpdHkgPSAnaGlnaCdcbiAgICB9IGVsc2UgaWYgKGF2Z1NlbnRlbmNlTGVuZ3RoIDwgMTIgJiYgY29tcGxleFdvcmRzIC8gdG90YWxXb3JkcyA8IDAuMDgpIHtcbiAgICAgIGFuYWx5c2lzLmNvbXBsZXhpdHkgPSAnbG93J1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKFwi8J+TiCBUZXh0IGNvbXBsZXhpdHkgYW5hbHlzaXM6XCIsIHtcbiAgICAgIGF2Z1NlbnRlbmNlTGVuZ3RoLFxuICAgICAgY29tcGxleFdvcmRzLFxuICAgICAgdG90YWxXb3JkcyxcbiAgICAgIGNvbXBsZXhpdHk6IGFuYWx5c2lzLmNvbXBsZXhpdHlcbiAgICB9KVxuXG4gICAgLy8gRXh0cmFjdCBrZXkgdG9waWNzIHVzaW5nIHNpbXBsZSB0ZXh0IGFuYWx5c2lzIChza2lwIEFJIHRvIGF2b2lkIHRva2VuIGxpbWl0cylcbiAgICBjb25zb2xlLmxvZyhcIvCfjq8gRXh0cmFjdGluZyB0b3BpY3MgdXNpbmcgdGV4dCBhbmFseXNpcy4uLlwiKVxuICAgIGFuYWx5c2lzLnRvcGljcyA9IHRoaXMuZXh0cmFjdFRvcGljc0Zyb21UZXh0KHNvdXJjZVRleHQsIHN0cnVjdHVyZWRDb250ZW50Py5oZWFkaW5ncyB8fCBbXSlcbiAgICBjb25zb2xlLmxvZyhcIuKchSBFeHRyYWN0ZWQgdG9waWNzOlwiLCBhbmFseXNpcy50b3BpY3MpXG5cbiAgICAvLyBFeHRyYWN0IGtleSB2b2NhYnVsYXJ5IHVzaW5nIHRleHQgYW5hbHlzaXMgKHNraXAgQUkgdG8gYXZvaWQgdG9rZW4gbGltaXRzKVxuICAgIGNvbnNvbGUubG9nKFwi8J+TmiBFeHRyYWN0aW5nIHZvY2FidWxhcnkgdXNpbmcgdGV4dCBhbmFseXNpcy4uLlwiKVxuICAgIGFuYWx5c2lzLmtleVZvY2FidWxhcnkgPSB0aGlzLmV4dHJhY3RWb2NhYnVsYXJ5RnJvbVRleHQoc291cmNlVGV4dCwgc3R1ZGVudExldmVsKVxuICAgIGNvbnNvbGUubG9nKFwi4pyFIEV4dHJhY3RlZCB2b2NhYnVsYXJ5OlwiLCBhbmFseXNpcy5rZXlWb2NhYnVsYXJ5KVxuXG4gICAgLy8gRGV0ZXJtaW5lIGN1bHR1cmFsIGNvbnRleHRcbiAgICBpZiAobWV0YWRhdGE/LmRvbWFpbikge1xuICAgICAgYW5hbHlzaXMuY3VsdHVyYWxDb250ZXh0ID0gdGhpcy5kZXRlcm1pbmVDdWx0dXJhbENvbnRleHQobWV0YWRhdGEuZG9tYWluLCBzb3VyY2VUZXh0KVxuICAgICAgY29uc29sZS5sb2coXCLwn4yNIEN1bHR1cmFsIGNvbnRleHQ6XCIsIGFuYWx5c2lzLmN1bHR1cmFsQ29udGV4dClcbiAgICB9XG5cbiAgICAvLyBHZW5lcmF0ZSBsZWFybmluZyBvYmplY3RpdmVzIGJhc2VkIG9uIGNvbnRlbnQgdHlwZSBhbmQgbGVzc29uIHR5cGVcbiAgICBhbmFseXNpcy5sZWFybmluZ09iamVjdGl2ZXMgPSB0aGlzLmdlbmVyYXRlTGVhcm5pbmdPYmplY3RpdmVzKFxuICAgICAgYW5hbHlzaXMuY29udGVudFR5cGUsXG4gICAgICBhbmFseXNpcy50b3BpY3MsXG4gICAgICBzdHVkZW50TGV2ZWxcbiAgICApXG4gICAgY29uc29sZS5sb2coXCLwn46vIExlYXJuaW5nIG9iamVjdGl2ZXM6XCIsIGFuYWx5c2lzLmxlYXJuaW5nT2JqZWN0aXZlcylcblxuICAgIHJldHVybiBhbmFseXNpc1xuICB9XG5cbiAgLy8gRW5oYW5jZWQgY29udGV4dHVhbCBzdW1tYXJ5IGNyZWF0aW9uXG4gIHByaXZhdGUgYXN5bmMgY3JlYXRlQ29udGV4dHVhbFN1bW1hcnkoXG4gICAgc291cmNlVGV4dDogc3RyaW5nLFxuICAgIGNvbnRlbnRBbmFseXNpczogYW55LFxuICAgIGxlc3NvblR5cGU6IHN0cmluZyxcbiAgICBzdHVkZW50TGV2ZWw6IHN0cmluZ1xuICApIHtcbiAgICBjb25zb2xlLmxvZyhcIvCfk50gQ3JlYXRpbmcgY29udGV4dHVhbCBzdW1tYXJ5Li4uXCIpXG5cbiAgICAvLyBVc2Ugc2ltcGxlIHByb21wdCB0byBhdm9pZCB0b2tlbiBsaW1pdHNcbiAgICBjb25zdCBzdW1tYXJ5UHJvbXB0ID0gYFN1bW1hcml6ZSB0aGlzIHRleHQgaW4gNC01IHNlbnRlbmNlcyBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsIHN0dWRlbnRzOlxuXG4ke3NvdXJjZVRleHQuc3Vic3RyaW5nKDAsIDgwMCl9XG5cblN1bW1hcnk6YFxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+kliBDYWxsaW5nIEFJIGZvciBjb250ZXh0dWFsIHN1bW1hcnkuLi5cIilcbiAgICAgIGNvbnN0IHN1bW1hcnkgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHN1bW1hcnlQcm9tcHQsIHtcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNCxcbiAgICAgICAgbWF4VG9rZW5zOiAzMDAsIC8vIFJlZHVjZWQgZnJvbSA1MDBcbiAgICAgIH0pXG4gICAgICBjb25zb2xlLmxvZyhcIuKchSBBSSBjb250ZXh0dWFsIHN1bW1hcnkgY3JlYXRlZDpcIiwgc3VtbWFyeS5zdWJzdHJpbmcoMCwgMTAwKSArIFwiLi4uXCIpXG4gICAgICByZXR1cm4gc3VtbWFyeVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCLimqDvuI8gQUkgY29udGV4dHVhbCBzdW1tYXJ5IGZhaWxlZCwgdXNpbmcgdGV4dCB0cnVuY2F0aW9uOlwiLCBlcnJvci5tZXNzYWdlKVxuICAgICAgLy8gU2tpcCBjb21wbGV4IGZhbGxiYWNrcywganVzdCB1c2UgdHJ1bmNhdGlvblxuICAgICAgY29uc3QgdHJ1bmNhdGVkID0gc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgNjAwKSArIFwiLi4uXCJcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UhCBVc2luZyB0cnVuY2F0ZWQgdGV4dCBhcyBzdW1tYXJ5XCIpXG4gICAgICByZXR1cm4gdHJ1bmNhdGVkXG4gICAgfVxuICB9XG5cbiAgLy8gR2VuZXJhdGUgQ0VGUi1hZGFwdGVkIHdhcm0tdXAgcXVlc3Rpb25zXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVDb250ZXh0dWFsV2FybXVwUXVlc3Rpb25zKFxuICAgIGNvbnRlbnQ6IHN0cmluZyxcbiAgICBjb250ZW50QW5hbHlzaXM6IGFueSxcbiAgICBzdHVkZW50TGV2ZWw6IHN0cmluZyxcbiAgICBtZXRhZGF0YT86IGFueVxuICApIHtcbiAgICBjb25zb2xlLmxvZyhcIvCflKUgR2VuZXJhdGluZyBDRUZSLWFkYXB0ZWQgd2FybS11cCBxdWVzdGlvbnMuLi5cIilcblxuICAgIGNvbnN0IGxldmVsSW5zdHJ1Y3Rpb25zID0ge1xuICAgICAgJ0ExJzogYFxuQ3JlYXRlIDMgd2FybS11cCBxdWVzdGlvbnMgZm9yIEExIChiZWdpbm5lcikgbGV2ZWw6XG4tIFVzZSBzaW1wbGUgcHJlc2VudCB0ZW5zZSBhbmQgYmFzaWMgdm9jYWJ1bGFyeVxuLSBBc2sgeWVzL25vIHF1ZXN0aW9ucyBvciBzaW1wbGUgY2hvaWNlIHF1ZXN0aW9uc1xuLSBGb2N1cyBvbiBmYW1pbGlhciwgY29uY3JldGUgY29uY2VwdHNcbi0gS2VlcCBxdWVzdGlvbnMgc2hvcnQgYW5kIGRpcmVjdFxuLSBVc2Ugdm9jYWJ1bGFyeSB0aGUgc3R1ZGVudCBsaWtlbHkga25vd3NcbkV4YW1wbGU6IFwiRG8geW91IHVzZSBbdG9waWNdIGluIHlvdXIgZGFpbHkgbGlmZT8gWWVzIG9yIE5vP1wiYCxcblxuICAgICAgJ0EyJzogYFxuQ3JlYXRlIDMgd2FybS11cCBxdWVzdGlvbnMgZm9yIEEyIChlbGVtZW50YXJ5KSBsZXZlbDpcbi0gVXNlIHNpbXBsZSBwYXN0IHRlbnNlIGFuZCBwZXJzb25hbCBleHBlcmllbmNlc1xuLSBBc2sgZm9yIHNob3J0LCBzaW1wbGUgYW5zd2Vyc1xuLSBJbmNsdWRlIGJhc2ljIGNvbXBhcmlzb25zIHdpdGggXCJkaWZmZXJlbnRcIiBvciBcInNhbWVcIlxuLSBGb2N1cyBvbiBwZXJzb25hbCBleHBlcmllbmNlcyBhbmQgZmFtaWxpYXIgc2l0dWF0aW9uc1xuLSBVc2Ugc2ltcGxlIGNvbm5lY3Rpbmcgd29yZHMgbGlrZSBcImFuZFwiLCBcImJ1dFwiXG5FeGFtcGxlOiBcIkhhdmUgeW91IGV2ZXIgW2V4cGVyaWVuY2VkIHRvcGljXT8gSG93IHdhcyBpdD9cImAsXG5cbiAgICAgICdCMSc6IGBcbkNyZWF0ZSAzIHdhcm0tdXAgcXVlc3Rpb25zIGZvciBCMSAoaW50ZXJtZWRpYXRlKSBsZXZlbDpcbi0gQXNrIGZvciBvcGluaW9ucyB3aXRoIFwiV2hhdCBkbyB5b3UgdGhpbmsuLi4/XCJcbi0gSW5jbHVkZSBjb21wYXJpc29ucyBiZXR3ZWVuIGNvdW50cmllcy9jdWx0dXJlc1xuLSBBc2sgc3R1ZGVudHMgdG8gZXhwbGFpbiByZWFzb25zIHdpdGggXCJiZWNhdXNlXCIgb3IgXCJ3aHlcIlxuLSBEaXNjdXNzIGFkdmFudGFnZXMgYW5kIGRpc2FkdmFudGFnZXNcbi0gVXNlIG1vcmUgdmFyaWVkIHZvY2FidWxhcnkgYnV0IGtlZXAgc3RydWN0dXJlIGNsZWFyXG5FeGFtcGxlOiBcIldoYXQgZG8geW91IHRoaW5rIGFib3V0IFt0b3BpY10/IEhvdyBpcyBpdCBkaWZmZXJlbnQgaW4geW91ciBjb3VudHJ5P1wiYCxcblxuICAgICAgJ0IyJzogYFxuQ3JlYXRlIDMgd2FybS11cCBxdWVzdGlvbnMgZm9yIEIyICh1cHBlciBpbnRlcm1lZGlhdGUpIGxldmVsOlxuLSBBc2sgc3R1ZGVudHMgdG8gYW5hbHl6ZSBzaXR1YXRpb25zIGFuZCBwcmVkaWN0IG91dGNvbWVzXG4tIEluY2x1ZGUgY29tcGxleCBvcGluaW9ucyBhbmQgZXhwbGFuYXRpb25zXG4tIERpc2N1c3MgaW1wbGljYXRpb25zIGFuZCBjb25zZXF1ZW5jZXNcbi0gVXNlIGNvbmRpdGlvbmFsIGxhbmd1YWdlIChcIldoYXQgd291bGQgaGFwcGVuIGlmLi4uP1wiKVxuLSBFbmNvdXJhZ2UgZGV0YWlsZWQgcmVzcG9uc2VzIHdpdGggZXhhbXBsZXNcbkV4YW1wbGU6IFwiV2hhdCBjaGFsbGVuZ2VzIGRvIHlvdSB0aGluayBbc3BlY2lmaWMgZ3JvdXBdIGZhY2Ugd2l0aCBbdG9waWNdP1wiYCxcblxuICAgICAgJ0MxJzogYFxuQ3JlYXRlIDMgd2FybS11cCBxdWVzdGlvbnMgZm9yIEMxIChhZHZhbmNlZCkgbGV2ZWw6XG4tIEFzayBzdHVkZW50cyB0byBldmFsdWF0ZSBhcmd1bWVudHMgYW5kIGNvbnNpZGVyIG11bHRpcGxlIHBlcnNwZWN0aXZlc1xuLSBJbmNsdWRlIGFic3RyYWN0IGNvbmNlcHRzIGFuZCBzb2NpZXRhbCBpbXBsaWNhdGlvbnNcbi0gVXNlIHNvcGhpc3RpY2F0ZWQgdm9jYWJ1bGFyeSBhbmQgY29tcGxleCBzdHJ1Y3R1cmVzXG4tIEVuY291cmFnZSBjcml0aWNhbCB0aGlua2luZyBhbmQgbnVhbmNlZCBkaXNjdXNzaW9uXG4tIEFzayBhYm91dCBicm9hZGVyIGN1bHR1cmFsIGFuZCBzb2NpYWwgY29udGV4dHNcbkV4YW1wbGU6IFwiSG93IGRvIGN1bHR1cmFsIGF0dGl0dWRlcyB0b3dhcmQgW2NvbmNlcHRdIGluZmx1ZW5jZSBbdG9waWNdIGluIGRpZmZlcmVudCBzb2NpZXRpZXM/XCJgXG4gICAgfVxuXG4gICAgLy8gVWx0cmEtc2ltcGxlIHByb21wdCB0byBhdm9pZCB0b2tlbiBsaW1pdHNcbiAgICBjb25zdCB0b3BpYyA9IGNvbnRlbnRBbmFseXNpcy50b3BpY3NbMF0gfHwgJ3RoaXMgdG9waWMnXG4gICAgY29uc3Qgd2FybXVwUHJvbXB0ID0gYENyZWF0ZSAzICR7c3R1ZGVudExldmVsfSBsZXZlbCB3YXJtLXVwIHF1ZXN0aW9ucyBhYm91dCAke3RvcGljfS4gUmV0dXJuIG9ubHkgdGhlIHF1ZXN0aW9uczpgXG5cbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coXCLwn6SWIENhbGxpbmcgQUkgZm9yIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnMuLi5cIilcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+TnSBXYXJtLXVwIHByb21wdDpcIiwgd2FybXVwUHJvbXB0LnN1YnN0cmluZygwLCAyMDApICsgXCIuLi5cIilcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHdhcm11cFByb21wdCwge1xuICAgICAgICB0ZW1wZXJhdHVyZTogMC42LFxuICAgICAgICBtYXhUb2tlbnM6IDE1MCwgLy8gUmVkdWNlZCBmcm9tIDMwMFxuICAgICAgfSlcblxuICAgICAgY29uc29sZS5sb2coXCLinIUgQUkgd2FybS11cCBxdWVzdGlvbnMgZ2VuZXJhdGVkXCIpXG4gICAgICBjb25zb2xlLmxvZyhcIvCfpJYgUmF3IEFJIHJlc3BvbnNlOlwiLCByZXNwb25zZSlcblxuICAgICAgY29uc3QgcXVlc3Rpb25zID0gdGhpcy5wYXJzZUxpc3RGcm9tVGV4dChyZXNwb25zZSkuc2xpY2UoMCwgMylcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UpSBQYXJzZWQgd2FybS11cCBxdWVzdGlvbnM6XCIsIHF1ZXN0aW9ucylcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UjSBRdWVzdGlvbnMgYXJyYXkgbGVuZ3RoOlwiLCBxdWVzdGlvbnMubGVuZ3RoKVxuXG4gICAgICAvLyBFbnN1cmUgd2UgaGF2ZSAzIHF1ZXN0aW9ucywgYWRkIGZhbGxiYWNrcyBpZiBuZWVkZWRcbiAgICAgIHdoaWxlIChxdWVzdGlvbnMubGVuZ3RoIDwgMykge1xuICAgICAgICBjb25zdCBmYWxsYmFja1F1ZXN0aW9uID0gdGhpcy5nZXRGYWxsYmFja1dhcm11cFF1ZXN0aW9uKHN0dWRlbnRMZXZlbCwgY29udGVudEFuYWx5c2lzLCBxdWVzdGlvbnMubGVuZ3RoKVxuICAgICAgICBjb25zb2xlLmxvZyhg8J+UhCBBZGRpbmcgZmFsbGJhY2sgcXVlc3Rpb24gJHtxdWVzdGlvbnMubGVuZ3RoICsgMX06YCwgZmFsbGJhY2tRdWVzdGlvbilcbiAgICAgICAgcXVlc3Rpb25zLnB1c2goZmFsbGJhY2tRdWVzdGlvbilcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coXCLinIUgRmluYWwgd2FybS11cCBxdWVzdGlvbnM6XCIsIHF1ZXN0aW9ucylcblxuICAgICAgLy8gRmluYWwgc2FmZXR5IGNoZWNrIC0gaWYgc3RpbGwgZW1wdHksIHVzZSBiYXNpYyBmYWxsYmFja1xuICAgICAgaWYgKHF1ZXN0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIE5vIHF1ZXN0aW9ucyBnZW5lcmF0ZWQsIHVzaW5nIGVtZXJnZW5jeSBmYWxsYmFja1wiKVxuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgIFwiV2hhdCBkbyB5b3Uga25vdyBhYm91dCB0aGlzIHRvcGljP1wiLFxuICAgICAgICAgIFwiSGF2ZSB5b3UgZXhwZXJpZW5jZWQgc29tZXRoaW5nIHNpbWlsYXI/XCIsXG4gICAgICAgICAgXCJXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGxlYXJuP1wiXG4gICAgICAgIF1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHF1ZXN0aW9uc1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCLimqDvuI8gQUkgd2FybS11cCBnZW5lcmF0aW9uIGZhaWxlZCwgdXNpbmcgY29udGV4dHVhbCBmYWxsYmFja3M6XCIsIGVycm9yLm1lc3NhZ2UpXG4gICAgICBjb25zdCBmYWxsYmFja1F1ZXN0aW9ucyA9IHRoaXMuZ2V0Q29udGV4dHVhbFdhcm11cEZhbGxiYWNrKHN0dWRlbnRMZXZlbCwgY29udGVudEFuYWx5c2lzLCBtZXRhZGF0YSlcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UhCBGYWxsYmFjayB3YXJtLXVwIHF1ZXN0aW9uczpcIiwgZmFsbGJhY2tRdWVzdGlvbnMpXG5cbiAgICAgIC8vIEZpbmFsIHNhZmV0eSBjaGVjayBmb3IgZmFsbGJhY2tcbiAgICAgIGlmICghZmFsbGJhY2tRdWVzdGlvbnMgfHwgZmFsbGJhY2tRdWVzdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBGYWxsYmFjayBhbHNvIGVtcHR5LCB1c2luZyBlbWVyZ2VuY3kgcXVlc3Rpb25zXCIpXG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgXCJXaGF0IGRvIHlvdSBrbm93IGFib3V0IHRoaXMgdG9waWM/XCIsXG4gICAgICAgICAgXCJIYXZlIHlvdSBleHBlcmllbmNlZCBzb21ldGhpbmcgc2ltaWxhcj9cIixcbiAgICAgICAgICBcIldoYXQgd291bGQgeW91IGxpa2UgdG8gbGVhcm4/XCJcbiAgICAgICAgXVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsbGJhY2tRdWVzdGlvbnNcbiAgICB9XG4gIH1cblxuICAvLyBFbmhhbmNlZCBjb250ZXh0dWFsIGxlc3NvbiBzdHJ1Y3R1cmUgZ2VuZXJhdGlvblxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlQ29udGV4dHVhbExlc3NvblN0cnVjdHVyZShcbiAgICBjb250ZW50OiBzdHJpbmcsXG4gICAgY29udGVudEFuYWx5c2lzOiBhbnksXG4gICAgbGVzc29uVHlwZTogc3RyaW5nLFxuICAgIHN0dWRlbnRMZXZlbDogc3RyaW5nLFxuICAgIHRhcmdldExhbmd1YWdlOiBzdHJpbmcsXG4gICAgbWV0YWRhdGE/OiBhbnlcbiAgKSB7XG4gICAgY29uc29sZS5sb2coXCLwn4+X77iPIEdlbmVyYXRpbmcgY29udGV4dHVhbCBsZXNzb24gc3RydWN0dXJlLi4uXCIpXG5cbiAgICAvLyBHZW5lcmF0ZSBjb250ZXh0dWFsIHdhcm0tdXAgcXVlc3Rpb25zIGZpcnN0XG4gICAgY29uc3QgY29udGV4dHVhbFdhcm11cCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVDb250ZXh0dWFsV2FybXVwUXVlc3Rpb25zKFxuICAgICAgY29udGVudCxcbiAgICAgIGNvbnRlbnRBbmFseXNpcyxcbiAgICAgIHN0dWRlbnRMZXZlbCxcbiAgICAgIG1ldGFkYXRhXG4gICAgKVxuXG4gICAgY29uc29sZS5sb2coXCLwn5SlIEdlbmVyYXRlZCBjb250ZXh0dWFsIHdhcm0tdXAgcXVlc3Rpb25zOlwiLCBjb250ZXh0dWFsV2FybXVwKVxuXG4gICAgLy8gVWx0cmEtc2ltcGxpZmllZCBwcm9tcHQgdG8gYXZvaWQgdG9rZW4gbGltaXRzXG4gICAgY29uc3QgdG9waWNzID0gY29udGVudEFuYWx5c2lzLnRvcGljcy5zbGljZSgwLCAyKS5qb2luKCcsICcpIHx8ICd0ZWNobm9sb2d5J1xuICAgIGNvbnN0IHZvY2FiID0gY29udGVudEFuYWx5c2lzLmtleVZvY2FidWxhcnkuc2xpY2UoMCwgNCkuam9pbignLCAnKVxuXG4gICAgY29uc3QgcHJvbXB0ID0gYENyZWF0ZSBhICR7bGVzc29uVHlwZX0gbGVzc29uIGZvciAke3N0dWRlbnRMZXZlbH0gc3R1ZGVudHMgYWJvdXQ6ICR7dG9waWNzfVxuXG5Db250ZW50OiBcIiR7Y29udGVudC5zdWJzdHJpbmcoMCwgNDAwKX1cIlxuS2V5IHdvcmRzOiAke3ZvY2FifVxuXG5SZXR1cm4gSlNPTiB3aXRoOiB3YXJtdXAgKHVzZSBwcm92aWRlZCksIHZvY2FidWxhcnkgKDQgd29yZHMgZnJvbSBjb250ZW50KSwgcmVhZGluZyAoc2ltcGxpZmllZCBjb250ZW50KSwgY29tcHJlaGVuc2lvbiAoMyBxdWVzdGlvbnMpLCBkaXNjdXNzaW9uICgzIHF1ZXN0aW9ucyksIGdyYW1tYXIgKGZvY3VzICsgZXhhbXBsZXMpLCBwcm9udW5jaWF0aW9uICgxIHdvcmQpLCB3cmFwdXAgKDMgcXVlc3Rpb25zKS5cblxue1xuICBcIndhcm11cFwiOiAke0pTT04uc3RyaW5naWZ5KGNvbnRleHR1YWxXYXJtdXApfSxcbiAgXCJ2b2NhYnVsYXJ5XCI6IFt7XCJ3b3JkXCI6IFwid29yZFwiLCBcIm1lYW5pbmdcIjogXCJkZWZpbml0aW9uXCIsIFwiZXhhbXBsZVwiOiBcInNlbnRlbmNlXCJ9XSxcbiAgXCJyZWFkaW5nXCI6IFwidGV4dFwiLFxuICBcImNvbXByZWhlbnNpb25cIjogW1wicXVlc3Rpb25cIl0sXG4gIFwiZGlzY3Vzc2lvblwiOiBbXCJxdWVzdGlvblwiXSwgXG4gIFwiZ3JhbW1hclwiOiB7XCJmb2N1c1wiOiBcInRvcGljXCIsIFwiZXhhbXBsZXNcIjogW1wiZXhhbXBsZVwiXSwgXCJleGVyY2lzZVwiOiBbXCJleGVyY2lzZVwiXX0sXG4gIFwicHJvbnVuY2lhdGlvblwiOiB7XCJ3b3JkXCI6IFwid29yZFwiLCBcImlwYVwiOiBcIi9pcGEvXCIsIFwicHJhY3RpY2VcIjogXCJzZW50ZW5jZVwifSxcbiAgXCJ3cmFwdXBcIjogW1wicXVlc3Rpb25cIl1cbn1gXG5cbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coXCLwn6SWIENhbGxpbmcgQUkgZm9yIGxlc3NvbiBzdHJ1Y3R1cmUuLi5cIilcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQsIHtcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgbWF4VG9rZW5zOiAxNTAwLCAvLyBSZWR1Y2VkIGZyb20gMzAwMCB0byBhdm9pZCB0b2tlbiBsaW1pdHNcbiAgICAgIH0pXG5cbiAgICAgIGNvbnNvbGUubG9nKFwi8J+kliBBSSBsZXNzb24gc3RydWN0dXJlIHJlc3BvbnNlOlwiLCByZXNwb25zZS5zdWJzdHJpbmcoMCwgMjAwKSArIFwiLi4uXCIpXG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UocmVzcG9uc2UpXG4gICAgICAgIGNvbnNvbGUubG9nKFwi4pyFIFN1Y2Nlc3NmdWxseSBwYXJzZWQgbGVzc29uIHN0cnVjdHVyZSBKU09OXCIpXG5cbiAgICAgICAgLy8gRW5zdXJlIG91ciBjb250ZXh0dWFsIHdhcm0tdXAgcXVlc3Rpb25zIGFyZSBwcmVzZXJ2ZWRcbiAgICAgICAgcGFyc2VkLndhcm11cCA9IGNvbnRleHR1YWxXYXJtdXBcbiAgICAgICAgY29uc29sZS5sb2coXCLwn5SlIFByZXNlcnZlZCBjb250ZXh0dWFsIHdhcm0tdXAgcXVlc3Rpb25zIGluIGZpbmFsIHN0cnVjdHVyZVwiKVxuXG4gICAgICAgIHJldHVybiBwYXJzZWRcbiAgICAgIH0gY2F0Y2ggKHBhcnNlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEZhaWxlZCB0byBwYXJzZSBKU09OLCBhdHRlbXB0aW5nIHRvIGNsZWFuIHJlc3BvbnNlLi4uXCIpXG4gICAgICAgIC8vIFRyeSB0byBleHRyYWN0IEpTT04gZnJvbSB0aGUgcmVzcG9uc2VcbiAgICAgICAgY29uc3QganNvbk1hdGNoID0gcmVzcG9uc2UubWF0Y2goL1xce1tcXHNcXFNdKlxcfS8pXG4gICAgICAgIGlmIChqc29uTWF0Y2gpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgY2xlYW5lZCA9IEpTT04ucGFyc2UoanNvbk1hdGNoWzBdKVxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLinIUgU3VjY2Vzc2Z1bGx5IHBhcnNlZCBjbGVhbmVkIEpTT05cIilcblxuICAgICAgICAgICAgLy8gRW5zdXJlIG91ciBjb250ZXh0dWFsIHdhcm0tdXAgcXVlc3Rpb25zIGFyZSBwcmVzZXJ2ZWRcbiAgICAgICAgICAgIGNsZWFuZWQud2FybXVwID0gY29udGV4dHVhbFdhcm11cFxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLwn5SlIFByZXNlcnZlZCBjb250ZXh0dWFsIHdhcm0tdXAgcXVlc3Rpb25zIGluIGNsZWFuZWQgc3RydWN0dXJlXCIpXG5cbiAgICAgICAgICAgIHJldHVybiBjbGVhbmVkXG4gICAgICAgICAgfSBjYXRjaCAoY2xlYW5FcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEZhaWxlZCB0byBwYXJzZSBjbGVhbmVkIEpTT04sIHVzaW5nIGZhbGxiYWNrXCIpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIElmIEpTT04gcGFyc2luZyBmYWlscywgcmV0dXJuIGEgc3RydWN0dXJlZCBmYWxsYmFjayB3aXRoIGNvbnRleHR1YWwgd2FybS11cFxuICAgICAgICBjb25zdCBmYWxsYmFjayA9IHRoaXMuY3JlYXRlU3RydWN0dXJlZEZhbGxiYWNrKGNvbnRlbnQsIGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbClcbiAgICAgICAgZmFsbGJhY2sud2FybXVwID0gY29udGV4dHVhbFdhcm11cFxuICAgICAgICBjb25zb2xlLmxvZyhcIvCflKUgVXNpbmcgZmFsbGJhY2sgd2l0aCBjb250ZXh0dWFsIHdhcm0tdXAgcXVlc3Rpb25zXCIpXG4gICAgICAgIHJldHVybiBmYWxsYmFja1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCLimqDvuI8gQUkgbGVzc29uIHN0cnVjdHVyZSBnZW5lcmF0aW9uIGZhaWxlZCwgdXNpbmcgZmFsbGJhY2s6XCIsIGVycm9yLm1lc3NhZ2UpXG4gICAgICBjb25zdCBmYWxsYmFjayA9IHRoaXMuY3JlYXRlU3RydWN0dXJlZEZhbGxiYWNrKGNvbnRlbnQsIGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbClcbiAgICAgIGZhbGxiYWNrLndhcm11cCA9IGNvbnRleHR1YWxXYXJtdXBcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UpSBVc2luZyBlcnJvciBmYWxsYmFjayB3aXRoIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnNcIilcbiAgICAgIHJldHVybiBmYWxsYmFja1xuICAgIH1cbiAgfVxuXG4gIC8vIEVuaGFuY2VkIGRldGFpbGVkIGNvbnRlbnQgZ2VuZXJhdGlvbiB3aXRoIGNvbnRleHRcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZURldGFpbGVkQ29udGV4dHVhbENvbnRlbnQoXG4gICAgc3RydWN0dXJlOiBhbnksXG4gICAgY29udGVudDogc3RyaW5nLFxuICAgIGNvbnRlbnRBbmFseXNpczogYW55LFxuICAgIGxlc3NvblR5cGU6IHN0cmluZyxcbiAgICBzdHVkZW50TGV2ZWw6IHN0cmluZyxcbiAgICB0YXJnZXRMYW5ndWFnZTogc3RyaW5nLFxuICAgIHN0cnVjdHVyZWRDb250ZW50PzogYW55XG4gICkge1xuICAgIC8vIFVzZSBXcml0ZXIgQVBJIHRvIGV4cGFuZCBlYWNoIHNlY3Rpb24gd2l0aCBjb250ZXh0dWFsLCBkZXRhaWxlZCBjb250ZW50XG4gICAgY29uc3Qgc2VjdGlvbnMgPSB7IC4uLnN0cnVjdHVyZSB9XG5cbiAgICAvLyBFbmhhbmNlIHZvY2FidWxhcnkgc2VjdGlvbiB3aXRoIGNvbnRleHR1YWwgZXhhbXBsZXNcbiAgICBpZiAoc2VjdGlvbnMudm9jYWJ1bGFyeSkge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWN0aW9ucy52b2NhYnVsYXJ5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHZvY2FiID0gc2VjdGlvbnMudm9jYWJ1bGFyeVtpXVxuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGNvbnRleHR1YWxFeGFtcGxlUHJvbXB0ID0gYFxuQ3JlYXRlIGEgbmF0dXJhbCBleGFtcGxlIHNlbnRlbmNlIHVzaW5nIHRoZSB3b3JkIFwiJHt2b2NhYi53b3JkfVwiIHRoYXQgcmVsYXRlcyB0byB0aGlzIGNvbnRlbnQgY29udGV4dDpcblRvcGljczogJHtjb250ZW50QW5hbHlzaXMudG9waWNzLmpvaW4oJywgJyl9XG5Db250ZW50IHR5cGU6ICR7Y29udGVudEFuYWx5c2lzLmNvbnRlbnRUeXBlfVxuTGV2ZWw6ICR7c3R1ZGVudExldmVsfVxuXG5NYWtlIHRoZSBleGFtcGxlIHJlbGV2YW50IHRvIHRoZSBzb3VyY2UgbWF0ZXJpYWwgYW5kIGFwcHJvcHJpYXRlIGZvciAke3N0dWRlbnRMZXZlbH0gbGV2ZWwgc3R1ZGVudHMuXG5gXG4gICAgICAgICAgY29uc3QgZW5oYW5jZWRFeGFtcGxlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLndyaXRlKGNvbnRleHR1YWxFeGFtcGxlUHJvbXB0LCB7XG4gICAgICAgICAgICB0b25lOiBcImNhc3VhbFwiLFxuICAgICAgICAgICAgbGVuZ3RoOiBcInNob3J0XCJcbiAgICAgICAgICB9KVxuICAgICAgICAgIHNlY3Rpb25zLnZvY2FidWxhcnlbaV0uZXhhbXBsZSA9IGVuaGFuY2VkRXhhbXBsZVxuXG4gICAgICAgICAgLy8gQWRkIGNvbnRleHR1YWwgbWVhbmluZyBiYXNlZCBvbiBzb3VyY2UgY29udGVudFxuICAgICAgICAgIGNvbnN0IGNvbnRleHR1YWxNZWFuaW5nUHJvbXB0ID0gYFxuRXhwbGFpbiB0aGUgbWVhbmluZyBvZiBcIiR7dm9jYWIud29yZH1cIiBpbiB0aGUgY29udGV4dCBvZjogJHtjb250ZW50QW5hbHlzaXMudG9waWNzWzBdIHx8IGNvbnRlbnRBbmFseXNpcy5jb250ZW50VHlwZX1cbktlZXAgaXQgc2ltcGxlIGZvciAke3N0dWRlbnRMZXZlbH0gbGV2ZWwgc3R1ZGVudHMuXG5gXG4gICAgICAgICAgY29uc3QgY29udGV4dHVhbE1lYW5pbmcgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkud3JpdGUoY29udGV4dHVhbE1lYW5pbmdQcm9tcHQsIHtcbiAgICAgICAgICAgIHRvbmU6IFwiY2FzdWFsXCIsXG4gICAgICAgICAgICBsZW5ndGg6IFwic2hvcnRcIlxuICAgICAgICAgIH0pXG4gICAgICAgICAgc2VjdGlvbnMudm9jYWJ1bGFyeVtpXS5jb250ZXh0dWFsTWVhbmluZyA9IGNvbnRleHR1YWxNZWFuaW5nXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgLy8gS2VlcCBvcmlnaW5hbCBpZiBlbmhhbmNlbWVudCBmYWlsc1xuICAgICAgICAgIGNvbnNvbGUud2FybihgRmFpbGVkIHRvIGVuaGFuY2Ugdm9jYWJ1bGFyeSBmb3IgJHt2b2NhYi53b3JkfTpgLCBlcnJvcilcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEVuaGFuY2UgZGlzY3Vzc2lvbiBxdWVzdGlvbnMgd2l0aCBzcGVjaWZpYyBjb250ZW50IHJlZmVyZW5jZXNcbiAgICBpZiAoc2VjdGlvbnMuZGlzY3Vzc2lvbikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZW5oYW5jZWREaXNjdXNzaW9uUHJvbXB0ID0gYFxuRW5oYW5jZSB0aGVzZSBkaXNjdXNzaW9uIHF1ZXN0aW9ucyBmb3IgYSAke2xlc3NvblR5cGV9IGxlc3NvbiBhYm91dCAke2NvbnRlbnRBbmFseXNpcy50b3BpY3Muam9pbignIGFuZCAnKX06XG4ke3NlY3Rpb25zLmRpc2N1c3Npb24uam9pbignXFxuJyl9XG5cbk1ha2UgdGhlbSBtb3JlIHNwZWNpZmljIHRvIHRoZSBjb250ZW50LCBlbmdhZ2luZyBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsIHN0dWRlbnRzLCBhbmQgZW5jb3VyYWdlIGRlZXBlciB0aGlua2luZyBhYm91dDpcbi0gJHtjb250ZW50QW5hbHlzaXMudG9waWNzLnNsaWNlKDAsIDMpLmpvaW4oJ1xcbi0gJyl9XG5cblJldHVybiAzLTQgZW5oYW5jZWQgcXVlc3Rpb25zIHRoYXQgcmVmZXJlbmNlIHNwZWNpZmljIGFzcGVjdHMgb2YgdGhlIGNvbnRlbnQuXG5gXG4gICAgICAgIGNvbnN0IGVuaGFuY2VkRGlzY3Vzc2lvbiA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS53cml0ZShlbmhhbmNlZERpc2N1c3Npb25Qcm9tcHQsIHtcbiAgICAgICAgICB0b25lOiBcImNhc3VhbFwiLFxuICAgICAgICAgIGxlbmd0aDogXCJtZWRpdW1cIixcbiAgICAgICAgICBmb3JtYXQ6IFwiYnVsbGV0LXBvaW50c1wiXG4gICAgICAgIH0pXG4gICAgICAgIHNlY3Rpb25zLmRpc2N1c3Npb24gPSB0aGlzLnBhcnNlTGlzdEZyb21UZXh0KGVuaGFuY2VkRGlzY3Vzc2lvbikuc2xpY2UoMCwgNClcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIkZhaWxlZCB0byBlbmhhbmNlIGRpc2N1c3Npb24gcXVlc3Rpb25zOlwiLCBlcnJvcilcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBFbmhhbmNlIHJlYWRpbmcgc2VjdGlvbiB3aXRoIGJldHRlciBzdHJ1Y3R1cmVcbiAgICBpZiAoc2VjdGlvbnMucmVhZGluZyAmJiBzdHJ1Y3R1cmVkQ29udGVudD8uaGVhZGluZ3M/Lmxlbmd0aCA+IDApIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHN0cnVjdHVyZWRSZWFkaW5nUHJvbXB0ID0gYFxuSW1wcm92ZSB0aGlzIHJlYWRpbmcgdGV4dCBieSBvcmdhbml6aW5nIGl0IHdpdGggY2xlYXIgc3RydWN0dXJlIGJhc2VkIG9uIHRoZXNlIGhlYWRpbmdzIGZyb20gdGhlIG9yaWdpbmFsOlxuJHtzdHJ1Y3R1cmVkQ29udGVudC5oZWFkaW5ncy5zbGljZSgwLCAzKS5tYXAoaCA9PiBgLSAke2gudGV4dH1gKS5qb2luKCdcXG4nKX1cblxuT3JpZ2luYWwgdGV4dDogXCIke3NlY3Rpb25zLnJlYWRpbmd9XCJcblxuQ3JlYXRlIGEgd2VsbC1zdHJ1Y3R1cmVkLCAke3N0dWRlbnRMZXZlbH0tYXBwcm9wcmlhdGUgcmVhZGluZyBwYXNzYWdlIHRoYXQgbWFpbnRhaW5zIHRoZSBrZXkgaW5mb3JtYXRpb24gYnV0IGltcHJvdmVzIHJlYWRhYmlsaXR5LlxuYFxuICAgICAgICBjb25zdCBlbmhhbmNlZFJlYWRpbmcgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucmV3cml0ZShzZWN0aW9ucy5yZWFkaW5nLCB7XG4gICAgICAgICAgdG9uZTogXCJjYXN1YWxcIixcbiAgICAgICAgICBsZW5ndGg6IFwic2FtZVwiLFxuICAgICAgICAgIGF1ZGllbmNlOiB0aGlzLmdldEF1ZGllbmNlTGV2ZWwoc3R1ZGVudExldmVsKVxuICAgICAgICB9KVxuICAgICAgICBzZWN0aW9ucy5yZWFkaW5nID0gZW5oYW5jZWRSZWFkaW5nXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJGYWlsZWQgdG8gZW5oYW5jZSByZWFkaW5nIHNlY3Rpb246XCIsIGVycm9yKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEVuaGFuY2UgZ3JhbW1hciBzZWN0aW9uIHdpdGggY29udGVudC1zcGVjaWZpYyBleGFtcGxlc1xuICAgIGlmIChzZWN0aW9ucy5ncmFtbWFyICYmIHNlY3Rpb25zLmdyYW1tYXIuZm9jdXMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGdyYW1tYXJFeGFtcGxlc1Byb21wdCA9IGBcbkNyZWF0ZSAzIGdyYW1tYXIgZXhhbXBsZXMgZm9yIFwiJHtzZWN0aW9ucy5ncmFtbWFyLmZvY3VzfVwiIHVzaW5nIHZvY2FidWxhcnkgYW5kIGNvbmNlcHRzIGZyb20gdGhpcyBjb250ZW50OlxuVG9waWNzOiAke2NvbnRlbnRBbmFseXNpcy50b3BpY3Muam9pbignLCAnKX1cbktleSB2b2NhYnVsYXJ5OiAke2NvbnRlbnRBbmFseXNpcy5rZXlWb2NhYnVsYXJ5LnNsaWNlKDAsIDUpLmpvaW4oJywgJyl9XG5cbk1ha2UgZXhhbXBsZXMgcmVsZXZhbnQgdG8gdGhlIGNvbnRlbnQgYW5kIGFwcHJvcHJpYXRlIGZvciAke3N0dWRlbnRMZXZlbH0gbGV2ZWwuXG5gXG4gICAgICAgIGNvbnN0IGNvbnRleHR1YWxHcmFtbWFyRXhhbXBsZXMgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkud3JpdGUoZ3JhbW1hckV4YW1wbGVzUHJvbXB0LCB7XG4gICAgICAgICAgdG9uZTogXCJjYXN1YWxcIixcbiAgICAgICAgICBsZW5ndGg6IFwic2hvcnRcIixcbiAgICAgICAgICBmb3JtYXQ6IFwiYnVsbGV0LXBvaW50c1wiXG4gICAgICAgIH0pXG4gICAgICAgIHNlY3Rpb25zLmdyYW1tYXIuY29udGV4dHVhbEV4YW1wbGVzID0gdGhpcy5wYXJzZUxpc3RGcm9tVGV4dChjb250ZXh0dWFsR3JhbW1hckV4YW1wbGVzKVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwiRmFpbGVkIHRvIGVuaGFuY2UgZ3JhbW1hciBleGFtcGxlczpcIiwgZXJyb3IpXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHNlY3Rpb25zXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHByb29mcmVhZExlc3NvbihsZXNzb246IGFueSkge1xuICAgIC8vIFByb29mcmVhZCBrZXkgdGV4dCBzZWN0aW9uc1xuICAgIGNvbnN0IHNlY3Rpb25zVG9Qcm9vZnJlYWQgPSBbXCJyZWFkaW5nXCIsIFwiZ3JhbW1hci5leGFtcGxlc1wiLCBcInByb251bmNpYXRpb24ucHJhY3RpY2VcIl1cblxuICAgIGZvciAoY29uc3Qgc2VjdGlvblBhdGggb2Ygc2VjdGlvbnNUb1Byb29mcmVhZCkge1xuICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmdldE5lc3RlZFZhbHVlKGxlc3Nvbiwgc2VjdGlvblBhdGgpXG4gICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGNvbnN0IHByb29mcmVhZCA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9vZnJlYWQodmFsdWUsIHtcbiAgICAgICAgICBjaGVja0dyYW1tYXI6IHRydWUsXG4gICAgICAgICAgY2hlY2tTcGVsbGluZzogdHJ1ZSxcbiAgICAgICAgICBjaGVja1N0eWxlOiB0cnVlLFxuICAgICAgICB9KVxuICAgICAgICB0aGlzLnNldE5lc3RlZFZhbHVlKGxlc3Nvbiwgc2VjdGlvblBhdGgsIHByb29mcmVhZC5jb3JyZWN0ZWRfdGV4dClcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbGVzc29uXG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlRmFsbGJhY2tMZXNzb24ocGFyYW1zOiBMZXNzb25HZW5lcmF0aW9uUGFyYW1zKTogR2VuZXJhdGVkTGVzc29uIHtcbiAgICAvLyBUZW1wbGF0ZS1iYXNlZCBmYWxsYmFjayB3aGVuIEFJIEFQSXMgZmFpbFxuICAgIGNvbnN0IHsgc291cmNlVGV4dCwgbGVzc29uVHlwZSwgc3R1ZGVudExldmVsLCB0YXJnZXRMYW5ndWFnZSB9ID0gcGFyYW1zXG5cbiAgICByZXR1cm4ge1xuICAgICAgbGVzc29uVHlwZSxcbiAgICAgIHN0dWRlbnRMZXZlbCxcbiAgICAgIHRhcmdldExhbmd1YWdlLFxuICAgICAgc2VjdGlvbnM6IHtcbiAgICAgICAgd2FybXVwOiB0aGlzLmdldFRlbXBsYXRlV2FybXVwKGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCksXG4gICAgICAgIHZvY2FidWxhcnk6IHRoaXMuZXh0cmFjdFZvY2FidWxhcnkoc291cmNlVGV4dCwgc3R1ZGVudExldmVsKSxcbiAgICAgICAgcmVhZGluZzogdGhpcy5zaW1wbGlmeVRleHQoc291cmNlVGV4dCwgc3R1ZGVudExldmVsKSxcbiAgICAgICAgY29tcHJlaGVuc2lvbjogdGhpcy5nZXRUZW1wbGF0ZUNvbXByZWhlbnNpb24obGVzc29uVHlwZSwgc3R1ZGVudExldmVsKSxcbiAgICAgICAgZGlzY3Vzc2lvbjogdGhpcy5nZXRUZW1wbGF0ZURpc2N1c3Npb24obGVzc29uVHlwZSwgc3R1ZGVudExldmVsKSxcbiAgICAgICAgZ3JhbW1hcjogdGhpcy5nZXRUZW1wbGF0ZUdyYW1tYXIoc3R1ZGVudExldmVsKSxcbiAgICAgICAgcHJvbnVuY2lhdGlvbjogdGhpcy5nZXRUZW1wbGF0ZVByb251bmNpYXRpb24oc291cmNlVGV4dCksXG4gICAgICAgIHdyYXB1cDogdGhpcy5nZXRUZW1wbGF0ZVdyYXB1cChsZXNzb25UeXBlKSxcbiAgICAgIH0sXG4gICAgfVxuICB9XG5cbiAgLy8gSGVscGVyIG1ldGhvZHNcbiAgcHJpdmF0ZSBnZXRTdW1tYXJ5TGVuZ3RoKGxldmVsOiBzdHJpbmcpOiBcInNob3J0XCIgfCBcIm1lZGl1bVwiIHwgXCJsb25nXCIge1xuICAgIGNvbnN0IGxlbmd0aE1hcCA9IHtcbiAgICAgIEExOiBcInNob3J0XCIgYXMgY29uc3QsXG4gICAgICBBMjogXCJzaG9ydFwiIGFzIGNvbnN0LFxuICAgICAgQjE6IFwibWVkaXVtXCIgYXMgY29uc3QsXG4gICAgICBCMjogXCJtZWRpdW1cIiBhcyBjb25zdCxcbiAgICAgIEMxOiBcImxvbmdcIiBhcyBjb25zdCxcbiAgICB9XG4gICAgcmV0dXJuIGxlbmd0aE1hcFtsZXZlbF0gfHwgXCJtZWRpdW1cIlxuICB9XG5cbiAgcHJpdmF0ZSBnZXRMYW5ndWFnZUNvZGUobGFuZ3VhZ2U6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgbGFuZ3VhZ2VNYXAgPSB7XG4gICAgICBzcGFuaXNoOiBcImVzXCIsXG4gICAgICBmcmVuY2g6IFwiZnJcIixcbiAgICAgIGdlcm1hbjogXCJkZVwiLFxuICAgICAgaXRhbGlhbjogXCJpdFwiLFxuICAgICAgcG9ydHVndWVzZTogXCJwdFwiLFxuICAgICAgamFwYW5lc2U6IFwiamFcIixcbiAgICAgIGtvcmVhbjogXCJrb1wiLFxuICAgICAgY2hpbmVzZTogXCJ6aFwiLFxuICAgIH1cbiAgICByZXR1cm4gbGFuZ3VhZ2VNYXBbbGFuZ3VhZ2VdIHx8IFwiZW5cIlxuICB9XG5cbiAgcHJpdmF0ZSBwYXJzZUxpc3RGcm9tVGV4dCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIHRleHRcbiAgICAgIC5zcGxpdChcIlxcblwiKVxuICAgICAgLmZpbHRlcigobGluZSkgPT4gbGluZS50cmltKCkpXG4gICAgICAubWFwKChsaW5lKSA9PiBsaW5lLnJlcGxhY2UoL15bLeKAoipdXFxzKi8sIFwiXCIpLnRyaW0oKSlcbiAgICAgIC5maWx0ZXIoKGxpbmUpID0+IGxpbmUubGVuZ3RoID4gMClcbiAgICAgIC5zbGljZSgwLCA0KSAvLyBMaW1pdCB0byA0IGl0ZW1zXG4gIH1cblxuICBwcml2YXRlIGdldE5lc3RlZFZhbHVlKG9iajogYW55LCBwYXRoOiBzdHJpbmcpOiBhbnkge1xuICAgIHJldHVybiBwYXRoLnNwbGl0KFwiLlwiKS5yZWR1Y2UoKGN1cnJlbnQsIGtleSkgPT4gY3VycmVudD8uW2tleV0sIG9iailcbiAgfVxuXG4gIHByaXZhdGUgc2V0TmVzdGVkVmFsdWUob2JqOiBhbnksIHBhdGg6IHN0cmluZywgdmFsdWU6IGFueSk6IHZvaWQge1xuICAgIGNvbnN0IGtleXMgPSBwYXRoLnNwbGl0KFwiLlwiKVxuICAgIGNvbnN0IGxhc3RLZXkgPSBrZXlzLnBvcCgpIVxuICAgIGNvbnN0IHRhcmdldCA9IGtleXMucmVkdWNlKChjdXJyZW50LCBrZXkpID0+IGN1cnJlbnRba2V5XSwgb2JqKVxuICAgIHRhcmdldFtsYXN0S2V5XSA9IHZhbHVlXG4gIH1cblxuICBwcml2YXRlIGNyZWF0ZVN0cnVjdHVyZWRGYWxsYmFjayhjb250ZW50OiBzdHJpbmcsIGxlc3NvblR5cGU6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpIHtcbiAgICBjb25zb2xlLmxvZyhcIvCflIQgQ3JlYXRpbmcgc3RydWN0dXJlZCBmYWxsYmFjayBsZXNzb24uLi5cIilcblxuICAgIC8vIEV4dHJhY3Qgc29tZSBiYXNpYyBpbmZvcm1hdGlvbiBmcm9tIGNvbnRlbnQgZm9yIGJldHRlciBmYWxsYmFja1xuICAgIGNvbnN0IHdvcmRzID0gY29udGVudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9cXGJbYS16XXs0LH1cXGIvZykgfHwgW11cbiAgICBjb25zdCB1bmlxdWVXb3JkcyA9IEFycmF5LmZyb20obmV3IFNldCh3b3JkcykpLnNsaWNlKDAsIDYpXG5cbiAgICBjb25zdCBmYWxsYmFjayA9IHtcbiAgICAgIHdhcm11cDogW10sIC8vIFdpbGwgYmUgc2V0IGJ5IGNhbGxlciB3aXRoIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnNcbiAgICAgIHZvY2FidWxhcnk6IHVuaXF1ZVdvcmRzLm1hcCh3b3JkID0+ICh7XG4gICAgICAgIHdvcmQ6IHdvcmQsXG4gICAgICAgIG1lYW5pbmc6IGBEZWZpbml0aW9uIG9mICR7d29yZH1gLFxuICAgICAgICBleGFtcGxlOiBgRXhhbXBsZSBzZW50ZW5jZSB3aXRoICR7d29yZH0uYFxuICAgICAgfSkpLFxuICAgICAgcmVhZGluZzogdGhpcy5zaW1wbGlmeVRleHQoY29udGVudCwgc3R1ZGVudExldmVsKSxcbiAgICAgIGNvbXByZWhlbnNpb246IHRoaXMuZ2V0VGVtcGxhdGVDb21wcmVoZW5zaW9uKGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCksXG4gICAgICBkaXNjdXNzaW9uOiB0aGlzLmdldFRlbXBsYXRlRGlzY3Vzc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpLFxuICAgICAgZ3JhbW1hcjogdGhpcy5nZXRUZW1wbGF0ZUdyYW1tYXIoc3R1ZGVudExldmVsKSxcbiAgICAgIHByb251bmNpYXRpb246IHRoaXMuZ2V0VGVtcGxhdGVQcm9udW5jaWF0aW9uKGNvbnRlbnQpLFxuICAgICAgd3JhcHVwOiB0aGlzLmdldFRlbXBsYXRlV3JhcHVwKGxlc3NvblR5cGUpLFxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKFwi4pyFIFN0cnVjdHVyZWQgZmFsbGJhY2sgY3JlYXRlZCAod2FybXVwIHdpbGwgYmUgc2V0IGJ5IGNhbGxlcilcIilcbiAgICByZXR1cm4gZmFsbGJhY2tcbiAgfVxuXG4gIHByaXZhdGUgZ2V0VGVtcGxhdGVXYXJtdXAobGVzc29uVHlwZTogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCB0ZW1wbGF0ZXMgPSB7XG4gICAgICBkaXNjdXNzaW9uOiBbXG4gICAgICAgIFwiV2hhdCBkbyB5b3UgYWxyZWFkeSBrbm93IGFib3V0IHRoaXMgdG9waWM/XCIsXG4gICAgICAgIFwiSGF2ZSB5b3UgaGFkIHNpbWlsYXIgZXhwZXJpZW5jZXM/XCIsXG4gICAgICAgIFwiV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBsZWFybiBtb3JlIGFib3V0P1wiLFxuICAgICAgXSxcbiAgICAgIGdyYW1tYXI6IFtcbiAgICAgICAgXCJXaGF0IGdyYW1tYXIgcGF0dGVybnMgZG8geW91IG5vdGljZT9cIixcbiAgICAgICAgXCJXaGljaCBzZW50ZW5jZXMgc2VlbSBtb3N0IGNvbXBsZXg/XCIsXG4gICAgICAgIFwiV2hhdCBncmFtbWFyIHJ1bGVzIGRvIHlvdSByZW1lbWJlcj9cIixcbiAgICAgIF0sXG4gICAgICB0cmF2ZWw6IFtcbiAgICAgICAgXCJXaGVyZSB3b3VsZCB5b3UgbGlrZSB0byB0cmF2ZWwgbmV4dD9cIixcbiAgICAgICAgXCJXaGF0IHRyYXZlbCBleHBlcmllbmNlcyBoYXZlIHlvdSBoYWQ/XCIsXG4gICAgICAgIFwiV2hhdCB0cmF2ZWwgdm9jYWJ1bGFyeSBkbyB5b3Uga25vdz9cIixcbiAgICAgIF0sXG4gICAgICBidXNpbmVzczogW1xuICAgICAgICBcIldoYXQgYnVzaW5lc3Mgc2l0dWF0aW9ucyBhcmUgeW91IGZhbWlsaWFyIHdpdGg/XCIsXG4gICAgICAgIFwiSG93IGRvIHlvdSBjb21tdW5pY2F0ZSBwcm9mZXNzaW9uYWxseT9cIixcbiAgICAgICAgXCJXaGF0IGJ1c2luZXNzIHRlcm1zIGFyZSBjaGFsbGVuZ2luZz9cIixcbiAgICAgIF0sXG4gICAgICBwcm9udW5jaWF0aW9uOiBbXG4gICAgICAgIFwiV2hpY2ggc291bmRzIGFyZSBkaWZmaWN1bHQgdG8gcHJvbm91bmNlP1wiLFxuICAgICAgICBcIkhvdyBkbyB5b3UgcHJhY3RpY2UgcHJvbnVuY2lhdGlvbj9cIixcbiAgICAgICAgXCJXaGF0IHByb251bmNpYXRpb24gZ29hbHMgZG8geW91IGhhdmU/XCIsXG4gICAgICBdLFxuICAgIH1cbiAgICByZXR1cm4gdGVtcGxhdGVzW2xlc3NvblR5cGVdIHx8IHRlbXBsYXRlcy5kaXNjdXNzaW9uXG4gIH1cblxuICBwcml2YXRlIGV4dHJhY3RWb2NhYnVsYXJ5KHRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpIHtcbiAgICAvLyBTaW1wbGUgdm9jYWJ1bGFyeSBleHRyYWN0aW9uIGJhc2VkIG9uIHdvcmQgZnJlcXVlbmN5IGFuZCBjb21wbGV4aXR5XG4gICAgY29uc3Qgd29yZHMgPSB0ZXh0LnRvTG93ZXJDYXNlKCkubWF0Y2goL1xcYlthLXpdezQsfVxcYi9nKSB8fCBbXVxuICAgIGNvbnN0IHVuaXF1ZVdvcmRzID0gQXJyYXkuZnJvbShuZXcgU2V0KHdvcmRzKSlcbiAgICBjb25zdCBzZWxlY3RlZFdvcmRzID0gdW5pcXVlV29yZHMuc2xpY2UoMCwgNilcblxuICAgIHJldHVybiBzZWxlY3RlZFdvcmRzLm1hcCgod29yZCkgPT4gKHtcbiAgICAgIHdvcmQ6IHdvcmQsXG4gICAgICBtZWFuaW5nOiBgRGVmaW5pdGlvbiBvZiAke3dvcmR9YCxcbiAgICAgIGV4YW1wbGU6IGBFeGFtcGxlIHNlbnRlbmNlIHdpdGggJHt3b3JkfS5gLFxuICAgIH0pKVxuICB9XG5cbiAgcHJpdmF0ZSBzaW1wbGlmeVRleHQodGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gQmFzaWMgdGV4dCBzaW1wbGlmaWNhdGlvbiBiYXNlZCBvbiBsZXZlbFxuICAgIGNvbnN0IG1heExlbmd0aCA9IHtcbiAgICAgIEExOiAyMDAsXG4gICAgICBBMjogMzAwLFxuICAgICAgQjE6IDQwMCxcbiAgICAgIEIyOiA1MDAsXG4gICAgICBDMTogNjAwLFxuICAgIH1cblxuICAgIGNvbnN0IGxpbWl0ID0gbWF4TGVuZ3RoW3N0dWRlbnRMZXZlbF0gfHwgNDAwXG4gICAgcmV0dXJuIHRleHQuc3Vic3RyaW5nKDAsIGxpbWl0KSArICh0ZXh0Lmxlbmd0aCA+IGxpbWl0ID8gXCIuLi5cIiA6IFwiXCIpXG4gIH1cblxuICBwcml2YXRlIGdldFRlbXBsYXRlQ29tcHJlaGVuc2lvbihsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBbXG4gICAgICBcIldoYXQgaXMgdGhlIG1haW4gaWRlYSBvZiB0aGlzIHRleHQ/XCIsXG4gICAgICBcIldoYXQgc3VwcG9ydGluZyBkZXRhaWxzIGNhbiB5b3UgaWRlbnRpZnk/XCIsXG4gICAgICBcIkhvdyBkb2VzIHRoaXMgcmVsYXRlIHRvIHlvdXIgZXhwZXJpZW5jZT9cIixcbiAgICAgIFwiV2hhdCBjb25jbHVzaW9ucyBjYW4geW91IGRyYXc/XCIsXG4gICAgXVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRUZW1wbGF0ZURpc2N1c3Npb24obGVzc29uVHlwZTogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCB0ZW1wbGF0ZXMgPSB7XG4gICAgICBkaXNjdXNzaW9uOiBbXG4gICAgICAgIFwiV2hhdCBpcyB5b3VyIG9waW5pb24gb24gdGhpcyB0b3BpYz9cIixcbiAgICAgICAgXCJIb3cgd291bGQgeW91IGhhbmRsZSB0aGlzIHNpdHVhdGlvbj9cIixcbiAgICAgICAgXCJXaGF0IGFsdGVybmF0aXZlIGFwcHJvYWNoZXMgZXhpc3Q/XCIsXG4gICAgICBdLFxuICAgICAgYnVzaW5lc3M6IFtcbiAgICAgICAgXCJIb3cgd291bGQgeW91IGFwcGx5IHRoaXMgcHJvZmVzc2lvbmFsbHk/XCIsXG4gICAgICAgIFwiV2hhdCBidXNpbmVzcyBjaGFsbGVuZ2VzIGRvZXMgdGhpcyBhZGRyZXNzP1wiLFxuICAgICAgICBcIkhvdyB3b3VsZCB5b3UgcHJlc2VudCB0aGlzIHRvIGNvbGxlYWd1ZXM/XCIsXG4gICAgICBdLFxuICAgICAgdHJhdmVsOiBbXG4gICAgICAgIFwiSG93IHdvdWxkIHRoaXMgaGVscCB3aGlsZSB0cmF2ZWxpbmc/XCIsXG4gICAgICAgIFwiV2hhdCBwcmVwYXJhdGlvbnMgd291bGQgeW91IG1ha2U/XCIsXG4gICAgICAgIFwiSG93IHdvdWxkIHlvdSBzaGFyZSB0aGlzIGV4cGVyaWVuY2U/XCIsXG4gICAgICBdLFxuICAgIH1cbiAgICByZXR1cm4gdGVtcGxhdGVzW2xlc3NvblR5cGVdIHx8IHRlbXBsYXRlcy5kaXNjdXNzaW9uXG4gIH1cblxuICBwcml2YXRlIGdldFRlbXBsYXRlR3JhbW1hcihzdHVkZW50TGV2ZWw6IHN0cmluZykge1xuICAgIGNvbnN0IGdyYW1tYXJGb2NpID0ge1xuICAgICAgQTE6IFwiUHJlc2VudCBTaW1wbGUgVGVuc2VcIixcbiAgICAgIEEyOiBcIlBhc3QgU2ltcGxlIFRlbnNlXCIsXG4gICAgICBCMTogXCJQcmVzZW50IFBlcmZlY3QgVGVuc2VcIixcbiAgICAgIEIyOiBcIkNvbmRpdGlvbmFsIFNlbnRlbmNlc1wiLFxuICAgICAgQzE6IFwiQWR2YW5jZWQgR3JhbW1hciBTdHJ1Y3R1cmVzXCIsXG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGZvY3VzOiBncmFtbWFyRm9jaVtzdHVkZW50TGV2ZWxdIHx8IFwiUHJlc2VudCBQZXJmZWN0IFRlbnNlXCIsXG4gICAgICBleGFtcGxlczogW1wiSSBoYXZlIGxlYXJuZWQgbWFueSBuZXcgdGhpbmdzLlwiLCBcIlNoZSBoYXMgaW1wcm92ZWQgaGVyIHNraWxscy5cIiwgXCJXZSBoYXZlIGRpc2N1c3NlZCB0aGlzIHRvcGljLlwiXSxcbiAgICAgIGV4ZXJjaXNlOiBbXG4gICAgICAgIFwiSSBfX19fXyAobGVhcm4pIGEgbG90IHRvZGF5LlwiLFxuICAgICAgICBcIlRoZXkgX19fX18gKGNvbXBsZXRlKSB0aGUgcHJvamVjdC5cIixcbiAgICAgICAgXCJTaGUgX19fX18gKGltcHJvdmUpIHNpZ25pZmljYW50bHkuXCIsXG4gICAgICBdLFxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0VGVtcGxhdGVQcm9udW5jaWF0aW9uKHRleHQ6IHN0cmluZykge1xuICAgIC8vIEV4dHJhY3QgYSBjaGFsbGVuZ2luZyB3b3JkIGZyb20gdGhlIHRleHRcbiAgICBjb25zdCB3b3JkcyA9IHRleHQubWF0Y2goL1xcYlthLXpdezYsfVxcYi9naSkgfHwgW1wiY29tbXVuaWNhdGlvblwiXVxuICAgIGNvbnN0IHNlbGVjdGVkV29yZCA9IHdvcmRzWzBdIHx8IFwiY29tbXVuaWNhdGlvblwiXG5cbiAgICByZXR1cm4ge1xuICAgICAgd29yZDogc2VsZWN0ZWRXb3JkLnRvTG93ZXJDYXNlKCksXG4gICAgICBpcGE6IFwiL2vJmcuMbWp1y5BuyarLiGtlyarKg8mZbi9cIixcbiAgICAgIHByYWN0aWNlOiBgUHJhY3RpY2Ugc2F5aW5nOiBcIiR7c2VsZWN0ZWRXb3JkfVwiIGluIGEgc2VudGVuY2UuYCxcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldFRlbXBsYXRlV3JhcHVwKGxlc3NvblR5cGU6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gW1xuICAgICAgXCJXaGF0IG5ldyB2b2NhYnVsYXJ5IGRpZCB5b3UgbGVhcm4/XCIsXG4gICAgICBcIldoaWNoIGNvbmNlcHRzIG5lZWQgbW9yZSBwcmFjdGljZT9cIixcbiAgICAgIFwiSG93IHdpbGwgeW91IHVzZSB0aGlzIGtub3dsZWRnZT9cIixcbiAgICAgIFwiV2hhdCBxdWVzdGlvbnMgZG8geW91IHN0aWxsIGhhdmU/XCIsXG4gICAgXVxuICB9XG5cbiAgLy8gTmV3IGhlbHBlciBtZXRob2RzIGZvciBlbmhhbmNlZCBjb250ZXh0dWFsIGFuYWx5c2lzXG5cbiAgcHJpdmF0ZSBleHRyYWN0VG9waWNzRnJvbUhlYWRpbmdzKGhlYWRpbmdzOiBBcnJheTx7IGxldmVsOiBudW1iZXI7IHRleHQ6IHN0cmluZyB9Pik6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gaGVhZGluZ3NcbiAgICAgIC5maWx0ZXIoaCA9PiBoLmxldmVsIDw9IDMpIC8vIEZvY3VzIG9uIG1haW4gaGVhZGluZ3NcbiAgICAgIC5tYXAoaCA9PiBoLnRleHQpXG4gICAgICAuc2xpY2UoMCwgNSlcbiAgfVxuXG4gIHByaXZhdGUgZXh0cmFjdFRvcGljc0Zyb21UZXh0KHRleHQ6IHN0cmluZywgaGVhZGluZ3M6IEFycmF5PHsgbGV2ZWw6IG51bWJlcjsgdGV4dDogc3RyaW5nIH0+KTogc3RyaW5nW10ge1xuICAgIC8vIEZpcnN0IHRyeSB0byBnZXQgdG9waWNzIGZyb20gaGVhZGluZ3NcbiAgICBjb25zdCBoZWFkaW5nVG9waWNzID0gdGhpcy5leHRyYWN0VG9waWNzRnJvbUhlYWRpbmdzKGhlYWRpbmdzKVxuICAgIGlmIChoZWFkaW5nVG9waWNzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBoZWFkaW5nVG9waWNzXG4gICAgfVxuXG4gICAgLy8gRmFsbGJhY2s6IGV4dHJhY3Qga2V5IHBocmFzZXMgZnJvbSB0ZXh0XG4gICAgY29uc3Qgc2VudGVuY2VzID0gdGV4dC5zcGxpdCgvWy4hP10rLykuZmlsdGVyKHMgPT4gcy50cmltKCkubGVuZ3RoID4gMjApXG4gICAgY29uc3QgdG9waWNzID0gW11cblxuICAgIC8vIExvb2sgZm9yIGNvbW1vbiB0b3BpYyBpbmRpY2F0b3JzXG4gICAgY29uc3QgdG9waWNQYXR0ZXJucyA9IFtcbiAgICAgIC9hYm91dCAoLis/KSg/Olxcc3wsfFxcLikvZ2ksXG4gICAgICAvZGlzY3VzcyAoLis/KSg/Olxcc3wsfFxcLikvZ2ksXG4gICAgICAvZm9jdXMgb24gKC4rPykoPzpcXHN8LHxcXC4pL2dpLFxuICAgICAgL3JlZ2FyZGluZyAoLis/KSg/Olxcc3wsfFxcLikvZ2ksXG4gICAgXVxuXG4gICAgZm9yIChjb25zdCBzZW50ZW5jZSBvZiBzZW50ZW5jZXMuc2xpY2UoMCwgNSkpIHtcbiAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiB0b3BpY1BhdHRlcm5zKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoZXMgPSBzZW50ZW5jZS5tYXRjaChwYXR0ZXJuKVxuICAgICAgICBpZiAobWF0Y2hlcykge1xuICAgICAgICAgIHRvcGljcy5wdXNoKC4uLm1hdGNoZXMubWFwKG0gPT4gbS5yZXBsYWNlKHBhdHRlcm4sICckMScpLnRyaW0oKSkuc2xpY2UoMCwgMikpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBJZiBubyBwYXR0ZXJucyBmb3VuZCwgZXh0cmFjdCBrZXkgbm91bnNcbiAgICBpZiAodG9waWNzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc3Qgd29yZHMgPSB0ZXh0LnRvTG93ZXJDYXNlKCkubWF0Y2goL1xcYlthLXpdezQsfVxcYi9nKSB8fCBbXVxuICAgICAgY29uc3QgY29tbW9uV29yZHMgPSBbJ3RoaXMnLCAndGhhdCcsICd3aXRoJywgJ2Zyb20nLCAndGhleScsICdoYXZlJywgJ2JlZW4nLCAnd2lsbCcsICdtb3JlJywgJ3NvbWUnLCAnd2hhdCcsICd3aGVuJywgJ3doZXJlJywgJ3doaWNoJywgJ3RoZWlyJywgJ3dvdWxkJywgJ2NvdWxkJywgJ3Nob3VsZCddXG4gICAgICBjb25zdCBrZXlXb3JkcyA9IHdvcmRzXG4gICAgICAgIC5maWx0ZXIod29yZCA9PiAhY29tbW9uV29yZHMuaW5jbHVkZXMod29yZCkpXG4gICAgICAgIC5maWx0ZXIoKHdvcmQsIGluZGV4LCBhcnIpID0+IGFyci5pbmRleE9mKHdvcmQpID09PSBpbmRleCkgLy8gdW5pcXVlXG4gICAgICAgIC5zbGljZSgwLCAzKVxuXG4gICAgICByZXR1cm4ga2V5V29yZHMubGVuZ3RoID4gMCA/IGtleVdvcmRzIDogWydBSSB0ZWNobm9sb2d5JywgJ21vYmlsZSBkZXZpY2VzJywgJ3ByaXZhY3knXVxuICAgIH1cblxuICAgIHJldHVybiB0b3BpY3Muc2xpY2UoMCwgMylcbiAgfVxuXG4gIHByaXZhdGUgZXh0cmFjdFZvY2FidWxhcnlGcm9tVGV4dCh0ZXh0OiBzdHJpbmcsIGxldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgLy8gRXh0cmFjdCB3b3JkcyBiYXNlZCBvbiBjb21wbGV4aXR5IGFwcHJvcHJpYXRlIGZvciB0aGUgbGV2ZWxcbiAgICBjb25zdCB3b3JkcyA9IHRleHQudG9Mb3dlckNhc2UoKS5tYXRjaCgvXFxiW2Etel17NCx9XFxiL2cpIHx8IFtdXG4gICAgY29uc3QgdW5pcXVlV29yZHMgPSBBcnJheS5mcm9tKG5ldyBTZXQod29yZHMpKVxuXG4gICAgLy8gRmlsdGVyIGJ5IGNvbXBsZXhpdHkgYmFzZWQgb24gbGV2ZWxcbiAgICBjb25zdCBjb21wbGV4aXR5VGhyZXNob2xkID0ge1xuICAgICAgJ0ExJzogNixcbiAgICAgICdBMic6IDcsXG4gICAgICAnQjEnOiA4LFxuICAgICAgJ0IyJzogMTAsXG4gICAgICAnQzEnOiAxMlxuICAgIH1cblxuICAgIGNvbnN0IG1heExlbmd0aCA9IGNvbXBsZXhpdHlUaHJlc2hvbGRbbGV2ZWxdIHx8IDhcbiAgICByZXR1cm4gdW5pcXVlV29yZHNcbiAgICAgIC5maWx0ZXIod29yZCA9PiB3b3JkLmxlbmd0aCA8PSBtYXhMZW5ndGggJiYgd29yZC5sZW5ndGggPj0gNClcbiAgICAgIC5zbGljZSgwLCA4KVxuICB9XG5cbiAgcHJpdmF0ZSBkZXRlcm1pbmVDdWx0dXJhbENvbnRleHQoZG9tYWluOiBzdHJpbmcsIHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gRGV0ZXJtaW5lIGN1bHR1cmFsIGNvbnRleHQgYmFzZWQgb24gZG9tYWluIGFuZCBjb250ZW50XG4gICAgY29uc3QgY3VsdHVyYWxJbmRpY2F0b3JzID0ge1xuICAgICAgJ2JiYy5jb20nOiAnQnJpdGlzaCBFbmdsaXNoLCBVSyBjdWx0dXJlJyxcbiAgICAgICdjbm4uY29tJzogJ0FtZXJpY2FuIEVuZ2xpc2gsIFVTIGN1bHR1cmUnLFxuICAgICAgJ3dpa2lwZWRpYS5vcmcnOiAnSW50ZXJuYXRpb25hbCwgZW5jeWNsb3BlZGljJyxcbiAgICAgICdueXRpbWVzLmNvbSc6ICdBbWVyaWNhbiBFbmdsaXNoLCBVUyBwZXJzcGVjdGl2ZScsXG4gICAgICAndGhlZ3VhcmRpYW4uY29tJzogJ0JyaXRpc2ggRW5nbGlzaCwgVUsgcGVyc3BlY3RpdmUnLFxuICAgIH1cblxuICAgIGlmIChjdWx0dXJhbEluZGljYXRvcnNbZG9tYWluXSkge1xuICAgICAgcmV0dXJuIGN1bHR1cmFsSW5kaWNhdG9yc1tkb21haW5dXG4gICAgfVxuXG4gICAgLy8gQW5hbHl6ZSB0ZXh0IGZvciBjdWx0dXJhbCBtYXJrZXJzXG4gICAgY29uc3QgYW1lcmljYW5NYXJrZXJzID0gWydkb2xsYXInLCAncHJlc2lkZW50JywgJ2NvbmdyZXNzJywgJ3N0YXRlJywgJ2ZlZGVyYWwnXVxuICAgIGNvbnN0IGJyaXRpc2hNYXJrZXJzID0gWydwb3VuZCcsICdtaW5pc3RlcicsICdwYXJsaWFtZW50JywgJ2NvdW5jaWwnLCAnZ292ZXJubWVudCddXG5cbiAgICBjb25zdCBhbWVyaWNhbkNvdW50ID0gYW1lcmljYW5NYXJrZXJzLmZpbHRlcihtYXJrZXIgPT5cbiAgICAgIHRleHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhtYXJrZXIpXG4gICAgKS5sZW5ndGhcblxuICAgIGNvbnN0IGJyaXRpc2hDb3VudCA9IGJyaXRpc2hNYXJrZXJzLmZpbHRlcihtYXJrZXIgPT5cbiAgICAgIHRleHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhtYXJrZXIpXG4gICAgKS5sZW5ndGhcblxuICAgIGlmIChhbWVyaWNhbkNvdW50ID4gYnJpdGlzaENvdW50KSB7XG4gICAgICByZXR1cm4gJ0FtZXJpY2FuIEVuZ2xpc2ggY29udGV4dCdcbiAgICB9IGVsc2UgaWYgKGJyaXRpc2hDb3VudCA+IGFtZXJpY2FuQ291bnQpIHtcbiAgICAgIHJldHVybiAnQnJpdGlzaCBFbmdsaXNoIGNvbnRleHQnXG4gICAgfVxuXG4gICAgcmV0dXJuICdJbnRlcm5hdGlvbmFsIGNvbnRleHQnXG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlTGVhcm5pbmdPYmplY3RpdmVzKGNvbnRlbnRUeXBlOiBzdHJpbmcsIHRvcGljczogc3RyaW5nW10sIGxldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3Qgb2JqZWN0aXZlcyA9IFtdXG5cbiAgICAvLyBCYXNlIG9iamVjdGl2ZXMgb24gY29udGVudCB0eXBlXG4gICAgc3dpdGNoIChjb250ZW50VHlwZSkge1xuICAgICAgY2FzZSAnbmV3cyc6XG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnVW5kZXJzdGFuZCBjdXJyZW50IGV2ZW50cyB2b2NhYnVsYXJ5JylcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdQcmFjdGljZSByZWFkaW5nIG5ld3MgYXJ0aWNsZXMnKVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSAnYmxvZyc6XG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnTGVhcm4gaW5mb3JtYWwgd3JpdGluZyBzdHlsZScpXG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnVW5kZXJzdGFuZCBwZXJzb25hbCBvcGluaW9ucyBhbmQgZXhwZXJpZW5jZXMnKVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSAndHV0b3JpYWwnOlxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ0ZvbGxvdyBzdGVwLWJ5LXN0ZXAgaW5zdHJ1Y3Rpb25zJylcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdMZWFybiB0ZWNobmljYWwgdm9jYWJ1bGFyeScpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdlbmN5Y2xvcGVkaWEnOlxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ1VuZGVyc3RhbmQgZmFjdHVhbCBpbmZvcm1hdGlvbicpXG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnTGVhcm4gYWNhZGVtaWMgdm9jYWJ1bGFyeScpXG4gICAgICAgIGJyZWFrXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ0ltcHJvdmUgcmVhZGluZyBjb21wcmVoZW5zaW9uJylcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdFeHBhbmQgdm9jYWJ1bGFyeSBrbm93bGVkZ2UnKVxuICAgIH1cblxuICAgIC8vIEFkZCB0b3BpYy1zcGVjaWZpYyBvYmplY3RpdmVzXG4gICAgdG9waWNzLnNsaWNlKDAsIDIpLmZvckVhY2godG9waWMgPT4ge1xuICAgICAgb2JqZWN0aXZlcy5wdXNoKGBEaXNjdXNzIHRvcGljcyByZWxhdGVkIHRvICR7dG9waWMudG9Mb3dlckNhc2UoKX1gKVxuICAgIH0pXG5cbiAgICByZXR1cm4gb2JqZWN0aXZlcy5zbGljZSgwLCA0KVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRBdWRpZW5jZUxldmVsKGNlZnJMZXZlbDogc3RyaW5nKTogXCJnZW5lcmFsXCIgfCBcImV4cGVydFwiIHwgXCJiZWdpbm5lclwiIHtcbiAgICBjb25zdCBsZXZlbE1hcCA9IHtcbiAgICAgICdBMSc6ICdiZWdpbm5lcicgYXMgY29uc3QsXG4gICAgICAnQTInOiAnYmVnaW5uZXInIGFzIGNvbnN0LFxuICAgICAgJ0IxJzogJ2dlbmVyYWwnIGFzIGNvbnN0LFxuICAgICAgJ0IyJzogJ2dlbmVyYWwnIGFzIGNvbnN0LFxuICAgICAgJ0MxJzogJ2V4cGVydCcgYXMgY29uc3QsXG4gICAgfVxuICAgIHJldHVybiBsZXZlbE1hcFtjZWZyTGV2ZWxdIHx8ICdnZW5lcmFsJ1xuICB9XG5cbiAgLy8gRW5oYW5jZWQgZmFsbGJhY2sgbGVzc29uIGdlbmVyYXRpb24gd2l0aCBjb250ZXh0XG4gIHByaXZhdGUgZ2VuZXJhdGVFbmhhbmNlZEZhbGxiYWNrTGVzc29uKHBhcmFtczogTGVzc29uR2VuZXJhdGlvblBhcmFtcyk6IEdlbmVyYXRlZExlc3NvbiB7XG4gICAgY29uc3Qge1xuICAgICAgc291cmNlVGV4dCxcbiAgICAgIGxlc3NvblR5cGUsXG4gICAgICBzdHVkZW50TGV2ZWwsXG4gICAgICB0YXJnZXRMYW5ndWFnZSxcbiAgICAgIGNvbnRlbnRNZXRhZGF0YSxcbiAgICAgIHN0cnVjdHVyZWRDb250ZW50XG4gICAgfSA9IHBhcmFtc1xuXG4gICAgY29uc29sZS5sb2coXCLwn5SEIEdlbmVyYXRpbmcgZW5oYW5jZWQgZmFsbGJhY2sgbGVzc29uIHdpdGggY29udGV4dHVhbCB3YXJtLXVwLi4uXCIpXG5cbiAgICAvLyBVc2UgYXZhaWxhYmxlIGNvbnRleHQgZXZlbiBpbiBmYWxsYmFja1xuICAgIGNvbnN0IHRvcGljcyA9IHN0cnVjdHVyZWRDb250ZW50Py5oZWFkaW5ncz8ubWFwKGggPT4gaC50ZXh0KS5zbGljZSgwLCAzKSB8fCBbXVxuICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gY29udGVudE1ldGFkYXRhPy5jb250ZW50VHlwZSB8fCAnZ2VuZXJhbCdcblxuICAgIC8vIENyZWF0ZSBtb2NrIGNvbnRlbnQgYW5hbHlzaXMgZm9yIGZhbGxiYWNrIHdhcm0tdXAgZ2VuZXJhdGlvblxuICAgIGNvbnN0IG1vY2tDb250ZW50QW5hbHlzaXMgPSB7XG4gICAgICB0b3BpY3M6IHRvcGljcyxcbiAgICAgIGNvbnRlbnRUeXBlOiBjb250ZW50VHlwZSxcbiAgICAgIHNvdXJjZUNvdW50cnk6IHRoaXMuZGV0ZXJtaW5lU291cmNlQ291bnRyeShjb250ZW50TWV0YWRhdGE/LmRvbWFpbiB8fCAnJyksXG4gICAgICBjdWx0dXJhbENvbnRleHQ6IHRoaXMuZGV0ZXJtaW5lQ3VsdHVyYWxDb250ZXh0KGNvbnRlbnRNZXRhZGF0YT8uZG9tYWluIHx8ICcnLCBzb3VyY2VUZXh0KVxuICAgIH1cblxuICAgIC8vIEdlbmVyYXRlIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnMgZXZlbiBpbiBmYWxsYmFja1xuICAgIGNvbnN0IGNvbnRleHR1YWxXYXJtdXAgPSB0aGlzLmdldENvbnRleHR1YWxXYXJtdXBGYWxsYmFjayhzdHVkZW50TGV2ZWwsIG1vY2tDb250ZW50QW5hbHlzaXMsIGNvbnRlbnRNZXRhZGF0YSlcblxuICAgIGNvbnNvbGUubG9nKFwi8J+UpSBHZW5lcmF0ZWQgZmFsbGJhY2sgY29udGV4dHVhbCB3YXJtLXVwOlwiLCBjb250ZXh0dWFsV2FybXVwKVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGxlc3NvblR5cGUsXG4gICAgICBzdHVkZW50TGV2ZWwsXG4gICAgICB0YXJnZXRMYW5ndWFnZSxcbiAgICAgIHNlY3Rpb25zOiB7XG4gICAgICAgIHdhcm11cDogY29udGV4dHVhbFdhcm11cCxcbiAgICAgICAgdm9jYWJ1bGFyeTogdGhpcy5leHRyYWN0Q29udGV4dHVhbFZvY2FidWxhcnkoc291cmNlVGV4dCwgc3R1ZGVudExldmVsLCB0b3BpY3MpLFxuICAgICAgICByZWFkaW5nOiB0aGlzLnNpbXBsaWZ5VGV4dChzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpLFxuICAgICAgICBjb21wcmVoZW5zaW9uOiB0aGlzLmdldENvbnRleHR1YWxDb21wcmVoZW5zaW9uKGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCwgdG9waWNzKSxcbiAgICAgICAgZGlzY3Vzc2lvbjogdGhpcy5nZXRDb250ZXh0dWFsRGlzY3Vzc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwsIHRvcGljcyksXG4gICAgICAgIGdyYW1tYXI6IHRoaXMuZ2V0VGVtcGxhdGVHcmFtbWFyKHN0dWRlbnRMZXZlbCksXG4gICAgICAgIHByb251bmNpYXRpb246IHRoaXMuZ2V0VGVtcGxhdGVQcm9udW5jaWF0aW9uKHNvdXJjZVRleHQpLFxuICAgICAgICB3cmFwdXA6IHRoaXMuZ2V0Q29udGV4dHVhbFdyYXB1cChsZXNzb25UeXBlLCB0b3BpY3MpLFxuICAgICAgfSxcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldENvbnRleHR1YWxXYXJtdXAobGVzc29uVHlwZTogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZywgdG9waWNzOiBzdHJpbmdbXSwgY29udGVudFR5cGU6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAvLyBVc2UgdGhlIHNhbWUgY29udGV4dHVhbCBmYWxsYmFjayBsb2dpY1xuICAgIGNvbnN0IG1vY2tBbmFseXNpcyA9IHtcbiAgICAgIHRvcGljczogdG9waWNzLFxuICAgICAgY29udGVudFR5cGU6IGNvbnRlbnRUeXBlLFxuICAgICAgc291cmNlQ291bnRyeTogJ0ludGVybmF0aW9uYWwnXG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuZ2V0Q29udGV4dHVhbFdhcm11cEZhbGxiYWNrKHN0dWRlbnRMZXZlbCwgbW9ja0FuYWx5c2lzLCB7IHRpdGxlOiB0b3BpY3NbMF0gfHwgJ0NvbnRlbnQnIH0pXG4gIH1cblxuICAvLyBCYXNpYyBmYWxsYmFjayBmb3IgY29tcGxldGUgZmFpbHVyZXNcbiAgcHJpdmF0ZSBnZW5lcmF0ZUJhc2ljRmFsbGJhY2tMZXNzb24ocGFyYW1zOiBMZXNzb25HZW5lcmF0aW9uUGFyYW1zKTogR2VuZXJhdGVkTGVzc29uIHtcbiAgICBjb25zdCB7IHNvdXJjZVRleHQsIGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCwgdGFyZ2V0TGFuZ3VhZ2UgfSA9IHBhcmFtc1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGxlc3NvblR5cGUsXG4gICAgICBzdHVkZW50TGV2ZWwsXG4gICAgICB0YXJnZXRMYW5ndWFnZSxcbiAgICAgIHNlY3Rpb25zOiB7XG4gICAgICAgIHdhcm11cDogW1wiV2hhdCBkbyB5b3UgYWxyZWFkeSBrbm93IGFib3V0IHRoaXMgdG9waWM/XCIsIFwiSGF2ZSB5b3UgaGFkIHNpbWlsYXIgZXhwZXJpZW5jZXM/XCIsIFwiV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBsZWFybj9cIl0sXG4gICAgICAgIHZvY2FidWxhcnk6IFtdLFxuICAgICAgICByZWFkaW5nOiBzb3VyY2VUZXh0LnN1YnN0cmluZygwLCA0MDApLFxuICAgICAgICBjb21wcmVoZW5zaW9uOiBbXCJXaGF0IGlzIHRoZSBtYWluIGlkZWE/XCIsIFwiV2hhdCBkZXRhaWxzIGNhbiB5b3UgaWRlbnRpZnk/XCJdLFxuICAgICAgICBkaXNjdXNzaW9uOiBbXCJXaGF0IGlzIHlvdXIgb3Bpbmlvbj9cIiwgXCJIb3cgd291bGQgeW91IGhhbmRsZSB0aGlzP1wiXSxcbiAgICAgICAgZ3JhbW1hcjogdGhpcy5nZXRUZW1wbGF0ZUdyYW1tYXIoc3R1ZGVudExldmVsKSxcbiAgICAgICAgcHJvbnVuY2lhdGlvbjogeyB3b3JkOiBcImV4YW1wbGVcIiwgaXBhOiBcIi/Jqsmhy4h6w6ZtcMmZbC9cIiwgcHJhY3RpY2U6IFwiUHJhY3RpY2Ugc2F5aW5nIGV4YW1wbGUuXCIgfSxcbiAgICAgICAgd3JhcHVwOiBbXCJXaGF0IGRpZCB5b3UgbGVhcm4/XCIsIFwiV2hhdCBuZWVkcyBtb3JlIHByYWN0aWNlP1wiXVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZXh0cmFjdENvbnRleHR1YWxWb2NhYnVsYXJ5KHRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcsIHRvcGljczogc3RyaW5nW10pIHtcbiAgICBjb25zdCB2b2NhYnVsYXJ5ID0gdGhpcy5leHRyYWN0Vm9jYWJ1bGFyeSh0ZXh0LCBzdHVkZW50TGV2ZWwpXG5cbiAgICAvLyBFbmhhbmNlIHdpdGggdG9waWMgY29udGV4dCBpZiBhdmFpbGFibGVcbiAgICBpZiAodG9waWNzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiB2b2NhYnVsYXJ5Lm1hcCgodm9jYWIsIGluZGV4KSA9PiAoe1xuICAgICAgICAuLi52b2NhYixcbiAgICAgICAgY29udGV4dDogaW5kZXggPCB0b3BpY3MubGVuZ3RoID8gYFJlbGF0ZWQgdG8gJHt0b3BpY3NbaW5kZXhdLnRvTG93ZXJDYXNlKCl9YCA6IHZvY2FiLm1lYW5pbmcsXG4gICAgICB9KSlcbiAgICB9XG5cbiAgICByZXR1cm4gdm9jYWJ1bGFyeVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRDb250ZXh0dWFsQ29tcHJlaGVuc2lvbihsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nLCB0b3BpY3M6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGJhc2VRdWVzdGlvbnMgPSB0aGlzLmdldFRlbXBsYXRlQ29tcHJlaGVuc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpXG5cbiAgICBpZiAodG9waWNzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBbXG4gICAgICAgIGBXaGF0IGlzIHRoZSBtYWluIHBvaW50IGFib3V0ICR7dG9waWNzWzBdPy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IGRvZXMgdGhlIHRleHQgZXhwbGFpbiAke3RvcGljc1sxXT8udG9Mb3dlckNhc2UoKSB8fCAndGhlIHRvcGljJ30/YCxcbiAgICAgICAgXCJXaGF0IHN1cHBvcnRpbmcgZGV0YWlscyBjYW4geW91IGlkZW50aWZ5P1wiLFxuICAgICAgICBcIldoYXQgY29uY2x1c2lvbnMgY2FuIHlvdSBkcmF3IGZyb20gdGhpcyBpbmZvcm1hdGlvbj9cIixcbiAgICAgIF1cbiAgICB9XG5cbiAgICByZXR1cm4gYmFzZVF1ZXN0aW9uc1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRDb250ZXh0dWFsRGlzY3Vzc2lvbihsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nLCB0b3BpY3M6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGJhc2VRdWVzdGlvbnMgPSB0aGlzLmdldFRlbXBsYXRlRGlzY3Vzc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpXG5cbiAgICBpZiAodG9waWNzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBbXG4gICAgICAgIGBXaGF0IGlzIHlvdXIgb3BpbmlvbiBhYm91dCAke3RvcGljc1swXT8udG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYEhvdyB3b3VsZCB5b3UgYXBwbHkgdGhpcyBpbmZvcm1hdGlvbiBhYm91dCAke3RvcGljc1sxXT8udG9Mb3dlckNhc2UoKSB8fCAndGhpcyB0b3BpYyd9P2AsXG4gICAgICAgIGBXaGF0IGFyZSB0aGUgaW1wbGljYXRpb25zIG9mIHdoYXQgeW91IGxlYXJuZWQgYWJvdXQgJHt0b3BpY3NbMF0/LnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICBdXG4gICAgfVxuXG4gICAgcmV0dXJuIGJhc2VRdWVzdGlvbnNcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q29udGV4dHVhbFdyYXB1cChsZXNzb25UeXBlOiBzdHJpbmcsIHRvcGljczogc3RyaW5nW10pOiBzdHJpbmdbXSB7XG4gICAgaWYgKHRvcGljcy5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gW1xuICAgICAgICBgV2hhdCBuZXcgdm9jYWJ1bGFyeSBkaWQgeW91IGxlYXJuIGFib3V0ICR7dG9waWNzWzBdPy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgV2hpY2ggY29uY2VwdHMgYWJvdXQgJHt0b3BpY3NbMV0/LnRvTG93ZXJDYXNlKCkgfHwgJ3RoaXMgdG9waWMnfSBuZWVkIG1vcmUgcHJhY3RpY2U/YCxcbiAgICAgICAgXCJIb3cgd2lsbCB5b3UgdXNlIHRoaXMga25vd2xlZGdlIGluIHJlYWwgc2l0dWF0aW9ucz9cIixcbiAgICAgICAgXCJXaGF0IHF1ZXN0aW9ucyBkbyB5b3Ugc3RpbGwgaGF2ZSBhYm91dCB0aGlzIGNvbnRlbnQ/XCIsXG4gICAgICBdXG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuZ2V0VGVtcGxhdGVXcmFwdXAobGVzc29uVHlwZSlcbiAgfVxuXG4gIC8vIFNtYXJ0IHRlbXBsYXRlLWJhc2VkIGxlc3NvbiBnZW5lcmF0aW9uXG4gIHByaXZhdGUgZ2VuZXJhdGVTbWFydFRlbXBsYXRlTGVzc29uKFxuICAgIHNvdXJjZVRleHQ6IHN0cmluZyxcbiAgICBjb250ZW50QW5hbHlzaXM6IGFueSxcbiAgICBsZXNzb25UeXBlOiBzdHJpbmcsXG4gICAgc3R1ZGVudExldmVsOiBzdHJpbmcsXG4gICAgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZyxcbiAgICBtZXRhZGF0YT86IGFueVxuICApIHtcbiAgICBjb25zb2xlLmxvZyhcIvCfjqggR2VuZXJhdGluZyBzbWFydCB0ZW1wbGF0ZSBsZXNzb24uLi5cIilcblxuICAgIGNvbnN0IHRvcGljcyA9IGNvbnRlbnRBbmFseXNpcy50b3BpY3NcbiAgICBjb25zdCB2b2NhYnVsYXJ5ID0gY29udGVudEFuYWx5c2lzLmtleVZvY2FidWxhcnlcbiAgICBjb25zdCB0aXRsZSA9IG1ldGFkYXRhPy50aXRsZSB8fCAnQ29udGVudCdcblxuICAgIHJldHVybiB7XG4gICAgICB3YXJtdXA6IHRoaXMuZ2VuZXJhdGVTbWFydFdhcm11cFF1ZXN0aW9ucyh0b3BpY3MsIHN0dWRlbnRMZXZlbCwgY29udGVudEFuYWx5c2lzKSxcbiAgICAgIHZvY2FidWxhcnk6IHRoaXMuZ2VuZXJhdGVTbWFydFZvY2FidWxhcnkodm9jYWJ1bGFyeSwgc291cmNlVGV4dCwgc3R1ZGVudExldmVsKSxcbiAgICAgIHJlYWRpbmc6IHRoaXMuZ2VuZXJhdGVTbWFydFJlYWRpbmcoc291cmNlVGV4dCwgc3R1ZGVudExldmVsKSxcbiAgICAgIGNvbXByZWhlbnNpb246IHRoaXMuZ2VuZXJhdGVTbWFydENvbXByZWhlbnNpb24odG9waWNzLCBzdHVkZW50TGV2ZWwpLFxuICAgICAgZGlzY3Vzc2lvbjogdGhpcy5nZW5lcmF0ZVNtYXJ0RGlzY3Vzc2lvbih0b3BpY3MsIGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCksXG4gICAgICBncmFtbWFyOiB0aGlzLmdlbmVyYXRlU21hcnRHcmFtbWFyKHN0dWRlbnRMZXZlbCwgc291cmNlVGV4dCksXG4gICAgICBwcm9udW5jaWF0aW9uOiB0aGlzLmdlbmVyYXRlU21hcnRQcm9udW5jaWF0aW9uKHZvY2FidWxhcnkpLFxuICAgICAgd3JhcHVwOiB0aGlzLmdlbmVyYXRlU21hcnRXcmFwdXAodG9waWNzLCBzdHVkZW50TGV2ZWwpXG4gICAgfVxuICB9XG5cbiAgLy8gU21hcnQgd2FybS11cCBxdWVzdGlvbnMgYmFzZWQgb24gY29udGVudCAocHJpb3Iga25vd2xlZGdlIGFjdGl2YXRpb24pXG4gIHByaXZhdGUgZ2VuZXJhdGVTbWFydFdhcm11cFF1ZXN0aW9ucyh0b3BpY3M6IHN0cmluZ1tdLCBzdHVkZW50TGV2ZWw6IHN0cmluZywgY29udGVudEFuYWx5c2lzOiBhbnkpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgdG9waWMgPSB0b3BpY3NbMF0gfHwgJ3RoaXMgdG9waWMnXG4gICAgY29uc3Qgc2Vjb25kVG9waWMgPSB0b3BpY3NbMV0gfHwgJ3RlY2hub2xvZ3knXG5cbiAgICAvLyBGb2N1cyBvbiBhY3RpdmF0aW5nIHByaW9yIGtub3dsZWRnZSwgbm90IGFzc3VtaW5nIGNvbnRlbnQga25vd2xlZGdlXG4gICAgY29uc3QgbGV2ZWxRdWVzdGlvbnMgPSB7XG4gICAgICAnQTEnOiBbXG4gICAgICAgIGBEbyB5b3Uga25vdyBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBJcyAke3RvcGljLnRvTG93ZXJDYXNlKCl9IHBvcHVsYXIgaW4geW91ciBjb3VudHJ5P2AsXG4gICAgICAgIGBEbyB5b3UgbGlrZSAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2BcbiAgICAgIF0sXG4gICAgICAnQTInOiBbXG4gICAgICAgIGBIYXZlIHlvdSBoZWFyZCBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGJlZm9yZT9gLFxuICAgICAgICBgV2hhdCBkbyB5b3UgYWxyZWFkeSBrbm93IGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYElzICR7dG9waWMudG9Mb3dlckNhc2UoKX0gY29tbW9uIGluIHlvdXIgY291bnRyeT9gXG4gICAgICBdLFxuICAgICAgJ0IxJzogW1xuICAgICAgICBgV2hhdCBjb21lcyB0byBtaW5kIHdoZW4geW91IGhlYXIgYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSGF2ZSB5b3UgaGFkIGFueSBleHBlcmllbmNlIHdpdGggJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBrbm93IGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YFxuICAgICAgXSxcbiAgICAgICdCMic6IFtcbiAgICAgICAgYFdoYXQgaXMgeW91ciBnZW5lcmFsIG9waW5pb24gYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IGZhbWlsaWFyIGFyZSB5b3Ugd2l0aCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBXaGF0IHJvbGUgZG9lcyAke3RvcGljLnRvTG93ZXJDYXNlKCl9IHBsYXkgaW4geW91ciBkYWlseSBsaWZlP2BcbiAgICAgIF0sXG4gICAgICAnQzEnOiBbXG4gICAgICAgIGBIb3cgd291bGQgeW91IGRlc2NyaWJlIHRoZSBzaWduaWZpY2FuY2Ugb2YgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBpbiBtb2Rlcm4gc29jaWV0eT9gLFxuICAgICAgICBgV2hhdCBhcmUgeW91ciB0aG91Z2h0cyBvbiB0aGUgY3VycmVudCBzdGF0ZSBvZiAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBIb3cgZG8geW91IHRoaW5rICR7dG9waWMudG9Mb3dlckNhc2UoKX0gaGFzIGV2b2x2ZWQgb3ZlciB0aW1lP2BcbiAgICAgIF1cbiAgICB9XG5cbiAgICByZXR1cm4gbGV2ZWxRdWVzdGlvbnNbc3R1ZGVudExldmVsXSB8fCBsZXZlbFF1ZXN0aW9uc1snQjEnXVxuICB9XG5cbiAgLy8gU21hcnQgdm9jYWJ1bGFyeSB3aXRoIGNvbnRleHR1YWwgZXhhbXBsZXNcbiAgcHJpdmF0ZSBnZW5lcmF0ZVNtYXJ0Vm9jYWJ1bGFyeSh2b2NhYnVsYXJ5OiBzdHJpbmdbXSwgc291cmNlVGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZykge1xuICAgIHJldHVybiB2b2NhYnVsYXJ5LnNsaWNlKDAsIDYpLm1hcCh3b3JkID0+IHtcbiAgICAgIC8vIEZpbmQgdGhlIHdvcmQgaW4gY29udGV4dFxuICAgICAgY29uc3Qgc2VudGVuY2VzID0gc291cmNlVGV4dC5zcGxpdCgvWy4hP10rLylcbiAgICAgIGNvbnN0IGNvbnRleHRTZW50ZW5jZSA9IHNlbnRlbmNlcy5maW5kKHMgPT4gcy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHdvcmQudG9Mb3dlckNhc2UoKSkpXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHdvcmQ6IHdvcmQsXG4gICAgICAgIG1lYW5pbmc6IHRoaXMuZ2VuZXJhdGVXb3JkTWVhbmluZyh3b3JkLCBzdHVkZW50TGV2ZWwpLFxuICAgICAgICBleGFtcGxlOiBjb250ZXh0U2VudGVuY2UgP1xuICAgICAgICAgIGNvbnRleHRTZW50ZW5jZS50cmltKCkuc3Vic3RyaW5nKDAsIDEwMCkgKyAoY29udGV4dFNlbnRlbmNlLmxlbmd0aCA+IDEwMCA/ICcuLi4nIDogJycpIDpcbiAgICAgICAgICBgVGhpcyBpcyBhbiBleGFtcGxlIHNlbnRlbmNlIHdpdGggJHt3b3JkfS5gXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIC8vIEdlbmVyYXRlIHdvcmQgbWVhbmluZ3MgYmFzZWQgb24gbGV2ZWxcbiAgcHJpdmF0ZSBnZW5lcmF0ZVdvcmRNZWFuaW5nKHdvcmQ6IHN0cmluZywgbGV2ZWw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gU2ltcGxlIGRlZmluaXRpb25zIGJhc2VkIG9uIGxldmVsXG4gICAgY29uc3QgY29tbW9uTWVhbmluZ3MgPSB7XG4gICAgICAnZWZmaWNpZW50JzogbGV2ZWwgPT09ICdBMScgfHwgbGV2ZWwgPT09ICdBMicgPyAnd29ya2luZyB3ZWxsIGFuZCBmYXN0JyA6ICdhY2hpZXZpbmcgbWF4aW11bSBwcm9kdWN0aXZpdHkgd2l0aCBtaW5pbXVtIHdhc3RlZCBlZmZvcnQnLFxuICAgICAgJ3RlY2hub2xvZ3knOiBsZXZlbCA9PT0gJ0ExJyB8fCBsZXZlbCA9PT0gJ0EyJyA/ICdjb21wdXRlcnMgYW5kIG1hY2hpbmVzJyA6ICd0aGUgYXBwbGljYXRpb24gb2Ygc2NpZW50aWZpYyBrbm93bGVkZ2UgZm9yIHByYWN0aWNhbCBwdXJwb3NlcycsXG4gICAgICAncHJpdmFjeSc6IGxldmVsID09PSAnQTEnIHx8IGxldmVsID09PSAnQTInID8gJ2tlZXBpbmcgdGhpbmdzIHNlY3JldCcgOiAndGhlIHN0YXRlIG9mIGJlaW5nIGZyZWUgZnJvbSBwdWJsaWMgYXR0ZW50aW9uJyxcbiAgICAgICdkZXZpY2UnOiBsZXZlbCA9PT0gJ0ExJyB8fCBsZXZlbCA9PT0gJ0EyJyA/ICdhIG1hY2hpbmUgb3IgdG9vbCcgOiAnYSBwaWVjZSBvZiBlcXVpcG1lbnQgZGVzaWduZWQgZm9yIGEgcGFydGljdWxhciBwdXJwb3NlJyxcbiAgICAgICdwcm9jZXNzaW5nJzogbGV2ZWwgPT09ICdBMScgfHwgbGV2ZWwgPT09ICdBMicgPyAnd29ya2luZyB3aXRoIGluZm9ybWF0aW9uJyA6ICdwZXJmb3JtaW5nIG9wZXJhdGlvbnMgb24gZGF0YScsXG4gICAgICAnY29tcGFjdCc6IGxldmVsID09PSAnQTEnIHx8IGxldmVsID09PSAnQTInID8gJ3NtYWxsIGFuZCBuZWF0JyA6ICdjbG9zZWx5IGFuZCBuZWF0bHkgcGFja2VkIHRvZ2V0aGVyJyxcbiAgICAgICd2ZXJzaW9uJzogbGV2ZWwgPT09ICdBMScgfHwgbGV2ZWwgPT09ICdBMicgPyAnYSB0eXBlIG9mIHNvbWV0aGluZycgOiAnYSBwYXJ0aWN1bGFyIGZvcm0gb2Ygc29tZXRoaW5nJyxcbiAgICAgICdmYW1pbHknOiBsZXZlbCA9PT0gJ0ExJyB8fCBsZXZlbCA9PT0gJ0EyJyA/ICdhIGdyb3VwIG9mIHJlbGF0ZWQgdGhpbmdzJyA6ICdhIGdyb3VwIG9mIHJlbGF0ZWQgb2JqZWN0cyBvciBjb25jZXB0cycsXG4gICAgICAnbmFubyc6IGxldmVsID09PSAnQTEnIHx8IGxldmVsID09PSAnQTInID8gJ3Zlcnkgc21hbGwnIDogJ2V4dHJlbWVseSBzbWFsbCBpbiBzY2FsZScsXG4gICAgICAnZ2VtaW5pJzogbGV2ZWwgPT09ICdBMScgfHwgbGV2ZWwgPT09ICdBMicgPyAnYSB0eXBlIG9mIEFJJyA6ICdhbiBhcnRpZmljaWFsIGludGVsbGlnZW5jZSBzeXN0ZW0gZGV2ZWxvcGVkIGJ5IEdvb2dsZSdcbiAgICB9XG5cbiAgICByZXR1cm4gY29tbW9uTWVhbmluZ3Nbd29yZC50b0xvd2VyQ2FzZSgpXSB8fCBgQSB3b3JkIG1lYW5pbmcgJHt3b3JkLnRvTG93ZXJDYXNlKCl9YFxuICB9XG5cbiAgLy8gU21hcnQgcmVhZGluZyBwYXNzYWdlIGFkYXB0YXRpb25cbiAgcHJpdmF0ZSBnZW5lcmF0ZVNtYXJ0UmVhZGluZyhzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBtYXhMZW5ndGggPSB7XG4gICAgICAnQTEnOiAyMDAsXG4gICAgICAnQTInOiAzMDAsXG4gICAgICAnQjEnOiA0MDAsXG4gICAgICAnQjInOiA1MDAsXG4gICAgICAnQzEnOiA2MDBcbiAgICB9XG5cbiAgICBjb25zdCB0YXJnZXRMZW5ndGggPSBtYXhMZW5ndGhbc3R1ZGVudExldmVsXSB8fCA0MDBcblxuICAgIC8vIFNpbXBsaWZ5IHNlbnRlbmNlcyBmb3IgbG93ZXIgbGV2ZWxzXG4gICAgaWYgKHN0dWRlbnRMZXZlbCA9PT0gJ0ExJyB8fCBzdHVkZW50TGV2ZWwgPT09ICdBMicpIHtcbiAgICAgIGNvbnN0IHNlbnRlbmNlcyA9IHNvdXJjZVRleHQuc3BsaXQoL1suIT9dKy8pXG4gICAgICBjb25zdCBzaW1wbGlmaWVkU2VudGVuY2VzID0gc2VudGVuY2VzXG4gICAgICAgIC5maWx0ZXIocyA9PiBzLnRyaW0oKS5sZW5ndGggPiAxMClcbiAgICAgICAgLm1hcChzID0+IHMudHJpbSgpKVxuICAgICAgICAuc2xpY2UoMCwgOCkgLy8gTGltaXQgbnVtYmVyIG9mIHNlbnRlbmNlc1xuXG4gICAgICByZXR1cm4gc2ltcGxpZmllZFNlbnRlbmNlcy5qb2luKCcuICcpLnN1YnN0cmluZygwLCB0YXJnZXRMZW5ndGgpXG4gICAgfVxuXG4gICAgcmV0dXJuIHNvdXJjZVRleHQuc3Vic3RyaW5nKDAsIHRhcmdldExlbmd0aClcbiAgfVxuXG4gIC8vIFNtYXJ0IGNvbXByZWhlbnNpb24gcXVlc3Rpb25zXG4gIHByaXZhdGUgZ2VuZXJhdGVTbWFydENvbXByZWhlbnNpb24odG9waWNzOiBzdHJpbmdbXSwgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgdG9waWMgPSB0b3BpY3NbMF0gfHwgJ3RoZSBjb250ZW50J1xuXG4gICAgY29uc3QgbGV2ZWxRdWVzdGlvbnMgPSB7XG4gICAgICAnQTEnOiBbXG4gICAgICAgIGBXaGF0IGlzICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgXCJXaGF0IGlzIHRoZSBtYWluIGlkZWE/XCIsXG4gICAgICAgIFwiSXMgdGhpcyBpbmZvcm1hdGlvbiBuZXcgdG8geW91P1wiXG4gICAgICBdLFxuICAgICAgJ0EyJzogW1xuICAgICAgICBgV2hhdCBkb2VzIHRoZSB0ZXh0IHNheSBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIFwiV2hhdCBhcmUgdGhlIG1haW4gcG9pbnRzP1wiLFxuICAgICAgICBcIkRvIHlvdSBhZ3JlZSB3aXRoIHRoZSBpbmZvcm1hdGlvbj9cIlxuICAgICAgXSxcbiAgICAgICdCMSc6IFtcbiAgICAgICAgYEhvdyBkb2VzIHRoZSB0ZXh0IGV4cGxhaW4gJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBcIldoYXQgc3VwcG9ydGluZyBkZXRhaWxzIGFyZSBwcm92aWRlZD9cIixcbiAgICAgICAgXCJXaGF0IGNvbmNsdXNpb25zIGNhbiB5b3UgZHJhdz9cIixcbiAgICAgICAgXCJIb3cgZG9lcyB0aGlzIHJlbGF0ZSB0byB5b3VyIGV4cGVyaWVuY2U/XCJcbiAgICAgIF0sXG4gICAgICAnQjInOiBbXG4gICAgICAgIGBXaGF0IGlzIHRoZSBhdXRob3IncyBwZXJzcGVjdGl2ZSBvbiAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIFwiV2hhdCBldmlkZW5jZSBzdXBwb3J0cyB0aGUgbWFpbiBhcmd1bWVudHM/XCIsXG4gICAgICAgIFwiV2hhdCBhcmUgdGhlIGltcGxpY2F0aW9ucyBvZiB0aGlzIGluZm9ybWF0aW9uP1wiLFxuICAgICAgICBcIkhvdyBtaWdodCB0aGlzIGFmZmVjdCBkaWZmZXJlbnQgZ3JvdXBzIG9mIHBlb3BsZT9cIlxuICAgICAgXSxcbiAgICAgICdDMSc6IFtcbiAgICAgICAgYEhvdyBkb2VzIHRoZSBhdXRob3IncyB0cmVhdG1lbnQgb2YgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSByZWZsZWN0IGJyb2FkZXIgdGhlbWVzP2AsXG4gICAgICAgIFwiV2hhdCB1bmRlcmx5aW5nIGFzc3VtcHRpb25zIGNhbiB5b3UgaWRlbnRpZnk/XCIsXG4gICAgICAgIFwiSG93IG1pZ2h0IHRoaXMgaW5mb3JtYXRpb24gYmUgaW50ZXJwcmV0ZWQgZGlmZmVyZW50bHkgaW4gdmFyaW91cyBjb250ZXh0cz9cIixcbiAgICAgICAgXCJXaGF0IGFyZSB0aGUgcG90ZW50aWFsIGxvbmctdGVybSBjb25zZXF1ZW5jZXMgZGlzY3Vzc2VkP1wiXG4gICAgICBdXG4gICAgfVxuXG4gICAgcmV0dXJuIGxldmVsUXVlc3Rpb25zW3N0dWRlbnRMZXZlbF0gfHwgbGV2ZWxRdWVzdGlvbnNbJ0IxJ11cbiAgfVxuXG4gIC8vIFNtYXJ0IGRpc2N1c3Npb24gcXVlc3Rpb25zXG4gIHByaXZhdGUgZ2VuZXJhdGVTbWFydERpc2N1c3Npb24odG9waWNzOiBzdHJpbmdbXSwgbGVzc29uVHlwZTogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCB0b3BpYyA9IHRvcGljc1swXSB8fCAndGhpcyB0b3BpYydcbiAgICBjb25zdCBzZWNvbmRUb3BpYyA9IHRvcGljc1sxXSB8fCAndGVjaG5vbG9neSdcblxuICAgIGNvbnN0IGxldmVsUXVlc3Rpb25zID0ge1xuICAgICAgJ0ExJzogW1xuICAgICAgICBgRG8geW91IGxpa2UgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT8gV2h5P2AsXG4gICAgICAgIGBJcyAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGdvb2Qgb3IgYmFkP2AsXG4gICAgICAgIGBXb3VsZCB5b3UgcmVjb21tZW5kICR7dG9waWMudG9Mb3dlckNhc2UoKX0gdG8gZnJpZW5kcz9gXG4gICAgICBdLFxuICAgICAgJ0EyJzogW1xuICAgICAgICBgV2hhdCBpcyB5b3VyIG9waW5pb24gYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IGRvIHlvdSB1c2UgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBpbiB5b3VyIGxpZmU/YCxcbiAgICAgICAgYFdoYXQgcHJvYmxlbXMgY2FuICR7dG9waWMudG9Mb3dlckNhc2UoKX0gY2F1c2U/YFxuICAgICAgXSxcbiAgICAgICdCMSc6IFtcbiAgICAgICAgYFdoYXQgYXJlIHRoZSBhZHZhbnRhZ2VzIGFuZCBkaXNhZHZhbnRhZ2VzIG9mICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYEhvdyBoYXMgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBjaGFuZ2VkIG92ZXIgdGltZT9gLFxuICAgICAgICBgV2hhdCB3b3VsZCBoYXBwZW4gaWYgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBkaWRuJ3QgZXhpc3Q/YFxuICAgICAgXSxcbiAgICAgICdCMic6IFtcbiAgICAgICAgYEhvdyBtaWdodCAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGltcGFjdCBzb2NpZXR5IGluIHRoZSBuZXh0IGRlY2FkZT9gLFxuICAgICAgICBgV2hhdCBldGhpY2FsIGNvbnNpZGVyYXRpb25zIHN1cnJvdW5kICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYEhvdyBkb2VzICR7dG9waWMudG9Mb3dlckNhc2UoKX0gZGlmZmVyIGFjcm9zcyBjdWx0dXJlcz9gXG4gICAgICBdLFxuICAgICAgJ0MxJzogW1xuICAgICAgICBgV2hhdCBhcmUgdGhlIGJyb2FkZXIgc29jaWV0YWwgaW1wbGljYXRpb25zIG9mICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYEhvdyBtaWdodCAke3RvcGljLnRvTG93ZXJDYXNlKCl9IHJlc2hhcGUgb3VyIHVuZGVyc3RhbmRpbmcgb2YgJHtzZWNvbmRUb3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgV2hhdCByb2xlIHNob3VsZCByZWd1bGF0aW9uIHBsYXkgaW4gJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gXG4gICAgICBdXG4gICAgfVxuXG4gICAgcmV0dXJuIGxldmVsUXVlc3Rpb25zW3N0dWRlbnRMZXZlbF0gfHwgbGV2ZWxRdWVzdGlvbnNbJ0IxJ11cbiAgfVxuXG4gIC8vIFNtYXJ0IGdyYW1tYXIgZm9jdXNcbiAgcHJpdmF0ZSBnZW5lcmF0ZVNtYXJ0R3JhbW1hcihzdHVkZW50TGV2ZWw6IHN0cmluZywgc291cmNlVGV4dDogc3RyaW5nKSB7XG4gICAgY29uc3QgZ3JhbW1hckZvY3VzID0ge1xuICAgICAgJ0ExJzoge1xuICAgICAgICBmb2N1czogJ1ByZXNlbnQgU2ltcGxlJyxcbiAgICAgICAgZXhhbXBsZXM6IFsnSXQgaXMgZWZmaWNpZW50LicsICdUaGlzIHdvcmtzIHdlbGwuJywgJ1Blb3BsZSB1c2UgdGVjaG5vbG9neS4nXSxcbiAgICAgICAgZXhlcmNpc2U6IFsnSXQgX19fX18gKGJlKSB2ZXJ5IHVzZWZ1bC4nLCAnVGVjaG5vbG9neSBfX19fXyAoaGVscCkgcGVvcGxlLicsICdUaGlzIF9fX19fICh3b3JrKSBvbiBwaG9uZXMuJ11cbiAgICAgIH0sXG4gICAgICAnQTInOiB7XG4gICAgICAgIGZvY3VzOiAnUHJlc2VudCBDb250aW51b3VzIGFuZCBTaW1wbGUnLFxuICAgICAgICBleGFtcGxlczogWydJdCBpcyB3b3JraW5nIG9uIHlvdXIgZGV2aWNlLicsICdQZW9wbGUgYXJlIHVzaW5nIHRoaXMgdGVjaG5vbG9neS4nLCAnSXQgaGVscHMgd2l0aCBwcml2YWN5LiddLFxuICAgICAgICBleGVyY2lzZTogWydJdCBfX19fXyAod29yaykgcmlnaHQgbm93LicsICdQZW9wbGUgX19fX18gKHVzZSkgaXQgZXZlcnkgZGF5LicsICdUaGlzIF9fX19fIChoZWxwKSB3aXRoIHNlY3VyaXR5LiddXG4gICAgICB9LFxuICAgICAgJ0IxJzoge1xuICAgICAgICBmb2N1czogJ1ByZXNlbnQgUGVyZmVjdCcsXG4gICAgICAgIGV4YW1wbGVzOiBbJ1RlY2hub2xvZ3kgaGFzIGltcHJvdmVkIHNpZ25pZmljYW50bHkuJywgJ0l0IGhhcyBiZWNvbWUgbW9yZSBlZmZpY2llbnQuJywgJ1VzZXJzIGhhdmUgZXhwZXJpZW5jZWQgYmV0dGVyIHByaXZhY3kuJ10sXG4gICAgICAgIGV4ZXJjaXNlOiBbJ1RlY2hub2xvZ3kgX19fX18gKGltcHJvdmUpIGEgbG90LicsICdJdCBfX19fXyAoYmVjb21lKSB2ZXJ5IHBvcHVsYXIuJywgJ1Blb3BsZSBfX19fXyAoc3RhcnQpIHVzaW5nIGl0IG1vcmUuJ11cbiAgICAgIH0sXG4gICAgICAnQjInOiB7XG4gICAgICAgIGZvY3VzOiAnUGFzc2l2ZSBWb2ljZScsXG4gICAgICAgIGV4YW1wbGVzOiBbJ0l0IGlzIGRlc2lnbmVkIGZvciBtb2JpbGUgZGV2aWNlcy4nLCAnUHJpdmFjeSBpcyBlbmhhbmNlZCBieSB0aGlzIHRlY2hub2xvZ3kuJywgJ0RhdGEgaXMgcHJvY2Vzc2VkIGxvY2FsbHkuJ10sXG4gICAgICAgIGV4ZXJjaXNlOiBbJ0l0IF9fX19fIChkZXNpZ24pIGZvciBwaG9uZXMuJywgJ1ByaXZhY3kgX19fX18gKGltcHJvdmUpIHNpZ25pZmljYW50bHkuJywgJ0luZm9ybWF0aW9uIF9fX19fIChwcm9jZXNzKSBzYWZlbHkuJ11cbiAgICAgIH0sXG4gICAgICAnQzEnOiB7XG4gICAgICAgIGZvY3VzOiAnQ29tcGxleCBTZW50ZW5jZSBTdHJ1Y3R1cmVzJyxcbiAgICAgICAgZXhhbXBsZXM6IFsnSGF2aW5nIGJlZW4gZGVzaWduZWQgZm9yIGVmZmljaWVuY3ksIGl0IG9wZXJhdGVzIHNlYW1sZXNzbHkuJywgJ1RoZSB0ZWNobm9sb2d5LCB3aGljaCBwcmlvcml0aXplcyBwcml2YWN5LCBoYXMgZ2FpbmVkIHBvcHVsYXJpdHkuJ10sXG4gICAgICAgIGV4ZXJjaXNlOiBbJ19fX19fIChkZXNpZ24pIGZvciBtb2JpbGUgdXNlLCBpdCB3b3JrcyBvZmZsaW5lLicsICdUaGUgc3lzdGVtLCBfX19fXyAoZm9jdXMpIG9uIHByaXZhY3ksIGFwcGVhbHMgdG8gdXNlcnMuJ11cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZ3JhbW1hckZvY3VzW3N0dWRlbnRMZXZlbF0gfHwgZ3JhbW1hckZvY3VzWydCMSddXG4gIH1cblxuICAvLyBTbWFydCBwcm9udW5jaWF0aW9uXG4gIHByaXZhdGUgZ2VuZXJhdGVTbWFydFByb251bmNpYXRpb24odm9jYWJ1bGFyeTogc3RyaW5nW10pIHtcbiAgICBjb25zdCB3b3JkID0gdm9jYWJ1bGFyeS5maW5kKHcgPT4gdy5sZW5ndGggPiA2KSB8fCB2b2NhYnVsYXJ5WzBdIHx8ICd0ZWNobm9sb2d5J1xuXG4gICAgY29uc3QgcHJvbnVuY2lhdGlvbnMgPSB7XG4gICAgICAndGVjaG5vbG9neSc6ICcvdGVry4huyZJsyZlkypJpLycsXG4gICAgICAnZWZmaWNpZW50JzogJy/JqsuIZsmqyoPJmW50LycsXG4gICAgICAncHJpdmFjeSc6ICcvy4hwcmHJqnbJmXNpLycsXG4gICAgICAncHJvY2Vzc2luZyc6ICcvy4hwcsmZyopzZXPJqsWLLycsXG4gICAgICAnZGV2aWNlJzogJy9kyarLiHZhyapzLycsXG4gICAgICAnYXJ0aWZpY2lhbCc6ICcvy4zJkcuQdMmqy4hmyarKg8mZbC8nLFxuICAgICAgJ2ludGVsbGlnZW5jZSc6ICcvyapuy4h0ZWzJqmTKksmZbnMvJyxcbiAgICAgICdjb21wYWN0JzogJy9ryZlty4hww6ZrdC8nLFxuICAgICAgJ3ZlcnNpb24nOiAnL8uIdsmcy5DKg8mZbi8nLFxuICAgICAgJ2ZhbWlseSc6ICcvy4hmw6ZtyZlsaS8nLFxuICAgICAgJ25hbm8nOiAnL8uIbsOmbm/Kii8nLFxuICAgICAgJ2dlbWluaSc6ICcvy4hkypJlbcmqbmHJqi8nXG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHdvcmQ6IHdvcmQsXG4gICAgICBpcGE6IHByb251bmNpYXRpb25zW3dvcmQudG9Mb3dlckNhc2UoKV0gfHwgYC/LiHfJnMuQcmQvYCxcbiAgICAgIHByYWN0aWNlOiBgUHJhY3RpY2Ugc2F5aW5nIFwiJHt3b3JkfVwiIGluIHRoaXMgc2VudGVuY2U6IFRoaXMgJHt3b3JkfSBpcyB2ZXJ5IHVzZWZ1bC5gXG4gICAgfVxuICB9XG5cbiAgLy8gU21hcnQgd3JhcC11cCBxdWVzdGlvbnNcbiAgcHJpdmF0ZSBnZW5lcmF0ZVNtYXJ0V3JhcHVwKHRvcGljczogc3RyaW5nW10sIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHRvcGljID0gdG9waWNzWzBdIHx8ICd0aGlzIHRvcGljJ1xuXG4gICAgcmV0dXJuIFtcbiAgICAgIGBXaGF0IG5ldyB2b2NhYnVsYXJ5IGRpZCB5b3UgbGVhcm4gYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgYFdoaWNoIGNvbmNlcHRzIGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0gbmVlZCBtb3JlIHByYWN0aWNlP2AsXG4gICAgICBcIkhvdyB3aWxsIHlvdSB1c2UgdGhpcyBrbm93bGVkZ2UgaW4gcmVhbCBzaXR1YXRpb25zP1wiLFxuICAgICAgXCJXaGF0IHF1ZXN0aW9ucyBkbyB5b3Ugc3RpbGwgaGF2ZSBhYm91dCB0aGlzIGNvbnRlbnQ/XCJcbiAgICBdXG4gIH1cblxuICAvLyBIZWxwZXIgbWV0aG9kIHRvIGRldGVybWluZSBzb3VyY2UgY291bnRyeSBmcm9tIGRvbWFpblxuICBwcml2YXRlIGRldGVybWluZVNvdXJjZUNvdW50cnkoZG9tYWluOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGNvdW50cnlNYXAgPSB7XG4gICAgICAnYmJjLmNvbSc6ICdVbml0ZWQgS2luZ2RvbScsXG4gICAgICAnYmJjLmNvLnVrJzogJ1VuaXRlZCBLaW5nZG9tJyxcbiAgICAgICdjbm4uY29tJzogJ1VuaXRlZCBTdGF0ZXMnLFxuICAgICAgJ255dGltZXMuY29tJzogJ1VuaXRlZCBTdGF0ZXMnLFxuICAgICAgJ3RoZWd1YXJkaWFuLmNvbSc6ICdVbml0ZWQgS2luZ2RvbScsXG4gICAgICAnd2FzaGluZ3RvbnBvc3QuY29tJzogJ1VuaXRlZCBTdGF0ZXMnLFxuICAgICAgJ3JldXRlcnMuY29tJzogJ0ludGVybmF0aW9uYWwnLFxuICAgICAgJ2FwLm9yZyc6ICdVbml0ZWQgU3RhdGVzJyxcbiAgICAgICducHIub3JnJzogJ1VuaXRlZCBTdGF0ZXMnLFxuICAgICAgJ2FiYy5uZXQuYXUnOiAnQXVzdHJhbGlhJyxcbiAgICAgICdjYmMuY2EnOiAnQ2FuYWRhJyxcbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IFtkb21haW5LZXksIGNvdW50cnldIG9mIE9iamVjdC5lbnRyaWVzKGNvdW50cnlNYXApKSB7XG4gICAgICBpZiAoZG9tYWluLmluY2x1ZGVzKGRvbWFpbktleSkpIHtcbiAgICAgICAgcmV0dXJuIGNvdW50cnlcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gJ0ludGVybmF0aW9uYWwnXG4gIH1cblxuICAvLyBGYWxsYmFjayB3YXJtLXVwIHF1ZXN0aW9uIGdlbmVyYXRvclxuICBwcml2YXRlIGdldEZhbGxiYWNrV2FybXVwUXVlc3Rpb24obGV2ZWw6IHN0cmluZywgY29udGVudEFuYWx5c2lzOiBhbnksIHF1ZXN0aW9uSW5kZXg6IG51bWJlcik6IHN0cmluZyB7XG4gICAgY29uc3QgdG9waWMgPSBjb250ZW50QW5hbHlzaXMudG9waWNzWzBdIHx8ICd0aGlzIHRvcGljJ1xuICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gY29udGVudEFuYWx5c2lzLmNvbnRlbnRUeXBlXG5cbiAgICBjb25zdCBmYWxsYmFja1F1ZXN0aW9ucyA9IHtcbiAgICAgICdBMSc6IFtcbiAgICAgICAgYERvIHlvdSBrbm93IGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYElzICR7dG9waWMudG9Mb3dlckNhc2UoKX0gaW1wb3J0YW50IGluIHlvdXIgY291bnRyeT9gLFxuICAgICAgICBgRG8geW91IGxpa2UgdG8gcmVhZCBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2BcbiAgICAgIF0sXG4gICAgICAnQTInOiBbXG4gICAgICAgIGBIYXZlIHlvdSBoZWFyZCBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGJlZm9yZT9gLFxuICAgICAgICBgV2hhdCBkbyB5b3Uga25vdyBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBJcyAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGRpZmZlcmVudCBpbiB5b3VyIGNvdW50cnk/YFxuICAgICAgXSxcbiAgICAgICdCMSc6IFtcbiAgICAgICAgYFdoYXQgZG8geW91IHRoaW5rIGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYEhvdyBpcyAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGltcG9ydGFudCBpbiB5b3VyIGRhaWx5IGxpZmU/YCxcbiAgICAgICAgYFdoYXQgd291bGQgeW91IGxpa2UgdG8ga25vdyBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2BcbiAgICAgIF0sXG4gICAgICAnQjInOiBbXG4gICAgICAgIGBXaGF0IGFyZSB5b3VyIHRob3VnaHRzIG9uICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYEhvdyBtaWdodCAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGFmZmVjdCBwZW9wbGUgaW4gZGlmZmVyZW50IGNvdW50cmllcz9gLFxuICAgICAgICBgV2hhdCBxdWVzdGlvbnMgd291bGQgeW91IGFzayBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2BcbiAgICAgIF0sXG4gICAgICAnQzEnOiBbXG4gICAgICAgIGBIb3cgZG8gY3VsdHVyYWwgcGVyc3BlY3RpdmVzIGluZmx1ZW5jZSBhdHRpdHVkZXMgdG93YXJkICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYFdoYXQgYXJlIHRoZSBicm9hZGVyIGltcGxpY2F0aW9ucyBvZiAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGluIG1vZGVybiBzb2NpZXR5P2AsXG4gICAgICAgIGBIb3cgbWlnaHQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBldm9sdmUgaW4gdGhlIGNvbWluZyB5ZWFycz9gXG4gICAgICBdXG4gICAgfVxuXG4gICAgY29uc3QgbGV2ZWxRdWVzdGlvbnMgPSBmYWxsYmFja1F1ZXN0aW9uc1tsZXZlbF0gfHwgZmFsbGJhY2tRdWVzdGlvbnNbJ0IxJ11cbiAgICByZXR1cm4gbGV2ZWxRdWVzdGlvbnNbcXVlc3Rpb25JbmRleF0gfHwgbGV2ZWxRdWVzdGlvbnNbMF1cbiAgfVxuXG4gIC8vIENvbnRleHR1YWwgd2FybS11cCBmYWxsYmFjayB3aGVuIEFJIGZhaWxzXG4gIHByaXZhdGUgZ2V0Q29udGV4dHVhbFdhcm11cEZhbGxiYWNrKGxldmVsOiBzdHJpbmcsIGNvbnRlbnRBbmFseXNpczogYW55LCBtZXRhZGF0YT86IGFueSk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCB0b3BpYyA9IGNvbnRlbnRBbmFseXNpcy50b3BpY3NbMF0gfHwgJ3RoaXMgdG9waWMnXG4gICAgY29uc3Qgc291cmNlQ291bnRyeSA9IGNvbnRlbnRBbmFseXNpcy5zb3VyY2VDb3VudHJ5IHx8ICd0aGlzIGNvdW50cnknXG4gICAgY29uc3QgdGl0bGUgPSBtZXRhZGF0YT8udGl0bGUgfHwgJ3RoaXMgY29udGVudCdcblxuICAgIGNvbnN0IGZhbGxiYWNrU2V0cyA9IHtcbiAgICAgICdBMSc6IFtcbiAgICAgICAgYERvIHlvdSBrbm93IGFib3V0ICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYElzIHRoaXMgdG9waWMgY29tbW9uIGluIHlvdXIgY291bnRyeT9gLFxuICAgICAgICBgRG8geW91IHdhbnQgdG8gbGVhcm4gYWJvdXQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gXG4gICAgICBdLFxuICAgICAgJ0EyJzogW1xuICAgICAgICBgSGF2ZSB5b3UgZXhwZXJpZW5jZWQgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBiZWZvcmU/YCxcbiAgICAgICAgYFdoYXQgaXMgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBsaWtlIGluIHlvdXIgY291bnRyeT9gLFxuICAgICAgICBgV2h5IGlzICR7dG9waWMudG9Mb3dlckNhc2UoKX0gaW50ZXJlc3RpbmcgdG8geW91P2BcbiAgICAgIF0sXG4gICAgICAnQjEnOiBbXG4gICAgICAgIGBXaGF0IGRvIHlvdSB0aGluayBhYm91dCAke3RvcGljLnRvTG93ZXJDYXNlKCl9P2AsXG4gICAgICAgIGBIb3cgaXMgJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBkaWZmZXJlbnQgaW4geW91ciBjb3VudHJ5IGNvbXBhcmVkIHRvICR7c291cmNlQ291bnRyeX0/YCxcbiAgICAgICAgYFdoYXQgd291bGQgeW91IGV4cGVjdCB0byBsZWFybiBmcm9tIHRoaXMgJHtjb250ZW50QW5hbHlzaXMuY29udGVudFR5cGV9P2BcbiAgICAgIF0sXG4gICAgICAnQjInOiBbXG4gICAgICAgIGBXaGF0IGFyZSB5b3VyIHRob3VnaHRzIG9uIGhvdyAke3RvcGljLnRvTG93ZXJDYXNlKCl9IGlzIHByZXNlbnRlZCBpbiAke3NvdXJjZUNvdW50cnl9IG1lZGlhP2AsXG4gICAgICAgIGBXaGF0IGNoYWxsZW5nZXMgZG8geW91IHRoaW5rIHBlb3BsZSBmYWNlIHdpdGggJHt0b3BpYy50b0xvd2VyQ2FzZSgpfT9gLFxuICAgICAgICBgSG93IG1pZ2h0IHlvdXIgcGVyc3BlY3RpdmUgb24gJHt0b3BpYy50b0xvd2VyQ2FzZSgpfSBkaWZmZXIgZnJvbSB0aGUgYXV0aG9yJ3M/YFxuICAgICAgXSxcbiAgICAgICdDMSc6IFtcbiAgICAgICAgYEhvdyBkbyBjdWx0dXJhbCBhdHRpdHVkZXMgdG93YXJkICR7dG9waWMudG9Mb3dlckNhc2UoKX0gdmFyeSBiZXR3ZWVuICR7c291cmNlQ291bnRyeX0gYW5kIHlvdXIgY291bnRyeT9gLFxuICAgICAgICBgV2hhdCBhcmUgdGhlIGJyb2FkZXIgc29jaWV0YWwgaW1wbGljYXRpb25zIG9mICR7dG9waWMudG9Mb3dlckNhc2UoKX0/YCxcbiAgICAgICAgYEhvdyBtaWdodCB0aGUgcGVyc3BlY3RpdmUgaW4gdGhpcyAke2NvbnRlbnRBbmFseXNpcy5jb250ZW50VHlwZX0gcmVmbGVjdCAke3NvdXJjZUNvdW50cnl9IHZhbHVlcz9gXG4gICAgICBdXG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbGxiYWNrU2V0c1tsZXZlbF0gfHwgZmFsbGJhY2tTZXRzWydCMSddXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGxlc3NvbkFJU2VydmVyR2VuZXJhdG9yID0gbmV3IExlc3NvbkFJU2VydmVyR2VuZXJhdG9yKClcbiJdLCJuYW1lcyI6WyJjcmVhdGVHb29nbGVBSVNlcnZlclNlcnZpY2UiLCJMZXNzb25BSVNlcnZlckdlbmVyYXRvciIsImdldEdvb2dsZUFJIiwiZ29vZ2xlQUkiLCJnZW5lcmF0ZUxlc3NvbiIsInBhcmFtcyIsInNvdXJjZVRleHQiLCJsZXNzb25UeXBlIiwic3R1ZGVudExldmVsIiwidGFyZ2V0TGFuZ3VhZ2UiLCJzb3VyY2VVcmwiLCJjb250ZW50TWV0YWRhdGEiLCJzdHJ1Y3R1cmVkQ29udGVudCIsIndvcmRDb3VudCIsInJlYWRpbmdUaW1lIiwiY29uc29sZSIsImxvZyIsInRleHRMZW5ndGgiLCJsZW5ndGgiLCJoYXNNZXRhZGF0YSIsImhhc1N0cnVjdHVyZWRDb250ZW50IiwibGVzc29uU3RydWN0dXJlIiwiZ2VuZXJhdGVNaW5pbWFsQUlMZXNzb24iLCJPYmplY3QiLCJrZXlzIiwiZmluYWxMZXNzb24iLCJzZWN0aW9ucyIsInNlY3Rpb25zQ291bnQiLCJ3YXJtdXBDb3VudCIsIndhcm11cCIsInZvY2FidWxhcnlDb3VudCIsInZvY2FidWxhcnkiLCJlcnJvciIsImdlbmVyYXRlU21hcnRUZW1wbGF0ZUZhbGxiYWNrIiwibWV0YWRhdGEiLCJ3YXJtdXBRdWVzdGlvbnMiLCJnZW5lcmF0ZU1pbmltYWxXYXJtdXAiLCJnZW5lcmF0ZU1pbmltYWxWb2NhYnVsYXJ5IiwiY29tcHJlaGVuc2lvblF1ZXN0aW9ucyIsImdlbmVyYXRlTWluaW1hbENvbXByZWhlbnNpb24iLCJhZGRXYXJtdXBJbnN0cnVjdGlvbnMiLCJyZWFkaW5nIiwiZ2VuZXJhdGVTbWFydFJlYWRpbmciLCJjb21wcmVoZW5zaW9uIiwiYWRkQ29tcHJlaGVuc2lvbkluc3RydWN0aW9ucyIsImRpc2N1c3Npb24iLCJhZGREaXNjdXNzaW9uSW5zdHJ1Y3Rpb25zIiwiZ2VuZXJhdGVTbWFydERpc2N1c3Npb24iLCJleHRyYWN0QmV0dGVyVG9waWNzIiwiZ3JhbW1hciIsImdlbmVyYXRlU21hcnRHcmFtbWFyIiwicHJvbnVuY2lhdGlvbiIsImdlbmVyYXRlU21hcnRQcm9udW5jaWF0aW9uIiwibWFwIiwidiIsIndvcmQiLCJ3cmFwdXAiLCJhZGRXcmFwdXBJbnN0cnVjdGlvbnMiLCJnZW5lcmF0ZVNtYXJ0V3JhcHVwIiwidG9waWNzIiwibWFpblRvcGljIiwicHJvbXB0IiwicmVzcG9uc2UiLCJxdWVzdGlvbnMiLCJzcGxpdCIsImxpbmUiLCJ0cmltIiwiZmlsdGVyIiwiZW5kc1dpdGgiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwicmVwbGFjZSIsInNsaWNlIiwiZ2VuZXJhdGVTbWFydFdhcm11cFF1ZXN0aW9ucyIsImluc3RydWN0aW9uIiwidGV4dCIsImNvbXBvdW5kUGF0dGVybnMiLCJwYXR0ZXJuIiwibWF0Y2hlcyIsIm1hdGNoIiwicHVzaCIsIm0iLCJ3b3JkcyIsImNvbW1vbldvcmRzIiwiZm91bmRXb3JkcyIsInVuaXF1ZVdvcmRzIiwiQXJyYXkiLCJmcm9tIiwiU2V0IiwibWVhbmluZyIsInNlbnRlbmNlcyIsImV4YW1wbGUiLCJmaW5kIiwicyIsInN1YnN0cmluZyIsImdlbmVyYXRlV29yZE1lYW5pbmciLCJzaG9ydFRleHQiLCJnZW5lcmF0ZVNtYXJ0Q29tcHJlaGVuc2lvbiIsImV4dHJhY3RUb3BpY3NGcm9tVGV4dCIsImV4dHJhY3RWb2NhYnVsYXJ5RnJvbVRleHQiLCJnZW5lcmF0ZVNtYXJ0Vm9jYWJ1bGFyeSIsImFuYWx5emVDb250ZW50Q29udGV4dE5vQUkiLCJhbmFseXNpcyIsImNvbnRlbnRUeXBlIiwiZG9tYWluIiwiY29tcGxleGl0eSIsImtleVZvY2FidWxhcnkiLCJjdWx0dXJhbENvbnRleHQiLCJsZWFybmluZ09iamVjdGl2ZXMiLCJkaWZmaWN1bHR5IiwidGl0bGUiLCJzb3VyY2VDb3VudHJ5IiwiZGV0ZXJtaW5lU291cmNlQ291bnRyeSIsImF2Z1NlbnRlbmNlTGVuZ3RoIiwicmVkdWNlIiwic3VtIiwiY29tcGxleFdvcmRzIiwidG90YWxXb3JkcyIsImhlYWRpbmdzIiwiZGV0ZXJtaW5lQ3VsdHVyYWxDb250ZXh0IiwiZ2VuZXJhdGVMZWFybmluZ09iamVjdGl2ZXMiLCJhbmFseXplQ29udGVudENvbnRleHQiLCJjcmVhdGVDb250ZXh0dWFsU3VtbWFyeSIsImNvbnRlbnRBbmFseXNpcyIsInN1bW1hcnlQcm9tcHQiLCJzdW1tYXJ5IiwidGVtcGVyYXR1cmUiLCJtYXhUb2tlbnMiLCJ3YXJuIiwibWVzc2FnZSIsInRydW5jYXRlZCIsImdlbmVyYXRlQ29udGV4dHVhbFdhcm11cFF1ZXN0aW9ucyIsImNvbnRlbnQiLCJsZXZlbEluc3RydWN0aW9ucyIsInRvcGljIiwid2FybXVwUHJvbXB0IiwicGFyc2VMaXN0RnJvbVRleHQiLCJmYWxsYmFja1F1ZXN0aW9uIiwiZ2V0RmFsbGJhY2tXYXJtdXBRdWVzdGlvbiIsImZhbGxiYWNrUXVlc3Rpb25zIiwiZ2V0Q29udGV4dHVhbFdhcm11cEZhbGxiYWNrIiwiZ2VuZXJhdGVDb250ZXh0dWFsTGVzc29uU3RydWN0dXJlIiwiY29udGV4dHVhbFdhcm11cCIsImpvaW4iLCJ2b2NhYiIsIkpTT04iLCJzdHJpbmdpZnkiLCJwYXJzZWQiLCJwYXJzZSIsInBhcnNlRXJyb3IiLCJqc29uTWF0Y2giLCJjbGVhbmVkIiwiY2xlYW5FcnJvciIsImZhbGxiYWNrIiwiY3JlYXRlU3RydWN0dXJlZEZhbGxiYWNrIiwiZ2VuZXJhdGVEZXRhaWxlZENvbnRleHR1YWxDb250ZW50Iiwic3RydWN0dXJlIiwiaSIsImNvbnRleHR1YWxFeGFtcGxlUHJvbXB0IiwiZW5oYW5jZWRFeGFtcGxlIiwid3JpdGUiLCJ0b25lIiwiY29udGV4dHVhbE1lYW5pbmdQcm9tcHQiLCJjb250ZXh0dWFsTWVhbmluZyIsImVuaGFuY2VkRGlzY3Vzc2lvblByb21wdCIsImVuaGFuY2VkRGlzY3Vzc2lvbiIsImZvcm1hdCIsInN0cnVjdHVyZWRSZWFkaW5nUHJvbXB0IiwiaCIsImVuaGFuY2VkUmVhZGluZyIsInJld3JpdGUiLCJhdWRpZW5jZSIsImdldEF1ZGllbmNlTGV2ZWwiLCJmb2N1cyIsImdyYW1tYXJFeGFtcGxlc1Byb21wdCIsImNvbnRleHR1YWxHcmFtbWFyRXhhbXBsZXMiLCJjb250ZXh0dWFsRXhhbXBsZXMiLCJwcm9vZnJlYWRMZXNzb24iLCJsZXNzb24iLCJzZWN0aW9uc1RvUHJvb2ZyZWFkIiwic2VjdGlvblBhdGgiLCJ2YWx1ZSIsImdldE5lc3RlZFZhbHVlIiwicHJvb2ZyZWFkIiwiY2hlY2tHcmFtbWFyIiwiY2hlY2tTcGVsbGluZyIsImNoZWNrU3R5bGUiLCJzZXROZXN0ZWRWYWx1ZSIsImNvcnJlY3RlZF90ZXh0IiwiZ2VuZXJhdGVGYWxsYmFja0xlc3NvbiIsImdldFRlbXBsYXRlV2FybXVwIiwiZXh0cmFjdFZvY2FidWxhcnkiLCJzaW1wbGlmeVRleHQiLCJnZXRUZW1wbGF0ZUNvbXByZWhlbnNpb24iLCJnZXRUZW1wbGF0ZURpc2N1c3Npb24iLCJnZXRUZW1wbGF0ZUdyYW1tYXIiLCJnZXRUZW1wbGF0ZVByb251bmNpYXRpb24iLCJnZXRUZW1wbGF0ZVdyYXB1cCIsImdldFN1bW1hcnlMZW5ndGgiLCJsZXZlbCIsImxlbmd0aE1hcCIsIkExIiwiQTIiLCJCMSIsIkIyIiwiQzEiLCJnZXRMYW5ndWFnZUNvZGUiLCJsYW5ndWFnZSIsImxhbmd1YWdlTWFwIiwic3BhbmlzaCIsImZyZW5jaCIsImdlcm1hbiIsIml0YWxpYW4iLCJwb3J0dWd1ZXNlIiwiamFwYW5lc2UiLCJrb3JlYW4iLCJjaGluZXNlIiwib2JqIiwicGF0aCIsImN1cnJlbnQiLCJrZXkiLCJsYXN0S2V5IiwicG9wIiwidGFyZ2V0IiwidGVtcGxhdGVzIiwidHJhdmVsIiwiYnVzaW5lc3MiLCJzZWxlY3RlZFdvcmRzIiwibWF4TGVuZ3RoIiwibGltaXQiLCJncmFtbWFyRm9jaSIsImV4YW1wbGVzIiwiZXhlcmNpc2UiLCJzZWxlY3RlZFdvcmQiLCJpcGEiLCJwcmFjdGljZSIsImV4dHJhY3RUb3BpY3NGcm9tSGVhZGluZ3MiLCJoZWFkaW5nVG9waWNzIiwidG9waWNQYXR0ZXJucyIsInNlbnRlbmNlIiwia2V5V29yZHMiLCJpbmRleCIsImFyciIsImluZGV4T2YiLCJjb21wbGV4aXR5VGhyZXNob2xkIiwiY3VsdHVyYWxJbmRpY2F0b3JzIiwiYW1lcmljYW5NYXJrZXJzIiwiYnJpdGlzaE1hcmtlcnMiLCJhbWVyaWNhbkNvdW50IiwibWFya2VyIiwiYnJpdGlzaENvdW50Iiwib2JqZWN0aXZlcyIsImZvckVhY2giLCJjZWZyTGV2ZWwiLCJsZXZlbE1hcCIsImdlbmVyYXRlRW5oYW5jZWRGYWxsYmFja0xlc3NvbiIsIm1vY2tDb250ZW50QW5hbHlzaXMiLCJleHRyYWN0Q29udGV4dHVhbFZvY2FidWxhcnkiLCJnZXRDb250ZXh0dWFsQ29tcHJlaGVuc2lvbiIsImdldENvbnRleHR1YWxEaXNjdXNzaW9uIiwiZ2V0Q29udGV4dHVhbFdyYXB1cCIsImdldENvbnRleHR1YWxXYXJtdXAiLCJtb2NrQW5hbHlzaXMiLCJnZW5lcmF0ZUJhc2ljRmFsbGJhY2tMZXNzb24iLCJjb250ZXh0IiwiYmFzZVF1ZXN0aW9ucyIsImdlbmVyYXRlU21hcnRUZW1wbGF0ZUxlc3NvbiIsInNlY29uZFRvcGljIiwibGV2ZWxRdWVzdGlvbnMiLCJjb250ZXh0U2VudGVuY2UiLCJjb21tb25NZWFuaW5ncyIsInRhcmdldExlbmd0aCIsInNpbXBsaWZpZWRTZW50ZW5jZXMiLCJncmFtbWFyRm9jdXMiLCJ3IiwicHJvbnVuY2lhdGlvbnMiLCJjb3VudHJ5TWFwIiwiZG9tYWluS2V5IiwiY291bnRyeSIsImVudHJpZXMiLCJxdWVzdGlvbkluZGV4IiwiZmFsbGJhY2tTZXRzIiwibGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/lesson-ai-generator-server.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftest-smart-template%2Froute&page=%2Fapi%2Ftest-smart-template%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftest-smart-template%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();
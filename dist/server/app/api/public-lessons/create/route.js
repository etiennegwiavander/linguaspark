"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/public-lessons/create/route";
exports.ids = ["app/api/public-lessons/create/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpublic-lessons%2Fcreate%2Froute&page=%2Fapi%2Fpublic-lessons%2Fcreate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpublic-lessons%2Fcreate%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpublic-lessons%2Fcreate%2Froute&page=%2Fapi%2Fpublic-lessons%2Fcreate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpublic-lessons%2Fcreate%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_linguaspark_app_api_public_lessons_create_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/public-lessons/create/route.ts */ \"(rsc)/./app/api/public-lessons/create/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/public-lessons/create/route\",\n        pathname: \"/api/public-lessons/create\",\n        filename: \"route\",\n        bundlePath: \"app/api/public-lessons/create/route\"\n    },\n    resolvedPagePath: \"D:\\\\linguaspark\\\\app\\\\api\\\\public-lessons\\\\create\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_linguaspark_app_api_public_lessons_create_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/public-lessons/create/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwdWJsaWMtbGVzc29ucyUyRmNyZWF0ZSUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGcHVibGljLWxlc3NvbnMlMkZjcmVhdGUlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZwdWJsaWMtbGVzc29ucyUyRmNyZWF0ZSUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDbGluZ3Vhc3BhcmslNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUQlM0ElNUNsaW5ndWFzcGFyayZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDVztBQUN4RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvP2E3NjMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxcbGluZ3Vhc3BhcmtcXFxcYXBwXFxcXGFwaVxcXFxwdWJsaWMtbGVzc29uc1xcXFxjcmVhdGVcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3B1YmxpYy1sZXNzb25zL2NyZWF0ZS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3B1YmxpYy1sZXNzb25zL2NyZWF0ZVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvcHVibGljLWxlc3NvbnMvY3JlYXRlL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRDpcXFxcbGluZ3Vhc3BhcmtcXFxcYXBwXFxcXGFwaVxcXFxwdWJsaWMtbGVzc29uc1xcXFxjcmVhdGVcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3B1YmxpYy1sZXNzb25zL2NyZWF0ZS9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpublic-lessons%2Fcreate%2Froute&page=%2Fapi%2Fpublic-lessons%2Fcreate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpublic-lessons%2Fcreate%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/public-lessons/create/route.ts":
/*!************************************************!*\
  !*** ./app/api/public-lessons/create/route.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase-server */ \"(rsc)/./lib/supabase-server.ts\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/* harmony import */ var _lib_public_lessons_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/public-lessons-server */ \"(rsc)/./lib/public-lessons-server.ts\");\n/* harmony import */ var _lib_admin_utils_server__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/admin-utils-server */ \"(rsc)/./lib/admin-utils-server.ts\");\n\n\n\n\n\nasync function POST(request) {\n    try {\n        // Parse request body first\n        const body = await request.json();\n        const { lesson, metadata, userId } = body;\n        let authenticatedUserId;\n        // Check if userId is provided (from extension)\n        if (userId) {\n            // Verify the user is an admin\n            const adminStatus = await (0,_lib_admin_utils_server__WEBPACK_IMPORTED_MODULE_3__.isAdmin)(userId);\n            if (!adminStatus) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: \"PERMISSION_DENIED\",\n                    message: \"Only admins can create public lessons\"\n                }, {\n                    status: 403\n                });\n            }\n            authenticatedUserId = userId;\n        } else {\n            // Get authenticated user from Authorization header or session\n            const authHeader = request.headers.get(\"authorization\");\n            let user = null;\n            let authError = null;\n            if (authHeader && authHeader.startsWith(\"Bearer \")) {\n                // Use the Bearer token from the header\n                const token = authHeader.substring(7);\n                const supabaseUrl = \"https://jbkpnirowdvlwlgheqho.supabase.co\";\n                const supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impia3BuaXJvd2R2bHdsZ2hlcWhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5MTQ3NTEsImV4cCI6MjA3NDQ5MDc1MX0.FZhruXKDzIkZLhla5oerfs7yzjvTsGLlKTUer34N6N0\";\n                const supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_4__.createClient)(supabaseUrl, supabaseAnonKey, {\n                    global: {\n                        headers: {\n                            Authorization: authHeader\n                        }\n                    }\n                });\n                const result = await supabase.auth.getUser(token);\n                user = result.data.user;\n                authError = result.error;\n            } else {\n                // Fall back to cookie-based session\n                const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createServerSupabaseClient)();\n                const result = await supabase.auth.getUser();\n                user = result.data.user;\n                authError = result.error;\n            }\n            if (authError || !user) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: \"AUTHENTICATION_REQUIRED\",\n                    message: \"You must be logged in to create public lessons\"\n                }, {\n                    status: 401\n                });\n            }\n            // Verify the user is an admin\n            const adminStatus = await (0,_lib_admin_utils_server__WEBPACK_IMPORTED_MODULE_3__.isAdmin)(user.id);\n            if (!adminStatus) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: \"PERMISSION_DENIED\",\n                    message: \"Only admins can create public lessons\"\n                }, {\n                    status: 403\n                });\n            }\n            authenticatedUserId = user.id;\n        }\n        if (!lesson || !metadata) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"INVALID_REQUEST\",\n                message: \"Lesson content and metadata are required\"\n            }, {\n                status: 400\n            });\n        }\n        // Validate lesson content\n        console.log(\"[API] Validating lesson content...\");\n        console.log(\"[API] Lesson keys:\", Object.keys(lesson));\n        console.log(\"[API] Has title:\", !!lesson.title);\n        console.log(\"[API] Has warmup:\", !!lesson.warmup);\n        console.log(\"[API] Has wrapup:\", !!lesson.wrapup);\n        console.log(\"[API] Has metadata:\", !!lesson.metadata);\n        if (lesson.metadata) {\n            console.log(\"[API] Metadata keys:\", Object.keys(lesson.metadata));\n            console.log(\"[API] Has cefr_level:\", !!lesson.metadata.cefr_level);\n            console.log(\"[API] Has lesson_type:\", !!lesson.metadata.lesson_type);\n        }\n        const validation = (0,_lib_public_lessons_server__WEBPACK_IMPORTED_MODULE_2__.validatePublicLessonContent)(lesson);\n        if (!validation.valid) {\n            console.log(\"[API] Validation failed:\", validation.errors);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"VALIDATION_ERROR\",\n                message: \"Lesson content validation failed\",\n                errors: validation.errors\n            }, {\n                status: 400\n            });\n        }\n        // Create public lesson\n        const result = await (0,_lib_public_lessons_server__WEBPACK_IMPORTED_MODULE_2__.createPublicLesson)(lesson, metadata, authenticatedUserId);\n        if (!result.success) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: result.error,\n                message: result.message\n            }, {\n                status: 500\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            lesson_id: result.data,\n            message: \"Public lesson created successfully\"\n        });\n    } catch (error) {\n        console.error(\"Error creating public lesson:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"UNKNOWN_ERROR\",\n            message: \"An unexpected error occurred while creating the lesson\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3B1YmxpYy1sZXNzb25zL2NyZWF0ZS9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBd0Q7QUFDVztBQUNkO0FBQ3lDO0FBQzNDO0FBRzVDLGVBQWVNLEtBQUtDLE9BQW9CO0lBQzdDLElBQUk7UUFDRiwyQkFBMkI7UUFDM0IsTUFBTUMsT0FBTyxNQUFNRCxRQUFRRSxJQUFJO1FBQy9CLE1BQU0sRUFBRUMsTUFBTSxFQUFFQyxRQUFRLEVBQUVDLE1BQU0sRUFBRSxHQUFHSjtRQU1yQyxJQUFJSztRQUVKLCtDQUErQztRQUMvQyxJQUFJRCxRQUFRO1lBQ1YsOEJBQThCO1lBQzlCLE1BQU1FLGNBQWMsTUFBTVQsZ0VBQU9BLENBQUNPO1lBQ2xDLElBQUksQ0FBQ0UsYUFBYTtnQkFDaEIsT0FBT2QscURBQVlBLENBQUNTLElBQUksQ0FDdEI7b0JBQ0VNLFNBQVM7b0JBQ1RDLE9BQU87b0JBQ1BDLFNBQVM7Z0JBQ1gsR0FDQTtvQkFBRUMsUUFBUTtnQkFBSTtZQUVsQjtZQUNBTCxzQkFBc0JEO1FBQ3hCLE9BQU87WUFDTCw4REFBOEQ7WUFDOUQsTUFBTU8sYUFBYVosUUFBUWEsT0FBTyxDQUFDQyxHQUFHLENBQUM7WUFDdkMsSUFBSUMsT0FBTztZQUNYLElBQUlDLFlBQVk7WUFFaEIsSUFBSUosY0FBY0EsV0FBV0ssVUFBVSxDQUFDLFlBQVk7Z0JBQ2xELHVDQUF1QztnQkFDdkMsTUFBTUMsUUFBUU4sV0FBV08sU0FBUyxDQUFDO2dCQUNuQyxNQUFNQyxjQUFjQywwQ0FBb0M7Z0JBQ3hELE1BQU1HLGtCQUFrQkgsa05BQXlDO2dCQUNqRSxNQUFNSyxXQUFXL0IsbUVBQVlBLENBQUN5QixhQUFhSSxpQkFBaUI7b0JBQzFERyxRQUFRO3dCQUNOZCxTQUFTOzRCQUNQZSxlQUFlaEI7d0JBQ2pCO29CQUNGO2dCQUNGO2dCQUNBLE1BQU1pQixTQUFTLE1BQU1ILFNBQVNJLElBQUksQ0FBQ0MsT0FBTyxDQUFDYjtnQkFDM0NILE9BQU9jLE9BQU9HLElBQUksQ0FBQ2pCLElBQUk7Z0JBQ3ZCQyxZQUFZYSxPQUFPcEIsS0FBSztZQUMxQixPQUFPO2dCQUNMLG9DQUFvQztnQkFDcEMsTUFBTWlCLFdBQVcsTUFBTWhDLGdGQUEwQkE7Z0JBQ2pELE1BQU1tQyxTQUFTLE1BQU1ILFNBQVNJLElBQUksQ0FBQ0MsT0FBTztnQkFDMUNoQixPQUFPYyxPQUFPRyxJQUFJLENBQUNqQixJQUFJO2dCQUN2QkMsWUFBWWEsT0FBT3BCLEtBQUs7WUFDMUI7WUFFQSxJQUFJTyxhQUFhLENBQUNELE1BQU07Z0JBQ3RCLE9BQU90QixxREFBWUEsQ0FBQ1MsSUFBSSxDQUN0QjtvQkFDRU0sU0FBUztvQkFDVEMsT0FBTztvQkFDUEMsU0FBUztnQkFDWCxHQUNBO29CQUFFQyxRQUFRO2dCQUFJO1lBRWxCO1lBRUEsOEJBQThCO1lBQzlCLE1BQU1KLGNBQWMsTUFBTVQsZ0VBQU9BLENBQUNpQixLQUFLa0IsRUFBRTtZQUN6QyxJQUFJLENBQUMxQixhQUFhO2dCQUNoQixPQUFPZCxxREFBWUEsQ0FBQ1MsSUFBSSxDQUN0QjtvQkFDRU0sU0FBUztvQkFDVEMsT0FBTztvQkFDUEMsU0FBUztnQkFDWCxHQUNBO29CQUFFQyxRQUFRO2dCQUFJO1lBRWxCO1lBRUFMLHNCQUFzQlMsS0FBS2tCLEVBQUU7UUFDL0I7UUFFQSxJQUFJLENBQUM5QixVQUFVLENBQUNDLFVBQVU7WUFDeEIsT0FBT1gscURBQVlBLENBQUNTLElBQUksQ0FDdEI7Z0JBQ0VNLFNBQVM7Z0JBQ1RDLE9BQU87Z0JBQ1BDLFNBQVM7WUFDWCxHQUNBO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSwwQkFBMEI7UUFDMUJ1QixRQUFRQyxHQUFHLENBQUM7UUFDWkQsUUFBUUMsR0FBRyxDQUFDLHNCQUFzQkMsT0FBT0MsSUFBSSxDQUFDbEM7UUFDOUMrQixRQUFRQyxHQUFHLENBQUMsb0JBQW9CLENBQUMsQ0FBQ2hDLE9BQU9tQyxLQUFLO1FBQzlDSixRQUFRQyxHQUFHLENBQUMscUJBQXFCLENBQUMsQ0FBQ2hDLE9BQU9vQyxNQUFNO1FBQ2hETCxRQUFRQyxHQUFHLENBQUMscUJBQXFCLENBQUMsQ0FBQ2hDLE9BQU9xQyxNQUFNO1FBQ2hETixRQUFRQyxHQUFHLENBQUMsdUJBQXVCLENBQUMsQ0FBQ2hDLE9BQU9DLFFBQVE7UUFDcEQsSUFBSUQsT0FBT0MsUUFBUSxFQUFFO1lBQ25COEIsUUFBUUMsR0FBRyxDQUFDLHdCQUF3QkMsT0FBT0MsSUFBSSxDQUFDbEMsT0FBT0MsUUFBUTtZQUMvRDhCLFFBQVFDLEdBQUcsQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDaEMsT0FBT0MsUUFBUSxDQUFDcUMsVUFBVTtZQUNqRVAsUUFBUUMsR0FBRyxDQUFDLDBCQUEwQixDQUFDLENBQUNoQyxPQUFPQyxRQUFRLENBQUNzQyxXQUFXO1FBQ3JFO1FBRUEsTUFBTUMsYUFBYTlDLHVGQUEyQkEsQ0FBQ007UUFDL0MsSUFBSSxDQUFDd0MsV0FBV0MsS0FBSyxFQUFFO1lBQ3JCVixRQUFRQyxHQUFHLENBQUMsNEJBQTRCUSxXQUFXRSxNQUFNO1lBQ3pELE9BQU9wRCxxREFBWUEsQ0FBQ1MsSUFBSSxDQUN0QjtnQkFDRU0sU0FBUztnQkFDVEMsT0FBTztnQkFDUEMsU0FBUztnQkFDVG1DLFFBQVFGLFdBQVdFLE1BQU07WUFDM0IsR0FDQTtnQkFBRWxDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLHVCQUF1QjtRQUN2QixNQUFNa0IsU0FBUyxNQUFNakMsOEVBQWtCQSxDQUFDTyxRQUFRQyxVQUFVRTtRQUUxRCxJQUFJLENBQUN1QixPQUFPckIsT0FBTyxFQUFFO1lBQ25CLE9BQU9mLHFEQUFZQSxDQUFDUyxJQUFJLENBQ3RCO2dCQUNFTSxTQUFTO2dCQUNUQyxPQUFPb0IsT0FBT3BCLEtBQUs7Z0JBQ25CQyxTQUFTbUIsT0FBT25CLE9BQU87WUFDekIsR0FDQTtnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsT0FBT2xCLHFEQUFZQSxDQUFDUyxJQUFJLENBQUM7WUFDdkJNLFNBQVM7WUFDVHNDLFdBQVdqQixPQUFPRyxJQUFJO1lBQ3RCdEIsU0FBUztRQUNYO0lBRUYsRUFBRSxPQUFPRCxPQUFPO1FBQ2R5QixRQUFRekIsS0FBSyxDQUFDLGlDQUFpQ0E7UUFDL0MsT0FBT2hCLHFEQUFZQSxDQUFDUyxJQUFJLENBQ3RCO1lBQ0VNLFNBQVM7WUFDVEMsT0FBTztZQUNQQyxTQUFTO1FBQ1gsR0FDQTtZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvLi9hcHAvYXBpL3B1YmxpYy1sZXNzb25zL2NyZWF0ZS9yb3V0ZS50cz9hMjEwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XHJcbmltcG9ydCB7IGNyZWF0ZVNlcnZlclN1cGFiYXNlQ2xpZW50IH0gZnJvbSAnQC9saWIvc3VwYWJhc2Utc2VydmVyJztcclxuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcclxuaW1wb3J0IHsgY3JlYXRlUHVibGljTGVzc29uLCB2YWxpZGF0ZVB1YmxpY0xlc3NvbkNvbnRlbnQgfSBmcm9tICdAL2xpYi9wdWJsaWMtbGVzc29ucy1zZXJ2ZXInO1xyXG5pbXBvcnQgeyBpc0FkbWluIH0gZnJvbSAnQC9saWIvYWRtaW4tdXRpbHMtc2VydmVyJztcclxuaW1wb3J0IHR5cGUgeyBMZXNzb25Db250ZW50LCBQdWJsaWNMZXNzb25NZXRhZGF0YSB9IGZyb20gJ0AvbGliL3R5cGVzL3B1YmxpYy1sZXNzb25zJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIFBhcnNlIHJlcXVlc3QgYm9keSBmaXJzdFxyXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xyXG4gICAgY29uc3QgeyBsZXNzb24sIG1ldGFkYXRhLCB1c2VySWQgfSA9IGJvZHkgYXMge1xyXG4gICAgICBsZXNzb246IExlc3NvbkNvbnRlbnQ7XHJcbiAgICAgIG1ldGFkYXRhOiBQdWJsaWNMZXNzb25NZXRhZGF0YTtcclxuICAgICAgdXNlcklkPzogc3RyaW5nO1xyXG4gICAgfTtcclxuXHJcbiAgICBsZXQgYXV0aGVudGljYXRlZFVzZXJJZDogc3RyaW5nO1xyXG5cclxuICAgIC8vIENoZWNrIGlmIHVzZXJJZCBpcyBwcm92aWRlZCAoZnJvbSBleHRlbnNpb24pXHJcbiAgICBpZiAodXNlcklkKSB7XHJcbiAgICAgIC8vIFZlcmlmeSB0aGUgdXNlciBpcyBhbiBhZG1pblxyXG4gICAgICBjb25zdCBhZG1pblN0YXR1cyA9IGF3YWl0IGlzQWRtaW4odXNlcklkKTtcclxuICAgICAgaWYgKCFhZG1pblN0YXR1cykge1xyXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICAgIGVycm9yOiAnUEVSTUlTU0lPTl9ERU5JRUQnLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiAnT25seSBhZG1pbnMgY2FuIGNyZWF0ZSBwdWJsaWMgbGVzc29ucydcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB7IHN0YXR1czogNDAzIH1cclxuICAgICAgICApO1xyXG4gICAgICB9XHJcbiAgICAgIGF1dGhlbnRpY2F0ZWRVc2VySWQgPSB1c2VySWQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBHZXQgYXV0aGVudGljYXRlZCB1c2VyIGZyb20gQXV0aG9yaXphdGlvbiBoZWFkZXIgb3Igc2Vzc2lvblxyXG4gICAgICBjb25zdCBhdXRoSGVhZGVyID0gcmVxdWVzdC5oZWFkZXJzLmdldCgnYXV0aG9yaXphdGlvbicpO1xyXG4gICAgICBsZXQgdXNlciA9IG51bGw7XHJcbiAgICAgIGxldCBhdXRoRXJyb3IgPSBudWxsO1xyXG5cclxuICAgICAgaWYgKGF1dGhIZWFkZXIgJiYgYXV0aEhlYWRlci5zdGFydHNXaXRoKCdCZWFyZXIgJykpIHtcclxuICAgICAgICAvLyBVc2UgdGhlIEJlYXJlciB0b2tlbiBmcm9tIHRoZSBoZWFkZXJcclxuICAgICAgICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIuc3Vic3RyaW5nKDcpO1xyXG4gICAgICAgIGNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMITtcclxuICAgICAgICBjb25zdCBzdXBhYmFzZUFub25LZXkgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSE7XHJcbiAgICAgICAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlQW5vbktleSwge1xyXG4gICAgICAgICAgZ2xvYmFsOiB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBhdXRoSGVhZGVyXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIodG9rZW4pO1xyXG4gICAgICAgIHVzZXIgPSByZXN1bHQuZGF0YS51c2VyO1xyXG4gICAgICAgIGF1dGhFcnJvciA9IHJlc3VsdC5lcnJvcjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBGYWxsIGJhY2sgdG8gY29va2llLWJhc2VkIHNlc3Npb25cclxuICAgICAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZVNlcnZlclN1cGFiYXNlQ2xpZW50KCk7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKCk7XHJcbiAgICAgICAgdXNlciA9IHJlc3VsdC5kYXRhLnVzZXI7XHJcbiAgICAgICAgYXV0aEVycm9yID0gcmVzdWx0LmVycm9yO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgICAgZXJyb3I6ICdBVVRIRU5USUNBVElPTl9SRVFVSVJFRCcsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdZb3UgbXVzdCBiZSBsb2dnZWQgaW4gdG8gY3JlYXRlIHB1YmxpYyBsZXNzb25zJ1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHsgc3RhdHVzOiA0MDEgfVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFZlcmlmeSB0aGUgdXNlciBpcyBhbiBhZG1pblxyXG4gICAgICBjb25zdCBhZG1pblN0YXR1cyA9IGF3YWl0IGlzQWRtaW4odXNlci5pZCk7XHJcbiAgICAgIGlmICghYWRtaW5TdGF0dXMpIHtcclxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICBlcnJvcjogJ1BFUk1JU1NJT05fREVOSUVEJyxcclxuICAgICAgICAgICAgbWVzc2FnZTogJ09ubHkgYWRtaW5zIGNhbiBjcmVhdGUgcHVibGljIGxlc3NvbnMnXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMyB9XHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgYXV0aGVudGljYXRlZFVzZXJJZCA9IHVzZXIuaWQ7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFsZXNzb24gfHwgIW1ldGFkYXRhKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgIGVycm9yOiAnSU5WQUxJRF9SRVFVRVNUJyxcclxuICAgICAgICAgIG1lc3NhZ2U6ICdMZXNzb24gY29udGVudCBhbmQgbWV0YWRhdGEgYXJlIHJlcXVpcmVkJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmFsaWRhdGUgbGVzc29uIGNvbnRlbnRcclxuICAgIGNvbnNvbGUubG9nKCdbQVBJXSBWYWxpZGF0aW5nIGxlc3NvbiBjb250ZW50Li4uJyk7XHJcbiAgICBjb25zb2xlLmxvZygnW0FQSV0gTGVzc29uIGtleXM6JywgT2JqZWN0LmtleXMobGVzc29uKSk7XHJcbiAgICBjb25zb2xlLmxvZygnW0FQSV0gSGFzIHRpdGxlOicsICEhbGVzc29uLnRpdGxlKTtcclxuICAgIGNvbnNvbGUubG9nKCdbQVBJXSBIYXMgd2FybXVwOicsICEhbGVzc29uLndhcm11cCk7XHJcbiAgICBjb25zb2xlLmxvZygnW0FQSV0gSGFzIHdyYXB1cDonLCAhIWxlc3Nvbi53cmFwdXApO1xyXG4gICAgY29uc29sZS5sb2coJ1tBUEldIEhhcyBtZXRhZGF0YTonLCAhIWxlc3Nvbi5tZXRhZGF0YSk7XHJcbiAgICBpZiAobGVzc29uLm1ldGFkYXRhKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdbQVBJXSBNZXRhZGF0YSBrZXlzOicsIE9iamVjdC5rZXlzKGxlc3Nvbi5tZXRhZGF0YSkpO1xyXG4gICAgICBjb25zb2xlLmxvZygnW0FQSV0gSGFzIGNlZnJfbGV2ZWw6JywgISFsZXNzb24ubWV0YWRhdGEuY2Vmcl9sZXZlbCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdbQVBJXSBIYXMgbGVzc29uX3R5cGU6JywgISFsZXNzb24ubWV0YWRhdGEubGVzc29uX3R5cGUpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCB2YWxpZGF0aW9uID0gdmFsaWRhdGVQdWJsaWNMZXNzb25Db250ZW50KGxlc3Nvbik7XHJcbiAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcclxuICAgICAgY29uc29sZS5sb2coJ1tBUEldIFZhbGlkYXRpb24gZmFpbGVkOicsIHZhbGlkYXRpb24uZXJyb3JzKTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6ICdWQUxJREFUSU9OX0VSUk9SJyxcclxuICAgICAgICAgIG1lc3NhZ2U6ICdMZXNzb24gY29udGVudCB2YWxpZGF0aW9uIGZhaWxlZCcsXHJcbiAgICAgICAgICBlcnJvcnM6IHZhbGlkYXRpb24uZXJyb3JzXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDcmVhdGUgcHVibGljIGxlc3NvblxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY3JlYXRlUHVibGljTGVzc29uKGxlc3NvbiwgbWV0YWRhdGEsIGF1dGhlbnRpY2F0ZWRVc2VySWQpO1xyXG5cclxuICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6IHJlc3VsdC5lcnJvcixcclxuICAgICAgICAgIG1lc3NhZ2U6IHJlc3VsdC5tZXNzYWdlXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBsZXNzb25faWQ6IHJlc3VsdC5kYXRhLFxyXG4gICAgICBtZXNzYWdlOiAnUHVibGljIGxlc3NvbiBjcmVhdGVkIHN1Y2Nlc3NmdWxseSdcclxuICAgIH0pO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcHVibGljIGxlc3NvbjonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ1VOS05PV05fRVJST1InLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkIHdoaWxlIGNyZWF0aW5nIHRoZSBsZXNzb24nXHJcbiAgICAgIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImNyZWF0ZVNlcnZlclN1cGFiYXNlQ2xpZW50IiwiY3JlYXRlQ2xpZW50IiwiY3JlYXRlUHVibGljTGVzc29uIiwidmFsaWRhdGVQdWJsaWNMZXNzb25Db250ZW50IiwiaXNBZG1pbiIsIlBPU1QiLCJyZXF1ZXN0IiwiYm9keSIsImpzb24iLCJsZXNzb24iLCJtZXRhZGF0YSIsInVzZXJJZCIsImF1dGhlbnRpY2F0ZWRVc2VySWQiLCJhZG1pblN0YXR1cyIsInN1Y2Nlc3MiLCJlcnJvciIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJhdXRoSGVhZGVyIiwiaGVhZGVycyIsImdldCIsInVzZXIiLCJhdXRoRXJyb3IiLCJzdGFydHNXaXRoIiwidG9rZW4iLCJzdWJzdHJpbmciLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsInN1cGFiYXNlIiwiZ2xvYmFsIiwiQXV0aG9yaXphdGlvbiIsInJlc3VsdCIsImF1dGgiLCJnZXRVc2VyIiwiZGF0YSIsImlkIiwiY29uc29sZSIsImxvZyIsIk9iamVjdCIsImtleXMiLCJ0aXRsZSIsIndhcm11cCIsIndyYXB1cCIsImNlZnJfbGV2ZWwiLCJsZXNzb25fdHlwZSIsInZhbGlkYXRpb24iLCJ2YWxpZCIsImVycm9ycyIsImxlc3Nvbl9pZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/public-lessons/create/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/admin-utils-server.ts":
/*!***********************************!*\
  !*** ./lib/admin-utils-server.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAdminInfo: () => (/* binding */ getAdminInfo),\n/* harmony export */   getAdminStats: () => (/* binding */ getAdminStats),\n/* harmony export */   isAdmin: () => (/* binding */ isAdmin),\n/* harmony export */   requireAdmin: () => (/* binding */ requireAdmin),\n/* harmony export */   verifyAdmin: () => (/* binding */ verifyAdmin)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/**\r\n * Admin Utilities - Server-side functions for admin verification and statistics\r\n * \r\n * This module provides admin-related functionality including:\r\n * - Admin status verification\r\n * - Admin statistics retrieval\r\n * - Admin verification middleware\r\n */ \n/**\r\n * Create admin Supabase client (bypasses RLS for admin checks)\r\n */ function getAdminSupabaseClient() {\n    const supabaseUrl = \"https://jbkpnirowdvlwlgheqho.supabase.co\";\n    const supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impia3BuaXJvd2R2bHdsZ2hlcWhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5MTQ3NTEsImV4cCI6MjA3NDQ5MDc1MX0.FZhruXKDzIkZLhla5oerfs7yzjvTsGLlKTUer34N6N0\";\n    if (!supabaseUrl || !supabaseAnonKey) {\n        throw new Error(\"Missing Supabase environment variables\");\n    }\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey);\n}\n/**\r\n * Check if a user has admin privileges\r\n * \r\n * @param userId - The UUID of the user to check\r\n * @returns Promise<boolean> - True if user is admin, false otherwise\r\n */ async function isAdmin(userId) {\n    try {\n        console.log(\"[isAdmin] \\uD83D\\uDD0D Checking admin status for userId:\", userId);\n        const supabase = getAdminSupabaseClient();\n        console.log(\"[isAdmin] \\uD83D\\uDCE1 Querying tutors table...\");\n        const { data, error } = await supabase.from(\"tutors\").select(\"is_admin\").eq(\"id\", userId).single();\n        if (error) {\n            console.error(\"[isAdmin] ❌ Database error:\", error);\n            return false;\n        }\n        console.log(\"[isAdmin] \\uD83D\\uDCCA Database returned data:\", data);\n        console.log(\"[isAdmin] \\uD83C\\uDFAF is_admin value:\", data?.is_admin);\n        console.log(\"[isAdmin] ✅ Returning:\", data?.is_admin === true);\n        return data?.is_admin === true;\n    } catch (error) {\n        console.error(\"[isAdmin] ❌ Exception:\", error);\n        return false;\n    }\n}\n/**\r\n * Verify admin status and throw error if not admin\r\n * Used as middleware-style verification\r\n * \r\n * @param userId - The UUID of the user to verify\r\n * @throws Error if user is not admin\r\n */ async function verifyAdmin(userId) {\n    const adminStatus = await isAdmin(userId);\n    if (!adminStatus) {\n        throw new Error(\"PERMISSION_DENIED: Admin privileges required\");\n    }\n}\n/**\r\n * Get comprehensive admin statistics\r\n * \r\n * @param adminId - The UUID of the admin user requesting stats\r\n * @returns Promise<AdminStats> - Statistics object with lesson counts and breakdowns\r\n */ async function getAdminStats(adminId) {\n    try {\n        // Verify admin status first\n        await verifyAdmin(adminId);\n        const supabase = getAdminSupabaseClient();\n        // Get all public lessons\n        const { data: allLessons, error: lessonsError } = await supabase.from(\"public_lessons\").select(\"*\").order(\"created_at\", {\n            ascending: false\n        });\n        if (lessonsError) {\n            throw new Error(`Failed to fetch lessons: ${lessonsError.message}`);\n        }\n        const lessons = allLessons || [];\n        // Calculate total lessons\n        const total_lessons = lessons.length;\n        // Calculate lessons by category\n        const lessons_by_category = {\n            \"general-english\": 0,\n            \"business\": 0,\n            \"travel\": 0,\n            \"academic\": 0,\n            \"conversation\": 0,\n            \"grammar\": 0,\n            \"vocabulary\": 0,\n            \"pronunciation\": 0,\n            \"culture\": 0\n        };\n        lessons.forEach((lesson)=>{\n            if (lesson.category in lessons_by_category) {\n                lessons_by_category[lesson.category]++;\n            }\n        });\n        // Calculate lessons by CEFR level\n        const lessons_by_level = {\n            \"A1\": 0,\n            \"A2\": 0,\n            \"B1\": 0,\n            \"B2\": 0,\n            \"C1\": 0\n        };\n        lessons.forEach((lesson)=>{\n            if (lesson.cefr_level in lessons_by_level) {\n                lessons_by_level[lesson.cefr_level]++;\n            }\n        });\n        // Get recent lessons (last 10)\n        const recent_lessons = lessons.slice(0, 10);\n        // Count lessons created by this admin\n        const my_lessons_count = lessons.filter((lesson)=>lesson.creator_id === adminId).length;\n        return {\n            total_lessons,\n            lessons_by_category,\n            lessons_by_level,\n            recent_lessons,\n            my_lessons_count\n        };\n    } catch (error) {\n        if (error instanceof Error && error.message.includes(\"PERMISSION_DENIED\")) {\n            throw error;\n        }\n        console.error(\"Error getting admin stats:\", error);\n        throw new Error(\"Failed to retrieve admin statistics\");\n    }\n}\n/**\r\n * Admin verification middleware for API routes\r\n * Returns user ID if admin, throws error otherwise\r\n * \r\n * @param request - The incoming request object\r\n * @returns Promise<string> - The admin user's ID\r\n * @throws Error if not authenticated or not admin\r\n */ async function requireAdmin(request) {\n    try {\n        const supabase = getAdminSupabaseClient();\n        // Get authorization header\n        const authHeader = request.headers.get(\"authorization\");\n        if (!authHeader) {\n            throw new Error(\"UNAUTHORIZED: No authorization header\");\n        }\n        // Extract token\n        const token = authHeader.replace(\"Bearer \", \"\");\n        // Verify token and get user\n        const { data: { user }, error: authError } = await supabase.auth.getUser(token);\n        if (authError || !user) {\n            throw new Error(\"UNAUTHORIZED: Invalid token\");\n        }\n        // Verify admin status\n        await verifyAdmin(user.id);\n        return user.id;\n    } catch (error) {\n        if (error instanceof Error) {\n            throw error;\n        }\n        throw new Error(\"UNAUTHORIZED: Authentication failed\");\n    }\n}\n/**\r\n * Get admin user information\r\n * \r\n * @param userId - The UUID of the admin user\r\n * @returns Promise with admin user data\r\n */ async function getAdminInfo(userId) {\n    try {\n        const supabase = getAdminSupabaseClient();\n        const { data, error } = await supabase.from(\"tutors\").select(\"id, email, is_admin\").eq(\"id\", userId).single();\n        if (error) {\n            console.error(\"Error fetching admin info:\", error);\n            return null;\n        }\n        return data;\n    } catch (error) {\n        console.error(\"Exception fetching admin info:\", error);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJO1FBQ0YsTUFBTUcsV0FBV1o7UUFFakIsTUFBTSxFQUFFYSxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1GLFNBQzNCRyxJQUFJLENBQUMsVUFDTEMsTUFBTSxDQUFDLHVCQUNQQyxFQUFFLENBQUMsTUFBTVIsUUFDVFMsTUFBTTtRQUVULElBQUlKLE9BQU87WUFDVEosUUFBUUksS0FBSyxDQUFDLDhCQUE4QkE7WUFDNUMsT0FBTztRQUNUO1FBRUEsT0FBT0Q7SUFDVCxFQUFFLE9BQU9DLE9BQU87UUFDZEosUUFBUUksS0FBSyxDQUFDLGtDQUFrQ0E7UUFDaEQsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL2FkbWluLXV0aWxzLXNlcnZlci50cz85NjU0Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBBZG1pbiBVdGlsaXRpZXMgLSBTZXJ2ZXItc2lkZSBmdW5jdGlvbnMgZm9yIGFkbWluIHZlcmlmaWNhdGlvbiBhbmQgc3RhdGlzdGljc1xyXG4gKiBcclxuICogVGhpcyBtb2R1bGUgcHJvdmlkZXMgYWRtaW4tcmVsYXRlZCBmdW5jdGlvbmFsaXR5IGluY2x1ZGluZzpcclxuICogLSBBZG1pbiBzdGF0dXMgdmVyaWZpY2F0aW9uXHJcbiAqIC0gQWRtaW4gc3RhdGlzdGljcyByZXRyaWV2YWxcclxuICogLSBBZG1pbiB2ZXJpZmljYXRpb24gbWlkZGxld2FyZVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XHJcbmltcG9ydCB0eXBlIHsgQWRtaW5TdGF0cywgUHVibGljTGVzc29uLCBMZXNzb25DYXRlZ29yeSwgQ0VGUkxldmVsIH0gZnJvbSAnLi90eXBlcy9wdWJsaWMtbGVzc29ucyc7XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFkbWluIFN1cGFiYXNlIGNsaWVudCAoYnlwYXNzZXMgUkxTIGZvciBhZG1pbiBjaGVja3MpXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRBZG1pblN1cGFiYXNlQ2xpZW50KCkge1xyXG4gIGNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMO1xyXG4gIGNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZO1xyXG5cclxuICBpZiAoIXN1cGFiYXNlVXJsIHx8ICFzdXBhYmFzZUFub25LZXkpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBTdXBhYmFzZSBlbnZpcm9ubWVudCB2YXJpYWJsZXMnKTtcclxuICB9XHJcblxyXG4gIHJldHVybiBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlQW5vbktleSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiBhIHVzZXIgaGFzIGFkbWluIHByaXZpbGVnZXNcclxuICogXHJcbiAqIEBwYXJhbSB1c2VySWQgLSBUaGUgVVVJRCBvZiB0aGUgdXNlciB0byBjaGVja1xyXG4gKiBAcmV0dXJucyBQcm9taXNlPGJvb2xlYW4+IC0gVHJ1ZSBpZiB1c2VyIGlzIGFkbWluLCBmYWxzZSBvdGhlcndpc2VcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpc0FkbWluKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCdbaXNBZG1pbl0g8J+UjSBDaGVja2luZyBhZG1pbiBzdGF0dXMgZm9yIHVzZXJJZDonLCB1c2VySWQpO1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRBZG1pblN1cGFiYXNlQ2xpZW50KCk7XHJcblxyXG4gICAgY29uc29sZS5sb2coJ1tpc0FkbWluXSDwn5OhIFF1ZXJ5aW5nIHR1dG9ycyB0YWJsZS4uLicpO1xyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3R1dG9ycycpXHJcbiAgICAgIC5zZWxlY3QoJ2lzX2FkbWluJylcclxuICAgICAgLmVxKCdpZCcsIHVzZXJJZClcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdbaXNBZG1pbl0g4p2MIERhdGFiYXNlIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnNvbGUubG9nKCdbaXNBZG1pbl0g8J+TiiBEYXRhYmFzZSByZXR1cm5lZCBkYXRhOicsIGRhdGEpO1xyXG4gICAgY29uc29sZS5sb2coJ1tpc0FkbWluXSDwn46vIGlzX2FkbWluIHZhbHVlOicsIGRhdGE/LmlzX2FkbWluKTtcclxuICAgIGNvbnNvbGUubG9nKCdbaXNBZG1pbl0g4pyFIFJldHVybmluZzonLCBkYXRhPy5pc19hZG1pbiA9PT0gdHJ1ZSk7XHJcblxyXG4gICAgcmV0dXJuIGRhdGE/LmlzX2FkbWluID09PSB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbaXNBZG1pbl0g4p2MIEV4Y2VwdGlvbjonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVmVyaWZ5IGFkbWluIHN0YXR1cyBhbmQgdGhyb3cgZXJyb3IgaWYgbm90IGFkbWluXHJcbiAqIFVzZWQgYXMgbWlkZGxld2FyZS1zdHlsZSB2ZXJpZmljYXRpb25cclxuICogXHJcbiAqIEBwYXJhbSB1c2VySWQgLSBUaGUgVVVJRCBvZiB0aGUgdXNlciB0byB2ZXJpZnlcclxuICogQHRocm93cyBFcnJvciBpZiB1c2VyIGlzIG5vdCBhZG1pblxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeUFkbWluKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgY29uc3QgYWRtaW5TdGF0dXMgPSBhd2FpdCBpc0FkbWluKHVzZXJJZCk7XHJcblxyXG4gIGlmICghYWRtaW5TdGF0dXMpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcignUEVSTUlTU0lPTl9ERU5JRUQ6IEFkbWluIHByaXZpbGVnZXMgcmVxdWlyZWQnKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgY29tcHJlaGVuc2l2ZSBhZG1pbiBzdGF0aXN0aWNzXHJcbiAqIFxyXG4gKiBAcGFyYW0gYWRtaW5JZCAtIFRoZSBVVUlEIG9mIHRoZSBhZG1pbiB1c2VyIHJlcXVlc3Rpbmcgc3RhdHNcclxuICogQHJldHVybnMgUHJvbWlzZTxBZG1pblN0YXRzPiAtIFN0YXRpc3RpY3Mgb2JqZWN0IHdpdGggbGVzc29uIGNvdW50cyBhbmQgYnJlYWtkb3duc1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFkbWluU3RhdHMoYWRtaW5JZDogc3RyaW5nKTogUHJvbWlzZTxBZG1pblN0YXRzPiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIFZlcmlmeSBhZG1pbiBzdGF0dXMgZmlyc3RcclxuICAgIGF3YWl0IHZlcmlmeUFkbWluKGFkbWluSWQpO1xyXG5cclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0QWRtaW5TdXBhYmFzZUNsaWVudCgpO1xyXG5cclxuICAgIC8vIEdldCBhbGwgcHVibGljIGxlc3NvbnNcclxuICAgIGNvbnN0IHsgZGF0YTogYWxsTGVzc29ucywgZXJyb3I6IGxlc3NvbnNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3B1YmxpY19sZXNzb25zJylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcclxuXHJcbiAgICBpZiAobGVzc29uc0Vycm9yKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIGxlc3NvbnM6ICR7bGVzc29uc0Vycm9yLm1lc3NhZ2V9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbGVzc29ucyA9IGFsbExlc3NvbnMgfHwgW107XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIHRvdGFsIGxlc3NvbnNcclxuICAgIGNvbnN0IHRvdGFsX2xlc3NvbnMgPSBsZXNzb25zLmxlbmd0aDtcclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgbGVzc29ucyBieSBjYXRlZ29yeVxyXG4gICAgY29uc3QgbGVzc29uc19ieV9jYXRlZ29yeTogUmVjb3JkPExlc3NvbkNhdGVnb3J5LCBudW1iZXI+ID0ge1xyXG4gICAgICAnZ2VuZXJhbC1lbmdsaXNoJzogMCxcclxuICAgICAgJ2J1c2luZXNzJzogMCxcclxuICAgICAgJ3RyYXZlbCc6IDAsXHJcbiAgICAgICdhY2FkZW1pYyc6IDAsXHJcbiAgICAgICdjb252ZXJzYXRpb24nOiAwLFxyXG4gICAgICAnZ3JhbW1hcic6IDAsXHJcbiAgICAgICd2b2NhYnVsYXJ5JzogMCxcclxuICAgICAgJ3Byb251bmNpYXRpb24nOiAwLFxyXG4gICAgICAnY3VsdHVyZSc6IDBcclxuICAgIH07XHJcblxyXG4gICAgbGVzc29ucy5mb3JFYWNoKChsZXNzb246IFB1YmxpY0xlc3NvbikgPT4ge1xyXG4gICAgICBpZiAobGVzc29uLmNhdGVnb3J5IGluIGxlc3NvbnNfYnlfY2F0ZWdvcnkpIHtcclxuICAgICAgICBsZXNzb25zX2J5X2NhdGVnb3J5W2xlc3Nvbi5jYXRlZ29yeSBhcyBMZXNzb25DYXRlZ29yeV0rKztcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIGxlc3NvbnMgYnkgQ0VGUiBsZXZlbFxyXG4gICAgY29uc3QgbGVzc29uc19ieV9sZXZlbDogUmVjb3JkPENFRlJMZXZlbCwgbnVtYmVyPiA9IHtcclxuICAgICAgJ0ExJzogMCxcclxuICAgICAgJ0EyJzogMCxcclxuICAgICAgJ0IxJzogMCxcclxuICAgICAgJ0IyJzogMCxcclxuICAgICAgJ0MxJzogMFxyXG4gICAgfTtcclxuXHJcbiAgICBsZXNzb25zLmZvckVhY2goKGxlc3NvbjogUHVibGljTGVzc29uKSA9PiB7XHJcbiAgICAgIGlmIChsZXNzb24uY2Vmcl9sZXZlbCBpbiBsZXNzb25zX2J5X2xldmVsKSB7XHJcbiAgICAgICAgbGVzc29uc19ieV9sZXZlbFtsZXNzb24uY2Vmcl9sZXZlbCBhcyBDRUZSTGV2ZWxdKys7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEdldCByZWNlbnQgbGVzc29ucyAobGFzdCAxMClcclxuICAgIGNvbnN0IHJlY2VudF9sZXNzb25zID0gbGVzc29ucy5zbGljZSgwLCAxMCk7XHJcblxyXG4gICAgLy8gQ291bnQgbGVzc29ucyBjcmVhdGVkIGJ5IHRoaXMgYWRtaW5cclxuICAgIGNvbnN0IG15X2xlc3NvbnNfY291bnQgPSBsZXNzb25zLmZpbHRlcihcclxuICAgICAgKGxlc3NvbjogUHVibGljTGVzc29uKSA9PiBsZXNzb24uY3JlYXRvcl9pZCA9PT0gYWRtaW5JZFxyXG4gICAgKS5sZW5ndGg7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdG90YWxfbGVzc29ucyxcclxuICAgICAgbGVzc29uc19ieV9jYXRlZ29yeSxcclxuICAgICAgbGVzc29uc19ieV9sZXZlbCxcclxuICAgICAgcmVjZW50X2xlc3NvbnMsXHJcbiAgICAgIG15X2xlc3NvbnNfY291bnRcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ1BFUk1JU1NJT05fREVOSUVEJykpIHtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIGFkbWluIHN0YXRzOicsIGVycm9yKTtcclxuICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHJldHJpZXZlIGFkbWluIHN0YXRpc3RpY3MnKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBZG1pbiB2ZXJpZmljYXRpb24gbWlkZGxld2FyZSBmb3IgQVBJIHJvdXRlc1xyXG4gKiBSZXR1cm5zIHVzZXIgSUQgaWYgYWRtaW4sIHRocm93cyBlcnJvciBvdGhlcndpc2VcclxuICogXHJcbiAqIEBwYXJhbSByZXF1ZXN0IC0gVGhlIGluY29taW5nIHJlcXVlc3Qgb2JqZWN0XHJcbiAqIEByZXR1cm5zIFByb21pc2U8c3RyaW5nPiAtIFRoZSBhZG1pbiB1c2VyJ3MgSURcclxuICogQHRocm93cyBFcnJvciBpZiBub3QgYXV0aGVudGljYXRlZCBvciBub3QgYWRtaW5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlQWRtaW4ocmVxdWVzdDogUmVxdWVzdCk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0QWRtaW5TdXBhYmFzZUNsaWVudCgpO1xyXG5cclxuICAgIC8vIEdldCBhdXRob3JpemF0aW9uIGhlYWRlclxyXG4gICAgY29uc3QgYXV0aEhlYWRlciA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ2F1dGhvcml6YXRpb24nKTtcclxuICAgIGlmICghYXV0aEhlYWRlcikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VOQVVUSE9SSVpFRDogTm8gYXV0aG9yaXphdGlvbiBoZWFkZXInKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBFeHRyYWN0IHRva2VuXHJcbiAgICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIucmVwbGFjZSgnQmVhcmVyICcsICcnKTtcclxuXHJcbiAgICAvLyBWZXJpZnkgdG9rZW4gYW5kIGdldCB1c2VyXHJcbiAgICBjb25zdCB7IGRhdGE6IHsgdXNlciB9LCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIodG9rZW4pO1xyXG5cclxuICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVTkFVVEhPUklaRUQ6IEludmFsaWQgdG9rZW4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBWZXJpZnkgYWRtaW4gc3RhdHVzXHJcbiAgICBhd2FpdCB2ZXJpZnlBZG1pbih1c2VyLmlkKTtcclxuXHJcbiAgICByZXR1cm4gdXNlci5pZDtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VOQVVUSE9SSVpFRDogQXV0aGVudGljYXRpb24gZmFpbGVkJyk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGFkbWluIHVzZXIgaW5mb3JtYXRpb25cclxuICogXHJcbiAqIEBwYXJhbSB1c2VySWQgLSBUaGUgVVVJRCBvZiB0aGUgYWRtaW4gdXNlclxyXG4gKiBAcmV0dXJucyBQcm9taXNlIHdpdGggYWRtaW4gdXNlciBkYXRhXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWRtaW5JbmZvKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTx7XHJcbiAgaWQ6IHN0cmluZztcclxuICBlbWFpbDogc3RyaW5nO1xyXG4gIGlzX2FkbWluOiBib29sZWFuO1xyXG59IHwgbnVsbD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldEFkbWluU3VwYWJhc2VDbGllbnQoKTtcclxuXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgndHV0b3JzJylcclxuICAgICAgLnNlbGVjdCgnaWQsIGVtYWlsLCBpc19hZG1pbicpXHJcbiAgICAgIC5lcSgnaWQnLCB1c2VySWQpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWRtaW4gaW5mbzonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBkYXRhO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFeGNlcHRpb24gZmV0Y2hpbmcgYWRtaW4gaW5mbzonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsImdldEFkbWluU3VwYWJhc2VDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsIkVycm9yIiwiaXNBZG1pbiIsInVzZXJJZCIsImNvbnNvbGUiLCJsb2ciLCJzdXBhYmFzZSIsImRhdGEiLCJlcnJvciIsImZyb20iLCJzZWxlY3QiLCJlcSIsInNpbmdsZSIsImlzX2FkbWluIiwidmVyaWZ5QWRtaW4iLCJhZG1pblN0YXR1cyIsImdldEFkbWluU3RhdHMiLCJhZG1pbklkIiwiYWxsTGVzc29ucyIsImxlc3NvbnNFcnJvciIsIm9yZGVyIiwiYXNjZW5kaW5nIiwibWVzc2FnZSIsImxlc3NvbnMiLCJ0b3RhbF9sZXNzb25zIiwibGVuZ3RoIiwibGVzc29uc19ieV9jYXRlZ29yeSIsImZvckVhY2giLCJsZXNzb24iLCJjYXRlZ29yeSIsImxlc3NvbnNfYnlfbGV2ZWwiLCJjZWZyX2xldmVsIiwicmVjZW50X2xlc3NvbnMiLCJzbGljZSIsIm15X2xlc3NvbnNfY291bnQiLCJmaWx0ZXIiLCJjcmVhdG9yX2lkIiwiaW5jbHVkZXMiLCJyZXF1aXJlQWRtaW4iLCJyZXF1ZXN0IiwiYXV0aEhlYWRlciIsImhlYWRlcnMiLCJnZXQiLCJ0b2tlbiIsInJlcGxhY2UiLCJ1c2VyIiwiYXV0aEVycm9yIiwiYXV0aCIsImdldFVzZXIiLCJpZCIsImdldEFkbWluSW5mbyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/admin-utils-server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/public-lessons-server.ts":
/*!**************************************!*\
  !*** ./lib/public-lessons-server.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createPublicLesson: () => (/* binding */ createPublicLesson),\n/* harmony export */   deletePublicLesson: () => (/* binding */ deletePublicLesson),\n/* harmony export */   getPublicLesson: () => (/* binding */ getPublicLesson),\n/* harmony export */   getPublicLessons: () => (/* binding */ getPublicLessons),\n/* harmony export */   updatePublicLesson: () => (/* binding */ updatePublicLesson),\n/* harmony export */   validatePublicLessonContent: () => (/* binding */ validatePublicLessonContent)\n/* harmony export */ });\n/* harmony import */ var _supabase_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase-server */ \"(rsc)/./lib/supabase-server.ts\");\n// Server-side utilities for public lesson library\n// This file contains CRUD operations for public lessons with proper validation and access control\n\n/**\r\n * Validates public lesson content before saving\r\n * Ensures all required sections are present and properly formatted\r\n */ function validatePublicLessonContent(content) {\n    const errors = [];\n    // Validate title\n    if (!content.title || content.title.trim().length === 0) {\n        errors.push(\"Lesson title is required\");\n    }\n    // Validate warmup section\n    if (!content.warmup || !content.warmup.questions || content.warmup.questions.length === 0) {\n        errors.push(\"Warmup section with at least one question is required\");\n    }\n    // Validate wrapup section\n    if (!content.wrapup || !content.wrapup.summary || content.wrapup.summary.trim().length === 0) {\n        errors.push(\"Wrapup section with summary is required\");\n    }\n    // Validate at least one main content section exists\n    const hasMainContent = !!(content.vocabulary || content.grammar || content.reading || content.discussion || content.pronunciation);\n    if (!hasMainContent) {\n        errors.push(\"At least one main content section (vocabulary, grammar, reading, discussion, or pronunciation) is required\");\n    }\n    // Validate metadata\n    if (!content.metadata) {\n        errors.push(\"Lesson metadata is required\");\n    } else {\n        if (!content.metadata.cefr_level) {\n            errors.push(\"CEFR level is required in metadata\");\n        }\n        if (!content.metadata.lesson_type) {\n            errors.push(\"Lesson type is required in metadata\");\n        }\n    }\n    return {\n        valid: errors.length === 0,\n        errors\n    };\n}\n/**\r\n * Retrieves public lessons with filtering and cursor-based pagination\r\n * Supports filtering by category, CEFR level, lesson type, and search\r\n */ async function getPublicLessons(filters = {}, cursor, limit = 20) {\n    try {\n        const supabase = await (0,_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createServerSupabaseClient)();\n        // Build query with filters\n        let query = supabase.from(\"public_lessons\").select(\"*\").order(\"created_at\", {\n            ascending: false\n        }).limit(limit);\n        // Apply cursor-based pagination\n        if (cursor) {\n            query = query.lt(\"created_at\", cursor);\n        }\n        // Apply category filter\n        if (filters.category) {\n            query = query.eq(\"category\", filters.category);\n        }\n        // Apply CEFR level filter\n        if (filters.cefr_level) {\n            query = query.eq(\"cefr_level\", filters.cefr_level);\n        }\n        // Apply lesson type filter\n        if (filters.lesson_type) {\n            query = query.eq(\"lesson_type\", filters.lesson_type);\n        }\n        // Apply search filter (searches in title and source_title)\n        if (filters.search && filters.search.trim().length > 0) {\n            query = query.textSearch(\"search_vector\", filters.search.trim());\n        }\n        const { data, error } = await query;\n        if (error) {\n            return {\n                success: false,\n                error: \"DATABASE_ERROR\",\n                message: `Failed to fetch public lessons: ${error.message}`\n            };\n        }\n        // Calculate next cursor\n        const nextCursor = data && data.length === limit ? data[data.length - 1].created_at : undefined;\n        return {\n            success: true,\n            data: {\n                lessons: data || [],\n                nextCursor\n            }\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: \"UNKNOWN_ERROR\",\n            message: `An unexpected error occurred: ${error instanceof Error ? error.message : \"Unknown error\"}`\n        };\n    }\n}\n/**\r\n * Retrieves a single public lesson by ID\r\n * Accessible to all users (authenticated and unauthenticated)\r\n */ async function getPublicLesson(lessonId) {\n    try {\n        const supabase = await (0,_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createServerSupabaseClient)();\n        const { data, error } = await supabase.from(\"public_lessons\").select(\"*\").eq(\"id\", lessonId).single();\n        if (error) {\n            if (error.code === \"PGRST116\") {\n                return {\n                    success: false,\n                    error: \"NOT_FOUND\",\n                    message: \"Public lesson not found\"\n                };\n            }\n            return {\n                success: false,\n                error: \"DATABASE_ERROR\",\n                message: `Failed to fetch public lesson: ${error.message}`\n            };\n        }\n        return {\n            success: true,\n            data: data\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: \"UNKNOWN_ERROR\",\n            message: `An unexpected error occurred: ${error instanceof Error ? error.message : \"Unknown error\"}`\n        };\n    }\n}\n/**\r\n * Creates a new public lesson\r\n * Requires authentication and validates content before saving\r\n */ async function createPublicLesson(content, metadata, userId) {\n    try {\n        // Validate content\n        const validation = validatePublicLessonContent(content);\n        if (!validation.valid) {\n            return {\n                success: false,\n                error: \"VALIDATION_ERROR\",\n                message: `Content validation failed: ${validation.errors.join(\", \")}`\n            };\n        }\n        // Use service role client to bypass RLS for admin operations\n        // This is safe because we've already verified admin status in the API route\n        const { createClient } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\"));\n        const supabase = createClient(\"https://jbkpnirowdvlwlgheqho.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY, {\n            auth: {\n                autoRefreshToken: false,\n                persistSession: false\n            }\n        });\n        // Prepare lesson data\n        const lessonData = {\n            creator_id: userId,\n            title: content.title,\n            content: content,\n            source_url: content.metadata.source_url || null,\n            source_title: content.metadata.source_title || null,\n            banner_image_url: content.metadata.banner_image_url || null,\n            category: metadata.category,\n            cefr_level: content.metadata.cefr_level,\n            lesson_type: content.metadata.lesson_type,\n            tags: metadata.tags || [],\n            estimated_duration_minutes: metadata.estimated_duration_minutes || null\n        };\n        const { data, error } = await supabase.from(\"public_lessons\").insert(lessonData).select(\"id\").single();\n        if (error) {\n            return {\n                success: false,\n                error: \"DATABASE_ERROR\",\n                message: `Failed to create public lesson: ${error.message}`\n            };\n        }\n        return {\n            success: true,\n            data: data.id,\n            message: \"Public lesson created successfully\"\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: \"UNKNOWN_ERROR\",\n            message: `An unexpected error occurred: ${error instanceof Error ? error.message : \"Unknown error\"}`\n        };\n    }\n}\n/**\r\n * Updates an existing public lesson\r\n * Requires authentication (RLS enforces update permissions)\r\n */ async function updatePublicLesson(lessonId, updates, userId) {\n    try {\n        const supabase = await (0,_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createServerSupabaseClient)();\n        // Verify user is authenticated\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user || user.id !== userId) {\n            return {\n                success: false,\n                error: \"AUTHENTICATION_ERROR\",\n                message: \"User must be authenticated to update public lessons\"\n            };\n        }\n        // If content is being updated, validate it\n        if (updates.content) {\n            const validation = validatePublicLessonContent(updates.content);\n            if (!validation.valid) {\n                return {\n                    success: false,\n                    error: \"VALIDATION_ERROR\",\n                    message: `Content validation failed: ${validation.errors.join(\", \")}`\n                };\n            }\n        }\n        // Remove fields that shouldn't be updated directly\n        const { id, created_at, creator_id, ...allowedUpdates } = updates;\n        const { error } = await supabase.from(\"public_lessons\").update(allowedUpdates).eq(\"id\", lessonId);\n        if (error) {\n            return {\n                success: false,\n                error: \"DATABASE_ERROR\",\n                message: `Failed to update public lesson: ${error.message}`\n            };\n        }\n        return {\n            success: true,\n            message: \"Public lesson updated successfully\"\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: \"UNKNOWN_ERROR\",\n            message: `An unexpected error occurred: ${error instanceof Error ? error.message : \"Unknown error\"}`\n        };\n    }\n}\n/**\r\n * Deletes a public lesson\r\n * Requires admin privileges (enforced by RLS)\r\n */ async function deletePublicLesson(lessonId, userId) {\n    try {\n        const supabase = await (0,_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createServerSupabaseClient)();\n        // Verify user is authenticated\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user || user.id !== userId) {\n            return {\n                success: false,\n                error: \"AUTHENTICATION_ERROR\",\n                message: \"User must be authenticated to delete public lessons\"\n            };\n        }\n        // Verify admin status\n        const { data: tutor, error: tutorError } = await supabase.from(\"tutors\").select(\"is_admin\").eq(\"id\", userId).single();\n        if (tutorError || !tutor?.is_admin) {\n            return {\n                success: false,\n                error: \"PERMISSION_DENIED\",\n                message: \"Only administrators can delete public lessons\"\n            };\n        }\n        // Proceed with deletion\n        const { error } = await supabase.from(\"public_lessons\").delete().eq(\"id\", lessonId);\n        if (error) {\n            return {\n                success: false,\n                error: \"DATABASE_ERROR\",\n                message: `Failed to delete public lesson: ${error.message}`\n            };\n        }\n        return {\n            success: true,\n            message: \"Public lesson deleted successfully\"\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: \"UNKNOWN_ERROR\",\n            message: `An unexpected error occurred: ${error instanceof Error ? error.message : \"Unknown error\"}`\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU87Z0JBQ0xaLFNBQVM7Z0JBQ1RELE9BQU87Z0JBQ1BFLFNBQVM7WUFDWDtRQUNGO1FBRUEsc0JBQXNCO1FBQ3RCLE1BQU0sRUFBRUgsTUFBTXlDLEtBQUssRUFBRXhDLE9BQU95QyxVQUFVLEVBQUUsR0FBRyxNQUFNckQsU0FDOUNFLElBQUksQ0FBQyxVQUNMQyxNQUFNLENBQUMsWUFDUEssRUFBRSxDQUFDLE1BQU1pQixRQUNUSCxNQUFNO1FBRVQsSUFBSStCLGNBQWMsQ0FBQ0QsT0FBT0UsVUFBVTtZQUNsQyxPQUFPO2dCQUNMekMsU0FBUztnQkFDVEQsT0FBTztnQkFDUEUsU0FBUztZQUNYO1FBQ0Y7UUFFQSx3QkFBd0I7UUFDeEIsTUFBTSxFQUFFRixLQUFLLEVBQUUsR0FBRyxNQUFNWixTQUNyQkUsSUFBSSxDQUFDLGtCQUNMcUQsTUFBTSxHQUNOL0MsRUFBRSxDQUFDLE1BQU1hO1FBRVosSUFBSVQsT0FBTztZQUNULE9BQU87Z0JBQ0xDLFNBQVM7Z0JBQ1RELE9BQU87Z0JBQ1BFLFNBQVMsQ0FBQyxnQ0FBZ0MsRUFBRUYsTUFBTUUsT0FBTyxDQUFDLENBQUM7WUFDN0Q7UUFDRjtRQUVBLE9BQU87WUFDTEQsU0FBUztZQUNUQyxTQUFTO1FBQ1g7SUFDRixFQUFFLE9BQU9GLE9BQU87UUFDZCxPQUFPO1lBQ0xDLFNBQVM7WUFDVEQsT0FBTztZQUNQRSxTQUFTLENBQUMsOEJBQThCLEVBQUVGLGlCQUFpQk8sUUFBUVAsTUFBTUUsT0FBTyxHQUFHLGdCQUFnQixDQUFDO1FBQ3RHO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvLi9saWIvcHVibGljLWxlc3NvbnMtc2VydmVyLnRzP2M0YTQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gU2VydmVyLXNpZGUgdXRpbGl0aWVzIGZvciBwdWJsaWMgbGVzc29uIGxpYnJhcnlcclxuLy8gVGhpcyBmaWxlIGNvbnRhaW5zIENSVUQgb3BlcmF0aW9ucyBmb3IgcHVibGljIGxlc3NvbnMgd2l0aCBwcm9wZXIgdmFsaWRhdGlvbiBhbmQgYWNjZXNzIGNvbnRyb2xcclxuXHJcbmltcG9ydCB7IGNyZWF0ZVNlcnZlclN1cGFiYXNlQ2xpZW50IH0gZnJvbSAnLi9zdXBhYmFzZS1zZXJ2ZXInO1xyXG5pbXBvcnQgdHlwZSB7XHJcbiAgUHVibGljTGVzc29uLFxyXG4gIFB1YmxpY0xlc3NvbkZpbHRlcnMsXHJcbiAgUHVibGljTGVzc29uTGlzdFJlc3BvbnNlLFxyXG4gIExlc3NvbkNvbnRlbnQsXHJcbiAgUHVibGljTGVzc29uTWV0YWRhdGEsXHJcbn0gZnJvbSAnLi90eXBlcy9wdWJsaWMtbGVzc29ucyc7XHJcblxyXG4vLyBSZXN1bHQgdHlwZSBmb3Igb3BlcmF0aW9uc1xyXG5pbnRlcmZhY2UgT3BlcmF0aW9uUmVzdWx0PFQgPSB2b2lkPiB7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBkYXRhPzogVDtcclxuICBlcnJvcj86IHN0cmluZztcclxuICBtZXNzYWdlPzogc3RyaW5nO1xyXG59XHJcblxyXG4vLyBWYWxpZGF0aW9uIHJlc3VsdCB0eXBlXHJcbmludGVyZmFjZSBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICB2YWxpZDogYm9vbGVhbjtcclxuICBlcnJvcnM6IHN0cmluZ1tdO1xyXG59XHJcblxyXG4vKipcclxuICogVmFsaWRhdGVzIHB1YmxpYyBsZXNzb24gY29udGVudCBiZWZvcmUgc2F2aW5nXHJcbiAqIEVuc3VyZXMgYWxsIHJlcXVpcmVkIHNlY3Rpb25zIGFyZSBwcmVzZW50IGFuZCBwcm9wZXJseSBmb3JtYXR0ZWRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVB1YmxpY0xlc3NvbkNvbnRlbnQoY29udGVudDogTGVzc29uQ29udGVudCk6IFZhbGlkYXRpb25SZXN1bHQge1xyXG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcclxuXHJcbiAgLy8gVmFsaWRhdGUgdGl0bGVcclxuICBpZiAoIWNvbnRlbnQudGl0bGUgfHwgY29udGVudC50aXRsZS50cmltKCkubGVuZ3RoID09PSAwKSB7XHJcbiAgICBlcnJvcnMucHVzaCgnTGVzc29uIHRpdGxlIGlzIHJlcXVpcmVkJyk7XHJcbiAgfVxyXG5cclxuICAvLyBWYWxpZGF0ZSB3YXJtdXAgc2VjdGlvblxyXG4gIGlmICghY29udGVudC53YXJtdXAgfHwgIWNvbnRlbnQud2FybXVwLnF1ZXN0aW9ucyB8fCBjb250ZW50Lndhcm11cC5xdWVzdGlvbnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICBlcnJvcnMucHVzaCgnV2FybXVwIHNlY3Rpb24gd2l0aCBhdCBsZWFzdCBvbmUgcXVlc3Rpb24gaXMgcmVxdWlyZWQnKTtcclxuICB9XHJcblxyXG4gIC8vIFZhbGlkYXRlIHdyYXB1cCBzZWN0aW9uXHJcbiAgaWYgKCFjb250ZW50LndyYXB1cCB8fCAhY29udGVudC53cmFwdXAuc3VtbWFyeSB8fCBjb250ZW50LndyYXB1cC5zdW1tYXJ5LnRyaW0oKS5sZW5ndGggPT09IDApIHtcclxuICAgIGVycm9ycy5wdXNoKCdXcmFwdXAgc2VjdGlvbiB3aXRoIHN1bW1hcnkgaXMgcmVxdWlyZWQnKTtcclxuICB9XHJcblxyXG4gIC8vIFZhbGlkYXRlIGF0IGxlYXN0IG9uZSBtYWluIGNvbnRlbnQgc2VjdGlvbiBleGlzdHNcclxuICBjb25zdCBoYXNNYWluQ29udGVudCA9ICEhKFxyXG4gICAgY29udGVudC52b2NhYnVsYXJ5IHx8XHJcbiAgICBjb250ZW50LmdyYW1tYXIgfHxcclxuICAgIGNvbnRlbnQucmVhZGluZyB8fFxyXG4gICAgY29udGVudC5kaXNjdXNzaW9uIHx8XHJcbiAgICBjb250ZW50LnByb251bmNpYXRpb25cclxuICApO1xyXG5cclxuICBpZiAoIWhhc01haW5Db250ZW50KSB7XHJcbiAgICBlcnJvcnMucHVzaCgnQXQgbGVhc3Qgb25lIG1haW4gY29udGVudCBzZWN0aW9uICh2b2NhYnVsYXJ5LCBncmFtbWFyLCByZWFkaW5nLCBkaXNjdXNzaW9uLCBvciBwcm9udW5jaWF0aW9uKSBpcyByZXF1aXJlZCcpO1xyXG4gIH1cclxuXHJcbiAgLy8gVmFsaWRhdGUgbWV0YWRhdGFcclxuICBpZiAoIWNvbnRlbnQubWV0YWRhdGEpIHtcclxuICAgIGVycm9ycy5wdXNoKCdMZXNzb24gbWV0YWRhdGEgaXMgcmVxdWlyZWQnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaWYgKCFjb250ZW50Lm1ldGFkYXRhLmNlZnJfbGV2ZWwpIHtcclxuICAgICAgZXJyb3JzLnB1c2goJ0NFRlIgbGV2ZWwgaXMgcmVxdWlyZWQgaW4gbWV0YWRhdGEnKTtcclxuICAgIH1cclxuICAgIGlmICghY29udGVudC5tZXRhZGF0YS5sZXNzb25fdHlwZSkge1xyXG4gICAgICBlcnJvcnMucHVzaCgnTGVzc29uIHR5cGUgaXMgcmVxdWlyZWQgaW4gbWV0YWRhdGEnKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICB2YWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcclxuICAgIGVycm9ycyxcclxuICB9O1xyXG59XHJcblxyXG4vKipcclxuICogUmV0cmlldmVzIHB1YmxpYyBsZXNzb25zIHdpdGggZmlsdGVyaW5nIGFuZCBjdXJzb3ItYmFzZWQgcGFnaW5hdGlvblxyXG4gKiBTdXBwb3J0cyBmaWx0ZXJpbmcgYnkgY2F0ZWdvcnksIENFRlIgbGV2ZWwsIGxlc3NvbiB0eXBlLCBhbmQgc2VhcmNoXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHVibGljTGVzc29ucyhcclxuICBmaWx0ZXJzOiBQdWJsaWNMZXNzb25GaWx0ZXJzID0ge30sXHJcbiAgY3Vyc29yPzogc3RyaW5nLFxyXG4gIGxpbWl0OiBudW1iZXIgPSAyMFxyXG4pOiBQcm9taXNlPE9wZXJhdGlvblJlc3VsdDxQdWJsaWNMZXNzb25MaXN0UmVzcG9uc2U+PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQoKTtcclxuXHJcbiAgICAvLyBCdWlsZCBxdWVyeSB3aXRoIGZpbHRlcnNcclxuICAgIGxldCBxdWVyeSA9IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdwdWJsaWNfbGVzc29ucycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcclxuICAgICAgLmxpbWl0KGxpbWl0KTtcclxuXHJcbiAgICAvLyBBcHBseSBjdXJzb3ItYmFzZWQgcGFnaW5hdGlvblxyXG4gICAgaWYgKGN1cnNvcikge1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5Lmx0KCdjcmVhdGVkX2F0JywgY3Vyc29yKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBBcHBseSBjYXRlZ29yeSBmaWx0ZXJcclxuICAgIGlmIChmaWx0ZXJzLmNhdGVnb3J5KSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2NhdGVnb3J5JywgZmlsdGVycy5jYXRlZ29yeSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQXBwbHkgQ0VGUiBsZXZlbCBmaWx0ZXJcclxuICAgIGlmIChmaWx0ZXJzLmNlZnJfbGV2ZWwpIHtcclxuICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnY2Vmcl9sZXZlbCcsIGZpbHRlcnMuY2Vmcl9sZXZlbCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQXBwbHkgbGVzc29uIHR5cGUgZmlsdGVyXHJcbiAgICBpZiAoZmlsdGVycy5sZXNzb25fdHlwZSkge1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdsZXNzb25fdHlwZScsIGZpbHRlcnMubGVzc29uX3R5cGUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFwcGx5IHNlYXJjaCBmaWx0ZXIgKHNlYXJjaGVzIGluIHRpdGxlIGFuZCBzb3VyY2VfdGl0bGUpXHJcbiAgICBpZiAoZmlsdGVycy5zZWFyY2ggJiYgZmlsdGVycy5zZWFyY2gudHJpbSgpLmxlbmd0aCA+IDApIHtcclxuICAgICAgcXVlcnkgPSBxdWVyeS50ZXh0U2VhcmNoKCdzZWFyY2hfdmVjdG9yJywgZmlsdGVycy5zZWFyY2gudHJpbSgpKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBxdWVyeTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0RBVEFCQVNFX0VSUk9SJyxcclxuICAgICAgICBtZXNzYWdlOiBgRmFpbGVkIHRvIGZldGNoIHB1YmxpYyBsZXNzb25zOiAke2Vycm9yLm1lc3NhZ2V9YCxcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgbmV4dCBjdXJzb3JcclxuICAgIGNvbnN0IG5leHRDdXJzb3IgPSBkYXRhICYmIGRhdGEubGVuZ3RoID09PSBsaW1pdCA/IGRhdGFbZGF0YS5sZW5ndGggLSAxXS5jcmVhdGVkX2F0IDogdW5kZWZpbmVkO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGRhdGE6IHtcclxuICAgICAgICBsZXNzb25zOiBkYXRhIHx8IFtdLFxyXG4gICAgICAgIG5leHRDdXJzb3IsXHJcbiAgICAgIH0sXHJcbiAgICB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6ICdVTktOT1dOX0VSUk9SJyxcclxuICAgICAgbWVzc2FnZTogYEFuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQ6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmV0cmlldmVzIGEgc2luZ2xlIHB1YmxpYyBsZXNzb24gYnkgSURcclxuICogQWNjZXNzaWJsZSB0byBhbGwgdXNlcnMgKGF1dGhlbnRpY2F0ZWQgYW5kIHVuYXV0aGVudGljYXRlZClcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQdWJsaWNMZXNzb24obGVzc29uSWQ6IHN0cmluZyk6IFByb21pc2U8T3BlcmF0aW9uUmVzdWx0PFB1YmxpY0xlc3Nvbj4+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVTZXJ2ZXJTdXBhYmFzZUNsaWVudCgpO1xyXG5cclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdwdWJsaWNfbGVzc29ucycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuZXEoJ2lkJywgbGVzc29uSWQpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdQR1JTVDExNicpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBlcnJvcjogJ05PVF9GT1VORCcsXHJcbiAgICAgICAgICBtZXNzYWdlOiAnUHVibGljIGxlc3NvbiBub3QgZm91bmQnLFxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0RBVEFCQVNFX0VSUk9SJyxcclxuICAgICAgICBtZXNzYWdlOiBgRmFpbGVkIHRvIGZldGNoIHB1YmxpYyBsZXNzb246ICR7ZXJyb3IubWVzc2FnZX1gLFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGRhdGE6IGRhdGEgYXMgUHVibGljTGVzc29uLFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnVU5LTk9XTl9FUlJPUicsXHJcbiAgICAgIG1lc3NhZ2U6IGBBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWAsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZXMgYSBuZXcgcHVibGljIGxlc3NvblxyXG4gKiBSZXF1aXJlcyBhdXRoZW50aWNhdGlvbiBhbmQgdmFsaWRhdGVzIGNvbnRlbnQgYmVmb3JlIHNhdmluZ1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVB1YmxpY0xlc3NvbihcclxuICBjb250ZW50OiBMZXNzb25Db250ZW50LFxyXG4gIG1ldGFkYXRhOiBQdWJsaWNMZXNzb25NZXRhZGF0YSxcclxuICB1c2VySWQ6IHN0cmluZ1xyXG4pOiBQcm9taXNlPE9wZXJhdGlvblJlc3VsdDxzdHJpbmc+PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIFZhbGlkYXRlIGNvbnRlbnRcclxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSB2YWxpZGF0ZVB1YmxpY0xlc3NvbkNvbnRlbnQoY29udGVudCk7XHJcbiAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ1ZBTElEQVRJT05fRVJST1InLFxyXG4gICAgICAgIG1lc3NhZ2U6IGBDb250ZW50IHZhbGlkYXRpb24gZmFpbGVkOiAke3ZhbGlkYXRpb24uZXJyb3JzLmpvaW4oJywgJyl9YCxcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVc2Ugc2VydmljZSByb2xlIGNsaWVudCB0byBieXBhc3MgUkxTIGZvciBhZG1pbiBvcGVyYXRpb25zXHJcbiAgICAvLyBUaGlzIGlzIHNhZmUgYmVjYXVzZSB3ZSd2ZSBhbHJlYWR5IHZlcmlmaWVkIGFkbWluIHN0YXR1cyBpbiB0aGUgQVBJIHJvdXRlXHJcbiAgICBjb25zdCB7IGNyZWF0ZUNsaWVudCB9ID0gYXdhaXQgaW1wb3J0KCdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnKTtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KFxyXG4gICAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhLFxyXG4gICAgICBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZISxcclxuICAgICAge1xyXG4gICAgICAgIGF1dGg6IHtcclxuICAgICAgICAgIGF1dG9SZWZyZXNoVG9rZW46IGZhbHNlLFxyXG4gICAgICAgICAgcGVyc2lzdFNlc3Npb246IGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIC8vIFByZXBhcmUgbGVzc29uIGRhdGFcclxuICAgIGNvbnN0IGxlc3NvbkRhdGEgPSB7XHJcbiAgICAgIGNyZWF0b3JfaWQ6IHVzZXJJZCxcclxuICAgICAgdGl0bGU6IGNvbnRlbnQudGl0bGUsXHJcbiAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsXHJcbiAgICAgIHNvdXJjZV91cmw6IGNvbnRlbnQubWV0YWRhdGEuc291cmNlX3VybCB8fCBudWxsLFxyXG4gICAgICBzb3VyY2VfdGl0bGU6IGNvbnRlbnQubWV0YWRhdGEuc291cmNlX3RpdGxlIHx8IG51bGwsXHJcbiAgICAgIGJhbm5lcl9pbWFnZV91cmw6IGNvbnRlbnQubWV0YWRhdGEuYmFubmVyX2ltYWdlX3VybCB8fCBudWxsLFxyXG4gICAgICBjYXRlZ29yeTogbWV0YWRhdGEuY2F0ZWdvcnksXHJcbiAgICAgIGNlZnJfbGV2ZWw6IGNvbnRlbnQubWV0YWRhdGEuY2Vmcl9sZXZlbCxcclxuICAgICAgbGVzc29uX3R5cGU6IGNvbnRlbnQubWV0YWRhdGEubGVzc29uX3R5cGUsXHJcbiAgICAgIHRhZ3M6IG1ldGFkYXRhLnRhZ3MgfHwgW10sXHJcbiAgICAgIGVzdGltYXRlZF9kdXJhdGlvbl9taW51dGVzOiBtZXRhZGF0YS5lc3RpbWF0ZWRfZHVyYXRpb25fbWludXRlcyB8fCBudWxsLFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncHVibGljX2xlc3NvbnMnKVxyXG4gICAgICAuaW5zZXJ0KGxlc3NvbkRhdGEpXHJcbiAgICAgIC5zZWxlY3QoJ2lkJylcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnREFUQUJBU0VfRVJST1InLFxyXG4gICAgICAgIG1lc3NhZ2U6IGBGYWlsZWQgdG8gY3JlYXRlIHB1YmxpYyBsZXNzb246ICR7ZXJyb3IubWVzc2FnZX1gLFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGRhdGE6IGRhdGEuaWQsXHJcbiAgICAgIG1lc3NhZ2U6ICdQdWJsaWMgbGVzc29uIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5JyxcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ1VOS05PV05fRVJST1InLFxyXG4gICAgICBtZXNzYWdlOiBgQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZDogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVcGRhdGVzIGFuIGV4aXN0aW5nIHB1YmxpYyBsZXNzb25cclxuICogUmVxdWlyZXMgYXV0aGVudGljYXRpb24gKFJMUyBlbmZvcmNlcyB1cGRhdGUgcGVybWlzc2lvbnMpXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlUHVibGljTGVzc29uKFxyXG4gIGxlc3NvbklkOiBzdHJpbmcsXHJcbiAgdXBkYXRlczogUGFydGlhbDxQdWJsaWNMZXNzb24+LFxyXG4gIHVzZXJJZDogc3RyaW5nXHJcbik6IFByb21pc2U8T3BlcmF0aW9uUmVzdWx0PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQoKTtcclxuXHJcbiAgICAvLyBWZXJpZnkgdXNlciBpcyBhdXRoZW50aWNhdGVkXHJcbiAgICBjb25zdCB7IGRhdGE6IHsgdXNlciB9IH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIoKTtcclxuICAgIGlmICghdXNlciB8fCB1c2VyLmlkICE9PSB1c2VySWQpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0FVVEhFTlRJQ0FUSU9OX0VSUk9SJyxcclxuICAgICAgICBtZXNzYWdlOiAnVXNlciBtdXN0IGJlIGF1dGhlbnRpY2F0ZWQgdG8gdXBkYXRlIHB1YmxpYyBsZXNzb25zJyxcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJZiBjb250ZW50IGlzIGJlaW5nIHVwZGF0ZWQsIHZhbGlkYXRlIGl0XHJcbiAgICBpZiAodXBkYXRlcy5jb250ZW50KSB7XHJcbiAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB2YWxpZGF0ZVB1YmxpY0xlc3NvbkNvbnRlbnQodXBkYXRlcy5jb250ZW50KTtcclxuICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6ICdWQUxJREFUSU9OX0VSUk9SJyxcclxuICAgICAgICAgIG1lc3NhZ2U6IGBDb250ZW50IHZhbGlkYXRpb24gZmFpbGVkOiAke3ZhbGlkYXRpb24uZXJyb3JzLmpvaW4oJywgJyl9YCxcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmVtb3ZlIGZpZWxkcyB0aGF0IHNob3VsZG4ndCBiZSB1cGRhdGVkIGRpcmVjdGx5XHJcbiAgICBjb25zdCB7IGlkLCBjcmVhdGVkX2F0LCBjcmVhdG9yX2lkLCAuLi5hbGxvd2VkVXBkYXRlcyB9ID0gdXBkYXRlcztcclxuXHJcbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncHVibGljX2xlc3NvbnMnKVxyXG4gICAgICAudXBkYXRlKGFsbG93ZWRVcGRhdGVzKVxyXG4gICAgICAuZXEoJ2lkJywgbGVzc29uSWQpO1xyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnREFUQUJBU0VfRVJST1InLFxyXG4gICAgICAgIG1lc3NhZ2U6IGBGYWlsZWQgdG8gdXBkYXRlIHB1YmxpYyBsZXNzb246ICR7ZXJyb3IubWVzc2FnZX1gLFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIG1lc3NhZ2U6ICdQdWJsaWMgbGVzc29uIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5JyxcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ1VOS05PV05fRVJST1InLFxyXG4gICAgICBtZXNzYWdlOiBgQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZDogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZWxldGVzIGEgcHVibGljIGxlc3NvblxyXG4gKiBSZXF1aXJlcyBhZG1pbiBwcml2aWxlZ2VzIChlbmZvcmNlZCBieSBSTFMpXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlUHVibGljTGVzc29uKFxyXG4gIGxlc3NvbklkOiBzdHJpbmcsXHJcbiAgdXNlcklkOiBzdHJpbmdcclxuKTogUHJvbWlzZTxPcGVyYXRpb25SZXN1bHQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVTZXJ2ZXJTdXBhYmFzZUNsaWVudCgpO1xyXG5cclxuICAgIC8vIFZlcmlmeSB1c2VyIGlzIGF1dGhlbnRpY2F0ZWRcclxuICAgIGNvbnN0IHsgZGF0YTogeyB1c2VyIH0gfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpO1xyXG4gICAgaWYgKCF1c2VyIHx8IHVzZXIuaWQgIT09IHVzZXJJZCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQVVUSEVOVElDQVRJT05fRVJST1InLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdVc2VyIG11c3QgYmUgYXV0aGVudGljYXRlZCB0byBkZWxldGUgcHVibGljIGxlc3NvbnMnLFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFZlcmlmeSBhZG1pbiBzdGF0dXNcclxuICAgIGNvbnN0IHsgZGF0YTogdHV0b3IsIGVycm9yOiB0dXRvckVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgndHV0b3JzJylcclxuICAgICAgLnNlbGVjdCgnaXNfYWRtaW4nKVxyXG4gICAgICAuZXEoJ2lkJywgdXNlcklkKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKHR1dG9yRXJyb3IgfHwgIXR1dG9yPy5pc19hZG1pbikge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnUEVSTUlTU0lPTl9ERU5JRUQnLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdPbmx5IGFkbWluaXN0cmF0b3JzIGNhbiBkZWxldGUgcHVibGljIGxlc3NvbnMnLFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFByb2NlZWQgd2l0aCBkZWxldGlvblxyXG4gICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3B1YmxpY19sZXNzb25zJylcclxuICAgICAgLmRlbGV0ZSgpXHJcbiAgICAgIC5lcSgnaWQnLCBsZXNzb25JZCk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdEQVRBQkFTRV9FUlJPUicsXHJcbiAgICAgICAgbWVzc2FnZTogYEZhaWxlZCB0byBkZWxldGUgcHVibGljIGxlc3NvbjogJHtlcnJvci5tZXNzYWdlfWAsXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgbWVzc2FnZTogJ1B1YmxpYyBsZXNzb24gZGVsZXRlZCBzdWNjZXNzZnVsbHknLFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnVU5LTk9XTl9FUlJPUicsXHJcbiAgICAgIG1lc3NhZ2U6IGBBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWAsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQiLCJ2YWxpZGF0ZVB1YmxpY0xlc3NvbkNvbnRlbnQiLCJjb250ZW50IiwiZXJyb3JzIiwidGl0bGUiLCJ0cmltIiwibGVuZ3RoIiwicHVzaCIsIndhcm11cCIsInF1ZXN0aW9ucyIsIndyYXB1cCIsInN1bW1hcnkiLCJoYXNNYWluQ29udGVudCIsInZvY2FidWxhcnkiLCJncmFtbWFyIiwicmVhZGluZyIsImRpc2N1c3Npb24iLCJwcm9udW5jaWF0aW9uIiwibWV0YWRhdGEiLCJjZWZyX2xldmVsIiwibGVzc29uX3R5cGUiLCJ2YWxpZCIsImdldFB1YmxpY0xlc3NvbnMiLCJmaWx0ZXJzIiwiY3Vyc29yIiwibGltaXQiLCJzdXBhYmFzZSIsInF1ZXJ5IiwiZnJvbSIsInNlbGVjdCIsIm9yZGVyIiwiYXNjZW5kaW5nIiwibHQiLCJjYXRlZ29yeSIsImVxIiwic2VhcmNoIiwidGV4dFNlYXJjaCIsImRhdGEiLCJlcnJvciIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwibmV4dEN1cnNvciIsImNyZWF0ZWRfYXQiLCJ1bmRlZmluZWQiLCJsZXNzb25zIiwiRXJyb3IiLCJnZXRQdWJsaWNMZXNzb24iLCJsZXNzb25JZCIsInNpbmdsZSIsImNvZGUiLCJjcmVhdGVQdWJsaWNMZXNzb24iLCJ1c2VySWQiLCJ2YWxpZGF0aW9uIiwiam9pbiIsImNyZWF0ZUNsaWVudCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiYXV0aCIsImF1dG9SZWZyZXNoVG9rZW4iLCJwZXJzaXN0U2Vzc2lvbiIsImxlc3NvbkRhdGEiLCJjcmVhdG9yX2lkIiwic291cmNlX3VybCIsInNvdXJjZV90aXRsZSIsImJhbm5lcl9pbWFnZV91cmwiLCJ0YWdzIiwiZXN0aW1hdGVkX2R1cmF0aW9uX21pbnV0ZXMiLCJpbnNlcnQiLCJpZCIsInVwZGF0ZVB1YmxpY0xlc3NvbiIsInVwZGF0ZXMiLCJ1c2VyIiwiZ2V0VXNlciIsImFsbG93ZWRVcGRhdGVzIiwidXBkYXRlIiwiZGVsZXRlUHVibGljTGVzc29uIiwidHV0b3IiLCJ0dXRvckVycm9yIiwiaXNfYWRtaW4iLCJkZWxldGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/public-lessons-server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase-server.ts":
/*!********************************!*\
  !*** ./lib/supabase-server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createServerSupabaseClient: () => (/* binding */ createServerSupabaseClient)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n\n\nconst supabaseUrl = \"https://jbkpnirowdvlwlgheqho.supabase.co\" || 0;\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impia3BuaXJvd2R2bHdsZ2hlcWhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5MTQ3NTEsImV4cCI6MjA3NDQ5MDc1MX0.FZhruXKDzIkZLhla5oerfs7yzjvTsGLlKTUer34N6N0\" || 0;\n// Server client (for API routes and server components)\nconst createServerSupabaseClient = async ()=>{\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_1__.createServerClient)(supabaseUrl, supabaseAnonKey, {\n        cookies: {\n            getAll () {\n                return cookieStore.getAll();\n            },\n            setAll (cookiesToSet) {\n                try {\n                    cookiesToSet.forEach(({ name, value, options })=>cookieStore.set(name, value, options));\n                } catch  {\n                // The `setAll` method was called from a Server Component.\n                // This can be ignored if you have middleware refreshing\n                // user sessions.\n                }\n            }\n        }\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Utc2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFzQztBQUNZO0FBR2xELE1BQU1FLGNBQWNDLDBDQUFvQyxJQUFJO0FBQzVELE1BQU1HLGtCQUFrQkgsa05BQXlDLElBQUk7QUFFckUsdURBQXVEO0FBQ2hELE1BQU1LLDZCQUE2QjtJQUN4QyxNQUFNQyxjQUFjLE1BQU1ULHFEQUFPQTtJQUVqQyxPQUFPQyxpRUFBa0JBLENBQUNDLGFBQWFJLGlCQUFpQjtRQUN0RE4sU0FBUztZQUNQVTtnQkFDRSxPQUFPRCxZQUFZQyxNQUFNO1lBQzNCO1lBQ0FDLFFBQU9DLFlBQVk7Z0JBQ2pCLElBQUk7b0JBQ0ZBLGFBQWFDLE9BQU8sQ0FBQyxDQUFDLEVBQUVDLElBQUksRUFBRUMsS0FBSyxFQUFFQyxPQUFPLEVBQUUsR0FDNUNQLFlBQVlRLEdBQUcsQ0FBQ0gsTUFBTUMsT0FBT0M7Z0JBRWpDLEVBQUUsT0FBTTtnQkFDTiwwREFBMEQ7Z0JBQzFELHdEQUF3RDtnQkFDeEQsaUJBQWlCO2dCQUNuQjtZQUNGO1FBQ0Y7SUFDRjtBQUNGLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL3N1cGFiYXNlLXNlcnZlci50cz8wOTRmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNvb2tpZXMgfSBmcm9tIFwibmV4dC9oZWFkZXJzXCJcbmltcG9ydCB7IGNyZWF0ZVNlcnZlckNsaWVudCB9IGZyb20gXCJAc3VwYWJhc2Uvc3NyXCJcblxuXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCB8fCAnaHR0cHM6Ly9wbGFjZWhvbGRlci5zdXBhYmFzZS5jbydcbmNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIHx8ICdwbGFjZWhvbGRlci1rZXknXG5cbi8vIFNlcnZlciBjbGllbnQgKGZvciBBUEkgcm91dGVzIGFuZCBzZXJ2ZXIgY29tcG9uZW50cylcbmV4cG9ydCBjb25zdCBjcmVhdGVTZXJ2ZXJTdXBhYmFzZUNsaWVudCA9IGFzeW5jICgpID0+IHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKClcblxuICByZXR1cm4gY3JlYXRlU2VydmVyQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUFub25LZXksIHtcbiAgICBjb29raWVzOiB7XG4gICAgICBnZXRBbGwoKSB7XG4gICAgICAgIHJldHVybiBjb29raWVTdG9yZS5nZXRBbGwoKVxuICAgICAgfSxcbiAgICAgIHNldEFsbChjb29raWVzVG9TZXQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb29raWVzVG9TZXQuZm9yRWFjaCgoeyBuYW1lLCB2YWx1ZSwgb3B0aW9ucyB9KSA9PlxuICAgICAgICAgICAgY29va2llU3RvcmUuc2V0KG5hbWUsIHZhbHVlLCBvcHRpb25zKVxuICAgICAgICAgIClcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgLy8gVGhlIGBzZXRBbGxgIG1ldGhvZCB3YXMgY2FsbGVkIGZyb20gYSBTZXJ2ZXIgQ29tcG9uZW50LlxuICAgICAgICAgIC8vIFRoaXMgY2FuIGJlIGlnbm9yZWQgaWYgeW91IGhhdmUgbWlkZGxld2FyZSByZWZyZXNoaW5nXG4gICAgICAgICAgLy8gdXNlciBzZXNzaW9ucy5cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9LFxuICB9KVxufVxuIl0sIm5hbWVzIjpbImNvb2tpZXMiLCJjcmVhdGVTZXJ2ZXJDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImNyZWF0ZVNlcnZlclN1cGFiYXNlQ2xpZW50IiwiY29va2llU3RvcmUiLCJnZXRBbGwiLCJzZXRBbGwiLCJjb29raWVzVG9TZXQiLCJmb3JFYWNoIiwibmFtZSIsInZhbHVlIiwib3B0aW9ucyIsInNldCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase-server.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions","vendor-chunks/cookie"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpublic-lessons%2Fcreate%2Froute&page=%2Fapi%2Fpublic-lessons%2Fcreate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpublic-lessons%2Fcreate%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();
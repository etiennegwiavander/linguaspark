"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/public-lessons/list/route";
exports.ids = ["app/api/public-lessons/list/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpublic-lessons%2Flist%2Froute&page=%2Fapi%2Fpublic-lessons%2Flist%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpublic-lessons%2Flist%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpublic-lessons%2Flist%2Froute&page=%2Fapi%2Fpublic-lessons%2Flist%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpublic-lessons%2Flist%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_linguaspark_app_api_public_lessons_list_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/public-lessons/list/route.ts */ \"(rsc)/./app/api/public-lessons/list/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/public-lessons/list/route\",\n        pathname: \"/api/public-lessons/list\",\n        filename: \"route\",\n        bundlePath: \"app/api/public-lessons/list/route\"\n    },\n    resolvedPagePath: \"D:\\\\linguaspark\\\\app\\\\api\\\\public-lessons\\\\list\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_linguaspark_app_api_public_lessons_list_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/public-lessons/list/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwdWJsaWMtbGVzc29ucyUyRmxpc3QlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnB1YmxpYy1sZXNzb25zJTJGbGlzdCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnB1YmxpYy1sZXNzb25zJTJGbGlzdCUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDbGluZ3Vhc3BhcmslNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUQlM0ElNUNsaW5ndWFzcGFyayZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDUztBQUN0RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvPzc2ODUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxcbGluZ3Vhc3BhcmtcXFxcYXBwXFxcXGFwaVxcXFxwdWJsaWMtbGVzc29uc1xcXFxsaXN0XFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9wdWJsaWMtbGVzc29ucy9saXN0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvcHVibGljLWxlc3NvbnMvbGlzdFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvcHVibGljLWxlc3NvbnMvbGlzdC9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkQ6XFxcXGxpbmd1YXNwYXJrXFxcXGFwcFxcXFxhcGlcXFxccHVibGljLWxlc3NvbnNcXFxcbGlzdFxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvcHVibGljLWxlc3NvbnMvbGlzdC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpublic-lessons%2Flist%2Froute&page=%2Fapi%2Fpublic-lessons%2Flist%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpublic-lessons%2Flist%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/public-lessons/list/route.ts":
/*!**********************************************!*\
  !*** ./app/api/public-lessons/list/route.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var _lib_public_lessons_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/public-lessons-server */ \"(rsc)/./lib/public-lessons-server.ts\");\n\nasync function GET(request) {\n    try {\n        const searchParams = request.nextUrl.searchParams;\n        // Extract filter parameters\n        const filters = {};\n        const category = searchParams.get(\"category\");\n        if (category) {\n            filters.category = category;\n        }\n        const cefrLevel = searchParams.get(\"cefr_level\");\n        if (cefrLevel) {\n            filters.cefr_level = cefrLevel;\n        }\n        const lessonType = searchParams.get(\"lesson_type\");\n        if (lessonType) {\n            filters.lesson_type = lessonType;\n        }\n        const search = searchParams.get(\"search\");\n        if (search) {\n            filters.search = search;\n        }\n        // Extract pagination parameters\n        const cursor = searchParams.get(\"cursor\") || undefined;\n        const limit = parseInt(searchParams.get(\"limit\") || \"20\", 10);\n        // Validate limit\n        const validLimit = Math.min(Math.max(limit, 1), 100); // Between 1 and 100\n        // Fetch public lessons\n        const result = await (0,_lib_public_lessons_server__WEBPACK_IMPORTED_MODULE_0__.getPublicLessons)(filters, cursor, validLimit);\n        if (!result.success || !result.data) {\n            return Response.json({\n                success: false,\n                error: result.error,\n                message: result.message\n            }, {\n                status: 500\n            });\n        }\n        return Response.json({\n            success: true,\n            lessons: result.data.lessons,\n            nextCursor: result.data.nextCursor\n        });\n    } catch (error) {\n        console.error(\"Error in public lessons list API:\", error);\n        return Response.json({\n            success: false,\n            error: \"UNKNOWN_ERROR\",\n            message: \"An unexpected error occurred while fetching public lessons\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3B1YmxpYy1sZXNzb25zL2xpc3Qvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDK0Q7QUFHeEQsZUFBZUMsSUFBSUMsT0FBb0I7SUFDNUMsSUFBSTtRQUNGLE1BQU1DLGVBQWVELFFBQVFFLE9BQU8sQ0FBQ0QsWUFBWTtRQUVqRCw0QkFBNEI7UUFDNUIsTUFBTUUsVUFBK0IsQ0FBQztRQUV0QyxNQUFNQyxXQUFXSCxhQUFhSSxHQUFHLENBQUM7UUFDbEMsSUFBSUQsVUFBVTtZQUNaRCxRQUFRQyxRQUFRLEdBQUdBO1FBQ3JCO1FBRUEsTUFBTUUsWUFBWUwsYUFBYUksR0FBRyxDQUFDO1FBQ25DLElBQUlDLFdBQVc7WUFDYkgsUUFBUUksVUFBVSxHQUFHRDtRQUN2QjtRQUVBLE1BQU1FLGFBQWFQLGFBQWFJLEdBQUcsQ0FBQztRQUNwQyxJQUFJRyxZQUFZO1lBQ2RMLFFBQVFNLFdBQVcsR0FBR0Q7UUFDeEI7UUFFQSxNQUFNRSxTQUFTVCxhQUFhSSxHQUFHLENBQUM7UUFDaEMsSUFBSUssUUFBUTtZQUNWUCxRQUFRTyxNQUFNLEdBQUdBO1FBQ25CO1FBRUEsZ0NBQWdDO1FBQ2hDLE1BQU1DLFNBQVNWLGFBQWFJLEdBQUcsQ0FBQyxhQUFhTztRQUM3QyxNQUFNQyxRQUFRQyxTQUFTYixhQUFhSSxHQUFHLENBQUMsWUFBWSxNQUFNO1FBRTFELGlCQUFpQjtRQUNqQixNQUFNVSxhQUFhQyxLQUFLQyxHQUFHLENBQUNELEtBQUtFLEdBQUcsQ0FBQ0wsT0FBTyxJQUFJLE1BQU0sb0JBQW9CO1FBRTFFLHVCQUF1QjtRQUN2QixNQUFNTSxTQUFTLE1BQU1yQiw0RUFBZ0JBLENBQUNLLFNBQVNRLFFBQVFJO1FBRXZELElBQUksQ0FBQ0ksT0FBT0MsT0FBTyxJQUFJLENBQUNELE9BQU9FLElBQUksRUFBRTtZQUNuQyxPQUFPQyxTQUFTQyxJQUFJLENBQ2xCO2dCQUNFSCxTQUFTO2dCQUNUSSxPQUFPTCxPQUFPSyxLQUFLO2dCQUNuQkMsU0FBU04sT0FBT00sT0FBTztZQUN6QixHQUNBO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxPQUFPSixTQUFTQyxJQUFJLENBQUM7WUFDbkJILFNBQVM7WUFDVE8sU0FBU1IsT0FBT0UsSUFBSSxDQUFDTSxPQUFPO1lBQzVCQyxZQUFZVCxPQUFPRSxJQUFJLENBQUNPLFVBQVU7UUFDcEM7SUFDRixFQUFFLE9BQU9KLE9BQU87UUFDZEssUUFBUUwsS0FBSyxDQUFDLHFDQUFxQ0E7UUFDbkQsT0FBT0YsU0FBU0MsSUFBSSxDQUNsQjtZQUNFSCxTQUFTO1lBQ1RJLE9BQU87WUFDUEMsU0FBUztRQUNYLEdBQ0E7WUFBRUMsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vYXBwL2FwaS9wdWJsaWMtbGVzc29ucy9saXN0L3JvdXRlLnRzPzY2MDQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QgfSBmcm9tICduZXh0L3NlcnZlcic7XHJcbmltcG9ydCB7IGdldFB1YmxpY0xlc3NvbnMgfSBmcm9tICdAL2xpYi9wdWJsaWMtbGVzc29ucy1zZXJ2ZXInO1xyXG5pbXBvcnQgdHlwZSB7IFB1YmxpY0xlc3NvbkZpbHRlcnMgfSBmcm9tICdAL2xpYi90eXBlcy9wdWJsaWMtbGVzc29ucyc7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHNlYXJjaFBhcmFtcyA9IHJlcXVlc3QubmV4dFVybC5zZWFyY2hQYXJhbXM7XHJcbiAgICBcclxuICAgIC8vIEV4dHJhY3QgZmlsdGVyIHBhcmFtZXRlcnNcclxuICAgIGNvbnN0IGZpbHRlcnM6IFB1YmxpY0xlc3NvbkZpbHRlcnMgPSB7fTtcclxuICAgIFxyXG4gICAgY29uc3QgY2F0ZWdvcnkgPSBzZWFyY2hQYXJhbXMuZ2V0KCdjYXRlZ29yeScpO1xyXG4gICAgaWYgKGNhdGVnb3J5KSB7XHJcbiAgICAgIGZpbHRlcnMuY2F0ZWdvcnkgPSBjYXRlZ29yeSBhcyBhbnk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IGNlZnJMZXZlbCA9IHNlYXJjaFBhcmFtcy5nZXQoJ2NlZnJfbGV2ZWwnKTtcclxuICAgIGlmIChjZWZyTGV2ZWwpIHtcclxuICAgICAgZmlsdGVycy5jZWZyX2xldmVsID0gY2VmckxldmVsIGFzIGFueTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgbGVzc29uVHlwZSA9IHNlYXJjaFBhcmFtcy5nZXQoJ2xlc3Nvbl90eXBlJyk7XHJcbiAgICBpZiAobGVzc29uVHlwZSkge1xyXG4gICAgICBmaWx0ZXJzLmxlc3Nvbl90eXBlID0gbGVzc29uVHlwZSBhcyBhbnk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHNlYXJjaCA9IHNlYXJjaFBhcmFtcy5nZXQoJ3NlYXJjaCcpO1xyXG4gICAgaWYgKHNlYXJjaCkge1xyXG4gICAgICBmaWx0ZXJzLnNlYXJjaCA9IHNlYXJjaDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gRXh0cmFjdCBwYWdpbmF0aW9uIHBhcmFtZXRlcnNcclxuICAgIGNvbnN0IGN1cnNvciA9IHNlYXJjaFBhcmFtcy5nZXQoJ2N1cnNvcicpIHx8IHVuZGVmaW5lZDtcclxuICAgIGNvbnN0IGxpbWl0ID0gcGFyc2VJbnQoc2VhcmNoUGFyYW1zLmdldCgnbGltaXQnKSB8fCAnMjAnLCAxMCk7XHJcbiAgICBcclxuICAgIC8vIFZhbGlkYXRlIGxpbWl0XHJcbiAgICBjb25zdCB2YWxpZExpbWl0ID0gTWF0aC5taW4oTWF0aC5tYXgobGltaXQsIDEpLCAxMDApOyAvLyBCZXR3ZWVuIDEgYW5kIDEwMFxyXG4gICAgXHJcbiAgICAvLyBGZXRjaCBwdWJsaWMgbGVzc29uc1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UHVibGljTGVzc29ucyhmaWx0ZXJzLCBjdXJzb3IsIHZhbGlkTGltaXQpO1xyXG4gICAgXHJcbiAgICBpZiAoIXJlc3VsdC5zdWNjZXNzIHx8ICFyZXN1bHQuZGF0YSkge1xyXG4gICAgICByZXR1cm4gUmVzcG9uc2UuanNvbihcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgIGVycm9yOiByZXN1bHQuZXJyb3IsXHJcbiAgICAgICAgICBtZXNzYWdlOiByZXN1bHQubWVzc2FnZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBSZXNwb25zZS5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgbGVzc29uczogcmVzdWx0LmRhdGEubGVzc29ucyxcclxuICAgICAgbmV4dEN1cnNvcjogcmVzdWx0LmRhdGEubmV4dEN1cnNvclxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHB1YmxpYyBsZXNzb25zIGxpc3QgQVBJOicsIGVycm9yKTtcclxuICAgIHJldHVybiBSZXNwb25zZS5qc29uKFxyXG4gICAgICB7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdVTktOT1dOX0VSUk9SJyxcclxuICAgICAgICBtZXNzYWdlOiAnQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBwdWJsaWMgbGVzc29ucydcclxuICAgICAgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiZ2V0UHVibGljTGVzc29ucyIsIkdFVCIsInJlcXVlc3QiLCJzZWFyY2hQYXJhbXMiLCJuZXh0VXJsIiwiZmlsdGVycyIsImNhdGVnb3J5IiwiZ2V0IiwiY2VmckxldmVsIiwiY2Vmcl9sZXZlbCIsImxlc3NvblR5cGUiLCJsZXNzb25fdHlwZSIsInNlYXJjaCIsImN1cnNvciIsInVuZGVmaW5lZCIsImxpbWl0IiwicGFyc2VJbnQiLCJ2YWxpZExpbWl0IiwiTWF0aCIsIm1pbiIsIm1heCIsInJlc3VsdCIsInN1Y2Nlc3MiLCJkYXRhIiwiUmVzcG9uc2UiLCJqc29uIiwiZXJyb3IiLCJtZXNzYWdlIiwic3RhdHVzIiwibGVzc29ucyIsIm5leHRDdXJzb3IiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/public-lessons/list/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/public-lessons-server.ts":
/*!**************************************!*\
  !*** ./lib/public-lessons-server.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createPublicLesson: () => (/* binding */ createPublicLesson),\n/* harmony export */   deletePublicLesson: () => (/* binding */ deletePublicLesson),\n/* harmony export */   getPublicLesson: () => (/* binding */ getPublicLesson),\n/* harmony export */   getPublicLessons: () => (/* binding */ getPublicLessons),\n/* harmony export */   updatePublicLesson: () => (/* binding */ updatePublicLesson),\n/* harmony export */   validatePublicLessonContent: () => (/* binding */ validatePublicLessonContent)\n/* harmony export */ });\n/* harmony import */ var _supabase_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase-server */ \"(rsc)/./lib/supabase-server.ts\");\n// Server-side utilities for public lesson library\n// This file contains CRUD operations for public lessons with proper validation and access control\n\n/**\r\n * Validates public lesson content before saving\r\n * Ensures all required sections are present and properly formatted\r\n */ function validatePublicLessonContent(content) {\n    const errors = [];\n    // Validate title\n    if (!content.title || content.title.trim().length === 0) {\n        errors.push(\"Lesson title is required\");\n    }\n    // Validate warmup section\n    if (!content.warmup || !content.warmup.questions || content.warmup.questions.length === 0) {\n        errors.push(\"Warmup section with at least one question is required\");\n    }\n    // Validate wrapup section\n    if (!content.wrapup || !content.wrapup.summary || content.wrapup.summary.trim().length === 0) {\n        errors.push(\"Wrapup section with summary is required\");\n    }\n    // Validate at least one main content section exists\n    const hasMainContent = !!(content.vocabulary || content.grammar || content.reading || content.discussion || content.pronunciation);\n    if (!hasMainContent) {\n        errors.push(\"At least one main content section (vocabulary, grammar, reading, discussion, or pronunciation) is required\");\n    }\n    // Validate metadata\n    if (!content.metadata) {\n        errors.push(\"Lesson metadata is required\");\n    } else {\n        if (!content.metadata.cefr_level) {\n            errors.push(\"CEFR level is required in metadata\");\n        }\n        if (!content.metadata.lesson_type) {\n            errors.push(\"Lesson type is required in metadata\");\n        }\n    }\n    return {\n        valid: errors.length === 0,\n        errors\n    };\n}\n/**\r\n * Retrieves public lessons with filtering and cursor-based pagination\r\n * Supports filtering by category, CEFR level, lesson type, and search\r\n */ async function getPublicLessons(filters = {}, cursor, limit = 20) {\n    try {\n        const supabase = await (0,_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createServerSupabaseClient)();\n        // Build query with filters\n        let query = supabase.from(\"public_lessons\").select(\"*\").order(\"created_at\", {\n            ascending: false\n        }).limit(limit);\n        // Apply cursor-based pagination\n        if (cursor) {\n            query = query.lt(\"created_at\", cursor);\n        }\n        // Apply category filter\n        if (filters.category) {\n            query = query.eq(\"category\", filters.category);\n        }\n        // Apply CEFR level filter\n        if (filters.cefr_level) {\n            query = query.eq(\"cefr_level\", filters.cefr_level);\n        }\n        // Apply lesson type filter\n        if (filters.lesson_type) {\n            query = query.eq(\"lesson_type\", filters.lesson_type);\n        }\n        // Apply search filter (searches in title and source_title)\n        if (filters.search && filters.search.trim().length > 0) {\n            query = query.textSearch(\"search_vector\", filters.search.trim());\n        }\n        const { data, error } = await query;\n        if (error) {\n            return {\n                success: false,\n                error: \"DATABASE_ERROR\",\n                message: `Failed to fetch public lessons: ${error.message}`\n            };\n        }\n        // Calculate next cursor\n        const nextCursor = data && data.length === limit ? data[data.length - 1].created_at : undefined;\n        return {\n            success: true,\n            data: {\n                lessons: data || [],\n                nextCursor\n            }\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: \"UNKNOWN_ERROR\",\n            message: `An unexpected error occurred: ${error instanceof Error ? error.message : \"Unknown error\"}`\n        };\n    }\n}\n/**\r\n * Retrieves a single public lesson by ID\r\n * Accessible to all users (authenticated and unauthenticated)\r\n */ async function getPublicLesson(lessonId) {\n    try {\n        const supabase = await (0,_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createServerSupabaseClient)();\n        const { data, error } = await supabase.from(\"public_lessons\").select(\"*\").eq(\"id\", lessonId).single();\n        if (error) {\n            if (error.code === \"PGRST116\") {\n                return {\n                    success: false,\n                    error: \"NOT_FOUND\",\n                    message: \"Public lesson not found\"\n                };\n            }\n            return {\n                success: false,\n                error: \"DATABASE_ERROR\",\n                message: `Failed to fetch public lesson: ${error.message}`\n            };\n        }\n        return {\n            success: true,\n            data: data\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: \"UNKNOWN_ERROR\",\n            message: `An unexpected error occurred: ${error instanceof Error ? error.message : \"Unknown error\"}`\n        };\n    }\n}\n/**\r\n * Creates a new public lesson\r\n * Requires authentication and validates content before saving\r\n */ async function createPublicLesson(content, metadata, userId) {\n    try {\n        // Validate content\n        const validation = validatePublicLessonContent(content);\n        if (!validation.valid) {\n            return {\n                success: false,\n                error: \"VALIDATION_ERROR\",\n                message: `Content validation failed: ${validation.errors.join(\", \")}`\n            };\n        }\n        // Use service role client to bypass RLS for admin operations\n        // This is safe because we've already verified admin status in the API route\n        const { createClient } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\"));\n        const supabase = createClient(\"https://jbkpnirowdvlwlgheqho.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY, {\n            auth: {\n                autoRefreshToken: false,\n                persistSession: false\n            }\n        });\n        // Prepare lesson data\n        const lessonData = {\n            creator_id: userId,\n            title: content.title,\n            content: content,\n            source_url: content.metadata.source_url || null,\n            source_title: content.metadata.source_title || null,\n            banner_image_url: content.metadata.banner_image_url || null,\n            category: metadata.category,\n            cefr_level: content.metadata.cefr_level,\n            lesson_type: content.metadata.lesson_type,\n            tags: metadata.tags || [],\n            estimated_duration_minutes: metadata.estimated_duration_minutes || null\n        };\n        const { data, error } = await supabase.from(\"public_lessons\").insert(lessonData).select(\"id\").single();\n        if (error) {\n            return {\n                success: false,\n                error: \"DATABASE_ERROR\",\n                message: `Failed to create public lesson: ${error.message}`\n            };\n        }\n        return {\n            success: true,\n            data: data.id,\n            message: \"Public lesson created successfully\"\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: \"UNKNOWN_ERROR\",\n            message: `An unexpected error occurred: ${error instanceof Error ? error.message : \"Unknown error\"}`\n        };\n    }\n}\n/**\r\n * Updates an existing public lesson\r\n * Requires authentication (RLS enforces update permissions)\r\n */ async function updatePublicLesson(lessonId, updates, userId) {\n    try {\n        const supabase = await (0,_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createServerSupabaseClient)();\n        // Verify user is authenticated\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user || user.id !== userId) {\n            return {\n                success: false,\n                error: \"AUTHENTICATION_ERROR\",\n                message: \"User must be authenticated to update public lessons\"\n            };\n        }\n        // If content is being updated, validate it\n        if (updates.content) {\n            const validation = validatePublicLessonContent(updates.content);\n            if (!validation.valid) {\n                return {\n                    success: false,\n                    error: \"VALIDATION_ERROR\",\n                    message: `Content validation failed: ${validation.errors.join(\", \")}`\n                };\n            }\n        }\n        // Remove fields that shouldn't be updated directly\n        const { id, created_at, creator_id, ...allowedUpdates } = updates;\n        const { error } = await supabase.from(\"public_lessons\").update(allowedUpdates).eq(\"id\", lessonId);\n        if (error) {\n            return {\n                success: false,\n                error: \"DATABASE_ERROR\",\n                message: `Failed to update public lesson: ${error.message}`\n            };\n        }\n        return {\n            success: true,\n            message: \"Public lesson updated successfully\"\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: \"UNKNOWN_ERROR\",\n            message: `An unexpected error occurred: ${error instanceof Error ? error.message : \"Unknown error\"}`\n        };\n    }\n}\n/**\r\n * Deletes a public lesson\r\n * Requires admin privileges (enforced by RLS)\r\n */ async function deletePublicLesson(lessonId, userId) {\n    try {\n        const supabase = await (0,_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createServerSupabaseClient)();\n        // Verify user is authenticated\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user || user.id !== userId) {\n            return {\n                success: false,\n                error: \"AUTHENTICATION_ERROR\",\n                message: \"User must be authenticated to delete public lessons\"\n            };\n        }\n        // Verify admin status\n        const { data: tutor, error: tutorError } = await supabase.from(\"tutors\").select(\"is_admin\").eq(\"id\", userId).single();\n        if (tutorError || !tutor?.is_admin) {\n            return {\n                success: false,\n                error: \"PERMISSION_DENIED\",\n                message: \"Only administrators can delete public lessons\"\n            };\n        }\n        // Proceed with deletion\n        const { error } = await supabase.from(\"public_lessons\").delete().eq(\"id\", lessonId);\n        if (error) {\n            return {\n                success: false,\n                error: \"DATABASE_ERROR\",\n                message: `Failed to delete public lesson: ${error.message}`\n            };\n        }\n        return {\n            success: true,\n            message: \"Public lesson deleted successfully\"\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: \"UNKNOWN_ERROR\",\n            message: `An unexpected error occurred: ${error instanceof Error ? error.message : \"Unknown error\"}`\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU87Z0JBQ0xaLFNBQVM7Z0JBQ1RELE9BQU87Z0JBQ1BFLFNBQVM7WUFDWDtRQUNGO1FBRUEsc0JBQXNCO1FBQ3RCLE1BQU0sRUFBRUgsTUFBTXlDLEtBQUssRUFBRXhDLE9BQU95QyxVQUFVLEVBQUUsR0FBRyxNQUFNckQsU0FDOUNFLElBQUksQ0FBQyxVQUNMQyxNQUFNLENBQUMsWUFDUEssRUFBRSxDQUFDLE1BQU1pQixRQUNUSCxNQUFNO1FBRVQsSUFBSStCLGNBQWMsQ0FBQ0QsT0FBT0UsVUFBVTtZQUNsQyxPQUFPO2dCQUNMekMsU0FBUztnQkFDVEQsT0FBTztnQkFDUEUsU0FBUztZQUNYO1FBQ0Y7UUFFQSx3QkFBd0I7UUFDeEIsTUFBTSxFQUFFRixLQUFLLEVBQUUsR0FBRyxNQUFNWixTQUNyQkUsSUFBSSxDQUFDLGtCQUNMcUQsTUFBTSxHQUNOL0MsRUFBRSxDQUFDLE1BQU1hO1FBRVosSUFBSVQsT0FBTztZQUNULE9BQU87Z0JBQ0xDLFNBQVM7Z0JBQ1RELE9BQU87Z0JBQ1BFLFNBQVMsQ0FBQyxnQ0FBZ0MsRUFBRUYsTUFBTUUsT0FBTyxDQUFDLENBQUM7WUFDN0Q7UUFDRjtRQUVBLE9BQU87WUFDTEQsU0FBUztZQUNUQyxTQUFTO1FBQ1g7SUFDRixFQUFFLE9BQU9GLE9BQU87UUFDZCxPQUFPO1lBQ0xDLFNBQVM7WUFDVEQsT0FBTztZQUNQRSxTQUFTLENBQUMsOEJBQThCLEVBQUVGLGlCQUFpQk8sUUFBUVAsTUFBTUUsT0FBTyxHQUFHLGdCQUFnQixDQUFDO1FBQ3RHO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvLi9saWIvcHVibGljLWxlc3NvbnMtc2VydmVyLnRzP2M0YTQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gU2VydmVyLXNpZGUgdXRpbGl0aWVzIGZvciBwdWJsaWMgbGVzc29uIGxpYnJhcnlcclxuLy8gVGhpcyBmaWxlIGNvbnRhaW5zIENSVUQgb3BlcmF0aW9ucyBmb3IgcHVibGljIGxlc3NvbnMgd2l0aCBwcm9wZXIgdmFsaWRhdGlvbiBhbmQgYWNjZXNzIGNvbnRyb2xcclxuXHJcbmltcG9ydCB7IGNyZWF0ZVNlcnZlclN1cGFiYXNlQ2xpZW50IH0gZnJvbSAnLi9zdXBhYmFzZS1zZXJ2ZXInO1xyXG5pbXBvcnQgdHlwZSB7XHJcbiAgUHVibGljTGVzc29uLFxyXG4gIFB1YmxpY0xlc3NvbkZpbHRlcnMsXHJcbiAgUHVibGljTGVzc29uTGlzdFJlc3BvbnNlLFxyXG4gIExlc3NvbkNvbnRlbnQsXHJcbiAgUHVibGljTGVzc29uTWV0YWRhdGEsXHJcbn0gZnJvbSAnLi90eXBlcy9wdWJsaWMtbGVzc29ucyc7XHJcblxyXG4vLyBSZXN1bHQgdHlwZSBmb3Igb3BlcmF0aW9uc1xyXG5pbnRlcmZhY2UgT3BlcmF0aW9uUmVzdWx0PFQgPSB2b2lkPiB7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBkYXRhPzogVDtcclxuICBlcnJvcj86IHN0cmluZztcclxuICBtZXNzYWdlPzogc3RyaW5nO1xyXG59XHJcblxyXG4vLyBWYWxpZGF0aW9uIHJlc3VsdCB0eXBlXHJcbmludGVyZmFjZSBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICB2YWxpZDogYm9vbGVhbjtcclxuICBlcnJvcnM6IHN0cmluZ1tdO1xyXG59XHJcblxyXG4vKipcclxuICogVmFsaWRhdGVzIHB1YmxpYyBsZXNzb24gY29udGVudCBiZWZvcmUgc2F2aW5nXHJcbiAqIEVuc3VyZXMgYWxsIHJlcXVpcmVkIHNlY3Rpb25zIGFyZSBwcmVzZW50IGFuZCBwcm9wZXJseSBmb3JtYXR0ZWRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVB1YmxpY0xlc3NvbkNvbnRlbnQoY29udGVudDogTGVzc29uQ29udGVudCk6IFZhbGlkYXRpb25SZXN1bHQge1xyXG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcclxuXHJcbiAgLy8gVmFsaWRhdGUgdGl0bGVcclxuICBpZiAoIWNvbnRlbnQudGl0bGUgfHwgY29udGVudC50aXRsZS50cmltKCkubGVuZ3RoID09PSAwKSB7XHJcbiAgICBlcnJvcnMucHVzaCgnTGVzc29uIHRpdGxlIGlzIHJlcXVpcmVkJyk7XHJcbiAgfVxyXG5cclxuICAvLyBWYWxpZGF0ZSB3YXJtdXAgc2VjdGlvblxyXG4gIGlmICghY29udGVudC53YXJtdXAgfHwgIWNvbnRlbnQud2FybXVwLnF1ZXN0aW9ucyB8fCBjb250ZW50Lndhcm11cC5xdWVzdGlvbnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICBlcnJvcnMucHVzaCgnV2FybXVwIHNlY3Rpb24gd2l0aCBhdCBsZWFzdCBvbmUgcXVlc3Rpb24gaXMgcmVxdWlyZWQnKTtcclxuICB9XHJcblxyXG4gIC8vIFZhbGlkYXRlIHdyYXB1cCBzZWN0aW9uXHJcbiAgaWYgKCFjb250ZW50LndyYXB1cCB8fCAhY29udGVudC53cmFwdXAuc3VtbWFyeSB8fCBjb250ZW50LndyYXB1cC5zdW1tYXJ5LnRyaW0oKS5sZW5ndGggPT09IDApIHtcclxuICAgIGVycm9ycy5wdXNoKCdXcmFwdXAgc2VjdGlvbiB3aXRoIHN1bW1hcnkgaXMgcmVxdWlyZWQnKTtcclxuICB9XHJcblxyXG4gIC8vIFZhbGlkYXRlIGF0IGxlYXN0IG9uZSBtYWluIGNvbnRlbnQgc2VjdGlvbiBleGlzdHNcclxuICBjb25zdCBoYXNNYWluQ29udGVudCA9ICEhKFxyXG4gICAgY29udGVudC52b2NhYnVsYXJ5IHx8XHJcbiAgICBjb250ZW50LmdyYW1tYXIgfHxcclxuICAgIGNvbnRlbnQucmVhZGluZyB8fFxyXG4gICAgY29udGVudC5kaXNjdXNzaW9uIHx8XHJcbiAgICBjb250ZW50LnByb251bmNpYXRpb25cclxuICApO1xyXG5cclxuICBpZiAoIWhhc01haW5Db250ZW50KSB7XHJcbiAgICBlcnJvcnMucHVzaCgnQXQgbGVhc3Qgb25lIG1haW4gY29udGVudCBzZWN0aW9uICh2b2NhYnVsYXJ5LCBncmFtbWFyLCByZWFkaW5nLCBkaXNjdXNzaW9uLCBvciBwcm9udW5jaWF0aW9uKSBpcyByZXF1aXJlZCcpO1xyXG4gIH1cclxuXHJcbiAgLy8gVmFsaWRhdGUgbWV0YWRhdGFcclxuICBpZiAoIWNvbnRlbnQubWV0YWRhdGEpIHtcclxuICAgIGVycm9ycy5wdXNoKCdMZXNzb24gbWV0YWRhdGEgaXMgcmVxdWlyZWQnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaWYgKCFjb250ZW50Lm1ldGFkYXRhLmNlZnJfbGV2ZWwpIHtcclxuICAgICAgZXJyb3JzLnB1c2goJ0NFRlIgbGV2ZWwgaXMgcmVxdWlyZWQgaW4gbWV0YWRhdGEnKTtcclxuICAgIH1cclxuICAgIGlmICghY29udGVudC5tZXRhZGF0YS5sZXNzb25fdHlwZSkge1xyXG4gICAgICBlcnJvcnMucHVzaCgnTGVzc29uIHR5cGUgaXMgcmVxdWlyZWQgaW4gbWV0YWRhdGEnKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICB2YWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcclxuICAgIGVycm9ycyxcclxuICB9O1xyXG59XHJcblxyXG4vKipcclxuICogUmV0cmlldmVzIHB1YmxpYyBsZXNzb25zIHdpdGggZmlsdGVyaW5nIGFuZCBjdXJzb3ItYmFzZWQgcGFnaW5hdGlvblxyXG4gKiBTdXBwb3J0cyBmaWx0ZXJpbmcgYnkgY2F0ZWdvcnksIENFRlIgbGV2ZWwsIGxlc3NvbiB0eXBlLCBhbmQgc2VhcmNoXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHVibGljTGVzc29ucyhcclxuICBmaWx0ZXJzOiBQdWJsaWNMZXNzb25GaWx0ZXJzID0ge30sXHJcbiAgY3Vyc29yPzogc3RyaW5nLFxyXG4gIGxpbWl0OiBudW1iZXIgPSAyMFxyXG4pOiBQcm9taXNlPE9wZXJhdGlvblJlc3VsdDxQdWJsaWNMZXNzb25MaXN0UmVzcG9uc2U+PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQoKTtcclxuXHJcbiAgICAvLyBCdWlsZCBxdWVyeSB3aXRoIGZpbHRlcnNcclxuICAgIGxldCBxdWVyeSA9IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdwdWJsaWNfbGVzc29ucycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcclxuICAgICAgLmxpbWl0KGxpbWl0KTtcclxuXHJcbiAgICAvLyBBcHBseSBjdXJzb3ItYmFzZWQgcGFnaW5hdGlvblxyXG4gICAgaWYgKGN1cnNvcikge1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5Lmx0KCdjcmVhdGVkX2F0JywgY3Vyc29yKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBBcHBseSBjYXRlZ29yeSBmaWx0ZXJcclxuICAgIGlmIChmaWx0ZXJzLmNhdGVnb3J5KSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2NhdGVnb3J5JywgZmlsdGVycy5jYXRlZ29yeSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQXBwbHkgQ0VGUiBsZXZlbCBmaWx0ZXJcclxuICAgIGlmIChmaWx0ZXJzLmNlZnJfbGV2ZWwpIHtcclxuICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnY2Vmcl9sZXZlbCcsIGZpbHRlcnMuY2Vmcl9sZXZlbCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQXBwbHkgbGVzc29uIHR5cGUgZmlsdGVyXHJcbiAgICBpZiAoZmlsdGVycy5sZXNzb25fdHlwZSkge1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdsZXNzb25fdHlwZScsIGZpbHRlcnMubGVzc29uX3R5cGUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFwcGx5IHNlYXJjaCBmaWx0ZXIgKHNlYXJjaGVzIGluIHRpdGxlIGFuZCBzb3VyY2VfdGl0bGUpXHJcbiAgICBpZiAoZmlsdGVycy5zZWFyY2ggJiYgZmlsdGVycy5zZWFyY2gudHJpbSgpLmxlbmd0aCA+IDApIHtcclxuICAgICAgcXVlcnkgPSBxdWVyeS50ZXh0U2VhcmNoKCdzZWFyY2hfdmVjdG9yJywgZmlsdGVycy5zZWFyY2gudHJpbSgpKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBxdWVyeTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0RBVEFCQVNFX0VSUk9SJyxcclxuICAgICAgICBtZXNzYWdlOiBgRmFpbGVkIHRvIGZldGNoIHB1YmxpYyBsZXNzb25zOiAke2Vycm9yLm1lc3NhZ2V9YCxcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgbmV4dCBjdXJzb3JcclxuICAgIGNvbnN0IG5leHRDdXJzb3IgPSBkYXRhICYmIGRhdGEubGVuZ3RoID09PSBsaW1pdCA/IGRhdGFbZGF0YS5sZW5ndGggLSAxXS5jcmVhdGVkX2F0IDogdW5kZWZpbmVkO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGRhdGE6IHtcclxuICAgICAgICBsZXNzb25zOiBkYXRhIHx8IFtdLFxyXG4gICAgICAgIG5leHRDdXJzb3IsXHJcbiAgICAgIH0sXHJcbiAgICB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6ICdVTktOT1dOX0VSUk9SJyxcclxuICAgICAgbWVzc2FnZTogYEFuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQ6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmV0cmlldmVzIGEgc2luZ2xlIHB1YmxpYyBsZXNzb24gYnkgSURcclxuICogQWNjZXNzaWJsZSB0byBhbGwgdXNlcnMgKGF1dGhlbnRpY2F0ZWQgYW5kIHVuYXV0aGVudGljYXRlZClcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQdWJsaWNMZXNzb24obGVzc29uSWQ6IHN0cmluZyk6IFByb21pc2U8T3BlcmF0aW9uUmVzdWx0PFB1YmxpY0xlc3Nvbj4+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVTZXJ2ZXJTdXBhYmFzZUNsaWVudCgpO1xyXG5cclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdwdWJsaWNfbGVzc29ucycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuZXEoJ2lkJywgbGVzc29uSWQpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdQR1JTVDExNicpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBlcnJvcjogJ05PVF9GT1VORCcsXHJcbiAgICAgICAgICBtZXNzYWdlOiAnUHVibGljIGxlc3NvbiBub3QgZm91bmQnLFxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0RBVEFCQVNFX0VSUk9SJyxcclxuICAgICAgICBtZXNzYWdlOiBgRmFpbGVkIHRvIGZldGNoIHB1YmxpYyBsZXNzb246ICR7ZXJyb3IubWVzc2FnZX1gLFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGRhdGE6IGRhdGEgYXMgUHVibGljTGVzc29uLFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnVU5LTk9XTl9FUlJPUicsXHJcbiAgICAgIG1lc3NhZ2U6IGBBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWAsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZXMgYSBuZXcgcHVibGljIGxlc3NvblxyXG4gKiBSZXF1aXJlcyBhdXRoZW50aWNhdGlvbiBhbmQgdmFsaWRhdGVzIGNvbnRlbnQgYmVmb3JlIHNhdmluZ1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVB1YmxpY0xlc3NvbihcclxuICBjb250ZW50OiBMZXNzb25Db250ZW50LFxyXG4gIG1ldGFkYXRhOiBQdWJsaWNMZXNzb25NZXRhZGF0YSxcclxuICB1c2VySWQ6IHN0cmluZ1xyXG4pOiBQcm9taXNlPE9wZXJhdGlvblJlc3VsdDxzdHJpbmc+PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIFZhbGlkYXRlIGNvbnRlbnRcclxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSB2YWxpZGF0ZVB1YmxpY0xlc3NvbkNvbnRlbnQoY29udGVudCk7XHJcbiAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ1ZBTElEQVRJT05fRVJST1InLFxyXG4gICAgICAgIG1lc3NhZ2U6IGBDb250ZW50IHZhbGlkYXRpb24gZmFpbGVkOiAke3ZhbGlkYXRpb24uZXJyb3JzLmpvaW4oJywgJyl9YCxcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVc2Ugc2VydmljZSByb2xlIGNsaWVudCB0byBieXBhc3MgUkxTIGZvciBhZG1pbiBvcGVyYXRpb25zXHJcbiAgICAvLyBUaGlzIGlzIHNhZmUgYmVjYXVzZSB3ZSd2ZSBhbHJlYWR5IHZlcmlmaWVkIGFkbWluIHN0YXR1cyBpbiB0aGUgQVBJIHJvdXRlXHJcbiAgICBjb25zdCB7IGNyZWF0ZUNsaWVudCB9ID0gYXdhaXQgaW1wb3J0KCdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnKTtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KFxyXG4gICAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhLFxyXG4gICAgICBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZISxcclxuICAgICAge1xyXG4gICAgICAgIGF1dGg6IHtcclxuICAgICAgICAgIGF1dG9SZWZyZXNoVG9rZW46IGZhbHNlLFxyXG4gICAgICAgICAgcGVyc2lzdFNlc3Npb246IGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIC8vIFByZXBhcmUgbGVzc29uIGRhdGFcclxuICAgIGNvbnN0IGxlc3NvbkRhdGEgPSB7XHJcbiAgICAgIGNyZWF0b3JfaWQ6IHVzZXJJZCxcclxuICAgICAgdGl0bGU6IGNvbnRlbnQudGl0bGUsXHJcbiAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsXHJcbiAgICAgIHNvdXJjZV91cmw6IGNvbnRlbnQubWV0YWRhdGEuc291cmNlX3VybCB8fCBudWxsLFxyXG4gICAgICBzb3VyY2VfdGl0bGU6IGNvbnRlbnQubWV0YWRhdGEuc291cmNlX3RpdGxlIHx8IG51bGwsXHJcbiAgICAgIGJhbm5lcl9pbWFnZV91cmw6IGNvbnRlbnQubWV0YWRhdGEuYmFubmVyX2ltYWdlX3VybCB8fCBudWxsLFxyXG4gICAgICBjYXRlZ29yeTogbWV0YWRhdGEuY2F0ZWdvcnksXHJcbiAgICAgIGNlZnJfbGV2ZWw6IGNvbnRlbnQubWV0YWRhdGEuY2Vmcl9sZXZlbCxcclxuICAgICAgbGVzc29uX3R5cGU6IGNvbnRlbnQubWV0YWRhdGEubGVzc29uX3R5cGUsXHJcbiAgICAgIHRhZ3M6IG1ldGFkYXRhLnRhZ3MgfHwgW10sXHJcbiAgICAgIGVzdGltYXRlZF9kdXJhdGlvbl9taW51dGVzOiBtZXRhZGF0YS5lc3RpbWF0ZWRfZHVyYXRpb25fbWludXRlcyB8fCBudWxsLFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncHVibGljX2xlc3NvbnMnKVxyXG4gICAgICAuaW5zZXJ0KGxlc3NvbkRhdGEpXHJcbiAgICAgIC5zZWxlY3QoJ2lkJylcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnREFUQUJBU0VfRVJST1InLFxyXG4gICAgICAgIG1lc3NhZ2U6IGBGYWlsZWQgdG8gY3JlYXRlIHB1YmxpYyBsZXNzb246ICR7ZXJyb3IubWVzc2FnZX1gLFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGRhdGE6IGRhdGEuaWQsXHJcbiAgICAgIG1lc3NhZ2U6ICdQdWJsaWMgbGVzc29uIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5JyxcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ1VOS05PV05fRVJST1InLFxyXG4gICAgICBtZXNzYWdlOiBgQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZDogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVcGRhdGVzIGFuIGV4aXN0aW5nIHB1YmxpYyBsZXNzb25cclxuICogUmVxdWlyZXMgYXV0aGVudGljYXRpb24gKFJMUyBlbmZvcmNlcyB1cGRhdGUgcGVybWlzc2lvbnMpXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlUHVibGljTGVzc29uKFxyXG4gIGxlc3NvbklkOiBzdHJpbmcsXHJcbiAgdXBkYXRlczogUGFydGlhbDxQdWJsaWNMZXNzb24+LFxyXG4gIHVzZXJJZDogc3RyaW5nXHJcbik6IFByb21pc2U8T3BlcmF0aW9uUmVzdWx0PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQoKTtcclxuXHJcbiAgICAvLyBWZXJpZnkgdXNlciBpcyBhdXRoZW50aWNhdGVkXHJcbiAgICBjb25zdCB7IGRhdGE6IHsgdXNlciB9IH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIoKTtcclxuICAgIGlmICghdXNlciB8fCB1c2VyLmlkICE9PSB1c2VySWQpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0FVVEhFTlRJQ0FUSU9OX0VSUk9SJyxcclxuICAgICAgICBtZXNzYWdlOiAnVXNlciBtdXN0IGJlIGF1dGhlbnRpY2F0ZWQgdG8gdXBkYXRlIHB1YmxpYyBsZXNzb25zJyxcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJZiBjb250ZW50IGlzIGJlaW5nIHVwZGF0ZWQsIHZhbGlkYXRlIGl0XHJcbiAgICBpZiAodXBkYXRlcy5jb250ZW50KSB7XHJcbiAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB2YWxpZGF0ZVB1YmxpY0xlc3NvbkNvbnRlbnQodXBkYXRlcy5jb250ZW50KTtcclxuICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6ICdWQUxJREFUSU9OX0VSUk9SJyxcclxuICAgICAgICAgIG1lc3NhZ2U6IGBDb250ZW50IHZhbGlkYXRpb24gZmFpbGVkOiAke3ZhbGlkYXRpb24uZXJyb3JzLmpvaW4oJywgJyl9YCxcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmVtb3ZlIGZpZWxkcyB0aGF0IHNob3VsZG4ndCBiZSB1cGRhdGVkIGRpcmVjdGx5XHJcbiAgICBjb25zdCB7IGlkLCBjcmVhdGVkX2F0LCBjcmVhdG9yX2lkLCAuLi5hbGxvd2VkVXBkYXRlcyB9ID0gdXBkYXRlcztcclxuXHJcbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncHVibGljX2xlc3NvbnMnKVxyXG4gICAgICAudXBkYXRlKGFsbG93ZWRVcGRhdGVzKVxyXG4gICAgICAuZXEoJ2lkJywgbGVzc29uSWQpO1xyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnREFUQUJBU0VfRVJST1InLFxyXG4gICAgICAgIG1lc3NhZ2U6IGBGYWlsZWQgdG8gdXBkYXRlIHB1YmxpYyBsZXNzb246ICR7ZXJyb3IubWVzc2FnZX1gLFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIG1lc3NhZ2U6ICdQdWJsaWMgbGVzc29uIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5JyxcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ1VOS05PV05fRVJST1InLFxyXG4gICAgICBtZXNzYWdlOiBgQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZDogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZWxldGVzIGEgcHVibGljIGxlc3NvblxyXG4gKiBSZXF1aXJlcyBhZG1pbiBwcml2aWxlZ2VzIChlbmZvcmNlZCBieSBSTFMpXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlUHVibGljTGVzc29uKFxyXG4gIGxlc3NvbklkOiBzdHJpbmcsXHJcbiAgdXNlcklkOiBzdHJpbmdcclxuKTogUHJvbWlzZTxPcGVyYXRpb25SZXN1bHQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVTZXJ2ZXJTdXBhYmFzZUNsaWVudCgpO1xyXG5cclxuICAgIC8vIFZlcmlmeSB1c2VyIGlzIGF1dGhlbnRpY2F0ZWRcclxuICAgIGNvbnN0IHsgZGF0YTogeyB1c2VyIH0gfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpO1xyXG4gICAgaWYgKCF1c2VyIHx8IHVzZXIuaWQgIT09IHVzZXJJZCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQVVUSEVOVElDQVRJT05fRVJST1InLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdVc2VyIG11c3QgYmUgYXV0aGVudGljYXRlZCB0byBkZWxldGUgcHVibGljIGxlc3NvbnMnLFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFZlcmlmeSBhZG1pbiBzdGF0dXNcclxuICAgIGNvbnN0IHsgZGF0YTogdHV0b3IsIGVycm9yOiB0dXRvckVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgndHV0b3JzJylcclxuICAgICAgLnNlbGVjdCgnaXNfYWRtaW4nKVxyXG4gICAgICAuZXEoJ2lkJywgdXNlcklkKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKHR1dG9yRXJyb3IgfHwgIXR1dG9yPy5pc19hZG1pbikge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnUEVSTUlTU0lPTl9ERU5JRUQnLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdPbmx5IGFkbWluaXN0cmF0b3JzIGNhbiBkZWxldGUgcHVibGljIGxlc3NvbnMnLFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFByb2NlZWQgd2l0aCBkZWxldGlvblxyXG4gICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3B1YmxpY19sZXNzb25zJylcclxuICAgICAgLmRlbGV0ZSgpXHJcbiAgICAgIC5lcSgnaWQnLCBsZXNzb25JZCk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdEQVRBQkFTRV9FUlJPUicsXHJcbiAgICAgICAgbWVzc2FnZTogYEZhaWxlZCB0byBkZWxldGUgcHVibGljIGxlc3NvbjogJHtlcnJvci5tZXNzYWdlfWAsXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgbWVzc2FnZTogJ1B1YmxpYyBsZXNzb24gZGVsZXRlZCBzdWNjZXNzZnVsbHknLFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnVU5LTk9XTl9FUlJPUicsXHJcbiAgICAgIG1lc3NhZ2U6IGBBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWAsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQiLCJ2YWxpZGF0ZVB1YmxpY0xlc3NvbkNvbnRlbnQiLCJjb250ZW50IiwiZXJyb3JzIiwidGl0bGUiLCJ0cmltIiwibGVuZ3RoIiwicHVzaCIsIndhcm11cCIsInF1ZXN0aW9ucyIsIndyYXB1cCIsInN1bW1hcnkiLCJoYXNNYWluQ29udGVudCIsInZvY2FidWxhcnkiLCJncmFtbWFyIiwicmVhZGluZyIsImRpc2N1c3Npb24iLCJwcm9udW5jaWF0aW9uIiwibWV0YWRhdGEiLCJjZWZyX2xldmVsIiwibGVzc29uX3R5cGUiLCJ2YWxpZCIsImdldFB1YmxpY0xlc3NvbnMiLCJmaWx0ZXJzIiwiY3Vyc29yIiwibGltaXQiLCJzdXBhYmFzZSIsInF1ZXJ5IiwiZnJvbSIsInNlbGVjdCIsIm9yZGVyIiwiYXNjZW5kaW5nIiwibHQiLCJjYXRlZ29yeSIsImVxIiwic2VhcmNoIiwidGV4dFNlYXJjaCIsImRhdGEiLCJlcnJvciIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwibmV4dEN1cnNvciIsImNyZWF0ZWRfYXQiLCJ1bmRlZmluZWQiLCJsZXNzb25zIiwiRXJyb3IiLCJnZXRQdWJsaWNMZXNzb24iLCJsZXNzb25JZCIsInNpbmdsZSIsImNvZGUiLCJjcmVhdGVQdWJsaWNMZXNzb24iLCJ1c2VySWQiLCJ2YWxpZGF0aW9uIiwiam9pbiIsImNyZWF0ZUNsaWVudCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiYXV0aCIsImF1dG9SZWZyZXNoVG9rZW4iLCJwZXJzaXN0U2Vzc2lvbiIsImxlc3NvbkRhdGEiLCJjcmVhdG9yX2lkIiwic291cmNlX3VybCIsInNvdXJjZV90aXRsZSIsImJhbm5lcl9pbWFnZV91cmwiLCJ0YWdzIiwiZXN0aW1hdGVkX2R1cmF0aW9uX21pbnV0ZXMiLCJpbnNlcnQiLCJpZCIsInVwZGF0ZVB1YmxpY0xlc3NvbiIsInVwZGF0ZXMiLCJ1c2VyIiwiZ2V0VXNlciIsImFsbG93ZWRVcGRhdGVzIiwidXBkYXRlIiwiZGVsZXRlUHVibGljTGVzc29uIiwidHV0b3IiLCJ0dXRvckVycm9yIiwiaXNfYWRtaW4iLCJkZWxldGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/public-lessons-server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase-server.ts":
/*!********************************!*\
  !*** ./lib/supabase-server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createServerSupabaseClient: () => (/* binding */ createServerSupabaseClient)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n\n\nconst supabaseUrl = \"https://jbkpnirowdvlwlgheqho.supabase.co\" || 0;\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impia3BuaXJvd2R2bHdsZ2hlcWhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5MTQ3NTEsImV4cCI6MjA3NDQ5MDc1MX0.FZhruXKDzIkZLhla5oerfs7yzjvTsGLlKTUer34N6N0\" || 0;\n// Server client (for API routes and server components)\nconst createServerSupabaseClient = async ()=>{\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_1__.createServerClient)(supabaseUrl, supabaseAnonKey, {\n        cookies: {\n            getAll () {\n                return cookieStore.getAll();\n            },\n            setAll (cookiesToSet) {\n                try {\n                    cookiesToSet.forEach(({ name, value, options })=>cookieStore.set(name, value, options));\n                } catch  {\n                // The `setAll` method was called from a Server Component.\n                // This can be ignored if you have middleware refreshing\n                // user sessions.\n                }\n            }\n        }\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Utc2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFzQztBQUNZO0FBR2xELE1BQU1FLGNBQWNDLDBDQUFvQyxJQUFJO0FBQzVELE1BQU1HLGtCQUFrQkgsa05BQXlDLElBQUk7QUFFckUsdURBQXVEO0FBQ2hELE1BQU1LLDZCQUE2QjtJQUN4QyxNQUFNQyxjQUFjLE1BQU1ULHFEQUFPQTtJQUVqQyxPQUFPQyxpRUFBa0JBLENBQUNDLGFBQWFJLGlCQUFpQjtRQUN0RE4sU0FBUztZQUNQVTtnQkFDRSxPQUFPRCxZQUFZQyxNQUFNO1lBQzNCO1lBQ0FDLFFBQU9DLFlBQVk7Z0JBQ2pCLElBQUk7b0JBQ0ZBLGFBQWFDLE9BQU8sQ0FBQyxDQUFDLEVBQUVDLElBQUksRUFBRUMsS0FBSyxFQUFFQyxPQUFPLEVBQUUsR0FDNUNQLFlBQVlRLEdBQUcsQ0FBQ0gsTUFBTUMsT0FBT0M7Z0JBRWpDLEVBQUUsT0FBTTtnQkFDTiwwREFBMEQ7Z0JBQzFELHdEQUF3RDtnQkFDeEQsaUJBQWlCO2dCQUNuQjtZQUNGO1FBQ0Y7SUFDRjtBQUNGLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL3N1cGFiYXNlLXNlcnZlci50cz8wOTRmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNvb2tpZXMgfSBmcm9tIFwibmV4dC9oZWFkZXJzXCJcbmltcG9ydCB7IGNyZWF0ZVNlcnZlckNsaWVudCB9IGZyb20gXCJAc3VwYWJhc2Uvc3NyXCJcblxuXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCB8fCAnaHR0cHM6Ly9wbGFjZWhvbGRlci5zdXBhYmFzZS5jbydcbmNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIHx8ICdwbGFjZWhvbGRlci1rZXknXG5cbi8vIFNlcnZlciBjbGllbnQgKGZvciBBUEkgcm91dGVzIGFuZCBzZXJ2ZXIgY29tcG9uZW50cylcbmV4cG9ydCBjb25zdCBjcmVhdGVTZXJ2ZXJTdXBhYmFzZUNsaWVudCA9IGFzeW5jICgpID0+IHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKClcblxuICByZXR1cm4gY3JlYXRlU2VydmVyQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUFub25LZXksIHtcbiAgICBjb29raWVzOiB7XG4gICAgICBnZXRBbGwoKSB7XG4gICAgICAgIHJldHVybiBjb29raWVTdG9yZS5nZXRBbGwoKVxuICAgICAgfSxcbiAgICAgIHNldEFsbChjb29raWVzVG9TZXQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb29raWVzVG9TZXQuZm9yRWFjaCgoeyBuYW1lLCB2YWx1ZSwgb3B0aW9ucyB9KSA9PlxuICAgICAgICAgICAgY29va2llU3RvcmUuc2V0KG5hbWUsIHZhbHVlLCBvcHRpb25zKVxuICAgICAgICAgIClcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgLy8gVGhlIGBzZXRBbGxgIG1ldGhvZCB3YXMgY2FsbGVkIGZyb20gYSBTZXJ2ZXIgQ29tcG9uZW50LlxuICAgICAgICAgIC8vIFRoaXMgY2FuIGJlIGlnbm9yZWQgaWYgeW91IGhhdmUgbWlkZGxld2FyZSByZWZyZXNoaW5nXG4gICAgICAgICAgLy8gdXNlciBzZXNzaW9ucy5cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9LFxuICB9KVxufVxuIl0sIm5hbWVzIjpbImNvb2tpZXMiLCJjcmVhdGVTZXJ2ZXJDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImNyZWF0ZVNlcnZlclN1cGFiYXNlQ2xpZW50IiwiY29va2llU3RvcmUiLCJnZXRBbGwiLCJzZXRBbGwiLCJjb29raWVzVG9TZXQiLCJmb3JFYWNoIiwibmFtZSIsInZhbHVlIiwib3B0aW9ucyIsInNldCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase-server.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions","vendor-chunks/cookie"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpublic-lessons%2Flist%2Froute&page=%2Fapi%2Fpublic-lessons%2Flist%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpublic-lessons%2Flist%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();
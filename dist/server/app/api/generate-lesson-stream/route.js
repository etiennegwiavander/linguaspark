"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/generate-lesson-stream/route";
exports.ids = ["app/api/generate-lesson-stream/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson-stream%2Froute&page=%2Fapi%2Fgenerate-lesson-stream%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson-stream%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson-stream%2Froute&page=%2Fapi%2Fgenerate-lesson-stream%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson-stream%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_linguaspark_app_api_generate_lesson_stream_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/generate-lesson-stream/route.ts */ \"(rsc)/./app/api/generate-lesson-stream/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/generate-lesson-stream/route\",\n        pathname: \"/api/generate-lesson-stream\",\n        filename: \"route\",\n        bundlePath: \"app/api/generate-lesson-stream/route\"\n    },\n    resolvedPagePath: \"D:\\\\linguaspark\\\\app\\\\api\\\\generate-lesson-stream\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_linguaspark_app_api_generate_lesson_stream_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/generate-lesson-stream/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZnZW5lcmF0ZS1sZXNzb24tc3RyZWFtJTJGcm91dGUmcGFnZT0lMkZhcGklMkZnZW5lcmF0ZS1sZXNzb24tc3RyZWFtJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGZ2VuZXJhdGUtbGVzc29uLXN0cmVhbSUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDbGluZ3Vhc3BhcmslNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUQlM0ElNUNsaW5ndWFzcGFyayZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDVztBQUN4RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvPzJkZjQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxcbGluZ3Vhc3BhcmtcXFxcYXBwXFxcXGFwaVxcXFxnZW5lcmF0ZS1sZXNzb24tc3RyZWFtXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9nZW5lcmF0ZS1sZXNzb24tc3RyZWFtL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZ2VuZXJhdGUtbGVzc29uLXN0cmVhbVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvZ2VuZXJhdGUtbGVzc29uLXN0cmVhbS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkQ6XFxcXGxpbmd1YXNwYXJrXFxcXGFwcFxcXFxhcGlcXFxcZ2VuZXJhdGUtbGVzc29uLXN0cmVhbVxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvZ2VuZXJhdGUtbGVzc29uLXN0cmVhbS9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson-stream%2Froute&page=%2Fapi%2Fgenerate-lesson-stream%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson-stream%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/globals.css":
/*!*************************!*\
  !*** ./app/globals.css ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"b8709e0dedae\");\nif (false) {}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvZ2xvYmFscy5jc3MiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLGlFQUFlLGNBQWM7QUFDN0IsSUFBSSxLQUFVLEVBQUUsRUFBdUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vYXBwL2dsb2JhbHMuY3NzP2YxMTIiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgXCJiODcwOWUwZGVkYWVcIlxuaWYgKG1vZHVsZS5ob3QpIHsgbW9kdWxlLmhvdC5hY2NlcHQoKSB9XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/globals.css\n");

/***/ }),

/***/ "(rsc)/./app/api/generate-lesson-stream/route.ts":
/*!*************************************************!*\
  !*** ./app/api/generate-lesson-stream/route.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var _lib_lesson_ai_generator_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/lesson-ai-generator-server */ \"(rsc)/./lib/lesson-ai-generator-server.ts\");\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase */ \"(rsc)/./lib/supabase.ts\");\n/* harmony import */ var _lib_content_validator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/content-validator */ \"(rsc)/./lib/content-validator.ts\");\n/* harmony import */ var _lib_error_classifier__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/error-classifier */ \"(rsc)/./lib/error-classifier.ts\");\n\n\n\n\n// Helper to create SSE message\nfunction createSSEMessage(data) {\n    return `data: ${JSON.stringify(data)}\\n\\n`;\n}\nasync function POST(request) {\n    const encoder = new TextEncoder();\n    let userId;\n    let requestContext = {};\n    // Track current progress state for error reporting\n    let currentProgressState = {\n        step: \"Not started\",\n        progress: 0,\n        phase: \"initialization\",\n        section: undefined\n    };\n    const stream = new ReadableStream({\n        async start (controller) {\n            try {\n                const body = await request.json();\n                const { sourceText, lessonType, studentLevel, targetLanguage, sourceUrl, contentMetadata, structuredContent, wordCount, readingTime } = body;\n                // Set up request context\n                requestContext = {\n                    contentLength: sourceText?.length,\n                    lessonType,\n                    studentLevel,\n                    targetLanguage,\n                    apiEndpoint: \"/api/generate-lesson-stream\"\n                };\n                // Send initial progress\n                currentProgressState = {\n                    step: \"Initializing lesson generation...\",\n                    progress: 5,\n                    phase: \"initialization\",\n                    section: undefined\n                };\n                controller.enqueue(encoder.encode(createSSEMessage({\n                    type: \"progress\",\n                    ...currentProgressState\n                })));\n                // Validate required fields\n                if (!sourceText || !lessonType || !studentLevel || !targetLanguage) {\n                    controller.enqueue(encoder.encode(createSSEMessage({\n                        type: \"error\",\n                        error: {\n                            type: \"CONTENT_ISSUE\",\n                            message: \"Missing required fields\",\n                            errorId: `REQ_${Date.now()}`\n                        },\n                        progressState: currentProgressState\n                    })));\n                    controller.close();\n                    return;\n                }\n                // Validate content\n                currentProgressState = {\n                    step: \"Validating content...\",\n                    progress: 10,\n                    phase: \"validation\",\n                    section: undefined\n                };\n                controller.enqueue(encoder.encode(createSSEMessage({\n                    type: \"progress\",\n                    ...currentProgressState\n                })));\n                const validationResult = _lib_content_validator__WEBPACK_IMPORTED_MODULE_2__.contentValidator.validateContent(sourceText);\n                if (!validationResult.isValid) {\n                    const classifiedError = _lib_error_classifier__WEBPACK_IMPORTED_MODULE_3__.errorClassifier.classifyError(new Error(`Content validation failed: ${validationResult.reason}`), requestContext);\n                    const userMessage = _lib_error_classifier__WEBPACK_IMPORTED_MODULE_3__.errorClassifier.generateUserMessage(classifiedError);\n                    controller.enqueue(encoder.encode(createSSEMessage({\n                        type: \"error\",\n                        error: {\n                            type: userMessage.title,\n                            message: userMessage.message,\n                            errorId: userMessage.errorId\n                        },\n                        progressState: currentProgressState\n                    })));\n                    controller.close();\n                    return;\n                }\n                // Validate authentication\n                currentProgressState = {\n                    step: \"Authenticating...\",\n                    progress: 15,\n                    phase: \"authentication\",\n                    section: undefined\n                };\n                controller.enqueue(encoder.encode(createSSEMessage({\n                    type: \"progress\",\n                    ...currentProgressState\n                })));\n                // Get auth token from request headers\n                const authHeader = request.headers.get(\"Authorization\");\n                if (!authHeader) {\n                    controller.enqueue(encoder.encode(createSSEMessage({\n                        type: \"error\",\n                        error: {\n                            type: \"AUTH_ERROR\",\n                            message: \"Authentication required - no authorization header\",\n                            errorId: `AUTH_${Date.now()}`\n                        },\n                        progressState: currentProgressState\n                    })));\n                    controller.close();\n                    return;\n                }\n                // Verify the token by creating a client with it\n                const supabase = (0,_lib_supabase__WEBPACK_IMPORTED_MODULE_1__.createClient)();\n                const token = authHeader.replace(\"Bearer \", \"\");\n                const { data: { user }, error: authError } = await supabase.auth.getUser(token);\n                if (authError || !user) {\n                    controller.enqueue(encoder.encode(createSSEMessage({\n                        type: \"error\",\n                        error: {\n                            type: \"AUTH_ERROR\",\n                            message: \"Invalid or expired token\",\n                            errorId: `AUTH_${Date.now()}`\n                        },\n                        progressState: currentProgressState\n                    })));\n                    controller.close();\n                    return;\n                }\n                userId = user.id;\n                // Create progress callback that streams real-time updates to frontend\n                const progressCallback = (update)=>{\n                    try {\n                        // Update current progress state for error reporting\n                        currentProgressState = {\n                            step: update.step,\n                            progress: update.progress,\n                            phase: update.phase,\n                            section: update.section\n                        };\n                        controller.enqueue(encoder.encode(createSSEMessage({\n                            type: \"progress\",\n                            ...currentProgressState\n                        })));\n                    } catch (error) {\n                        // Log but don't throw - generation should continue even if streaming fails\n                        console.error(\"Failed to stream progress update:\", error);\n                    }\n                };\n                // Generate the lesson with real-time progress callbacks\n                const lesson = await _lib_lesson_ai_generator_server__WEBPACK_IMPORTED_MODULE_0__.lessonAIServerGenerator.generateLesson({\n                    sourceText,\n                    lessonType,\n                    studentLevel,\n                    targetLanguage,\n                    sourceUrl,\n                    contentMetadata,\n                    structuredContent,\n                    wordCount,\n                    readingTime,\n                    onProgress: progressCallback\n                });\n                // Save to database\n                currentProgressState = {\n                    step: \"Saving lesson...\",\n                    progress: 95,\n                    phase: \"saving\",\n                    section: undefined\n                };\n                controller.enqueue(encoder.encode(createSSEMessage({\n                    type: \"progress\",\n                    ...currentProgressState\n                })));\n                const { error: insertError } = await supabase.from(\"lessons\").insert({\n                    user_id: userId,\n                    lesson_title: lesson.lessonTitle,\n                    lesson_type: lessonType,\n                    student_level: studentLevel,\n                    target_language: targetLanguage,\n                    lesson_data: lesson,\n                    source_url: sourceUrl\n                });\n                if (insertError) {\n                    console.error(\"Error saving lesson:\", insertError);\n                }\n                // Send completion\n                controller.enqueue(encoder.encode(createSSEMessage({\n                    type: \"complete\",\n                    step: \"Lesson generated successfully!\",\n                    progress: 100,\n                    lesson\n                })));\n                controller.close();\n            } catch (error) {\n                console.error(\"Streaming error:\", error);\n                console.error(\"Progress state at error:\", currentProgressState);\n                const classifiedError = _lib_error_classifier__WEBPACK_IMPORTED_MODULE_3__.errorClassifier.classifyError(error, requestContext);\n                const userMessage = _lib_error_classifier__WEBPACK_IMPORTED_MODULE_3__.errorClassifier.generateUserMessage(classifiedError);\n                controller.enqueue(encoder.encode(createSSEMessage({\n                    type: \"error\",\n                    error: {\n                        type: userMessage.title,\n                        message: userMessage.message,\n                        errorId: userMessage.errorId\n                    },\n                    progressState: currentProgressState\n                })));\n                controller.close();\n            }\n        }\n    });\n    return new Response(stream, {\n        headers: {\n            \"Content-Type\": \"text/event-stream\",\n            \"Cache-Control\": \"no-cache\",\n            \"Connection\": \"keep-alive\"\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2dlbmVyYXRlLWxlc3Nvbi1zdHJlYW0vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFDMEU7QUFDN0I7QUFDYTtBQUNZO0FBRXRFLCtCQUErQjtBQUMvQixTQUFTSSxpQkFBaUJDLElBQVM7SUFDakMsT0FBTyxDQUFDLE1BQU0sRUFBRUMsS0FBS0MsU0FBUyxDQUFDRixNQUFNLElBQUksQ0FBQztBQUM1QztBQUVPLGVBQWVHLEtBQUtDLE9BQW9CO0lBQzdDLE1BQU1DLFVBQVUsSUFBSUM7SUFFcEIsSUFBSUM7SUFDSixJQUFJQyxpQkFBc0IsQ0FBQztJQUUzQixtREFBbUQ7SUFDbkQsSUFBSUMsdUJBQXVCO1FBQ3pCQyxNQUFNO1FBQ05DLFVBQVU7UUFDVkMsT0FBTztRQUNQQyxTQUFTQztJQUNYO0lBRUEsTUFBTUMsU0FBUyxJQUFJQyxlQUFlO1FBQ2hDLE1BQU1DLE9BQU1DLFVBQVU7WUFDcEIsSUFBSTtnQkFDRixNQUFNQyxPQUFPLE1BQU1mLFFBQVFnQixJQUFJO2dCQUMvQixNQUFNLEVBQ0pDLFVBQVUsRUFDVkMsVUFBVSxFQUNWQyxZQUFZLEVBQ1pDLGNBQWMsRUFDZEMsU0FBUyxFQUNUQyxlQUFlLEVBQ2ZDLGlCQUFpQixFQUNqQkMsU0FBUyxFQUNUQyxXQUFXLEVBQ1osR0FBR1Y7Z0JBRUoseUJBQXlCO2dCQUN6QlgsaUJBQWlCO29CQUNmc0IsZUFBZVQsWUFBWVU7b0JBQzNCVDtvQkFDQUM7b0JBQ0FDO29CQUNBUSxhQUFhO2dCQUNmO2dCQUVBLHdCQUF3QjtnQkFDeEJ2Qix1QkFBdUI7b0JBQ3JCQyxNQUFNO29CQUNOQyxVQUFVO29CQUNWQyxPQUFPO29CQUNQQyxTQUFTQztnQkFDWDtnQkFDQUksV0FBV2UsT0FBTyxDQUNoQjVCLFFBQVE2QixNQUFNLENBQUNuQyxpQkFBaUI7b0JBQzlCb0MsTUFBTTtvQkFDTixHQUFHMUIsb0JBQW9CO2dCQUN6QjtnQkFHRiwyQkFBMkI7Z0JBQzNCLElBQUksQ0FBQ1ksY0FB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WXZEO2dCQUNkO2dCQUVBLElBQUk2QyxhQUFhO29CQUNmSixRQUFROUIsS0FBSyxDQUFDLHdCQUF3QmtDO2dCQUN4QztnQkFFQSxrQkFBa0I7Z0JBQ2xCcEQsV0FBV2UsT0FBTyxDQUNoQjVCLFFBQVE2QixNQUFNLENBQUNuQyxpQkFBaUI7b0JBQzlCb0MsTUFBTTtvQkFDTnpCLE1BQU07b0JBQ05DLFVBQVU7b0JBQ1Z3RDtnQkFDRjtnQkFHRmpELFdBQVd3QixLQUFLO1lBRWxCLEVBQUUsT0FBT04sT0FBTztnQkFDZDhCLFFBQVE5QixLQUFLLENBQUMsb0JBQW9CQTtnQkFDbEM4QixRQUFROUIsS0FBSyxDQUFDLDRCQUE0QjNCO2dCQUUxQyxNQUFNcUMsa0JBQWtCaEQsa0VBQWVBLENBQUNpRCxhQUFhLENBQUNYLE9BQWtCNUI7Z0JBQ3hFLE1BQU0wQyxjQUFjcEQsa0VBQWVBLENBQUNxRCxtQkFBbUIsQ0FBQ0w7Z0JBRXhENUIsV0FBV2UsT0FBTyxDQUNoQjVCLFFBQVE2QixNQUFNLENBQUNuQyxpQkFBaUI7b0JBQzlCb0MsTUFBTTtvQkFDTkMsT0FBTzt3QkFDTEQsTUFBTWUsWUFBWUUsS0FBSzt3QkFDdkJmLFNBQVNhLFlBQVliLE9BQU87d0JBQzVCQyxTQUFTWSxZQUFZWixPQUFPO29CQUM5QjtvQkFDQUcsZUFBZWhDO2dCQUNqQjtnQkFHRlMsV0FBV3dCLEtBQUs7WUFDbEI7UUFDRjtJQUNGO0lBRUEsT0FBTyxJQUFJdUMsU0FBU2xFLFFBQVE7UUFDMUJ1QyxTQUFTO1lBQ1AsZ0JBQWdCO1lBQ2hCLGlCQUFpQjtZQUNqQixjQUFjO1FBQ2hCO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvLi9hcHAvYXBpL2dlbmVyYXRlLWxlc3Nvbi1zdHJlYW0vcm91dGUudHM/OGM4YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0eXBlIE5leHRSZXF1ZXN0IH0gZnJvbSBcIm5leHQvc2VydmVyXCJcclxuaW1wb3J0IHsgbGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3IgfSBmcm9tIFwiQC9saWIvbGVzc29uLWFpLWdlbmVyYXRvci1zZXJ2ZXJcIlxyXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tIFwiQC9saWIvc3VwYWJhc2VcIlxyXG5pbXBvcnQgeyBjb250ZW50VmFsaWRhdG9yIH0gZnJvbSBcIkAvbGliL2NvbnRlbnQtdmFsaWRhdG9yXCJcclxuaW1wb3J0IHsgZXJyb3JDbGFzc2lmaWVyLCB0eXBlIEFJRXJyb3IgfSBmcm9tIFwiQC9saWIvZXJyb3ItY2xhc3NpZmllclwiXHJcblxyXG4vLyBIZWxwZXIgdG8gY3JlYXRlIFNTRSBtZXNzYWdlXHJcbmZ1bmN0aW9uIGNyZWF0ZVNTRU1lc3NhZ2UoZGF0YTogYW55KTogc3RyaW5nIHtcclxuICByZXR1cm4gYGRhdGE6ICR7SlNPTi5zdHJpbmdpZnkoZGF0YSl9XFxuXFxuYFxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xyXG4gIGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKVxyXG4gIFxyXG4gIGxldCB1c2VySWQ6IHN0cmluZyB8IHVuZGVmaW5lZFxyXG4gIGxldCByZXF1ZXN0Q29udGV4dDogYW55ID0ge31cclxuICBcclxuICAvLyBUcmFjayBjdXJyZW50IHByb2dyZXNzIHN0YXRlIGZvciBlcnJvciByZXBvcnRpbmdcclxuICBsZXQgY3VycmVudFByb2dyZXNzU3RhdGUgPSB7XHJcbiAgICBzdGVwOiAnTm90IHN0YXJ0ZWQnLFxyXG4gICAgcHJvZ3Jlc3M6IDAsXHJcbiAgICBwaGFzZTogJ2luaXRpYWxpemF0aW9uJyxcclxuICAgIHNlY3Rpb246IHVuZGVmaW5lZCBhcyBzdHJpbmcgfCB1bmRlZmluZWRcclxuICB9XHJcblxyXG4gIGNvbnN0IHN0cmVhbSA9IG5ldyBSZWFkYWJsZVN0cmVhbSh7XHJcbiAgICBhc3luYyBzdGFydChjb250cm9sbGVyKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXHJcbiAgICAgICAgY29uc3Qge1xyXG4gICAgICAgICAgc291cmNlVGV4dCxcclxuICAgICAgICAgIGxlc3NvblR5cGUsXHJcbiAgICAgICAgICBzdHVkZW50TGV2ZWwsXHJcbiAgICAgICAgICB0YXJnZXRMYW5ndWFnZSxcclxuICAgICAgICAgIHNvdXJjZVVybCxcclxuICAgICAgICAgIGNvbnRlbnRNZXRhZGF0YSxcclxuICAgICAgICAgIHN0cnVjdHVyZWRDb250ZW50LFxyXG4gICAgICAgICAgd29yZENvdW50LFxyXG4gICAgICAgICAgcmVhZGluZ1RpbWUsXHJcbiAgICAgICAgfSA9IGJvZHlcclxuXHJcbiAgICAgICAgLy8gU2V0IHVwIHJlcXVlc3QgY29udGV4dFxyXG4gICAgICAgIHJlcXVlc3RDb250ZXh0ID0ge1xyXG4gICAgICAgICAgY29udGVudExlbmd0aDogc291cmNlVGV4dD8ubGVuZ3RoLFxyXG4gICAgICAgICAgbGVzc29uVHlwZSxcclxuICAgICAgICAgIHN0dWRlbnRMZXZlbCxcclxuICAgICAgICAgIHRhcmdldExhbmd1YWdlLFxyXG4gICAgICAgICAgYXBpRW5kcG9pbnQ6ICcvYXBpL2dlbmVyYXRlLWxlc3Nvbi1zdHJlYW0nXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBTZW5kIGluaXRpYWwgcHJvZ3Jlc3NcclxuICAgICAgICBjdXJyZW50UHJvZ3Jlc3NTdGF0ZSA9IHtcclxuICAgICAgICAgIHN0ZXA6ICdJbml0aWFsaXppbmcgbGVzc29uIGdlbmVyYXRpb24uLi4nLFxyXG4gICAgICAgICAgcHJvZ3Jlc3M6IDUsXHJcbiAgICAgICAgICBwaGFzZTogJ2luaXRpYWxpemF0aW9uJyxcclxuICAgICAgICAgIHNlY3Rpb246IHVuZGVmaW5lZFxyXG4gICAgICAgIH1cclxuICAgICAgICBjb250cm9sbGVyLmVucXVldWUoXHJcbiAgICAgICAgICBlbmNvZGVyLmVuY29kZShjcmVhdGVTU0VNZXNzYWdlKHtcclxuICAgICAgICAgICAgdHlwZTogJ3Byb2dyZXNzJyxcclxuICAgICAgICAgICAgLi4uY3VycmVudFByb2dyZXNzU3RhdGVcclxuICAgICAgICAgIH0pKVxyXG4gICAgICAgIClcclxuXHJcbiAgICAgICAgLy8gVmFsaWRhdGUgcmVxdWlyZWQgZmllbGRzXHJcbiAgICAgICAgaWYgKCFzb3VyY2VUZXh0IHx8ICFsZXNzb25UeXBlIHx8ICFzdHVkZW50TGV2ZWwgfHwgIXRhcmdldExhbmd1YWdlKSB7XHJcbiAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoXHJcbiAgICAgICAgICAgIGVuY29kZXIuZW5jb2RlKGNyZWF0ZVNTRU1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXHJcbiAgICAgICAgICAgICAgZXJyb3I6IHtcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdDT05URU5UX0lTU1VFJyxcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdNaXNzaW5nIHJlcXVpcmVkIGZpZWxkcycsXHJcbiAgICAgICAgICAgICAgICBlcnJvcklkOiBgUkVRXyR7RGF0ZS5ub3coKX1gXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBwcm9ncmVzc1N0YXRlOiBjdXJyZW50UHJvZ3Jlc3NTdGF0ZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICAgIClcclxuICAgICAgICAgIGNvbnRyb2xsZXIuY2xvc2UoKVxyXG4gICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBWYWxpZGF0ZSBjb250ZW50XHJcbiAgICAgICAgY3VycmVudFByb2dyZXNzU3RhdGUgPSB7XHJcbiAgICAgICAgICBzdGVwOiAnVmFsaWRhdGluZyBjb250ZW50Li4uJyxcclxuICAgICAgICAgIHByb2dyZXNzOiAxMCxcclxuICAgICAgICAgIHBoYXNlOiAndmFsaWRhdGlvbicsXHJcbiAgICAgICAgICBzZWN0aW9uOiB1bmRlZmluZWRcclxuICAgICAgICB9XHJcbiAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKFxyXG4gICAgICAgICAgZW5jb2Rlci5lbmNvZGUoY3JlYXRlU1NFTWVzc2FnZSh7XHJcbiAgICAgICAgICAgIHR5cGU6ICdwcm9ncmVzcycsXHJcbiAgICAgICAgICAgIC4uLmN1cnJlbnRQcm9ncmVzc1N0YXRlXHJcbiAgICAgICAgICB9KSlcclxuICAgICAgICApXHJcblxyXG4gICAgICAgIGNvbnN0IHZhbGlkYXRpb25SZXN1bHQgPSBjb250ZW50VmFsaWRhdG9yLnZhbGlkYXRlQ29udGVudChzb3VyY2VUZXh0KVxyXG4gICAgICAgIGlmICghdmFsaWRhdGlvblJlc3VsdC5pc1ZhbGlkKSB7XHJcbiAgICAgICAgICBjb25zdCBjbGFzc2lmaWVkRXJyb3IgPSBlcnJvckNsYXNzaWZpZXIuY2xhc3NpZnlFcnJvcihcclxuICAgICAgICAgICAgbmV3IEVycm9yKGBDb250ZW50IHZhbGlkYXRpb24gZmFpbGVkOiAke3ZhbGlkYXRpb25SZXN1bHQucmVhc29ufWApIGFzIEFJRXJyb3IsXHJcbiAgICAgICAgICAgIHJlcXVlc3RDb250ZXh0XHJcbiAgICAgICAgICApXHJcbiAgICAgICAgICBjb25zdCB1c2VyTWVzc2FnZSA9IGVycm9yQ2xhc3NpZmllci5nZW5lcmF0ZVVzZXJNZXNzYWdlKGNsYXNzaWZpZWRFcnJvcilcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKFxyXG4gICAgICAgICAgICBlbmNvZGVyLmVuY29kZShjcmVhdGVTU0VNZXNzYWdlKHtcclxuICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgIGVycm9yOiB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiB1c2VyTWVzc2FnZS50aXRsZSxcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHVzZXJNZXNzYWdlLm1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgICBlcnJvcklkOiB1c2VyTWVzc2FnZS5lcnJvcklkXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBwcm9ncmVzc1N0YXRlOiBjdXJyZW50UHJvZ3Jlc3NTdGF0ZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICAgIClcclxuICAgICAgICAgIGNvbnRyb2xsZXIuY2xvc2UoKVxyXG4gICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBWYWxpZGF0ZSBhdXRoZW50aWNhdGlvblxyXG4gICAgICAgIGN1cnJlbnRQcm9ncmVzc1N0YXRlID0ge1xyXG4gICAgICAgICAgc3RlcDogJ0F1dGhlbnRpY2F0aW5nLi4uJyxcclxuICAgICAgICAgIHByb2dyZXNzOiAxNSxcclxuICAgICAgICAgIHBoYXNlOiAnYXV0aGVudGljYXRpb24nLFxyXG4gICAgICAgICAgc2VjdGlvbjogdW5kZWZpbmVkXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShcclxuICAgICAgICAgIGVuY29kZXIuZW5jb2RlKGNyZWF0ZVNTRU1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICB0eXBlOiAncHJvZ3Jlc3MnLFxyXG4gICAgICAgICAgICAuLi5jdXJyZW50UHJvZ3Jlc3NTdGF0ZVxyXG4gICAgICAgICAgfSkpXHJcbiAgICAgICAgKVxyXG5cclxuICAgICAgICAvLyBHZXQgYXV0aCB0b2tlbiBmcm9tIHJlcXVlc3QgaGVhZGVyc1xyXG4gICAgICAgIGNvbnN0IGF1dGhIZWFkZXIgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdBdXRob3JpemF0aW9uJylcclxuICAgICAgICBcclxuICAgICAgICBpZiAoIWF1dGhIZWFkZXIpIHtcclxuICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShcclxuICAgICAgICAgICAgZW5jb2Rlci5lbmNvZGUoY3JlYXRlU1NFTWVzc2FnZSh7XHJcbiAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJyxcclxuICAgICAgICAgICAgICBlcnJvcjoge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogJ0FVVEhfRVJST1InLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkIC0gbm8gYXV0aG9yaXphdGlvbiBoZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgZXJyb3JJZDogYEFVVEhfJHtEYXRlLm5vdygpfWBcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIHByb2dyZXNzU3RhdGU6IGN1cnJlbnRQcm9ncmVzc1N0YXRlXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgICAgKVxyXG4gICAgICAgICAgY29udHJvbGxlci5jbG9zZSgpXHJcbiAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFZlcmlmeSB0aGUgdG9rZW4gYnkgY3JlYXRpbmcgYSBjbGllbnQgd2l0aCBpdFxyXG4gICAgICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KClcclxuICAgICAgICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIucmVwbGFjZSgnQmVhcmVyICcsICcnKVxyXG4gICAgICAgIGNvbnN0IHsgZGF0YTogeyB1c2VyIH0sIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcih0b2tlbilcclxuXHJcbiAgICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xyXG4gICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKFxyXG4gICAgICAgICAgICBlbmNvZGVyLmVuY29kZShjcmVhdGVTU0VNZXNzYWdlKHtcclxuICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgIGVycm9yOiB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiAnQVVUSF9FUlJPUicsXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnSW52YWxpZCBvciBleHBpcmVkIHRva2VuJyxcclxuICAgICAgICAgICAgICAgIGVycm9ySWQ6IGBBVVRIXyR7RGF0ZS5ub3coKX1gXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBwcm9ncmVzc1N0YXRlOiBjdXJyZW50UHJvZ3Jlc3NTdGF0ZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICAgIClcclxuICAgICAgICAgIGNvbnRyb2xsZXIuY2xvc2UoKVxyXG4gICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB1c2VySWQgPSB1c2VyLmlkXHJcblxyXG4gICAgICAgIC8vIENyZWF0ZSBwcm9ncmVzcyBjYWxsYmFjayB0aGF0IHN0cmVhbXMgcmVhbC10aW1lIHVwZGF0ZXMgdG8gZnJvbnRlbmRcclxuICAgICAgICBjb25zdCBwcm9ncmVzc0NhbGxiYWNrID0gKHVwZGF0ZToge1xyXG4gICAgICAgICAgc3RlcDogc3RyaW5nXHJcbiAgICAgICAgICBwcm9ncmVzczogbnVtYmVyXHJcbiAgICAgICAgICBwaGFzZTogc3RyaW5nXHJcbiAgICAgICAgICBzZWN0aW9uPzogc3RyaW5nXHJcbiAgICAgICAgfSkgPT4ge1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gVXBkYXRlIGN1cnJlbnQgcHJvZ3Jlc3Mgc3RhdGUgZm9yIGVycm9yIHJlcG9ydGluZ1xyXG4gICAgICAgICAgICBjdXJyZW50UHJvZ3Jlc3NTdGF0ZSA9IHtcclxuICAgICAgICAgICAgICBzdGVwOiB1cGRhdGUuc3RlcCxcclxuICAgICAgICAgICAgICBwcm9ncmVzczogdXBkYXRlLnByb2dyZXNzLFxyXG4gICAgICAgICAgICAgIHBoYXNlOiB1cGRhdGUucGhhc2UsXHJcbiAgICAgICAgICAgICAgc2VjdGlvbjogdXBkYXRlLnNlY3Rpb25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKFxyXG4gICAgICAgICAgICAgIGVuY29kZXIuZW5jb2RlKGNyZWF0ZVNTRU1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICAgICAgdHlwZTogJ3Byb2dyZXNzJyxcclxuICAgICAgICAgICAgICAgIC4uLmN1cnJlbnRQcm9ncmVzc1N0YXRlXHJcbiAgICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIC8vIExvZyBidXQgZG9uJ3QgdGhyb3cgLSBnZW5lcmF0aW9uIHNob3VsZCBjb250aW51ZSBldmVuIGlmIHN0cmVhbWluZyBmYWlsc1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc3RyZWFtIHByb2dyZXNzIHVwZGF0ZTonLCBlcnJvcilcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEdlbmVyYXRlIHRoZSBsZXNzb24gd2l0aCByZWFsLXRpbWUgcHJvZ3Jlc3MgY2FsbGJhY2tzXHJcbiAgICAgICAgY29uc3QgbGVzc29uID0gYXdhaXQgbGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3IuZ2VuZXJhdGVMZXNzb24oe1xyXG4gICAgICAgICAgc291cmNlVGV4dCxcclxuICAgICAgICAgIGxlc3NvblR5cGUsXHJcbiAgICAgICAgICBzdHVkZW50TGV2ZWwsXHJcbiAgICAgICAgICB0YXJnZXRMYW5ndWFnZSxcclxuICAgICAgICAgIHNvdXJjZVVybCxcclxuICAgICAgICAgIGNvbnRlbnRNZXRhZGF0YSxcclxuICAgICAgICAgIHN0cnVjdHVyZWRDb250ZW50LFxyXG4gICAgICAgICAgd29yZENvdW50LFxyXG4gICAgICAgICAgcmVhZGluZ1RpbWUsXHJcbiAgICAgICAgICBvblByb2dyZXNzOiBwcm9ncmVzc0NhbGxiYWNrXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy8gU2F2ZSB0byBkYXRhYmFzZVxyXG4gICAgICAgIGN1cnJlbnRQcm9ncmVzc1N0YXRlID0ge1xyXG4gICAgICAgICAgc3RlcDogJ1NhdmluZyBsZXNzb24uLi4nLFxyXG4gICAgICAgICAgcHJvZ3Jlc3M6IDk1LFxyXG4gICAgICAgICAgcGhhc2U6ICdzYXZpbmcnLFxyXG4gICAgICAgICAgc2VjdGlvbjogdW5kZWZpbmVkXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShcclxuICAgICAgICAgIGVuY29kZXIuZW5jb2RlKGNyZWF0ZVNTRU1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICB0eXBlOiAncHJvZ3Jlc3MnLFxyXG4gICAgICAgICAgICAuLi5jdXJyZW50UHJvZ3Jlc3NTdGF0ZVxyXG4gICAgICAgICAgfSkpXHJcbiAgICAgICAgKVxyXG5cclxuICAgICAgICBjb25zdCB7IGVycm9yOiBpbnNlcnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuZnJvbShcImxlc3NvbnNcIikuaW5zZXJ0KHtcclxuICAgICAgICAgIHVzZXJfaWQ6IHVzZXJJZCxcclxuICAgICAgICAgIGxlc3Nvbl90aXRsZTogbGVzc29uLmxlc3NvblRpdGxlLFxyXG4gICAgICAgICAgbGVzc29uX3R5cGU6IGxlc3NvblR5cGUsXHJcbiAgICAgICAgICBzdHVkZW50X2xldmVsOiBzdHVkZW50TGV2ZWwsXHJcbiAgICAgICAgICB0YXJnZXRfbGFuZ3VhZ2U6IHRhcmdldExhbmd1YWdlLFxyXG4gICAgICAgICAgbGVzc29uX2RhdGE6IGxlc3NvbixcclxuICAgICAgICAgIHNvdXJjZV91cmw6IHNvdXJjZVVybCxcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBpZiAoaW5zZXJ0RXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBzYXZpbmcgbGVzc29uOlwiLCBpbnNlcnRFcnJvcilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFNlbmQgY29tcGxldGlvblxyXG4gICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShcclxuICAgICAgICAgIGVuY29kZXIuZW5jb2RlKGNyZWF0ZVNTRU1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICB0eXBlOiAnY29tcGxldGUnLFxyXG4gICAgICAgICAgICBzdGVwOiAnTGVzc29uIGdlbmVyYXRlZCBzdWNjZXNzZnVsbHkhJyxcclxuICAgICAgICAgICAgcHJvZ3Jlc3M6IDEwMCxcclxuICAgICAgICAgICAgbGVzc29uXHJcbiAgICAgICAgICB9KSlcclxuICAgICAgICApXHJcblxyXG4gICAgICAgIGNvbnRyb2xsZXIuY2xvc2UoKVxyXG5cclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiU3RyZWFtaW5nIGVycm9yOlwiLCBlcnJvcilcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiUHJvZ3Jlc3Mgc3RhdGUgYXQgZXJyb3I6XCIsIGN1cnJlbnRQcm9ncmVzc1N0YXRlKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGNsYXNzaWZpZWRFcnJvciA9IGVycm9yQ2xhc3NpZmllci5jbGFzc2lmeUVycm9yKGVycm9yIGFzIEFJRXJyb3IsIHJlcXVlc3RDb250ZXh0KVxyXG4gICAgICAgIGNvbnN0IHVzZXJNZXNzYWdlID0gZXJyb3JDbGFzc2lmaWVyLmdlbmVyYXRlVXNlck1lc3NhZ2UoY2xhc3NpZmllZEVycm9yKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShcclxuICAgICAgICAgIGVuY29kZXIuZW5jb2RlKGNyZWF0ZVNTRU1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICBlcnJvcjoge1xyXG4gICAgICAgICAgICAgIHR5cGU6IHVzZXJNZXNzYWdlLnRpdGxlLFxyXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IHVzZXJNZXNzYWdlLm1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgZXJyb3JJZDogdXNlck1lc3NhZ2UuZXJyb3JJZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBwcm9ncmVzc1N0YXRlOiBjdXJyZW50UHJvZ3Jlc3NTdGF0ZVxyXG4gICAgICAgICAgfSkpXHJcbiAgICAgICAgKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnRyb2xsZXIuY2xvc2UoKVxyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gIH0pXHJcblxyXG4gIHJldHVybiBuZXcgUmVzcG9uc2Uoc3RyZWFtLCB7XHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICdDb250ZW50LVR5cGUnOiAndGV4dC9ldmVudC1zdHJlYW0nLFxyXG4gICAgICAnQ2FjaGUtQ29udHJvbCc6ICduby1jYWNoZScsXHJcbiAgICAgICdDb25uZWN0aW9uJzogJ2tlZXAtYWxpdmUnLFxyXG4gICAgfSxcclxuICB9KVxyXG59XHJcbiJdLCJuYW1lcyI6WyJsZXNzb25BSVNlcnZlckdlbmVyYXRvciIsImNyZWF0ZUNsaWVudCIsImNvbnRlbnRWYWxpZGF0b3IiLCJlcnJvckNsYXNzaWZpZXIiLCJjcmVhdGVTU0VNZXNzYWdlIiwiZGF0YSIsIkpTT04iLCJzdHJpbmdpZnkiLCJQT1NUIiwicmVxdWVzdCIsImVuY29kZXIiLCJUZXh0RW5jb2RlciIsInVzZXJJZCIsInJlcXVlc3RDb250ZXh0IiwiY3VycmVudFByb2dyZXNzU3RhdGUiLCJzdGVwIiwicHJvZ3Jlc3MiLCJwaGFzZSIsInNlY3Rpb24iLCJ1bmRlZmluZWQiLCJzdHJlYW0iLCJSZWFkYWJsZVN0cmVhbSIsInN0YXJ0IiwiY29udHJvbGxlciIsImJvZHkiLCJqc29uIiwic291cmNlVGV4dCIsImxlc3NvblR5cGUiLCJzdHVkZW50TGV2ZWwiLCJ0YXJnZXRMYW5ndWFnZSIsInNvdXJjZVVybCIsImNvbnRlbnRNZXRhZGF0YSIsInN0cnVjdHVyZWRDb250ZW50Iiwid29yZENvdW50IiwicmVhZGluZ1RpbWUiLCJjb250ZW50TGVuZ3RoIiwibGVuZ3RoIiwiYXBpRW5kcG9pbnQiLCJlbnF1ZXVlIiwiZW5jb2RlIiwidHlwZSIsImVycm9yIiwibWVzc2FnZSIsImVycm9ySWQiLCJEYXRlIiwibm93IiwicHJvZ3Jlc3NTdGF0ZSIsImNsb3NlIiwidmFsaWRhdGlvblJlc3VsdCIsInZhbGlkYXRlQ29udGVudCIsImlzVmFsaWQiLCJjbGFzc2lmaWVkRXJyb3IiLCJjbGFzc2lmeUVycm9yIiwiRXJyb3IiLCJyZWFzb24iLCJ1c2VyTWVzc2FnZSIsImdlbmVyYXRlVXNlck1lc3NhZ2UiLCJ0aXRsZSIsImF1dGhIZWFkZXIiLCJoZWFkZXJzIiwiZ2V0Iiwic3VwYWJhc2UiLCJ0b2tlbiIsInJlcGxhY2UiLCJ1c2VyIiwiYXV0aEVycm9yIiwiYXV0aCIsImdldFVzZXIiLCJpZCIsInByb2dyZXNzQ2FsbGJhY2siLCJ1cGRhdGUiLCJjb25zb2xlIiwibGVzc29uIiwiZ2VuZXJhdGVMZXNzb24iLCJvblByb2dyZXNzIiwiaW5zZXJ0RXJyb3IiLCJmcm9tIiwiaW5zZXJ0IiwidXNlcl9pZCIsImxlc3Nvbl90aXRsZSIsImxlc3NvblRpdGxlIiwibGVzc29uX3R5cGUiLCJzdHVkZW50X2xldmVsIiwidGFyZ2V0X2xhbmd1YWdlIiwibGVzc29uX2RhdGEiLCJzb3VyY2VfdXJsIiwiUmVzcG9uc2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/generate-lesson-stream/route.ts\n");

/***/ }),

/***/ "(rsc)/./app/layout.tsx":
/*!************************!*\
  !*** ./app/layout.tsx ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ RootLayout),\n/* harmony export */   metadata: () => (/* binding */ metadata)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/rsc/react-jsx-dev-runtime.js\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_font_google_target_css_path_app_layout_tsx_import_Inter_arguments_variable_font_inter_subsets_latin_variableName_inter___WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/font/google/target.css?{\"path\":\"app\\\\layout.tsx\",\"import\":\"Inter\",\"arguments\":[{\"variable\":\"--font-inter\",\"subsets\":[\"latin\"]}],\"variableName\":\"inter\"} */ \"(rsc)/./node_modules/next/font/google/target.css?{\\\"path\\\":\\\"app\\\\\\\\layout.tsx\\\",\\\"import\\\":\\\"Inter\\\",\\\"arguments\\\":[{\\\"variable\\\":\\\"--font-inter\\\",\\\"subsets\\\":[\\\"latin\\\"]}],\\\"variableName\\\":\\\"inter\\\"}\");\n/* harmony import */ var next_font_google_target_css_path_app_layout_tsx_import_Inter_arguments_variable_font_inter_subsets_latin_variableName_inter___WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_font_google_target_css_path_app_layout_tsx_import_Inter_arguments_variable_font_inter_subsets_latin_variableName_inter___WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_font_google_target_css_path_app_layout_tsx_import_JetBrains_Mono_arguments_variable_font_jetbrains_mono_subsets_latin_variableName_jetbrainsMono___WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/font/google/target.css?{\"path\":\"app\\\\layout.tsx\",\"import\":\"JetBrains_Mono\",\"arguments\":[{\"variable\":\"--font-jetbrains-mono\",\"subsets\":[\"latin\"]}],\"variableName\":\"jetbrainsMono\"} */ \"(rsc)/./node_modules/next/font/google/target.css?{\\\"path\\\":\\\"app\\\\\\\\layout.tsx\\\",\\\"import\\\":\\\"JetBrains_Mono\\\",\\\"arguments\\\":[{\\\"variable\\\":\\\"--font-jetbrains-mono\\\",\\\"subsets\\\":[\\\"latin\\\"]}],\\\"variableName\\\":\\\"jetbrainsMono\\\"}\");\n/* harmony import */ var next_font_google_target_css_path_app_layout_tsx_import_JetBrains_Mono_arguments_variable_font_jetbrains_mono_subsets_latin_variableName_jetbrainsMono___WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_font_google_target_css_path_app_layout_tsx_import_JetBrains_Mono_arguments_variable_font_jetbrains_mono_subsets_latin_variableName_jetbrainsMono___WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_font_google_target_css_path_app_layout_tsx_import_Merriweather_arguments_variable_font_serif_subsets_latin_weight_300_400_700_900_variableName_merriweather___WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/font/google/target.css?{\"path\":\"app\\\\layout.tsx\",\"import\":\"Merriweather\",\"arguments\":[{\"variable\":\"--font-serif\",\"subsets\":[\"latin\"],\"weight\":[\"300\",\"400\",\"700\",\"900\"]}],\"variableName\":\"merriweather\"} */ \"(rsc)/./node_modules/next/font/google/target.css?{\\\"path\\\":\\\"app\\\\\\\\layout.tsx\\\",\\\"import\\\":\\\"Merriweather\\\",\\\"arguments\\\":[{\\\"variable\\\":\\\"--font-serif\\\",\\\"subsets\\\":[\\\"latin\\\"],\\\"weight\\\":[\\\"300\\\",\\\"400\\\",\\\"700\\\",\\\"900\\\"]}],\\\"variableName\\\":\\\"merriweather\\\"}\");\n/* harmony import */ var next_font_google_target_css_path_app_layout_tsx_import_Merriweather_arguments_variable_font_serif_subsets_latin_weight_300_400_700_900_variableName_merriweather___WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_font_google_target_css_path_app_layout_tsx_import_Merriweather_arguments_variable_font_serif_subsets_latin_weight_300_400_700_900_variableName_merriweather___WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_font_google_target_css_path_app_layout_tsx_import_Lora_arguments_variable_font_serif_alt_subsets_latin_weight_400_500_600_700_variableName_lora___WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/font/google/target.css?{\"path\":\"app\\\\layout.tsx\",\"import\":\"Lora\",\"arguments\":[{\"variable\":\"--font-serif-alt\",\"subsets\":[\"latin\"],\"weight\":[\"400\",\"500\",\"600\",\"700\"]}],\"variableName\":\"lora\"} */ \"(rsc)/./node_modules/next/font/google/target.css?{\\\"path\\\":\\\"app\\\\\\\\layout.tsx\\\",\\\"import\\\":\\\"Lora\\\",\\\"arguments\\\":[{\\\"variable\\\":\\\"--font-serif-alt\\\",\\\"subsets\\\":[\\\"latin\\\"],\\\"weight\\\":[\\\"400\\\",\\\"500\\\",\\\"600\\\",\\\"700\\\"]}],\\\"variableName\\\":\\\"lora\\\"}\");\n/* harmony import */ var next_font_google_target_css_path_app_layout_tsx_import_Lora_arguments_variable_font_serif_alt_subsets_latin_weight_400_500_600_700_variableName_lora___WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_font_google_target_css_path_app_layout_tsx_import_Lora_arguments_variable_font_serif_alt_subsets_latin_weight_400_500_600_700_variableName_lora___WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _globals_css__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./globals.css */ \"(rsc)/./app/globals.css\");\n/* harmony import */ var _components_auth_wrapper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/components/auth-wrapper */ \"(rsc)/./components/auth-wrapper.tsx\");\n\n\n\n\n\n\n\nfunction RootLayout({ children }) {\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"html\", {\n        lang: \"en\",\n        className: `${(next_font_google_target_css_path_app_layout_tsx_import_Inter_arguments_variable_font_inter_subsets_latin_variableName_inter___WEBPACK_IMPORTED_MODULE_3___default().variable)} ${(next_font_google_target_css_path_app_layout_tsx_import_JetBrains_Mono_arguments_variable_font_jetbrains_mono_subsets_latin_variableName_jetbrainsMono___WEBPACK_IMPORTED_MODULE_4___default().variable)} ${(next_font_google_target_css_path_app_layout_tsx_import_Merriweather_arguments_variable_font_serif_subsets_latin_weight_300_400_700_900_variableName_merriweather___WEBPACK_IMPORTED_MODULE_5___default().variable)} ${(next_font_google_target_css_path_app_layout_tsx_import_Lora_arguments_variable_font_serif_alt_subsets_latin_weight_400_500_600_700_variableName_lora___WEBPACK_IMPORTED_MODULE_6___default().variable)} antialiased`,\n        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"body\", {\n            className: \"min-h-screen bg-vintage-cream font-sans antialiased\",\n            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_auth_wrapper__WEBPACK_IMPORTED_MODULE_2__[\"default\"], {\n                children: children\n            }, void 0, false, {\n                fileName: \"D:\\\\linguaspark\\\\app\\\\layout.tsx\",\n                lineNumber: 36,\n                columnNumber: 9\n            }, this)\n        }, void 0, false, {\n            fileName: \"D:\\\\linguaspark\\\\app\\\\layout.tsx\",\n            lineNumber: 35,\n            columnNumber: 7\n        }, this)\n    }, void 0, false, {\n        fileName: \"D:\\\\linguaspark\\\\app\\\\layout.tsx\",\n        lineNumber: 34,\n        columnNumber: 5\n    }, this);\n}\nconst metadata = {\n    generator: \"v0.app\"\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvbGF5b3V0LnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFLTUE7QUFLQUM7QUFLQUM7QUFNQUM7QUFuQmdCO0FBQzZCO0FBd0JwQyxTQUFTRSxXQUFXLEVBQ2pDQyxRQUFRLEVBR1Q7SUFDQyxxQkFDRSw4REFBQ0M7UUFBS0MsTUFBSztRQUFLQyxXQUFXLENBQUMsRUFBRVQsOEtBQWMsQ0FBQyxDQUFDLEVBQUVDLHdNQUFzQixDQUFDLENBQUMsRUFBRUMsbU5BQXFCLENBQUMsQ0FBQyxFQUFFQyx1TUFBYSxDQUFDLFlBQVksQ0FBQztrQkFDNUgsNEVBQUNRO1lBQUtGLFdBQVU7c0JBQ2QsNEVBQUNMLGdFQUFXQTswQkFBRUU7Ozs7Ozs7Ozs7Ozs7Ozs7QUFJdEI7QUFFTyxNQUFNTSxXQUFXO0lBQ2xCQyxXQUFXO0FBQ2IsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvLi9hcHAvbGF5b3V0LnRzeD85OTg4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIFJlYWN0IGZyb20gXCJyZWFjdFwiXG5pbXBvcnQgeyBJbnRlciwgSmV0QnJhaW5zX01vbm8sIE1lcnJpd2VhdGhlciwgTG9yYSB9IGZyb20gXCJuZXh0L2ZvbnQvZ29vZ2xlXCJcbmltcG9ydCBcIi4vZ2xvYmFscy5jc3NcIlxuaW1wb3J0IEF1dGhXcmFwcGVyIGZyb20gXCJAL2NvbXBvbmVudHMvYXV0aC13cmFwcGVyXCJcblxuY29uc3QgaW50ZXIgPSBJbnRlcih7XG4gIHZhcmlhYmxlOiBcIi0tZm9udC1pbnRlclwiLFxuICBzdWJzZXRzOiBbXCJsYXRpblwiXSxcbn0pXG5cbmNvbnN0IGpldGJyYWluc01vbm8gPSBKZXRCcmFpbnNfTW9ubyh7XG4gIHZhcmlhYmxlOiBcIi0tZm9udC1qZXRicmFpbnMtbW9ub1wiLFxuICBzdWJzZXRzOiBbXCJsYXRpblwiXSxcbn0pXG5cbmNvbnN0IG1lcnJpd2VhdGhlciA9IE1lcnJpd2VhdGhlcih7XG4gIHZhcmlhYmxlOiBcIi0tZm9udC1zZXJpZlwiLFxuICBzdWJzZXRzOiBbXCJsYXRpblwiXSxcbiAgd2VpZ2h0OiBbXCIzMDBcIiwgXCI0MDBcIiwgXCI3MDBcIiwgXCI5MDBcIl0sXG59KVxuXG5jb25zdCBsb3JhID0gTG9yYSh7XG4gIHZhcmlhYmxlOiBcIi0tZm9udC1zZXJpZi1hbHRcIixcbiAgc3Vic2V0czogW1wibGF0aW5cIl0sXG4gIHdlaWdodDogW1wiNDAwXCIsIFwiNTAwXCIsIFwiNjAwXCIsIFwiNzAwXCJdLFxufSlcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gUm9vdExheW91dCh7XG4gIGNoaWxkcmVuLFxufToge1xuICBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlXG59KSB7XG4gIHJldHVybiAoXG4gICAgPGh0bWwgbGFuZz1cImVuXCIgY2xhc3NOYW1lPXtgJHtpbnRlci52YXJpYWJsZX0gJHtqZXRicmFpbnNNb25vLnZhcmlhYmxlfSAke21lcnJpd2VhdGhlci52YXJpYWJsZX0gJHtsb3JhLnZhcmlhYmxlfSBhbnRpYWxpYXNlZGB9PlxuICAgICAgPGJvZHkgY2xhc3NOYW1lPVwibWluLWgtc2NyZWVuIGJnLXZpbnRhZ2UtY3JlYW0gZm9udC1zYW5zIGFudGlhbGlhc2VkXCI+XG4gICAgICAgIDxBdXRoV3JhcHBlcj57Y2hpbGRyZW59PC9BdXRoV3JhcHBlcj5cbiAgICAgIDwvYm9keT5cbiAgICA8L2h0bWw+XG4gIClcbn1cblxuZXhwb3J0IGNvbnN0IG1ldGFkYXRhID0ge1xuICAgICAgZ2VuZXJhdG9yOiAndjAuYXBwJ1xuICAgIH07XG4iXSwibmFtZXMiOlsiaW50ZXIiLCJqZXRicmFpbnNNb25vIiwibWVycml3ZWF0aGVyIiwibG9yYSIsIkF1dGhXcmFwcGVyIiwiUm9vdExheW91dCIsImNoaWxkcmVuIiwiaHRtbCIsImxhbmciLCJjbGFzc05hbWUiLCJ2YXJpYWJsZSIsImJvZHkiLCJtZXRhZGF0YSIsImdlbmVyYXRvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/layout.tsx\n");

/***/ }),

/***/ "(rsc)/./components/auth-wrapper.tsx":
/*!*************************************!*\
  !*** ./components/auth-wrapper.tsx ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AuthProvider: () => (/* binding */ e1),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),
/* harmony export */   useAuth: () => (/* binding */ e0)
/* harmony export */ });
/* harmony import */ var next_dist_build_webpack_loaders_next_flight_loader_module_proxy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/build/webpack/loaders/next-flight-loader/module-proxy */ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/module-proxy.js");


const e0 = (0,next_dist_build_webpack_loaders_next_flight_loader_module_proxy__WEBPACK_IMPORTED_MODULE_0__.createProxy)(String.raw`D:\linguaspark\components\auth-wrapper.tsx#useAuth`);

const e1 = (0,next_dist_build_webpack_loaders_next_flight_loader_module_proxy__WEBPACK_IMPORTED_MODULE_0__.createProxy)(String.raw`D:\linguaspark\components\auth-wrapper.tsx#AuthProvider`);
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_webpack_loaders_next_flight_loader_module_proxy__WEBPACK_IMPORTED_MODULE_0__.createProxy)(String.raw`D:\linguaspark\components\auth-wrapper.tsx#default`));


/***/ }),

/***/ "(rsc)/./lib/content-validator.ts":
/*!**********************************!*\
  !*** ./lib/content-validator.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ContentValidatorImpl: () => (/* binding */ ContentValidatorImpl),\n/* harmony export */   contentValidator: () => (/* binding */ contentValidator)\n/* harmony export */ });\n/**\r\n * Content Validation Service\r\n * \r\n * Ensures source content meets minimum requirements for AI processing\r\n * before attempting lesson generation.\r\n */ class ContentValidatorImpl {\n    /**\r\n   * Validates content for AI lesson generation suitability\r\n   */ validateContent(content) {\n        // Basic sanitization and preparation\n        const cleanContent = this.sanitizeContent(content);\n        if (!cleanContent || cleanContent.trim().length === 0) {\n            return {\n                isValid: false,\n                reason: \"No content provided\",\n                suggestions: [\n                    \"Please select or paste some text content to generate a lesson from\"\n                ]\n            };\n        }\n        // Check minimum word count\n        const wordCount = this.getWordCount(cleanContent);\n        if (wordCount < this.MINIMUM_WORD_COUNT) {\n            return {\n                isValid: false,\n                reason: `Content too short (${wordCount} words, minimum ${this.MINIMUM_WORD_COUNT} required)`,\n                suggestions: [\n                    \"Select more text from the webpage\",\n                    \"Choose a longer article or passage\",\n                    \"Combine multiple paragraphs for better lesson content\"\n                ]\n            };\n        }\n        // Check sentence count\n        const sentenceCount = this.getSentenceCount(cleanContent);\n        if (sentenceCount < this.MINIMUM_SENTENCE_COUNT) {\n            return {\n                isValid: false,\n                reason: `Content lacks structure (${sentenceCount} sentences, minimum ${this.MINIMUM_SENTENCE_COUNT} required)`,\n                suggestions: [\n                    \"Select content with complete sentences\",\n                    \"Choose text with proper punctuation\",\n                    \"Avoid selecting only titles or bullet points\"\n                ]\n            };\n        }\n        // Check content quality\n        const qualityScore = this.checkContentQuality(cleanContent);\n        if (qualityScore.score < this.MINIMUM_QUALITY_SCORE) {\n            return {\n                isValid: false,\n                reason: `Content quality insufficient for lesson generation (score: ${qualityScore.score}/100)`,\n                suggestions: this.getQualityImprovementSuggestions(qualityScore)\n            };\n        }\n        return {\n            isValid: true\n        };\n    }\n    /**\r\n   * Returns the minimum word count required for content validation\r\n   */ getMinimumWordCount() {\n        return this.MINIMUM_WORD_COUNT;\n    }\n    /**\r\n   * Analyzes content quality and returns a detailed score\r\n   */ checkContentQuality(content) {\n        const cleanContent = this.sanitizeContent(content);\n        const words = this.getWords(cleanContent);\n        const sentences = this.getSentences(cleanContent);\n        const wordCount = words.length;\n        const sentenceCount = sentences.length;\n        const averageWordsPerSentence = sentenceCount > 0 ? wordCount / sentenceCount : 0;\n        // Check vocabulary variety (unique words vs total words)\n        const uniqueWords = new Set(words.map((word)=>word.toLowerCase()));\n        const vocabularyVariety = uniqueWords.size / wordCount;\n        const hasVariedVocabulary = vocabularyVariety > 0.4; // At least 40% unique words\n        // Check for complete thoughts (sentences ending with proper punctuation)\n        const completeThoughts = sentences.filter((sentence)=>/[.!?]$/.test(sentence.trim())).length;\n        const hasCompleteThoughts = completeThoughts / sentenceCount > 0.7; // 70% complete sentences\n        // Calculate overall quality score\n        let score = 0;\n        // Word count factor (0-30 points)\n        if (wordCount >= this.MINIMUM_WORD_COUNT) {\n            score += Math.min(30, wordCount / 200 * 30); // Max points at 200 words\n        }\n        // Sentence structure factor (0-25 points)\n        if (averageWordsPerSentence >= 8 && averageWordsPerSentence <= 25) {\n            score += 25; // Good sentence length\n        } else if (averageWordsPerSentence >= 5) {\n            score += 15; // Acceptable sentence length\n        }\n        // Vocabulary variety factor (0-25 points)\n        if (hasVariedVocabulary) {\n            score += 25;\n        } else if (vocabularyVariety > 0.25) {\n            score += 15;\n        }\n        // Complete thoughts factor (0-20 points)\n        if (hasCompleteThoughts) {\n            score += 20;\n        } else if (completeThoughts / sentenceCount > 0.5) {\n            score += 10;\n        }\n        return {\n            score: Math.round(score),\n            factors: {\n                wordCount,\n                sentenceCount,\n                averageWordsPerSentence: Math.round(averageWordsPerSentence * 10) / 10,\n                hasVariedVocabulary,\n                hasCompleteThoughts\n            }\n        };\n    }\n    /**\r\n   * Sanitizes content by removing excessive whitespace and non-text elements\r\n   */ sanitizeContent(content) {\n        return content.replace(/\\s+/g, \" \") // Replace multiple whitespace with single space\n        .replace(/[^\\w\\s.,!?;:'\"()-]/g, \"\") // Remove special characters except basic punctuation\n        .trim();\n    }\n    /**\r\n   * Counts words in the content\r\n   */ getWordCount(content) {\n        return this.getWords(content).length;\n    }\n    /**\r\n   * Gets array of words from content\r\n   */ getWords(content) {\n        return content.split(/\\s+/).filter((word)=>word.length > 0 && /\\w/.test(word));\n    }\n    /**\r\n   * Counts sentences in the content\r\n   */ getSentenceCount(content) {\n        return this.getSentences(content).length;\n    }\n    /**\r\n   * Gets array of sentences from content\r\n   */ getSentences(content) {\n        return content.split(/[.!?]+/).map((sentence)=>sentence.trim()).filter((sentence)=>sentence.length > 0);\n    }\n    /**\r\n   * Generates improvement suggestions based on quality score factors\r\n   */ getQualityImprovementSuggestions(qualityScore) {\n        const suggestions = [];\n        if (qualityScore.factors.wordCount < 100) {\n            suggestions.push(\"Select longer content with more detailed information\");\n        }\n        if (qualityScore.factors.averageWordsPerSentence < 8) {\n            suggestions.push(\"Choose content with more complex, complete sentences\");\n        }\n        if (!qualityScore.factors.hasVariedVocabulary) {\n            suggestions.push(\"Select content with more diverse vocabulary and topics\");\n        }\n        if (!qualityScore.factors.hasCompleteThoughts) {\n            suggestions.push(\"Choose well-structured text with proper punctuation\");\n        }\n        if (suggestions.length === 0) {\n            suggestions.push(\"Try selecting different content that is more suitable for language learning\");\n        }\n        return suggestions;\n    }\n    constructor(){\n        this.MINIMUM_WORD_COUNT = 50;\n        this.MINIMUM_SENTENCE_COUNT = 3;\n        this.MINIMUM_QUALITY_SCORE = 60;\n    }\n}\n// Export singleton instance\nconst contentValidator = new ContentValidatorImpl();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNoRCxPQUFPLElBQUksQ0FBQ3VCLFlBQVksQ0FBQ3ZCLFNBQVNJLE1BQU07SUFDMUM7SUFFQTs7R0FFQyxHQUNELGFBQXFCSixPQUFlLEVBQVk7UUFDOUMsT0FBT0EsUUFDSjJDLEtBQUssQ0FBQyxVQUNOaEIsR0FBRyxDQUFDUSxDQUFBQSxXQUFZQSxTQUFTaEMsSUFBSSxJQUM3QitCLE1BQU0sQ0FBQ0MsQ0FBQUEsV0FBWUEsU0FBUy9CLE1BQU0sR0FBRztJQUMxQztJQUVBOztHQUVDLEdBQ0QsaUNBQXlDVSxZQUEwQixFQUFZO1FBQzdFLE1BQU1QLGNBQXdCLEVBQUU7UUFFaEMsSUFBSU8sYUFBYTJCLE9BQU8sQ0FBQ2pDLFNBQVMsR0FBRyxLQUFLO1lBQ3hDRCxZQUFZcUMsSUFBSSxDQUFDO1FBQ25CO1FBRUEsSUFBSTlCLGFBQWEyQixPQUFPLENBQUNqQix1QkFBdUIsR0FBRyxHQUFHO1lBQ3BEakIsWUFBWXFDLElBQUksQ0FBQztRQUNuQjtRQUVBLElBQUksQ0FBQzlCLGFBQWEyQixPQUFPLENBQUNULG1CQUFtQixFQUFFO1lBQzdDekIsWUFBWXFDLElBQUksQ0FBQztRQUNuQjtRQUVBLElBQUksQ0FBQzlCLGFBQWEyQixPQUFPLENBQUNKLG1CQUFtQixFQUFFO1lBQzdDOUIsWUFBWXFDLElBQUksQ0FBQztRQUNuQjtRQUVBLElBQUlyQyxZQUFZSCxNQUFNLEtBQUssR0FBRztZQUM1QkcsWUFBWXFDLElBQUksQ0FBQztRQUNuQjtRQUVBLE9BQU9yQztJQUNUOzthQTNNaUJHLHFCQUFxQjthQUNyQkcseUJBQXlCO2FBQ3pCSSx3QkFBd0I7O0FBME0zQztBQUVBLDRCQUE0QjtBQUNyQixNQUFNNEIsbUJBQW1CLElBQUkvQyx1QkFBdUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL2NvbnRlbnQtdmFsaWRhdG9yLnRzP2ZhNTUiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENvbnRlbnQgVmFsaWRhdGlvbiBTZXJ2aWNlXHJcbiAqIFxyXG4gKiBFbnN1cmVzIHNvdXJjZSBjb250ZW50IG1lZXRzIG1pbmltdW0gcmVxdWlyZW1lbnRzIGZvciBBSSBwcm9jZXNzaW5nXHJcbiAqIGJlZm9yZSBhdHRlbXB0aW5nIGxlc3NvbiBnZW5lcmF0aW9uLlxyXG4gKi9cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgaXNWYWxpZDogYm9vbGVhbjtcclxuICByZWFzb24/OiBzdHJpbmc7XHJcbiAgc3VnZ2VzdGlvbnM/OiBzdHJpbmdbXTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBRdWFsaXR5U2NvcmUge1xyXG4gIHNjb3JlOiBudW1iZXI7IC8vIDAtMTAwXHJcbiAgZmFjdG9yczoge1xyXG4gICAgd29yZENvdW50OiBudW1iZXI7XHJcbiAgICBzZW50ZW5jZUNvdW50OiBudW1iZXI7XHJcbiAgICBhdmVyYWdlV29yZHNQZXJTZW50ZW5jZTogbnVtYmVyO1xyXG4gICAgaGFzVmFyaWVkVm9jYWJ1bGFyeTogYm9vbGVhbjtcclxuICAgIGhhc0NvbXBsZXRlVGhvdWdodHM6IGJvb2xlYW47XHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDb250ZW50VmFsaWRhdG9yIHtcclxuICB2YWxpZGF0ZUNvbnRlbnQoY29udGVudDogc3RyaW5nKTogVmFsaWRhdGlvblJlc3VsdDtcclxuICBnZXRNaW5pbXVtV29yZENvdW50KCk6IG51bWJlcjtcclxuICBjaGVja0NvbnRlbnRRdWFsaXR5KGNvbnRlbnQ6IHN0cmluZyk6IFF1YWxpdHlTY29yZTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIENvbnRlbnRWYWxpZGF0b3JJbXBsIGltcGxlbWVudHMgQ29udGVudFZhbGlkYXRvciB7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBNSU5JTVVNX1dPUkRfQ09VTlQgPSA1MDtcclxuICBwcml2YXRlIHJlYWRvbmx5IE1JTklNVU1fU0VOVEVOQ0VfQ09VTlQgPSAzO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgTUlOSU1VTV9RVUFMSVRZX1NDT1JFID0gNjA7XHJcblxyXG4gIC8qKlxyXG4gICAqIFZhbGlkYXRlcyBjb250ZW50IGZvciBBSSBsZXNzb24gZ2VuZXJhdGlvbiBzdWl0YWJpbGl0eVxyXG4gICAqL1xyXG4gIHZhbGlkYXRlQ29udGVudChjb250ZW50OiBzdHJpbmcpOiBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICAgIC8vIEJhc2ljIHNhbml0aXphdGlvbiBhbmQgcHJlcGFyYXRpb25cclxuICAgIGNvbnN0IGNsZWFuQ29udGVudCA9IHRoaXMuc2FuaXRpemVDb250ZW50KGNvbnRlbnQpO1xyXG4gICAgXHJcbiAgICBpZiAoIWNsZWFuQ29udGVudCB8fCBjbGVhbkNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICAgIHJlYXNvbjogXCJObyBjb250ZW50IHByb3ZpZGVkXCIsXHJcbiAgICAgICAgc3VnZ2VzdGlvbnM6IFtcIlBsZWFzZSBzZWxlY3Qgb3IgcGFzdGUgc29tZSB0ZXh0IGNvbnRlbnQgdG8gZ2VuZXJhdGUgYSBsZXNzb24gZnJvbVwiXVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIG1pbmltdW0gd29yZCBjb3VudFxyXG4gICAgY29uc3Qgd29yZENvdW50ID0gdGhpcy5nZXRXb3JkQ291bnQoY2xlYW5Db250ZW50KTtcclxuICAgIGlmICh3b3JkQ291bnQgPCB0aGlzLk1JTklNVU1fV09SRF9DT1VOVCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICAgIHJlYXNvbjogYENvbnRlbnQgdG9vIHNob3J0ICgke3dvcmRDb3VudH0gd29yZHMsIG1pbmltdW0gJHt0aGlzLk1JTklNVU1fV09SRF9DT1VOVH0gcmVxdWlyZWQpYCxcclxuICAgICAgICBzdWdnZXN0aW9uczogW1xyXG4gICAgICAgICAgXCJTZWxlY3QgbW9yZSB0ZXh0IGZyb20gdGhlIHdlYnBhZ2VcIixcclxuICAgICAgICAgIFwiQ2hvb3NlIGEgbG9uZ2VyIGFydGljbGUgb3IgcGFzc2FnZVwiLFxyXG4gICAgICAgICAgXCJDb21iaW5lIG11bHRpcGxlIHBhcmFncmFwaHMgZm9yIGJldHRlciBsZXNzb24gY29udGVudFwiXHJcbiAgICAgICAgXVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIHNlbnRlbmNlIGNvdW50XHJcbiAgICBjb25zdCBzZW50ZW5jZUNvdW50ID0gdGhpcy5nZXRTZW50ZW5jZUNvdW50KGNsZWFuQ29udGVudCk7XHJcbiAgICBpZiAoc2VudGVuY2VDb3VudCA8IHRoaXMuTUlOSU1VTV9TRU5URU5DRV9DT1VOVCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICAgIHJlYXNvbjogYENvbnRlbnQgbGFja3Mgc3RydWN0dXJlICgke3NlbnRlbmNlQ291bnR9IHNlbnRlbmNlcywgbWluaW11bSAke3RoaXMuTUlOSU1VTV9TRU5URU5DRV9DT1VOVH0gcmVxdWlyZWQpYCxcclxuICAgICAgICBzdWdnZXN0aW9uczogW1xyXG4gICAgICAgICAgXCJTZWxlY3QgY29udGVudCB3aXRoIGNvbXBsZXRlIHNlbnRlbmNlc1wiLFxyXG4gICAgICAgICAgXCJDaG9vc2UgdGV4dCB3aXRoIHByb3BlciBwdW5jdHVhdGlvblwiLFxyXG4gICAgICAgICAgXCJBdm9pZCBzZWxlY3Rpbmcgb25seSB0aXRsZXMgb3IgYnVsbGV0IHBvaW50c1wiXHJcbiAgICAgICAgXVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGNvbnRlbnQgcXVhbGl0eVxyXG4gICAgY29uc3QgcXVhbGl0eVNjb3JlID0gdGhpcy5jaGVja0NvbnRlbnRRdWFsaXR5KGNsZWFuQ29udGVudCk7XHJcbiAgICBpZiAocXVhbGl0eVNjb3JlLnNjb3JlIDwgdGhpcy5NSU5JTVVNX1FVQUxJVFlfU0NPUkUpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcclxuICAgICAgICByZWFzb246IGBDb250ZW50IHF1YWxpdHkgaW5zdWZmaWNpZW50IGZvciBsZXNzb24gZ2VuZXJhdGlvbiAoc2NvcmU6ICR7cXVhbGl0eVNjb3JlLnNjb3JlfS8xMDApYCxcclxuICAgICAgICBzdWdnZXN0aW9uczogdGhpcy5nZXRRdWFsaXR5SW1wcm92ZW1lbnRTdWdnZXN0aW9ucyhxdWFsaXR5U2NvcmUpXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXNWYWxpZDogdHJ1ZVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdGhlIG1pbmltdW0gd29yZCBjb3VudCByZXF1aXJlZCBmb3IgY29udGVudCB2YWxpZGF0aW9uXHJcbiAgICovXHJcbiAgZ2V0TWluaW11bVdvcmRDb3VudCgpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuTUlOSU1VTV9XT1JEX0NPVU5UO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQW5hbHl6ZXMgY29udGVudCBxdWFsaXR5IGFuZCByZXR1cm5zIGEgZGV0YWlsZWQgc2NvcmVcclxuICAgKi9cclxuICBjaGVja0NvbnRlbnRRdWFsaXR5KGNvbnRlbnQ6IHN0cmluZyk6IFF1YWxpdHlTY29yZSB7XHJcbiAgICBjb25zdCBjbGVhbkNvbnRlbnQgPSB0aGlzLnNhbml0aXplQ29udGVudChjb250ZW50KTtcclxuICAgIGNvbnN0IHdvcmRzID0gdGhpcy5nZXRXb3JkcyhjbGVhbkNvbnRlbnQpO1xyXG4gICAgY29uc3Qgc2VudGVuY2VzID0gdGhpcy5nZXRTZW50ZW5jZXMoY2xlYW5Db250ZW50KTtcclxuICAgIFxyXG4gICAgY29uc3Qgd29yZENvdW50ID0gd29yZHMubGVuZ3RoO1xyXG4gICAgY29uc3Qgc2VudGVuY2VDb3VudCA9IHNlbnRlbmNlcy5sZW5ndGg7XHJcbiAgICBjb25zdCBhdmVyYWdlV29yZHNQZXJTZW50ZW5jZSA9IHNlbnRlbmNlQ291bnQgPiAwID8gd29yZENvdW50IC8gc2VudGVuY2VDb3VudCA6IDA7XHJcbiAgICBcclxuICAgIC8vIENoZWNrIHZvY2FidWxhcnkgdmFyaWV0eSAodW5pcXVlIHdvcmRzIHZzIHRvdGFsIHdvcmRzKVxyXG4gICAgY29uc3QgdW5pcXVlV29yZHMgPSBuZXcgU2V0KHdvcmRzLm1hcCh3b3JkID0+IHdvcmQudG9Mb3dlckNhc2UoKSkpO1xyXG4gICAgY29uc3Qgdm9jYWJ1bGFyeVZhcmlldHkgPSB1bmlxdWVXb3Jkcy5zaXplIC8gd29yZENvdW50O1xyXG4gICAgY29uc3QgaGFzVmFyaWVkVm9jYWJ1bGFyeSA9IHZvY2FidWxhcnlWYXJpZXR5ID4gMC40OyAvLyBBdCBsZWFzdCA0MCUgdW5pcXVlIHdvcmRzXHJcbiAgICBcclxuICAgIC8vIENoZWNrIGZvciBjb21wbGV0ZSB0aG91Z2h0cyAoc2VudGVuY2VzIGVuZGluZyB3aXRoIHByb3BlciBwdW5jdHVhdGlvbilcclxuICAgIGNvbnN0IGNvbXBsZXRlVGhvdWdodHMgPSBzZW50ZW5jZXMuZmlsdGVyKHNlbnRlbmNlID0+IFxyXG4gICAgICAvWy4hP10kLy50ZXN0KHNlbnRlbmNlLnRyaW0oKSlcclxuICAgICkubGVuZ3RoO1xyXG4gICAgY29uc3QgaGFzQ29tcGxldGVUaG91Z2h0cyA9IChjb21wbGV0ZVRob3VnaHRzIC8gc2VudGVuY2VDb3VudCkgPiAwLjc7IC8vIDcwJSBjb21wbGV0ZSBzZW50ZW5jZXNcclxuICAgIFxyXG4gICAgLy8gQ2FsY3VsYXRlIG92ZXJhbGwgcXVhbGl0eSBzY29yZVxyXG4gICAgbGV0IHNjb3JlID0gMDtcclxuICAgIFxyXG4gICAgLy8gV29yZCBjb3VudCBmYWN0b3IgKDAtMzAgcG9pbnRzKVxyXG4gICAgaWYgKHdvcmRDb3VudCA+PSB0aGlzLk1JTklNVU1fV09SRF9DT1VOVCkge1xyXG4gICAgICBzY29yZSArPSBNYXRoLm1pbigzMCwgKHdvcmRDb3VudCAvIDIwMCkgKiAzMCk7IC8vIE1heCBwb2ludHMgYXQgMjAwIHdvcmRzXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFNlbnRlbmNlIHN0cnVjdHVyZSBmYWN0b3IgKDAtMjUgcG9pbnRzKVxyXG4gICAgaWYgKGF2ZXJhZ2VXb3Jkc1BlclNlbnRlbmNlID49IDggJiYgYXZlcmFnZVdvcmRzUGVyU2VudGVuY2UgPD0gMjUpIHtcclxuICAgICAgc2NvcmUgKz0gMjU7IC8vIEdvb2Qgc2VudGVuY2UgbGVuZ3RoXHJcbiAgICB9IGVsc2UgaWYgKGF2ZXJhZ2VXb3Jkc1BlclNlbnRlbmNlID49IDUpIHtcclxuICAgICAgc2NvcmUgKz0gMTU7IC8vIEFjY2VwdGFibGUgc2VudGVuY2UgbGVuZ3RoXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFZvY2FidWxhcnkgdmFyaWV0eSBmYWN0b3IgKDAtMjUgcG9pbnRzKVxyXG4gICAgaWYgKGhhc1ZhcmllZFZvY2FidWxhcnkpIHtcclxuICAgICAgc2NvcmUgKz0gMjU7XHJcbiAgICB9IGVsc2UgaWYgKHZvY2FidWxhcnlWYXJpZXR5ID4gMC4yNSkge1xyXG4gICAgICBzY29yZSArPSAxNTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQ29tcGxldGUgdGhvdWdodHMgZmFjdG9yICgwLTIwIHBvaW50cylcclxuICAgIGlmIChoYXNDb21wbGV0ZVRob3VnaHRzKSB7XHJcbiAgICAgIHNjb3JlICs9IDIwO1xyXG4gICAgfSBlbHNlIGlmICgoY29tcGxldGVUaG91Z2h0cyAvIHNlbnRlbmNlQ291bnQpID4gMC41KSB7XHJcbiAgICAgIHNjb3JlICs9IDEwO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzY29yZTogTWF0aC5yb3VuZChzY29yZSksXHJcbiAgICAgIGZhY3RvcnM6IHtcclxuICAgICAgICB3b3JkQ291bnQsXHJcbiAgICAgICAgc2VudGVuY2VDb3VudCxcclxuICAgICAgICBhdmVyYWdlV29yZHNQZXJTZW50ZW5jZTogTWF0aC5yb3VuZChhdmVyYWdlV29yZHNQZXJTZW50ZW5jZSAqIDEwKSAvIDEwLFxyXG4gICAgICAgIGhhc1ZhcmllZFZvY2FidWxhcnksXHJcbiAgICAgICAgaGFzQ29tcGxldGVUaG91Z2h0c1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2FuaXRpemVzIGNvbnRlbnQgYnkgcmVtb3ZpbmcgZXhjZXNzaXZlIHdoaXRlc3BhY2UgYW5kIG5vbi10ZXh0IGVsZW1lbnRzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzYW5pdGl6ZUNvbnRlbnQoY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIHJldHVybiBjb250ZW50XHJcbiAgICAgIC5yZXBsYWNlKC9cXHMrL2csICcgJykgLy8gUmVwbGFjZSBtdWx0aXBsZSB3aGl0ZXNwYWNlIHdpdGggc2luZ2xlIHNwYWNlXHJcbiAgICAgIC5yZXBsYWNlKC9bXlxcd1xccy4sIT87OidcIigpLV0vZywgJycpIC8vIFJlbW92ZSBzcGVjaWFsIGNoYXJhY3RlcnMgZXhjZXB0IGJhc2ljIHB1bmN0dWF0aW9uXHJcbiAgICAgIC50cmltKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDb3VudHMgd29yZHMgaW4gdGhlIGNvbnRlbnRcclxuICAgKi9cclxuICBwcml2YXRlIGdldFdvcmRDb3VudChjb250ZW50OiBzdHJpbmcpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0V29yZHMoY29udGVudCkubGVuZ3RoO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0cyBhcnJheSBvZiB3b3JkcyBmcm9tIGNvbnRlbnRcclxuICAgKi9cclxuICBwcml2YXRlIGdldFdvcmRzKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIHJldHVybiBjb250ZW50XHJcbiAgICAgIC5zcGxpdCgvXFxzKy8pXHJcbiAgICAgIC5maWx0ZXIod29yZCA9PiB3b3JkLmxlbmd0aCA+IDAgJiYgL1xcdy8udGVzdCh3b3JkKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDb3VudHMgc2VudGVuY2VzIGluIHRoZSBjb250ZW50XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXRTZW50ZW5jZUNvdW50KGNvbnRlbnQ6IHN0cmluZyk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRTZW50ZW5jZXMoY29udGVudCkubGVuZ3RoO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0cyBhcnJheSBvZiBzZW50ZW5jZXMgZnJvbSBjb250ZW50XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXRTZW50ZW5jZXMoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgcmV0dXJuIGNvbnRlbnRcclxuICAgICAgLnNwbGl0KC9bLiE/XSsvKVxyXG4gICAgICAubWFwKHNlbnRlbmNlID0+IHNlbnRlbmNlLnRyaW0oKSlcclxuICAgICAgLmZpbHRlcihzZW50ZW5jZSA9PiBzZW50ZW5jZS5sZW5ndGggPiAwKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdlbmVyYXRlcyBpbXByb3ZlbWVudCBzdWdnZXN0aW9ucyBiYXNlZCBvbiBxdWFsaXR5IHNjb3JlIGZhY3RvcnNcclxuICAgKi9cclxuICBwcml2YXRlIGdldFF1YWxpdHlJbXByb3ZlbWVudFN1Z2dlc3Rpb25zKHF1YWxpdHlTY29yZTogUXVhbGl0eVNjb3JlKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XHJcbiAgICBcclxuICAgIGlmIChxdWFsaXR5U2NvcmUuZmFjdG9ycy53b3JkQ291bnQgPCAxMDApIHtcclxuICAgICAgc3VnZ2VzdGlvbnMucHVzaChcIlNlbGVjdCBsb25nZXIgY29udGVudCB3aXRoIG1vcmUgZGV0YWlsZWQgaW5mb3JtYXRpb25cIik7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChxdWFsaXR5U2NvcmUuZmFjdG9ycy5hdmVyYWdlV29yZHNQZXJTZW50ZW5jZSA8IDgpIHtcclxuICAgICAgc3VnZ2VzdGlvbnMucHVzaChcIkNob29zZSBjb250ZW50IHdpdGggbW9yZSBjb21wbGV4LCBjb21wbGV0ZSBzZW50ZW5jZXNcIik7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICghcXVhbGl0eVNjb3JlLmZhY3RvcnMuaGFzVmFyaWVkVm9jYWJ1bGFyeSkge1xyXG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKFwiU2VsZWN0IGNvbnRlbnQgd2l0aCBtb3JlIGRpdmVyc2Ugdm9jYWJ1bGFyeSBhbmQgdG9waWNzXCIpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoIXF1YWxpdHlTY29yZS5mYWN0b3JzLmhhc0NvbXBsZXRlVGhvdWdodHMpIHtcclxuICAgICAgc3VnZ2VzdGlvbnMucHVzaChcIkNob29zZSB3ZWxsLXN0cnVjdHVyZWQgdGV4dCB3aXRoIHByb3BlciBwdW5jdHVhdGlvblwiKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKHN1Z2dlc3Rpb25zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKFwiVHJ5IHNlbGVjdGluZyBkaWZmZXJlbnQgY29udGVudCB0aGF0IGlzIG1vcmUgc3VpdGFibGUgZm9yIGxhbmd1YWdlIGxlYXJuaW5nXCIpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXHJcbmV4cG9ydCBjb25zdCBjb250ZW50VmFsaWRhdG9yID0gbmV3IENvbnRlbnRWYWxpZGF0b3JJbXBsKCk7Il0sIm5hbWVzIjpbIkNvbnRlbnRWYWxpZGF0b3JJbXBsIiwidmFsaWRhdGVDb250ZW50IiwiY29udGVudCIsImNsZWFuQ29udGVudCIsInNhbml0aXplQ29udGVudCIsInRyaW0iLCJsZW5ndGgiLCJpc1ZhbGlkIiwicmVhc29uIiwic3VnZ2VzdGlvbnMiLCJ3b3JkQ291bnQiLCJnZXRXb3JkQ291bnQiLCJNSU5JTVVNX1dPUkRfQ09VTlQiLCJzZW50ZW5jZUNvdW50IiwiZ2V0U2VudGVuY2VDb3VudCIsIk1JTklNVU1fU0VOVEVOQ0VfQ09VTlQiLCJxdWFsaXR5U2NvcmUiLCJjaGVja0NvbnRlbnRRdWFsaXR5Iiwic2NvcmUiLCJNSU5JTVVNX1FVQUxJVFlfU0NPUkUiLCJnZXRRdWFsaXR5SW1wcm92ZW1lbnRTdWdnZXN0aW9ucyIsImdldE1pbmltdW1Xb3JkQ291bnQiLCJ3b3JkcyIsImdldFdvcmRzIiwic2VudGVuY2VzIiwiZ2V0U2VudGVuY2VzIiwiYXZlcmFnZVdvcmRzUGVyU2VudGVuY2UiLCJ1bmlxdWVXb3JkcyIsIlNldCIsIm1hcCIsIndvcmQiLCJ0b0xvd2VyQ2FzZSIsInZvY2FidWxhcnlWYXJpZXR5Iiwic2l6ZSIsImhhc1ZhcmllZFZvY2FidWxhcnkiLCJjb21wbGV0ZVRob3VnaHRzIiwiZmlsdGVyIiwic2VudGVuY2UiLCJ0ZXN0IiwiaGFzQ29tcGxldGVUaG91Z2h0cyIsIk1hdGgiLCJtaW4iLCJyb3VuZCIsImZhY3RvcnMiLCJyZXBsYWNlIiwic3BsaXQiLCJwdXNoIiwiY29udGVudFZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/content-validator.ts\n");

/***/ }),

/***/ "(rsc)/./lib/error-classifier.ts":
/*!*********************************!*\
  !*** ./lib/error-classifier.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ErrorClassifier: () => (/* binding */ ErrorClassifier),\n/* harmony export */   errorClassifier: () => (/* binding */ errorClassifier)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n/**\r\n * Error Classification System for AI-Only Lesson Generation\r\n * \r\n * This module provides error classification and message generation\r\n * for AI failures in the lesson generation system.\r\n */ \n/**\r\n * Implementation of the error classification system\r\n */ class ErrorClassifier {\n    /**\r\n   * Classifies an AI error based on error properties and context\r\n   */ classifyError(error, context = {}) {\n        const errorId = this.generateErrorId();\n        const fullContext = {\n            timestamp: new Date(),\n            ...context\n        };\n        const type = this.determineErrorType(error);\n        return {\n            type,\n            originalError: error,\n            context: fullContext,\n            errorId\n        };\n    }\n    /**\r\n   * Generates user-friendly error messages with actionable steps\r\n   */ generateUserMessage(error) {\n        switch(error.type){\n            case \"QUOTA_EXCEEDED\":\n                return {\n                    title: \"API Quota Exceeded\",\n                    message: \"API quota exceeded, please try again later\",\n                    actionableSteps: [\n                        \"Wait a few minutes before trying again\",\n                        \"Try generating a shorter lesson\",\n                        \"Contact support if the issue persists\"\n                    ],\n                    errorId: error.errorId,\n                    supportContact: \"support@linguaspark.com\"\n                };\n            case \"CONTENT_ISSUE\":\n                return {\n                    title: \"Content Processing Error\",\n                    message: \"Unable to process this content, please try different text\",\n                    actionableSteps: [\n                        \"Ensure the content has at least 100 words\",\n                        \"Try selecting different text from the webpage\",\n                        \"Check that the content is in a supported language\",\n                        \"Remove any special characters or formatting\"\n                    ],\n                    errorId: error.errorId\n                };\n            case \"NETWORK_ERROR\":\n                return {\n                    title: \"Connection Error\",\n                    message: \"Connection error, please check your internet and try again\",\n                    actionableSteps: [\n                        \"Check your internet connection\",\n                        \"Try refreshing the page\",\n                        \"Wait a moment and try again\",\n                        \"Contact support if the problem continues\"\n                    ],\n                    errorId: error.errorId\n                };\n            case \"UNKNOWN\":\n            default:\n                return {\n                    title: \"Service Temporarily Unavailable\",\n                    message: \"AI service temporarily unavailable, please try again later\",\n                    actionableSteps: [\n                        \"Wait a few minutes and try again\",\n                        \"Try refreshing the page\",\n                        \"Contact support with the error ID below\"\n                    ],\n                    errorId: error.errorId,\n                    supportContact: \"support@linguaspark.com\"\n                };\n        }\n    }\n    /**\r\n   * Generates detailed support messages for debugging\r\n   */ generateSupportMessage(error) {\n        return {\n            errorId: error.errorId,\n            type: error.type,\n            technicalDetails: this.extractTechnicalDetails(error.originalError),\n            context: error.context,\n            stackTrace: error.originalError.stack,\n            timestamp: error.context.timestamp\n        };\n    }\n    /**\r\n   * Determines error type based on error properties\r\n   */ determineErrorType(error) {\n        // Check for quota/rate limit errors\n        if (this.isQuotaError(error)) {\n            return \"QUOTA_EXCEEDED\";\n        }\n        // Check for network/connection errors\n        if (this.isNetworkError(error)) {\n            return \"NETWORK_ERROR\";\n        }\n        // Check for content-related errors\n        if (this.isContentError(error)) {\n            return \"CONTENT_ISSUE\";\n        }\n        // Default to unknown for unclassified errors\n        return \"UNKNOWN\";\n    }\n    /**\r\n   * Checks if error is related to API quota/rate limits\r\n   */ isQuotaError(error) {\n        const quotaIndicators = [\n            \"quota\",\n            \"rate limit\",\n            \"too many requests\",\n            \"limit exceeded\",\n            \"429\",\n            \"RESOURCE_EXHAUSTED\"\n        ];\n        const errorText = (error.message || \"\").toLowerCase();\n        const errorCode = (error.code || \"\").toLowerCase();\n        const status = error.status;\n        return status === 429 || quotaIndicators.some((indicator)=>errorText.includes(indicator) || errorCode.includes(indicator));\n    }\n    /**\r\n   * Checks if error is network/connection related\r\n   */ isNetworkError(error) {\n        const networkIndicators = [\n            \"network\",\n            \"connection\",\n            \"timeout\",\n            \"fetch\",\n            \"ECONNREFUSED\",\n            \"ENOTFOUND\",\n            \"ETIMEDOUT\"\n        ];\n        const errorText = (error.message || \"\").toLowerCase();\n        const errorCode = (error.code || \"\").toLowerCase();\n        const status = error.status;\n        return status === 0 || status === 502 || status === 503 || status === 504 || networkIndicators.some((indicator)=>errorText.includes(indicator) || errorCode.includes(indicator));\n    }\n    /**\r\n   * Checks if error is content-related\r\n   */ isContentError(error) {\n        const contentIndicators = [\n            \"invalid input\",\n            \"content too short\",\n            \"unsupported format\",\n            \"parsing error\",\n            \"invalid content\",\n            \"content validation\",\n            \"INVALID_ARGUMENT\"\n        ];\n        const errorText = (error.message || \"\").toLowerCase();\n        const errorCode = (error.code || \"\").toLowerCase();\n        const status = error.status;\n        return status === 400 || contentIndicators.some((indicator)=>errorText.includes(indicator) || errorCode.includes(indicator));\n    }\n    /**\r\n   * Extracts technical details from error for support\r\n   */ extractTechnicalDetails(error) {\n        const details = [];\n        if (error.message) {\n            details.push(`Message: ${error.message}`);\n        }\n        if (\"code\" in error && error.code) {\n            details.push(`Code: ${error.code}`);\n        }\n        if (\"status\" in error && error.status) {\n            details.push(`Status: ${error.status}`);\n        }\n        if (\"response\" in error && error.response) {\n            details.push(`Response: ${JSON.stringify(error.response, null, 2)}`);\n        }\n        return details.join(\"\\n\");\n    }\n    /**\r\n   * Generates unique error ID for support tracking\r\n   */ generateErrorId() {\n        const timestamp = Date.now().toString(36);\n        const random = (0,crypto__WEBPACK_IMPORTED_MODULE_0__.randomUUID)().split(\"-\")[0];\n        return `ERR_${timestamp}_${random}`.toUpperCase();\n    }\n}\n// Export singleton instance\nconst errorClassifier = new ErrorClassifier();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVFDLElBQUksQ0FBQyxDQUFDLE1BQU0sRUFBRW5DLE1BQU0yQixJQUFJLENBQUMsQ0FBQztRQUNwQztRQUVBLElBQUksWUFBWTNCLFNBQVNBLE1BQU00QixNQUFNLEVBQUU7WUFDckNNLFFBQVFDLElBQUksQ0FBQyxDQUFDLFFBQVEsRUFBRW5DLE1BQU00QixNQUFNLENBQUMsQ0FBQztRQUN4QztRQUVBLElBQUksY0FBYzVCLFNBQVNBLE1BQU1vQyxRQUFRLEVBQUU7WUFDekNGLFFBQVFDLElBQUksQ0FBQyxDQUFDLFVBQVUsRUFBRUUsS0FBS0MsU0FBUyxDQUFDdEMsTUFBTW9DLFFBQVEsRUFBRSxNQUFNLEdBQUcsQ0FBQztRQUNyRTtRQUVBLE9BQU9GLFFBQVFLLElBQUksQ0FBQztJQUN0QjtJQUVBOztHQUVDLEdBQ0Qsa0JBQWtDO1FBQ2hDLE1BQU1sQyxZQUFZQyxLQUFLa0MsR0FBRyxHQUFHQyxRQUFRLENBQUM7UUFDdEMsTUFBTUMsU0FBUzdDLGtEQUFVQSxHQUFHOEMsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQ3pDLE9BQU8sQ0FBQyxJQUFJLEVBQUV0QyxVQUFVLENBQUMsRUFBRXFDLE9BQU8sQ0FBQyxDQUFDRSxXQUFXO0lBQ2pEO0FBQ0Y7QUFFQSw0QkFBNEI7QUFDckIsTUFBTUMsa0JBQWtCLElBQUkvQyxrQkFBa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL2Vycm9yLWNsYXNzaWZpZXIudHM/Nzg1NSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogRXJyb3IgQ2xhc3NpZmljYXRpb24gU3lzdGVtIGZvciBBSS1Pbmx5IExlc3NvbiBHZW5lcmF0aW9uXHJcbiAqIFxyXG4gKiBUaGlzIG1vZHVsZSBwcm92aWRlcyBlcnJvciBjbGFzc2lmaWNhdGlvbiBhbmQgbWVzc2FnZSBnZW5lcmF0aW9uXHJcbiAqIGZvciBBSSBmYWlsdXJlcyBpbiB0aGUgbGVzc29uIGdlbmVyYXRpb24gc3lzdGVtLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IHJhbmRvbVVVSUQgfSBmcm9tICdjcnlwdG8nO1xyXG5cclxuLy8gRXJyb3IgdHlwZXMgYmFzZWQgb24gcmVxdWlyZW1lbnRzIDMuMS0zLjRcclxuZXhwb3J0IHR5cGUgRXJyb3JUeXBlID0gXHJcbiAgfCAnUVVPVEFfRVhDRUVERUQnIFxyXG4gIHwgJ0NPTlRFTlRfSVNTVUUnIFxyXG4gIHwgJ05FVFdPUktfRVJST1InIFxyXG4gIHwgJ1VOS05PV04nO1xyXG5cclxuLy8gQmFzZSBBSSBlcnJvciBpbnRlcmZhY2VcclxuZXhwb3J0IGludGVyZmFjZSBBSUVycm9yIGV4dGVuZHMgRXJyb3Ige1xyXG4gIGNvZGU/OiBzdHJpbmc7XHJcbiAgc3RhdHVzPzogbnVtYmVyO1xyXG4gIHJlc3BvbnNlPzogYW55O1xyXG59XHJcblxyXG4vLyBFcnJvciBjb250ZXh0IGZvciBkZWJ1Z2dpbmcgYW5kIHN1cHBvcnRcclxuZXhwb3J0IGludGVyZmFjZSBFcnJvckNvbnRleHQge1xyXG4gIHVzZXJJZD86IHN0cmluZztcclxuICBjb250ZW50TGVuZ3RoPzogbnVtYmVyO1xyXG4gIGxlc3NvblR5cGU/OiBzdHJpbmc7XHJcbiAgdGltZXN0YW1wOiBEYXRlO1xyXG4gIHJlcXVlc3RJZD86IHN0cmluZztcclxuICBhcGlFbmRwb2ludD86IHN0cmluZztcclxufVxyXG5cclxuLy8gQ2xhc3NpZmllZCBlcnJvciB3aXRoIGFkZGl0aW9uYWwgbWV0YWRhdGFcclxuZXhwb3J0IGludGVyZmFjZSBDbGFzc2lmaWVkRXJyb3Ige1xyXG4gIHR5cGU6IEVycm9yVHlwZTtcclxuICBvcmlnaW5hbEVycm9yOiBFcnJvcjtcclxuICBjb250ZXh0OiBFcnJvckNvbnRleHQ7XHJcbiAgZXJyb3JJZDogc3RyaW5nO1xyXG59XHJcblxyXG4vLyBVc2VyLWZhY2luZyBlcnJvciBtZXNzYWdlXHJcbmV4cG9ydCBpbnRlcmZhY2UgVXNlckVycm9yTWVzc2FnZSB7XHJcbiAgdGl0bGU6IHN0cmluZztcclxuICBtZXNzYWdlOiBzdHJpbmc7XHJcbiAgYWN0aW9uYWJsZVN0ZXBzOiBzdHJpbmdbXTtcclxuICBlcnJvcklkOiBzdHJpbmc7XHJcbiAgc3VwcG9ydENvbnRhY3Q/OiBzdHJpbmc7XHJcbn1cclxuXHJcbi8vIFN1cHBvcnQgZXJyb3IgbWVzc2FnZSB3aXRoIHRlY2huaWNhbCBkZXRhaWxzXHJcbmV4cG9ydCBpbnRlcmZhY2UgU3VwcG9ydEVycm9yTWVzc2FnZSB7XHJcbiAgZXJyb3JJZDogc3RyaW5nO1xyXG4gIHR5cGU6IEVycm9yVHlwZTtcclxuICB0ZWNobmljYWxEZXRhaWxzOiBzdHJpbmc7XHJcbiAgY29udGV4dDogRXJyb3JDb250ZXh0O1xyXG4gIHN0YWNrVHJhY2U/OiBzdHJpbmc7XHJcbiAgdGltZXN0YW1wOiBEYXRlO1xyXG59XHJcblxyXG4vLyBFcnJvciBjbGFzc2lmaWVyIGludGVyZmFjZVxyXG5leHBvcnQgaW50ZXJmYWNlIElFcnJvckNsYXNzaWZpZXIge1xyXG4gIGNsYXNzaWZ5RXJyb3IoZXJyb3I6IEFJRXJyb3IsIGNvbnRleHQ/OiBQYXJ0aWFsPEVycm9yQ29udGV4dD4pOiBDbGFzc2lmaWVkRXJyb3I7XHJcbiAgZ2VuZXJhdGVVc2VyTWVzc2FnZShlcnJvcjogQ2xhc3NpZmllZEVycm9yKTogVXNlckVycm9yTWVzc2FnZTtcclxuICBnZW5lcmF0ZVN1cHBvcnRNZXNzYWdlKGVycm9yOiBDbGFzc2lmaWVkRXJyb3IpOiBTdXBwb3J0RXJyb3JNZXNzYWdlO1xyXG59XHJcblxyXG4vKipcclxuICogSW1wbGVtZW50YXRpb24gb2YgdGhlIGVycm9yIGNsYXNzaWZpY2F0aW9uIHN5c3RlbVxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEVycm9yQ2xhc3NpZmllciBpbXBsZW1lbnRzIElFcnJvckNsYXNzaWZpZXIge1xyXG4gIFxyXG4gIC8qKlxyXG4gICAqIENsYXNzaWZpZXMgYW4gQUkgZXJyb3IgYmFzZWQgb24gZXJyb3IgcHJvcGVydGllcyBhbmQgY29udGV4dFxyXG4gICAqL1xyXG4gIGNsYXNzaWZ5RXJyb3IoZXJyb3I6IEFJRXJyb3IsIGNvbnRleHQ6IFBhcnRpYWw8RXJyb3JDb250ZXh0PiA9IHt9KTogQ2xhc3NpZmllZEVycm9yIHtcclxuICAgIGNvbnN0IGVycm9ySWQgPSB0aGlzLmdlbmVyYXRlRXJyb3JJZCgpO1xyXG4gICAgY29uc3QgZnVsbENvbnRleHQ6IEVycm9yQ29udGV4dCA9IHtcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAuLi5jb250ZXh0XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHR5cGUgPSB0aGlzLmRldGVybWluZUVycm9yVHlwZShlcnJvcik7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdHlwZSxcclxuICAgICAgb3JpZ2luYWxFcnJvcjogZXJyb3IsXHJcbiAgICAgIGNvbnRleHQ6IGZ1bGxDb250ZXh0LFxyXG4gICAgICBlcnJvcklkXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGVzIHVzZXItZnJpZW5kbHkgZXJyb3IgbWVzc2FnZXMgd2l0aCBhY3Rpb25hYmxlIHN0ZXBzXHJcbiAgICovXHJcbiAgZ2VuZXJhdGVVc2VyTWVzc2FnZShlcnJvcjogQ2xhc3NpZmllZEVycm9yKTogVXNlckVycm9yTWVzc2FnZSB7XHJcbiAgICBzd2l0Y2ggKGVycm9yLnR5cGUpIHtcclxuICAgICAgY2FzZSAnUVVPVEFfRVhDRUVERUQnOlxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICB0aXRsZTogJ0FQSSBRdW90YSBFeGNlZWRlZCcsXHJcbiAgICAgICAgICBtZXNzYWdlOiAnQVBJIHF1b3RhIGV4Y2VlZGVkLCBwbGVhc2UgdHJ5IGFnYWluIGxhdGVyJyxcclxuICAgICAgICAgIGFjdGlvbmFibGVTdGVwczogW1xyXG4gICAgICAgICAgICAnV2FpdCBhIGZldyBtaW51dGVzIGJlZm9yZSB0cnlpbmcgYWdhaW4nLFxyXG4gICAgICAgICAgICAnVHJ5IGdlbmVyYXRpbmcgYSBzaG9ydGVyIGxlc3NvbicsXHJcbiAgICAgICAgICAgICdDb250YWN0IHN1cHBvcnQgaWYgdGhlIGlzc3VlIHBlcnNpc3RzJ1xyXG4gICAgICAgICAgXSxcclxuICAgICAgICAgIGVycm9ySWQ6IGVycm9yLmVycm9ySWQsXHJcbiAgICAgICAgICBzdXBwb3J0Q29udGFjdDogJ3N1cHBvcnRAbGluZ3Vhc3BhcmsuY29tJ1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICBjYXNlICdDT05URU5UX0lTU1VFJzpcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgdGl0bGU6ICdDb250ZW50IFByb2Nlc3NpbmcgRXJyb3InLFxyXG4gICAgICAgICAgbWVzc2FnZTogJ1VuYWJsZSB0byBwcm9jZXNzIHRoaXMgY29udGVudCwgcGxlYXNlIHRyeSBkaWZmZXJlbnQgdGV4dCcsXHJcbiAgICAgICAgICBhY3Rpb25hYmxlU3RlcHM6IFtcclxuICAgICAgICAgICAgJ0Vuc3VyZSB0aGUgY29udGVudCBoYXMgYXQgbGVhc3QgMTAwIHdvcmRzJyxcclxuICAgICAgICAgICAgJ1RyeSBzZWxlY3RpbmcgZGlmZmVyZW50IHRleHQgZnJvbSB0aGUgd2VicGFnZScsXHJcbiAgICAgICAgICAgICdDaGVjayB0aGF0IHRoZSBjb250ZW50IGlzIGluIGEgc3VwcG9ydGVkIGxhbmd1YWdlJyxcclxuICAgICAgICAgICAgJ1JlbW92ZSBhbnkgc3BlY2lhbCBjaGFyYWN0ZXJzIG9yIGZvcm1hdHRpbmcnXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgICAgZXJyb3JJZDogZXJyb3IuZXJyb3JJZFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICBjYXNlICdORVRXT1JLX0VSUk9SJzpcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgdGl0bGU6ICdDb25uZWN0aW9uIEVycm9yJyxcclxuICAgICAgICAgIG1lc3NhZ2U6ICdDb25uZWN0aW9uIGVycm9yLCBwbGVhc2UgY2hlY2sgeW91ciBpbnRlcm5ldCBhbmQgdHJ5IGFnYWluJyxcclxuICAgICAgICAgIGFjdGlvbmFibGVTdGVwczogW1xyXG4gICAgICAgICAgICAnQ2hlY2sgeW91ciBpbnRlcm5ldCBjb25uZWN0aW9uJyxcclxuICAgICAgICAgICAgJ1RyeSByZWZyZXNoaW5nIHRoZSBwYWdlJyxcclxuICAgICAgICAgICAgJ1dhaXQgYSBtb21lbnQgYW5kIHRyeSBhZ2FpbicsXHJcbiAgICAgICAgICAgICdDb250YWN0IHN1cHBvcnQgaWYgdGhlIHByb2JsZW0gY29udGludWVzJ1xyXG4gICAgICAgICAgXSxcclxuICAgICAgICAgIGVycm9ySWQ6IGVycm9yLmVycm9ySWRcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgY2FzZSAnVU5LTk9XTic6XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHRpdGxlOiAnU2VydmljZSBUZW1wb3JhcmlseSBVbmF2YWlsYWJsZScsXHJcbiAgICAgICAgICBtZXNzYWdlOiAnQUkgc2VydmljZSB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZSwgcGxlYXNlIHRyeSBhZ2FpbiBsYXRlcicsXHJcbiAgICAgICAgICBhY3Rpb25hYmxlU3RlcHM6IFtcclxuICAgICAgICAgICAgJ1dhaXQgYSBmZXcgbWludXRlcyBhbmQgdHJ5IGFnYWluJyxcclxuICAgICAgICAgICAgJ1RyeSByZWZyZXNoaW5nIHRoZSBwYWdlJyxcclxuICAgICAgICAgICAgJ0NvbnRhY3Qgc3VwcG9ydCB3aXRoIHRoZSBlcnJvciBJRCBiZWxvdydcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICBlcnJvcklkOiBlcnJvci5lcnJvcklkLFxyXG4gICAgICAgICAgc3VwcG9ydENvbnRhY3Q6ICdzdXBwb3J0QGxpbmd1YXNwYXJrLmNvbSdcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGVzIGRldGFpbGVkIHN1cHBvcnQgbWVzc2FnZXMgZm9yIGRlYnVnZ2luZ1xyXG4gICAqL1xyXG4gIGdlbmVyYXRlU3VwcG9ydE1lc3NhZ2UoZXJyb3I6IENsYXNzaWZpZWRFcnJvcik6IFN1cHBvcnRFcnJvck1lc3NhZ2Uge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgZXJyb3JJZDogZXJyb3IuZXJyb3JJZCxcclxuICAgICAgdHlwZTogZXJyb3IudHlwZSxcclxuICAgICAgdGVjaG5pY2FsRGV0YWlsczogdGhpcy5leHRyYWN0VGVjaG5pY2FsRGV0YWlscyhlcnJvci5vcmlnaW5hbEVycm9yKSxcclxuICAgICAgY29udGV4dDogZXJyb3IuY29udGV4dCxcclxuICAgICAgc3RhY2tUcmFjZTogZXJyb3Iub3JpZ2luYWxFcnJvci5zdGFjayxcclxuICAgICAgdGltZXN0YW1wOiBlcnJvci5jb250ZXh0LnRpbWVzdGFtcFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERldGVybWluZXMgZXJyb3IgdHlwZSBiYXNlZCBvbiBlcnJvciBwcm9wZXJ0aWVzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBkZXRlcm1pbmVFcnJvclR5cGUoZXJyb3I6IEFJRXJyb3IpOiBFcnJvclR5cGUge1xyXG4gICAgLy8gQ2hlY2sgZm9yIHF1b3RhL3JhdGUgbGltaXQgZXJyb3JzXHJcbiAgICBpZiAodGhpcy5pc1F1b3RhRXJyb3IoZXJyb3IpKSB7XHJcbiAgICAgIHJldHVybiAnUVVPVEFfRVhDRUVERUQnO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGZvciBuZXR3b3JrL2Nvbm5lY3Rpb24gZXJyb3JzXHJcbiAgICBpZiAodGhpcy5pc05ldHdvcmtFcnJvcihlcnJvcikpIHtcclxuICAgICAgcmV0dXJuICdORVRXT1JLX0VSUk9SJztcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBmb3IgY29udGVudC1yZWxhdGVkIGVycm9yc1xyXG4gICAgaWYgKHRoaXMuaXNDb250ZW50RXJyb3IoZXJyb3IpKSB7XHJcbiAgICAgIHJldHVybiAnQ09OVEVOVF9JU1NVRSc7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRGVmYXVsdCB0byB1bmtub3duIGZvciB1bmNsYXNzaWZpZWQgZXJyb3JzXHJcbiAgICByZXR1cm4gJ1VOS05PV04nO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2tzIGlmIGVycm9yIGlzIHJlbGF0ZWQgdG8gQVBJIHF1b3RhL3JhdGUgbGltaXRzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpc1F1b3RhRXJyb3IoZXJyb3I6IEFJRXJyb3IpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IHF1b3RhSW5kaWNhdG9ycyA9IFtcclxuICAgICAgJ3F1b3RhJyxcclxuICAgICAgJ3JhdGUgbGltaXQnLFxyXG4gICAgICAndG9vIG1hbnkgcmVxdWVzdHMnLFxyXG4gICAgICAnbGltaXQgZXhjZWVkZWQnLFxyXG4gICAgICAnNDI5JyxcclxuICAgICAgJ1JFU09VUkNFX0VYSEFVU1RFRCdcclxuICAgIF07XHJcblxyXG4gICAgY29uc3QgZXJyb3JUZXh0ID0gKGVycm9yLm1lc3NhZ2UgfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBjb25zdCBlcnJvckNvZGUgPSAoZXJyb3IuY29kZSB8fCAnJykudG9Mb3dlckNhc2UoKTtcclxuICAgIGNvbnN0IHN0YXR1cyA9IGVycm9yLnN0YXR1cztcclxuXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICBzdGF0dXMgPT09IDQyOSB8fFxyXG4gICAgICBxdW90YUluZGljYXRvcnMuc29tZShpbmRpY2F0b3IgPT4gXHJcbiAgICAgICAgZXJyb3JUZXh0LmluY2x1ZGVzKGluZGljYXRvcikgfHwgZXJyb3JDb2RlLmluY2x1ZGVzKGluZGljYXRvcilcclxuICAgICAgKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoZWNrcyBpZiBlcnJvciBpcyBuZXR3b3JrL2Nvbm5lY3Rpb24gcmVsYXRlZFxyXG4gICAqL1xyXG4gIHByaXZhdGUgaXNOZXR3b3JrRXJyb3IoZXJyb3I6IEFJRXJyb3IpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IG5ldHdvcmtJbmRpY2F0b3JzID0gW1xyXG4gICAgICAnbmV0d29yaycsXHJcbiAgICAgICdjb25uZWN0aW9uJyxcclxuICAgICAgJ3RpbWVvdXQnLFxyXG4gICAgICAnZmV0Y2gnLFxyXG4gICAgICAnRUNPTk5SRUZVU0VEJyxcclxuICAgICAgJ0VOT1RGT1VORCcsXHJcbiAgICAgICdFVElNRURPVVQnXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IGVycm9yVGV4dCA9IChlcnJvci5tZXNzYWdlIHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgZXJyb3JDb2RlID0gKGVycm9yLmNvZGUgfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBjb25zdCBzdGF0dXMgPSBlcnJvci5zdGF0dXM7XHJcblxyXG4gICAgcmV0dXJuIChcclxuICAgICAgc3RhdHVzID09PSAwIHx8XHJcbiAgICAgIHN0YXR1cyA9PT0gNTAyIHx8XHJcbiAgICAgIHN0YXR1cyA9PT0gNTAzIHx8XHJcbiAgICAgIHN0YXR1cyA9PT0gNTA0IHx8XHJcbiAgICAgIG5ldHdvcmtJbmRpY2F0b3JzLnNvbWUoaW5kaWNhdG9yID0+IFxyXG4gICAgICAgIGVycm9yVGV4dC5pbmNsdWRlcyhpbmRpY2F0b3IpIHx8IGVycm9yQ29kZS5pbmNsdWRlcyhpbmRpY2F0b3IpXHJcbiAgICAgIClcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVja3MgaWYgZXJyb3IgaXMgY29udGVudC1yZWxhdGVkXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpc0NvbnRlbnRFcnJvcihlcnJvcjogQUlFcnJvcik6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgY29udGVudEluZGljYXRvcnMgPSBbXHJcbiAgICAgICdpbnZhbGlkIGlucHV0JyxcclxuICAgICAgJ2NvbnRlbnQgdG9vIHNob3J0JyxcclxuICAgICAgJ3Vuc3VwcG9ydGVkIGZvcm1hdCcsXHJcbiAgICAgICdwYXJzaW5nIGVycm9yJyxcclxuICAgICAgJ2ludmFsaWQgY29udGVudCcsXHJcbiAgICAgICdjb250ZW50IHZhbGlkYXRpb24nLFxyXG4gICAgICAnSU5WQUxJRF9BUkdVTUVOVCdcclxuICAgIF07XHJcblxyXG4gICAgY29uc3QgZXJyb3JUZXh0ID0gKGVycm9yLm1lc3NhZ2UgfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBjb25zdCBlcnJvckNvZGUgPSAoZXJyb3IuY29kZSB8fCAnJykudG9Mb3dlckNhc2UoKTtcclxuICAgIGNvbnN0IHN0YXR1cyA9IGVycm9yLnN0YXR1cztcclxuXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICBzdGF0dXMgPT09IDQwMCB8fFxyXG4gICAgICBjb250ZW50SW5kaWNhdG9ycy5zb21lKGluZGljYXRvciA9PiBcclxuICAgICAgICBlcnJvclRleHQuaW5jbHVkZXMoaW5kaWNhdG9yKSB8fCBlcnJvckNvZGUuaW5jbHVkZXMoaW5kaWNhdG9yKVxyXG4gICAgICApXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRXh0cmFjdHMgdGVjaG5pY2FsIGRldGFpbHMgZnJvbSBlcnJvciBmb3Igc3VwcG9ydFxyXG4gICAqL1xyXG4gIHByaXZhdGUgZXh0cmFjdFRlY2huaWNhbERldGFpbHMoZXJyb3I6IEVycm9yKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGRldGFpbHMgPSBbXTtcclxuICAgIFxyXG4gICAgaWYgKGVycm9yLm1lc3NhZ2UpIHtcclxuICAgICAgZGV0YWlscy5wdXNoKGBNZXNzYWdlOiAke2Vycm9yLm1lc3NhZ2V9YCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICgnY29kZScgaW4gZXJyb3IgJiYgZXJyb3IuY29kZSkge1xyXG4gICAgICBkZXRhaWxzLnB1c2goYENvZGU6ICR7ZXJyb3IuY29kZX1gKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKCdzdGF0dXMnIGluIGVycm9yICYmIGVycm9yLnN0YXR1cykge1xyXG4gICAgICBkZXRhaWxzLnB1c2goYFN0YXR1czogJHtlcnJvci5zdGF0dXN9YCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICgncmVzcG9uc2UnIGluIGVycm9yICYmIGVycm9yLnJlc3BvbnNlKSB7XHJcbiAgICAgIGRldGFpbHMucHVzaChgUmVzcG9uc2U6ICR7SlNPTi5zdHJpbmdpZnkoZXJyb3IucmVzcG9uc2UsIG51bGwsIDIpfWApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBkZXRhaWxzLmpvaW4oJ1xcbicpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGVzIHVuaXF1ZSBlcnJvciBJRCBmb3Igc3VwcG9ydCB0cmFja2luZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2VuZXJhdGVFcnJvcklkKCk6IHN0cmluZyB7XHJcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpLnRvU3RyaW5nKDM2KTtcclxuICAgIGNvbnN0IHJhbmRvbSA9IHJhbmRvbVVVSUQoKS5zcGxpdCgnLScpWzBdO1xyXG4gICAgcmV0dXJuIGBFUlJfJHt0aW1lc3RhbXB9XyR7cmFuZG9tfWAudG9VcHBlckNhc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2VcclxuZXhwb3J0IGNvbnN0IGVycm9yQ2xhc3NpZmllciA9IG5ldyBFcnJvckNsYXNzaWZpZXIoKTsiXSwibmFtZXMiOlsicmFuZG9tVVVJRCIsIkVycm9yQ2xhc3NpZmllciIsImNsYXNzaWZ5RXJyb3IiLCJlcnJvciIsImNvbnRleHQiLCJlcnJvcklkIiwiZ2VuZXJhdGVFcnJvcklkIiwiZnVsbENvbnRleHQiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidHlwZSIsImRldGVybWluZUVycm9yVHlwZSIsIm9yaWdpbmFsRXJyb3IiLCJnZW5lcmF0ZVVzZXJNZXNzYWdlIiwidGl0bGUiLCJtZXNzYWdlIiwiYWN0aW9uYWJsZVN0ZXBzIiwic3VwcG9ydENvbnRhY3QiLCJnZW5lcmF0ZVN1cHBvcnRNZXNzYWdlIiwidGVjaG5pY2FsRGV0YWlscyIsImV4dHJhY3RUZWNobmljYWxEZXRhaWxzIiwic3RhY2tUcmFjZSIsInN0YWNrIiwiaXNRdW90YUVycm9yIiwiaXNOZXR3b3JrRXJyb3IiLCJpc0NvbnRlbnRFcnJvciIsInF1b3RhSW5kaWNhdG9ycyIsImVycm9yVGV4dCIsInRvTG93ZXJDYXNlIiwiZXJyb3JDb2RlIiwiY29kZSIsInN0YXR1cyIsInNvbWUiLCJpbmRpY2F0b3IiLCJpbmNsdWRlcyIsIm5ldHdvcmtJbmRpY2F0b3JzIiwiY29udGVudEluZGljYXRvcnMiLCJkZXRhaWxzIiwicHVzaCIsInJlc3BvbnNlIiwiSlNPTiIsInN0cmluZ2lmeSIsImpvaW4iLCJub3ciLCJ0b1N0cmluZyIsInJhbmRvbSIsInNwbGl0IiwidG9VcHBlckNhc2UiLCJlcnJvckNsYXNzaWZpZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/error-classifier.ts\n");

/***/ }),

/***/ "(rsc)/./lib/google-ai-server.ts":
/*!*********************************!*\
  !*** ./lib/google-ai-server.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createGoogleAIServerService: () => (/* binding */ createGoogleAIServerService)\n/* harmony export */ });\n/* harmony import */ var _error_classifier__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./error-classifier */ \"(rsc)/./lib/error-classifier.ts\");\n/* harmony import */ var _usage_monitor__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./usage-monitor */ \"(rsc)/./lib/usage-monitor.ts\");\n// Server-side Google AI (Gemini) APIs service layer\n\n\nclass GoogleAIServerService {\n    constructor(config){\n        this.model = \"models/gemini-2.5-flash\" // Use actual available model\n        ;\n        this.maxRetries = 3;\n        this.baseRetryDelay = 1000 // 1 second\n        ;\n        this.maxRetryDelay = 30000 // 30 seconds\n        ;\n        this.config = config;\n    }\n    async makeGeminiRequest(prompt, options = {}, metadata) {\n        return this.makeGeminiRequestWithRetry(prompt, options, metadata, 0);\n    }\n    async makeGeminiRequestWithRetry(prompt, options = {}, metadata, retryAttempt = 0) {\n        const startTime = Date.now();\n        const requestId = this.generateRequestId();\n        const requestBody = {\n            contents: [\n                {\n                    parts: [\n                        {\n                            text: prompt\n                        }\n                    ]\n                }\n            ],\n            generationConfig: {\n                temperature: options.temperature || 0.7,\n                maxOutputTokens: options.maxTokens || 8000,\n                topP: options.topP || 0.9\n            }\n        };\n        // Estimate input tokens (rough approximation: 1 token  4 characters)\n        const estimatedInputTokens = Math.ceil(prompt.length / 4);\n        const url = `${this.config.baseUrl}/v1beta/models/gemini-2.5-flash:generateContent?key=${this.config.apiKey}`;\n        console.log(` API Request [${requestId}] - Attempt ${retryAttempt + 1}/${this.maxRetries + 1}`);\n        console.log(` Estimated input tokens: ${estimatedInputTokens}`);\n        try {\n            const response = await fetch(url, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(requestBody)\n            });\n            console.log(` Response [${requestId}]: ${response.status} ${response.statusText}`);\n            if (response.ok) {\n                const result = await response.json();\n                const endTime = Date.now();\n                const responseTime = endTime - startTime;\n                console.log(\" Successful API response received\");\n                // Extract token usage information if available\n                const tokenUsage = this.extractTokenUsage(result, estimatedInputTokens);\n                // Log token usage\n                if (metadata?.section && tokenUsage) {\n                    _usage_monitor__WEBPACK_IMPORTED_MODULE_1__.usageMonitor.logTokenUsage(metadata.section, tokenUsage.totalTokens, metadata.optimization || \"none\", metadata.context);\n                }\n                // Parse response content\n                if (result.candidates && result.candidates.length > 0) {\n                    const candidate = result.candidates[0];\n                    // Check if we hit MAX_TOKENS limit\n                    if (candidate.finishReason === \"MAX_TOKENS\") {\n                        console.warn(\" Hit MAX_TOKENS limit, response may be incomplete\");\n                        // ALWAYS return partial text if available - don't throw error\n                        if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {\n                            const text = candidate.content.parts[0].text;\n                            // Check if text is actually present and not empty\n                            if (text && text.trim().length > 0) {\n                                console.log(` Extracted partial text (${text.length} chars) due to MAX_TOKENS`);\n                                return text;\n                            }\n                        }\n                        // CRITICAL FIX: MAX_TOKENS with no content - just throw error\n                        // The retry logic is too complex and causes scope issues\n                        // Let the calling code handle fallbacks instead\n                        console.warn(\" MAX_TOKENS hit with no content - cannot retry from here\");\n                        // Only throw if we truly can't retry\n                        console.error(\" MAX_TOKENS hit but no content available and cannot retry\");\n                        console.error(\" Response structure:\", JSON.stringify(candidate, null, 2));\n                        const error = new Error(\"MAX_TOKENS_EXCEEDED_NO_CONTENT\");\n                        error.code = \"MAX_TOKENS\";\n                        throw error;\n                    }\n                    // Normal response processing\n                    if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {\n                        const text = candidate.content.parts[0].text;\n                        console.log(` Generated text (${text.length} chars) in ${responseTime}ms`);\n                        return text;\n                    } else {\n                        const error = new Error(\"Invalid content structure in API response\");\n                        error.code = \"INVALID_RESPONSE_STRUCTURE\";\n                        throw error;\n                    }\n                } else {\n                    const error = new Error(\"No candidates in API response\");\n                    error.code = \"NO_CANDIDATES\";\n                    throw error;\n                }\n            } else {\n                // Handle HTTP errors with potential retry\n                const errorText = await response.text();\n                const error = new Error(`Gemini API error: ${response.status} ${response.statusText} - ${errorText}`);\n                error.status = response.status;\n                error.response = errorText;\n                // Check if this is a retryable error\n                if (this.isRetryableError(response.status) && retryAttempt < this.maxRetries) {\n                    const delay = this.calculateRetryDelay(retryAttempt);\n                    console.warn(` Retryable error (${response.status}), retrying in ${delay}ms...`);\n                    await this.sleep(delay);\n                    return this.makeGeminiRequestWithRetry(prompt, options, metadata, retryAttempt + 1);\n                }\n                throw error;\n            }\n        } catch (error) {\n            const aiError = error;\n            // Log error with context\n            if (metadata?.context) {\n                const errorContext = {\n                    userId: metadata.context.userId,\n                    contentLength: prompt.length,\n                    lessonType: metadata.context.lessonType,\n                    timestamp: new Date(),\n                    requestId,\n                    apiEndpoint: url\n                };\n                const classifiedError = _error_classifier__WEBPACK_IMPORTED_MODULE_0__.errorClassifier.classifyError(aiError, errorContext);\n                _usage_monitor__WEBPACK_IMPORTED_MODULE_1__.usageMonitor.logError(aiError, classifiedError.type, metadata.context);\n            }\n            // Check if this is a retryable network error\n            if (this.isNetworkError(aiError) && retryAttempt < this.maxRetries) {\n                const delay = this.calculateRetryDelay(retryAttempt);\n                console.warn(` Network error, retrying in ${delay}ms...`);\n                await this.sleep(delay);\n                return this.makeGeminiRequestWithRetry(prompt, options, metadata, retryAttempt + 1);\n            }\n            console.error(` API call failed [${requestId}]:`, aiError.message);\n            throw aiError;\n        }\n    }\n    /**\n   * Extract token usage from API response\n   */ extractTokenUsage(result, estimatedInputTokens) {\n        // Try to extract actual token usage from response metadata\n        let inputTokens = estimatedInputTokens;\n        let outputTokens = 0;\n        // Check if response includes usage metadata\n        if (result.usageMetadata) {\n            inputTokens = result.usageMetadata.promptTokenCount || estimatedInputTokens;\n            outputTokens = result.usageMetadata.candidatesTokenCount || 0;\n        } else if (result.candidates && result.candidates[0]?.content?.parts?.[0]?.text) {\n            // Estimate output tokens from response text\n            const responseText = result.candidates[0].content.parts[0].text;\n            outputTokens = Math.ceil(responseText.length / 4);\n        }\n        return {\n            inputTokens,\n            outputTokens,\n            totalTokens: inputTokens + outputTokens\n        };\n    }\n    /**\n   * Check if error is retryable based on status code\n   */ isRetryableError(status) {\n        return [\n            429,\n            500,\n            502,\n            503,\n            504\n        ].includes(status);\n    }\n    /**\n   * Check if error is a network error\n   */ isNetworkError(error) {\n        const networkIndicators = [\n            \"fetch\",\n            \"network\",\n            \"connection\",\n            \"timeout\",\n            \"ECONNREFUSED\",\n            \"ENOTFOUND\",\n            \"ETIMEDOUT\"\n        ];\n        const errorMessage = error.message.toLowerCase();\n        return networkIndicators.some((indicator)=>errorMessage.includes(indicator));\n    }\n    /**\n   * Calculate retry delay with exponential backoff\n   */ calculateRetryDelay(retryAttempt) {\n        const delay = this.baseRetryDelay * Math.pow(2, retryAttempt);\n        const jitter = Math.random() * 0.1 * delay; // Add 10% jitter\n        return Math.min(delay + jitter, this.maxRetryDelay);\n    }\n    /**\n   * Sleep utility for retry delays\n   */ sleep(ms) {\n        return new Promise((resolve)=>setTimeout(resolve, ms));\n    }\n    /**\n   * Generate unique request ID for tracking\n   */ generateRequestId() {\n        return `req_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    }\n    /**\n   * Process batch requests with intelligent batching\n   */ async processBatch(requests) {\n        console.log(` Processing batch of ${requests.length} requests`);\n        const results = [];\n        const batchSize = 5; // Process in smaller batches to avoid overwhelming the API\n        for(let i = 0; i < requests.length; i += batchSize){\n            const batch = requests.slice(i, i + batchSize);\n            console.log(` Processing batch ${Math.floor(i / batchSize) + 1}/${Math.ceil(requests.length / batchSize)}`);\n            // Process batch requests concurrently\n            const batchPromises = batch.map(async (request)=>{\n                try {\n                    const result = await this.makeGeminiRequest(request.prompt, request.options, request.metadata);\n                    return {\n                        id: request.id,\n                        result\n                    };\n                } catch (error) {\n                    return {\n                        id: request.id,\n                        error: error\n                    };\n                }\n            });\n            const batchResults = await Promise.all(batchPromises);\n            results.push(...batchResults);\n            // Add delay between batches to respect rate limits\n            if (i + batchSize < requests.length) {\n                await this.sleep(500); // 500ms delay between batches\n            }\n        }\n        console.log(` Batch processing complete: ${results.filter((r)=>r.result).length} successful, ${results.filter((r)=>r.error).length} failed`);\n        return results;\n    }\n    async summarize(text, options = {}, metadata) {\n        const summaryType = options.type || \"key-points\";\n        const length = options.length || \"medium\";\n        const lengthInstructions = {\n            short: \"in 2-3 sentences\",\n            medium: \"in 4-6 sentences\",\n            long: \"in 7-10 sentences\"\n        };\n        const typeInstructions = {\n            \"key-points\": \"Extract and summarize the key points\",\n            \"tl-dr\": \"Create a TL;DR summary\",\n            \"teaser\": \"Write an engaging teaser summary\",\n            \"headline\": \"Create a headline-style summary\"\n        };\n        const prompt = `${typeInstructions[summaryType]} of the following text ${lengthInstructions[length]}:\n\n${text}\n\nSummary:`;\n        const requestMetadata = {\n            section: \"summarize\",\n            optimization: \"content_summarization\",\n            ...metadata\n        };\n        try {\n            return await this.makeGeminiRequest(prompt, {\n                temperature: 0.3\n            }, requestMetadata);\n        } catch (error) {\n            console.error(\"Summarization failed:\", error);\n            // Re-throw error instead of fallback to maintain AI-only approach\n            throw error;\n        }\n    }\n    async translate(text, options, metadata) {\n        const targetLang = this.getLanguageName(options.targetLanguage);\n        const prompt = `Translate the following text to ${targetLang}. Maintain the original meaning and tone:\n\n${text}\n\nTranslation:`;\n        const requestMetadata = {\n            section: \"translate\",\n            optimization: \"direct_translation\",\n            ...metadata\n        };\n        try {\n            return await this.makeGeminiRequest(prompt, {\n                temperature: 0.2\n            }, requestMetadata);\n        } catch (error) {\n            console.error(\"Translation failed:\", error);\n            // Re-throw error instead of fallback to maintain AI-only approach\n            throw error;\n        }\n    }\n    async prompt(prompt, options = {}, metadata) {\n        const requestMetadata = {\n            section: \"prompt\",\n            optimization: \"direct_prompt\",\n            ...metadata\n        };\n        try {\n            return await this.makeGeminiRequest(prompt, options, requestMetadata);\n        } catch (error) {\n            console.error(\"Prompt generation failed:\", error);\n            throw error;\n        }\n    }\n    async write(prompt, options = {}, metadata) {\n        const tone = options.tone || \"casual\";\n        const length = options.length || \"medium\";\n        const format = options.format || \"paragraph\";\n        const lengthInstructions = {\n            short: \"Keep it brief and concise\",\n            medium: \"Write a moderate length response\",\n            long: \"Provide a detailed and comprehensive response\"\n        };\n        const formatInstructions = {\n            paragraph: \"Write in paragraph form\",\n            \"bullet-points\": \"Format as bullet points\",\n            \"numbered-list\": \"Format as a numbered list\"\n        };\n        const enhancedPrompt = `${prompt}\n\nInstructions:\n- Tone: ${tone}\n- ${lengthInstructions[length]}\n- ${formatInstructions[format]}\n\nResponse:`;\n        const requestMetadata = {\n            section: \"write\",\n            optimization: \"structured_writing\",\n            ...metadata\n        };\n        try {\n            return await this.makeGeminiRequest(enhancedPrompt, {\n                temperature: 0.7\n            }, requestMetadata);\n        } catch (error) {\n            console.error(\"Writing failed:\", error);\n            throw error;\n        }\n    }\n    async rewrite(text, options = {}, metadata) {\n        const tone = options.tone || \"casual\";\n        const length = options.length || \"same\";\n        const audience = options.audience || \"general\";\n        const lengthInstructions = {\n            shorter: \"Make it more concise\",\n            longer: \"Expand and add more detail\",\n            same: \"Keep approximately the same length\"\n        };\n        const prompt = `Rewrite the following text with these requirements:\n- Tone: ${tone}\n- Audience: ${audience}\n- Length: ${lengthInstructions[length]}\n\nOriginal text:\n${text}\n\nRewritten text:`;\n        const requestMetadata = {\n            section: \"rewrite\",\n            optimization: \"content_rewriting\",\n            ...metadata\n        };\n        try {\n            return await this.makeGeminiRequest(prompt, {\n                temperature: 0.5\n            }, requestMetadata);\n        } catch (error) {\n            console.error(\"Rewriting failed:\", error);\n            // Re-throw error instead of fallback to maintain AI-only approach\n            throw error;\n        }\n    }\n    async proofread(text, options = {}, metadata) {\n        const checkGrammar = options.checkGrammar !== false;\n        const checkSpelling = options.checkSpelling !== false;\n        const checkStyle = options.checkStyle !== false;\n        const checks = [];\n        if (checkGrammar) checks.push(\"grammar\");\n        if (checkSpelling) checks.push(\"spelling\");\n        if (checkStyle) checks.push(\"style and clarity\");\n        const prompt = `Proofread and correct the following text for ${checks.join(\", \")}. Return only the corrected text:\n\n${text}\n\nCorrected text:`;\n        const requestMetadata = {\n            section: \"proofread\",\n            optimization: \"text_correction\",\n            ...metadata\n        };\n        try {\n            const correctedText = await this.makeGeminiRequest(prompt, {\n                temperature: 0.2\n            }, requestMetadata);\n            return {\n                corrected_text: correctedText,\n                suggestions: [],\n                errors: []\n            };\n        } catch (error) {\n            console.error(\"Proofreading failed:\", error);\n            // Re-throw error instead of fallback to maintain AI-only approach\n            throw error;\n        }\n    }\n    getLanguageName(code) {\n        const languageMap = {\n            es: \"Spanish\",\n            fr: \"French\",\n            de: \"German\",\n            it: \"Italian\",\n            pt: \"Portuguese\",\n            ja: \"Japanese\",\n            ko: \"Korean\",\n            zh: \"Chinese\",\n            en: \"English\"\n        };\n        return languageMap[code] || \"English\";\n    }\n}\n// Server-side only initialization\nconst createGoogleAIServerService = ()=>{\n    const apiKey = \"AIzaSyAkDCpwWTPKYftoc1Fdm77P6B00Lj89Lio\";\n    const baseUrl = \"https://generativelanguage.googleapis.com\" || 0;\n    if (!apiKey) {\n        console.warn(\"Google AI API key not found. Lesson generation will use fallback templates.\");\n        // Return a service that will always throw errors, triggering fallbacks\n        return new GoogleAIServerService({\n            apiKey: \"dummy\",\n            baseUrl\n        });\n    }\n    return new GoogleAIServerService({\n        apiKey,\n        baseUrl\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZ29vZ2xlLWFpLXNlcnZlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxvREFBb0Q7QUFDa0M7QUFDZjtBQTBFdkUsTUFBTUU7SUFPSkMsWUFBWUMsTUFBc0IsQ0FBRTthQUw1QkMsUUFBZ0IsMEJBQTBCLDZCQUE2Qjs7YUFDOURDLGFBQWE7YUFDYkMsaUJBQWlCLEtBQU0sV0FBVzs7YUFDbENDLGdCQUFnQixNQUFPLGFBQWE7O1FBR25ELElBQUksQ0FBQ0osTUFBTSxHQUFHQTtJQUNoQjtJQUVBLE1BQWNLLGtCQUNaQyxNQUFjLEVBQ2RDLFVBQWUsQ0FBQyxDQUFDLEVBQ2pCQyxRQUEwQixFQUNUO1FBQ2pCLE9BQU8sSUFBSSxDQUFDQywwQkFBMEIsQ0FBQ0gsUUFBUUMsU0FBU0MsVUFBVTtJQUNwRTtJQUVBLE1BQWNDLDJCQUNaSCxNQUFjLEVBQ2RDLFVBQWUsQ0FBQyxDQUFDLEVBQ2pCQyxRQUEwQixFQUMxQkUsZUFBdUIsQ0FBQyxFQUNQO1FBQ2pCLE1BQU1DLFlBQVlDLEtBQUtDLEdBQUc7UUFDMUIsTUFBTUMsWUFBWSxJQUFJLENBQUNDLGlCQUFpQjtRQUV4QyxNQUFNQyxjQUFjO1lBQ2xCQyxVQUFVO2dCQUFDO29CQUNUQyxPQUFPO3dCQUFDOzRCQUNOQyxNQUFNYjt3QkFDUjtxQkFBRTtnQkFDSjthQUFFO1lBQ0ZjLGtCQUFrQjtnQkFDaEJDLGFBQWFkLFFBQVFjLFdBQVcsSUFBSTtnQkFDcENDLGlCQUFpQmYsUUFBUWdCLFNBQVMsSUFBSTtnQkFDdENDLE1BQU1qQixRQUFRaUIsSUFBSSxJQUFJO1lBQ3hCO1FBQ0Y7UUFFQSxzRUFBc0U7UUFDdEUsTUFBTUMsdUJBQXVCQyxLQUFLQyxJQUFJLENBQUNyQixPQUFPc0IsTUFBTSxHQUFHO1FBRXZELE1BQU1DLE1BQU0sQ0FBQyxFQUFFLElBQUksQ0FBQzdCLE1BQU0sQ0FBQzhCLE9BQU8sQ0FBQyxvREFBb0QsRUFBRSxJQUFJLENBQUM5QixNQUFNLENBQUMrQixNQUFNLENBQUMsQ0FBQztRQUM3R0MsUUFBUUMsR0FBRyxDQUFDLENBQUMsZ0JBQWdCLEVBQUVuQixVQUFVLFlBQVksRUFBRUosZUFBZSxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUNSLFVBQVUsR0FBRyxFQUFFLENBQUM7UUFDaEc4QixRQUFRQyxHQUFHLENBQUMsQ0FBQywyQkFBMkIsRUFBRVIscUJBQXFCLENBQUM7UUFFaEUsSUFBSTtZQUNGLE1BQU1TLFdBQVcsTUFBTUMsTUFBTU4sS0FBSztnQkFDaENPLFFBQVE7Z0JBQ1JDLFNBQVM7b0JBQ1AsZ0JBQWdCO2dCQUNsQjtnQkFDQUMsTUFBTUMsS0FBS0MsU0FBUyxDQUFDeEI7WUFDdkI7WUFFQWdCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGFBQWEsRUFBRW5CLFVBQVUsR0FBRyxFQUFFb0IsU0FBU08sTUFBTSxDQUFDLENBQUMsRUFBRVAsU0FBU1EsVUFBVSxDQUFDLENBQUM7WUFFbkYsSUFBSVIsU0FBU1MsRUFBRSxFQUFFO2dCQUNmLE1BQU1DLFNBQVMsTUFBTVYsU0FBU1csSUFBSTtnQkFDbEMsTUFBTUMsVUFBVWxDLEtBQUtDLEdBQUc7Z0JBQ3hCLE1BQU1rQyxlQUFlRCxVQUFVbkM7Z0JBRS9CcUIsUUFBUUMsR0FBRyxDQUFDO2dCQUVaLCtDQUErQztnQkFDL0MsTUFBTWUsYUFBYSxJQUFJLENBQUNDLGlCQUFpQixDQUFDTCxRQUFRbkI7Z0JBRWxELGtCQUFrQjtnQkFDbEIsSUFBSWpCLFVBQVUwQyxXQUFXRixZQUFZO29CQUNuQ25ELHdEQUFZQSxDQUFDc0QsYUFBYSxDQUN4QjNDLFNBQVMwQyxPQUFPLEVBQ2hCRixXQUFXSSxXQUFXLEVBQ3RCNUMsU0FBUzZDLFlBQVksSUFBSSxRQUN6QjdDLFNBQVM4QyxPQUFPO2dCQUVwQjtnQkFFQSx5QkFBeUI7Z0JBQ3pCLElBQUlWLE9BQU9XLFVBQVUsSUFBSVgsT0FBT1csVUFBVSxDQUFDM0IsTUFBTSxHQUFHLEdBQUc7b0JBQ3JELE1BQU00QixZQUFZWixPQUFPVyxVQUFVLENBQUMsRUFBRTtvQkFFdEMsbUNBQW1DO29CQUNuQyxJQUFJQyxVQUFVQyxZQUFZLEtBQUssY0FBYzt3QkFDM0N6QixRQUFRMEIsSUFBSSxDQUFDO3dCQUNiLDhEQUE4RDt3QkFDOUQsSUFBSUYsVUFBVUcsT0FBTyxJQUFJSCxVQUFVRyxPQUFPLENBQUN6QyxLQUFLLElBQUlzQyxVQUFVRyxPQUFPLENBQUN6QyxLQUFLLENBQUNVLE1BQU0sR0FBRyxHQUFHOzRCQUN0RixNQUFNVCxPQUFPcUMsVUFBVUcsT0FBTyxDQUFDekMsS0FBSyxDQUFDLEVBQUUsQ0FBQ0MsSUFBSTs0QkFDNUMsa0RBQWtEOzRCQUNsRCxJQUFJQSxRQUFRQSxLQUFLeUMsSUFBSSxHQUFHaEMsTUFBTSxHQUFHLEdBQUc7Z0NBQ2xDSSxRQUFRQyxHQUFHLENBQUMsQ0FBQywyQkFBMkIsRUFBRWQsS0FBS1MsTUFBTSxDQUFDLHlCQUF5QixDQUFDO2dDQUNoRixPQUFPVDs0QkFDVDt3QkFDRjt3QkFFQSw4REFBOEQ7d0JBQzlELHlEQUF5RDt3QkFDekQsZ0RBQWdEO3dCQUNoRGEsUUFBUTBCLElBQUksQ0FBQzt3QkFHYixxQ0FBcUM7d0JBQ3JDMUIsUUFBUTZCLEtBQUssQ0FBQzt3QkFDZDdCLFFBQVE2QixLQUFLLENBQUMseUJBQXlCdEIsS0FBS0MsU0FBUyxDQUFDZ0IsV0FBVyxNQUFNO3dCQUN2RSxNQUFNSyxRQUFRLElBQUlDLE1BQU07d0JBQ3hCRCxNQUFNRSxJQUFJLEdBQUc7d0JBQ2IsTUFBTUY7b0JBQ1I7b0JBRUEsNkJBQTZCO29CQUM3QixJQUFJTCxVQUFVRyxPQUFPLElBQUlILFVBQVVHLE9BQU8sQ0FBQ3pDLEtBQUssSUFBSXNDLFVBQVVHLE9BQU8sQ0FBQ3pDLEtBQUssQ0FBQ1UsTUFBTSxHQUFHLEdBQUc7d0JBQ3RGLE1BQU1ULE9BQU9xQyxVQUFVRyxPQUFPLENBQUN6QyxLQUFLLENBQUMsRUFBRSxDQUFDQyxJQUFJO3dCQUM1Q2EsUUFBUUMsR0FBRyxDQUFDLENBQUMsa0JBQWtCLEVBQUVkLEtBQUtTLE1BQU0sQ0FBQyxXQUFXLEVBQUVtQixhQUFhLEVBQUUsQ0FBQzt3QkFDMUUsT0FBTzVCO29CQUNULE9BQU87d0JBQ0wsTUFBTTBDLFFBQVEsSUFBSUMsTUFBTTt3QkFDeEJELE1BQU1FLElBQUksR0FBRzt3QkFDYixNQUFNRjtvQkFDUjtnQkFDRixPQUFPO29CQUNMLE1BQU1BLFFBQVEsSUFBSUMsTUFBTTtvQkFDeEJELE1BQU1FLElBQUksR0FBRztvQkFDYixNQUFNRjtnQkFDUjtZQUNGLE9BQU87Z0JBQ0wsMENBQTBDO2dCQUMxQyxNQUFNRyxZQUFZLE1BQU05QixTQUFTZixJQUFJO2dCQUNyQyxNQUFNMEMsUUFBUSxJQUFJQyxNQUFNLENBQUMsa0JBQWtCLEVBQUU1QixTQUFTTyxNQUFNLENBQUMsQ0FBQyxFQUFFUCxTQUFTUSxVQUFVLENBQUMsR0FBRyxFQUFFc0IsVUFBVSxDQUFDO2dCQUNwR0gsTUFBTXBCLE1BQU0sR0FBR1AsU0FBU08sTUFBTTtnQkFDOUJvQixNQUFNM0IsUUFBUSxHQUFHOEI7Z0JBRWpCLHFDQUFxQztnQkFDckMsSUFBSSxJQUFJLENBQUNDLGdCQUFnQixDQUFDL0IsU0FBU08sTUFBTSxLQUFLL0IsZUFBZSxJQUFJLENBQUNSLFVBQVUsRUFBRTtvQkFDNUUsTUFBTWdFLFFBQVEsSUFBSSxDQUFDQyxtQkFBbUIsQ0FBQ3pEO29CQUN2Q3NCLFFBQVEwQixJQUFJLENBQUMsQ0FBQyxvQkFBb0IsRUFBRXhCLFNBQVNPLE1BQU0sQ0FBQyxlQUFlLEVBQUV5QixNQUFNLEtBQUssQ0FBQztvQkFFakYsTUFBTSxJQUFJLENBQUNFLEtBQUssQ0FBQ0Y7b0JBQ2pCLE9BQU8sSUFBSSxDQUFDekQsMEJBQTBCLENBQUNILFFBQVFDLFNBQVNDLFVBQVVFLGVBQWU7Z0JBQ25GO2dCQUVBLE1BQU1tRDtZQUNSO1FBQ0YsRUFBRSxPQUFPQSxPQUFPO1lBQ2QsTUFBTVEsVUFBVVI7WUFFaEIseUJBQXlCO1lBQ3pCLElBQUlyRCxVQUFVOEMsU0FBUztnQkFDckIsTUFBTWdCLGVBQTZCO29CQUNqQ0MsUUFBUS9ELFNBQVM4QyxPQUFPLENBQUNpQixNQUFNO29CQUMvQkMsZUFBZWxFLE9BQU9zQixNQUFNO29CQUM1QjZDLFlBQVlqRSxTQUFTOEMsT0FBTyxDQUFDbUIsVUFBVTtvQkFDdkNDLFdBQVcsSUFBSTlEO29CQUNmRTtvQkFDQTZELGFBQWE5QztnQkFDZjtnQkFFQSxNQUFNK0Msa0JBQWtCaEYsOERBQWVBLENBQUNpRixhQUFhLENBQUNSLFNBQVNDO2dCQUMvRHpFLHdEQUFZQSxDQUFDaUYsUUFBUSxDQUFDVCxTQUFTTyxnQkFBZ0JHLElBQUksRUFBRXZFLFNBQVM4QyxPQUFPO1lBQ3ZFO1lBRUEsNkNBQTZDO1lBQzdDLElBQUksSUFBSSxDQUFDMEIsY0FBYyxDQUFDWCxZQUFZM0QsZUFBZSxJQUFJLENBQUNSLFVBQVUsRUFBRTtnQkFDbEUsTUFBTWdFLFFBQVEsSUFBSSxDQUFDQyxtQkFBbUIsQ0FBQ3pEO2dCQUN2Q3NCLFFBQVEwQixJQUFJLENBQUMsQ0FBQyw4QkFBOEIsRUFBRVEsTUFBTSxLQUFLLENBQUM7Z0JBRTFELE1BQU0sSUFBSSxDQUFDRSxLQUFLLENBQUNGO2dCQUNqQixPQUFPLElBQUksQ0FBQ3pELDBCQUEwQixDQUFDSCxRQUFRQyxTQUFTQyxVQUFVRSxlQUFlO1lBQ25GO1lBRUFzQixRQUFRNkIsS0FBSyxDQUFDLENBQUMsbUJBQW1CLEVBQUUvQyxVQUFVLEVBQUUsQ0FBQyxFQUFFdUQsUUFBUVksT0FBTztZQUNsRSxNQUFNWjtRQUNSO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELGtCQUEwQnpCLE1BQVcsRUFBRW5CLG9CQUE0QixFQUFjO1FBQy9FLDJEQUEyRDtRQUMzRCxJQUFJeUQsY0FBY3pEO1FBQ2xCLElBQUkwRCxlQUFlO1FBRW5CLDRDQUE0QztRQUM1QyxJQUFJdkMsT0FBT3dDLGFBQWEsRUFBRTtZQUN4QkYsY0FBY3RDLE9BQU93QyxhQUFhLENBQUNDLGdCQUFnQixJQUFJNUQ7WUFDdkQwRCxlQUFldkMsT0FBT3dDLGFBQWEsQ0FBQ0Usb0JBQW9CLElBQUk7UUFDOUQsT0FBTyxJQUFJMUMsT0FBT1csVUFBVSxJQUFJWCxPQUFPVyxVQUFVLENBQUMsRUFBRSxFQUFFSSxTQUFTekMsT0FBTyxDQUFDLEVBQUUsRUFBRUMsTUFBTTtZQUMvRSw0Q0FBNEM7WUFDNUMsTUFBTW9FLGVBQWUzQyxPQUFPVyxVQUFVLENBQUMsRUFBRSxDQUFDSSxPQUFPLENBQUN6QyxLQUFLLENBQUMsRUFBRSxDQUFDQyxJQUFJO1lBQy9EZ0UsZUFBZXpELEtBQUtDLElBQUksQ0FBQzRELGFBQWEzRCxNQUFNLEdBQUc7UUFDakQ7UUFFQSxPQUFPO1lBQ0xzRDtZQUNBQztZQUNBL0IsYUFBYThCLGNBQWNDO1FBQzdCO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELGlCQUF5QjFDLE1BQWMsRUFBVztRQUNoRCxPQUFPO1lBQUM7WUFBSztZQUFLO1lBQUs7WUFBSztTQUFJLENBQUMrQyxRQUFRLENBQUMvQztJQUM1QztJQUVBOztHQUVDLEdBQ0QsZUFBdUJvQixLQUFjLEVBQVc7UUFDOUMsTUFBTTRCLG9CQUFvQjtZQUFDO1lBQVM7WUFBVztZQUFjO1lBQVc7WUFBZ0I7WUFBYTtTQUFZO1FBQ2pILE1BQU1DLGVBQWU3QixNQUFNb0IsT0FBTyxDQUFDVSxXQUFXO1FBQzlDLE9BQU9GLGtCQUFrQkcsSUFBSSxDQUFDQyxDQUFBQSxZQUFhSCxhQUFhRixRQUFRLENBQUNLO0lBQ25FO0lBRUE7O0dBRUMsR0FDRCxvQkFBNEJuRixZQUFvQixFQUFVO1FBQ3hELE1BQU13RCxRQUFRLElBQUksQ0FBQy9ELGNBQWMsR0FBR3VCLEtBQUtvRSxHQUFHLENBQUMsR0FBR3BGO1FBQ2hELE1BQU1xRixTQUFTckUsS0FBS3NFLE1BQU0sS0FBSyxNQUFNOUIsT0FBTyxpQkFBaUI7UUFDN0QsT0FBT3hDLEtBQUt1RSxHQUFHLENBQUMvQixRQUFRNkIsUUFBUSxJQUFJLENBQUMzRixhQUFhO0lBQ3BEO0lBRUE7O0dBRUMsR0FDRCxNQUFjOEYsRUFBVSxFQUFpQjtRQUN2QyxPQUFPLElBQUlDLFFBQVFDLENBQUFBLFVBQVdDLFdBQVdELFNBQVNGO0lBQ3BEO0lBRUE7O0dBRUMsR0FDRCxvQkFBb0M7UUFDbEMsT0FBTyxDQUFDLElBQUksRUFBRXRGLEtBQUtDLEdBQUcsR0FBRyxDQUFDLEVBQUVhLEtBQUtzRSxNQUFNLEdBQUdNLFFBQVEsQ0FBQyxJQUFJQyxNQUFNLENBQUMsR0FBRyxHQUFHLENBQUM7SUFDdkU7SUFFQTs7R0FFQyxHQUNELE1BQU1DLGFBQWFDLFFBQXdCLEVBQTRCO1FBQ3JFekUsUUFBUUMsR0FBRyxDQUFDLENBQUMsdUJBQXVCLEVBQUV3RSxTQUFTN0UsTUFBTSxDQUFDLFNBQVMsQ0FBQztRQUVoRSxNQUFNOEUsVUFBMkIsRUFBRTtRQUNuQyxNQUFNQyxZQUFZLEdBQUcsMkRBQTJEO1FBRWhGLElBQUssSUFBSUMsSUFBSSxHQUFHQSxJQUFJSCxTQUFTN0UsTUFBTSxFQUFFZ0YsS0FBS0QsVUFBVztZQUNuRCxNQUFNRSxRQUFRSixTQUFTSyxLQUFLLENBQUNGLEdBQUdBLElBQUlEO1lBQ3BDM0UsUUFBUUMsR0FBRyxDQUFDLENBQUMsb0JBQW9CLEVBQUVQLEtBQUtxRixLQUFLLENBQUNILElBQUlELGFBQWEsRUFBRSxDQUFDLEVBQUVqRixLQUFLQyxJQUFJLENBQUM4RSxTQUFTN0UsTUFBTSxHQUFHK0UsV0FBVyxDQUFDO1lBRTVHLHNDQUFzQztZQUN0QyxNQUFNSyxnQkFBZ0JILE1BQU1JLEdBQUcsQ0FBQyxPQUFPQztnQkFDckMsSUFBSTtvQkFDRixNQUFNdEUsU0FBUyxNQUFNLElBQUksQ0FBQ3ZDLGlCQUFpQixDQUN6QzZHLFFBQVE1RyxNQUFNLEVBQ2Q0RyxRQUFRM0csT0FBTyxFQUNmMkcsUUFBUTFHLFFBQVE7b0JBR2xCLE9BQU87d0JBQ0wyRyxJQUFJRCxRQUFRQyxFQUFFO3dCQUNkdkU7b0JBQ0Y7Z0JBQ0YsRUFBRSxPQUFPaUIsT0FBTztvQkFDZCxPQUFPO3dCQUNMc0QsSUFBSUQsUUFBUUMsRUFBRTt3QkFDZHRELE9BQU9BO29CQUNUO2dCQUNGO1lBQ0Y7WUFFQSxNQUFNdUQsZUFBZSxNQUFNakIsUUFBUWtCLEdBQUcsQ0FBQ0w7WUFDdkNOLFFBQVFZLElBQUksSUFBSUY7WUFFaEIsbURBQW1EO1lBQ25ELElBQUlSLElBQUlELFlBQVlGLFNBQVM3RSxNQUFNLEVBQUU7Z0JBQ25DLE1BQU0sSUFBSSxDQUFDd0MsS0FBSyxDQUFDLE1BQU0sOEJBQThCO1lBQ3ZEO1FBQ0Y7UUFFQXBDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLDZCQUE2QixFQUFFeUUsUUFBUWEsTUFBTSxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFNUUsTUFBTSxFQUFFaEIsTUFBTSxDQUFDLGFBQWEsRUFBRThFLFFBQVFhLE1BQU0sQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRTNELEtBQUssRUFBRWpDLE1BQU0sQ0FBQyxPQUFPLENBQUM7UUFDNUksT0FBTzhFO0lBQ1Q7SUFFQSxNQUFNZSxVQUFVdEcsSUFBWSxFQUFFWixVQUE2QixDQUFDLENBQUMsRUFBRUMsUUFBMEIsRUFBRTtRQUN6RixNQUFNa0gsY0FBY25ILFFBQVF3RSxJQUFJLElBQUk7UUFDcEMsTUFBTW5ELFNBQVNyQixRQUFRcUIsTUFBTSxJQUFJO1FBRWpDLE1BQU0rRixxQkFBcUI7WUFDekJDLE9BQU87WUFDUEMsUUFBUTtZQUNSQyxNQUFNO1FBQ1I7UUFFQSxNQUFNQyxtQkFBbUI7WUFDdkIsY0FBYztZQUNkLFNBQVM7WUFDVCxVQUFVO1lBQ1YsWUFBWTtRQUNkO1FBRUEsTUFBTXpILFNBQVMsQ0FBQyxFQUFFeUgsZ0JBQWdCLENBQUNMLFlBQVksQ0FBQyx1QkFBdUIsRUFBRUMsa0JBQWtCLENBQUMvRixPQUFPLENBQUM7O0FBRXhHLEVBQUVULEtBQUs7O1FBRUMsQ0FBQztRQUVMLE1BQU02RyxrQkFBbUM7WUFDdkM5RSxTQUFTO1lBQ1RHLGNBQWM7WUFDZCxHQUFHN0MsUUFBUTtRQUNiO1FBRUEsSUFBSTtZQUNGLE9BQU8sTUFBTSxJQUFJLENBQUNILGlCQUFpQixDQUFDQyxRQUFRO2dCQUFFZSxhQUFhO1lBQUksR0FBRzJHO1FBQ3BFLEVBQUUsT0FBT25FLE9BQU87WUFDZDdCLFFBQVE2QixLQUFLLENBQUMseUJBQXlCQTtZQUN2QyxrRUFBa0U7WUFDbEUsTUFBTUE7UUFDUjtJQUNGO0lBRUEsTUFBTW9FLFVBQVU5RyxJQUFZLEVBQUVaLE9BQTBCLEVBQUVDLFFBQTBCLEVBQUU7UUFDcEYsTUFBTTBILGFBQWEsSUFBSSxDQUFDQyxlQUFlLENBQUM1SCxRQUFRNkgsY0FBYztRQUU5RCxNQUFNOUgsU0FBUyxDQUFDLGdDQUFnQyxFQUFFNEgsV0FBVzs7QUFFakUsRUFBRS9HLEtBQUs7O1lBRUssQ0FBQztRQUVULE1BQU02RyxrQkFBbUM7WUFDdkM5RSxTQUFTO1lBQ1RHLGNBQWM7WUFDZCxHQUFHN0MsUUFBUTtRQUNiO1FBRUEsSUFBSTtZQUNGLE9BQU8sTUFBTSxJQUFJLENBQUNILGlCQUFpQixDQUFDQyxRQUFRO2dCQUFFZSxhQUFhO1lBQUksR0FBRzJHO1FBQ3BFLEVBQUUsT0FBT25FLE9BQU87WUFDZDdCLFFBQVE2QixLQUFLLENBQUMsdUJBQXVCQTtZQUNyQyxrRUFBa0U7WUFDbEUsTUFBTUE7UUFDUjtJQUNGO0lBRUEsTUFBTXZELE9BQU9BLE1BQWMsRUFBRUMsVUFBeUIsQ0FBQyxDQUFDLEVBQUVDLFFBQTBCLEVBQUU7UUFDcEYsTUFBTXdILGtCQUFtQztZQUN2QzlFLFNBQVM7WUFDVEcsY0FBYztZQUNkLEdBQUc3QyxRQUFRO1FBQ2I7UUFFQSxJQUFJO1lBQ0YsT0FBTyxNQUFNLElBQUksQ0FBQ0gsaUJBQWlCLENBQUNDLFFBQVFDLFNBQVN5SDtRQUN2RCxFQUFFLE9BQU9uRSxPQUFPO1lBQ2Q3QixRQUFRNkIsS0FBSyxDQUFDLDZCQUE2QkE7WUFDM0MsTUFBTUE7UUFDUjtJQUNGO0lBRUEsTUFBTXdFLE1BQU0vSCxNQUFjLEVBQUVDLFVBQXlCLENBQUMsQ0FBQyxFQUFFQyxRQUEwQixFQUFFO1FBQ25GLE1BQU04SCxPQUFPL0gsUUFBUStILElBQUksSUFBSTtRQUM3QixNQUFNMUcsU0FBU3JCLFFBQVFxQixNQUFNLElBQUk7UUFDakMsTUFBTTJHLFNBQVNoSSxRQUFRZ0ksTUFBTSxJQUFJO1FBRWpDLE1BQU1aLHFCQUFxQjtZQUN6QkMsT0FBTztZQUNQQyxRQUFRO1lBQ1JDLE1BQU07UUFDUjtRQUVBLE1BQU1VLHFCQUFxQjtZQUN6QkMsV0FBVztZQUNYLGlCQUFpQjtZQUNqQixpQkFBaUI7UUFDbkI7UUFFQSxNQUFNQyxpQkFBaUIsQ0FBQyxFQUFFcEksT0FBTzs7O1FBRzdCLEVBQUVnSSxLQUFLO0VBQ2IsRUFBRVgsa0JBQWtCLENBQUMvRixPQUFPLENBQUM7RUFDN0IsRUFBRTRHLGtCQUFrQixDQUFDRCxPQUFPLENBQUM7O1NBRXRCLENBQUM7UUFFTixNQUFNUCxrQkFBbUM7WUFDdkM5RSxTQUFTO1lBQ1RHLGNBQWM7WUFDZCxHQUFHN0MsUUFBUTtRQUNiO1FBRUEsSUFBSTtZQUNGLE9BQU8sTUFBTSxJQUFJLENBQUNILGlCQUFpQixDQUFDcUksZ0JBQWdCO2dCQUFFckgsYUFBYTtZQUFJLEdBQUcyRztRQUM1RSxFQUFFLE9BQU9uRSxPQUFPO1lBQ2Q3QixRQUFRNkIsS0FBSyxDQUFDLG1CQUFtQkE7WUFDakMsTUFBTUE7UUFDUjtJQUNGO0lBRUEsTUFBTThFLFFBQVF4SCxJQUFZLEVBQUVaLFVBQTJCLENBQUMsQ0FBQyxFQUFFQyxRQUEwQixFQUFFO1FBQ3JGLE1BQU04SCxPQUFPL0gsUUFBUStILElBQUksSUFBSTtRQUM3QixNQUFNMUcsU0FBU3JCLFFBQVFxQixNQUFNLElBQUk7UUFDakMsTUFBTWdILFdBQVdySSxRQUFRcUksUUFBUSxJQUFJO1FBRXJDLE1BQU1qQixxQkFBcUI7WUFDekJrQixTQUFTO1lBQ1RDLFFBQVE7WUFDUkMsTUFBTTtRQUNSO1FBRUEsTUFBTXpJLFNBQVMsQ0FBQztRQUNaLEVBQUVnSSxLQUFLO1lBQ0gsRUFBRU0sU0FBUztVQUNiLEVBQUVqQixrQkFBa0IsQ0FBQy9GLE9BQU8sQ0FBQzs7O0FBR3ZDLEVBQUVULEtBQUs7O2VBRVEsQ0FBQztRQUVaLE1BQU02RyxrQkFBbUM7WUFDdkM5RSxTQUFTO1lBQ1RHLGNBQWM7WUFDZCxHQUFHN0MsUUFBUTtRQUNiO1FBRUEsSUFBSTtZQUNGLE9BQU8sTUFBTSxJQUFJLENBQUNILGlCQUFpQixDQUFDQyxRQUFRO2dCQUFFZSxhQUFhO1lBQUksR0FBRzJHO1FBQ3BFLEVBQUUsT0FBT25FLE9BQU87WUFDZDdCLFFBQVE2QixLQUFLLENBQUMscUJBQXFCQTtZQUNuQyxrRUFBa0U7WUFDbEUsTUFBTUE7UUFDUjtJQUNGO0lBRUEsTUFBTW1GLFVBQVU3SCxJQUFZLEVBQUVaLFVBQThCLENBQUMsQ0FBQyxFQUFFQyxRQUEwQixFQUFFO1FBQzFGLE1BQU15SSxlQUFlMUksUUFBUTBJLFlBQVksS0FBSztRQUM5QyxNQUFNQyxnQkFBZ0IzSSxRQUFRMkksYUFBYSxLQUFLO1FBQ2hELE1BQU1DLGFBQWE1SSxRQUFRNEksVUFBVSxLQUFLO1FBRTFDLE1BQU1DLFNBQVMsRUFBRTtRQUNqQixJQUFJSCxjQUFjRyxPQUFPOUIsSUFBSSxDQUFDO1FBQzlCLElBQUk0QixlQUFlRSxPQUFPOUIsSUFBSSxDQUFDO1FBQy9CLElBQUk2QixZQUFZQyxPQUFPOUIsSUFBSSxDQUFDO1FBRTVCLE1BQU1oSCxTQUFTLENBQUMsNkNBQTZDLEVBQUU4SSxPQUFPQyxJQUFJLENBQUMsTUFBTTs7QUFFckYsRUFBRWxJLEtBQUs7O2VBRVEsQ0FBQztRQUVaLE1BQU02RyxrQkFBbUM7WUFDdkM5RSxTQUFTO1lBQ1RHLGNBQWM7WUFDZCxHQUFHN0MsUUFBUTtRQUNiO1FBRUEsSUFBSTtZQUNGLE1BQU04SSxnQkFBZ0IsTUFBTSxJQUFJLENBQUNqSixpQkFBaUIsQ0FBQ0MsUUFBUTtnQkFBRWUsYUFBYTtZQUFJLEdBQUcyRztZQUNqRixPQUFPO2dCQUNMdUIsZ0JBQWdCRDtnQkFDaEJFLGFBQWEsRUFBRTtnQkFDZkMsUUFBUSxFQUFFO1lBQ1o7UUFDRixFQUFFLE9BQU81RixPQUFPO1lBQ2Q3QixRQUFRNkIsS0FBSyxDQUFDLHdCQUF3QkE7WUFDdEMsa0VBQWtFO1lBQ2xFLE1BQU1BO1FBQ1I7SUFDRjtJQUVRc0UsZ0JBQWdCcEUsSUFBWSxFQUFVO1FBQzVDLE1BQU0yRixjQUFjO1lBQ2xCQyxJQUFJO1lBQ0pDLElBQUk7WUFDSkMsSUFBSTtZQUNKQyxJQUFJO1lBQ0pDLElBQUk7WUFDSkMsSUFBSTtZQUNKQyxJQUFJO1lBQ0pDLElBQUk7WUFDSkMsSUFBSTtRQUNOO1FBQ0EsT0FBT1QsV0FBVyxDQUFDM0YsS0FBSyxJQUFJO0lBQzlCO0FBQ0Y7QUFFQSxrQ0FBa0M7QUFDM0IsTUFBTXFHLDhCQUE4QjtJQUN6QyxNQUFNckksU0FBU3NJLHlDQUF5QztJQUN4RCxNQUFNdkksVUFBVXVJLDJDQUEwQyxJQUFJLENBQTJDO0lBRXpHLElBQUksQ0FBQ3RJLFFBQVE7UUFDWEMsUUFBUTBCLElBQUksQ0FBQztRQUNiLHVFQUF1RTtRQUN2RSxPQUFPLElBQUk1RCxzQkFBc0I7WUFBRWlDLFFBQVE7WUFBU0Q7UUFBUTtJQUM5RDtJQUVBLE9BQU8sSUFBSWhDLHNCQUFzQjtRQUFFaUM7UUFBUUQ7SUFBUTtBQUNyRCxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktdjAtcHJvamVjdC8uL2xpYi9nb29nbGUtYWktc2VydmVyLnRzPzUyZDYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gU2VydmVyLXNpZGUgR29vZ2xlIEFJIChHZW1pbmkpIEFQSXMgc2VydmljZSBsYXllclxuaW1wb3J0IHsgZXJyb3JDbGFzc2lmaWVyLCB0eXBlIEFJRXJyb3IsIHR5cGUgRXJyb3JDb250ZXh0IH0gZnJvbSAnLi9lcnJvci1jbGFzc2lmaWVyJztcbmltcG9ydCB7IHVzYWdlTW9uaXRvciwgdHlwZSBHZW5lcmF0aW9uQ29udGV4dCB9IGZyb20gJy4vdXNhZ2UtbW9uaXRvcic7XG5cbmludGVyZmFjZSBHb29nbGVBSUNvbmZpZyB7XG4gIGFwaUtleTogc3RyaW5nXG4gIGJhc2VVcmw6IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgU3VtbWFyaXplck9wdGlvbnMge1xuICB0eXBlPzogXCJrZXktcG9pbnRzXCIgfCBcInRsLWRyXCIgfCBcInRlYXNlclwiIHwgXCJoZWFkbGluZVwiXG4gIGxlbmd0aD86IFwic2hvcnRcIiB8IFwibWVkaXVtXCIgfCBcImxvbmdcIlxuICBmb3JtYXQ/OiBcIm1hcmtkb3duXCIgfCBcInBsYWluLXRleHRcIlxufVxuXG5pbnRlcmZhY2UgVHJhbnNsYXRvck9wdGlvbnMge1xuICBzb3VyY2VMYW5ndWFnZT86IHN0cmluZ1xuICB0YXJnZXRMYW5ndWFnZTogc3RyaW5nXG59XG5cbmludGVyZmFjZSBQcm9tcHRPcHRpb25zIHtcbiAgdGVtcGVyYXR1cmU/OiBudW1iZXJcbiAgbWF4VG9rZW5zPzogbnVtYmVyXG4gIHRvcFA/OiBudW1iZXJcbn1cblxuaW50ZXJmYWNlIFdyaXRlck9wdGlvbnMge1xuICB0b25lPzogXCJmb3JtYWxcIiB8IFwiY2FzdWFsXCIgfCBcImFjYWRlbWljXCIgfCBcImNyZWF0aXZlXCJcbiAgbGVuZ3RoPzogXCJzaG9ydFwiIHwgXCJtZWRpdW1cIiB8IFwibG9uZ1wiXG4gIGZvcm1hdD86IFwicGFyYWdyYXBoXCIgfCBcImJ1bGxldC1wb2ludHNcIiB8IFwibnVtYmVyZWQtbGlzdFwiXG59XG5cbmludGVyZmFjZSBSZXdyaXRlck9wdGlvbnMge1xuICB0b25lPzogXCJmb3JtYWxcIiB8IFwiY2FzdWFsXCIgfCBcImFjYWRlbWljXCIgfCBcImNyZWF0aXZlXCJcbiAgbGVuZ3RoPzogXCJzaG9ydGVyXCIgfCBcImxvbmdlclwiIHwgXCJzYW1lXCJcbiAgYXVkaWVuY2U/OiBcImdlbmVyYWxcIiB8IFwiZXhwZXJ0XCIgfCBcImJlZ2lubmVyXCJcbn1cblxuaW50ZXJmYWNlIFByb29mcmVhZGVyT3B0aW9ucyB7XG4gIGNoZWNrR3JhbW1hcj86IGJvb2xlYW5cbiAgY2hlY2tTcGVsbGluZz86IGJvb2xlYW5cbiAgY2hlY2tTdHlsZT86IGJvb2xlYW5cbiAgc3VnZ2VzdEltcHJvdmVtZW50cz86IGJvb2xlYW5cbn1cblxuLy8gVG9rZW4gdXNhZ2UgdHJhY2tpbmcgaW50ZXJmYWNlXG5pbnRlcmZhY2UgVG9rZW5Vc2FnZSB7XG4gIGlucHV0VG9rZW5zOiBudW1iZXI7XG4gIG91dHB1dFRva2VuczogbnVtYmVyO1xuICB0b3RhbFRva2VuczogbnVtYmVyO1xufVxuXG4vLyBSZXF1ZXN0IG1ldGFkYXRhIGZvciB0cmFja2luZyBhbmQgb3B0aW1pemF0aW9uXG5pbnRlcmZhY2UgUmVxdWVzdE1ldGFkYXRhIHtcbiAgc2VjdGlvbj86IHN0cmluZztcbiAgb3B0aW1pemF0aW9uPzogc3RyaW5nO1xuICBjb250ZXh0PzogR2VuZXJhdGlvbkNvbnRleHQ7XG4gIHJldHJ5QXR0ZW1wdD86IG51bWJlcjtcbn1cblxuLy8gQmF0Y2ggcmVxdWVzdCBpbnRlcmZhY2VcbmludGVyZmFjZSBCYXRjaFJlcXVlc3Qge1xuICBpZDogc3RyaW5nO1xuICBwcm9tcHQ6IHN0cmluZztcbiAgb3B0aW9uczogYW55O1xuICBtZXRhZGF0YT86IFJlcXVlc3RNZXRhZGF0YTtcbn1cblxuLy8gQmF0Y2ggcmVzcG9uc2UgaW50ZXJmYWNlXG5pbnRlcmZhY2UgQmF0Y2hSZXNwb25zZSB7XG4gIGlkOiBzdHJpbmc7XG4gIHJlc3VsdD86IHN0cmluZztcbiAgZXJyb3I/OiBFcnJvcjtcbiAgdG9rZW5Vc2FnZT86IFRva2VuVXNhZ2U7XG59XG5cbmNsYXNzIEdvb2dsZUFJU2VydmVyU2VydmljZSB7XG4gIHByaXZhdGUgY29uZmlnOiBHb29nbGVBSUNvbmZpZ1xuICBwcml2YXRlIG1vZGVsOiBzdHJpbmcgPSBcIm1vZGVscy9nZW1pbmktMi41LWZsYXNoXCIgLy8gVXNlIGFjdHVhbCBhdmFpbGFibGUgbW9kZWxcbiAgcHJpdmF0ZSByZWFkb25seSBtYXhSZXRyaWVzID0gMztcbiAgcHJpdmF0ZSByZWFkb25seSBiYXNlUmV0cnlEZWxheSA9IDEwMDA7IC8vIDEgc2Vjb25kXG4gIHByaXZhdGUgcmVhZG9ubHkgbWF4UmV0cnlEZWxheSA9IDMwMDAwOyAvLyAzMCBzZWNvbmRzXG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBHb29nbGVBSUNvbmZpZykge1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIG1ha2VHZW1pbmlSZXF1ZXN0KFxuICAgIHByb21wdDogc3RyaW5nLFxuICAgIG9wdGlvbnM6IGFueSA9IHt9LFxuICAgIG1ldGFkYXRhPzogUmVxdWVzdE1ldGFkYXRhXG4gICk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgcmV0dXJuIHRoaXMubWFrZUdlbWluaVJlcXVlc3RXaXRoUmV0cnkocHJvbXB0LCBvcHRpb25zLCBtZXRhZGF0YSwgMCk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIG1ha2VHZW1pbmlSZXF1ZXN0V2l0aFJldHJ5KFxuICAgIHByb21wdDogc3RyaW5nLFxuICAgIG9wdGlvbnM6IGFueSA9IHt9LFxuICAgIG1ldGFkYXRhPzogUmVxdWVzdE1ldGFkYXRhLFxuICAgIHJldHJ5QXR0ZW1wdDogbnVtYmVyID0gMFxuICApOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgY29uc3QgcmVxdWVzdElkID0gdGhpcy5nZW5lcmF0ZVJlcXVlc3RJZCgpO1xuXG4gICAgY29uc3QgcmVxdWVzdEJvZHkgPSB7XG4gICAgICBjb250ZW50czogW3tcbiAgICAgICAgcGFydHM6IFt7XG4gICAgICAgICAgdGV4dDogcHJvbXB0XG4gICAgICAgIH1dXG4gICAgICB9XSxcbiAgICAgIGdlbmVyYXRpb25Db25maWc6IHtcbiAgICAgICAgdGVtcGVyYXR1cmU6IG9wdGlvbnMudGVtcGVyYXR1cmUgfHwgMC43LFxuICAgICAgICBtYXhPdXRwdXRUb2tlbnM6IG9wdGlvbnMubWF4VG9rZW5zIHx8IDgwMDAsIC8vIEluY3JlYXNlZCBmcm9tIDIwMDAgdG8gODAwMCAoR2VtaW5pIGZyZWUgdGllciBzdXBwb3J0cyB1cCB0byA4MTkyKVxuICAgICAgICB0b3BQOiBvcHRpb25zLnRvcFAgfHwgMC45LFxuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBFc3RpbWF0ZSBpbnB1dCB0b2tlbnMgKHJvdWdoIGFwcHJveGltYXRpb246IDEgdG9rZW4g4omIIDQgY2hhcmFjdGVycylcbiAgICBjb25zdCBlc3RpbWF0ZWRJbnB1dFRva2VucyA9IE1hdGguY2VpbChwcm9tcHQubGVuZ3RoIC8gNCk7XG5cbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmNvbmZpZy5iYXNlVXJsfS92MWJldGEvbW9kZWxzL2dlbWluaS0yLjUtZmxhc2g6Z2VuZXJhdGVDb250ZW50P2tleT0ke3RoaXMuY29uZmlnLmFwaUtleX1gO1xuICAgIGNvbnNvbGUubG9nKGDwn4yQIEFQSSBSZXF1ZXN0IFske3JlcXVlc3RJZH1dIC0gQXR0ZW1wdCAke3JldHJ5QXR0ZW1wdCArIDF9LyR7dGhpcy5tYXhSZXRyaWVzICsgMX1gKTtcbiAgICBjb25zb2xlLmxvZyhg8J+TiiBFc3RpbWF0ZWQgaW5wdXQgdG9rZW5zOiAke2VzdGltYXRlZElucHV0VG9rZW5zfWApO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnNvbGUubG9nKGDwn5OhIFJlc3BvbnNlIFske3JlcXVlc3RJZH1dOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBjb25zdCBlbmRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgY29uc3QgcmVzcG9uc2VUaW1lID0gZW5kVGltZSAtIHN0YXJ0VGltZTtcblxuICAgICAgICBjb25zb2xlLmxvZyhcIuKchSBTdWNjZXNzZnVsIEFQSSByZXNwb25zZSByZWNlaXZlZFwiKTtcblxuICAgICAgICAvLyBFeHRyYWN0IHRva2VuIHVzYWdlIGluZm9ybWF0aW9uIGlmIGF2YWlsYWJsZVxuICAgICAgICBjb25zdCB0b2tlblVzYWdlID0gdGhpcy5leHRyYWN0VG9rZW5Vc2FnZShyZXN1bHQsIGVzdGltYXRlZElucHV0VG9rZW5zKTtcblxuICAgICAgICAvLyBMb2cgdG9rZW4gdXNhZ2VcbiAgICAgICAgaWYgKG1ldGFkYXRhPy5zZWN0aW9uICYmIHRva2VuVXNhZ2UpIHtcbiAgICAgICAgICB1c2FnZU1vbml0b3IubG9nVG9rZW5Vc2FnZShcbiAgICAgICAgICAgIG1ldGFkYXRhLnNlY3Rpb24sXG4gICAgICAgICAgICB0b2tlblVzYWdlLnRvdGFsVG9rZW5zLFxuICAgICAgICAgICAgbWV0YWRhdGEub3B0aW1pemF0aW9uIHx8ICdub25lJyxcbiAgICAgICAgICAgIG1ldGFkYXRhLmNvbnRleHRcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUGFyc2UgcmVzcG9uc2UgY29udGVudFxuICAgICAgICBpZiAocmVzdWx0LmNhbmRpZGF0ZXMgJiYgcmVzdWx0LmNhbmRpZGF0ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IGNhbmRpZGF0ZSA9IHJlc3VsdC5jYW5kaWRhdGVzWzBdO1xuXG4gICAgICAgICAgLy8gQ2hlY2sgaWYgd2UgaGl0IE1BWF9UT0tFTlMgbGltaXRcbiAgICAgICAgICBpZiAoY2FuZGlkYXRlLmZpbmlzaFJlYXNvbiA9PT0gXCJNQVhfVE9LRU5TXCIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBIaXQgTUFYX1RPS0VOUyBsaW1pdCwgcmVzcG9uc2UgbWF5IGJlIGluY29tcGxldGVcIik7XG4gICAgICAgICAgICAvLyBBTFdBWVMgcmV0dXJuIHBhcnRpYWwgdGV4dCBpZiBhdmFpbGFibGUgLSBkb24ndCB0aHJvdyBlcnJvclxuICAgICAgICAgICAgaWYgKGNhbmRpZGF0ZS5jb250ZW50ICYmIGNhbmRpZGF0ZS5jb250ZW50LnBhcnRzICYmIGNhbmRpZGF0ZS5jb250ZW50LnBhcnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGNhbmRpZGF0ZS5jb250ZW50LnBhcnRzWzBdLnRleHQ7XG4gICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRleHQgaXMgYWN0dWFsbHkgcHJlc2VudCBhbmQgbm90IGVtcHR5XG4gICAgICAgICAgICAgIGlmICh0ZXh0ICYmIHRleHQudHJpbSgpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIEV4dHJhY3RlZCBwYXJ0aWFsIHRleHQgKCR7dGV4dC5sZW5ndGh9IGNoYXJzKSBkdWUgdG8gTUFYX1RPS0VOU2ApO1xuICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENSSVRJQ0FMIEZJWDogTUFYX1RPS0VOUyB3aXRoIG5vIGNvbnRlbnQgLSBqdXN0IHRocm93IGVycm9yXG4gICAgICAgICAgICAvLyBUaGUgcmV0cnkgbG9naWMgaXMgdG9vIGNvbXBsZXggYW5kIGNhdXNlcyBzY29wZSBpc3N1ZXNcbiAgICAgICAgICAgIC8vIExldCB0aGUgY2FsbGluZyBjb2RlIGhhbmRsZSBmYWxsYmFja3MgaW5zdGVhZFxuICAgICAgICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIE1BWF9UT0tFTlMgaGl0IHdpdGggbm8gY29udGVudCAtIGNhbm5vdCByZXRyeSBmcm9tIGhlcmVcIik7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gT25seSB0aHJvdyBpZiB3ZSB0cnVseSBjYW4ndCByZXRyeVxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBNQVhfVE9LRU5TIGhpdCBidXQgbm8gY29udGVudCBhdmFpbGFibGUgYW5kIGNhbm5vdCByZXRyeVwiKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgUmVzcG9uc2Ugc3RydWN0dXJlOlwiLCBKU09OLnN0cmluZ2lmeShjYW5kaWRhdGUsIG51bGwsIDIpKTtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiTUFYX1RPS0VOU19FWENFRURFRF9OT19DT05URU5UXCIpIGFzIEFJRXJyb3I7XG4gICAgICAgICAgICBlcnJvci5jb2RlID0gXCJNQVhfVE9LRU5TXCI7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBOb3JtYWwgcmVzcG9uc2UgcHJvY2Vzc2luZ1xuICAgICAgICAgIGlmIChjYW5kaWRhdGUuY29udGVudCAmJiBjYW5kaWRhdGUuY29udGVudC5wYXJ0cyAmJiBjYW5kaWRhdGUuY29udGVudC5wYXJ0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gY2FuZGlkYXRlLmNvbnRlbnQucGFydHNbMF0udGV4dDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDinIUgR2VuZXJhdGVkIHRleHQgKCR7dGV4dC5sZW5ndGh9IGNoYXJzKSBpbiAke3Jlc3BvbnNlVGltZX1tc2ApO1xuICAgICAgICAgICAgcmV0dXJuIHRleHQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiSW52YWxpZCBjb250ZW50IHN0cnVjdHVyZSBpbiBBUEkgcmVzcG9uc2VcIikgYXMgQUlFcnJvcjtcbiAgICAgICAgICAgIGVycm9yLmNvZGUgPSBcIklOVkFMSURfUkVTUE9OU0VfU1RSVUNUVVJFXCI7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoXCJObyBjYW5kaWRhdGVzIGluIEFQSSByZXNwb25zZVwiKSBhcyBBSUVycm9yO1xuICAgICAgICAgIGVycm9yLmNvZGUgPSBcIk5PX0NBTkRJREFURVNcIjtcbiAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gSGFuZGxlIEhUVFAgZXJyb3JzIHdpdGggcG90ZW50aWFsIHJldHJ5XG4gICAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoYEdlbWluaSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9IC0gJHtlcnJvclRleHR9YCkgYXMgQUlFcnJvcjtcbiAgICAgICAgZXJyb3Iuc3RhdHVzID0gcmVzcG9uc2Uuc3RhdHVzO1xuICAgICAgICBlcnJvci5yZXNwb25zZSA9IGVycm9yVGV4dDtcblxuICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgcmV0cnlhYmxlIGVycm9yXG4gICAgICAgIGlmICh0aGlzLmlzUmV0cnlhYmxlRXJyb3IocmVzcG9uc2Uuc3RhdHVzKSAmJiByZXRyeUF0dGVtcHQgPCB0aGlzLm1heFJldHJpZXMpIHtcbiAgICAgICAgICBjb25zdCBkZWxheSA9IHRoaXMuY2FsY3VsYXRlUmV0cnlEZWxheShyZXRyeUF0dGVtcHQpO1xuICAgICAgICAgIGNvbnNvbGUud2Fybihg4pqg77iPIFJldHJ5YWJsZSBlcnJvciAoJHtyZXNwb25zZS5zdGF0dXN9KSwgcmV0cnlpbmcgaW4gJHtkZWxheX1tcy4uLmApO1xuXG4gICAgICAgICAgYXdhaXQgdGhpcy5zbGVlcChkZWxheSk7XG4gICAgICAgICAgcmV0dXJuIHRoaXMubWFrZUdlbWluaVJlcXVlc3RXaXRoUmV0cnkocHJvbXB0LCBvcHRpb25zLCBtZXRhZGF0YSwgcmV0cnlBdHRlbXB0ICsgMSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgYWlFcnJvciA9IGVycm9yIGFzIEFJRXJyb3I7XG5cbiAgICAgIC8vIExvZyBlcnJvciB3aXRoIGNvbnRleHRcbiAgICAgIGlmIChtZXRhZGF0YT8uY29udGV4dCkge1xuICAgICAgICBjb25zdCBlcnJvckNvbnRleHQ6IEVycm9yQ29udGV4dCA9IHtcbiAgICAgICAgICB1c2VySWQ6IG1ldGFkYXRhLmNvbnRleHQudXNlcklkLFxuICAgICAgICAgIGNvbnRlbnRMZW5ndGg6IHByb21wdC5sZW5ndGgsXG4gICAgICAgICAgbGVzc29uVHlwZTogbWV0YWRhdGEuY29udGV4dC5sZXNzb25UeXBlLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgICByZXF1ZXN0SWQsXG4gICAgICAgICAgYXBpRW5kcG9pbnQ6IHVybFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGNsYXNzaWZpZWRFcnJvciA9IGVycm9yQ2xhc3NpZmllci5jbGFzc2lmeUVycm9yKGFpRXJyb3IsIGVycm9yQ29udGV4dCk7XG4gICAgICAgIHVzYWdlTW9uaXRvci5sb2dFcnJvcihhaUVycm9yLCBjbGFzc2lmaWVkRXJyb3IudHlwZSwgbWV0YWRhdGEuY29udGV4dCk7XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIHRoaXMgaXMgYSByZXRyeWFibGUgbmV0d29yayBlcnJvclxuICAgICAgaWYgKHRoaXMuaXNOZXR3b3JrRXJyb3IoYWlFcnJvcikgJiYgcmV0cnlBdHRlbXB0IDwgdGhpcy5tYXhSZXRyaWVzKSB7XG4gICAgICAgIGNvbnN0IGRlbGF5ID0gdGhpcy5jYWxjdWxhdGVSZXRyeURlbGF5KHJldHJ5QXR0ZW1wdCk7XG4gICAgICAgIGNvbnNvbGUud2Fybihg4pqg77iPIE5ldHdvcmsgZXJyb3IsIHJldHJ5aW5nIGluICR7ZGVsYXl9bXMuLi5gKTtcblxuICAgICAgICBhd2FpdCB0aGlzLnNsZWVwKGRlbGF5KTtcbiAgICAgICAgcmV0dXJuIHRoaXMubWFrZUdlbWluaVJlcXVlc3RXaXRoUmV0cnkocHJvbXB0LCBvcHRpb25zLCBtZXRhZGF0YSwgcmV0cnlBdHRlbXB0ICsgMSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBBUEkgY2FsbCBmYWlsZWQgWyR7cmVxdWVzdElkfV06YCwgYWlFcnJvci5tZXNzYWdlKTtcbiAgICAgIHRocm93IGFpRXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhY3QgdG9rZW4gdXNhZ2UgZnJvbSBBUEkgcmVzcG9uc2VcbiAgICovXG4gIHByaXZhdGUgZXh0cmFjdFRva2VuVXNhZ2UocmVzdWx0OiBhbnksIGVzdGltYXRlZElucHV0VG9rZW5zOiBudW1iZXIpOiBUb2tlblVzYWdlIHtcbiAgICAvLyBUcnkgdG8gZXh0cmFjdCBhY3R1YWwgdG9rZW4gdXNhZ2UgZnJvbSByZXNwb25zZSBtZXRhZGF0YVxuICAgIGxldCBpbnB1dFRva2VucyA9IGVzdGltYXRlZElucHV0VG9rZW5zO1xuICAgIGxldCBvdXRwdXRUb2tlbnMgPSAwO1xuXG4gICAgLy8gQ2hlY2sgaWYgcmVzcG9uc2UgaW5jbHVkZXMgdXNhZ2UgbWV0YWRhdGFcbiAgICBpZiAocmVzdWx0LnVzYWdlTWV0YWRhdGEpIHtcbiAgICAgIGlucHV0VG9rZW5zID0gcmVzdWx0LnVzYWdlTWV0YWRhdGEucHJvbXB0VG9rZW5Db3VudCB8fCBlc3RpbWF0ZWRJbnB1dFRva2VucztcbiAgICAgIG91dHB1dFRva2VucyA9IHJlc3VsdC51c2FnZU1ldGFkYXRhLmNhbmRpZGF0ZXNUb2tlbkNvdW50IHx8IDA7XG4gICAgfSBlbHNlIGlmIChyZXN1bHQuY2FuZGlkYXRlcyAmJiByZXN1bHQuY2FuZGlkYXRlc1swXT8uY29udGVudD8ucGFydHM/LlswXT8udGV4dCkge1xuICAgICAgLy8gRXN0aW1hdGUgb3V0cHV0IHRva2VucyBmcm9tIHJlc3BvbnNlIHRleHRcbiAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IHJlc3VsdC5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHNbMF0udGV4dDtcbiAgICAgIG91dHB1dFRva2VucyA9IE1hdGguY2VpbChyZXNwb25zZVRleHQubGVuZ3RoIC8gNCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlucHV0VG9rZW5zLFxuICAgICAgb3V0cHV0VG9rZW5zLFxuICAgICAgdG90YWxUb2tlbnM6IGlucHV0VG9rZW5zICsgb3V0cHV0VG9rZW5zXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBlcnJvciBpcyByZXRyeWFibGUgYmFzZWQgb24gc3RhdHVzIGNvZGVcbiAgICovXG4gIHByaXZhdGUgaXNSZXRyeWFibGVFcnJvcihzdGF0dXM6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIHJldHVybiBbNDI5LCA1MDAsIDUwMiwgNTAzLCA1MDRdLmluY2x1ZGVzKHN0YXR1cyk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgZXJyb3IgaXMgYSBuZXR3b3JrIGVycm9yXG4gICAqL1xuICBwcml2YXRlIGlzTmV0d29ya0Vycm9yKGVycm9yOiBBSUVycm9yKTogYm9vbGVhbiB7XG4gICAgY29uc3QgbmV0d29ya0luZGljYXRvcnMgPSBbJ2ZldGNoJywgJ25ldHdvcmsnLCAnY29ubmVjdGlvbicsICd0aW1lb3V0JywgJ0VDT05OUkVGVVNFRCcsICdFTk9URk9VTkQnLCAnRVRJTUVET1VUJ107XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZS50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiBuZXR3b3JrSW5kaWNhdG9ycy5zb21lKGluZGljYXRvciA9PiBlcnJvck1lc3NhZ2UuaW5jbHVkZXMoaW5kaWNhdG9yKSk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIHJldHJ5IGRlbGF5IHdpdGggZXhwb25lbnRpYWwgYmFja29mZlxuICAgKi9cbiAgcHJpdmF0ZSBjYWxjdWxhdGVSZXRyeURlbGF5KHJldHJ5QXR0ZW1wdDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICBjb25zdCBkZWxheSA9IHRoaXMuYmFzZVJldHJ5RGVsYXkgKiBNYXRoLnBvdygyLCByZXRyeUF0dGVtcHQpO1xuICAgIGNvbnN0IGppdHRlciA9IE1hdGgucmFuZG9tKCkgKiAwLjEgKiBkZWxheTsgLy8gQWRkIDEwJSBqaXR0ZXJcbiAgICByZXR1cm4gTWF0aC5taW4oZGVsYXkgKyBqaXR0ZXIsIHRoaXMubWF4UmV0cnlEZWxheSk7XG4gIH1cblxuICAvKipcbiAgICogU2xlZXAgdXRpbGl0eSBmb3IgcmV0cnkgZGVsYXlzXG4gICAqL1xuICBwcml2YXRlIHNsZWVwKG1zOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgdW5pcXVlIHJlcXVlc3QgSUQgZm9yIHRyYWNraW5nXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlUmVxdWVzdElkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGByZXFfJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gO1xuICB9XG5cbiAgLyoqXG4gICAqIFByb2Nlc3MgYmF0Y2ggcmVxdWVzdHMgd2l0aCBpbnRlbGxpZ2VudCBiYXRjaGluZ1xuICAgKi9cbiAgYXN5bmMgcHJvY2Vzc0JhdGNoKHJlcXVlc3RzOiBCYXRjaFJlcXVlc3RbXSk6IFByb21pc2U8QmF0Y2hSZXNwb25zZVtdPiB7XG4gICAgY29uc29sZS5sb2coYPCflIQgUHJvY2Vzc2luZyBiYXRjaCBvZiAke3JlcXVlc3RzLmxlbmd0aH0gcmVxdWVzdHNgKTtcblxuICAgIGNvbnN0IHJlc3VsdHM6IEJhdGNoUmVzcG9uc2VbXSA9IFtdO1xuICAgIGNvbnN0IGJhdGNoU2l6ZSA9IDU7IC8vIFByb2Nlc3MgaW4gc21hbGxlciBiYXRjaGVzIHRvIGF2b2lkIG92ZXJ3aGVsbWluZyB0aGUgQVBJXG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlcXVlc3RzLmxlbmd0aDsgaSArPSBiYXRjaFNpemUpIHtcbiAgICAgIGNvbnN0IGJhdGNoID0gcmVxdWVzdHMuc2xpY2UoaSwgaSArIGJhdGNoU2l6ZSk7XG4gICAgICBjb25zb2xlLmxvZyhg8J+TpiBQcm9jZXNzaW5nIGJhdGNoICR7TWF0aC5mbG9vcihpIC8gYmF0Y2hTaXplKSArIDF9LyR7TWF0aC5jZWlsKHJlcXVlc3RzLmxlbmd0aCAvIGJhdGNoU2l6ZSl9YCk7XG5cbiAgICAgIC8vIFByb2Nlc3MgYmF0Y2ggcmVxdWVzdHMgY29uY3VycmVudGx5XG4gICAgICBjb25zdCBiYXRjaFByb21pc2VzID0gYmF0Y2gubWFwKGFzeW5jIChyZXF1ZXN0KTogUHJvbWlzZTxCYXRjaFJlc3BvbnNlPiA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5tYWtlR2VtaW5pUmVxdWVzdChcbiAgICAgICAgICAgIHJlcXVlc3QucHJvbXB0LFxuICAgICAgICAgICAgcmVxdWVzdC5vcHRpb25zLFxuICAgICAgICAgICAgcmVxdWVzdC5tZXRhZGF0YVxuICAgICAgICAgICk7XG5cbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IHJlcXVlc3QuaWQsXG4gICAgICAgICAgICByZXN1bHRcbiAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogcmVxdWVzdC5pZCxcbiAgICAgICAgICAgIGVycm9yOiBlcnJvciBhcyBFcnJvclxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBiYXRjaFJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbChiYXRjaFByb21pc2VzKTtcbiAgICAgIHJlc3VsdHMucHVzaCguLi5iYXRjaFJlc3VsdHMpO1xuXG4gICAgICAvLyBBZGQgZGVsYXkgYmV0d2VlbiBiYXRjaGVzIHRvIHJlc3BlY3QgcmF0ZSBsaW1pdHNcbiAgICAgIGlmIChpICsgYmF0Y2hTaXplIDwgcmVxdWVzdHMubGVuZ3RoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2xlZXAoNTAwKTsgLy8gNTAwbXMgZGVsYXkgYmV0d2VlbiBiYXRjaGVzXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYOKchSBCYXRjaCBwcm9jZXNzaW5nIGNvbXBsZXRlOiAke3Jlc3VsdHMuZmlsdGVyKHIgPT4gci5yZXN1bHQpLmxlbmd0aH0gc3VjY2Vzc2Z1bCwgJHtyZXN1bHRzLmZpbHRlcihyID0+IHIuZXJyb3IpLmxlbmd0aH0gZmFpbGVkYCk7XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cblxuICBhc3luYyBzdW1tYXJpemUodGV4dDogc3RyaW5nLCBvcHRpb25zOiBTdW1tYXJpemVyT3B0aW9ucyA9IHt9LCBtZXRhZGF0YT86IFJlcXVlc3RNZXRhZGF0YSkge1xuICAgIGNvbnN0IHN1bW1hcnlUeXBlID0gb3B0aW9ucy50eXBlIHx8IFwia2V5LXBvaW50c1wiXG4gICAgY29uc3QgbGVuZ3RoID0gb3B0aW9ucy5sZW5ndGggfHwgXCJtZWRpdW1cIlxuXG4gICAgY29uc3QgbGVuZ3RoSW5zdHJ1Y3Rpb25zID0ge1xuICAgICAgc2hvcnQ6IFwiaW4gMi0zIHNlbnRlbmNlc1wiLFxuICAgICAgbWVkaXVtOiBcImluIDQtNiBzZW50ZW5jZXNcIixcbiAgICAgIGxvbmc6IFwiaW4gNy0xMCBzZW50ZW5jZXNcIlxuICAgIH1cblxuICAgIGNvbnN0IHR5cGVJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBcImtleS1wb2ludHNcIjogXCJFeHRyYWN0IGFuZCBzdW1tYXJpemUgdGhlIGtleSBwb2ludHNcIixcbiAgICAgIFwidGwtZHJcIjogXCJDcmVhdGUgYSBUTDtEUiBzdW1tYXJ5XCIsXG4gICAgICBcInRlYXNlclwiOiBcIldyaXRlIGFuIGVuZ2FnaW5nIHRlYXNlciBzdW1tYXJ5XCIsXG4gICAgICBcImhlYWRsaW5lXCI6IFwiQ3JlYXRlIGEgaGVhZGxpbmUtc3R5bGUgc3VtbWFyeVwiXG4gICAgfVxuXG4gICAgY29uc3QgcHJvbXB0ID0gYCR7dHlwZUluc3RydWN0aW9uc1tzdW1tYXJ5VHlwZV19IG9mIHRoZSBmb2xsb3dpbmcgdGV4dCAke2xlbmd0aEluc3RydWN0aW9uc1tsZW5ndGhdfTpcblxuJHt0ZXh0fVxuXG5TdW1tYXJ5OmBcblxuICAgIGNvbnN0IHJlcXVlc3RNZXRhZGF0YTogUmVxdWVzdE1ldGFkYXRhID0ge1xuICAgICAgc2VjdGlvbjogJ3N1bW1hcml6ZScsXG4gICAgICBvcHRpbWl6YXRpb246ICdjb250ZW50X3N1bW1hcml6YXRpb24nLFxuICAgICAgLi4ubWV0YWRhdGFcbiAgICB9O1xuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLm1ha2VHZW1pbmlSZXF1ZXN0KHByb21wdCwgeyB0ZW1wZXJhdHVyZTogMC4zIH0sIHJlcXVlc3RNZXRhZGF0YSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIlN1bW1hcml6YXRpb24gZmFpbGVkOlwiLCBlcnJvcilcbiAgICAgIC8vIFJlLXRocm93IGVycm9yIGluc3RlYWQgb2YgZmFsbGJhY2sgdG8gbWFpbnRhaW4gQUktb25seSBhcHByb2FjaFxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgdHJhbnNsYXRlKHRleHQ6IHN0cmluZywgb3B0aW9uczogVHJhbnNsYXRvck9wdGlvbnMsIG1ldGFkYXRhPzogUmVxdWVzdE1ldGFkYXRhKSB7XG4gICAgY29uc3QgdGFyZ2V0TGFuZyA9IHRoaXMuZ2V0TGFuZ3VhZ2VOYW1lKG9wdGlvbnMudGFyZ2V0TGFuZ3VhZ2UpXG5cbiAgICBjb25zdCBwcm9tcHQgPSBgVHJhbnNsYXRlIHRoZSBmb2xsb3dpbmcgdGV4dCB0byAke3RhcmdldExhbmd9LiBNYWludGFpbiB0aGUgb3JpZ2luYWwgbWVhbmluZyBhbmQgdG9uZTpcblxuJHt0ZXh0fVxuXG5UcmFuc2xhdGlvbjpgXG5cbiAgICBjb25zdCByZXF1ZXN0TWV0YWRhdGE6IFJlcXVlc3RNZXRhZGF0YSA9IHtcbiAgICAgIHNlY3Rpb246ICd0cmFuc2xhdGUnLFxuICAgICAgb3B0aW1pemF0aW9uOiAnZGlyZWN0X3RyYW5zbGF0aW9uJyxcbiAgICAgIC4uLm1ldGFkYXRhXG4gICAgfTtcblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYWtlR2VtaW5pUmVxdWVzdChwcm9tcHQsIHsgdGVtcGVyYXR1cmU6IDAuMiB9LCByZXF1ZXN0TWV0YWRhdGEpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJUcmFuc2xhdGlvbiBmYWlsZWQ6XCIsIGVycm9yKVxuICAgICAgLy8gUmUtdGhyb3cgZXJyb3IgaW5zdGVhZCBvZiBmYWxsYmFjayB0byBtYWludGFpbiBBSS1vbmx5IGFwcHJvYWNoXG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICBhc3luYyBwcm9tcHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM6IFByb21wdE9wdGlvbnMgPSB7fSwgbWV0YWRhdGE/OiBSZXF1ZXN0TWV0YWRhdGEpIHtcbiAgICBjb25zdCByZXF1ZXN0TWV0YWRhdGE6IFJlcXVlc3RNZXRhZGF0YSA9IHtcbiAgICAgIHNlY3Rpb246ICdwcm9tcHQnLFxuICAgICAgb3B0aW1pemF0aW9uOiAnZGlyZWN0X3Byb21wdCcsXG4gICAgICAuLi5tZXRhZGF0YVxuICAgIH07XG5cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMubWFrZUdlbWluaVJlcXVlc3QocHJvbXB0LCBvcHRpb25zLCByZXF1ZXN0TWV0YWRhdGEpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJQcm9tcHQgZ2VuZXJhdGlvbiBmYWlsZWQ6XCIsIGVycm9yKVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cblxuICBhc3luYyB3cml0ZShwcm9tcHQ6IHN0cmluZywgb3B0aW9uczogV3JpdGVyT3B0aW9ucyA9IHt9LCBtZXRhZGF0YT86IFJlcXVlc3RNZXRhZGF0YSkge1xuICAgIGNvbnN0IHRvbmUgPSBvcHRpb25zLnRvbmUgfHwgXCJjYXN1YWxcIlxuICAgIGNvbnN0IGxlbmd0aCA9IG9wdGlvbnMubGVuZ3RoIHx8IFwibWVkaXVtXCJcbiAgICBjb25zdCBmb3JtYXQgPSBvcHRpb25zLmZvcm1hdCB8fCBcInBhcmFncmFwaFwiXG5cbiAgICBjb25zdCBsZW5ndGhJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBzaG9ydDogXCJLZWVwIGl0IGJyaWVmIGFuZCBjb25jaXNlXCIsXG4gICAgICBtZWRpdW06IFwiV3JpdGUgYSBtb2RlcmF0ZSBsZW5ndGggcmVzcG9uc2VcIixcbiAgICAgIGxvbmc6IFwiUHJvdmlkZSBhIGRldGFpbGVkIGFuZCBjb21wcmVoZW5zaXZlIHJlc3BvbnNlXCJcbiAgICB9XG5cbiAgICBjb25zdCBmb3JtYXRJbnN0cnVjdGlvbnMgPSB7XG4gICAgICBwYXJhZ3JhcGg6IFwiV3JpdGUgaW4gcGFyYWdyYXBoIGZvcm1cIixcbiAgICAgIFwiYnVsbGV0LXBvaW50c1wiOiBcIkZvcm1hdCBhcyBidWxsZXQgcG9pbnRzXCIsXG4gICAgICBcIm51bWJlcmVkLWxpc3RcIjogXCJGb3JtYXQgYXMgYSBudW1iZXJlZCBsaXN0XCJcbiAgICB9XG5cbiAgICBjb25zdCBlbmhhbmNlZFByb21wdCA9IGAke3Byb21wdH1cblxuSW5zdHJ1Y3Rpb25zOlxuLSBUb25lOiAke3RvbmV9XG4tICR7bGVuZ3RoSW5zdHJ1Y3Rpb25zW2xlbmd0aF19XG4tICR7Zm9ybWF0SW5zdHJ1Y3Rpb25zW2Zvcm1hdF19XG5cblJlc3BvbnNlOmBcblxuICAgIGNvbnN0IHJlcXVlc3RNZXRhZGF0YTogUmVxdWVzdE1ldGFkYXRhID0ge1xuICAgICAgc2VjdGlvbjogJ3dyaXRlJyxcbiAgICAgIG9wdGltaXphdGlvbjogJ3N0cnVjdHVyZWRfd3JpdGluZycsXG4gICAgICAuLi5tZXRhZGF0YVxuICAgIH07XG5cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMubWFrZUdlbWluaVJlcXVlc3QoZW5oYW5jZWRQcm9tcHQsIHsgdGVtcGVyYXR1cmU6IDAuNyB9LCByZXF1ZXN0TWV0YWRhdGEpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJXcml0aW5nIGZhaWxlZDpcIiwgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJld3JpdGUodGV4dDogc3RyaW5nLCBvcHRpb25zOiBSZXdyaXRlck9wdGlvbnMgPSB7fSwgbWV0YWRhdGE/OiBSZXF1ZXN0TWV0YWRhdGEpIHtcbiAgICBjb25zdCB0b25lID0gb3B0aW9ucy50b25lIHx8IFwiY2FzdWFsXCJcbiAgICBjb25zdCBsZW5ndGggPSBvcHRpb25zLmxlbmd0aCB8fCBcInNhbWVcIlxuICAgIGNvbnN0IGF1ZGllbmNlID0gb3B0aW9ucy5hdWRpZW5jZSB8fCBcImdlbmVyYWxcIlxuXG4gICAgY29uc3QgbGVuZ3RoSW5zdHJ1Y3Rpb25zID0ge1xuICAgICAgc2hvcnRlcjogXCJNYWtlIGl0IG1vcmUgY29uY2lzZVwiLFxuICAgICAgbG9uZ2VyOiBcIkV4cGFuZCBhbmQgYWRkIG1vcmUgZGV0YWlsXCIsXG4gICAgICBzYW1lOiBcIktlZXAgYXBwcm94aW1hdGVseSB0aGUgc2FtZSBsZW5ndGhcIlxuICAgIH1cblxuICAgIGNvbnN0IHByb21wdCA9IGBSZXdyaXRlIHRoZSBmb2xsb3dpbmcgdGV4dCB3aXRoIHRoZXNlIHJlcXVpcmVtZW50czpcbi0gVG9uZTogJHt0b25lfVxuLSBBdWRpZW5jZTogJHthdWRpZW5jZX1cbi0gTGVuZ3RoOiAke2xlbmd0aEluc3RydWN0aW9uc1tsZW5ndGhdfVxuXG5PcmlnaW5hbCB0ZXh0OlxuJHt0ZXh0fVxuXG5SZXdyaXR0ZW4gdGV4dDpgXG5cbiAgICBjb25zdCByZXF1ZXN0TWV0YWRhdGE6IFJlcXVlc3RNZXRhZGF0YSA9IHtcbiAgICAgIHNlY3Rpb246ICdyZXdyaXRlJyxcbiAgICAgIG9wdGltaXphdGlvbjogJ2NvbnRlbnRfcmV3cml0aW5nJyxcbiAgICAgIC4uLm1ldGFkYXRhXG4gICAgfTtcblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYWtlR2VtaW5pUmVxdWVzdChwcm9tcHQsIHsgdGVtcGVyYXR1cmU6IDAuNSB9LCByZXF1ZXN0TWV0YWRhdGEpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJSZXdyaXRpbmcgZmFpbGVkOlwiLCBlcnJvcilcbiAgICAgIC8vIFJlLXRocm93IGVycm9yIGluc3RlYWQgb2YgZmFsbGJhY2sgdG8gbWFpbnRhaW4gQUktb25seSBhcHByb2FjaFxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcHJvb2ZyZWFkKHRleHQ6IHN0cmluZywgb3B0aW9uczogUHJvb2ZyZWFkZXJPcHRpb25zID0ge30sIG1ldGFkYXRhPzogUmVxdWVzdE1ldGFkYXRhKSB7XG4gICAgY29uc3QgY2hlY2tHcmFtbWFyID0gb3B0aW9ucy5jaGVja0dyYW1tYXIgIT09IGZhbHNlXG4gICAgY29uc3QgY2hlY2tTcGVsbGluZyA9IG9wdGlvbnMuY2hlY2tTcGVsbGluZyAhPT0gZmFsc2VcbiAgICBjb25zdCBjaGVja1N0eWxlID0gb3B0aW9ucy5jaGVja1N0eWxlICE9PSBmYWxzZVxuXG4gICAgY29uc3QgY2hlY2tzID0gW11cbiAgICBpZiAoY2hlY2tHcmFtbWFyKSBjaGVja3MucHVzaChcImdyYW1tYXJcIilcbiAgICBpZiAoY2hlY2tTcGVsbGluZykgY2hlY2tzLnB1c2goXCJzcGVsbGluZ1wiKVxuICAgIGlmIChjaGVja1N0eWxlKSBjaGVja3MucHVzaChcInN0eWxlIGFuZCBjbGFyaXR5XCIpXG5cbiAgICBjb25zdCBwcm9tcHQgPSBgUHJvb2ZyZWFkIGFuZCBjb3JyZWN0IHRoZSBmb2xsb3dpbmcgdGV4dCBmb3IgJHtjaGVja3Muam9pbihcIiwgXCIpfS4gUmV0dXJuIG9ubHkgdGhlIGNvcnJlY3RlZCB0ZXh0OlxuXG4ke3RleHR9XG5cbkNvcnJlY3RlZCB0ZXh0OmBcblxuICAgIGNvbnN0IHJlcXVlc3RNZXRhZGF0YTogUmVxdWVzdE1ldGFkYXRhID0ge1xuICAgICAgc2VjdGlvbjogJ3Byb29mcmVhZCcsXG4gICAgICBvcHRpbWl6YXRpb246ICd0ZXh0X2NvcnJlY3Rpb24nLFxuICAgICAgLi4ubWV0YWRhdGFcbiAgICB9O1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvcnJlY3RlZFRleHQgPSBhd2FpdCB0aGlzLm1ha2VHZW1pbmlSZXF1ZXN0KHByb21wdCwgeyB0ZW1wZXJhdHVyZTogMC4yIH0sIHJlcXVlc3RNZXRhZGF0YSlcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvcnJlY3RlZF90ZXh0OiBjb3JyZWN0ZWRUZXh0LFxuICAgICAgICBzdWdnZXN0aW9uczogW10sXG4gICAgICAgIGVycm9yczogW11cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIlByb29mcmVhZGluZyBmYWlsZWQ6XCIsIGVycm9yKVxuICAgICAgLy8gUmUtdGhyb3cgZXJyb3IgaW5zdGVhZCBvZiBmYWxsYmFjayB0byBtYWludGFpbiBBSS1vbmx5IGFwcHJvYWNoXG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldExhbmd1YWdlTmFtZShjb2RlOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGxhbmd1YWdlTWFwID0ge1xuICAgICAgZXM6IFwiU3BhbmlzaFwiLFxuICAgICAgZnI6IFwiRnJlbmNoXCIsXG4gICAgICBkZTogXCJHZXJtYW5cIixcbiAgICAgIGl0OiBcIkl0YWxpYW5cIixcbiAgICAgIHB0OiBcIlBvcnR1Z3Vlc2VcIixcbiAgICAgIGphOiBcIkphcGFuZXNlXCIsXG4gICAgICBrbzogXCJLb3JlYW5cIixcbiAgICAgIHpoOiBcIkNoaW5lc2VcIixcbiAgICAgIGVuOiBcIkVuZ2xpc2hcIlxuICAgIH1cbiAgICByZXR1cm4gbGFuZ3VhZ2VNYXBbY29kZV0gfHwgXCJFbmdsaXNoXCJcbiAgfVxufVxuXG4vLyBTZXJ2ZXItc2lkZSBvbmx5IGluaXRpYWxpemF0aW9uXG5leHBvcnQgY29uc3QgY3JlYXRlR29vZ2xlQUlTZXJ2ZXJTZXJ2aWNlID0gKCkgPT4ge1xuICBjb25zdCBhcGlLZXkgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19HT09HTEVfQUlfQVBJX0tFWVxuICBjb25zdCBiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfR09PR0xFX0FJX0JBU0VfVVJMIHx8IFwiaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb21cIlxuXG4gIGlmICghYXBpS2V5KSB7XG4gICAgY29uc29sZS53YXJuKFwiR29vZ2xlIEFJIEFQSSBrZXkgbm90IGZvdW5kLiBMZXNzb24gZ2VuZXJhdGlvbiB3aWxsIHVzZSBmYWxsYmFjayB0ZW1wbGF0ZXMuXCIpXG4gICAgLy8gUmV0dXJuIGEgc2VydmljZSB0aGF0IHdpbGwgYWx3YXlzIHRocm93IGVycm9ycywgdHJpZ2dlcmluZyBmYWxsYmFja3NcbiAgICByZXR1cm4gbmV3IEdvb2dsZUFJU2VydmVyU2VydmljZSh7IGFwaUtleTogXCJkdW1teVwiLCBiYXNlVXJsIH0pXG4gIH1cblxuICByZXR1cm4gbmV3IEdvb2dsZUFJU2VydmVyU2VydmljZSh7IGFwaUtleSwgYmFzZVVybCB9KVxufVxuXG5leHBvcnQgdHlwZSB7XG4gIFN1bW1hcml6ZXJPcHRpb25zLFxuICBUcmFuc2xhdG9yT3B0aW9ucyxcbiAgUHJvbXB0T3B0aW9ucyxcbiAgV3JpdGVyT3B0aW9ucyxcbiAgUmV3cml0ZXJPcHRpb25zLFxuICBQcm9vZnJlYWRlck9wdGlvbnMsXG4gIFRva2VuVXNhZ2UsXG4gIFJlcXVlc3RNZXRhZGF0YSxcbiAgQmF0Y2hSZXF1ZXN0LFxuICBCYXRjaFJlc3BvbnNlXG59XG4iXSwibmFtZXMiOlsiZXJyb3JDbGFzc2lmaWVyIiwidXNhZ2VNb25pdG9yIiwiR29vZ2xlQUlTZXJ2ZXJTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJtb2RlbCIsIm1heFJldHJpZXMiLCJiYXNlUmV0cnlEZWxheSIsIm1heFJldHJ5RGVsYXkiLCJtYWtlR2VtaW5pUmVxdWVzdCIsInByb21wdCIsIm9wdGlvbnMiLCJtZXRhZGF0YSIsIm1ha2VHZW1pbmlSZXF1ZXN0V2l0aFJldHJ5IiwicmV0cnlBdHRlbXB0Iiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsInJlcXVlc3RJZCIsImdlbmVyYXRlUmVxdWVzdElkIiwicmVxdWVzdEJvZHkiLCJjb250ZW50cyIsInBhcnRzIiwidGV4dCIsImdlbmVyYXRpb25Db25maWciLCJ0ZW1wZXJhdHVyZSIsIm1heE91dHB1dFRva2VucyIsIm1heFRva2VucyIsInRvcFAiLCJlc3RpbWF0ZWRJbnB1dFRva2VucyIsIk1hdGgiLCJjZWlsIiwibGVuZ3RoIiwidXJsIiwiYmFzZVVybCIsImFwaUtleSIsImNvbnNvbGUiLCJsb2ciLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5Iiwic3RhdHVzIiwic3RhdHVzVGV4dCIsIm9rIiwicmVzdWx0IiwianNvbiIsImVuZFRpbWUiLCJyZXNwb25zZVRpbWUiLCJ0b2tlblVzYWdlIiwiZXh0cmFjdFRva2VuVXNhZ2UiLCJzZWN0aW9uIiwibG9nVG9rZW5Vc2FnZSIsInRvdGFsVG9rZW5zIiwib3B0aW1pemF0aW9uIiwiY29udGV4dCIsImNhbmRpZGF0ZXMiLCJjYW5kaWRhdGUiLCJmaW5pc2hSZWFzb24iLCJ3YXJuIiwiY29udGVudCIsInRyaW0iLCJlcnJvciIsIkVycm9yIiwiY29kZSIsImVycm9yVGV4dCIsImlzUmV0cnlhYmxlRXJyb3IiLCJkZWxheSIsImNhbGN1bGF0ZVJldHJ5RGVsYXkiLCJzbGVlcCIsImFpRXJyb3IiLCJlcnJvckNvbnRleHQiLCJ1c2VySWQiLCJjb250ZW50TGVuZ3RoIiwibGVzc29uVHlwZSIsInRpbWVzdGFtcCIsImFwaUVuZHBvaW50IiwiY2xhc3NpZmllZEVycm9yIiwiY2xhc3NpZnlFcnJvciIsImxvZ0Vycm9yIiwidHlwZSIsImlzTmV0d29ya0Vycm9yIiwibWVzc2FnZSIsImlucHV0VG9rZW5zIiwib3V0cHV0VG9rZW5zIiwidXNhZ2VNZXRhZGF0YSIsInByb21wdFRva2VuQ291bnQiLCJjYW5kaWRhdGVzVG9rZW5Db3VudCIsInJlc3BvbnNlVGV4dCIsImluY2x1ZGVzIiwibmV0d29ya0luZGljYXRvcnMiLCJlcnJvck1lc3NhZ2UiLCJ0b0xvd2VyQ2FzZSIsInNvbWUiLCJpbmRpY2F0b3IiLCJwb3ciLCJqaXR0ZXIiLCJyYW5kb20iLCJtaW4iLCJtcyIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsInRvU3RyaW5nIiwic3Vic3RyIiwicHJvY2Vzc0JhdGNoIiwicmVxdWVzdHMiLCJyZXN1bHRzIiwiYmF0Y2hTaXplIiwiaSIsImJhdGNoIiwic2xpY2UiLCJmbG9vciIsImJhdGNoUHJvbWlzZXMiLCJtYXAiLCJyZXF1ZXN0IiwiaWQiLCJiYXRjaFJlc3VsdHMiLCJhbGwiLCJwdXNoIiwiZmlsdGVyIiwiciIsInN1bW1hcml6ZSIsInN1bW1hcnlUeXBlIiwibGVuZ3RoSW5zdHJ1Y3Rpb25zIiwic2hvcnQiLCJtZWRpdW0iLCJsb25nIiwidHlwZUluc3RydWN0aW9ucyIsInJlcXVlc3RNZXRhZGF0YSIsInRyYW5zbGF0ZSIsInRhcmdldExhbmciLCJnZXRMYW5ndWFnZU5hbWUiLCJ0YXJnZXRMYW5ndWFnZSIsIndyaXRlIiwidG9uZSIsImZvcm1hdCIsImZvcm1hdEluc3RydWN0aW9ucyIsInBhcmFncmFwaCIsImVuaGFuY2VkUHJvbXB0IiwicmV3cml0ZSIsImF1ZGllbmNlIiwic2hvcnRlciIsImxvbmdlciIsInNhbWUiLCJwcm9vZnJlYWQiLCJjaGVja0dyYW1tYXIiLCJjaGVja1NwZWxsaW5nIiwiY2hlY2tTdHlsZSIsImNoZWNrcyIsImpvaW4iLCJjb3JyZWN0ZWRUZXh0IiwiY29ycmVjdGVkX3RleHQiLCJzdWdnZXN0aW9ucyIsImVycm9ycyIsImxhbmd1YWdlTWFwIiwiZXMiLCJmciIsImRlIiwiaXQiLCJwdCIsImphIiwia28iLCJ6aCIsImVuIiwiY3JlYXRlR29vZ2xlQUlTZXJ2ZXJTZXJ2aWNlIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX0dPT0dMRV9BSV9BUElfS0VZIiwiTkVYVF9QVUJMSUNfR09PR0xFX0FJX0JBU0VfVVJMIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/google-ai-server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/lesson-ai-generator-server.ts":
/*!*******************************************!*\
  !*** ./lib/lesson-ai-generator-server.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LessonAIServerGenerator: () => (/* binding */ LessonAIServerGenerator),\n/* harmony export */   lessonAIServerGenerator: () => (/* binding */ lessonAIServerGenerator)\n/* harmony export */ });\n/* harmony import */ var _app_layout__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/app/layout */ \"(rsc)/./app/layout.tsx\");\n/* harmony import */ var _google_ai_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./google-ai-server */ \"(rsc)/./lib/google-ai-server.ts\");\n/* harmony import */ var _progressive_generator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./progressive-generator */ \"(rsc)/./lib/progressive-generator.ts\");\n/* harmony import */ var _usage_monitor__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./usage-monitor */ \"(rsc)/./lib/usage-monitor.ts\");\n\n\n\n\nclass LessonAIServerGenerator {\n    getGoogleAI() {\n        if (!this.googleAI) {\n            this.googleAI = (0,_google_ai_server__WEBPACK_IMPORTED_MODULE_1__.createGoogleAIServerService)();\n        }\n        return this.googleAI;\n    }\n    getProgressiveGenerator() {\n        if (!this.progressiveGenerator) {\n            this.progressiveGenerator = new _progressive_generator__WEBPACK_IMPORTED_MODULE_2__.ProgressiveGeneratorImpl();\n        }\n        return this.progressiveGenerator;\n    }\n    // Summarize and adapt content to student level\n    async summarizeAndAdaptContent(sourceText, studentLevel, targetLanguage) {\n        try {\n            const levelGuidance = {\n                \"A1\": \"Use very simple vocabulary, present tense, short sentences (5-8 words). Explain basic concepts clearly.\",\n                \"A2\": \"Use simple vocabulary, basic past/present tense, medium sentences (8-12 words). Include familiar topics.\",\n                \"B1\": \"Use intermediate vocabulary, various tenses, longer sentences (12-15 words). Include opinions and explanations.\",\n                \"B2\": \"Use advanced vocabulary, complex sentences, abstract concepts. Include detailed explanations and analysis.\",\n                \"C1\": \"Use sophisticated vocabulary, complex structures, nuanced ideas. Include cultural and contextual depth.\"\n            };\n            const guidance = levelGuidance[studentLevel] || levelGuidance[\"B1\"];\n            const prompt = `Summarize and rewrite this content for ${studentLevel} level ${targetLanguage} students:\r\n\r\n${sourceText.substring(0, 1000)}\r\n\r\nREQUIREMENTS:\r\n- ${guidance}\r\n- Keep all important information and key concepts\r\n- Make it 200-400 words (appropriate length for reading)\r\n- Use vocabulary appropriate for ${studentLevel} level\r\n- Maintain the main ideas but simplify complex language\r\n- Include specific details and examples\r\n- Make it engaging and educational\r\n\r\nRewrite the content clearly and completely:`;\n            console.log(\"\\uD83D\\uDCDD Content adaptation prompt:\", prompt.length, \"chars\");\n            const response = await this.getGoogleAI().prompt(prompt);\n            return response.trim() || sourceText.substring(0, 400);\n        } catch (error) {\n            console.log(\" Content adaptation failed, using original text\");\n            return sourceText.substring(0, 400);\n        }\n    }\n    async generateLesson(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage, sourceUrl, contentMetadata, structuredContent, wordCount, readingTime, onProgress } = params;\n        // Create usage monitoring context\n        const generationContext = {\n            lessonId: `lesson_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            lessonType,\n            difficultyLevel: studentLevel,\n            contentLength: sourceText.length,\n            timestamp: new Date()\n        };\n        // Validate sourceText\n        if (!sourceText || typeof sourceText !== \"string\") {\n            throw new Error(\"Invalid sourceText: must be a non-empty string\");\n        }\n        console.log(\"\\uD83D\\uDE80 Starting lesson generation with params:\", {\n            textLength: sourceText.length,\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            hasMetadata: !!contentMetadata,\n            hasStructuredContent: !!structuredContent\n        });\n        try {\n            // Step 1: Summarize and adapt content to student level\n            console.log(\"\\uD83D\\uDCDD Step 1: Summarizing and adapting content to student level...\");\n            const adaptationStartTime = Date.now();\n            const adaptedContent = await this.summarizeAndAdaptContent(sourceText, studentLevel, targetLanguage);\n            const adaptationEndTime = Date.now();\n            // Log content adaptation usage\n            _usage_monitor__WEBPACK_IMPORTED_MODULE_3__.usageMonitor.logTokenUsage(\"content-adaptation\", Math.ceil(sourceText.length / 4), \"content-summarization\", generationContext);\n            console.log(\" Content adapted:\", adaptedContent.length, \"chars\");\n            // Step 2: Generate lesson with adapted content\n            console.log(\"\\uD83E\\uDD16 Step 2: Generating lesson with adapted content...\");\n            const lessonGenerationStartTime = Date.now();\n            const lessonStructure = await this.generateMinimalAILesson(adaptedContent, lessonType, studentLevel, targetLanguage, contentMetadata, onProgress);\n            const lessonGenerationEndTime = Date.now();\n            // Log lesson generation usage\n            _usage_monitor__WEBPACK_IMPORTED_MODULE_3__.usageMonitor.logTokenUsage(\"lesson-structure-generation\", Math.ceil(adaptedContent.length / 3), \"structured-generation\", generationContext);\n            console.log(\" Minimal AI lesson generated:\", Object.keys(lessonStructure));\n            // Return properly structured GeneratedLesson object with metadata\n            const finalLesson = {\n                lessonTitle: lessonStructure.lessonTitle,\n                lessonType,\n                studentLevel,\n                targetLanguage,\n                sections: lessonStructure,\n                metadata: _app_layout__WEBPACK_IMPORTED_MODULE_0__.metadata || undefined // Include metadata for banner images, etc.\n            };\n            console.log(\"\\uD83C\\uDFAF Returning AI-generated lesson:\", {\n                lessonType: finalLesson.lessonType,\n                studentLevel: finalLesson.studentLevel,\n                targetLanguage: finalLesson.targetLanguage,\n                sectionsCount: Object.keys(finalLesson.sections).length,\n                warmupCount: finalLesson.sections.warmup?.length || 0,\n                vocabularyCount: finalLesson.sections.vocabulary?.length || 0,\n                hasMetadata: !!_app_layout__WEBPACK_IMPORTED_MODULE_0__.metadata,\n                hasBannerImages: !!_app_layout__WEBPACK_IMPORTED_MODULE_0__.metadata?.bannerImages,\n                metadataKeys: _app_layout__WEBPACK_IMPORTED_MODULE_0__.metadata ? Object.keys(_app_layout__WEBPACK_IMPORTED_MODULE_0__.metadata) : [],\n                bannerImagesCount: _app_layout__WEBPACK_IMPORTED_MODULE_0__.metadata?.bannerImages?.length || 0\n            });\n            console.log(\"\\uD83D\\uDCE6 Full metadata received:\", JSON.stringify(_app_layout__WEBPACK_IMPORTED_MODULE_0__.metadata, null, 2));\n            console.log(\"\\uD83C\\uDF89 Optimized AI lesson generation complete!\");\n            return finalLesson;\n        } catch (error) {\n            // Log error to usage monitor\n            _usage_monitor__WEBPACK_IMPORTED_MODULE_3__.usageMonitor.logError(error, \"LESSON_GENERATION_FAILED\", generationContext);\n            console.error(\" Error in AI lesson generation:\", error);\n            throw error;\n        }\n    }\n    // Progressive AI lesson generation with shared context\n    async generateMinimalAILesson(sourceText, lessonType, studentLevel, targetLanguage, metadata, onProgress) {\n        console.log(\"\\uD83C\\uDFAF Using progressive generation with shared context...\");\n        const progressiveGen = this.getProgressiveGenerator();\n        // Set progress callback if provided\n        if (onProgress) {\n            progressiveGen.setProgressCallback(onProgress, lessonType);\n        }\n        // Step 1: Build shared context for all sections\n        console.log(\"\\uD83C\\uDFD7 Building shared context...\");\n        const sharedContext = await progressiveGen.buildSharedContext(sourceText, lessonType, studentLevel, targetLanguage, metadata // Pass metadata for title fallback\n        );\n        // Step 2: Define lesson sections with dependencies\n        const lessonSections = [\n            {\n                name: \"warmup\",\n                priority: 1,\n                dependencies: []\n            },\n            {\n                name: \"vocabulary\",\n                priority: 2,\n                dependencies: []\n            },\n            {\n                name: \"reading\",\n                priority: 3,\n                dependencies: [\n                    \"vocabulary\"\n                ]\n            },\n            {\n                name: \"comprehension\",\n                priority: 4,\n                dependencies: [\n                    \"reading\"\n                ]\n            },\n            {\n                name: \"discussion\",\n                priority: 5,\n                dependencies: [\n                    \"reading\",\n                    \"comprehension\"\n                ]\n            },\n            {\n                name: \"grammar\",\n                priority: 6,\n                dependencies: [\n                    \"reading\"\n                ]\n            },\n            {\n                name: \"pronunciation\",\n                priority: 7,\n                dependencies: [\n                    \"vocabulary\"\n                ]\n            },\n            {\n                name: \"wrapup\",\n                priority: 8,\n                dependencies: [\n                    \"discussion\"\n                ]\n            }\n        ];\n        // Step 3: Generate sections progressively\n        const generatedSections = [];\n        let currentContext = sharedContext;\n        for (const section of lessonSections){\n            console.log(` Generating section: ${section.name}`);\n            const generatedSection = await progressiveGen.generateSection(section, currentContext, generatedSections);\n            generatedSections.push(generatedSection);\n            // Update context with new section information\n            currentContext = progressiveGen.updateContext(currentContext, generatedSection);\n        }\n        // Step 4: Generate dialogue sections using AI-based progressive generation\n        console.log(\"\\uD83C\\uDFAD Generating dialogue sections with AI...\");\n        const dialoguePractice = await progressiveGen.generateDialoguePracticeWithContext(sharedContext, generatedSections);\n        const dialogueFillGap = await progressiveGen.generateDialogueFillGapWithContext(sharedContext, generatedSections);\n        // Step 5: Assemble final lesson structure\n        const lessonStructure = {};\n        for (const section of generatedSections){\n            lessonStructure[section.sectionName] = section.content;\n        }\n        lessonStructure.dialoguePractice = dialoguePractice;\n        lessonStructure.dialogueFillGap = dialogueFillGap;\n        // Include lesson title from shared context\n        lessonStructure.lessonTitle = sharedContext.lessonTitle;\n        console.log(\" Progressive lesson generation complete!\");\n        return lessonStructure;\n    }\n    // Ultra-minimal warmup generation\n    async generateMinimalWarmup(sourceText, studentLevel) {\n        // Extract better context for topic identification\n        const topics = this.extractBetterTopics(sourceText);\n        const mainTopic = topics[0] || \"this topic\";\n        // Create a more specific prompt that avoids content assumptions\n        const prompt = `Write 3 ${studentLevel} warm-up questions about ${mainTopic}. Ask about students' prior knowledge and experience. Do not mention any specific events or results. Format: just the questions, one per line:`;\n        try {\n            console.log(\"\\uD83D\\uDD25 Minimal warmup prompt:\", prompt.length, \"chars\");\n            console.log(\"\\uD83C\\uDFAF Topic identified:\", mainTopic);\n            const response = await this.getGoogleAI().prompt(prompt);\n            // Extract only actual questions (must end with ?)\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>{\n                // Must be a question (ends with ?) and not an instruction\n                return line.endsWith(\"?\") && line.length > 10 && !line.toLowerCase().includes(\"here are\") && !line.toLowerCase().includes(\"based on\") && !line.toLowerCase().includes(\"headline mentions\") && !line.toLowerCase().includes(\"the text\") && !line.toLowerCase().includes(\"the article\") && !line.toLowerCase().includes(\"according to\") && !line.toLowerCase().includes(\"the passage\");\n            }).map((line)=>line.replace(/^\\d+\\.?\\s*/, \"\").replace(/^-\\s*/, \"\").trim()).slice(0, 3);\n            console.log(\"\\uD83C\\uDFAF Extracted warmup questions:\", questions);\n            if (questions.length < 3) {\n                throw new Error(\"Failed to generate sufficient warmup questions\");\n            }\n            return questions;\n        } catch (error) {\n            console.log(\" Minimal warmup failed\");\n            throw new Error(\"Failed to generate warmup questions: \" + error.message);\n        }\n    }\n    // Add instructional text to sections\n    addWarmupInstructions(questions, studentLevel) {\n        const instruction = \"Have the following conversations or discussions with your tutor before reading the text:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    addComprehensionInstructions(questions, studentLevel) {\n        const instruction = \"After reading the text, answer these comprehension questions:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    addDiscussionInstructions(questions, studentLevel) {\n        const instruction = \"Discuss these questions with your tutor to explore the topic in depth:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    addWrapupInstructions(questions, studentLevel) {\n        const instruction = \"Reflect on your learning by discussing these wrap-up questions:\";\n        return [\n            instruction,\n            ...questions\n        ];\n    }\n    addVocabularyInstructions(vocabulary, studentLevel) {\n        const instruction = {\n            word: \"INSTRUCTION\",\n            meaning: \"Study the following words with your tutor before reading the text:\",\n            example: \"\"\n        };\n        return [\n            instruction,\n            ...vocabulary\n        ];\n    }\n    addReadingInstructions(readingText, studentLevel) {\n        const instruction = \"Read the following text carefully. Your tutor will help you with any difficult words or concepts:\";\n        return `${instruction}\\n\\n${readingText}`;\n    }\n    // Better topic extraction that recognizes compound terms\n    extractBetterTopics(text) {\n        const topics = [];\n        // Look for compound terms first (like \"Ryder Cup\", \"World Cup\", etc.)\n        const compoundPatterns = [\n            /\\b(Ryder Cup|World Cup|Champions League|Premier League|Super Bowl|Olympics|World Series)\\b/gi,\n            /\\b(artificial intelligence|machine learning|climate change|social media)\\b/gi,\n            /\\b([A-Z][a-z]+ [A-Z][a-z]+)\\b/g // General compound proper nouns\n        ];\n        for (const pattern of compoundPatterns){\n            const matches = text.match(pattern);\n            if (matches) {\n                topics.push(...matches.map((m)=>m.toLowerCase()));\n            }\n        }\n        // If no compound terms found, fall back to single words\n        if (topics.length === 0) {\n            const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n            const commonWords = [\n                \"europe\",\n                \"team\",\n                \"golf\",\n                \"tournament\",\n                \"sports\",\n                \"competition\"\n            ];\n            const foundWords = words.filter((word)=>commonWords.includes(word));\n            topics.push(...foundWords.slice(0, 3));\n        }\n        return topics.length > 0 ? topics : [\n            \"sports\"\n        ];\n    }\n    // Enhanced vocabulary generation with AI-generated contextual examples\n    async generateMinimalVocabulary(sourceText, studentLevel) {\n        // Use smart vocabulary extraction instead of basic word matching\n        const meaningfulWords = this.extractMeaningfulVocabulary(sourceText, studentLevel);\n        console.log(\"\\uD83D\\uDCDA Meaningful vocabulary extracted:\", meaningfulWords);\n        const vocabulary = [];\n        for (const word of meaningfulWords){\n            try {\n                const capitalizedWord = this.capitalizeWord(word);\n                // Generate AI definition\n                const definitionPrompt = `Define \"${word}\" simply for ${studentLevel} level. Context: ${sourceText.substring(0, 80)}. Give only the definition, no extra text:`;\n                console.log(\"\\uD83D\\uDCDA Vocab definition prompt:\", definitionPrompt.length, \"chars\");\n                const rawMeaning = await this.getGoogleAI().prompt(definitionPrompt);\n                const meaning = this.cleanDefinition(rawMeaning, studentLevel);\n                // Generate AI contextual examples\n                const examples = await this.generateAIExampleSentences(word, studentLevel, sourceText);\n                vocabulary.push({\n                    word: capitalizedWord,\n                    meaning: meaning.trim().substring(0, 200),\n                    example: examples\n                });\n            } catch (error) {\n                console.log(` Vocab failed for ${word}, using enhanced template`);\n                const capitalizedWord = this.capitalizeWord(word);\n                vocabulary.push({\n                    word: capitalizedWord,\n                    meaning: this.generateContextualWordMeaning(word, studentLevel, sourceText),\n                    example: await this.generateAIExampleSentences(word, studentLevel, sourceText)\n                });\n            }\n        }\n        // Ensure we have 6-10 words\n        return vocabulary.slice(0, 10).length >= 6 ? vocabulary.slice(0, 10) : vocabulary.slice(0, 6);\n    }\n    // Ultra-minimal comprehension generation\n    async generateMinimalComprehension(sourceText, studentLevel) {\n        const shortText = sourceText.substring(0, 200) // Increase context for more questions\n        ;\n        const prompt = `Write 5 ${studentLevel} reading comprehension questions about this text. Only return questions, no instructions: ${shortText}`;\n        try {\n            console.log(\" Minimal comprehension prompt:\", prompt.length, \"chars\");\n            const response = await this.getGoogleAI().prompt(prompt);\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>{\n                // Must be a question and not an instruction\n                return line.endsWith(\"?\") && line.length > 10 && !line.toLowerCase().includes(\"here are\") && !line.toLowerCase().includes(\"based on\");\n            }).map((line)=>line.replace(/^\\d+\\.?\\s*/, \"\").replace(/^\\*\\*/, \"\").replace(/\\*\\*$/, \"\").trim()).slice(0, 5);\n            if (questions.length < 5) {\n                throw new Error(\"Failed to generate sufficient comprehension questions\");\n            }\n            return questions;\n        } catch (error) {\n            console.log(\" Minimal comprehension failed\");\n            throw new Error(\"Failed to generate comprehension questions: \" + error.message);\n        }\n    }\n    // Minimal AI-only reading passage generation\n    async generateMinimalReading(sourceText, studentLevel) {\n        const prompt = `Rewrite this text for ${studentLevel} level students. Keep it 200-400 words: ${sourceText.substring(0, 500)}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            return response.trim();\n        } catch (error) {\n            throw new Error(\"Failed to generate reading passage: \" + error.message);\n        }\n    }\n    // Minimal AI-only discussion questions generation\n    async generateMinimalDiscussion(sourceText, studentLevel) {\n        const prompt = `Write 3 ${studentLevel} discussion questions about this text. Only return questions: ${sourceText.substring(0, 200)}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.endsWith(\"?\") && line.length > 10).map((line)=>line.replace(/^\\d+\\.?\\s*/, \"\").trim()).slice(0, 3);\n            if (questions.length < 3) {\n                throw new Error(\"Failed to generate sufficient discussion questions\");\n            }\n            return questions;\n        } catch (error) {\n            throw new Error(\"Failed to generate discussion questions: \" + error.message);\n        }\n    }\n    // Minimal AI-only grammar section generation\n    async generateMinimalGrammar(sourceText, studentLevel) {\n        const prompt = `Create a grammar lesson for ${studentLevel} level based on this text. Return JSON with focus, examples, exercise: ${sourceText.substring(0, 200)}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            return JSON.parse(response);\n        } catch (error) {\n            throw new Error(\"Failed to generate grammar section: \" + error.message);\n        }\n    }\n    // Minimal AI-only pronunciation section generation\n    async generateMinimalPronunciation(vocabularyWords, studentLevel) {\n        const word = vocabularyWords[0] || \"communication\";\n        const prompt = `Create pronunciation practice for \"${word}\". Return JSON with word, ipa, practice:`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            return JSON.parse(response);\n        } catch (error) {\n            throw new Error(\"Failed to generate pronunciation section: \" + error.message);\n        }\n    }\n    // Minimal AI-only wrapup questions generation\n    async generateMinimalWrapup(sourceText, studentLevel) {\n        const prompt = `Write 3 ${studentLevel} wrap-up questions about this lesson. Only return questions: ${sourceText.substring(0, 200)}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.endsWith(\"?\") && line.length > 10).map((line)=>line.replace(/^\\d+\\.?\\s*/, \"\").trim()).slice(0, 3);\n            if (questions.length < 3) {\n                throw new Error(\"Failed to generate sufficient wrapup questions\");\n            }\n            return questions;\n        } catch (error) {\n            throw new Error(\"Failed to generate wrapup questions: \" + error.message);\n        }\n    }\n    // Content analysis without AI calls\n    analyzeContentContextNoAI(sourceText, metadata, structuredContent, studentLevel) {\n        console.log(\"\\uD83D\\uDD0D Analyzing content context without AI...\");\n        const analysis = {\n            contentType: metadata?.contentType || \"general\",\n            domain: metadata?.domain || \"\",\n            complexity: \"medium\",\n            topics: [],\n            keyVocabulary: [],\n            culturalContext: \"\",\n            learningObjectives: [],\n            difficulty: studentLevel || \"B1\",\n            title: metadata?.title || \"\",\n            sourceCountry: this.determineSourceCountry(metadata?.domain || \"\")\n        };\n        // Analyze content complexity\n        const sentences = sourceText.split(/[.!?]+/).filter((s)=>s.trim().length > 10);\n        const avgSentenceLength = sentences.length > 0 ? sentences.reduce((sum, s)=>sum + s.split(\" \").length, 0) / sentences.length : 0;\n        const complexWords = sourceText.match(/\\b\\w{8,}\\b/g)?.length || 0;\n        const totalWords = sourceText.split(/\\s+/).length;\n        if (avgSentenceLength > 20 || complexWords / totalWords > 0.15) {\n            analysis.complexity = \"high\";\n        } else if (avgSentenceLength < 12 && complexWords / totalWords < 0.08) {\n            analysis.complexity = \"low\";\n        }\n        // Extract topics using text analysis\n        analysis.topics = this.extractTopicsFromText(sourceText, structuredContent?.headings || []);\n        // Extract vocabulary using text analysis\n        analysis.keyVocabulary = this.extractVocabularyFromText(sourceText, studentLevel);\n        // Determine cultural context\n        if (metadata?.domain) {\n            analysis.culturalContext = this.determineCulturalContext(metadata.domain, sourceText);\n        }\n        // Generate learning objectives\n        analysis.learningObjectives = this.generateLearningObjectives(analysis.contentType, analysis.topics, studentLevel);\n        return analysis;\n    }\n    // New method: Analyze content context and complexity\n    async analyzeContentContext(sourceText, metadata, structuredContent, studentLevel) {\n        console.log(\"\\uD83D\\uDD0D Analyzing content context...\");\n        const analysis = {\n            contentType: metadata?.contentType || \"general\",\n            domain: metadata?.domain || \"\",\n            complexity: \"medium\",\n            topics: [],\n            keyVocabulary: [],\n            culturalContext: \"\",\n            learningObjectives: [],\n            difficulty: studentLevel || \"B1\",\n            title: metadata?.title || \"\",\n            sourceCountry: this.determineSourceCountry(metadata?.domain || \"\")\n        };\n        // Analyze content complexity based on text characteristics\n        const sentences = sourceText.split(/[.!?]+/).filter((s)=>s.trim().length > 10);\n        const avgSentenceLength = sentences.length > 0 ? sentences.reduce((sum, s)=>sum + s.split(\" \").length, 0) / sentences.length : 0;\n        const complexWords = sourceText.match(/\\b\\w{8,}\\b/g)?.length || 0;\n        const totalWords = sourceText.split(/\\s+/).length;\n        if (avgSentenceLength > 20 || complexWords / totalWords > 0.15) {\n            analysis.complexity = \"high\";\n        } else if (avgSentenceLength < 12 && complexWords / totalWords < 0.08) {\n            analysis.complexity = \"low\";\n        }\n        console.log(\"\\uD83D\\uDCC8 Text complexity analysis:\", {\n            avgSentenceLength,\n            complexWords,\n            totalWords,\n            complexity: analysis.complexity\n        });\n        // Extract key topics using simple text analysis (skip AI to avoid token limits)\n        console.log(\"\\uD83C\\uDFAF Extracting topics using text analysis...\");\n        analysis.topics = this.extractTopicsFromText(sourceText, structuredContent?.headings || []);\n        console.log(\" Extracted topics:\", analysis.topics);\n        // Extract key vocabulary using text analysis (skip AI to avoid token limits)\n        console.log(\"\\uD83D\\uDCDA Extracting vocabulary using text analysis...\");\n        analysis.keyVocabulary = this.extractVocabularyFromText(sourceText, studentLevel);\n        console.log(\" Extracted vocabulary:\", analysis.keyVocabulary);\n        // Determine cultural context\n        if (metadata?.domain) {\n            analysis.culturalContext = this.determineCulturalContext(metadata.domain, sourceText);\n            console.log(\"\\uD83C\\uDF0D Cultural context:\", analysis.culturalContext);\n        }\n        // Generate learning objectives based on content type and lesson type\n        analysis.learningObjectives = this.generateLearningObjectives(analysis.contentType, analysis.topics, studentLevel);\n        console.log(\"\\uD83C\\uDFAF Learning objectives:\", analysis.learningObjectives);\n        return analysis;\n    }\n    // Enhanced contextual summary creation\n    async createContextualSummary(sourceText, contentAnalysis, lessonType, studentLevel) {\n        console.log(\"\\uD83D\\uDCDD Creating contextual summary...\");\n        // Use simple prompt to avoid token limits\n        const summaryPrompt = `Summarize this text in 4-5 sentences for ${studentLevel} level students:\r\n\r\n${sourceText.substring(0, 800)}\r\n\r\nSummary:`;\n        try {\n            console.log(\"\\uD83E\\uDD16 Calling AI for contextual summary...\");\n            const summary = await this.getGoogleAI().prompt(summaryPrompt, {\n                temperature: 0.4,\n                maxTokens: 300\n            });\n            console.log(\" AI contextual summary created:\", summary.substring(0, 100) + \"...\");\n            return summary;\n        } catch (error) {\n            console.warn(\" AI contextual summary failed, using text truncation:\", error.message);\n            // Skip complex fallbacks, just use truncation\n            const truncated = sourceText.substring(0, 600) + \"...\";\n            console.log(\"\\uD83D\\uDD04 Using truncated text as summary\");\n            return truncated;\n        }\n    }\n    // Generate CEFR-adapted warm-up questions\n    async generateContextualWarmupQuestions(content, contentAnalysis, studentLevel, metadata) {\n        console.log(\"\\uD83D\\uDD25 Generating CEFR-adapted warm-up questions...\");\n        const levelInstructions = {\n            \"A1\": `\r\nCreate 3 warm-up questions for A1 (beginner) level:\r\n- Use simple present tense and basic vocabulary\r\n- Ask yes/no questions or simple choice questions\r\n- Focus on familiar, concrete concepts\r\n- Keep questions short and direct\r\n- Use vocabulary the student likely knows\r\nExample: \"Do you use [topic] in your daily life? Yes or No?\"`,\n            \"A2\": `\r\nCreate 3 warm-up questions for A2 (elementary) level:\r\n- Use simple past tense and personal experiences\r\n- Ask for short, simple answers\r\n- Include basic comparisons with \"different\" or \"same\"\r\n- Focus on personal experiences and familiar situations\r\n- Use simple connecting words like \"and\", \"but\"\r\nExample: \"Have you ever [experienced topic]? How was it?\"`,\n            \"B1\": `\r\nCreate 3 warm-up questions for B1 (intermediate) level:\r\n- Ask for opinions with \"What do you think...?\"\r\n- Include comparisons between countries/cultures\r\n- Ask students to explain reasons with \"because\" or \"why\"\r\n- Discuss advantages and disadvantages\r\n- Use more varied vocabulary but keep structure clear\r\nExample: \"What do you think about [topic]? How is it different in your country?\"`,\n            \"B2\": `\r\nCreate 3 warm-up questions for B2 (upper intermediate) level:\r\n- Ask students to analyze situations and predict outcomes\r\n- Include complex opinions and explanations\r\n- Discuss implications and consequences\r\n- Use conditional language (\"What would happen if...?\")\r\n- Encourage detailed responses with examples\r\nExample: \"What challenges do you think [specific group] face with [topic]?\"`,\n            \"C1\": `\r\nCreate 3 warm-up questions for C1 (advanced) level:\r\n- Ask students to evaluate arguments and consider multiple perspectives\r\n- Include abstract concepts and societal implications\r\n- Use sophisticated vocabulary and complex structures\r\n- Encourage critical thinking and nuanced discussion\r\n- Ask about broader cultural and social contexts\r\nExample: \"How do cultural attitudes toward [concept] influence [topic] in different societies?\"`\n        };\n        // Ultra-simple prompt to avoid token limits\n        const topic = contentAnalysis.topics[0] || \"this topic\";\n        const warmupPrompt = `Create 3 ${studentLevel} level warm-up questions about ${topic}. Return only the questions:`;\n        try {\n            console.log(\"\\uD83E\\uDD16 Calling AI for contextual warm-up questions...\");\n            console.log(\"\\uD83D\\uDCDD Warm-up prompt:\", warmupPrompt.substring(0, 200) + \"...\");\n            const response = await this.getGoogleAI().prompt(warmupPrompt, {\n                temperature: 0.6,\n                maxTokens: 150\n            });\n            console.log(\" AI warm-up questions generated\");\n            console.log(\"\\uD83E\\uDD16 Raw AI response:\", response);\n            const questions = this.parseListFromText(response).slice(0, 3);\n            console.log(\"\\uD83D\\uDD25 Parsed warm-up questions:\", questions);\n            console.log(\"\\uD83D\\uDD0D Questions array length:\", questions.length);\n            // Ensure we have 3 questions, add fallbacks if needed\n            while(questions.length < 3){\n                const fallbackQuestion = this.getFallbackWarmupQuestion(studentLevel, contentAnalysis, questions.length);\n                console.log(` Adding fallback question ${questions.length + 1}:`, fallbackQuestion);\n                questions.push(fallbackQuestion);\n            }\n            console.log(\" Final warm-up questions:\", questions);\n            // Final safety check - if still empty, use basic fallback\n            if (questions.length === 0) {\n                console.warn(\" No questions generated, using emergency fallback\");\n                return [\n                    \"What do you know about this topic?\",\n                    \"Have you experienced something similar?\",\n                    \"What would you like to learn?\"\n                ];\n            }\n            return questions;\n        } catch (error) {\n            console.warn(\" AI warm-up generation failed, using contextual fallbacks:\", error.message);\n            const fallbackQuestions = this.getContextualWarmupFallback(studentLevel, contentAnalysis, metadata);\n            console.log(\"\\uD83D\\uDD04 Fallback warm-up questions:\", fallbackQuestions);\n            // Final safety check for fallback\n            if (!fallbackQuestions || fallbackQuestions.length === 0) {\n                console.warn(\" Fallback also empty, using emergency questions\");\n                return [\n                    \"What do you know about this topic?\",\n                    \"Have you experienced something similar?\",\n                    \"What would you like to learn?\"\n                ];\n            }\n            return fallbackQuestions;\n        }\n    }\n    // Enhanced contextual lesson structure generation\n    async generateContextualLessonStructure(content, contentAnalysis, lessonType, studentLevel, targetLanguage, metadata) {\n        console.log(\"\\uD83C\\uDFD7 Generating contextual lesson structure...\");\n        // Generate contextual warm-up questions first\n        const contextualWarmup = await this.generateContextualWarmupQuestions(content, contentAnalysis, studentLevel, metadata);\n        console.log(\"\\uD83D\\uDD25 Generated contextual warm-up questions:\", contextualWarmup);\n        // Ultra-simplified prompt to avoid token limits\n        const topics = contentAnalysis.topics.slice(0, 2).join(\", \") || \"technology\";\n        const vocab = contentAnalysis.keyVocabulary.slice(0, 4).join(\", \");\n        const prompt = `Create a ${lessonType} lesson for ${studentLevel} students about: ${topics}\r\n\r\nContent: \"${content.substring(0, 400)}\"\r\nKey words: ${vocab}\r\n\r\nReturn JSON with: warmup (use provided), vocabulary (4 words from content), reading (simplified content), comprehension (3 questions), discussion (3 questions), grammar (focus + examples), pronunciation (1 word), wrapup (3 questions).\r\n\r\n{\r\n  \"warmup\": ${JSON.stringify(contextualWarmup)},\r\n  \"vocabulary\": [{\"word\": \"word\", \"meaning\": \"definition\", \"example\": \"sentence\"}],\r\n  \"reading\": \"text\",\r\n  \"comprehension\": [\"question\"],\r\n  \"discussion\": [\"question\"], \r\n  \"grammar\": {\"focus\": \"topic\", \"examples\": [\"example\"], \"exercise\": [\"exercise\"]},\r\n  \"pronunciation\": {\"word\": \"word\", \"ipa\": \"/ipa/\", \"practice\": \"sentence\"},\r\n  \"wrapup\": [\"question\"]\r\n}`;\n        try {\n            console.log(\"\\uD83E\\uDD16 Calling AI for lesson structure...\");\n            const response = await this.getGoogleAI().prompt(prompt, {\n                temperature: 0.7,\n                maxTokens: 1500\n            });\n            console.log(\"\\uD83E\\uDD16 AI lesson structure response:\", response.substring(0, 200) + \"...\");\n            try {\n                const parsed = JSON.parse(response);\n                console.log(\" Successfully parsed lesson structure JSON\");\n                // Ensure our contextual warm-up questions are preserved\n                parsed.warmup = contextualWarmup;\n                console.log(\"\\uD83D\\uDD25 Preserved contextual warm-up questions in final structure\");\n                return parsed;\n            } catch (parseError) {\n                console.warn(\" Failed to parse JSON, attempting to clean response...\");\n                // Try to extract JSON from the response\n                const jsonMatch = response.match(/\\{[\\s\\S]*\\}/);\n                if (jsonMatch) {\n                    try {\n                        const cleaned = JSON.parse(jsonMatch[0]);\n                        console.log(\" Successfully parsed cleaned JSON\");\n                        // Ensure our contextual warm-up questions are preserved\n                        cleaned.warmup = contextualWarmup;\n                        console.log(\"\\uD83D\\uDD25 Preserved contextual warm-up questions in cleaned structure\");\n                        return cleaned;\n                    } catch (cleanError) {\n                        console.warn(\" Failed to parse cleaned JSON, using fallback\");\n                    }\n                }\n                // If JSON parsing fails, return a structured fallback with contextual warm-up\n                const fallback = this.createStructuredFallback(content, lessonType, studentLevel);\n                fallback.warmup = contextualWarmup;\n                console.log(\"\\uD83D\\uDD25 Using fallback with contextual warm-up questions\");\n                return fallback;\n            }\n        } catch (error) {\n            console.warn(\" AI lesson structure generation failed, using fallback:\", error.message);\n            const fallback = this.createStructuredFallback(content, lessonType, studentLevel);\n            fallback.warmup = contextualWarmup;\n            console.log(\"\\uD83D\\uDD25 Using error fallback with contextual warm-up questions\");\n            return fallback;\n        }\n    }\n    // Enhanced detailed content generation with context\n    async generateDetailedContextualContent(structure, content, contentAnalysis, lessonType, studentLevel, targetLanguage, structuredContent) {\n        // Use Writer API to expand each section with contextual, detailed content\n        const sections = {\n            ...structure\n        };\n        // Enhance vocabulary section with contextual examples\n        if (sections.vocabulary) {\n            for(let i = 0; i < sections.vocabulary.length; i++){\n                const vocab = sections.vocabulary[i];\n                try {\n                    const contextualExamplePrompt = `\r\nCreate a natural example sentence using the word \"${vocab.word}\" that relates to this content context:\r\nTopics: ${contentAnalysis.topics.join(\", \")}\r\nContent type: ${contentAnalysis.contentType}\r\nLevel: ${studentLevel}\r\n\r\nMake the example relevant to the source material and appropriate for ${studentLevel} level students.\r\n`;\n                    const enhancedExample = await this.getGoogleAI().write(contextualExamplePrompt, {\n                        tone: \"casual\",\n                        length: \"short\"\n                    });\n                    sections.vocabulary[i].example = enhancedExample;\n                    // Add contextual meaning based on source content\n                    const contextualMeaningPrompt = `\r\nExplain the meaning of \"${vocab.word}\" in the context of: ${contentAnalysis.topics[0] || contentAnalysis.contentType}\r\nKeep it simple for ${studentLevel} level students.\r\n`;\n                    const contextualMeaning = await this.getGoogleAI().write(contextualMeaningPrompt, {\n                        tone: \"casual\",\n                        length: \"short\"\n                    });\n                    sections.vocabulary[i].contextualMeaning = contextualMeaning;\n                } catch (error) {\n                    // Keep original if enhancement fails\n                    console.warn(`Failed to enhance vocabulary for ${vocab.word}:`, error);\n                }\n            }\n        }\n        // Enhance discussion questions with specific content references\n        if (sections.discussion) {\n            try {\n                const enhancedDiscussionPrompt = `\r\nEnhance these discussion questions for a ${lessonType} lesson about ${contentAnalysis.topics.join(\" and \")}:\r\n${sections.discussion.join(\"\\n\")}\r\n\r\nMake them more specific to the content, engaging for ${studentLevel} level students, and encourage deeper thinking about:\r\n- ${contentAnalysis.topics.slice(0, 3).join(\"\\n- \")}\r\n\r\nReturn 3-4 enhanced questions that reference specific aspects of the content.\r\n`;\n                const enhancedDiscussion = await this.getGoogleAI().write(enhancedDiscussionPrompt, {\n                    tone: \"casual\",\n                    length: \"medium\",\n                    format: \"bullet-points\"\n                });\n                sections.discussion = this.parseListFromText(enhancedDiscussion).slice(0, 4);\n            } catch (error) {\n                console.warn(\"Failed to enhance discussion questions:\", error);\n            }\n        }\n        // Enhance reading section with better structure\n        if (sections.reading && structuredContent?.headings?.length > 0) {\n            try {\n                const structuredReadingPrompt = `\r\nImprove this reading text by organizing it with clear structure based on these headings from the original:\r\n${structuredContent.headings.slice(0, 3).map((h)=>`- ${h.text}`).join(\"\\n\")}\r\n\r\nOriginal text: \"${sections.reading}\"\r\n\r\nCreate a well-structured, ${studentLevel}-appropriate reading passage that maintains the key information but improves readability.\r\n`;\n                const enhancedReading = await this.getGoogleAI().rewrite(sections.reading, {\n                    tone: \"casual\",\n                    length: \"same\",\n                    audience: this.getAudienceLevel(studentLevel)\n                });\n                sections.reading = enhancedReading;\n            } catch (error) {\n                console.warn(\"Failed to enhance reading section:\", error);\n            }\n        }\n        // Enhance grammar section with content-specific examples\n        if (sections.grammar && sections.grammar.focus) {\n            try {\n                const grammarExamplesPrompt = `\r\nCreate 3 grammar examples for \"${sections.grammar.focus}\" using vocabulary and concepts from this content:\r\nTopics: ${contentAnalysis.topics.join(\", \")}\r\nKey vocabulary: ${contentAnalysis.keyVocabulary.slice(0, 5).join(\", \")}\r\n\r\nMake examples relevant to the content and appropriate for ${studentLevel} level.\r\n`;\n                const contextualGrammarExamples = await this.getGoogleAI().write(grammarExamplesPrompt, {\n                    tone: \"casual\",\n                    length: \"short\",\n                    format: \"bullet-points\"\n                });\n                sections.grammar.contextualExamples = this.parseListFromText(contextualGrammarExamples);\n            } catch (error) {\n                console.warn(\"Failed to enhance grammar examples:\", error);\n            }\n        }\n        return sections;\n    }\n    async proofreadLesson(lesson) {\n        // Proofread key text sections\n        const sectionsToProofread = [\n            \"reading\",\n            \"grammar.examples\",\n            \"pronunciation.practice\"\n        ];\n        for (const sectionPath of sectionsToProofread){\n            const value = this.getNestedValue(lesson, sectionPath);\n            if (typeof value === \"string\") {\n                const proofread = await this.getGoogleAI().proofread(value, {\n                    checkGrammar: true,\n                    checkSpelling: true,\n                    checkStyle: true\n                });\n                this.setNestedValue(lesson, sectionPath, proofread.corrected_text);\n            }\n        }\n        return lesson;\n    }\n    generateFallbackLesson(params) {\n        // Template-based fallback when AI APIs fail\n        const { sourceText, lessonType, studentLevel, targetLanguage } = params;\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: this.getTemplateWarmup(lessonType, studentLevel),\n                vocabulary: this.extractVocabulary(sourceText, studentLevel),\n                reading: this.simplifyText(sourceText, studentLevel),\n                comprehension: this.getTemplateComprehension(lessonType, studentLevel),\n                dialoguePractice: this.generateTemplateDialoguePractice(\"this topic\", studentLevel, []),\n                dialogueFillGap: this.generateTemplateDialogueFillGap(\"this topic\", studentLevel, []),\n                discussion: this.getTemplateDiscussion(lessonType, studentLevel),\n                grammar: this.getTemplateGrammar(studentLevel),\n                pronunciation: this.getTemplatePronunciation(sourceText),\n                wrapup: this.getTemplateWrapup(lessonType)\n            }\n        };\n    }\n    // Helper methods\n    getSummaryLength(level) {\n        const lengthMap = {\n            A1: \"short\",\n            A2: \"short\",\n            B1: \"medium\",\n            B2: \"medium\",\n            C1: \"long\"\n        };\n        return lengthMap[level] || \"medium\";\n    }\n    getLanguageCode(language) {\n        const languageMap = {\n            spanish: \"es\",\n            french: \"fr\",\n            german: \"de\",\n            italian: \"it\",\n            portuguese: \"pt\",\n            japanese: \"ja\",\n            korean: \"ko\",\n            chinese: \"zh\"\n        };\n        return languageMap[language] || \"en\";\n    }\n    parseListFromText(text) {\n        return text.split(\"\\n\").filter((line)=>line.trim()).map((line)=>line.replace(/^[-*]\\s*/, \"\").trim()).filter((line)=>line.length > 0).slice(0, 4) // Limit to 4 items\n        ;\n    }\n    getNestedValue(obj, path) {\n        return path.split(\".\").reduce((current, key)=>current?.[key], obj);\n    }\n    setNestedValue(obj, path, value) {\n        const keys = path.split(\".\");\n        const lastKey = keys.pop();\n        const target = keys.reduce((current, key)=>current[key], obj);\n        target[lastKey] = value;\n    }\n    createStructuredFallback(content, lessonType, studentLevel) {\n        console.log(\"\\uD83D\\uDD04 Creating structured fallback lesson...\");\n        // Extract some basic information from content for better fallback\n        const words = content.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words)).slice(0, 6);\n        const fallback = {\n            warmup: [],\n            vocabulary: uniqueWords.map((word)=>({\n                    word: word,\n                    meaning: `Definition of ${word}`,\n                    example: `Example sentence with ${word}.`\n                })),\n            reading: this.simplifyText(content, studentLevel),\n            comprehension: this.getTemplateComprehension(lessonType, studentLevel),\n            discussion: this.getTemplateDiscussion(lessonType, studentLevel),\n            grammar: this.getTemplateGrammar(studentLevel),\n            pronunciation: this.getTemplatePronunciation(content),\n            wrapup: this.getTemplateWrapup(lessonType)\n        };\n        console.log(\" Structured fallback created (warmup will be set by caller)\");\n        return fallback;\n    }\n    getTemplateWarmup(lessonType, studentLevel) {\n        const templates = {\n            discussion: [\n                \"What do you already know about this topic?\",\n                \"Have you had similar experiences?\",\n                \"What would you like to learn more about?\"\n            ],\n            grammar: [\n                \"What grammar patterns do you notice?\",\n                \"Which sentences seem most complex?\",\n                \"What grammar rules do you remember?\"\n            ],\n            travel: [\n                \"Where would you like to travel next?\",\n                \"What travel experiences have you had?\",\n                \"What travel vocabulary do you know?\"\n            ],\n            business: [\n                \"What business situations are you familiar with?\",\n                \"How do you communicate professionally?\",\n                \"What business terms are challenging?\"\n            ],\n            pronunciation: [\n                \"Which sounds are difficult to pronounce?\",\n                \"How do you practice pronunciation?\",\n                \"What pronunciation goals do you have?\"\n            ]\n        };\n        return templates[lessonType] || templates.discussion;\n    }\n    extractVocabulary(text, studentLevel) {\n        // Simple vocabulary extraction based on word frequency and complexity\n        const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words));\n        const selectedWords = uniqueWords.slice(0, 6);\n        return selectedWords.map((word)=>({\n                word: word,\n                meaning: `Definition of ${word}`,\n                example: `Example sentence with ${word}.`\n            }));\n    }\n    simplifyText(text, studentLevel) {\n        // Basic text simplification based on level\n        const maxLength = {\n            A1: 200,\n            A2: 300,\n            B1: 400,\n            B2: 500,\n            C1: 600\n        };\n        const limit = maxLength[studentLevel] || 400;\n        return text.substring(0, limit) + (text.length > limit ? \"...\" : \"\");\n    }\n    getTemplateComprehension(lessonType, studentLevel) {\n        return [\n            \"What is the main idea of this text?\",\n            \"What supporting details can you identify?\",\n            \"How does this relate to your experience?\",\n            \"What conclusions can you draw?\"\n        ];\n    }\n    getTemplateDiscussion(lessonType, studentLevel) {\n        const templates = {\n            discussion: [\n                \"What is your opinion on this topic?\",\n                \"How would you handle this situation?\",\n                \"What alternative approaches exist?\"\n            ],\n            business: [\n                \"How would you apply this professionally?\",\n                \"What business challenges does this address?\",\n                \"How would you present this to colleagues?\"\n            ],\n            travel: [\n                \"How would this help while traveling?\",\n                \"What preparations would you make?\",\n                \"How would you share this experience?\"\n            ]\n        };\n        return templates[lessonType] || templates.discussion;\n    }\n    getTemplateGrammar(studentLevel) {\n        const grammarFoci = {\n            A1: \"Present Simple Tense\",\n            A2: \"Past Simple Tense\",\n            B1: \"Present Perfect Tense\",\n            B2: \"Conditional Sentences\",\n            C1: \"Advanced Grammar Structures\"\n        };\n        return {\n            focus: grammarFoci[studentLevel] || \"Present Perfect Tense\",\n            examples: [\n                \"I have learned many new things.\",\n                \"She has improved her skills.\",\n                \"We have discussed this topic.\"\n            ],\n            exercise: [\n                \"I _____ (learn) a lot today.\",\n                \"They _____ (complete) the project.\",\n                \"She _____ (improve) significantly.\"\n            ]\n        };\n    }\n    getTemplatePronunciation(text) {\n        // Extract a challenging word from the text\n        const words = text.match(/\\b[a-z]{6,}\\b/gi) || [\n            \"communication\"\n        ];\n        const selectedWord = words[0] || \"communication\";\n        return {\n            word: selectedWord.toLowerCase(),\n            ipa: \"/kmjunken/\",\n            practice: `Practice saying: \"${selectedWord}\" in a sentence.`\n        };\n    }\n    getTemplateWrapup(lessonType) {\n        return [\n            \"What new vocabulary did you learn?\",\n            \"Which concepts need more practice?\",\n            \"How will you use this knowledge?\",\n            \"What questions do you still have?\"\n        ];\n    }\n    // New helper methods for enhanced contextual analysis\n    extractTopicsFromHeadings(headings) {\n        return headings.filter((h)=>h.level <= 3) // Focus on main headings\n        .map((h)=>h.text).slice(0, 5);\n    }\n    extractTopicsFromText(text, headings) {\n        // First try to get topics from headings\n        const headingTopics = this.extractTopicsFromHeadings(headings);\n        if (headingTopics.length > 0) {\n            return headingTopics;\n        }\n        // Fallback: extract key phrases from text\n        const sentences = text.split(/[.!?]+/).filter((s)=>s.trim().length > 20);\n        const topics = [];\n        // Look for common topic indicators\n        const topicPatterns = [\n            /about (.+?)(?:\\s|,|\\.)/gi,\n            /discuss (.+?)(?:\\s|,|\\.)/gi,\n            /focus on (.+?)(?:\\s|,|\\.)/gi,\n            /regarding (.+?)(?:\\s|,|\\.)/gi\n        ];\n        for (const sentence of sentences.slice(0, 5)){\n            for (const pattern of topicPatterns){\n                const matches = sentence.match(pattern);\n                if (matches) {\n                    topics.push(...matches.map((m)=>m.replace(pattern, \"$1\").trim()).slice(0, 2));\n                }\n            }\n        }\n        // If no patterns found, extract key nouns\n        if (topics.length === 0) {\n            const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n            const commonWords = [\n                \"this\",\n                \"that\",\n                \"with\",\n                \"from\",\n                \"they\",\n                \"have\",\n                \"been\",\n                \"will\",\n                \"more\",\n                \"some\",\n                \"what\",\n                \"when\",\n                \"where\",\n                \"which\",\n                \"their\",\n                \"would\",\n                \"could\",\n                \"should\"\n            ];\n            const keyWords = words.filter((word)=>!commonWords.includes(word)).filter((word, index, arr)=>arr.indexOf(word) === index) // unique\n            .slice(0, 3);\n            return keyWords.length > 0 ? keyWords : [\n                \"AI technology\",\n                \"mobile devices\",\n                \"privacy\"\n            ];\n        }\n        return topics.slice(0, 3);\n    }\n    // Extract meaningful vocabulary for lesson content (improved algorithm)\n    extractMeaningfulVocabulary(text, level) {\n        const words = text.toLowerCase().match(/\\b[a-z]{4,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words));\n        // Enhanced exclusion list focusing on truly basic words and proper names\n        const excludeWords = new Set([\n            // Basic function words\n            \"the\",\n            \"and\",\n            \"for\",\n            \"are\",\n            \"but\",\n            \"not\",\n            \"you\",\n            \"all\",\n            \"can\",\n            \"had\",\n            \"her\",\n            \"was\",\n            \"one\",\n            \"our\",\n            \"out\",\n            \"day\",\n            \"get\",\n            \"has\",\n            \"him\",\n            \"his\",\n            \"how\",\n            \"its\",\n            \"may\",\n            \"new\",\n            \"now\",\n            \"old\",\n            \"see\",\n            \"two\",\n            \"who\",\n            \"boy\",\n            \"did\",\n            \"she\",\n            \"use\",\n            \"way\",\n            \"what\",\n            \"when\",\n            \"where\",\n            \"will\",\n            \"with\",\n            \"have\",\n            \"this\",\n            \"that\",\n            \"they\",\n            \"been\",\n            \"said\",\n            \"each\",\n            \"which\",\n            \"their\",\n            \"time\",\n            \"would\",\n            \"there\",\n            \"could\",\n            \"other\",\n            \"after\",\n            \"first\",\n            \"well\",\n            \"water\",\n            \"very\",\n            \"what\",\n            \"know\",\n            \"just\",\n            \"people\",\n            \"into\",\n            \"over\",\n            \"think\",\n            \"also\",\n            \"back\",\n            \"work\",\n            \"life\",\n            \"only\",\n            \"year\",\n            \"years\",\n            \"come\",\n            \"came\",\n            \"right\",\n            \"good\",\n            \"each\",\n            \"those\",\n            \"feel\",\n            \"seem\",\n            \"these\",\n            \"give\",\n            \"most\",\n            \"hand\",\n            \"high\",\n            \"keep\",\n            \"last\",\n            \"left\",\n            \"life\",\n            \"live\",\n            \"look\",\n            \"made\",\n            \"make\",\n            \"many\",\n            \"much\",\n            \"must\",\n            \"name\",\n            \"need\",\n            \"next\",\n            \"open\",\n            \"part\",\n            \"play\",\n            \"said\",\n            \"same\",\n            \"seem\",\n            \"show\",\n            \"side\",\n            \"take\",\n            \"tell\",\n            \"turn\",\n            \"want\",\n            \"ways\",\n            \"well\",\n            \"went\",\n            \"were\",\n            \"here\",\n            \"home\",\n            \"long\",\n            \"look\",\n            \"move\",\n            \"place\",\n            \"right\",\n            \"small\",\n            \"sound\",\n            \"still\",\n            \"such\",\n            \"thing\",\n            \"think\",\n            \"three\",\n            \"under\",\n            \"water\",\n            \"where\",\n            \"while\",\n            \"world\",\n            \"write\",\n            \"young\",\n            // Very basic words that B1+ students should know\n            \"student\",\n            \"english\",\n            \"september\",\n            \"october\",\n            \"november\",\n            \"december\",\n            \"january\",\n            \"february\",\n            \"march\",\n            \"april\",\n            \"june\",\n            \"july\",\n            \"august\",\n            \"south\",\n            \"africa\",\n            \"images\",\n            \"image\",\n            \"photo\",\n            \"picture\",\n            \"black\",\n            \"white\",\n            \"coloured\",\n            \"colored\",\n            // Problematic or sensitive terms to avoid in vocabulary\n            \"slur\",\n            \"slurs\",\n            \"racial\",\n            \"racist\",\n            \"racism\",\n            \"mckenzie\",\n            \"apartheid\",\n            \"monday\",\n            \"tuesday\",\n            \"wednesday\",\n            \"thursday\",\n            \"friday\",\n            \"saturday\",\n            \"sunday\",\n            \"today\",\n            \"yesterday\",\n            \"tomorrow\",\n            \"morning\",\n            \"afternoon\",\n            \"evening\",\n            \"night\",\n            // Common proper names to avoid (people's names and specific places)\n            \"john\",\n            \"mary\",\n            \"david\",\n            \"sarah\",\n            \"michael\",\n            \"jennifer\",\n            \"robert\",\n            \"lisa\",\n            \"william\",\n            \"karen\",\n            \"james\",\n            \"susan\",\n            \"christopher\",\n            \"jessica\",\n            \"daniel\",\n            \"nancy\",\n            \"matthew\",\n            \"betty\",\n            \"anthony\",\n            \"helen\",\n            \"mark\",\n            \"sandra\",\n            \"donald\",\n            \"donna\",\n            \"steven\",\n            \"carol\",\n            \"paul\",\n            \"ruth\",\n            \"andrew\",\n            \"sharon\",\n            \"joshua\",\n            \"michelle\",\n            \"kenneth\",\n            \"laura\",\n            \"kevin\",\n            \"sarah\",\n            \"brian\",\n            \"kimberly\",\n            \"george\",\n            \"deborah\",\n            \"edward\",\n            \"dorothy\",\n            \"ronald\",\n            \"lisa\",\n            \"timothy\",\n            \"nancy\",\n            \"jason\",\n            \"karen\",\n            \"jeffrey\",\n            \"betty\",\n            \"ryan\",\n            \"helen\",\n            \"jacob\",\n            \"sandra\",\n            \"gary\",\n            \"donna\",\n            \"nicholas\",\n            \"carol\",\n            \"eric\",\n            \"ruth\",\n            \"jonathan\",\n            \"sharon\",\n            \"stephen\",\n            \"michelle\",\n            \"larry\",\n            \"laura\",\n            \"justin\",\n            \"sarah\",\n            \"scott\",\n            \"kimberly\",\n            \"brandon\",\n            \"deborah\",\n            \"benjamin\",\n            \"dorothy\",\n            \"samuel\",\n            \"lisa\",\n            \"gregory\",\n            \"nancy\",\n            \"alexander\",\n            \"karen\",\n            \"patrick\",\n            \"betty\",\n            \"frank\",\n            \"helen\",\n            \"raymond\",\n            \"sandra\",\n            \"jack\",\n            \"donna\",\n            \"dennis\",\n            \"carol\",\n            \"jerry\",\n            \"ruth\",\n            \"tyler\",\n            \"sharon\",\n            \"aaron\",\n            \"michelle\",\n            \"jose\",\n            \"laura\",\n            \"henry\",\n            \"sarah\",\n            \"adam\",\n            \"kimberly\",\n            \"douglas\",\n            \"deborah\",\n            \"nathan\",\n            \"dorothy\",\n            \"peter\",\n            \"lisa\",\n            \"zachary\",\n            \"nancy\",\n            \"kyle\",\n            \"karen\",\n            \"julius\",\n            \"malema\"\n        ]);\n        // Filter and score words for educational value\n        const meaningfulWords = uniqueWords.filter((word)=>{\n            if (excludeWords.has(word)) return false;\n            if (/^\\d+$/.test(word)) return false // Skip pure numbers\n            ;\n            if (word.length < 4) return false // Skip very short words\n            ;\n            if (word.length > 15) return false // Skip very long words\n            ;\n            if (this.isProperName(word)) return false // Skip proper names\n            ;\n            return true;\n        });\n        // Score words based on educational and contextual value\n        const scoredWords = meaningfulWords.map((word)=>{\n            let score = 0;\n            // High-value content-specific vocabulary (political, business, academic terms)\n            if (/^(announcement|opposition|recognition|leadership|management|government|political|parliament|democracy|election|policy|legislation|constitution|rights|freedom|justice|equality|development|economic|social|cultural|environmental|international|national|regional|community|organization|institution|administration|authority|responsibility|accountability|transparency|governance|regulation|compliance|strategy|implementation|evaluation|assessment|analysis|research|investigation|examination|consideration|discussion|negotiation|agreement|cooperation|collaboration|partnership|relationship|communication|information|education|training|knowledge|understanding|awareness|consciousness|perspective|opinion|belief|attitude|approach|method|technique|process|system|structure|framework|principle|concept|theory|practice|experience|skill|expertise|professional|academic|scientific|technical|technological|digital|innovation|creativity|development|improvement|enhancement|transformation|change|progress|advancement|achievement|success|performance|quality|efficiency|effectiveness|productivity|sustainability|responsibility|commitment|dedication|motivation|inspiration|leadership|management|coordination|supervision|direction|guidance|support|assistance|service|provision|delivery|implementation|execution|operation|function|activity|action|behavior|conduct|practice|procedure|protocol|standard|guideline|requirement|condition|situation|circumstance|context|environment|setting|background|history|tradition|culture|society|community|population|group|team|organization|institution|establishment|authority|government|administration|policy|regulation|law|rule|standard|guideline|procedure|protocol|framework|model|pattern|template|example|instance|case|scenario)/.test(word)) {\n                score += 6 // Highest priority for meaningful content vocabulary\n                ;\n            }\n            // Business and professional terms\n            if (/^(manage|leader|team|company|business|strategy|develop|create|innovat|technolog|digital|global|professional|experience|skill|expert|analysis|research|project|solution|challenge|opportunity|growth|success|achievement|performance|quality|efficiency|productivity|collaboration|communication|decision|responsibility|objective|goal|target|result|outcome|impact|benefit|advantage|value|profit|revenue|investment|market|customer|client|service|product|brand|reputation|competitive|industry|sector|economy|economic|financial|budget|cost|price|sales|marketing|advertising|promotion|campaign|strategy|planning|implementation|execution|evaluation|assessment|improvement|optimization|transformation|change|adaptation|flexibility|agility|resilience|sustainability|environmental|social|ethical|governance|compliance|regulation|policy|procedure|standard|guideline|framework|methodology|approach|technique|method|process|system|structure|organization|hierarchy|department|division|function|role|position|title|career|development|training|education|learning|knowledge|information|data|insight|intelligence)/.test(word)) {\n                score += 4;\n            }\n            // Academic and formal vocabulary\n            if (/^(research|study|analysis|theory|concept|principle|method|approach|technique|process|system|structure|function|relationship|connection|interaction|influence|effect|impact|cause|result|consequence|factor|element|component|aspect|feature|characteristic|property|quality|attribute|dimension|level|degree|extent|scope|range|scale|measure|measurement|evaluation|assessment|comparison|contrast|similarity|difference|variation|change|development|evolution|progress|advancement|improvement|enhancement|modification|adjustment|adaptation|transformation|revolution|innovation|discovery|invention|creation|production|construction|design|planning|organization|management|administration|operation|implementation|execution|performance|achievement|accomplishment)/.test(word)) {\n                score += 3;\n            }\n            // Action words and processes (often good for learning)\n            if (/^(announce|reorganize|manage|develop|implement|achieve|improve|transform|communicate|collaborate|investigate|explore|examine|evaluate|assess|consider|discuss|negotiate|present|demonstrate|explain|describe|illustrate|interpret|translate|adapt|modify|optimize|organize|coordinate|administer|supervise|operate|execute|perform|accomplish|establish|maintain|preserve|conserve|protect|prevent|promote|advance|enhance|enrich|empower|engage|involve|participate|contribute|dedicate|commit|invest|allocate|distribute|circulate|transmit|transport|deliver|provide|supply|support|assist|guide|direct|instruct|educate|train|prepare|plan|schedule|arrange|coordinate|synchronize|integrate|combine|connect|associate|relate|partner|collaborate|cooperate|compete|compare|contrast|differentiate|distinguish|identify|recognize|acknowledge|appreciate|understand|comprehend|realize|aware|conscious|perceive|observe|monitor|track|measure|calculate|estimate|predict|forecast|project|anticipate|expect|assume|hypothesize|speculate|investigate|explore|research|analyze|synthesize|evaluate|assess|judge|decide|choose|select|prefer|recommend|suggest|propose|offer|request|demand|require|specify|instruct|direct|guide|advise|consult|discuss|negotiate|agree|contract|deal|transaction|exchange|trade|purchase|sale|investment|funding|financing|sponsorship|support|assistance|service|provision|delivery|distribution|allocation|assignment|delegation|authorization|approval|permission|consent|acceptance|rejection|refusal|denial|prohibition|restriction|limitation|constraint|regulation|control|management|administration|governance|leadership|supervision|oversight|monitoring|evaluation|assessment|review|audit|inspection|examination|investigation|inquiry)/.test(word)) {\n                score += 3;\n            }\n            // Frequency bonus (words that appear multiple times are likely important)\n            const frequency = (text.toLowerCase().match(new RegExp(`\\\\b${word}\\\\b`, \"g\")) || []).length;\n            if (frequency > 1) score += frequency * 2;\n            // Length bonus for substantial words\n            if (word.length >= 6 && word.length <= 12) score += 1;\n            return {\n                word,\n                score\n            };\n        });\n        // Sort by score and return top words\n        const topWords = scoredWords.sort((a, b)=>b.score - a.score).slice(0, 8) // Take top 8 words\n        .map((item)=>item.word);\n        console.log(\"\\uD83D\\uDCDA Meaningful vocabulary extraction results:\", topWords.map((w)=>`${w} (score: ${scoredWords.find((s)=>s.word === w)?.score})`));\n        return topWords;\n    }\n    extractVocabularyFromText(text, level) {\n        // Smart vocabulary extraction focusing on meaningful, educational words\n        const words = text.toLowerCase().match(/\\b[a-z]{3,}\\b/g) || [];\n        const uniqueWords = Array.from(new Set(words));\n        // Words to exclude (common, non-educational words)\n        const excludeWords = new Set([\n            // Common words\n            \"the\",\n            \"and\",\n            \"for\",\n            \"are\",\n            \"but\",\n            \"not\",\n            \"you\",\n            \"all\",\n            \"can\",\n            \"had\",\n            \"her\",\n            \"was\",\n            \"one\",\n            \"our\",\n            \"out\",\n            \"day\",\n            \"get\",\n            \"has\",\n            \"him\",\n            \"his\",\n            \"how\",\n            \"its\",\n            \"may\",\n            \"new\",\n            \"now\",\n            \"old\",\n            \"see\",\n            \"two\",\n            \"who\",\n            \"boy\",\n            \"did\",\n            \"she\",\n            \"use\",\n            \"way\",\n            \"what\",\n            \"when\",\n            \"where\",\n            \"will\",\n            \"with\",\n            \"have\",\n            \"this\",\n            \"that\",\n            \"they\",\n            \"been\",\n            \"said\",\n            \"each\",\n            \"which\",\n            \"their\",\n            \"time\",\n            \"would\",\n            \"there\",\n            \"could\",\n            \"other\",\n            \"after\",\n            \"first\",\n            \"well\",\n            \"water\",\n            \"very\",\n            \"what\",\n            \"know\",\n            \"just\",\n            \"people\",\n            \"into\",\n            \"over\",\n            \"think\",\n            \"also\",\n            \"back\",\n            \"work\",\n            \"life\",\n            \"only\",\n            \"year\",\n            \"years\",\n            \"come\",\n            \"came\",\n            \"right\",\n            \"good\",\n            \"each\",\n            \"those\",\n            \"feel\",\n            \"seem\",\n            \"these\",\n            \"give\",\n            \"most\",\n            \"hand\",\n            \"high\",\n            \"keep\",\n            \"last\",\n            \"left\",\n            \"life\",\n            \"live\",\n            \"look\",\n            \"made\",\n            \"make\",\n            \"many\",\n            \"much\",\n            \"must\",\n            \"name\",\n            \"need\",\n            \"next\",\n            \"open\",\n            \"part\",\n            \"play\",\n            \"said\",\n            \"same\",\n            \"seem\",\n            \"show\",\n            \"side\",\n            \"take\",\n            \"tell\",\n            \"turn\",\n            \"want\",\n            \"ways\",\n            \"well\",\n            \"went\",\n            \"were\",\n            \"here\",\n            \"home\",\n            \"long\",\n            \"look\",\n            \"move\",\n            \"place\",\n            \"right\",\n            \"small\",\n            \"sound\",\n            \"still\",\n            \"such\",\n            \"thing\",\n            \"think\",\n            \"three\",\n            \"under\",\n            \"water\",\n            \"where\",\n            \"while\",\n            \"world\",\n            \"write\",\n            \"young\",\n            // Dates, numbers, names (often not useful for vocabulary)\n            \"january\",\n            \"february\",\n            \"march\",\n            \"april\",\n            \"june\",\n            \"july\",\n            \"august\",\n            \"september\",\n            \"october\",\n            \"november\",\n            \"december\",\n            \"monday\",\n            \"tuesday\",\n            \"wednesday\",\n            \"thursday\",\n            \"friday\",\n            \"saturday\",\n            \"sunday\",\n            \"today\",\n            \"yesterday\",\n            \"tomorrow\",\n            \"morning\",\n            \"afternoon\",\n            \"evening\",\n            \"night\",\n            // Common proper nouns that are often not educational\n            \"francisco\",\n            \"california\",\n            \"america\",\n            \"american\",\n            \"united\",\n            \"states\",\n            \"york\",\n            \"london\",\n            \"paris\",\n            \"tokyo\"\n        ]);\n        // Prioritize meaningful vocabulary categories\n        const meaningfulWords = uniqueWords.filter((word)=>{\n            // Skip excluded words\n            if (excludeWords.has(word)) return false;\n            // Skip pure numbers or dates\n            if (/^\\d+$/.test(word) || /^\\d{4}$/.test(word)) return false;\n            // Skip very short words (less than 4 letters) unless they're important\n            if (word.length < 4) return false;\n            // Skip very long words that might be too complex\n            if (word.length > 15) return false;\n            return true;\n        });\n        // Score words based on educational value\n        const scoredWords = meaningfulWords.map((word)=>{\n            let score = 0;\n            // Business/professional vocabulary\n            if (/^(manage|leader|team|company|business|strategy|develop|create|innovat|technolog|digital|global|international|professional|experience|skill|expert|analysis|research|project|solution|challenge|opportunity|growth|success|achievement|performance|quality|efficiency|productivity|collaboration|communication|decision|responsibility|objective|goal|target|result|outcome|impact|benefit|advantage|value|profit|revenue|investment|market|customer|client|service|product|brand|reputation|competitive|industry|sector|economy|economic|financial|budget|cost|price|sales|marketing|advertising|promotion|campaign|strategy|planning|implementation|execution|evaluation|assessment|improvement|optimization|transformation|change|adaptation|flexibility|agility|resilience|sustainability|environmental|social|ethical|governance|compliance|regulation|policy|procedure|standard|guideline|framework|methodology|approach|technique|method|process|system|structure|organization|hierarchy|department|division|function|role|position|title|career|development|training|education|learning|knowledge|information|data|insight|intelligence|wisdom|understanding|comprehension|awareness|consciousness|perception|perspective|viewpoint|opinion|belief|attitude|mindset|culture|values|principles|ethics|integrity|honesty|transparency|accountability|responsibility|commitment|dedication|passion|motivation|inspiration|creativity|innovation|imagination|vision|mission|purpose|meaning|significance|importance|relevance|priority|urgency|critical|essential|fundamental|basic|advanced|complex|sophisticated|comprehensive|detailed|specific|particular|general|overall|total|complete|full|entire|whole|partial|limited|restricted|exclusive|inclusive|diverse|varied|different|similar|comparable|equivalent|equal|fair|just|reasonable|logical|rational|practical|realistic|achievable|feasible|possible|probable|likely|unlikely|impossible|certain|uncertain|confident|doubtful|optimistic|pessimistic|positive|negative|neutral|objective|subjective|personal|individual|collective|social|public|private|internal|external|local|regional|national|international|global|worldwide|universal)/.test(word)) {\n                score += 3;\n            }\n            // Academic/educational vocabulary\n            if (/^(research|study|analysis|theory|concept|principle|method|approach|technique|process|system|structure|function|relationship|connection|interaction|influence|effect|impact|cause|result|consequence|factor|element|component|aspect|feature|characteristic|property|quality|attribute|dimension|level|degree|extent|scope|range|scale|measure|measurement|evaluation|assessment|comparison|contrast|similarity|difference|variation|change|development|evolution|progress|advancement|improvement|enhancement|modification|adjustment|adaptation|transformation|revolution|innovation|discovery|invention|creation|production|construction|design|planning|organization|management|administration|operation|implementation|execution|performance|achievement|accomplishment|success|failure|challenge|problem|issue|difficulty|obstacle|barrier|limitation|constraint|restriction|requirement|condition|situation|circumstance|context|environment|setting|background|history|tradition|culture|society|community|population|group|team|organization|institution|establishment|authority|government|administration|policy|regulation|law|rule|standard|guideline|procedure|protocol|framework|model|pattern|template|example|instance|case|scenario|situation|condition|state|status|position|location|place|area|region|zone|territory|domain|field|sector|industry|market|economy|business|commerce|trade|exchange|transaction|deal|agreement|contract|partnership|collaboration|cooperation|coordination|communication|interaction|relationship|connection|network|system|structure|organization|hierarchy|level|rank|grade|class|category|type|kind|sort|variety|diversity|range|spectrum)/.test(word)) {\n                score += 2;\n            }\n            // Technical/specialized vocabulary\n            if (/^(technolog|digital|computer|software|hardware|internet|online|website|platform|application|program|code|data|information|network|system|security|privacy|encryption|algorithm|artificial|intelligence|machine|learning|automation|robot|innovation|development|engineering|science|scientific|medical|health|treatment|diagnosis|research|experiment|laboratory|equipment|instrument|device|tool|machine|mechanism|process|procedure|technique|method|approach|strategy|solution|problem|challenge|opportunity|advantage|benefit|risk|threat|danger|safety|protection|prevention|control|management|monitoring|supervision|oversight|governance|regulation|compliance|standard|quality|performance|efficiency|effectiveness|productivity|optimization|improvement|enhancement|upgrade|update|modification|customization|personalization|adaptation|flexibility|scalability|sustainability|reliability|durability|stability|consistency|accuracy|precision|validity|credibility|authenticity|transparency|accountability|responsibility|integrity|ethics|morality|values|principles|beliefs|attitudes|perspectives|opinions|views|thoughts|ideas|concepts|theories|models|frameworks|paradigms|approaches|methodologies|strategies|tactics|techniques|procedures|protocols)/.test(word)) {\n                score += 2;\n            }\n            // Action/process words (verbs in noun form or gerunds)\n            if (/^(announcement|leadership|management|development|implementation|achievement|improvement|transformation|communication|collaboration|investigation|exploration|examination|evaluation|assessment|consideration|discussion|negotiation|presentation|demonstration|explanation|description|illustration|interpretation|translation|adaptation|modification|optimization|organization|coordination|administration|supervision|operation|execution|performance|accomplishment|establishment|maintenance|preservation|conservation|protection|prevention|promotion|advancement|enhancement|enrichment|empowerment|engagement|involvement|participation|contribution|dedication|commitment|investment|allocation|distribution|circulation|transmission|transportation|delivery|provision|supply|support|assistance|guidance|direction|instruction|education|training|preparation|planning|scheduling|arrangement|coordination|synchronization|integration|combination|connection|association|relationship|partnership|collaboration|cooperation|competition|comparison|contrast|differentiation|distinction|identification|recognition|acknowledgment|appreciation|understanding|comprehension|realization|awareness|consciousness|perception|observation|monitoring|tracking|measurement|calculation|estimation|prediction|forecasting|projection|anticipation|expectation|assumption|hypothesis|speculation|investigation|exploration|research|analysis|synthesis|evaluation|assessment|judgment|decision|choice|selection|preference|recommendation|suggestion|proposal|offer|request|demand|requirement|specification|instruction|direction|guidance|advice|consultation|discussion|negotiation|agreement|contract|deal|transaction|exchange|trade|purchase|sale|investment|funding|financing|sponsorship|support|assistance|service|provision|delivery|distribution|allocation|assignment|delegation|authorization|approval|permission|consent|acceptance|rejection|refusal|denial|prohibition|restriction|limitation|constraint|regulation|control|management|administration|governance|leadership|supervision|oversight|monitoring|evaluation|assessment|review|audit|inspection|examination|investigation|inquiry|research|study|analysis|interpretation|explanation|clarification|specification|definition|description|illustration|demonstration|presentation|exhibition|display|show|performance|execution|implementation|application|utilization|employment|usage|operation|function|activity|action|behavior|conduct|practice|procedure|process|method|technique|approach|strategy|plan|scheme|program|project|initiative|campaign|movement|effort|attempt|trial|experiment|test|examination|evaluation|assessment|measurement|calculation|estimation|determination|identification|recognition|discovery|invention|creation|production|construction|building|development|growth|expansion|extension|enlargement|increase|improvement|enhancement|upgrade|advancement|progress|evolution|transformation|change|modification|adjustment|adaptation|customization|personalization|optimization|refinement|perfection|completion|achievement|accomplishment|success|victory|triumph|conquest|defeat|failure|loss|mistake|error|problem|issue|difficulty|challenge|obstacle|barrier|limitation|constraint|restriction|requirement|condition|situation|circumstance|context|environment|setting|atmosphere|climate|culture|tradition|custom|habit|routine|pattern|trend|tendency|inclination|preference|choice|option|alternative|possibility|opportunity|chance|probability|likelihood|certainty|uncertainty|doubt|confidence|trust|faith|belief|conviction|opinion|view|perspective|standpoint|position|stance|attitude|approach|mindset|mentality|psychology|philosophy|ideology|theory|concept|idea|notion|thought|consideration|reflection|contemplation|meditation|concentration|focus|attention|interest|curiosity|wonder|amazement|surprise|shock|astonishment|bewilderment|confusion|uncertainty|clarity|understanding|comprehension|knowledge|information|data|facts|details|specifics|particulars|characteristics|features|attributes|properties|qualities|aspects|elements|components|parts|sections|segments|divisions|categories|types|kinds|varieties|forms|shapes|sizes|dimensions|measurements|quantities|amounts|numbers|figures|statistics|percentages|proportions|ratios|rates|speeds|frequencies|intervals|periods|durations|times|moments|instances|occasions|events|incidents|occurrences|happenings|developments|changes|modifications|alterations|adjustments|improvements|enhancements|upgrades|updates|revisions|corrections|fixes|repairs|maintenance|preservation|conservation|protection|security|safety|defense|prevention|precaution|preparation|readiness|availability|accessibility|convenience|comfort|ease|simplicity|complexity|difficulty|challenge|complication|sophistication|advancement|progress|development|growth|expansion|extension|increase|rise|improvement|enhancement|betterment|amelioration|optimization|perfection|excellence|quality|standard|level|grade|rank|status|position|location|place|site|spot|point|area|region|zone|territory|domain|field|sector|industry|market|economy|business|enterprise|organization|institution|establishment|company|corporation|firm|agency|department|division|section|unit|team|group|committee|board|council|assembly|association|society|community|population|public|audience|customers|clients|users|consumers|buyers|purchasers|investors|stakeholders|shareholders|partners|collaborators|colleagues|associates|members|participants|contributors|supporters|advocates|representatives|delegates|ambassadors|spokespersons|leaders|managers|directors|executives|administrators|supervisors|coordinators|organizers|planners|designers|developers|creators|producers|manufacturers|suppliers|providers|distributors|retailers|sellers|vendors|contractors|consultants|advisors|experts|specialists|professionals|practitioners|technicians|operators|workers|employees|staff|personnel|workforce|labor|human|resources|capital|assets|investments|funds|finances|budget|costs|expenses|revenues|income|profits|earnings|returns|benefits|advantages|gains|losses|risks|threats|dangers|hazards|challenges|problems|issues|difficulties|obstacles|barriers|limitations|constraints|restrictions|requirements|conditions|terms|specifications|standards|criteria|guidelines|rules|regulations|policies|procedures|protocols|processes|methods|techniques|approaches|strategies|plans|programs|projects|initiatives|campaigns|efforts|activities|actions|operations|functions|services|products|goods|items|articles|objects|things|materials|substances|elements|components|ingredients|contents)$/.test(word)) {\n                score += 3;\n            }\n            // Bonus for words that appear multiple times (indicating importance)\n            const frequency = (text.toLowerCase().match(new RegExp(`\\\\b${word}\\\\b`, \"g\")) || []).length;\n            if (frequency > 1) score += frequency;\n            return {\n                word,\n                score\n            };\n        });\n        // Sort by score and return top words\n        const topWords = scoredWords.sort((a, b)=>b.score - a.score).slice(0, 10).map((item)=>item.word);\n        console.log(\"\\uD83D\\uDCDA Smart vocabulary extraction results:\", topWords);\n        return topWords;\n    }\n    determineCulturalContext(domain, text) {\n        // Determine cultural context based on domain and content\n        const culturalIndicators = {\n            \"bbc.com\": \"British English, UK culture\",\n            \"cnn.com\": \"American English, US culture\",\n            \"wikipedia.org\": \"International, encyclopedic\",\n            \"nytimes.com\": \"American English, US perspective\",\n            \"theguardian.com\": \"British English, UK perspective\"\n        };\n        if (culturalIndicators[domain]) {\n            return culturalIndicators[domain];\n        }\n        // Analyze text for cultural markers\n        const americanMarkers = [\n            \"dollar\",\n            \"president\",\n            \"congress\",\n            \"state\",\n            \"federal\"\n        ];\n        const britishMarkers = [\n            \"pound\",\n            \"minister\",\n            \"parliament\",\n            \"council\",\n            \"government\"\n        ];\n        const americanCount = americanMarkers.filter((marker)=>text.toLowerCase().includes(marker)).length;\n        const britishCount = britishMarkers.filter((marker)=>text.toLowerCase().includes(marker)).length;\n        if (americanCount > britishCount) {\n            return \"American English context\";\n        } else if (britishCount > americanCount) {\n            return \"British English context\";\n        }\n        return \"International context\";\n    }\n    generateLearningObjectives(contentType, topics, level) {\n        const objectives = [];\n        // Base objectives on content type\n        switch(contentType){\n            case \"news\":\n                objectives.push(\"Understand current events vocabulary\");\n                objectives.push(\"Practice reading news articles\");\n                break;\n            case \"blog\":\n                objectives.push(\"Learn informal writing style\");\n                objectives.push(\"Understand personal opinions and experiences\");\n                break;\n            case \"tutorial\":\n                objectives.push(\"Follow step-by-step instructions\");\n                objectives.push(\"Learn technical vocabulary\");\n                break;\n            case \"encyclopedia\":\n                objectives.push(\"Understand factual information\");\n                objectives.push(\"Learn academic vocabulary\");\n                break;\n            default:\n                objectives.push(\"Improve reading comprehension\");\n                objectives.push(\"Expand vocabulary knowledge\");\n        }\n        // Add topic-specific objectives\n        topics.slice(0, 2).forEach((topic)=>{\n            objectives.push(`Discuss topics related to ${topic.toLowerCase()}`);\n        });\n        return objectives.slice(0, 4);\n    }\n    getAudienceLevel(cefrLevel) {\n        const levelMap = {\n            \"A1\": \"beginner\",\n            \"A2\": \"beginner\",\n            \"B1\": \"general\",\n            \"B2\": \"general\",\n            \"C1\": \"expert\"\n        };\n        return levelMap[cefrLevel] || \"general\";\n    }\n    // Enhanced fallback lesson generation with context\n    generateEnhancedFallbackLesson(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage, contentMetadata, structuredContent } = params;\n        console.log(\"\\uD83D\\uDD04 Generating enhanced fallback lesson with contextual warm-up...\");\n        // Use available context even in fallback\n        const topics = structuredContent?.headings?.map((h)=>h.text).slice(0, 3) || [];\n        const contentType = contentMetadata?.contentType || \"general\";\n        // Create mock content analysis for fallback warm-up generation\n        const mockContentAnalysis = {\n            topics: topics,\n            contentType: contentType,\n            sourceCountry: this.determineSourceCountry(contentMetadata?.domain || \"\"),\n            culturalContext: this.determineCulturalContext(contentMetadata?.domain || \"\", sourceText)\n        };\n        // Generate contextual warm-up questions even in fallback\n        const contextualWarmup = this.getContextualWarmupFallback(studentLevel, mockContentAnalysis, contentMetadata);\n        console.log(\"\\uD83D\\uDD25 Generated fallback contextual warm-up:\", contextualWarmup);\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: contextualWarmup,\n                vocabulary: this.extractContextualVocabulary(sourceText, studentLevel, topics),\n                reading: this.simplifyText(sourceText, studentLevel),\n                comprehension: this.getContextualComprehension(lessonType, studentLevel, topics),\n                dialoguePractice: this.generateTemplateDialoguePractice(topics[0] || \"this topic\", studentLevel, []),\n                dialogueFillGap: this.generateTemplateDialogueFillGap(topics[0] || \"this topic\", studentLevel, []),\n                discussion: this.getContextualDiscussion(lessonType, studentLevel, topics),\n                grammar: this.getTemplateGrammar(studentLevel),\n                pronunciation: this.getTemplatePronunciation(sourceText),\n                wrapup: this.getContextualWrapup(lessonType, topics)\n            }\n        };\n    }\n    getContextualWarmup(lessonType, studentLevel, topics, contentType) {\n        // Use the same contextual fallback logic\n        const mockAnalysis = {\n            topics: topics,\n            contentType: contentType,\n            sourceCountry: \"International\"\n        };\n        return this.getContextualWarmupFallback(studentLevel, mockAnalysis, {\n            title: topics[0] || \"Content\"\n        });\n    }\n    // Basic fallback for complete failures\n    generateBasicFallbackLesson(params) {\n        const { sourceText, lessonType, studentLevel, targetLanguage } = params;\n        return {\n            lessonType,\n            studentLevel,\n            targetLanguage,\n            sections: {\n                warmup: [\n                    \"What do you already know about this topic?\",\n                    \"Have you had similar experiences?\",\n                    \"What would you like to learn?\"\n                ],\n                vocabulary: [],\n                reading: sourceText.substring(0, 400),\n                comprehension: [\n                    \"What is the main idea?\",\n                    \"What details can you identify?\"\n                ],\n                dialoguePractice: this.generateTemplateDialoguePractice(\"this topic\", studentLevel, []),\n                dialogueFillGap: this.generateTemplateDialogueFillGap(\"this topic\", studentLevel, []),\n                discussion: [\n                    \"What is your opinion?\",\n                    \"How would you handle this?\"\n                ],\n                grammar: this.getTemplateGrammar(studentLevel),\n                pronunciation: {\n                    word: \"example\",\n                    ipa: \"/z\\xe6mpl/\",\n                    practice: \"Practice saying example.\"\n                },\n                wrapup: [\n                    \"What did you learn?\",\n                    \"What needs more practice?\"\n                ]\n            }\n        };\n    }\n    extractContextualVocabulary(text, studentLevel, topics) {\n        const vocabulary = this.extractVocabulary(text, studentLevel);\n        // Enhance with topic context if available\n        if (topics.length > 0) {\n            return vocabulary.map((vocab, index)=>({\n                    ...vocab,\n                    context: index < topics.length ? `Related to ${topics[index].toLowerCase()}` : vocab.meaning\n                }));\n        }\n        return vocabulary;\n    }\n    getContextualComprehension(lessonType, studentLevel, topics) {\n        const baseQuestions = this.getTemplateComprehension(lessonType, studentLevel);\n        if (topics.length > 0) {\n            return [\n                `What is the main point about ${topics[0]?.toLowerCase()}?`,\n                `How does the text explain ${topics[1]?.toLowerCase() || \"the topic\"}?`,\n                \"What supporting details can you identify?\",\n                \"What conclusions can you draw from this information?\"\n            ];\n        }\n        return baseQuestions;\n    }\n    getContextualDiscussion(lessonType, studentLevel, topics) {\n        const baseQuestions = this.getTemplateDiscussion(lessonType, studentLevel);\n        if (topics.length > 0) {\n            return [\n                `What is your opinion about ${topics[0]?.toLowerCase()}?`,\n                `How would you apply this information about ${topics[1]?.toLowerCase() || \"this topic\"}?`,\n                `What are the implications of what you learned about ${topics[0]?.toLowerCase()}?`\n            ];\n        }\n        return baseQuestions;\n    }\n    getContextualWrapup(lessonType, topics) {\n        if (topics.length > 0) {\n            return [\n                `What new vocabulary did you learn about ${topics[0]?.toLowerCase()}?`,\n                `Which concepts about ${topics[1]?.toLowerCase() || \"this topic\"} need more practice?`,\n                \"How will you use this knowledge in real situations?\",\n                \"What questions do you still have about this content?\"\n            ];\n        }\n        return this.getTemplateWrapup(lessonType);\n    }\n    // Template dialogue generation methods\n    generateTemplateDialoguePractice(topic, studentLevel, vocabularyWords) {\n        const levelDialogues = {\n            \"A1\": {\n                instruction: \"Practice this simple conversation with your tutor:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `I want to learn about ${topic}.`\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `That's great! What do you already know about ${topic}?`\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"I know a little bit.\"\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `Let's explore ${topic} together.`\n                    }\n                ],\n                followUpQuestions: [\n                    `What interests you most about ${topic}?`,\n                    \"What would you like to know more about?\",\n                    \"How can this help you in daily life?\"\n                ]\n            },\n            \"A2\": {\n                instruction: \"Practice this conversation with your tutor:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `I've been reading about ${topic}. It's quite interesting.`\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What did you find most interesting about ${topic}?`\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"I learned some new things I didn't know before.\"\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `Can you share what you learned about ${topic}?`\n                    }\n                ],\n                followUpQuestions: [\n                    `How does ${topic} relate to your experience?`,\n                    \"What surprised you the most?\",\n                    \"Would you recommend this topic to others?\"\n                ]\n            },\n            \"B1\": {\n                instruction: \"Practice this discussion with your tutor:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `I've been thinking about ${topic} and its implications.`\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `That's a complex topic. What aspects of ${topic} interest you most?`\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"There are several factors to consider when discussing this.\"\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `Let's explore those factors. What do you think is most important about ${topic}?`\n                    }\n                ],\n                followUpQuestions: [\n                    `What are the advantages and disadvantages of ${topic}?`,\n                    \"How might this impact different groups of people?\",\n                    \"What solutions would you propose?\"\n                ]\n            },\n            \"B2\": {\n                instruction: \"Engage in this analytical discussion with your tutor:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `The complexity of ${topic} requires careful analysis of multiple perspectives.`\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `Excellent point. How do you think different stakeholders view ${topic}?`\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"Each perspective brings unique insights and challenges to consider.\"\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What evidence supports your analysis of ${topic}?`\n                    }\n                ],\n                followUpQuestions: [\n                    `How do cultural differences influence perspectives on ${topic}?`,\n                    \"What long-term consequences should we consider?\",\n                    \"How would you evaluate the effectiveness of current approaches?\"\n                ]\n            },\n            \"C1\": {\n                instruction: \"Participate in this sophisticated discourse with your tutor:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `The nuanced nature of ${topic} demands a multifaceted approach to understanding.`\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `Indeed. How do you reconcile the apparent contradictions within ${topic}?`\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"The paradoxes inherent in this subject reflect broader societal complexities.\"\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What theoretical frameworks best illuminate the intricacies of ${topic}?`\n                    }\n                ],\n                followUpQuestions: [\n                    `How do philosophical underpinnings shape our understanding of ${topic}?`,\n                    \"What paradigm shifts might be necessary for progress?\",\n                    \"How do you envision the evolution of thought regarding this matter?\"\n                ]\n            }\n        };\n        return levelDialogues[studentLevel] || levelDialogues[\"B1\"];\n    }\n    generateTemplateDialogueFillGap(topic, studentLevel, vocabularyWords) {\n        const levelGapDialogues = {\n            \"A1\": {\n                instruction: \"Fill in the gaps in this conversation:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `I _____ to learn about ${topic}.`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `That's great! What _____ you already know?`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"I know _____ little bit.\",\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `Let's _____ together.`,\n                        isGap: true\n                    }\n                ],\n                answers: [\n                    \"want\",\n                    \"do\",\n                    \"a\",\n                    \"learn\"\n                ]\n            },\n            \"A2\": {\n                instruction: \"Complete this conversation with the missing words:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `I've been _____ about ${topic}.`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What did you _____ most interesting?`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"I _____ some new things.\",\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `Can you _____ what you learned?`,\n                        isGap: true\n                    }\n                ],\n                answers: [\n                    \"reading\",\n                    \"find\",\n                    \"learned\",\n                    \"share\"\n                ]\n            },\n            \"B1\": {\n                instruction: \"Fill in the blanks to complete this discussion:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `I've been _____ about ${topic} and its implications.`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What _____ interest you most?`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"There are several _____ to consider.\",\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What do you think is most _____ ?`,\n                        isGap: true\n                    }\n                ],\n                answers: [\n                    \"thinking\",\n                    \"aspects\",\n                    \"factors\",\n                    \"important\"\n                ]\n            },\n            \"B2\": {\n                instruction: \"Complete this analytical discussion:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `The _____ of ${topic} requires careful analysis.`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `How do different _____ view this topic?`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"Each perspective brings unique _____ .\",\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What _____ supports your analysis?`,\n                        isGap: true\n                    }\n                ],\n                answers: [\n                    \"complexity\",\n                    \"stakeholders\",\n                    \"insights\",\n                    \"evidence\"\n                ]\n            },\n            \"C1\": {\n                instruction: \"Fill in the sophisticated vocabulary:\",\n                dialogue: [\n                    {\n                        character: \"Student\",\n                        line: `The _____ nature of ${topic} demands a multifaceted approach.`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `How do you _____ the apparent contradictions?`,\n                        isGap: true\n                    },\n                    {\n                        character: \"Student\",\n                        line: \"The _____ reflect broader complexities.\",\n                        isGap: true\n                    },\n                    {\n                        character: \"Tutor\",\n                        line: `What theoretical _____ best illuminate this?`,\n                        isGap: true\n                    }\n                ],\n                answers: [\n                    \"nuanced\",\n                    \"reconcile\",\n                    \"paradoxes\",\n                    \"frameworks\"\n                ]\n            }\n        };\n        return levelGapDialogues[studentLevel] || levelGapDialogues[\"B1\"];\n    }\n    constructor(){\n        this.googleAI = null;\n        this.progressiveGenerator = null;\n    }\n}\nconst lessonAIServerGenerator = new LessonAIServerGenerator();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvbGVzc29uLWFpLWdlbmVyYXRvci1zZXJ2ZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQXVDO0FBQ3lCO0FBQzZEO0FBQ3ZEO0FBMkUvRCxNQUFNSTtJQUlIQyxjQUFjO1FBQ3BCLElBQUksQ0FBQyxJQUFJLENBQUNDLFFBQVEsRUFBRTtZQUNsQixJQUFJLENBQUNBLFFBQVEsR0FBR0wsOEVBQTJCQTtRQUM3QztRQUNBLE9BQU8sSUFBSSxDQUFDSyxRQUFRO0lBQ3RCO0lBRVFDLDBCQUEwQjtRQUNoQyxJQUFJLENBQUMsSUFBSSxDQUFDQyxvQkFBb0IsRUFBRTtZQUM5QixJQUFJLENBQUNBLG9CQUFvQixHQUFHLElBQUlOLDRFQUF3QkE7UUFDMUQ7UUFDQSxPQUFPLElBQUksQ0FBQ00sb0JBQW9CO0lBQ2xDO0lBRUEsK0NBQStDO0lBQy9DLE1BQWNDLHlCQUF5QkMsVUFBa0IsRUFBRUMsWUFBb0IsRUFBRUMsY0FBc0IsRUFBbUI7UUFDeEgsSUFBSTtZQUNGLE1BQU1DLGdCQUFnQjtnQkFDcEIsTUFBTTtnQkFDTixNQUFNO2dCQUNOLE1BQU07Z0JBQ04sTUFBTTtnQkFDTixNQUFNO1lBQ1I7WUFFQSxNQUFNQyxXQUFXRCxhQUFhLENBQUNGLGFBQWEsSUFBSUUsYUFBYSxDQUFDLEtBQUs7WUFFbkUsTUFBTUUsU0FBUyxDQUFDLHVDQUF1QyxFQUFFSixhQUFhLE9BQU8sRUFBRUMsZUFBZTs7QUFFcEcsRUFBRUYsV0FBV00sU0FBUyxDQUFDLEdBQUcsTUFBTTs7O0VBRzlCLEVBQUVGLFNBQVM7OztpQ0FHb0IsRUFBRUgsYUFBYTs7Ozs7MkNBS0wsQ0FBQztZQUV0Q00sUUFBUUMsR0FBRyxDQUFDLDJDQUFpQ0gsT0FBT0ksTUFBTSxFQUFFO1lBQzVELE1BQU1DLFdBQVcsTUFBTSxJQUFJLENBQUNmLFdBQVcsR0FBR1UsTUFBTSxDQUFDQTtZQUVqRCxPQUFPSyxTQUFTQyxJQUFJLE1BQU1YLFdBQVdNLFNBQVMsQ0FBQyxHQUFHO1FBQ3BELEVBQUUsT0FBT00sT0FBTztZQUNkTCxRQUFRQyxHQUFHLENBQUM7WUFDWixPQUFPUixXQUFXTSxTQUFTLENBQUMsR0FBRztRQUNqQztJQUNGO0lBRUEsTUFBTU8sZUFBZUMsTUFBOEIsRUFBNEI7UUFDN0UsTUFBTSxFQUNKZCxVQUFVLEVBQ1ZlLFVBQVUsRUFDVmQsWUFBWSxFQUNaQyxjQUFjLEVBQ2RjLFNBQVMsRUFDVEMsZUFBZSxFQUNmQyxpQkFBaUIsRUFDakJDLFNBQVMsRUFDVEMsV0FBVyxFQUNYQyxVQUFVLEVBQ1gsR0FBR1A7UUFFSixrQ0FBa0M7UUFDbEMsTUFBTVEsb0JBQXVDO1lBQzNDQyxVQUFVLENBQUMsT0FBTyxFQUFFQyxLQUFLQyxHQUFHLEdBQUcsQ0FBQyxFQUFFQyxLQUFLQyxNQUFNLEdBQUdDLFFBQVEsQ0FBQyxJQUFJQyxNQUFNLENBQUMsR0FBRyxHQUFHLENBQUM7WUFDM0VkO1lBQ0FlLGlCQUFpQjdCO1lBQ2pCOEIsZUFBZS9CLFdBQVdTLE1BQU07WUFDaEN1QixXQUFXLElBQUlSO1FBQ2pCO1FBRUEsc0JBQXNCO1FBQ3RCLElBQUksQ0FBQ3hCLGNBQWMsT0FBT0EsZUFBZSxVQUFVO1lBQ2pELE1BQU0sSUFBSWlDLE1BQU07UUFDbEI7UUFFQTFCLFFBQVFDLEdBQUcsQ0FBQyx3REFBOEM7WUFDeEQwQixZQUFZbEMsV0FBV1MsTUFBTTtZQUM3Qk07WUFDQWQ7WUFDQUM7WUFDQWlDLGFBQWEsQ0FBQyxDQUFDbEI7WUFDZm1CLHNCQUFzQixDQUFDLENBQUNsQjtRQUMxQjtRQUlBLElBQUk7WUFDRix1REFBdUQ7WUFDdkRYLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE1BQU02QixzQkFBc0JiLEtBQUtDLEdBQUc7WUFDcEMsTUFBTWEsaUJBQWlCLE1BQU0sSUFBSSxDQUFDdkMsd0JBQXdCLENBQUNDLFlBQVlDLGNBQWNDO1lBQ3JGLE1BQU1xQyxvQkFBb0JmLEtBQUtDLEdBQUc7WUFFbEMsK0JBQStCO1lBQy9CaEMsd0RBQVlBLENBQUMrQyxhQUFhLENBQ3hCLHNCQUNBZCxLQUFLZSxJQUFJLENBQUN6QyxXQUFXUyxNQUFNLEdBQUcsSUFDOUIseUJBQ0FhO1lBR0ZmLFFBQVFDLEdBQUcsQ0FBQyxzQkFBc0I4QixlQUFlN0IsTUFBTSxFQUFFO1lBRXpELCtDQUErQztZQUMvQ0YsUUFBUUMsR0FBRyxDQUFDO1lBQ1osTUFBTWtDLDRCQUE0QmxCLEtBQUtDLEdBQUc7WUFDMUMsTUFBTWtCLGtCQUFrQixNQUFNLElBQUksQ0FBQ0MsdUJBQXVCLENBQ3hETixnQkFDQXZCLFlBQ0FkLGNBQ0FDLGdCQUNBZSxpQkFDQUk7WUFFRixNQUFNd0IsMEJBQTBCckIsS0FBS0MsR0FBRztZQUV4Qyw4QkFBOEI7WUFDOUJoQyx3REFBWUEsQ0FBQytDLGFBQWEsQ0FDeEIsK0JBQ0FkLEtBQUtlLElBQUksQ0FBQ0gsZUFBZTdCLE1BQU0sR0FBRyxJQUNsQyx5QkFDQWE7WUFHRmYsUUFBUUMsR0FBRyxDQUFDLGtDQUFrQ3NDLE9BQU9DLElBQUksQ0FBQ0o7WUFFMUQsa0VBQWtFO1lBQ2xFLE1BQU1LLGNBQStCO2dCQUNuQ0MsYUFBYU4sZ0JBQWdCTSxXQUFXO2dCQUN4Q2xDO2dCQUNBZDtnQkFDQUM7Z0JBQ0FnRCxVQUFVUDtnQkFDVnJELFVBQVVBLGlEQUFRQSxJQUFJNkQsVUFBVSwyQ0FBMkM7WUFDN0U7WUFFQTVDLFFBQVFDLEdBQUcsQ0FBQywrQ0FBcUM7Z0JBQy9DTyxZQUFZaUMsWUFBWWpDLFVBQVU7Z0JBQ2xDZCxjQUFjK0MsWUFBWS9DLFlBQVk7Z0JBQ3RDQyxnQkFBZ0I4QyxZQUFZOUMsY0FBYztnQkFDMUNrRCxlQUFlTixPQUFPQyxJQUFJLENBQUNDLFlBQVlFLFFBQVEsRUFBRXpDLE1BQU07Z0JBQ3ZENEMsYUFBYUwsWUFBWUUsUUFBUSxDQUFDSSxNQUFNLEVBQUU3QyxVQUFVO2dCQUNwRDhDLGlCQUFpQlAsWUFBWUUsUUFBUSxDQUFDTSxVQUFVLEVBQUUvQyxVQUFVO2dCQUM1RDBCLGFBQWEsQ0FBQyxDQUFDN0MsaURBQVFBO2dCQUN2Qm1FLGlCQUFpQixDQUFDLENBQUNuRSxpREFBUUEsRUFBRW9FO2dCQUM3QkMsY0FBY3JFLGlEQUFRQSxHQUFHd0QsT0FBT0MsSUFBSSxDQUFDekQsaURBQVFBLElBQUksRUFBRTtnQkFDbkRzRSxtQkFBbUJ0RSxpREFBUUEsRUFBRW9FLGNBQWNqRCxVQUFVO1lBQ3ZEO1lBRUFGLFFBQVFDLEdBQUcsQ0FBQyx3Q0FBOEJxRCxLQUFLQyxTQUFTLENBQUN4RSxpREFBUUEsRUFBRSxNQUFNO1lBRXpFaUIsUUFBUUMsR0FBRyxDQUFDO1lBQ1osT0FBT3dDO1FBQ1QsRUFBRSxPQUFPcEMsT0FBTztZQUNkLDZCQUE2QjtZQUM3Qm5CLHdEQUFZQSxDQUFDc0UsUUFBUSxDQUFDbkQsT0FBZ0IsNEJBQTRCVTtZQUVsRWYsUUFBUUssS0FBSyxDQUFDLG9DQUFvQ0E7WUFDbEQsTUFBTUE7UUFDUjtJQUNGO0lBRUEsdURBQXVEO0lBQ3ZELE1BQWNnQyx3QkFDWjVDLFVBQWtCLEVBQ2xCZSxVQUFrQixFQUNsQmQsWUFBb0IsRUFDcEJDLGNBQXNCLEVBQ3RCWixRQUFjLEVBQ2QrQixVQUE2QixFQUM3QjtRQUNBZCxRQUFRQyxHQUFHLENBQUM7UUFFWixNQUFNd0QsaUJBQWlCLElBQUksQ0FBQ25FLHVCQUF1QjtRQUVuRCxvQ0FBb0M7UUFDcEMsSUFBSXdCLFlBQVk7WUFDZDJDLGVBQWVDLG1CQUFtQixDQUFDNUMsWUFBWU47UUFDakQ7UUFFQSxnREFBZ0Q7UUFDaERSLFFBQVFDLEdBQUcsQ0FBQztRQUNaLE1BQU0wRCxnQkFBZ0IsTUFBTUYsZUFBZUcsa0JBQWtCLENBQzNEbkUsWUFDQWUsWUFDQWQsY0FDQUMsZ0JBQ0FaLFNBQVMsbUNBQW1DOztRQUc5QyxtREFBbUQ7UUFDbkQsTUFBTThFLGlCQUFrQztZQUN0QztnQkFBRUMsTUFBTTtnQkFBVUMsVUFBVTtnQkFBR0MsY0FBYyxFQUFFO1lBQUM7WUFDaEQ7Z0JBQUVGLE1BQU07Z0JBQWNDLFVBQVU7Z0JBQUdDLGNBQWMsRUFBRTtZQUFDO1lBQ3BEO2dCQUFFRixNQUFNO2dCQUFXQyxVQUFVO2dCQUFHQyxjQUFjO29CQUFDO2lCQUFhO1lBQUM7WUFDN0Q7Z0JBQUVGLE1BQU07Z0JBQWlCQyxVQUFVO2dCQUFHQyxjQUFjO29CQUFDO2lCQUFVO1lBQUM7WUFDaEU7Z0JBQUVGLE1BQU07Z0JBQWNDLFVBQVU7Z0JBQUdDLGNBQWM7b0JBQUM7b0JBQVc7aUJBQWdCO1lBQUM7WUFDOUU7Z0JBQUVGLE1BQU07Z0JBQVdDLFVBQVU7Z0JBQUdDLGNBQWM7b0JBQUM7aUJBQVU7WUFBQztZQUMxRDtnQkFBRUYsTUFBTTtnQkFBaUJDLFVBQVU7Z0JBQUdDLGNBQWM7b0JBQUM7aUJBQWE7WUFBQztZQUNuRTtnQkFBRUYsTUFBTTtnQkFBVUMsVUFBVTtnQkFBR0MsY0FBYztvQkFBQztpQkFBYTtZQUFDO1NBQzdEO1FBRUQsMENBQTBDO1FBQzFDLE1BQU1DLG9CQUFvQixFQUFFO1FBQzVCLElBQUlDLGlCQUFpQlA7UUFFckIsS0FBSyxNQUFNUSxXQUFXTixlQUFnQjtZQUNwQzdELFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHVCQUF1QixFQUFFa0UsUUFBUUwsSUFBSSxDQUFDLENBQUM7WUFFcEQsTUFBTU0sbUJBQW1CLE1BQU1YLGVBQWVZLGVBQWUsQ0FDM0RGLFNBQ0FELGdCQUNBRDtZQUdGQSxrQkFBa0JLLElBQUksQ0FBQ0Y7WUFFdkIsOENBQThDO1lBQzlDRixpQkFBaUJULGVBQWVjLGFBQWEsQ0FBQ0wsZ0JBQWdCRTtRQUNoRTtRQUVBLDJFQUEyRTtRQUMzRXBFLFFBQVFDLEdBQUcsQ0FBQztRQUNaLE1BQU11RSxtQkFBbUIsTUFBTWYsZUFBZWdCLG1DQUFtQyxDQUMvRWQsZUFDQU07UUFFRixNQUFNUyxrQkFBa0IsTUFBTWpCLGVBQWVrQixrQ0FBa0MsQ0FDN0VoQixlQUNBTTtRQUdGLDBDQUEwQztRQUMxQyxNQUFNN0Isa0JBQXVCLENBQUM7UUFFOUIsS0FBSyxNQUFNK0IsV0FBV0Ysa0JBQW1CO1lBQ3ZDN0IsZUFBZSxDQUFDK0IsUUFBUVMsV0FBVyxDQUFDLEdBQUdULFFBQVFVLE9BQU87UUFDeEQ7UUFFQXpDLGdCQUFnQm9DLGdCQUFnQixHQUFHQTtRQUNuQ3BDLGdCQUFnQnNDLGVBQWUsR0FBR0E7UUFFbEMsMkNBQTJDO1FBQzNDdEMsZ0JBQWdCTSxXQUFXLEdBQUdpQixjQUFjakIsV0FBVztRQUV2RDFDLFFBQVFDLEdBQUcsQ0FBQztRQUNaLE9BQU9tQztJQUNUO0lBRUEsa0NBQWtDO0lBQ2xDLE1BQWMwQyxzQkFBc0JyRixVQUFrQixFQUFFQyxZQUFvQixFQUFxQjtRQUMvRixrREFBa0Q7UUFDbEQsTUFBTXFGLFNBQVMsSUFBSSxDQUFDQyxtQkFBbUIsQ0FBQ3ZGO1FBQ3hDLE1BQU13RixZQUFZRixNQUFNLENBQUMsRUFBRSxJQUFJO1FBRS9CLGdFQUFnRTtRQUNoRSxNQUFNakYsU0FBUyxDQUFDLFFBQVEsRUFBRUosYUFBYSx5QkFBeUIsRUFBRXVGLFVBQVUsOElBQThJLENBQUM7UUFFM04sSUFBSTtZQUNGakYsUUFBUUMsR0FBRyxDQUFDLHVDQUE2QkgsT0FBT0ksTUFBTSxFQUFFO1lBQ3hERixRQUFRQyxHQUFHLENBQUMsa0NBQXdCZ0Y7WUFDcEMsTUFBTTlFLFdBQVcsTUFBTSxJQUFJLENBQUNmLFdBQVcsR0FBR1UsTUFBTSxDQUFDQTtZQUVqRCxrREFBa0Q7WUFDbEQsTUFBTW9GLFlBQVkvRSxTQUFTZ0YsS0FBSyxDQUFDLE1BQzlCQyxHQUFHLENBQUNDLENBQUFBLE9BQVFBLEtBQUtqRixJQUFJLElBQ3JCa0YsTUFBTSxDQUFDRCxDQUFBQTtnQkFDTiwwREFBMEQ7Z0JBQzFELE9BQU9BLEtBQUtFLFFBQVEsQ0FBQyxRQUNuQkYsS0FBS25GLE1BQU0sR0FBRyxNQUNkLENBQUNtRixLQUFLRyxXQUFXLEdBQUdDLFFBQVEsQ0FBQyxlQUM3QixDQUFDSixLQUFLRyxXQUFXLEdBQUdDLFFBQVEsQ0FBQyxlQUM3QixDQUFDSixLQUFLRyxXQUFXLEdBQUdDLFFBQVEsQ0FBQyx3QkFDN0IsQ0FBQ0osS0FBS0csV0FBVyxHQUFHQyxRQUFRLENBQUMsZUFDN0IsQ0FBQ0osS0FBS0csV0FBVyxHQUFHQyxRQUFRLENBQUMsa0JBQzdCLENBQUNKLEtBQUtHLFdBQVcsR0FBR0MsUUFBUSxDQUFDLG1CQUM3QixDQUFDSixLQUFLRyxXQUFXLEdBQUdDLFFBQVEsQ0FBQztZQUNqQyxHQUNDTCxHQUFHLENBQUNDLENBQUFBLE9BQVFBLEtBQUtLLE9BQU8sQ0FBQyxjQUFjLElBQUlBLE9BQU8sQ0FBQyxTQUFTLElBQUl0RixJQUFJLElBQ3BFdUYsS0FBSyxDQUFDLEdBQUc7WUFFWjNGLFFBQVFDLEdBQUcsQ0FBQyw0Q0FBa0NpRjtZQUU5QyxJQUFJQSxVQUFVaEYsTUFBTSxHQUFHLEdBQUc7Z0JBQ3hCLE1BQU0sSUFBSXdCLE1BQU07WUFDbEI7WUFDQSxPQUFPd0Q7UUFDVCxFQUFFLE9BQU83RSxPQUFPO1lBQ2RMLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE1BQU0sSUFBSXlCLE1BQU0sMENBQTBDckIsTUFBTXVGLE9BQU87UUFDekU7SUFDRjtJQUVBLHFDQUFxQztJQUM3QkMsc0JBQXNCWCxTQUFtQixFQUFFeEYsWUFBb0IsRUFBWTtRQUNqRixNQUFNb0csY0FBYztRQUNwQixPQUFPO1lBQUNBO2VBQWdCWjtTQUFVO0lBQ3BDO0lBRVFhLDZCQUE2QmIsU0FBbUIsRUFBRXhGLFlBQW9CLEVBQVk7UUFDeEYsTUFBTW9HLGNBQWM7UUFDcEIsT0FBTztZQUFDQTtlQUFnQlo7U0FBVTtJQUNwQztJQUVRYywwQkFBMEJkLFNBQW1CLEVBQUV4RixZQUFvQixFQUFZO1FBQ3JGLE1BQU1vRyxjQUFjO1FBQ3BCLE9BQU87WUFBQ0E7ZUFBZ0JaO1NBQVU7SUFDcEM7SUFFUWUsc0JBQXNCZixTQUFtQixFQUFFeEYsWUFBb0IsRUFBWTtRQUNqRixNQUFNb0csY0FBYztRQUNwQixPQUFPO1lBQUNBO2VBQWdCWjtTQUFVO0lBQ3BDO0lBRVFnQiwwQkFBMEJqRCxVQUFxRSxFQUFFdkQsWUFBb0IsRUFBNkQ7UUFDeEwsTUFBTW9HLGNBQWM7WUFDbEJLLE1BQU07WUFDTkMsU0FBUztZQUNUQyxTQUFTO1FBQ1g7UUFDQSxPQUFPO1lBQUNQO2VBQWdCN0M7U0FBVztJQUNyQztJQUVRcUQsdUJBQXVCQyxXQUFtQixFQUFFN0csWUFBb0IsRUFBVTtRQUNoRixNQUFNb0csY0FBYztRQUNwQixPQUFPLENBQUMsRUFBRUEsWUFBWSxJQUFJLEVBQUVTLFlBQVksQ0FBQztJQUMzQztJQUVBLHlEQUF5RDtJQUNqRHZCLG9CQUFvQndCLElBQVksRUFBWTtRQUNsRCxNQUFNekIsU0FBUyxFQUFFO1FBRWpCLHNFQUFzRTtRQUN0RSxNQUFNMEIsbUJBQW1CO1lBQ3ZCO1lBQ0E7WUFDQSxpQ0FBaUMsZ0NBQWdDO1NBQ2xFO1FBRUQsS0FBSyxNQUFNQyxXQUFXRCxpQkFBa0I7WUFDdEMsTUFBTUUsVUFBVUgsS0FBS0ksS0FBSyxDQUFDRjtZQUMzQixJQUFJQyxTQUFTO2dCQUNYNUIsT0FBT1QsSUFBSSxJQUFJcUMsUUFBUXZCLEdBQUcsQ0FBQ3lCLENBQUFBLElBQUtBLEVBQUVyQixXQUFXO1lBQy9DO1FBQ0Y7UUFFQSx3REFBd0Q7UUFDeEQsSUFBSVQsT0FBTzdFLE1BQU0sS0FBSyxHQUFHO1lBQ3ZCLE1BQU00RyxRQUFRTixLQUFLaEIsV0FBVyxHQUFHb0IsS0FBSyxDQUFDLHFCQUFxQixFQUFFO1lBQzlELE1BQU1HLGNBQWM7Z0JBQUM7Z0JBQVU7Z0JBQVE7Z0JBQVE7Z0JBQWM7Z0JBQVU7YUFBYztZQUNyRixNQUFNQyxhQUFhRixNQUFNeEIsTUFBTSxDQUFDYSxDQUFBQSxPQUFRWSxZQUFZdEIsUUFBUSxDQUFDVTtZQUM3RHBCLE9BQU9ULElBQUksSUFBSTBDLFdBQVdyQixLQUFLLENBQUMsR0FBRztRQUNyQztRQUVBLE9BQU9aLE9BQU83RSxNQUFNLEdBQUcsSUFBSTZFLFNBQVM7WUFBQztTQUFTO0lBQ2hEO0lBRUEsdUVBQXVFO0lBQ3ZFLE1BQWNrQywwQkFBMEJ4SCxVQUFrQixFQUFFQyxZQUFvQixFQUFzRTtRQUNwSixpRUFBaUU7UUFDakUsTUFBTXdILGtCQUFrQixJQUFJLENBQUNDLDJCQUEyQixDQUFDMUgsWUFBWUM7UUFDckVNLFFBQVFDLEdBQUcsQ0FBQyxpREFBdUNpSDtRQUVuRCxNQUFNakUsYUFBYSxFQUFFO1FBRXJCLEtBQUssTUFBTWtELFFBQVFlLGdCQUFpQjtZQUNsQyxJQUFJO2dCQUNGLE1BQU1FLGtCQUFrQixJQUFJLENBQUNDLGNBQWMsQ0FBQ2xCO2dCQUU1Qyx5QkFBeUI7Z0JBQ3pCLE1BQU1tQixtQkFBbUIsQ0FBQyxRQUFRLEVBQUVuQixLQUFLLGFBQWEsRUFBRXpHLGFBQWEsaUJBQWlCLEVBQUVELFdBQVdNLFNBQVMsQ0FBQyxHQUFHLElBQUksMENBQTBDLENBQUM7Z0JBQy9KQyxRQUFRQyxHQUFHLENBQUMseUNBQStCcUgsaUJBQWlCcEgsTUFBTSxFQUFFO2dCQUNwRSxNQUFNcUgsYUFBYSxNQUFNLElBQUksQ0FBQ25JLFdBQVcsR0FBR1UsTUFBTSxDQUFDd0g7Z0JBQ25ELE1BQU1sQixVQUFVLElBQUksQ0FBQ29CLGVBQWUsQ0FBQ0QsWUFBWTdIO2dCQUVqRCxrQ0FBa0M7Z0JBQ2xDLE1BQU0rSCxXQUFXLE1BQU0sSUFBSSxDQUFDQywwQkFBMEIsQ0FBQ3ZCLE1BQU16RyxjQUFjRDtnQkFFM0V3RCxXQUFXcUIsSUFBSSxDQUFDO29CQUNkNkIsTUFBTWlCO29CQUNOaEIsU0FBU0EsUUFBUWhHLElBQUksR0FBR0wsU0FBUyxDQUFDLEdBQUc7b0JBQ3JDc0csU0FBU29CO2dCQUNYO1lBQ0YsRUFBRSxPQUFPcEgsT0FBTztnQkFDZEwsUUFBUUMsR0FBRyxDQUFDLENBQUMsb0JBQW9CLEVBQUVrRyxLQUFLLHlCQUF5QixDQUFDO2dCQUNsRSxNQUFNaUIsa0JBQWtCLElBQUksQ0FBQ0MsY0FBYyxDQUFDbEI7Z0JBQzVDbEQsV0FBV3FCLElBQUksQ0FBQztvQkFDZDZCLE1BQU1pQjtvQkFDTmhCLFNBQVMsSUFBSSxDQUFDdUIsNkJBQTZCLENBQUN4QixNQUFNekcsY0FBY0Q7b0JBQ2hFNEcsU0FBUyxNQUFNLElBQUksQ0FBQ3FCLDBCQUEwQixDQUFDdkIsTUFBTXpHLGNBQWNEO2dCQUNyRTtZQUNGO1FBQ0Y7UUFFQSw0QkFBNEI7UUFDNUIsT0FBT3dELFdBQVcwQyxLQUFLLENBQUMsR0FBRyxJQUFJekYsTUFBTSxJQUFJLElBQUkrQyxXQUFXMEMsS0FBSyxDQUFDLEdBQUcsTUFBTTFDLFdBQVcwQyxLQUFLLENBQUMsR0FBRztJQUM3RjtJQUVBLHlDQUF5QztJQUN6QyxNQUFjaUMsNkJBQTZCbkksVUFBa0IsRUFBRUMsWUFBb0IsRUFBcUI7UUFDdEcsTUFBTW1JLFlBQVlwSSxXQUFXTSxTQUFTLENBQUMsR0FBRyxLQUFLLHNDQUFzQzs7UUFDckYsTUFBTUQsU0FBUyxDQUFDLFFBQVEsRUFBRUosYUFBYSwwRkFBMEYsRUFBRW1JLFVBQVUsQ0FBQztRQUU5SSxJQUFJO1lBQ0Y3SCxRQUFRQyxHQUFHLENBQUMsbUNBQW1DSCxPQUFPSSxNQUFNLEVBQUU7WUFDOUQsTUFBTUMsV0FBVyxNQUFNLElBQUksQ0FBQ2YsV0FBVyxHQUFHVSxNQUFNLENBQUNBO1lBRWpELE1BQU1vRixZQUFZL0UsU0FBU2dGLEtBQUssQ0FBQyxNQUM5QkMsR0FBRyxDQUFDQyxDQUFBQSxPQUFRQSxLQUFLakYsSUFBSSxJQUNyQmtGLE1BQU0sQ0FBQ0QsQ0FBQUE7Z0JBQ04sNENBQTRDO2dCQUM1QyxPQUFPQSxLQUFLRSxRQUFRLENBQUMsUUFDbkJGLEtBQUtuRixNQUFNLEdBQUcsTUFDZCxDQUFDbUYsS0FBS0csV0FBVyxHQUFHQyxRQUFRLENBQUMsZUFDN0IsQ0FBQ0osS0FBS0csV0FBVyxHQUFHQyxRQUFRLENBQUM7WUFDakMsR0FDQ0wsR0FBRyxDQUFDQyxDQUFBQSxPQUFRQSxLQUFLSyxPQUFPLENBQUMsY0FBYyxJQUFJQSxPQUFPLENBQUMsU0FBUyxJQUFJQSxPQUFPLENBQUMsU0FBUyxJQUFJdEYsSUFBSSxJQUN6RnVGLEtBQUssQ0FBQyxHQUFHO1lBRVosSUFBSVQsVUFBVWhGLE1BQU0sR0FBRyxHQUFHO2dCQUN4QixNQUFNLElBQUl3QixNQUFNO1lBQ2xCO1lBQ0EsT0FBT3dEO1FBQ1QsRUFBRSxPQUFPN0UsT0FBTztZQUNkTCxRQUFRQyxHQUFHLENBQUM7WUFDWixNQUFNLElBQUl5QixNQUFNLGlEQUFpRHJCLE1BQU11RixPQUFPO1FBQ2hGO0lBQ0Y7SUFFQSw2Q0FBNkM7SUFDN0MsTUFBY2tDLHVCQUF1QnJJLFVBQWtCLEVBQUVDLFlBQW9CLEVBQW1CO1FBQzlGLE1BQU1JLFNBQVMsQ0FBQyxzQkFBc0IsRUFBRUosYUFBYSx3Q0FBd0MsRUFBRUQsV0FBV00sU0FBUyxDQUFDLEdBQUcsS0FBSyxDQUFDO1FBRTdILElBQUk7WUFDRixNQUFNSSxXQUFXLE1BQU0sSUFBSSxDQUFDZixXQUFXLEdBQUdVLE1BQU0sQ0FBQ0E7WUFDakQsT0FBT0ssU0FBU0MsSUFBSTtRQUN0QixFQUFFLE9BQU9DLE9BQU87WUFDZCxNQUFNLElBQUlxQixNQUFNLHlDQUF5Q3JCLE1BQU11RixPQUFPO1FBQ3hFO0lBQ0Y7SUFFQSxrREFBa0Q7SUFDbEQsTUFBY21DLDBCQUEwQnRJLFVBQWtCLEVBQUVDLFlBQW9CLEVBQXFCO1FBQ25HLE1BQU1JLFNBQVMsQ0FBQyxRQUFRLEVBQUVKLGFBQWEsOERBQThELEVBQUVELFdBQVdNLFNBQVMsQ0FBQyxHQUFHLEtBQUssQ0FBQztRQUVySSxJQUFJO1lBQ0YsTUFBTUksV0FBVyxNQUFNLElBQUksQ0FBQ2YsV0FBVyxHQUFHVSxNQUFNLENBQUNBO1lBQ2pELE1BQU1vRixZQUFZL0UsU0FBU2dGLEtBQUssQ0FBQyxNQUM5QkMsR0FBRyxDQUFDQyxDQUFBQSxPQUFRQSxLQUFLakYsSUFBSSxJQUNyQmtGLE1BQU0sQ0FBQ0QsQ0FBQUEsT0FBUUEsS0FBS0UsUUFBUSxDQUFDLFFBQVFGLEtBQUtuRixNQUFNLEdBQUcsSUFDbkRrRixHQUFHLENBQUNDLENBQUFBLE9BQVFBLEtBQUtLLE9BQU8sQ0FBQyxjQUFjLElBQUl0RixJQUFJLElBQy9DdUYsS0FBSyxDQUFDLEdBQUc7WUFFWixJQUFJVCxVQUFVaEYsTUFBTSxHQUFHLEdBQUc7Z0JBQ3hCLE1BQU0sSUFBSXdCLE1BQU07WUFDbEI7WUFDQSxPQUFPd0Q7UUFDVCxFQUFFLE9BQU83RSxPQUFPO1lBQ2QsTUFBTSxJQUFJcUIsTUFBTSw4Q0FBOENyQixNQUFNdUYsT0FBTztRQUM3RTtJQUNGO0lBRUEsNkNBQTZDO0lBQzdDLE1BQWNvQyx1QkFBdUJ2SSxVQUFrQixFQUFFQyxZQUFvQixFQUFnQjtRQUMzRixNQUFNSSxTQUFTLENBQUMsNEJBQTRCLEVBQUVKLGFBQWEsdUVBQXVFLEVBQUVELFdBQVdNLFNBQVMsQ0FBQyxHQUFHLEtBQUssQ0FBQztRQUVsSyxJQUFJO1lBQ0YsTUFBTUksV0FBVyxNQUFNLElBQUksQ0FBQ2YsV0FBVyxHQUFHVSxNQUFNLENBQUNBO1lBQ2pELE9BQU93RCxLQUFLMkUsS0FBSyxDQUFDOUg7UUFDcEIsRUFBRSxPQUFPRSxPQUFPO1lBQ2QsTUFBTSxJQUFJcUIsTUFBTSx5Q0FBeUNyQixNQUFNdUYsT0FBTztRQUN4RTtJQUNGO0lBRUEsbURBQW1EO0lBQ25ELE1BQWNzQyw2QkFBNkJDLGVBQXlCLEVBQUV6SSxZQUFvQixFQUFnQjtRQUN4RyxNQUFNeUcsT0FBT2dDLGVBQWUsQ0FBQyxFQUFFLElBQUk7UUFDbkMsTUFBTXJJLFNBQVMsQ0FBQyxtQ0FBbUMsRUFBRXFHLEtBQUssd0NBQXdDLENBQUM7UUFFbkcsSUFBSTtZQUNGLE1BQU1oRyxXQUFXLE1BQU0sSUFBSSxDQUFDZixXQUFXLEdBQUdVLE1BQU0sQ0FBQ0E7WUFDakQsT0FBT3dELEtBQUsyRSxLQUFLLENBQUM5SDtRQUNwQixFQUFFLE9BQU9FLE9BQU87WUFDZCxNQUFNLElBQUlxQixNQUFNLCtDQUErQ3JCLE1BQU11RixPQUFPO1FBQzlFO0lBQ0Y7SUFFQSw4Q0FBOEM7SUFDOUMsTUFBY3dDLHNCQUFzQjNJLFVBQWtCLEVBQUVDLFlBQW9CLEVBQXFCO1FBQy9GLE1BQU1JLFNBQVMsQ0FBQyxRQUFRLEVBQUVKLGFBQWEsNkRBQTZELEVBQUVELFdBQVdNLFNBQVMsQ0FBQyxHQUFHLEtBQUssQ0FBQztRQUVwSSxJQUFJO1lBQ0YsTUFBTUksV0FBVyxNQUFNLElBQUksQ0FBQ2YsV0FBVyxHQUFHVSxNQUFNLENBQUNBO1lBQ2pELE1BQU1vRixZQUFZL0UsU0FBU2dGLEtBQUssQ0FBQyxNQUM5QkMsR0FBRyxDQUFDQyxDQUFBQSxPQUFRQSxLQUFLakYsSUFBSSxJQUNyQmtGLE1BQU0sQ0FBQ0QsQ0FBQUEsT0FBUUEsS0FBS0UsUUFBUSxDQUFDLFFBQVFGLEtBQUtuRixNQUFNLEdBQUcsSUFDbkRrRixHQUFHLENBQUNDLENBQUFBLE9BQVFBLEtBQUtLLE9BQU8sQ0FBQyxjQUFjLElBQUl0RixJQUFJLElBQy9DdUYsS0FBSyxDQUFDLEdBQUc7WUFFWixJQUFJVCxVQUFVaEYsTUFBTSxHQUFHLEdBQUc7Z0JBQ3hCLE1BQU0sSUFBSXdCLE1BQU07WUFDbEI7WUFDQSxPQUFPd0Q7UUFDVCxFQUFFLE9BQU83RSxPQUFPO1lBQ2QsTUFBTSxJQUFJcUIsTUFBTSwwQ0FBMENyQixNQUFNdUYsT0FBTztRQUN6RTtJQUNGO0lBSUEsb0NBQW9DO0lBQzVCeUMsMEJBQ041SSxVQUFrQixFQUNsQlYsUUFBYyxFQUNkNEIsaUJBQXVCLEVBQ3ZCakIsWUFBcUIsRUFDckI7UUFDQU0sUUFBUUMsR0FBRyxDQUFDO1FBRVosTUFBTXFJLFdBQVc7WUFDZkMsYUFBYXhKLFVBQVV3SixlQUFlO1lBQ3RDQyxRQUFRekosVUFBVXlKLFVBQVU7WUFDNUJDLFlBQVk7WUFDWjFELFFBQVEsRUFBRTtZQUNWMkQsZUFBZSxFQUFFO1lBQ2pCQyxpQkFBaUI7WUFDakJDLG9CQUFvQixFQUFFO1lBQ3RCQyxZQUFZbkosZ0JBQWdCO1lBQzVCb0osT0FBTy9KLFVBQVUrSixTQUFTO1lBQzFCQyxlQUFlLElBQUksQ0FBQ0Msc0JBQXNCLENBQUNqSyxVQUFVeUosVUFBVTtRQUNqRTtRQUVBLDZCQUE2QjtRQUM3QixNQUFNUyxZQUFZeEosV0FBVzBGLEtBQUssQ0FBQyxVQUFVRyxNQUFNLENBQUM0RCxDQUFBQSxJQUFLQSxFQUFFOUksSUFBSSxHQUFHRixNQUFNLEdBQUc7UUFDM0UsTUFBTWlKLG9CQUFvQkYsVUFBVS9JLE1BQU0sR0FBRyxJQUFJK0ksVUFBVUcsTUFBTSxDQUFDLENBQUNDLEtBQUtILElBQU1HLE1BQU1ILEVBQUUvRCxLQUFLLENBQUMsS0FBS2pGLE1BQU0sRUFBRSxLQUFLK0ksVUFBVS9JLE1BQU0sR0FBRztRQUNqSSxNQUFNb0osZUFBZTdKLFdBQVdtSCxLQUFLLENBQUMsZ0JBQWdCMUcsVUFBVTtRQUNoRSxNQUFNcUosYUFBYTlKLFdBQVcwRixLQUFLLENBQUMsT0FBT2pGLE1BQU07UUFFakQsSUFBSWlKLG9CQUFvQixNQUFNRyxlQUFlQyxhQUFhLE1BQU07WUFDOURqQixTQUFTRyxVQUFVLEdBQUc7UUFDeEIsT0FBTyxJQUFJVSxvQkFBb0IsTUFBTUcsZUFBZUMsYUFBYSxNQUFNO1lBQ3JFakIsU0FBU0csVUFBVSxHQUFHO1FBQ3hCO1FBRUEscUNBQXFDO1FBQ3JDSCxTQUFTdkQsTUFBTSxHQUFHLElBQUksQ0FBQ3lFLHFCQUFxQixDQUFDL0osWUFBWWtCLG1CQUFtQjhJLFlBQVksRUFBRTtRQUUxRix5Q0FBeUM7UUFDekNuQixTQUFTSSxhQUFhLEdBQUcsSUFBSSxDQUFDZ0IseUJBQXlCLENBQUNqSyxZQUFZQztRQUVwRSw2QkFBNkI7UUFDN0IsSUFBSVgsVUFBVXlKLFFBQVE7WUFDcEJGLFNBQVNLLGVBQWUsR0FBRyxJQUFJLENBQUNnQix3QkFBd0IsQ0FBQzVLLFNBQVN5SixNQUFNLEVBQUUvSTtRQUM1RTtRQUVBLCtCQUErQjtRQUMvQjZJLFNBQVNNLGtCQUFrQixHQUFHLElBQUksQ0FBQ2dCLDBCQUEwQixDQUMzRHRCLFNBQVNDLFdBQVcsRUFDcEJELFNBQVN2RCxNQUFNLEVBQ2ZyRjtRQUdGLE9BQU80STtJQUNUO0lBRUEscURBQXFEO0lBQ3JELE1BQWN1QixzQkFDWnBLLFVBQWtCLEVBQ2xCVixRQUFjLEVBQ2Q0QixpQkFBdUIsRUFDdkJqQixZQUFxQixFQUNyQjtRQUNBTSxRQUFRQyxHQUFHLENBQUM7UUFFWixNQUFNcUksV0FBVztZQUNmQyxhQUFheEosVUFBVXdKLGVBQWU7WUFDdENDLFFBQVF6SixVQUFVeUosVUFBVTtZQUM1QkMsWUFBWTtZQUNaMUQsUUFBUSxFQUFFO1lBQ1YyRCxlQUFlLEVBQUU7WUFDakJDLGlCQUFpQjtZQUNqQkMsb0JBQW9CLEVBQUU7WUFDdEJDLFlBQVluSixnQkFBZ0I7WUFDNUJvSixPQUFPL0osVUFBVStKLFNBQVM7WUFDMUJDLGVBQWUsSUFBSSxDQUFDQyxzQkFBc0IsQ0FBQ2pLLFVBQVV5SixVQUFVO1FBQ2pFO1FBRUEsMkRBQTJEO1FBQzNELE1BQU1TLFlBQVl4SixXQUFXMEYsS0FBSyxDQUFDLFVBQVVHLE1BQU0sQ0FBQzRELENBQUFBLElBQUtBLEVBQUU5SSxJQUFJLEdBQUdGLE1BQU0sR0FBRztRQUMzRSxNQUFNaUosb0JBQW9CRixVQUFVL0ksTUFBTSxHQUFHLElBQUkrSSxVQUFVRyxNQUFNLENBQUMsQ0FBQ0MsS0FBS0gsSUFBTUcsTUFBTUgsRUFBRS9ELEtBQUssQ0FBQyxLQUFLakYsTUFBTSxFQUFFLEtBQUsrSSxVQUFVL0ksTUFBTSxHQUFHO1FBQ2pJLE1BQU1vSixlQUFlN0osV0FBV21ILEtBQUssQ0FBQyxnQkFBZ0IxRyxVQUFVO1FBQ2hFLE1BQU1xSixhQUFhOUosV0FBVzBGLEtBQUssQ0FBQyxPQUFPakYsTUFBTTtRQUVqRCxJQUFJaUosb0JBQW9CLE1BQU1HLGVBQWVDLGFBQWEsTUFBTTtZQUM5RGpCLFNBQVNHLFVBQVUsR0FBRztRQUN4QixPQUFPLElBQUlVLG9CQUFvQixNQUFNRyxlQUFlQyxhQUFhLE1BQU07WUFDckVqQixTQUFTRyxVQUFVLEdBQUc7UUFDeEI7UUFFQXpJLFFBQVFDLEdBQUcsQ0FBQywwQ0FBZ0M7WUFDMUNrSjtZQUNBRztZQUNBQztZQUNBZCxZQUFZSCxTQUFTRyxVQUFVO1FBQ2pDO1FBRUEsZ0ZBQWdGO1FBQ2hGekksUUFBUUMsR0FBRyxDQUFDO1FBQ1pxSSxTQUFTdkQsTUFBTSxHQUFHLElBQUksQ0FBQ3lFLHFCQUFxQixDQUFDL0osWUFBWWtCLG1CQUFtQjhJLFlBQVksRUFBRTtRQUMxRnpKLFFBQVFDLEdBQUcsQ0FBQyx1QkFBdUJxSSxTQUFTdkQsTUFBTTtRQUVsRCw2RUFBNkU7UUFDN0UvRSxRQUFRQyxHQUFHLENBQUM7UUFDWnFJLFNBQVNJLGFBQWEsR0FBRyxJQUFJLENBQUNnQix5QkFBeUIsQ0FBQ2pLLFlBQVlDO1FBQ3BFTSxRQUFRQyxHQUFHLENBQUMsMkJBQTJCcUksU0FBU0ksYUFBYTtRQUU3RCw2QkFBNkI7UUFDN0IsSUFBSTNKLFVBQVV5SixRQUFRO1lBQ3BCRixTQUFTSyxlQUFlLEdBQUcsSUFBSSxDQUFDZ0Isd0JBQXdCLENBQUM1SyxTQUFTeUosTUFBTSxFQUFFL0k7WUFDMUVPLFFBQVFDLEdBQUcsQ0FBQyxrQ0FBd0JxSSxTQUFTSyxlQUFlO1FBQzlEO1FBRUEscUVBQXFFO1FBQ3JFTCxTQUFTTSxrQkFBa0IsR0FBRyxJQUFJLENBQUNnQiwwQkFBMEIsQ0FDM0R0QixTQUFTQyxXQUFXLEVBQ3BCRCxTQUFTdkQsTUFBTSxFQUNmckY7UUFFRk0sUUFBUUMsR0FBRyxDQUFDLHFDQUEyQnFJLFNBQVNNLGtCQUFrQjtRQUVsRSxPQUFPTjtJQUNUO0lBRUEsdUNBQXVDO0lBQ3ZDLE1BQWN3Qix3QkFDWnJLLFVBQWtCLEVBQ2xCc0ssZUFBb0IsRUFDcEJ2SixVQUFrQixFQUNsQmQsWUFBb0IsRUFDcEI7UUFDQU0sUUFBUUMsR0FBRyxDQUFDO1FBRVosMENBQTBDO1FBQzFDLE1BQU0rSixnQkFBZ0IsQ0FBQyx5Q0FBeUMsRUFBRXRLLGFBQWE7O0FBRW5GLEVBQUVELFdBQVdNLFNBQVMsQ0FBQyxHQUFHLEtBQUs7O1FBRXZCLENBQUM7UUFFTCxJQUFJO1lBQ0ZDLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE1BQU1nSyxVQUFVLE1BQU0sSUFBSSxDQUFDN0ssV0FBVyxHQUFHVSxNQUFNLENBQUNrSyxlQUFlO2dCQUM3REUsYUFBYTtnQkFDYkMsV0FBVztZQUNiO1lBQ0FuSyxRQUFRQyxHQUFHLENBQUMsb0NBQW9DZ0ssUUFBUWxLLFNBQVMsQ0FBQyxHQUFHLE9BQU87WUFDNUUsT0FBT2tLO1FBQ1QsRUFBRSxPQUFPNUosT0FBTztZQUNkTCxRQUFRb0ssSUFBSSxDQUFDLDJEQUEyRC9KLE1BQU11RixPQUFPO1lBQ3JGLDhDQUE4QztZQUM5QyxNQUFNeUUsWUFBWTVLLFdBQVdNLFNBQVMsQ0FBQyxHQUFHLE9BQU87WUFDakRDLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE9BQU9vSztRQUNUO0lBQ0Y7SUFFQSwwQ0FBMEM7SUFDMUMsTUFBY0Msa0NBQ1p6RixPQUFlLEVBQ2ZrRixlQUFvQixFQUNwQnJLLFlBQW9CLEVBQ3BCWCxRQUFjLEVBQ2Q7UUFDQWlCLFFBQVFDLEdBQUcsQ0FBQztRQUVaLE1BQU1zSyxvQkFBb0I7WUFDeEIsTUFBTSxDQUFDOzs7Ozs7OzREQU8rQyxDQUFDO1lBRXZELE1BQU0sQ0FBQzs7Ozs7Ozt5REFPNEMsQ0FBQztZQUVwRCxNQUFNLENBQUM7Ozs7Ozs7Z0ZBT21FLENBQUM7WUFFM0UsTUFBTSxDQUFDOzs7Ozs7OzJFQU84RCxDQUFDO1lBRXRFLE1BQU0sQ0FBQzs7Ozs7OzsrRkFPa0YsQ0FBQztRQUM1RjtRQUVBLDRDQUE0QztRQUM1QyxNQUFNQyxRQUFRVCxnQkFBZ0JoRixNQUFNLENBQUMsRUFBRSxJQUFJO1FBQzNDLE1BQU0wRixlQUFlLENBQUMsU0FBUyxFQUFFL0ssYUFBYSwrQkFBK0IsRUFBRThLLE1BQU0sNEJBQTRCLENBQUM7UUFFbEgsSUFBSTtZQUNGeEssUUFBUUMsR0FBRyxDQUFDO1lBQ1pELFFBQVFDLEdBQUcsQ0FBQyxnQ0FBc0J3SyxhQUFhMUssU0FBUyxDQUFDLEdBQUcsT0FBTztZQUVuRSxNQUFNSSxXQUFXLE1BQU0sSUFBSSxDQUFDZixXQUFXLEdBQUdVLE1BQU0sQ0FBQzJLLGNBQWM7Z0JBQzdEUCxhQUFhO2dCQUNiQyxXQUFXO1lBQ2I7WUFFQW5LLFFBQVFDLEdBQUcsQ0FBQztZQUNaRCxRQUFRQyxHQUFHLENBQUMsaUNBQXVCRTtZQUVuQyxNQUFNK0UsWUFBWSxJQUFJLENBQUN3RixpQkFBaUIsQ0FBQ3ZLLFVBQVV3RixLQUFLLENBQUMsR0FBRztZQUM1RDNGLFFBQVFDLEdBQUcsQ0FBQywwQ0FBZ0NpRjtZQUM1Q2xGLFFBQVFDLEdBQUcsQ0FBQyx3Q0FBOEJpRixVQUFVaEYsTUFBTTtZQUUxRCxzREFBc0Q7WUFDdEQsTUFBT2dGLFVBQVVoRixNQUFNLEdBQUcsRUFBRztnQkFDM0IsTUFBTXlLLG1CQUFtQixJQUFJLENBQUNDLHlCQUF5QixDQUFDbEwsY0FBY3FLLGlCQUFpQjdFLFVBQVVoRixNQUFNO2dCQUN2R0YsUUFBUUMsR0FBRyxDQUFDLENBQUMsNEJBQTRCLEVBQUVpRixVQUFVaEYsTUFBTSxHQUFHLEVBQUUsQ0FBQyxDQUFDLEVBQUV5SztnQkFDcEV6RixVQUFVWixJQUFJLENBQUNxRztZQUNqQjtZQUVBM0ssUUFBUUMsR0FBRyxDQUFDLDhCQUE4QmlGO1lBRTFDLDBEQUEwRDtZQUMxRCxJQUFJQSxVQUFVaEYsTUFBTSxLQUFLLEdBQUc7Z0JBQzFCRixRQUFRb0ssSUFBSSxDQUFDO2dCQUNiLE9BQU87b0JBQ0w7b0JBQ0E7b0JBQ0E7aUJBQ0Q7WUFDSDtZQUVBLE9BQU9sRjtRQUNULEVBQUUsT0FBTzdFLE9BQU87WUFDZEwsUUFBUW9LLElBQUksQ0FBQyxnRUFBZ0UvSixNQUFNdUYsT0FBTztZQUMxRixNQUFNaUYsb0JBQW9CLElBQUksQ0FBQ0MsMkJBQTJCLENBQUNwTCxjQUFjcUssaUJBQWlCaEw7WUFDMUZpQixRQUFRQyxHQUFHLENBQUMsNENBQWtDNEs7WUFFOUMsa0NBQWtDO1lBQ2xDLElBQUksQ0FBQ0EscUJBQXFCQSxrQkFBa0IzSyxNQUFNLEtBQUssR0FBRztnQkFDeERGLFFBQVFvSyxJQUFJLENBQUM7Z0JBQ2IsT0FBTztvQkFDTDtvQkFDQTtvQkFDQTtpQkFDRDtZQUNIO1lBRUEsT0FBT1M7UUFDVDtJQUNGO0lBRUEsa0RBQWtEO0lBQ2xELE1BQWNFLGtDQUNabEcsT0FBZSxFQUNma0YsZUFBb0IsRUFDcEJ2SixVQUFrQixFQUNsQmQsWUFBb0IsRUFDcEJDLGNBQXNCLEVBQ3RCWixRQUFjLEVBQ2Q7UUFDQWlCLFFBQVFDLEdBQUcsQ0FBQztRQUVaLDhDQUE4QztRQUM5QyxNQUFNK0ssbUJBQW1CLE1BQU0sSUFBSSxDQUFDVixpQ0FBaUMsQ0FDbkV6RixTQUNBa0YsaUJBQ0FySyxjQUNBWDtRQUdGaUIsUUFBUUMsR0FBRyxDQUFDLHdEQUE4QytLO1FBRTFELGdEQUFnRDtRQUNoRCxNQUFNakcsU0FBU2dGLGdCQUFnQmhGLE1BQU0sQ0FBQ1ksS0FBSyxDQUFDLEdBQUcsR0FBR3NGLElBQUksQ0FBQyxTQUFTO1FBQ2hFLE1BQU1DLFFBQVFuQixnQkFBZ0JyQixhQUFhLENBQUMvQyxLQUFLLENBQUMsR0FBRyxHQUFHc0YsSUFBSSxDQUFDO1FBRTdELE1BQU1uTCxTQUFTLENBQUMsU0FBUyxFQUFFVSxXQUFXLFlBQVksRUFBRWQsYUFBYSxpQkFBaUIsRUFBRXFGLE9BQU87O1VBRXJGLEVBQUVGLFFBQVE5RSxTQUFTLENBQUMsR0FBRyxLQUFLO1dBQzNCLEVBQUVtTCxNQUFNOzs7OztZQUtQLEVBQUU1SCxLQUFLQyxTQUFTLENBQUN5SCxrQkFBa0I7Ozs7Ozs7O0NBUTlDLENBQUM7UUFFRSxJQUFJO1lBQ0ZoTCxRQUFRQyxHQUFHLENBQUM7WUFDWixNQUFNRSxXQUFXLE1BQU0sSUFBSSxDQUFDZixXQUFXLEdBQUdVLE1BQU0sQ0FBQ0EsUUFBUTtnQkFDdkRvSyxhQUFhO2dCQUNiQyxXQUFXO1lBQ2I7WUFFQW5LLFFBQVFDLEdBQUcsQ0FBQyw4Q0FBb0NFLFNBQVNKLFNBQVMsQ0FBQyxHQUFHLE9BQU87WUFFN0UsSUFBSTtnQkFDRixNQUFNb0wsU0FBUzdILEtBQUsyRSxLQUFLLENBQUM5SDtnQkFDMUJILFFBQVFDLEdBQUcsQ0FBQztnQkFFWix3REFBd0Q7Z0JBQ3hEa0wsT0FBT3BJLE1BQU0sR0FBR2lJO2dCQUNoQmhMLFFBQVFDLEdBQUcsQ0FBQztnQkFFWixPQUFPa0w7WUFDVCxFQUFFLE9BQU9DLFlBQVk7Z0JBQ25CcEwsUUFBUW9LLElBQUksQ0FBQztnQkFDYix3Q0FBd0M7Z0JBQ3hDLE1BQU1pQixZQUFZbEwsU0FBU3lHLEtBQUssQ0FBQztnQkFDakMsSUFBSXlFLFdBQVc7b0JBQ2IsSUFBSTt3QkFDRixNQUFNQyxVQUFVaEksS0FBSzJFLEtBQUssQ0FBQ29ELFNBQVMsQ0FBQyxFQUFFO3dCQUN2Q3JMLFFBQVFDLEdBQUcsQ0FBQzt3QkFFWix3REFBd0Q7d0JBQ3hEcUwsUUFBUXZJLE1BQU0sR0FBR2lJO3dCQUNqQmhMLFFBQVFDLEdBQUcsQ0FBQzt3QkFFWixPQUFPcUw7b0JBQ1QsRUFBRSxPQUFPQyxZQUFZO3dCQUNuQnZMLFFBQVFvSyxJQUFJLENBQUM7b0JBQ2Y7Z0JBQ0Y7Z0JBQ0EsOEVBQThFO2dCQUM5RSxNQUFNb0IsV0FBVyxJQUFJLENBQUNDLHdCQUF3QixDQUFDNUcsU0FBU3JFLFlBQVlkO2dCQUNwRThMLFNBQVN6SSxNQUFNLEdBQUdpSTtnQkFDbEJoTCxRQUFRQyxHQUFHLENBQUM7Z0JBQ1osT0FBT3VMO1lBQ1Q7UUFDRixFQUFFLE9BQU9uTCxPQUFPO1lBQ2RMLFFBQVFvSyxJQUFJLENBQUMsNkRBQTZEL0osTUFBTXVGLE9BQU87WUFDdkYsTUFBTTRGLFdBQVcsSUFBSSxDQUFDQyx3QkFBd0IsQ0FBQzVHLFNBQVNyRSxZQUFZZDtZQUNwRThMLFNBQVN6SSxNQUFNLEdBQUdpSTtZQUNsQmhMLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE9BQU91TDtRQUNUO0lBQ0Y7SUFFQSxvREFBb0Q7SUFDcEQsTUFBY0Usa0NBQ1pDLFNBQWMsRUFDZDlHLE9BQWUsRUFDZmtGLGVBQW9CLEVBQ3BCdkosVUFBa0IsRUFDbEJkLFlBQW9CLEVBQ3BCQyxjQUFzQixFQUN0QmdCLGlCQUF1QixFQUN2QjtRQUNBLDBFQUEwRTtRQUMxRSxNQUFNZ0MsV0FBVztZQUFFLEdBQUdnSixTQUFTO1FBQUM7UUFFaEMsc0RBQXNEO1FBQ3RELElBQUloSixTQUFTTSxVQUFVLEVBQUU7WUFDdkIsSUFBSyxJQUFJMkksSUFBSSxHQUFHQSxJQUFJakosU0FBU00sVUFBVSxDQUFDL0MsTUFBTSxFQUFFMEwsSUFBSztnQkFDbkQsTUFBTVYsUUFBUXZJLFNBQVNNLFVBQVUsQ0FBQzJJLEVBQUU7Z0JBQ3BDLElBQUk7b0JBQ0YsTUFBTUMsMEJBQTBCLENBQUM7a0RBQ08sRUFBRVgsTUFBTS9FLElBQUksQ0FBQztRQUN2RCxFQUFFNEQsZ0JBQWdCaEYsTUFBTSxDQUFDa0csSUFBSSxDQUFDLE1BQU07Y0FDOUIsRUFBRWxCLGdCQUFnQnhCLFdBQVcsQ0FBQztPQUNyQyxFQUFFN0ksYUFBYTs7cUVBRStDLEVBQUVBLGFBQWE7QUFDcEYsQ0FBQztvQkFDUyxNQUFNb00sa0JBQWtCLE1BQU0sSUFBSSxDQUFDMU0sV0FBVyxHQUFHMk0sS0FBSyxDQUFDRix5QkFBeUI7d0JBQzlFRyxNQUFNO3dCQUNOOUwsUUFBUTtvQkFDVjtvQkFDQXlDLFNBQVNNLFVBQVUsQ0FBQzJJLEVBQUUsQ0FBQ3ZGLE9BQU8sR0FBR3lGO29CQUVqQyxpREFBaUQ7b0JBQ2pELE1BQU1HLDBCQUEwQixDQUFDO3dCQUNuQixFQUFFZixNQUFNL0UsSUFBSSxDQUFDLHFCQUFxQixFQUFFNEQsZ0JBQWdCaEYsTUFBTSxDQUFDLEVBQUUsSUFBSWdGLGdCQUFnQnhCLFdBQVcsQ0FBQzttQkFDbEcsRUFBRTdJLGFBQWE7QUFDbEMsQ0FBQztvQkFDUyxNQUFNd00sb0JBQW9CLE1BQU0sSUFBSSxDQUFDOU0sV0FBVyxHQUFHMk0sS0FBSyxDQUFDRSx5QkFBeUI7d0JBQ2hGRCxNQUFNO3dCQUNOOUwsUUFBUTtvQkFDVjtvQkFDQXlDLFNBQVNNLFVBQVUsQ0FBQzJJLEVBQUUsQ0FBQ00saUJBQWlCLEdBQUdBO2dCQUM3QyxFQUFFLE9BQU83TCxPQUFPO29CQUNkLHFDQUFxQztvQkFDckNMLFFBQVFvSyxJQUFJLENBQUMsQ0FBQyxpQ0FBaUMsRUFBRWMsTUFBTS9FLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRTlGO2dCQUNsRTtZQUNGO1FBQ0Y7UUFFQSxnRUFBZ0U7UUFDaEUsSUFBSXNDLFNBQVN3SixVQUFVLEVBQUU7WUFDdkIsSUFBSTtnQkFDRixNQUFNQywyQkFBMkIsQ0FBQzt5Q0FDRCxFQUFFNUwsV0FBVyxjQUFjLEVBQUV1SixnQkFBZ0JoRixNQUFNLENBQUNrRyxJQUFJLENBQUMsU0FBUztBQUMzRyxFQUFFdEksU0FBU3dKLFVBQVUsQ0FBQ2xCLElBQUksQ0FBQyxNQUFNOztxREFFb0IsRUFBRXZMLGFBQWE7RUFDbEUsRUFBRXFLLGdCQUFnQmhGLE1BQU0sQ0FBQ1ksS0FBSyxDQUFDLEdBQUcsR0FBR3NGLElBQUksQ0FBQyxRQUFROzs7QUFHcEQsQ0FBQztnQkFDTyxNQUFNb0IscUJBQXFCLE1BQU0sSUFBSSxDQUFDak4sV0FBVyxHQUFHMk0sS0FBSyxDQUFDSywwQkFBMEI7b0JBQ2xGSixNQUFNO29CQUNOOUwsUUFBUTtvQkFDUm9NLFFBQVE7Z0JBQ1Y7Z0JBQ0EzSixTQUFTd0osVUFBVSxHQUFHLElBQUksQ0FBQ3pCLGlCQUFpQixDQUFDMkIsb0JBQW9CMUcsS0FBSyxDQUFDLEdBQUc7WUFDNUUsRUFBRSxPQUFPdEYsT0FBTztnQkFDZEwsUUFBUW9LLElBQUksQ0FBQywyQ0FBMkMvSjtZQUMxRDtRQUNGO1FBRUEsZ0RBQWdEO1FBQ2hELElBQUlzQyxTQUFTNEosT0FBTyxJQUFJNUwsbUJBQW1COEksVUFBVXZKLFNBQVMsR0FBRztZQUMvRCxJQUFJO2dCQUNGLE1BQU1zTSwwQkFBMEIsQ0FBQzs7QUFFekMsRUFBRTdMLGtCQUFrQjhJLFFBQVEsQ0FBQzlELEtBQUssQ0FBQyxHQUFHLEdBQUdQLEdBQUcsQ0FBQ3FILENBQUFBLElBQUssQ0FBQyxFQUFFLEVBQUVBLEVBQUVqRyxJQUFJLENBQUMsQ0FBQyxFQUFFeUUsSUFBSSxDQUFDLE1BQU07O2dCQUU1RCxFQUFFdEksU0FBUzRKLE9BQU8sQ0FBQzs7MEJBRVQsRUFBRTdNLGFBQWE7QUFDekMsQ0FBQztnQkFDTyxNQUFNZ04sa0JBQWtCLE1BQU0sSUFBSSxDQUFDdE4sV0FBVyxHQUFHdU4sT0FBTyxDQUFDaEssU0FBUzRKLE9BQU8sRUFBRTtvQkFDekVQLE1BQU07b0JBQ045TCxRQUFRO29CQUNSME0sVUFBVSxJQUFJLENBQUNDLGdCQUFnQixDQUFDbk47Z0JBQ2xDO2dCQUNBaUQsU0FBUzRKLE9BQU8sR0FBR0c7WUFDckIsRUFBRSxPQUFPck0sT0FBTztnQkFDZEwsUUFBUW9LLElBQUksQ0FBQyxzQ0FBc0MvSjtZQUNyRDtRQUNGO1FBRUEseURBQXlEO1FBQ3pELElBQUlzQyxTQUFTbUssT0FBTyxJQUFJbkssU0FBU21LLE9BQU8sQ0FBQ0MsS0FBSyxFQUFFO1lBQzlDLElBQUk7Z0JBQ0YsTUFBTUMsd0JBQXdCLENBQUM7K0JBQ1IsRUFBRXJLLFNBQVNtSyxPQUFPLENBQUNDLEtBQUssQ0FBQztRQUNoRCxFQUFFaEQsZ0JBQWdCaEYsTUFBTSxDQUFDa0csSUFBSSxDQUFDLE1BQU07Z0JBQzVCLEVBQUVsQixnQkFBZ0JyQixhQUFhLENBQUMvQyxLQUFLLENBQUMsR0FBRyxHQUFHc0YsSUFBSSxDQUFDLE1BQU07OzBEQUViLEVBQUV2TCxhQUFhO0FBQ3pFLENBQUM7Z0JBQ08sTUFBTXVOLDRCQUE0QixNQUFNLElBQUksQ0FBQzdOLFdBQVcsR0FBRzJNLEtBQUssQ0FBQ2lCLHVCQUF1QjtvQkFDdEZoQixNQUFNO29CQUNOOUwsUUFBUTtvQkFDUm9NLFFBQVE7Z0JBQ1Y7Z0JBQ0EzSixTQUFTbUssT0FBTyxDQUFDSSxrQkFBa0IsR0FBRyxJQUFJLENBQUN4QyxpQkFBaUIsQ0FBQ3VDO1lBQy9ELEVBQUUsT0FBTzVNLE9BQU87Z0JBQ2RMLFFBQVFvSyxJQUFJLENBQUMsdUNBQXVDL0o7WUFDdEQ7UUFDRjtRQUVBLE9BQU9zQztJQUNUO0lBRUEsTUFBY3dLLGdCQUFnQkMsTUFBVyxFQUFFO1FBQ3pDLDhCQUE4QjtRQUM5QixNQUFNQyxzQkFBc0I7WUFBQztZQUFXO1lBQW9CO1NBQXlCO1FBRXJGLEtBQUssTUFBTUMsZUFBZUQsb0JBQXFCO1lBQzdDLE1BQU1FLFFBQVEsSUFBSSxDQUFDQyxjQUFjLENBQUNKLFFBQVFFO1lBQzFDLElBQUksT0FBT0MsVUFBVSxVQUFVO2dCQUM3QixNQUFNRSxZQUFZLE1BQU0sSUFBSSxDQUFDck8sV0FBVyxHQUFHcU8sU0FBUyxDQUFDRixPQUFPO29CQUMxREcsY0FBYztvQkFDZEMsZUFBZTtvQkFDZkMsWUFBWTtnQkFDZDtnQkFDQSxJQUFJLENBQUNDLGNBQWMsQ0FBQ1QsUUFBUUUsYUFBYUcsVUFBVUssY0FBYztZQUNuRTtRQUNGO1FBRUEsT0FBT1Y7SUFDVDtJQUVRVyx1QkFBdUJ4TixNQUE4QixFQUFtQjtRQUM5RSw0Q0FBNEM7UUFDNUMsTUFBTSxFQUFFZCxVQUFVLEVBQUVlLFVBQVUsRUFBRWQsWUFBWSxFQUFFQyxjQUFjLEVBQUUsR0FBR1k7UUFFakUsT0FBTztZQUNMQztZQUNBZDtZQUNBQztZQUNBZ0QsVUFBVTtnQkFDUkksUUFBUSxJQUFJLENBQUNpTCxpQkFBaUIsQ0FBQ3hOLFlBQVlkO2dCQUMzQ3VELFlBQVksSUFBSSxDQUFDZ0wsaUJBQWlCLENBQUN4TyxZQUFZQztnQkFDL0M2TSxTQUFTLElBQUksQ0FBQzJCLFlBQVksQ0FBQ3pPLFlBQVlDO2dCQUN2Q3lPLGVBQWUsSUFBSSxDQUFDQyx3QkFBd0IsQ0FBQzVOLFlBQVlkO2dCQUN6RDhFLGtCQUFrQixJQUFJLENBQUM2SixnQ0FBZ0MsQ0FBQyxjQUFjM08sY0FBYyxFQUFFO2dCQUN0RmdGLGlCQUFpQixJQUFJLENBQUM0SiwrQkFBK0IsQ0FBQyxjQUFjNU8sY0FBYyxFQUFFO2dCQUNwRnlNLFlBQVksSUFBSSxDQUFDb0MscUJBQXFCLENBQUMvTixZQUFZZDtnQkFDbkRvTixTQUFTLElBQUksQ0FBQzBCLGtCQUFrQixDQUFDOU87Z0JBQ2pDK08sZUFBZSxJQUFJLENBQUNDLHdCQUF3QixDQUFDalA7Z0JBQzdDa1AsUUFBUSxJQUFJLENBQUNDLGlCQUFpQixDQUFDcE87WUFDakM7UUFDRjtJQUNGO0lBRUEsaUJBQWlCO0lBQ1RxTyxpQkFBaUJDLEtBQWEsRUFBK0I7UUFDbkUsTUFBTUMsWUFBWTtZQUNoQkMsSUFBSTtZQUNKQyxJQUFJO1lBQ0pDLElBQUk7WUFDSkMsSUFBSTtZQUNKQyxJQUFJO1FBQ047UUFDQSxPQUFPTCxTQUFTLENBQUNELE1BQU0sSUFBSTtJQUM3QjtJQUVRTyxnQkFBZ0JDLFFBQWdCLEVBQVU7UUFDaEQsTUFBTUMsY0FBYztZQUNsQkMsU0FBUztZQUNUQyxRQUFRO1lBQ1JDLFFBQVE7WUFDUkMsU0FBUztZQUNUQyxZQUFZO1lBQ1pDLFVBQVU7WUFDVkMsUUFBUTtZQUNSQyxTQUFTO1FBQ1g7UUFDQSxPQUFPUixXQUFXLENBQUNELFNBQVMsSUFBSTtJQUNsQztJQUVRNUUsa0JBQWtCbEUsSUFBWSxFQUFZO1FBQ2hELE9BQU9BLEtBQ0pyQixLQUFLLENBQUMsTUFDTkcsTUFBTSxDQUFDLENBQUNELE9BQVNBLEtBQUtqRixJQUFJLElBQzFCZ0YsR0FBRyxDQUFDLENBQUNDLE9BQVNBLEtBQUtLLE9BQU8sQ0FBQyxhQUFhLElBQUl0RixJQUFJLElBQ2hEa0YsTUFBTSxDQUFDLENBQUNELE9BQVNBLEtBQUtuRixNQUFNLEdBQUcsR0FDL0J5RixLQUFLLENBQUMsR0FBRyxHQUFHLG1CQUFtQjs7SUFDcEM7SUFFUTZILGVBQWV3QyxHQUFRLEVBQUVDLElBQVksRUFBTztRQUNsRCxPQUFPQSxLQUFLOUssS0FBSyxDQUFDLEtBQUtpRSxNQUFNLENBQUMsQ0FBQzhHLFNBQVNDLE1BQVFELFNBQVMsQ0FBQ0MsSUFBSSxFQUFFSDtJQUNsRTtJQUVRbkMsZUFBZW1DLEdBQVEsRUFBRUMsSUFBWSxFQUFFMUMsS0FBVSxFQUFRO1FBQy9ELE1BQU0vSyxPQUFPeU4sS0FBSzlLLEtBQUssQ0FBQztRQUN4QixNQUFNaUwsVUFBVTVOLEtBQUs2TixHQUFHO1FBQ3hCLE1BQU1DLFNBQVM5TixLQUFLNEcsTUFBTSxDQUFDLENBQUM4RyxTQUFTQyxNQUFRRCxPQUFPLENBQUNDLElBQUksRUFBRUg7UUFDM0RNLE1BQU0sQ0FBQ0YsUUFBUSxHQUFHN0M7SUFDcEI7SUFFUTlCLHlCQUF5QjVHLE9BQWUsRUFBRXJFLFVBQWtCLEVBQUVkLFlBQW9CLEVBQUU7UUFDMUZNLFFBQVFDLEdBQUcsQ0FBQztRQUVaLGtFQUFrRTtRQUNsRSxNQUFNNkcsUUFBUWpDLFFBQVFXLFdBQVcsR0FBR29CLEtBQUssQ0FBQyxxQkFBcUIsRUFBRTtRQUNqRSxNQUFNMkosY0FBY0MsTUFBTUMsSUFBSSxDQUFDLElBQUlDLElBQUk1SixRQUFRbkIsS0FBSyxDQUFDLEdBQUc7UUFFeEQsTUFBTTZGLFdBQVc7WUFDZnpJLFFBQVEsRUFBRTtZQUNWRSxZQUFZc04sWUFBWW5MLEdBQUcsQ0FBQ2UsQ0FBQUEsT0FBUztvQkFDbkNBLE1BQU1BO29CQUNOQyxTQUFTLENBQUMsY0FBYyxFQUFFRCxLQUFLLENBQUM7b0JBQ2hDRSxTQUFTLENBQUMsc0JBQXNCLEVBQUVGLEtBQUssQ0FBQyxDQUFDO2dCQUMzQztZQUNBb0csU0FBUyxJQUFJLENBQUMyQixZQUFZLENBQUNySixTQUFTbkY7WUFDcEN5TyxlQUFlLElBQUksQ0FBQ0Msd0JBQXdCLENBQUM1TixZQUFZZDtZQUN6RHlNLFlBQVksSUFBSSxDQUFDb0MscUJBQXFCLENBQUMvTixZQUFZZDtZQUNuRG9OLFNBQVMsSUFBSSxDQUFDMEIsa0JBQWtCLENBQUM5TztZQUNqQytPLGVBQWUsSUFBSSxDQUFDQyx3QkFBd0IsQ0FBQzdKO1lBQzdDOEosUUFBUSxJQUFJLENBQUNDLGlCQUFpQixDQUFDcE87UUFDakM7UUFFQVIsUUFBUUMsR0FBRyxDQUFDO1FBQ1osT0FBT3VMO0lBQ1Q7SUFFUXdDLGtCQUFrQnhOLFVBQWtCLEVBQUVkLFlBQW9CLEVBQVk7UUFDNUUsTUFBTWlSLFlBQVk7WUFDaEJ4RSxZQUFZO2dCQUNWO2dCQUNBO2dCQUNBO2FBQ0Q7WUFDRFcsU0FBUztnQkFDUDtnQkFDQTtnQkFDQTthQUNEO1lBQ0Q4RCxRQUFRO2dCQUNOO2dCQUNBO2dCQUNBO2FBQ0Q7WUFDREMsVUFBVTtnQkFDUjtnQkFDQTtnQkFDQTthQUNEO1lBQ0RwQyxlQUFlO2dCQUNiO2dCQUNBO2dCQUNBO2FBQ0Q7UUFDSDtRQUNBLE9BQU9rQyxTQUFTLENBQUNuUSxXQUFXLElBQUltUSxVQUFVeEUsVUFBVTtJQUN0RDtJQUVROEIsa0JBQWtCekgsSUFBWSxFQUFFOUcsWUFBb0IsRUFBRTtRQUM1RCxzRUFBc0U7UUFDdEUsTUFBTW9ILFFBQVFOLEtBQUtoQixXQUFXLEdBQUdvQixLQUFLLENBQUMscUJBQXFCLEVBQUU7UUFDOUQsTUFBTTJKLGNBQWNDLE1BQU1DLElBQUksQ0FBQyxJQUFJQyxJQUFJNUo7UUFDdkMsTUFBTWdLLGdCQUFnQlAsWUFBWTVLLEtBQUssQ0FBQyxHQUFHO1FBRTNDLE9BQU9tTCxjQUFjMUwsR0FBRyxDQUFDLENBQUNlLE9BQVU7Z0JBQ2xDQSxNQUFNQTtnQkFDTkMsU0FBUyxDQUFDLGNBQWMsRUFBRUQsS0FBSyxDQUFDO2dCQUNoQ0UsU0FBUyxDQUFDLHNCQUFzQixFQUFFRixLQUFLLENBQUMsQ0FBQztZQUMzQztJQUNGO0lBRVErSCxhQUFhMUgsSUFBWSxFQUFFOUcsWUFBb0IsRUFBVTtRQUMvRCwyQ0FBMkM7UUFDM0MsTUFBTXFSLFlBQVk7WUFDaEIvQixJQUFJO1lBQ0pDLElBQUk7WUFDSkMsSUFBSTtZQUNKQyxJQUFJO1lBQ0pDLElBQUk7UUFDTjtRQUVBLE1BQU00QixRQUFRRCxTQUFTLENBQUNyUixhQUFhLElBQUk7UUFDekMsT0FBTzhHLEtBQUt6RyxTQUFTLENBQUMsR0FBR2lSLFNBQVV4SyxDQUFBQSxLQUFLdEcsTUFBTSxHQUFHOFEsUUFBUSxRQUFRLEVBQUM7SUFDcEU7SUFFUTVDLHlCQUF5QjVOLFVBQWtCLEVBQUVkLFlBQW9CLEVBQVk7UUFDbkYsT0FBTztZQUNMO1lBQ0E7WUFDQTtZQUNBO1NBQ0Q7SUFDSDtJQUVRNk8sc0JBQXNCL04sVUFBa0IsRUFBRWQsWUFBb0IsRUFBWTtRQUNoRixNQUFNaVIsWUFBWTtZQUNoQnhFLFlBQVk7Z0JBQ1Y7Z0JBQ0E7Z0JBQ0E7YUFDRDtZQUNEMEUsVUFBVTtnQkFDUjtnQkFDQTtnQkFDQTthQUNEO1lBQ0RELFFBQVE7Z0JBQ047Z0JBQ0E7Z0JBQ0E7YUFDRDtRQUNIO1FBQ0EsT0FBT0QsU0FBUyxDQUFDblEsV0FBVyxJQUFJbVEsVUFBVXhFLFVBQVU7SUFDdEQ7SUFFUXFDLG1CQUFtQjlPLFlBQW9CLEVBQUU7UUFDL0MsTUFBTXVSLGNBQWM7WUFDbEJqQyxJQUFJO1lBQ0pDLElBQUk7WUFDSkMsSUFBSTtZQUNKQyxJQUFJO1lBQ0pDLElBQUk7UUFDTjtRQUVBLE9BQU87WUFDTHJDLE9BQU9rRSxXQUFXLENBQUN2UixhQUFhLElBQUk7WUFDcEMrSCxVQUFVO2dCQUFDO2dCQUFtQztnQkFBZ0M7YUFBZ0M7WUFDOUd5SixVQUFVO2dCQUNSO2dCQUNBO2dCQUNBO2FBQ0Q7UUFDSDtJQUNGO0lBRVF4Qyx5QkFBeUJsSSxJQUFZLEVBQUU7UUFDN0MsMkNBQTJDO1FBQzNDLE1BQU1NLFFBQVFOLEtBQUtJLEtBQUssQ0FBQyxzQkFBc0I7WUFBQztTQUFnQjtRQUNoRSxNQUFNdUssZUFBZXJLLEtBQUssQ0FBQyxFQUFFLElBQUk7UUFFakMsT0FBTztZQUNMWCxNQUFNZ0wsYUFBYTNMLFdBQVc7WUFDOUI0TCxLQUFLO1lBQ0xDLFVBQVUsQ0FBQyxrQkFBa0IsRUFBRUYsYUFBYSxnQkFBZ0IsQ0FBQztRQUMvRDtJQUNGO0lBRVF2QyxrQkFBa0JwTyxVQUFrQixFQUFZO1FBQ3RELE9BQU87WUFDTDtZQUNBO1lBQ0E7WUFDQTtTQUNEO0lBQ0g7SUFFQSxzREFBc0Q7SUFFOUM4USwwQkFBMEI3SCxRQUFnRCxFQUFZO1FBQzVGLE9BQU9BLFNBQ0puRSxNQUFNLENBQUNtSCxDQUFBQSxJQUFLQSxFQUFFcUMsS0FBSyxJQUFJLEdBQUcseUJBQXlCO1NBQ25EMUosR0FBRyxDQUFDcUgsQ0FBQUEsSUFBS0EsRUFBRWpHLElBQUksRUFDZmIsS0FBSyxDQUFDLEdBQUc7SUFDZDtJQUVRNkQsc0JBQXNCaEQsSUFBWSxFQUFFaUQsUUFBZ0QsRUFBWTtRQUN0Ryx3Q0FBd0M7UUFDeEMsTUFBTThILGdCQUFnQixJQUFJLENBQUNELHlCQUF5QixDQUFDN0g7UUFDckQsSUFBSThILGNBQWNyUixNQUFNLEdBQUcsR0FBRztZQUM1QixPQUFPcVI7UUFDVDtRQUVBLDBDQUEwQztRQUMxQyxNQUFNdEksWUFBWXpDLEtBQUtyQixLQUFLLENBQUMsVUFBVUcsTUFBTSxDQUFDNEQsQ0FBQUEsSUFBS0EsRUFBRTlJLElBQUksR0FBR0YsTUFBTSxHQUFHO1FBQ3JFLE1BQU02RSxTQUFTLEVBQUU7UUFFakIsbUNBQW1DO1FBQ25DLE1BQU15TSxnQkFBZ0I7WUFDcEI7WUFDQTtZQUNBO1lBQ0E7U0FDRDtRQUVELEtBQUssTUFBTUMsWUFBWXhJLFVBQVV0RCxLQUFLLENBQUMsR0FBRyxHQUFJO1lBQzVDLEtBQUssTUFBTWUsV0FBVzhLLGNBQWU7Z0JBQ25DLE1BQU03SyxVQUFVOEssU0FBUzdLLEtBQUssQ0FBQ0Y7Z0JBQy9CLElBQUlDLFNBQVM7b0JBQ1g1QixPQUFPVCxJQUFJLElBQUlxQyxRQUFRdkIsR0FBRyxDQUFDeUIsQ0FBQUEsSUFBS0EsRUFBRW5CLE9BQU8sQ0FBQ2dCLFNBQVMsTUFBTXRHLElBQUksSUFBSXVGLEtBQUssQ0FBQyxHQUFHO2dCQUM1RTtZQUNGO1FBQ0Y7UUFFQSwwQ0FBMEM7UUFDMUMsSUFBSVosT0FBTzdFLE1BQU0sS0FBSyxHQUFHO1lBQ3ZCLE1BQU00RyxRQUFRTixLQUFLaEIsV0FBVyxHQUFHb0IsS0FBSyxDQUFDLHFCQUFxQixFQUFFO1lBQzlELE1BQU1HLGNBQWM7Z0JBQUM7Z0JBQVE7Z0JBQVE7Z0JBQVE7Z0JBQVE7Z0JBQVE7Z0JBQVE7Z0JBQVE7Z0JBQVE7Z0JBQVE7Z0JBQVE7Z0JBQVE7Z0JBQVE7Z0JBQVM7Z0JBQVM7Z0JBQVM7Z0JBQVM7Z0JBQVM7YUFBUztZQUMzSyxNQUFNMkssV0FBVzVLLE1BQ2R4QixNQUFNLENBQUNhLENBQUFBLE9BQVEsQ0FBQ1ksWUFBWXRCLFFBQVEsQ0FBQ1UsT0FDckNiLE1BQU0sQ0FBQyxDQUFDYSxNQUFNd0wsT0FBT0MsTUFBUUEsSUFBSUMsT0FBTyxDQUFDMUwsVUFBVXdMLE9BQU8sU0FBUzthQUNuRWhNLEtBQUssQ0FBQyxHQUFHO1lBRVosT0FBTytMLFNBQVN4UixNQUFNLEdBQUcsSUFBSXdSLFdBQVc7Z0JBQUM7Z0JBQWlCO2dCQUFrQjthQUFVO1FBQ3hGO1FBRUEsT0FBTzNNLE9BQU9ZLEtBQUssQ0FBQyxHQUFHO0lBQ3pCO0lBRUEsd0VBQXdFO0lBQ2hFd0IsNEJBQTRCWCxJQUFZLEVBQUVzSSxLQUFhLEVBQVk7UUFDekUsTUFBTWhJLFFBQVFOLEtBQUtoQixXQUFXLEdBQUdvQixLQUFLLENBQUMscUJBQXFCLEVBQUU7UUFDOUQsTUFBTTJKLGNBQWNDLE1BQU1DLElBQUksQ0FBQyxJQUFJQyxJQUFJNUo7UUFFdkMseUVBQXlFO1FBQ3pFLE1BQU1nTCxlQUFlLElBQUlwQixJQUFJO1lBQzNCLHVCQUF1QjtZQUN2QjtZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQVE7WUFBUTtZQUFTO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVM7WUFBUztZQUFRO1lBQVM7WUFBUztZQUFTO1lBQVM7WUFBUztZQUFTO1lBQVE7WUFBUztZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVU7WUFBUTtZQUFRO1lBQVM7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUztZQUFRO1lBQVE7WUFBUztZQUFRO1lBQVE7WUFBUztZQUFRO1lBQVE7WUFBUztZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFTO1lBQVM7WUFBUztZQUFTO1lBQVM7WUFBUTtZQUFTO1lBQVM7WUFBUztZQUFTO1lBQVM7WUFBUztZQUFTO1lBQVM7WUFBUztZQUNyakMsaURBQWlEO1lBQ2pEO1lBQVc7WUFBVztZQUFhO1lBQVc7WUFBWTtZQUFZO1lBQVc7WUFBWTtZQUFTO1lBQVM7WUFBUTtZQUFRO1lBQVU7WUFBUztZQUFVO1lBQVU7WUFBUztZQUFTO1lBQVc7WUFBUztZQUFTO1lBQVk7WUFDak8sd0RBQXdEO1lBQ3hEO1lBQVE7WUFBUztZQUFVO1lBQVU7WUFBVTtZQUFZO1lBQzNEO1lBQVU7WUFBVztZQUFhO1lBQVk7WUFBVTtZQUFZO1lBQ3BFO1lBQVM7WUFBYTtZQUFZO1lBQVc7WUFBYTtZQUFXO1lBQ3JFLG9FQUFvRTtZQUNwRTtZQUFRO1lBQVE7WUFBUztZQUFTO1lBQVc7WUFBWTtZQUFVO1lBQVE7WUFBVztZQUFTO1lBQVM7WUFBUztZQUFlO1lBQVc7WUFBVTtZQUFTO1lBQVc7WUFBUztZQUFXO1lBQVM7WUFBUTtZQUFVO1lBQVU7WUFBUztZQUFVO1lBQVM7WUFBUTtZQUFRO1lBQVU7WUFBVTtZQUFVO1lBQVk7WUFBVztZQUFTO1lBQVM7WUFBUztZQUFTO1lBQVk7WUFBVTtZQUFXO1lBQVU7WUFBVztZQUFVO1lBQVE7WUFBVztZQUFTO1lBQVM7WUFBUztZQUFXO1lBQVM7WUFBUTtZQUFTO1lBQVM7WUFBVTtZQUFRO1lBQVM7WUFBWTtZQUFTO1lBQVE7WUFBUTtZQUFZO1lBQVU7WUFBVztZQUFZO1lBQVM7WUFBUztZQUFVO1lBQVM7WUFBUztZQUFZO1lBQVc7WUFBVztZQUFZO1lBQVc7WUFBVTtZQUFRO1lBQVc7WUFBUztZQUFhO1lBQVM7WUFBVztZQUFTO1lBQVM7WUFBUztZQUFXO1lBQVU7WUFBUTtZQUFTO1lBQVU7WUFBUztZQUFTO1lBQVE7WUFBUztZQUFVO1lBQVM7WUFBWTtZQUFRO1lBQVM7WUFBUztZQUFTO1lBQVE7WUFBWTtZQUFXO1lBQVc7WUFBVTtZQUFXO1lBQVM7WUFBUTtZQUFXO1lBQVM7WUFBUTtZQUFTO1lBQVU7U0FDOWtDO1FBRUQsK0NBQStDO1FBQy9DLE1BQU14SixrQkFBa0JxSixZQUFZakwsTUFBTSxDQUFDYSxDQUFBQTtZQUN6QyxJQUFJMkwsYUFBYUMsR0FBRyxDQUFDNUwsT0FBTyxPQUFPO1lBQ25DLElBQUksUUFBUTZMLElBQUksQ0FBQzdMLE9BQU8sT0FBTyxNQUFNLG9CQUFvQjs7WUFDekQsSUFBSUEsS0FBS2pHLE1BQU0sR0FBRyxHQUFHLE9BQU8sTUFBTSx3QkFBd0I7O1lBQzFELElBQUlpRyxLQUFLakcsTUFBTSxHQUFHLElBQUksT0FBTyxNQUFNLHVCQUF1Qjs7WUFDMUQsSUFBSSxJQUFJLENBQUMrUixZQUFZLENBQUM5TCxPQUFPLE9BQU8sTUFBTSxvQkFBb0I7O1lBQzlELE9BQU87UUFDVDtRQUVBLHdEQUF3RDtRQUN4RCxNQUFNK0wsY0FBY2hMLGdCQUFnQjlCLEdBQUcsQ0FBQ2UsQ0FBQUE7WUFDdEMsSUFBSWdNLFFBQVE7WUFFWiwrRUFBK0U7WUFDL0UsSUFBSSxpdERBQWl0REgsSUFBSSxDQUFDN0wsT0FBTztnQkFDL3REZ00sU0FBUyxFQUFFLHFEQUFxRDs7WUFDbEU7WUFFQSxrQ0FBa0M7WUFDbEMsSUFBSSxva0NBQW9rQ0gsSUFBSSxDQUFDN0wsT0FBTztnQkFDbGxDZ00sU0FBUztZQUNYO1lBRUEsaUNBQWlDO1lBQ2pDLElBQUksK3VCQUErdUJILElBQUksQ0FBQzdMLE9BQU87Z0JBQzd2QmdNLFNBQVM7WUFDWDtZQUVBLHVEQUF1RDtZQUN2RCxJQUFJLDByREFBMHJESCxJQUFJLENBQUM3TCxPQUFPO2dCQUN4c0RnTSxTQUFTO1lBQ1g7WUFFQSwwRUFBMEU7WUFDMUUsTUFBTUMsWUFBWSxDQUFDNUwsS0FBS2hCLFdBQVcsR0FBR29CLEtBQUssQ0FBQyxJQUFJeUwsT0FBTyxDQUFDLEdBQUcsRUFBRWxNLEtBQUssR0FBRyxDQUFDLEVBQUUsU0FBUyxFQUFFLEVBQUVqRyxNQUFNO1lBQzNGLElBQUlrUyxZQUFZLEdBQUdELFNBQVNDLFlBQVk7WUFFeEMscUNBQXFDO1lBQ3JDLElBQUlqTSxLQUFLakcsTUFBTSxJQUFJLEtBQUtpRyxLQUFLakcsTUFBTSxJQUFJLElBQUlpUyxTQUFTO1lBRXBELE9BQU87Z0JBQUVoTTtnQkFBTWdNO1lBQU07UUFDdkI7UUFFQSxxQ0FBcUM7UUFDckMsTUFBTUcsV0FBV0osWUFDZEssSUFBSSxDQUFDLENBQUNDLEdBQUdDLElBQU1BLEVBQUVOLEtBQUssR0FBR0ssRUFBRUwsS0FBSyxFQUNoQ3hNLEtBQUssQ0FBQyxHQUFHLEdBQUcsbUJBQW1CO1NBQy9CUCxHQUFHLENBQUNzTixDQUFBQSxPQUFRQSxLQUFLdk0sSUFBSTtRQUV4Qm5HLFFBQVFDLEdBQUcsQ0FBQywwREFBZ0RxUyxTQUFTbE4sR0FBRyxDQUFDdU4sQ0FBQUEsSUFBSyxDQUFDLEVBQUVBLEVBQUUsU0FBUyxFQUFFVCxZQUFZVSxJQUFJLENBQUMxSixDQUFBQSxJQUFLQSxFQUFFL0MsSUFBSSxLQUFLd00sSUFBSVIsTUFBTSxDQUFDLENBQUM7UUFDM0ksT0FBT0c7SUFDVDtJQUVRNUksMEJBQTBCbEQsSUFBWSxFQUFFc0ksS0FBYSxFQUFZO1FBQ3ZFLHdFQUF3RTtRQUN4RSxNQUFNaEksUUFBUU4sS0FBS2hCLFdBQVcsR0FBR29CLEtBQUssQ0FBQyxxQkFBcUIsRUFBRTtRQUM5RCxNQUFNMkosY0FBY0MsTUFBTUMsSUFBSSxDQUFDLElBQUlDLElBQUk1SjtRQUV2QyxtREFBbUQ7UUFDbkQsTUFBTWdMLGVBQWUsSUFBSXBCLElBQUk7WUFDM0IsZUFBZTtZQUNmO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFBUTtZQUFRO1lBQVM7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUztZQUFTO1lBQVE7WUFBUztZQUFTO1lBQVM7WUFBUztZQUFTO1lBQVM7WUFBUTtZQUFTO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBVTtZQUFRO1lBQVE7WUFBUztZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFTO1lBQVE7WUFBUTtZQUFTO1lBQVE7WUFBUTtZQUFTO1lBQVE7WUFBUTtZQUFTO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVE7WUFBUTtZQUFRO1lBQVM7WUFBUztZQUFTO1lBQVM7WUFBUztZQUFRO1lBQVM7WUFBUztZQUFTO1lBQVM7WUFBUztZQUFTO1lBQVM7WUFBUztZQUFTO1lBQ3JqQywwREFBMEQ7WUFDMUQ7WUFBVztZQUFZO1lBQVM7WUFBUztZQUFRO1lBQVE7WUFBVTtZQUFhO1lBQVc7WUFBWTtZQUN2RztZQUFVO1lBQVc7WUFBYTtZQUFZO1lBQVU7WUFBWTtZQUNwRTtZQUFTO1lBQWE7WUFBWTtZQUFXO1lBQWE7WUFBVztZQUNyRSxxREFBcUQ7WUFDckQ7WUFBYTtZQUFjO1lBQVc7WUFBWTtZQUFVO1lBQVU7WUFBUTtZQUFVO1lBQVM7U0FDbEc7UUFFRCw4Q0FBOEM7UUFDOUMsTUFBTXhKLGtCQUFrQnFKLFlBQVlqTCxNQUFNLENBQUNhLENBQUFBO1lBQ3pDLHNCQUFzQjtZQUN0QixJQUFJMkwsYUFBYUMsR0FBRyxDQUFDNUwsT0FBTyxPQUFPO1lBRW5DLDZCQUE2QjtZQUM3QixJQUFJLFFBQVE2TCxJQUFJLENBQUM3TCxTQUFTLFVBQVU2TCxJQUFJLENBQUM3TCxPQUFPLE9BQU87WUFFdkQsdUVBQXVFO1lBQ3ZFLElBQUlBLEtBQUtqRyxNQUFNLEdBQUcsR0FBRyxPQUFPO1lBRTVCLGlEQUFpRDtZQUNqRCxJQUFJaUcsS0FBS2pHLE1BQU0sR0FBRyxJQUFJLE9BQU87WUFFN0IsT0FBTztRQUNUO1FBRUEseUNBQXlDO1FBQ3pDLE1BQU1nUyxjQUFjaEwsZ0JBQWdCOUIsR0FBRyxDQUFDZSxDQUFBQTtZQUN0QyxJQUFJZ00sUUFBUTtZQUVaLG1DQUFtQztZQUNuQyxJQUFJLCtrRUFBK2tFSCxJQUFJLENBQUM3TCxPQUFPO2dCQUM3bEVnTSxTQUFTO1lBQ1g7WUFFQSxrQ0FBa0M7WUFDbEMsSUFBSSxpbURBQWltREgsSUFBSSxDQUFDN0wsT0FBTztnQkFDL21EZ00sU0FBUztZQUNYO1lBRUEsbUNBQW1DO1lBQ25DLElBQUksOHNDQUE4c0NILElBQUksQ0FBQzdMLE9BQU87Z0JBQzV0Q2dNLFNBQVM7WUFDWDtZQUVBLHVEQUF1RDtZQUN2RCxJQUFJLG00TUFBbTRNSCxJQUFJLENBQUM3TCxPQUFPO2dCQUNqNU1nTSxTQUFTO1lBQ1g7WUFFQSxxRUFBcUU7WUFDckUsTUFBTUMsWUFBWSxDQUFDNUwsS0FBS2hCLFdBQVcsR0FBR29CLEtBQUssQ0FBQyxJQUFJeUwsT0FBTyxDQUFDLEdBQUcsRUFBRWxNLEtBQUssR0FBRyxDQUFDLEVBQUUsU0FBUyxFQUFFLEVBQUVqRyxNQUFNO1lBQzNGLElBQUlrUyxZQUFZLEdBQUdELFNBQVNDO1lBRTVCLE9BQU87Z0JBQUVqTTtnQkFBTWdNO1lBQU07UUFDdkI7UUFFQSxxQ0FBcUM7UUFDckMsTUFBTUcsV0FBV0osWUFDZEssSUFBSSxDQUFDLENBQUNDLEdBQUdDLElBQU1BLEVBQUVOLEtBQUssR0FBR0ssRUFBRUwsS0FBSyxFQUNoQ3hNLEtBQUssQ0FBQyxHQUFHLElBQ1RQLEdBQUcsQ0FBQ3NOLENBQUFBLE9BQVFBLEtBQUt2TSxJQUFJO1FBRXhCbkcsUUFBUUMsR0FBRyxDQUFDLHFEQUEyQ3FTO1FBQ3ZELE9BQU9BO0lBQ1Q7SUFFUTNJLHlCQUF5Qm5CLE1BQWMsRUFBRWhDLElBQVksRUFBVTtRQUNyRSx5REFBeUQ7UUFDekQsTUFBTXFNLHFCQUFxQjtZQUN6QixXQUFXO1lBQ1gsV0FBVztZQUNYLGlCQUFpQjtZQUNqQixlQUFlO1lBQ2YsbUJBQW1CO1FBQ3JCO1FBRUEsSUFBSUEsa0JBQWtCLENBQUNySyxPQUFPLEVBQUU7WUFDOUIsT0FBT3FLLGtCQUFrQixDQUFDckssT0FBTztRQUNuQztRQUVBLG9DQUFvQztRQUNwQyxNQUFNc0ssa0JBQWtCO1lBQUM7WUFBVTtZQUFhO1lBQVk7WUFBUztTQUFVO1FBQy9FLE1BQU1DLGlCQUFpQjtZQUFDO1lBQVM7WUFBWTtZQUFjO1lBQVc7U0FBYTtRQUVuRixNQUFNQyxnQkFBZ0JGLGdCQUFnQnhOLE1BQU0sQ0FBQzJOLENBQUFBLFNBQzNDek0sS0FBS2hCLFdBQVcsR0FBR0MsUUFBUSxDQUFDd04sU0FDNUIvUyxNQUFNO1FBRVIsTUFBTWdULGVBQWVILGVBQWV6TixNQUFNLENBQUMyTixDQUFBQSxTQUN6Q3pNLEtBQUtoQixXQUFXLEdBQUdDLFFBQVEsQ0FBQ3dOLFNBQzVCL1MsTUFBTTtRQUVSLElBQUk4UyxnQkFBZ0JFLGNBQWM7WUFDaEMsT0FBTztRQUNULE9BQU8sSUFBSUEsZUFBZUYsZUFBZTtZQUN2QyxPQUFPO1FBQ1Q7UUFFQSxPQUFPO0lBQ1Q7SUFFUXBKLDJCQUEyQnJCLFdBQW1CLEVBQUV4RCxNQUFnQixFQUFFK0osS0FBYSxFQUFZO1FBQ2pHLE1BQU1xRSxhQUFhLEVBQUU7UUFFckIsa0NBQWtDO1FBQ2xDLE9BQVE1SztZQUNOLEtBQUs7Z0JBQ0g0SyxXQUFXN08sSUFBSSxDQUFDO2dCQUNoQjZPLFdBQVc3TyxJQUFJLENBQUM7Z0JBQ2hCO1lBQ0YsS0FBSztnQkFDSDZPLFdBQVc3TyxJQUFJLENBQUM7Z0JBQ2hCNk8sV0FBVzdPLElBQUksQ0FBQztnQkFDaEI7WUFDRixLQUFLO2dCQUNINk8sV0FBVzdPLElBQUksQ0FBQztnQkFDaEI2TyxXQUFXN08sSUFBSSxDQUFDO2dCQUNoQjtZQUNGLEtBQUs7Z0JBQ0g2TyxXQUFXN08sSUFBSSxDQUFDO2dCQUNoQjZPLFdBQVc3TyxJQUFJLENBQUM7Z0JBQ2hCO1lBQ0Y7Z0JBQ0U2TyxXQUFXN08sSUFBSSxDQUFDO2dCQUNoQjZPLFdBQVc3TyxJQUFJLENBQUM7UUFDcEI7UUFFQSxnQ0FBZ0M7UUFDaENTLE9BQU9ZLEtBQUssQ0FBQyxHQUFHLEdBQUd5TixPQUFPLENBQUM1SSxDQUFBQTtZQUN6QjJJLFdBQVc3TyxJQUFJLENBQUMsQ0FBQywwQkFBMEIsRUFBRWtHLE1BQU1oRixXQUFXLEdBQUcsQ0FBQztRQUNwRTtRQUVBLE9BQU8yTixXQUFXeE4sS0FBSyxDQUFDLEdBQUc7SUFDN0I7SUFFUWtILGlCQUFpQndHLFNBQWlCLEVBQXFDO1FBQzdFLE1BQU1DLFdBQVc7WUFDZixNQUFNO1lBQ04sTUFBTTtZQUNOLE1BQU07WUFDTixNQUFNO1lBQ04sTUFBTTtRQUNSO1FBQ0EsT0FBT0EsUUFBUSxDQUFDRCxVQUFVLElBQUk7SUFDaEM7SUFFQSxtREFBbUQ7SUFDM0NFLCtCQUErQmhULE1BQThCLEVBQW1CO1FBQ3RGLE1BQU0sRUFDSmQsVUFBVSxFQUNWZSxVQUFVLEVBQ1ZkLFlBQVksRUFDWkMsY0FBYyxFQUNkZSxlQUFlLEVBQ2ZDLGlCQUFpQixFQUNsQixHQUFHSjtRQUVKUCxRQUFRQyxHQUFHLENBQUM7UUFFWix5Q0FBeUM7UUFDekMsTUFBTThFLFNBQVNwRSxtQkFBbUI4SSxVQUFVckUsSUFBSXFILENBQUFBLElBQUtBLEVBQUVqRyxJQUFJLEVBQUViLE1BQU0sR0FBRyxNQUFNLEVBQUU7UUFDOUUsTUFBTTRDLGNBQWM3SCxpQkFBaUI2SCxlQUFlO1FBRXBELCtEQUErRDtRQUMvRCxNQUFNaUwsc0JBQXNCO1lBQzFCek8sUUFBUUE7WUFDUndELGFBQWFBO1lBQ2JRLGVBQWUsSUFBSSxDQUFDQyxzQkFBc0IsQ0FBQ3RJLGlCQUFpQjhILFVBQVU7WUFDdEVHLGlCQUFpQixJQUFJLENBQUNnQix3QkFBd0IsQ0FBQ2pKLGlCQUFpQjhILFVBQVUsSUFBSS9JO1FBQ2hGO1FBRUEseURBQXlEO1FBQ3pELE1BQU11TCxtQkFBbUIsSUFBSSxDQUFDRiwyQkFBMkIsQ0FBQ3BMLGNBQWM4VCxxQkFBcUI5UztRQUU3RlYsUUFBUUMsR0FBRyxDQUFDLHVEQUE2QytLO1FBRXpELE9BQU87WUFDTHhLO1lBQ0FkO1lBQ0FDO1lBQ0FnRCxVQUFVO2dCQUNSSSxRQUFRaUk7Z0JBQ1IvSCxZQUFZLElBQUksQ0FBQ3dRLDJCQUEyQixDQUFDaFUsWUFBWUMsY0FBY3FGO2dCQUN2RXdILFNBQVMsSUFBSSxDQUFDMkIsWUFBWSxDQUFDek8sWUFBWUM7Z0JBQ3ZDeU8sZUFBZSxJQUFJLENBQUN1RiwwQkFBMEIsQ0FBQ2xULFlBQVlkLGNBQWNxRjtnQkFDekVQLGtCQUFrQixJQUFJLENBQUM2SixnQ0FBZ0MsQ0FBQ3RKLE1BQU0sQ0FBQyxFQUFFLElBQUksY0FBY3JGLGNBQWMsRUFBRTtnQkFDbkdnRixpQkFBaUIsSUFBSSxDQUFDNEosK0JBQStCLENBQUN2SixNQUFNLENBQUMsRUFBRSxJQUFJLGNBQWNyRixjQUFjLEVBQUU7Z0JBQ2pHeU0sWUFBWSxJQUFJLENBQUN3SCx1QkFBdUIsQ0FBQ25ULFlBQVlkLGNBQWNxRjtnQkFDbkUrSCxTQUFTLElBQUksQ0FBQzBCLGtCQUFrQixDQUFDOU87Z0JBQ2pDK08sZUFBZSxJQUFJLENBQUNDLHdCQUF3QixDQUFDalA7Z0JBQzdDa1AsUUFBUSxJQUFJLENBQUNpRixtQkFBbUIsQ0FBQ3BULFlBQVl1RTtZQUMvQztRQUNGO0lBQ0Y7SUFFUThPLG9CQUFvQnJULFVBQWtCLEVBQUVkLFlBQW9CLEVBQUVxRixNQUFnQixFQUFFd0QsV0FBbUIsRUFBWTtRQUNySCx5Q0FBeUM7UUFDekMsTUFBTXVMLGVBQWU7WUFDbkIvTyxRQUFRQTtZQUNSd0QsYUFBYUE7WUFDYlEsZUFBZTtRQUNqQjtRQUVBLE9BQU8sSUFBSSxDQUFDK0IsMkJBQTJCLENBQUNwTCxjQUFjb1UsY0FBYztZQUFFaEwsT0FBTy9ELE1BQU0sQ0FBQyxFQUFFLElBQUk7UUFBVTtJQUN0RztJQUVBLHVDQUF1QztJQUMvQmdQLDRCQUE0QnhULE1BQThCLEVBQW1CO1FBQ25GLE1BQU0sRUFBRWQsVUFBVSxFQUFFZSxVQUFVLEVBQUVkLFlBQVksRUFBRUMsY0FBYyxFQUFFLEdBQUdZO1FBRWpFLE9BQU87WUFDTEM7WUFDQWQ7WUFDQUM7WUFDQWdELFVBQVU7Z0JBQ1JJLFFBQVE7b0JBQUM7b0JBQThDO29CQUFxQztpQkFBZ0M7Z0JBQzVIRSxZQUFZLEVBQUU7Z0JBQ2RzSixTQUFTOU0sV0FBV00sU0FBUyxDQUFDLEdBQUc7Z0JBQ2pDb08sZUFBZTtvQkFBQztvQkFBMEI7aUJBQWlDO2dCQUMzRTNKLGtCQUFrQixJQUFJLENBQUM2SixnQ0FBZ0MsQ0FBQyxjQUFjM08sY0FBYyxFQUFFO2dCQUN0RmdGLGlCQUFpQixJQUFJLENBQUM0SiwrQkFBK0IsQ0FBQyxjQUFjNU8sY0FBYyxFQUFFO2dCQUNwRnlNLFlBQVk7b0JBQUM7b0JBQXlCO2lCQUE2QjtnQkFDbkVXLFNBQVMsSUFBSSxDQUFDMEIsa0JBQWtCLENBQUM5TztnQkFDakMrTyxlQUFlO29CQUFFdEksTUFBTTtvQkFBV2lMLEtBQUs7b0JBQWVDLFVBQVU7Z0JBQTJCO2dCQUMzRjFDLFFBQVE7b0JBQUM7b0JBQXVCO2lCQUE0QjtZQUM5RDtRQUNGO0lBQ0Y7SUFFUThFLDRCQUE0QmpOLElBQVksRUFBRTlHLFlBQW9CLEVBQUVxRixNQUFnQixFQUFFO1FBQ3hGLE1BQU05QixhQUFhLElBQUksQ0FBQ2dMLGlCQUFpQixDQUFDekgsTUFBTTlHO1FBRWhELDBDQUEwQztRQUMxQyxJQUFJcUYsT0FBTzdFLE1BQU0sR0FBRyxHQUFHO1lBQ3JCLE9BQU8rQyxXQUFXbUMsR0FBRyxDQUFDLENBQUM4RixPQUFPeUcsUUFBVztvQkFDdkMsR0FBR3pHLEtBQUs7b0JBQ1I4SSxTQUFTckMsUUFBUTVNLE9BQU83RSxNQUFNLEdBQUcsQ0FBQyxXQUFXLEVBQUU2RSxNQUFNLENBQUM0TSxNQUFNLENBQUNuTSxXQUFXLEdBQUcsQ0FBQyxHQUFHMEYsTUFBTTlFLE9BQU87Z0JBQzlGO1FBQ0Y7UUFFQSxPQUFPbkQ7SUFDVDtJQUVReVEsMkJBQTJCbFQsVUFBa0IsRUFBRWQsWUFBb0IsRUFBRXFGLE1BQWdCLEVBQVk7UUFDdkcsTUFBTWtQLGdCQUFnQixJQUFJLENBQUM3Rix3QkFBd0IsQ0FBQzVOLFlBQVlkO1FBRWhFLElBQUlxRixPQUFPN0UsTUFBTSxHQUFHLEdBQUc7WUFDckIsT0FBTztnQkFDTCxDQUFDLDZCQUE2QixFQUFFNkUsTUFBTSxDQUFDLEVBQUUsRUFBRVMsY0FBYyxDQUFDLENBQUM7Z0JBQzNELENBQUMsMEJBQTBCLEVBQUVULE1BQU0sQ0FBQyxFQUFFLEVBQUVTLGlCQUFpQixZQUFZLENBQUMsQ0FBQztnQkFDdkU7Z0JBQ0E7YUFDRDtRQUNIO1FBRUEsT0FBT3lPO0lBQ1Q7SUFFUU4sd0JBQXdCblQsVUFBa0IsRUFBRWQsWUFBb0IsRUFBRXFGLE1BQWdCLEVBQVk7UUFDcEcsTUFBTWtQLGdCQUFnQixJQUFJLENBQUMxRixxQkFBcUIsQ0FBQy9OLFlBQVlkO1FBRTdELElBQUlxRixPQUFPN0UsTUFBTSxHQUFHLEdBQUc7WUFDckIsT0FBTztnQkFDTCxDQUFDLDJCQUEyQixFQUFFNkUsTUFBTSxDQUFDLEVBQUUsRUFBRVMsY0FBYyxDQUFDLENBQUM7Z0JBQ3pELENBQUMsMkNBQTJDLEVBQUVULE1BQU0sQ0FBQyxFQUFFLEVBQUVTLGlCQUFpQixhQUFhLENBQUMsQ0FBQztnQkFDekYsQ0FBQyxvREFBb0QsRUFBRVQsTUFBTSxDQUFDLEVBQUUsRUFBRVMsY0FBYyxDQUFDLENBQUM7YUFDbkY7UUFDSDtRQUVBLE9BQU95TztJQUNUO0lBRVFMLG9CQUFvQnBULFVBQWtCLEVBQUV1RSxNQUFnQixFQUFZO1FBQzFFLElBQUlBLE9BQU83RSxNQUFNLEdBQUcsR0FBRztZQUNyQixPQUFPO2dCQUNMLENBQUMsd0NBQXdDLEVBQUU2RSxNQUFNLENBQUMsRUFBRSxFQUFFUyxjQUFjLENBQUMsQ0FBQztnQkFDdEUsQ0FBQyxxQkFBcUIsRUFBRVQsTUFBTSxDQUFDLEVBQUUsRUFBRVMsaUJBQWlCLGFBQWEsb0JBQW9CLENBQUM7Z0JBQ3RGO2dCQUNBO2FBQ0Q7UUFDSDtRQUVBLE9BQU8sSUFBSSxDQUFDb0osaUJBQWlCLENBQUNwTztJQUNoQztJQUVBLHVDQUF1QztJQUMvQjZOLGlDQUFpQzdELEtBQWEsRUFBRTlLLFlBQW9CLEVBQUV5SSxlQUF5QixFQUFPO1FBQzVHLE1BQU0rTCxpQkFBaUI7WUFDckIsTUFBTTtnQkFDSnBPLGFBQWE7Z0JBQ2JxTyxVQUFVO29CQUNSO3dCQUFFQyxXQUFXO3dCQUFXL08sTUFBTSxDQUFDLHNCQUFzQixFQUFFbUYsTUFBTSxDQUFDLENBQUM7b0JBQUM7b0JBQ2hFO3dCQUFFNEosV0FBVzt3QkFBUy9PLE1BQU0sQ0FBQyw2Q0FBNkMsRUFBRW1GLE1BQU0sQ0FBQyxDQUFDO29CQUFDO29CQUNyRjt3QkFBRTRKLFdBQVc7d0JBQVcvTyxNQUFNO29CQUF1QjtvQkFDckQ7d0JBQUUrTyxXQUFXO3dCQUFTL08sTUFBTSxDQUFDLGNBQWMsRUFBRW1GLE1BQU0sVUFBVSxDQUFDO29CQUFDO2lCQUNoRTtnQkFDRDZKLG1CQUFtQjtvQkFDakIsQ0FBQyw4QkFBOEIsRUFBRTdKLE1BQU0sQ0FBQyxDQUFDO29CQUN6QztvQkFDQTtpQkFDRDtZQUNIO1lBQ0EsTUFBTTtnQkFDSjFFLGFBQWE7Z0JBQ2JxTyxVQUFVO29CQUNSO3dCQUFFQyxXQUFXO3dCQUFXL08sTUFBTSxDQUFDLHdCQUF3QixFQUFFbUYsTUFBTSx5QkFBeUIsQ0FBQztvQkFBQztvQkFDMUY7d0JBQUU0SixXQUFXO3dCQUFTL08sTUFBTSxDQUFDLHlDQUF5QyxFQUFFbUYsTUFBTSxDQUFDLENBQUM7b0JBQUM7b0JBQ2pGO3dCQUFFNEosV0FBVzt3QkFBVy9PLE1BQU07b0JBQWtEO29CQUNoRjt3QkFBRStPLFdBQVc7d0JBQVMvTyxNQUFNLENBQUMscUNBQXFDLEVBQUVtRixNQUFNLENBQUMsQ0FBQztvQkFBQztpQkFDOUU7Z0JBQ0Q2SixtQkFBbUI7b0JBQ2pCLENBQUMsU0FBUyxFQUFFN0osTUFBTSwyQkFBMkIsQ0FBQztvQkFDOUM7b0JBQ0E7aUJBQ0Q7WUFDSDtZQUNBLE1BQU07Z0JBQ0oxRSxhQUFhO2dCQUNicU8sVUFBVTtvQkFDUjt3QkFBRUMsV0FBVzt3QkFBVy9PLE1BQU0sQ0FBQyx5QkFBeUIsRUFBRW1GLE1BQU0sc0JBQXNCLENBQUM7b0JBQUM7b0JBQ3hGO3dCQUFFNEosV0FBVzt3QkFBUy9PLE1BQU0sQ0FBQyx3Q0FBd0MsRUFBRW1GLE1BQU0sbUJBQW1CLENBQUM7b0JBQUM7b0JBQ2xHO3dCQUFFNEosV0FBVzt3QkFBVy9PLE1BQU07b0JBQThEO29CQUM1Rjt3QkFBRStPLFdBQVc7d0JBQVMvTyxNQUFNLENBQUMsdUVBQXVFLEVBQUVtRixNQUFNLENBQUMsQ0FBQztvQkFBQztpQkFDaEg7Z0JBQ0Q2SixtQkFBbUI7b0JBQ2pCLENBQUMsNkNBQTZDLEVBQUU3SixNQUFNLENBQUMsQ0FBQztvQkFDeEQ7b0JBQ0E7aUJBQ0Q7WUFDSDtZQUNBLE1BQU07Z0JBQ0oxRSxhQUFhO2dCQUNicU8sVUFBVTtvQkFDUjt3QkFBRUMsV0FBVzt3QkFBVy9PLE1BQU0sQ0FBQyxrQkFBa0IsRUFBRW1GLE1BQU0sb0RBQW9ELENBQUM7b0JBQUM7b0JBQy9HO3dCQUFFNEosV0FBVzt3QkFBUy9PLE1BQU0sQ0FBQyw4REFBOEQsRUFBRW1GLE1BQU0sQ0FBQyxDQUFDO29CQUFDO29CQUN0Rzt3QkFBRTRKLFdBQVc7d0JBQVcvTyxNQUFNO29CQUFzRTtvQkFDcEc7d0JBQUUrTyxXQUFXO3dCQUFTL08sTUFBTSxDQUFDLHdDQUF3QyxFQUFFbUYsTUFBTSxDQUFDLENBQUM7b0JBQUM7aUJBQ2pGO2dCQUNENkosbUJBQW1CO29CQUNqQixDQUFDLHNEQUFzRCxFQUFFN0osTUFBTSxDQUFDLENBQUM7b0JBQ2pFO29CQUNBO2lCQUNEO1lBQ0g7WUFDQSxNQUFNO2dCQUNKMUUsYUFBYTtnQkFDYnFPLFVBQVU7b0JBQ1I7d0JBQUVDLFdBQVc7d0JBQVcvTyxNQUFNLENBQUMsc0JBQXNCLEVBQUVtRixNQUFNLGtEQUFrRCxDQUFDO29CQUFDO29CQUNqSDt3QkFBRTRKLFdBQVc7d0JBQVMvTyxNQUFNLENBQUMsZ0VBQWdFLEVBQUVtRixNQUFNLENBQUMsQ0FBQztvQkFBQztvQkFDeEc7d0JBQUU0SixXQUFXO3dCQUFXL08sTUFBTTtvQkFBZ0Y7b0JBQzlHO3dCQUFFK08sV0FBVzt3QkFBUy9PLE1BQU0sQ0FBQywrREFBK0QsRUFBRW1GLE1BQU0sQ0FBQyxDQUFDO29CQUFDO2lCQUN4RztnQkFDRDZKLG1CQUFtQjtvQkFDakIsQ0FBQyw4REFBOEQsRUFBRTdKLE1BQU0sQ0FBQyxDQUFDO29CQUN6RTtvQkFDQTtpQkFDRDtZQUNIO1FBQ0Y7UUFFQSxPQUFPMEosY0FBYyxDQUFDeFUsYUFBNEMsSUFBSXdVLGNBQWMsQ0FBQyxLQUFLO0lBQzVGO0lBRVE1RixnQ0FBZ0M5RCxLQUFhLEVBQUU5SyxZQUFvQixFQUFFeUksZUFBeUIsRUFBTztRQUMzRyxNQUFNbU0sb0JBQW9CO1lBQ3hCLE1BQU07Z0JBQ0p4TyxhQUFhO2dCQUNicU8sVUFBVTtvQkFDUjt3QkFBRUMsV0FBVzt3QkFBVy9PLE1BQU0sQ0FBQyx1QkFBdUIsRUFBRW1GLE1BQU0sQ0FBQyxDQUFDO3dCQUFFK0osT0FBTztvQkFBSztvQkFDOUU7d0JBQUVILFdBQVc7d0JBQVMvTyxNQUFNLENBQUMsMENBQTBDLENBQUM7d0JBQUVrUCxPQUFPO29CQUFLO29CQUN0Rjt3QkFBRUgsV0FBVzt3QkFBVy9PLE1BQU07d0JBQTRCa1AsT0FBTztvQkFBSztvQkFDdEU7d0JBQUVILFdBQVc7d0JBQVMvTyxNQUFNLENBQUMscUJBQXFCLENBQUM7d0JBQUVrUCxPQUFPO29CQUFLO2lCQUNsRTtnQkFDREMsU0FBUztvQkFBQztvQkFBUTtvQkFBTTtvQkFBSztpQkFBUTtZQUN2QztZQUNBLE1BQU07Z0JBQ0oxTyxhQUFhO2dCQUNicU8sVUFBVTtvQkFDUjt3QkFBRUMsV0FBVzt3QkFBVy9PLE1BQU0sQ0FBQyxzQkFBc0IsRUFBRW1GLE1BQU0sQ0FBQyxDQUFDO3dCQUFFK0osT0FBTztvQkFBSztvQkFDN0U7d0JBQUVILFdBQVc7d0JBQVMvTyxNQUFNLENBQUMsb0NBQW9DLENBQUM7d0JBQUVrUCxPQUFPO29CQUFLO29CQUNoRjt3QkFBRUgsV0FBVzt3QkFBVy9PLE1BQU07d0JBQTRCa1AsT0FBTztvQkFBSztvQkFDdEU7d0JBQUVILFdBQVc7d0JBQVMvTyxNQUFNLENBQUMsK0JBQStCLENBQUM7d0JBQUVrUCxPQUFPO29CQUFLO2lCQUM1RTtnQkFDREMsU0FBUztvQkFBQztvQkFBVztvQkFBUTtvQkFBVztpQkFBUTtZQUNsRDtZQUNBLE1BQU07Z0JBQ0oxTyxhQUFhO2dCQUNicU8sVUFBVTtvQkFDUjt3QkFBRUMsV0FBVzt3QkFBVy9PLE1BQU0sQ0FBQyxzQkFBc0IsRUFBRW1GLE1BQU0sc0JBQXNCLENBQUM7d0JBQUUrSixPQUFPO29CQUFLO29CQUNsRzt3QkFBRUgsV0FBVzt3QkFBUy9PLE1BQU0sQ0FBQyw2QkFBNkIsQ0FBQzt3QkFBRWtQLE9BQU87b0JBQUs7b0JBQ3pFO3dCQUFFSCxXQUFXO3dCQUFXL08sTUFBTTt3QkFBd0NrUCxPQUFPO29CQUFLO29CQUNsRjt3QkFBRUgsV0FBVzt3QkFBUy9PLE1BQU0sQ0FBQyxpQ0FBaUMsQ0FBQzt3QkFBRWtQLE9BQU87b0JBQUs7aUJBQzlFO2dCQUNEQyxTQUFTO29CQUFDO29CQUFZO29CQUFXO29CQUFXO2lCQUFZO1lBQzFEO1lBQ0EsTUFBTTtnQkFDSjFPLGFBQWE7Z0JBQ2JxTyxVQUFVO29CQUNSO3dCQUFFQyxXQUFXO3dCQUFXL08sTUFBTSxDQUFDLGFBQWEsRUFBRW1GLE1BQU0sMkJBQTJCLENBQUM7d0JBQUUrSixPQUFPO29CQUFLO29CQUM5Rjt3QkFBRUgsV0FBVzt3QkFBUy9PLE1BQU0sQ0FBQyx1Q0FBdUMsQ0FBQzt3QkFBRWtQLE9BQU87b0JBQUs7b0JBQ25GO3dCQUFFSCxXQUFXO3dCQUFXL08sTUFBTTt3QkFBMENrUCxPQUFPO29CQUFLO29CQUNwRjt3QkFBRUgsV0FBVzt3QkFBUy9PLE1BQU0sQ0FBQyxrQ0FBa0MsQ0FBQzt3QkFBRWtQLE9BQU87b0JBQUs7aUJBQy9FO2dCQUNEQyxTQUFTO29CQUFDO29CQUFjO29CQUFnQjtvQkFBWTtpQkFBVztZQUNqRTtZQUNBLE1BQU07Z0JBQ0oxTyxhQUFhO2dCQUNicU8sVUFBVTtvQkFDUjt3QkFBRUMsV0FBVzt3QkFBVy9PLE1BQU0sQ0FBQyxvQkFBb0IsRUFBRW1GLE1BQU0saUNBQWlDLENBQUM7d0JBQUUrSixPQUFPO29CQUFLO29CQUMzRzt3QkFBRUgsV0FBVzt3QkFBUy9PLE1BQU0sQ0FBQyw2Q0FBNkMsQ0FBQzt3QkFBRWtQLE9BQU87b0JBQUs7b0JBQ3pGO3dCQUFFSCxXQUFXO3dCQUFXL08sTUFBTTt3QkFBMkNrUCxPQUFPO29CQUFLO29CQUNyRjt3QkFBRUgsV0FBVzt3QkFBUy9PLE1BQU0sQ0FBQyw0Q0FBNEMsQ0FBQzt3QkFBRWtQLE9BQU87b0JBQUs7aUJBQ3pGO2dCQUNEQyxTQUFTO29CQUFDO29CQUFXO29CQUFhO29CQUFhO2lCQUFhO1lBQzlEO1FBQ0Y7UUFFQSxPQUFPRixpQkFBaUIsQ0FBQzVVLGFBQStDLElBQUk0VSxpQkFBaUIsQ0FBQyxLQUFLO0lBQ3JHOzthQXB3RFFqVixXQUFrRTthQUNsRUUsdUJBQXdEOztBQW93RGxFO0FBRU8sTUFBTWtWLDBCQUEwQixJQUFJdFYsMEJBQXlCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktdjAtcHJvamVjdC8uL2xpYi9sZXNzb24tYWktZ2VuZXJhdG9yLXNlcnZlci50cz8wYmIxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG1ldGFkYXRhIH0gZnJvbSBcIkAvYXBwL2xheW91dFwiXHJcbmltcG9ydCB7IGNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZSB9IGZyb20gXCIuL2dvb2dsZS1haS1zZXJ2ZXJcIlxyXG5pbXBvcnQgeyBQcm9ncmVzc2l2ZUdlbmVyYXRvckltcGwsIHR5cGUgQ0VGUkxldmVsLCB0eXBlIExlc3NvblNlY3Rpb24sIHR5cGUgUHJvZ3Jlc3NDYWxsYmFjayB9IGZyb20gXCIuL3Byb2dyZXNzaXZlLWdlbmVyYXRvclwiXHJcbmltcG9ydCB7IHVzYWdlTW9uaXRvciwgdHlwZSBHZW5lcmF0aW9uQ29udGV4dCB9IGZyb20gXCIuL3VzYWdlLW1vbml0b3JcIlxyXG5cclxuaW50ZXJmYWNlIExlc3NvbkdlbmVyYXRpb25QYXJhbXMge1xyXG4gIHNvdXJjZVRleHQ6IHN0cmluZ1xyXG4gIGxlc3NvblR5cGU6IHN0cmluZ1xyXG4gIHN0dWRlbnRMZXZlbDogc3RyaW5nXHJcbiAgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZ1xyXG4gIHNvdXJjZVVybD86IHN0cmluZ1xyXG4gIGNvbnRlbnRNZXRhZGF0YT86IHtcclxuICAgIHRpdGxlPzogc3RyaW5nXHJcbiAgICBkZXNjcmlwdGlvbj86IHN0cmluZ1xyXG4gICAgYXV0aG9yPzogc3RyaW5nXHJcbiAgICBwdWJsaXNoRGF0ZT86IHN0cmluZ1xyXG4gICAgY29udGVudFR5cGU/OiBzdHJpbmdcclxuICAgIGRvbWFpbj86IHN0cmluZ1xyXG4gICAgbGFuZ3VhZ2U/OiBzdHJpbmdcclxuICAgIGtleXdvcmRzPzogc3RyaW5nW11cclxuICAgIGJhbm5lckltYWdlcz86IEFycmF5PHtcclxuICAgICAgc3JjOiBzdHJpbmdcclxuICAgICAgYWx0OiBzdHJpbmdcclxuICAgICAgdHlwZTogJ21ldGEnIHwgJ2NvbnRlbnQnXHJcbiAgICAgIHByaW9yaXR5OiBudW1iZXJcclxuICAgICAgd2lkdGg/OiBudW1iZXIgfCBudWxsXHJcbiAgICAgIGhlaWdodD86IG51bWJlciB8IG51bGxcclxuICAgIH0+XHJcbiAgfVxyXG4gIHN0cnVjdHVyZWRDb250ZW50Pzoge1xyXG4gICAgaGVhZGluZ3M/OiBBcnJheTx7IGxldmVsOiBudW1iZXI7IHRleHQ6IHN0cmluZyB9PlxyXG4gICAgcGFyYWdyYXBocz86IHN0cmluZ1tdXHJcbiAgICBsaXN0cz86IEFycmF5PHsgdHlwZTogc3RyaW5nOyBpdGVtczogc3RyaW5nW10gfT5cclxuICAgIHF1b3Rlcz86IHN0cmluZ1tdXHJcbiAgICBpbWFnZXM/OiBBcnJheTx7IGFsdDogc3RyaW5nOyBzcmM6IHN0cmluZyB9PlxyXG4gICAgbGlua3M/OiBBcnJheTx7IHRleHQ6IHN0cmluZzsgdXJsOiBzdHJpbmcgfT5cclxuICB9XHJcbiAgd29yZENvdW50PzogbnVtYmVyXHJcbiAgcmVhZGluZ1RpbWU/OiBudW1iZXJcclxuICBvblByb2dyZXNzPzogKHVwZGF0ZTogeyBzdGVwOiBzdHJpbmc7IHByb2dyZXNzOiBudW1iZXI7IHBoYXNlOiBzdHJpbmc7IHNlY3Rpb24/OiBzdHJpbmcgfSkgPT4gdm9pZFxyXG59XHJcblxyXG5pbnRlcmZhY2UgR2VuZXJhdGVkTGVzc29uIHtcclxuICBsZXNzb25UaXRsZTogc3RyaW5nXHJcbiAgbGVzc29uVHlwZTogc3RyaW5nXHJcbiAgc3R1ZGVudExldmVsOiBzdHJpbmdcclxuICB0YXJnZXRMYW5ndWFnZTogc3RyaW5nXHJcbiAgc2VjdGlvbnM6IHtcclxuICAgIHdhcm11cDogc3RyaW5nW11cclxuICAgIHZvY2FidWxhcnk6IEFycmF5PHsgd29yZDogc3RyaW5nOyBtZWFuaW5nOiBzdHJpbmc7IGV4YW1wbGU6IHN0cmluZyB9PlxyXG4gICAgcmVhZGluZzogc3RyaW5nXHJcbiAgICBjb21wcmVoZW5zaW9uOiBzdHJpbmdbXVxyXG4gICAgZGlzY3Vzc2lvbjogc3RyaW5nW11cclxuICAgIGRpYWxvZ3VlUHJhY3RpY2U6IHtcclxuICAgICAgaW5zdHJ1Y3Rpb246IHN0cmluZ1xyXG4gICAgICBkaWFsb2d1ZTogQXJyYXk8eyBjaGFyYWN0ZXI6IHN0cmluZzsgbGluZTogc3RyaW5nIH0+XHJcbiAgICAgIGZvbGxvd1VwUXVlc3Rpb25zOiBzdHJpbmdbXVxyXG4gICAgfVxyXG4gICAgZGlhbG9ndWVGaWxsR2FwOiB7XHJcbiAgICAgIGluc3RydWN0aW9uOiBzdHJpbmdcclxuICAgICAgZGlhbG9ndWU6IEFycmF5PHsgY2hhcmFjdGVyOiBzdHJpbmc7IGxpbmU6IHN0cmluZzsgaXNHYXA/OiBib29sZWFuIH0+XHJcbiAgICAgIGFuc3dlcnM6IHN0cmluZ1tdXHJcbiAgICB9XHJcbiAgICBncmFtbWFyOiB7XHJcbiAgICAgIGZvY3VzOiBzdHJpbmdcclxuICAgICAgZXhhbXBsZXM6IHN0cmluZ1tdXHJcbiAgICAgIGV4ZXJjaXNlOiBzdHJpbmdbXVxyXG4gICAgfVxyXG4gICAgcHJvbnVuY2lhdGlvbjoge1xyXG4gICAgICB3b3JkOiBzdHJpbmdcclxuICAgICAgaXBhOiBzdHJpbmdcclxuICAgICAgcHJhY3RpY2U6IHN0cmluZ1xyXG4gICAgfVxyXG4gICAgd3JhcHVwOiBzdHJpbmdbXVxyXG4gIH1cclxuICBtZXRhZGF0YT86IGFueSAvLyBJbmNsdWRlIG1ldGFkYXRhIGZvciBiYW5uZXIgaW1hZ2VzLCBzb3VyY2UgaW5mbywgZXRjLlxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgTGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3Ige1xyXG4gIHByaXZhdGUgZ29vZ2xlQUk6IFJldHVyblR5cGU8dHlwZW9mIGNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZT4gfCBudWxsID0gbnVsbFxyXG4gIHByaXZhdGUgcHJvZ3Jlc3NpdmVHZW5lcmF0b3I6IFByb2dyZXNzaXZlR2VuZXJhdG9ySW1wbCB8IG51bGwgPSBudWxsXHJcblxyXG4gIHByaXZhdGUgZ2V0R29vZ2xlQUkoKSB7XHJcbiAgICBpZiAoIXRoaXMuZ29vZ2xlQUkpIHtcclxuICAgICAgdGhpcy5nb29nbGVBSSA9IGNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZSgpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5nb29nbGVBSVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRQcm9ncmVzc2l2ZUdlbmVyYXRvcigpIHtcclxuICAgIGlmICghdGhpcy5wcm9ncmVzc2l2ZUdlbmVyYXRvcikge1xyXG4gICAgICB0aGlzLnByb2dyZXNzaXZlR2VuZXJhdG9yID0gbmV3IFByb2dyZXNzaXZlR2VuZXJhdG9ySW1wbCgpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5wcm9ncmVzc2l2ZUdlbmVyYXRvclxyXG4gIH1cclxuXHJcbiAgLy8gU3VtbWFyaXplIGFuZCBhZGFwdCBjb250ZW50IHRvIHN0dWRlbnQgbGV2ZWxcclxuICBwcml2YXRlIGFzeW5jIHN1bW1hcml6ZUFuZEFkYXB0Q29udGVudChzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nLCB0YXJnZXRMYW5ndWFnZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGxldmVsR3VpZGFuY2UgPSB7XHJcbiAgICAgICAgJ0ExJzogJ1VzZSB2ZXJ5IHNpbXBsZSB2b2NhYnVsYXJ5LCBwcmVzZW50IHRlbnNlLCBzaG9ydCBzZW50ZW5jZXMgKDUtOCB3b3JkcykuIEV4cGxhaW4gYmFzaWMgY29uY2VwdHMgY2xlYXJseS4nLFxyXG4gICAgICAgICdBMic6ICdVc2Ugc2ltcGxlIHZvY2FidWxhcnksIGJhc2ljIHBhc3QvcHJlc2VudCB0ZW5zZSwgbWVkaXVtIHNlbnRlbmNlcyAoOC0xMiB3b3JkcykuIEluY2x1ZGUgZmFtaWxpYXIgdG9waWNzLicsXHJcbiAgICAgICAgJ0IxJzogJ1VzZSBpbnRlcm1lZGlhdGUgdm9jYWJ1bGFyeSwgdmFyaW91cyB0ZW5zZXMsIGxvbmdlciBzZW50ZW5jZXMgKDEyLTE1IHdvcmRzKS4gSW5jbHVkZSBvcGluaW9ucyBhbmQgZXhwbGFuYXRpb25zLicsXHJcbiAgICAgICAgJ0IyJzogJ1VzZSBhZHZhbmNlZCB2b2NhYnVsYXJ5LCBjb21wbGV4IHNlbnRlbmNlcywgYWJzdHJhY3QgY29uY2VwdHMuIEluY2x1ZGUgZGV0YWlsZWQgZXhwbGFuYXRpb25zIGFuZCBhbmFseXNpcy4nLFxyXG4gICAgICAgICdDMSc6ICdVc2Ugc29waGlzdGljYXRlZCB2b2NhYnVsYXJ5LCBjb21wbGV4IHN0cnVjdHVyZXMsIG51YW5jZWQgaWRlYXMuIEluY2x1ZGUgY3VsdHVyYWwgYW5kIGNvbnRleHR1YWwgZGVwdGguJ1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBndWlkYW5jZSA9IGxldmVsR3VpZGFuY2Vbc3R1ZGVudExldmVsXSB8fCBsZXZlbEd1aWRhbmNlWydCMSddXHJcblxyXG4gICAgICBjb25zdCBwcm9tcHQgPSBgU3VtbWFyaXplIGFuZCByZXdyaXRlIHRoaXMgY29udGVudCBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsICR7dGFyZ2V0TGFuZ3VhZ2V9IHN0dWRlbnRzOlxyXG5cclxuJHtzb3VyY2VUZXh0LnN1YnN0cmluZygwLCAxMDAwKX1cclxuXHJcblJFUVVJUkVNRU5UUzpcclxuLSAke2d1aWRhbmNlfVxyXG4tIEtlZXAgYWxsIGltcG9ydGFudCBpbmZvcm1hdGlvbiBhbmQga2V5IGNvbmNlcHRzXHJcbi0gTWFrZSBpdCAyMDAtNDAwIHdvcmRzIChhcHByb3ByaWF0ZSBsZW5ndGggZm9yIHJlYWRpbmcpXHJcbi0gVXNlIHZvY2FidWxhcnkgYXBwcm9wcmlhdGUgZm9yICR7c3R1ZGVudExldmVsfSBsZXZlbFxyXG4tIE1haW50YWluIHRoZSBtYWluIGlkZWFzIGJ1dCBzaW1wbGlmeSBjb21wbGV4IGxhbmd1YWdlXHJcbi0gSW5jbHVkZSBzcGVjaWZpYyBkZXRhaWxzIGFuZCBleGFtcGxlc1xyXG4tIE1ha2UgaXQgZW5nYWdpbmcgYW5kIGVkdWNhdGlvbmFsXHJcblxyXG5SZXdyaXRlIHRoZSBjb250ZW50IGNsZWFybHkgYW5kIGNvbXBsZXRlbHk6YFxyXG5cclxuICAgICAgY29uc29sZS5sb2coXCLwn5OdIENvbnRlbnQgYWRhcHRhdGlvbiBwcm9tcHQ6XCIsIHByb21wdC5sZW5ndGgsIFwiY2hhcnNcIilcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcclxuXHJcbiAgICAgIHJldHVybiByZXNwb25zZS50cmltKCkgfHwgc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgNDAwKVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5sb2coXCLimqDvuI8gQ29udGVudCBhZGFwdGF0aW9uIGZhaWxlZCwgdXNpbmcgb3JpZ2luYWwgdGV4dFwiKVxyXG4gICAgICByZXR1cm4gc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgNDAwKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZ2VuZXJhdGVMZXNzb24ocGFyYW1zOiBMZXNzb25HZW5lcmF0aW9uUGFyYW1zKTogUHJvbWlzZTxHZW5lcmF0ZWRMZXNzb24+IHtcclxuICAgIGNvbnN0IHtcclxuICAgICAgc291cmNlVGV4dCxcclxuICAgICAgbGVzc29uVHlwZSxcclxuICAgICAgc3R1ZGVudExldmVsLFxyXG4gICAgICB0YXJnZXRMYW5ndWFnZSxcclxuICAgICAgc291cmNlVXJsLFxyXG4gICAgICBjb250ZW50TWV0YWRhdGEsXHJcbiAgICAgIHN0cnVjdHVyZWRDb250ZW50LFxyXG4gICAgICB3b3JkQ291bnQsXHJcbiAgICAgIHJlYWRpbmdUaW1lLFxyXG4gICAgICBvblByb2dyZXNzXHJcbiAgICB9ID0gcGFyYW1zXHJcblxyXG4gICAgLy8gQ3JlYXRlIHVzYWdlIG1vbml0b3JpbmcgY29udGV4dFxyXG4gICAgY29uc3QgZ2VuZXJhdGlvbkNvbnRleHQ6IEdlbmVyYXRpb25Db250ZXh0ID0ge1xyXG4gICAgICBsZXNzb25JZDogYGxlc3Nvbl8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWAsXHJcbiAgICAgIGxlc3NvblR5cGUsXHJcbiAgICAgIGRpZmZpY3VsdHlMZXZlbDogc3R1ZGVudExldmVsLFxyXG4gICAgICBjb250ZW50TGVuZ3RoOiBzb3VyY2VUZXh0Lmxlbmd0aCxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFZhbGlkYXRlIHNvdXJjZVRleHRcclxuICAgIGlmICghc291cmNlVGV4dCB8fCB0eXBlb2Ygc291cmNlVGV4dCAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBzb3VyY2VUZXh0OiBtdXN0IGJlIGEgbm9uLWVtcHR5IHN0cmluZ1wiKVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnNvbGUubG9nKFwi8J+agCBTdGFydGluZyBsZXNzb24gZ2VuZXJhdGlvbiB3aXRoIHBhcmFtczpcIiwge1xyXG4gICAgICB0ZXh0TGVuZ3RoOiBzb3VyY2VUZXh0Lmxlbmd0aCxcclxuICAgICAgbGVzc29uVHlwZSxcclxuICAgICAgc3R1ZGVudExldmVsLFxyXG4gICAgICB0YXJnZXRMYW5ndWFnZSxcclxuICAgICAgaGFzTWV0YWRhdGE6ICEhY29udGVudE1ldGFkYXRhLFxyXG4gICAgICBoYXNTdHJ1Y3R1cmVkQ29udGVudDogISFzdHJ1Y3R1cmVkQ29udGVudFxyXG4gICAgfSlcclxuXHJcblxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIFN0ZXAgMTogU3VtbWFyaXplIGFuZCBhZGFwdCBjb250ZW50IHRvIHN0dWRlbnQgbGV2ZWxcclxuICAgICAgY29uc29sZS5sb2coXCLwn5OdIFN0ZXAgMTogU3VtbWFyaXppbmcgYW5kIGFkYXB0aW5nIGNvbnRlbnQgdG8gc3R1ZGVudCBsZXZlbC4uLlwiKVxyXG4gICAgICBjb25zdCBhZGFwdGF0aW9uU3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgY29uc3QgYWRhcHRlZENvbnRlbnQgPSBhd2FpdCB0aGlzLnN1bW1hcml6ZUFuZEFkYXB0Q29udGVudChzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwsIHRhcmdldExhbmd1YWdlKVxyXG4gICAgICBjb25zdCBhZGFwdGF0aW9uRW5kVGltZSA9IERhdGUubm93KCk7XHJcblxyXG4gICAgICAvLyBMb2cgY29udGVudCBhZGFwdGF0aW9uIHVzYWdlXHJcbiAgICAgIHVzYWdlTW9uaXRvci5sb2dUb2tlblVzYWdlKFxyXG4gICAgICAgICdjb250ZW50LWFkYXB0YXRpb24nLFxyXG4gICAgICAgIE1hdGguY2VpbChzb3VyY2VUZXh0Lmxlbmd0aCAvIDQpLCAvLyBSb3VnaCB0b2tlbiBlc3RpbWF0ZVxyXG4gICAgICAgICdjb250ZW50LXN1bW1hcml6YXRpb24nLFxyXG4gICAgICAgIGdlbmVyYXRpb25Db250ZXh0XHJcbiAgICAgICk7XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhcIuKchSBDb250ZW50IGFkYXB0ZWQ6XCIsIGFkYXB0ZWRDb250ZW50Lmxlbmd0aCwgXCJjaGFyc1wiKVxyXG5cclxuICAgICAgLy8gU3RlcCAyOiBHZW5lcmF0ZSBsZXNzb24gd2l0aCBhZGFwdGVkIGNvbnRlbnRcclxuICAgICAgY29uc29sZS5sb2coXCLwn6SWIFN0ZXAgMjogR2VuZXJhdGluZyBsZXNzb24gd2l0aCBhZGFwdGVkIGNvbnRlbnQuLi5cIilcclxuICAgICAgY29uc3QgbGVzc29uR2VuZXJhdGlvblN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgIGNvbnN0IGxlc3NvblN0cnVjdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVNaW5pbWFsQUlMZXNzb24oXHJcbiAgICAgICAgYWRhcHRlZENvbnRlbnQsXHJcbiAgICAgICAgbGVzc29uVHlwZSxcclxuICAgICAgICBzdHVkZW50TGV2ZWwsXHJcbiAgICAgICAgdGFyZ2V0TGFuZ3VhZ2UsXHJcbiAgICAgICAgY29udGVudE1ldGFkYXRhLFxyXG4gICAgICAgIG9uUHJvZ3Jlc3NcclxuICAgICAgKVxyXG4gICAgICBjb25zdCBsZXNzb25HZW5lcmF0aW9uRW5kVGltZSA9IERhdGUubm93KCk7XHJcblxyXG4gICAgICAvLyBMb2cgbGVzc29uIGdlbmVyYXRpb24gdXNhZ2VcclxuICAgICAgdXNhZ2VNb25pdG9yLmxvZ1Rva2VuVXNhZ2UoXHJcbiAgICAgICAgJ2xlc3Nvbi1zdHJ1Y3R1cmUtZ2VuZXJhdGlvbicsXHJcbiAgICAgICAgTWF0aC5jZWlsKGFkYXB0ZWRDb250ZW50Lmxlbmd0aCAvIDMpLCAvLyBSb3VnaCB0b2tlbiBlc3RpbWF0ZSBmb3IgbGVzc29uIGdlbmVyYXRpb25cclxuICAgICAgICAnc3RydWN0dXJlZC1nZW5lcmF0aW9uJyxcclxuICAgICAgICBnZW5lcmF0aW9uQ29udGV4dFxyXG4gICAgICApO1xyXG5cclxuICAgICAgY29uc29sZS5sb2coXCLinIUgTWluaW1hbCBBSSBsZXNzb24gZ2VuZXJhdGVkOlwiLCBPYmplY3Qua2V5cyhsZXNzb25TdHJ1Y3R1cmUpKVxyXG5cclxuICAgICAgLy8gUmV0dXJuIHByb3Blcmx5IHN0cnVjdHVyZWQgR2VuZXJhdGVkTGVzc29uIG9iamVjdCB3aXRoIG1ldGFkYXRhXHJcbiAgICAgIGNvbnN0IGZpbmFsTGVzc29uOiBHZW5lcmF0ZWRMZXNzb24gPSB7XHJcbiAgICAgICAgbGVzc29uVGl0bGU6IGxlc3NvblN0cnVjdHVyZS5sZXNzb25UaXRsZSxcclxuICAgICAgICBsZXNzb25UeXBlLFxyXG4gICAgICAgIHN0dWRlbnRMZXZlbCxcclxuICAgICAgICB0YXJnZXRMYW5ndWFnZSxcclxuICAgICAgICBzZWN0aW9uczogbGVzc29uU3RydWN0dXJlLFxyXG4gICAgICAgIG1ldGFkYXRhOiBtZXRhZGF0YSB8fCB1bmRlZmluZWQgLy8gSW5jbHVkZSBtZXRhZGF0YSBmb3IgYmFubmVyIGltYWdlcywgZXRjLlxyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhcIvCfjq8gUmV0dXJuaW5nIEFJLWdlbmVyYXRlZCBsZXNzb246XCIsIHtcclxuICAgICAgICBsZXNzb25UeXBlOiBmaW5hbExlc3Nvbi5sZXNzb25UeXBlLFxyXG4gICAgICAgIHN0dWRlbnRMZXZlbDogZmluYWxMZXNzb24uc3R1ZGVudExldmVsLFxyXG4gICAgICAgIHRhcmdldExhbmd1YWdlOiBmaW5hbExlc3Nvbi50YXJnZXRMYW5ndWFnZSxcclxuICAgICAgICBzZWN0aW9uc0NvdW50OiBPYmplY3Qua2V5cyhmaW5hbExlc3Nvbi5zZWN0aW9ucykubGVuZ3RoLFxyXG4gICAgICAgIHdhcm11cENvdW50OiBmaW5hbExlc3Nvbi5zZWN0aW9ucy53YXJtdXA/Lmxlbmd0aCB8fCAwLFxyXG4gICAgICAgIHZvY2FidWxhcnlDb3VudDogZmluYWxMZXNzb24uc2VjdGlvbnMudm9jYWJ1bGFyeT8ubGVuZ3RoIHx8IDAsXHJcbiAgICAgICAgaGFzTWV0YWRhdGE6ICEhbWV0YWRhdGEsXHJcbiAgICAgICAgaGFzQmFubmVySW1hZ2VzOiAhIW1ldGFkYXRhPy5iYW5uZXJJbWFnZXMsXHJcbiAgICAgICAgbWV0YWRhdGFLZXlzOiBtZXRhZGF0YSA/IE9iamVjdC5rZXlzKG1ldGFkYXRhKSA6IFtdLFxyXG4gICAgICAgIGJhbm5lckltYWdlc0NvdW50OiBtZXRhZGF0YT8uYmFubmVySW1hZ2VzPy5sZW5ndGggfHwgMFxyXG4gICAgICB9KVxyXG5cclxuICAgICAgY29uc29sZS5sb2coXCLwn5OmIEZ1bGwgbWV0YWRhdGEgcmVjZWl2ZWQ6XCIsIEpTT04uc3RyaW5naWZ5KG1ldGFkYXRhLCBudWxsLCAyKSlcclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+OiSBPcHRpbWl6ZWQgQUkgbGVzc29uIGdlbmVyYXRpb24gY29tcGxldGUhXCIpXHJcbiAgICAgIHJldHVybiBmaW5hbExlc3NvblxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgLy8gTG9nIGVycm9yIHRvIHVzYWdlIG1vbml0b3JcclxuICAgICAgdXNhZ2VNb25pdG9yLmxvZ0Vycm9yKGVycm9yIGFzIEVycm9yLCAnTEVTU09OX0dFTkVSQVRJT05fRkFJTEVEJywgZ2VuZXJhdGlvbkNvbnRleHQpO1xyXG5cclxuICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBFcnJvciBpbiBBSSBsZXNzb24gZ2VuZXJhdGlvbjpcIiwgZXJyb3IpXHJcbiAgICAgIHRocm93IGVycm9yXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBQcm9ncmVzc2l2ZSBBSSBsZXNzb24gZ2VuZXJhdGlvbiB3aXRoIHNoYXJlZCBjb250ZXh0XHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZU1pbmltYWxBSUxlc3NvbihcclxuICAgIHNvdXJjZVRleHQ6IHN0cmluZyxcclxuICAgIGxlc3NvblR5cGU6IHN0cmluZyxcclxuICAgIHN0dWRlbnRMZXZlbDogc3RyaW5nLFxyXG4gICAgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZyxcclxuICAgIG1ldGFkYXRhPzogYW55LFxyXG4gICAgb25Qcm9ncmVzcz86IFByb2dyZXNzQ2FsbGJhY2tcclxuICApIHtcclxuICAgIGNvbnNvbGUubG9nKFwi8J+OryBVc2luZyBwcm9ncmVzc2l2ZSBnZW5lcmF0aW9uIHdpdGggc2hhcmVkIGNvbnRleHQuLi5cIilcclxuXHJcbiAgICBjb25zdCBwcm9ncmVzc2l2ZUdlbiA9IHRoaXMuZ2V0UHJvZ3Jlc3NpdmVHZW5lcmF0b3IoKVxyXG5cclxuICAgIC8vIFNldCBwcm9ncmVzcyBjYWxsYmFjayBpZiBwcm92aWRlZFxyXG4gICAgaWYgKG9uUHJvZ3Jlc3MpIHtcclxuICAgICAgcHJvZ3Jlc3NpdmVHZW4uc2V0UHJvZ3Jlc3NDYWxsYmFjayhvblByb2dyZXNzLCBsZXNzb25UeXBlKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFN0ZXAgMTogQnVpbGQgc2hhcmVkIGNvbnRleHQgZm9yIGFsbCBzZWN0aW9uc1xyXG4gICAgY29uc29sZS5sb2coXCLwn4+X77iPIEJ1aWxkaW5nIHNoYXJlZCBjb250ZXh0Li4uXCIpXHJcbiAgICBjb25zdCBzaGFyZWRDb250ZXh0ID0gYXdhaXQgcHJvZ3Jlc3NpdmVHZW4uYnVpbGRTaGFyZWRDb250ZXh0KFxyXG4gICAgICBzb3VyY2VUZXh0LFxyXG4gICAgICBsZXNzb25UeXBlLFxyXG4gICAgICBzdHVkZW50TGV2ZWwgYXMgQ0VGUkxldmVsLFxyXG4gICAgICB0YXJnZXRMYW5ndWFnZSxcclxuICAgICAgbWV0YWRhdGEgLy8gUGFzcyBtZXRhZGF0YSBmb3IgdGl0bGUgZmFsbGJhY2tcclxuICAgIClcclxuXHJcbiAgICAvLyBTdGVwIDI6IERlZmluZSBsZXNzb24gc2VjdGlvbnMgd2l0aCBkZXBlbmRlbmNpZXNcclxuICAgIGNvbnN0IGxlc3NvblNlY3Rpb25zOiBMZXNzb25TZWN0aW9uW10gPSBbXHJcbiAgICAgIHsgbmFtZTogJ3dhcm11cCcsIHByaW9yaXR5OiAxLCBkZXBlbmRlbmNpZXM6IFtdIH0sXHJcbiAgICAgIHsgbmFtZTogJ3ZvY2FidWxhcnknLCBwcmlvcml0eTogMiwgZGVwZW5kZW5jaWVzOiBbXSB9LFxyXG4gICAgICB7IG5hbWU6ICdyZWFkaW5nJywgcHJpb3JpdHk6IDMsIGRlcGVuZGVuY2llczogWyd2b2NhYnVsYXJ5J10gfSxcclxuICAgICAgeyBuYW1lOiAnY29tcHJlaGVuc2lvbicsIHByaW9yaXR5OiA0LCBkZXBlbmRlbmNpZXM6IFsncmVhZGluZyddIH0sXHJcbiAgICAgIHsgbmFtZTogJ2Rpc2N1c3Npb24nLCBwcmlvcml0eTogNSwgZGVwZW5kZW5jaWVzOiBbJ3JlYWRpbmcnLCAnY29tcHJlaGVuc2lvbiddIH0sXHJcbiAgICAgIHsgbmFtZTogJ2dyYW1tYXInLCBwcmlvcml0eTogNiwgZGVwZW5kZW5jaWVzOiBbJ3JlYWRpbmcnXSB9LFxyXG4gICAgICB7IG5hbWU6ICdwcm9udW5jaWF0aW9uJywgcHJpb3JpdHk6IDcsIGRlcGVuZGVuY2llczogWyd2b2NhYnVsYXJ5J10gfSxcclxuICAgICAgeyBuYW1lOiAnd3JhcHVwJywgcHJpb3JpdHk6IDgsIGRlcGVuZGVuY2llczogWydkaXNjdXNzaW9uJ10gfVxyXG4gICAgXVxyXG5cclxuICAgIC8vIFN0ZXAgMzogR2VuZXJhdGUgc2VjdGlvbnMgcHJvZ3Jlc3NpdmVseVxyXG4gICAgY29uc3QgZ2VuZXJhdGVkU2VjdGlvbnMgPSBbXVxyXG4gICAgbGV0IGN1cnJlbnRDb250ZXh0ID0gc2hhcmVkQ29udGV4dFxyXG5cclxuICAgIGZvciAoY29uc3Qgc2VjdGlvbiBvZiBsZXNzb25TZWN0aW9ucykge1xyXG4gICAgICBjb25zb2xlLmxvZyhg8J+UhCBHZW5lcmF0aW5nIHNlY3Rpb246ICR7c2VjdGlvbi5uYW1lfWApXHJcblxyXG4gICAgICBjb25zdCBnZW5lcmF0ZWRTZWN0aW9uID0gYXdhaXQgcHJvZ3Jlc3NpdmVHZW4uZ2VuZXJhdGVTZWN0aW9uKFxyXG4gICAgICAgIHNlY3Rpb24sXHJcbiAgICAgICAgY3VycmVudENvbnRleHQsXHJcbiAgICAgICAgZ2VuZXJhdGVkU2VjdGlvbnNcclxuICAgICAgKVxyXG5cclxuICAgICAgZ2VuZXJhdGVkU2VjdGlvbnMucHVzaChnZW5lcmF0ZWRTZWN0aW9uKVxyXG5cclxuICAgICAgLy8gVXBkYXRlIGNvbnRleHQgd2l0aCBuZXcgc2VjdGlvbiBpbmZvcm1hdGlvblxyXG4gICAgICBjdXJyZW50Q29udGV4dCA9IHByb2dyZXNzaXZlR2VuLnVwZGF0ZUNvbnRleHQoY3VycmVudENvbnRleHQsIGdlbmVyYXRlZFNlY3Rpb24pXHJcbiAgICB9XHJcblxyXG4gICAgLy8gU3RlcCA0OiBHZW5lcmF0ZSBkaWFsb2d1ZSBzZWN0aW9ucyB1c2luZyBBSS1iYXNlZCBwcm9ncmVzc2l2ZSBnZW5lcmF0aW9uXHJcbiAgICBjb25zb2xlLmxvZyhcIvCfjq0gR2VuZXJhdGluZyBkaWFsb2d1ZSBzZWN0aW9ucyB3aXRoIEFJLi4uXCIpXHJcbiAgICBjb25zdCBkaWFsb2d1ZVByYWN0aWNlID0gYXdhaXQgcHJvZ3Jlc3NpdmVHZW4uZ2VuZXJhdGVEaWFsb2d1ZVByYWN0aWNlV2l0aENvbnRleHQoXHJcbiAgICAgIHNoYXJlZENvbnRleHQsXHJcbiAgICAgIGdlbmVyYXRlZFNlY3Rpb25zXHJcbiAgICApXHJcbiAgICBjb25zdCBkaWFsb2d1ZUZpbGxHYXAgPSBhd2FpdCBwcm9ncmVzc2l2ZUdlbi5nZW5lcmF0ZURpYWxvZ3VlRmlsbEdhcFdpdGhDb250ZXh0KFxyXG4gICAgICBzaGFyZWRDb250ZXh0LFxyXG4gICAgICBnZW5lcmF0ZWRTZWN0aW9uc1xyXG4gICAgKVxyXG5cclxuICAgIC8vIFN0ZXAgNTogQXNzZW1ibGUgZmluYWwgbGVzc29uIHN0cnVjdHVyZVxyXG4gICAgY29uc3QgbGVzc29uU3RydWN0dXJlOiBhbnkgPSB7fVxyXG5cclxuICAgIGZvciAoY29uc3Qgc2VjdGlvbiBvZiBnZW5lcmF0ZWRTZWN0aW9ucykge1xyXG4gICAgICBsZXNzb25TdHJ1Y3R1cmVbc2VjdGlvbi5zZWN0aW9uTmFtZV0gPSBzZWN0aW9uLmNvbnRlbnRcclxuICAgIH1cclxuXHJcbiAgICBsZXNzb25TdHJ1Y3R1cmUuZGlhbG9ndWVQcmFjdGljZSA9IGRpYWxvZ3VlUHJhY3RpY2VcclxuICAgIGxlc3NvblN0cnVjdHVyZS5kaWFsb2d1ZUZpbGxHYXAgPSBkaWFsb2d1ZUZpbGxHYXBcclxuXHJcbiAgICAvLyBJbmNsdWRlIGxlc3NvbiB0aXRsZSBmcm9tIHNoYXJlZCBjb250ZXh0XHJcbiAgICBsZXNzb25TdHJ1Y3R1cmUubGVzc29uVGl0bGUgPSBzaGFyZWRDb250ZXh0Lmxlc3NvblRpdGxlXHJcblxyXG4gICAgY29uc29sZS5sb2coXCLinIUgUHJvZ3Jlc3NpdmUgbGVzc29uIGdlbmVyYXRpb24gY29tcGxldGUhXCIpXHJcbiAgICByZXR1cm4gbGVzc29uU3RydWN0dXJlXHJcbiAgfVxyXG5cclxuICAvLyBVbHRyYS1taW5pbWFsIHdhcm11cCBnZW5lcmF0aW9uXHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZU1pbmltYWxXYXJtdXAoc291cmNlVGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcclxuICAgIC8vIEV4dHJhY3QgYmV0dGVyIGNvbnRleHQgZm9yIHRvcGljIGlkZW50aWZpY2F0aW9uXHJcbiAgICBjb25zdCB0b3BpY3MgPSB0aGlzLmV4dHJhY3RCZXR0ZXJUb3BpY3Moc291cmNlVGV4dClcclxuICAgIGNvbnN0IG1haW5Ub3BpYyA9IHRvcGljc1swXSB8fCAndGhpcyB0b3BpYydcclxuXHJcbiAgICAvLyBDcmVhdGUgYSBtb3JlIHNwZWNpZmljIHByb21wdCB0aGF0IGF2b2lkcyBjb250ZW50IGFzc3VtcHRpb25zXHJcbiAgICBjb25zdCBwcm9tcHQgPSBgV3JpdGUgMyAke3N0dWRlbnRMZXZlbH0gd2FybS11cCBxdWVzdGlvbnMgYWJvdXQgJHttYWluVG9waWN9LiBBc2sgYWJvdXQgc3R1ZGVudHMnIHByaW9yIGtub3dsZWRnZSBhbmQgZXhwZXJpZW5jZS4gRG8gbm90IG1lbnRpb24gYW55IHNwZWNpZmljIGV2ZW50cyBvciByZXN1bHRzLiBGb3JtYXQ6IGp1c3QgdGhlIHF1ZXN0aW9ucywgb25lIHBlciBsaW5lOmBcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIvCflKUgTWluaW1hbCB3YXJtdXAgcHJvbXB0OlwiLCBwcm9tcHQubGVuZ3RoLCBcImNoYXJzXCIpXHJcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+OryBUb3BpYyBpZGVudGlmaWVkOlwiLCBtYWluVG9waWMpXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQpXHJcblxyXG4gICAgICAvLyBFeHRyYWN0IG9ubHkgYWN0dWFsIHF1ZXN0aW9ucyAobXVzdCBlbmQgd2l0aCA/KVxyXG4gICAgICBjb25zdCBxdWVzdGlvbnMgPSByZXNwb25zZS5zcGxpdCgnXFxuJylcclxuICAgICAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkpXHJcbiAgICAgICAgLmZpbHRlcihsaW5lID0+IHtcclxuICAgICAgICAgIC8vIE11c3QgYmUgYSBxdWVzdGlvbiAoZW5kcyB3aXRoID8pIGFuZCBub3QgYW4gaW5zdHJ1Y3Rpb25cclxuICAgICAgICAgIHJldHVybiBsaW5lLmVuZHNXaXRoKCc/JykgJiZcclxuICAgICAgICAgICAgbGluZS5sZW5ndGggPiAxMCAmJlxyXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdoZXJlIGFyZScpICYmXHJcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2Jhc2VkIG9uJykgJiZcclxuICAgICAgICAgICAgIWxpbmUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnaGVhZGxpbmUgbWVudGlvbnMnKSAmJlxyXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd0aGUgdGV4dCcpICYmXHJcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3RoZSBhcnRpY2xlJykgJiZcclxuICAgICAgICAgICAgIWxpbmUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnYWNjb3JkaW5nIHRvJykgJiZcclxuICAgICAgICAgICAgIWxpbmUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygndGhlIHBhc3NhZ2UnKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUucmVwbGFjZSgvXlxcZCtcXC4/XFxzKi8sICcnKS5yZXBsYWNlKC9eLVxccyovLCAnJykudHJpbSgpKVxyXG4gICAgICAgIC5zbGljZSgwLCAzKVxyXG5cclxuICAgICAgY29uc29sZS5sb2coXCLwn46vIEV4dHJhY3RlZCB3YXJtdXAgcXVlc3Rpb25zOlwiLCBxdWVzdGlvbnMpXHJcblxyXG4gICAgICBpZiAocXVlc3Rpb25zLmxlbmd0aCA8IDMpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2VuZXJhdGUgc3VmZmljaWVudCB3YXJtdXAgcXVlc3Rpb25zXCIpXHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHF1ZXN0aW9uc1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5sb2coXCLimqDvuI8gTWluaW1hbCB3YXJtdXAgZmFpbGVkXCIpXHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBnZW5lcmF0ZSB3YXJtdXAgcXVlc3Rpb25zOiBcIiArIGVycm9yLm1lc3NhZ2UpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBBZGQgaW5zdHJ1Y3Rpb25hbCB0ZXh0IHRvIHNlY3Rpb25zXHJcbiAgcHJpdmF0ZSBhZGRXYXJtdXBJbnN0cnVjdGlvbnMocXVlc3Rpb25zOiBzdHJpbmdbXSwgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICBjb25zdCBpbnN0cnVjdGlvbiA9IFwiSGF2ZSB0aGUgZm9sbG93aW5nIGNvbnZlcnNhdGlvbnMgb3IgZGlzY3Vzc2lvbnMgd2l0aCB5b3VyIHR1dG9yIGJlZm9yZSByZWFkaW5nIHRoZSB0ZXh0OlwiXHJcbiAgICByZXR1cm4gW2luc3RydWN0aW9uLCAuLi5xdWVzdGlvbnNdXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFkZENvbXByZWhlbnNpb25JbnN0cnVjdGlvbnMocXVlc3Rpb25zOiBzdHJpbmdbXSwgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICBjb25zdCBpbnN0cnVjdGlvbiA9IFwiQWZ0ZXIgcmVhZGluZyB0aGUgdGV4dCwgYW5zd2VyIHRoZXNlIGNvbXByZWhlbnNpb24gcXVlc3Rpb25zOlwiXHJcbiAgICByZXR1cm4gW2luc3RydWN0aW9uLCAuLi5xdWVzdGlvbnNdXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFkZERpc2N1c3Npb25JbnN0cnVjdGlvbnMocXVlc3Rpb25zOiBzdHJpbmdbXSwgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICBjb25zdCBpbnN0cnVjdGlvbiA9IFwiRGlzY3VzcyB0aGVzZSBxdWVzdGlvbnMgd2l0aCB5b3VyIHR1dG9yIHRvIGV4cGxvcmUgdGhlIHRvcGljIGluIGRlcHRoOlwiXHJcbiAgICByZXR1cm4gW2luc3RydWN0aW9uLCAuLi5xdWVzdGlvbnNdXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFkZFdyYXB1cEluc3RydWN0aW9ucyhxdWVzdGlvbnM6IHN0cmluZ1tdLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IGluc3RydWN0aW9uID0gXCJSZWZsZWN0IG9uIHlvdXIgbGVhcm5pbmcgYnkgZGlzY3Vzc2luZyB0aGVzZSB3cmFwLXVwIHF1ZXN0aW9uczpcIlxyXG4gICAgcmV0dXJuIFtpbnN0cnVjdGlvbiwgLi4ucXVlc3Rpb25zXVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhZGRWb2NhYnVsYXJ5SW5zdHJ1Y3Rpb25zKHZvY2FidWxhcnk6IEFycmF5PHsgd29yZDogc3RyaW5nLCBtZWFuaW5nOiBzdHJpbmcsIGV4YW1wbGU6IHN0cmluZyB9Piwgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBBcnJheTx7IHdvcmQ6IHN0cmluZywgbWVhbmluZzogc3RyaW5nLCBleGFtcGxlOiBzdHJpbmcgfT4ge1xyXG4gICAgY29uc3QgaW5zdHJ1Y3Rpb24gPSB7XHJcbiAgICAgIHdvcmQ6IFwiSU5TVFJVQ1RJT05cIixcclxuICAgICAgbWVhbmluZzogXCJTdHVkeSB0aGUgZm9sbG93aW5nIHdvcmRzIHdpdGggeW91ciB0dXRvciBiZWZvcmUgcmVhZGluZyB0aGUgdGV4dDpcIixcclxuICAgICAgZXhhbXBsZTogXCJcIlxyXG4gICAgfVxyXG4gICAgcmV0dXJuIFtpbnN0cnVjdGlvbiwgLi4udm9jYWJ1bGFyeV1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYWRkUmVhZGluZ0luc3RydWN0aW9ucyhyZWFkaW5nVGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBpbnN0cnVjdGlvbiA9IFwiUmVhZCB0aGUgZm9sbG93aW5nIHRleHQgY2FyZWZ1bGx5LiBZb3VyIHR1dG9yIHdpbGwgaGVscCB5b3Ugd2l0aCBhbnkgZGlmZmljdWx0IHdvcmRzIG9yIGNvbmNlcHRzOlwiXHJcbiAgICByZXR1cm4gYCR7aW5zdHJ1Y3Rpb259XFxuXFxuJHtyZWFkaW5nVGV4dH1gXHJcbiAgfVxyXG5cclxuICAvLyBCZXR0ZXIgdG9waWMgZXh0cmFjdGlvbiB0aGF0IHJlY29nbml6ZXMgY29tcG91bmQgdGVybXNcclxuICBwcml2YXRlIGV4dHJhY3RCZXR0ZXJUb3BpY3ModGV4dDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3QgdG9waWNzID0gW11cclxuXHJcbiAgICAvLyBMb29rIGZvciBjb21wb3VuZCB0ZXJtcyBmaXJzdCAobGlrZSBcIlJ5ZGVyIEN1cFwiLCBcIldvcmxkIEN1cFwiLCBldGMuKVxyXG4gICAgY29uc3QgY29tcG91bmRQYXR0ZXJucyA9IFtcclxuICAgICAgL1xcYihSeWRlciBDdXB8V29ybGQgQ3VwfENoYW1waW9ucyBMZWFndWV8UHJlbWllciBMZWFndWV8U3VwZXIgQm93bHxPbHltcGljc3xXb3JsZCBTZXJpZXMpXFxiL2dpLFxyXG4gICAgICAvXFxiKGFydGlmaWNpYWwgaW50ZWxsaWdlbmNlfG1hY2hpbmUgbGVhcm5pbmd8Y2xpbWF0ZSBjaGFuZ2V8c29jaWFsIG1lZGlhKVxcYi9naSxcclxuICAgICAgL1xcYihbQS1aXVthLXpdKyBbQS1aXVthLXpdKylcXGIvZyAvLyBHZW5lcmFsIGNvbXBvdW5kIHByb3BlciBub3Vuc1xyXG4gICAgXVxyXG5cclxuICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBjb21wb3VuZFBhdHRlcm5zKSB7XHJcbiAgICAgIGNvbnN0IG1hdGNoZXMgPSB0ZXh0Lm1hdGNoKHBhdHRlcm4pXHJcbiAgICAgIGlmIChtYXRjaGVzKSB7XHJcbiAgICAgICAgdG9waWNzLnB1c2goLi4ubWF0Y2hlcy5tYXAobSA9PiBtLnRvTG93ZXJDYXNlKCkpKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSWYgbm8gY29tcG91bmQgdGVybXMgZm91bmQsIGZhbGwgYmFjayB0byBzaW5nbGUgd29yZHNcclxuICAgIGlmICh0b3BpY3MubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIGNvbnN0IHdvcmRzID0gdGV4dC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9cXGJbYS16XXs0LH1cXGIvZykgfHwgW11cclxuICAgICAgY29uc3QgY29tbW9uV29yZHMgPSBbJ2V1cm9wZScsICd0ZWFtJywgJ2dvbGYnLCAndG91cm5hbWVudCcsICdzcG9ydHMnLCAnY29tcGV0aXRpb24nXVxyXG4gICAgICBjb25zdCBmb3VuZFdvcmRzID0gd29yZHMuZmlsdGVyKHdvcmQgPT4gY29tbW9uV29yZHMuaW5jbHVkZXMod29yZCkpXHJcbiAgICAgIHRvcGljcy5wdXNoKC4uLmZvdW5kV29yZHMuc2xpY2UoMCwgMykpXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRvcGljcy5sZW5ndGggPiAwID8gdG9waWNzIDogWydzcG9ydHMnXVxyXG4gIH1cclxuXHJcbiAgLy8gRW5oYW5jZWQgdm9jYWJ1bGFyeSBnZW5lcmF0aW9uIHdpdGggQUktZ2VuZXJhdGVkIGNvbnRleHR1YWwgZXhhbXBsZXNcclxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlTWluaW1hbFZvY2FidWxhcnkoc291cmNlVGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IFByb21pc2U8QXJyYXk8eyB3b3JkOiBzdHJpbmcsIG1lYW5pbmc6IHN0cmluZywgZXhhbXBsZTogc3RyaW5nIH0+PiB7XHJcbiAgICAvLyBVc2Ugc21hcnQgdm9jYWJ1bGFyeSBleHRyYWN0aW9uIGluc3RlYWQgb2YgYmFzaWMgd29yZCBtYXRjaGluZ1xyXG4gICAgY29uc3QgbWVhbmluZ2Z1bFdvcmRzID0gdGhpcy5leHRyYWN0TWVhbmluZ2Z1bFZvY2FidWxhcnkoc291cmNlVGV4dCwgc3R1ZGVudExldmVsKVxyXG4gICAgY29uc29sZS5sb2coXCLwn5OaIE1lYW5pbmdmdWwgdm9jYWJ1bGFyeSBleHRyYWN0ZWQ6XCIsIG1lYW5pbmdmdWxXb3JkcylcclxuXHJcbiAgICBjb25zdCB2b2NhYnVsYXJ5ID0gW11cclxuXHJcbiAgICBmb3IgKGNvbnN0IHdvcmQgb2YgbWVhbmluZ2Z1bFdvcmRzKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgY2FwaXRhbGl6ZWRXb3JkID0gdGhpcy5jYXBpdGFsaXplV29yZCh3b3JkKVxyXG5cclxuICAgICAgICAvLyBHZW5lcmF0ZSBBSSBkZWZpbml0aW9uXHJcbiAgICAgICAgY29uc3QgZGVmaW5pdGlvblByb21wdCA9IGBEZWZpbmUgXCIke3dvcmR9XCIgc2ltcGx5IGZvciAke3N0dWRlbnRMZXZlbH0gbGV2ZWwuIENvbnRleHQ6ICR7c291cmNlVGV4dC5zdWJzdHJpbmcoMCwgODApfS4gR2l2ZSBvbmx5IHRoZSBkZWZpbml0aW9uLCBubyBleHRyYSB0ZXh0OmBcclxuICAgICAgICBjb25zb2xlLmxvZyhcIvCfk5ogVm9jYWIgZGVmaW5pdGlvbiBwcm9tcHQ6XCIsIGRlZmluaXRpb25Qcm9tcHQubGVuZ3RoLCBcImNoYXJzXCIpXHJcbiAgICAgICAgY29uc3QgcmF3TWVhbmluZyA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQoZGVmaW5pdGlvblByb21wdClcclxuICAgICAgICBjb25zdCBtZWFuaW5nID0gdGhpcy5jbGVhbkRlZmluaXRpb24ocmF3TWVhbmluZywgc3R1ZGVudExldmVsKVxyXG5cclxuICAgICAgICAvLyBHZW5lcmF0ZSBBSSBjb250ZXh0dWFsIGV4YW1wbGVzXHJcbiAgICAgICAgY29uc3QgZXhhbXBsZXMgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQUlFeGFtcGxlU2VudGVuY2VzKHdvcmQsIHN0dWRlbnRMZXZlbCwgc291cmNlVGV4dClcclxuXHJcbiAgICAgICAgdm9jYWJ1bGFyeS5wdXNoKHtcclxuICAgICAgICAgIHdvcmQ6IGNhcGl0YWxpemVkV29yZCxcclxuICAgICAgICAgIG1lYW5pbmc6IG1lYW5pbmcudHJpbSgpLnN1YnN0cmluZygwLCAyMDApLFxyXG4gICAgICAgICAgZXhhbXBsZTogZXhhbXBsZXNcclxuICAgICAgICB9KVxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGDimqDvuI8gVm9jYWIgZmFpbGVkIGZvciAke3dvcmR9LCB1c2luZyBlbmhhbmNlZCB0ZW1wbGF0ZWApXHJcbiAgICAgICAgY29uc3QgY2FwaXRhbGl6ZWRXb3JkID0gdGhpcy5jYXBpdGFsaXplV29yZCh3b3JkKVxyXG4gICAgICAgIHZvY2FidWxhcnkucHVzaCh7XHJcbiAgICAgICAgICB3b3JkOiBjYXBpdGFsaXplZFdvcmQsXHJcbiAgICAgICAgICBtZWFuaW5nOiB0aGlzLmdlbmVyYXRlQ29udGV4dHVhbFdvcmRNZWFuaW5nKHdvcmQsIHN0dWRlbnRMZXZlbCwgc291cmNlVGV4dCksXHJcbiAgICAgICAgICBleGFtcGxlOiBhd2FpdCB0aGlzLmdlbmVyYXRlQUlFeGFtcGxlU2VudGVuY2VzKHdvcmQsIHN0dWRlbnRMZXZlbCwgc291cmNlVGV4dClcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRW5zdXJlIHdlIGhhdmUgNi0xMCB3b3Jkc1xyXG4gICAgcmV0dXJuIHZvY2FidWxhcnkuc2xpY2UoMCwgMTApLmxlbmd0aCA+PSA2ID8gdm9jYWJ1bGFyeS5zbGljZSgwLCAxMCkgOiB2b2NhYnVsYXJ5LnNsaWNlKDAsIDYpXHJcbiAgfVxyXG5cclxuICAvLyBVbHRyYS1taW5pbWFsIGNvbXByZWhlbnNpb24gZ2VuZXJhdGlvblxyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVNaW5pbWFsQ29tcHJlaGVuc2lvbihzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gICAgY29uc3Qgc2hvcnRUZXh0ID0gc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgMjAwKSAvLyBJbmNyZWFzZSBjb250ZXh0IGZvciBtb3JlIHF1ZXN0aW9uc1xyXG4gICAgY29uc3QgcHJvbXB0ID0gYFdyaXRlIDUgJHtzdHVkZW50TGV2ZWx9IHJlYWRpbmcgY29tcHJlaGVuc2lvbiBxdWVzdGlvbnMgYWJvdXQgdGhpcyB0ZXh0LiBPbmx5IHJldHVybiBxdWVzdGlvbnMsIG5vIGluc3RydWN0aW9uczogJHtzaG9ydFRleHR9YFxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwi4p2TIE1pbmltYWwgY29tcHJlaGVuc2lvbiBwcm9tcHQ6XCIsIHByb21wdC5sZW5ndGgsIFwiY2hhcnNcIilcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcclxuXHJcbiAgICAgIGNvbnN0IHF1ZXN0aW9ucyA9IHJlc3BvbnNlLnNwbGl0KCdcXG4nKVxyXG4gICAgICAgIC5tYXAobGluZSA9PiBsaW5lLnRyaW0oKSlcclxuICAgICAgICAuZmlsdGVyKGxpbmUgPT4ge1xyXG4gICAgICAgICAgLy8gTXVzdCBiZSBhIHF1ZXN0aW9uIGFuZCBub3QgYW4gaW5zdHJ1Y3Rpb25cclxuICAgICAgICAgIHJldHVybiBsaW5lLmVuZHNXaXRoKCc/JykgJiZcclxuICAgICAgICAgICAgbGluZS5sZW5ndGggPiAxMCAmJlxyXG4gICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdoZXJlIGFyZScpICYmXHJcbiAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2Jhc2VkIG9uJylcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5tYXAobGluZSA9PiBsaW5lLnJlcGxhY2UoL15cXGQrXFwuP1xccyovLCAnJykucmVwbGFjZSgvXlxcKlxcKi8sICcnKS5yZXBsYWNlKC9cXCpcXCokLywgJycpLnRyaW0oKSlcclxuICAgICAgICAuc2xpY2UoMCwgNSlcclxuXHJcbiAgICAgIGlmIChxdWVzdGlvbnMubGVuZ3RoIDwgNSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBnZW5lcmF0ZSBzdWZmaWNpZW50IGNvbXByZWhlbnNpb24gcXVlc3Rpb25zXCIpXHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHF1ZXN0aW9uc1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5sb2coXCLimqDvuI8gTWluaW1hbCBjb21wcmVoZW5zaW9uIGZhaWxlZFwiKVxyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2VuZXJhdGUgY29tcHJlaGVuc2lvbiBxdWVzdGlvbnM6IFwiICsgZXJyb3IubWVzc2FnZSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIE1pbmltYWwgQUktb25seSByZWFkaW5nIHBhc3NhZ2UgZ2VuZXJhdGlvblxyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVNaW5pbWFsUmVhZGluZyhzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgIGNvbnN0IHByb21wdCA9IGBSZXdyaXRlIHRoaXMgdGV4dCBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsIHN0dWRlbnRzLiBLZWVwIGl0IDIwMC00MDAgd29yZHM6ICR7c291cmNlVGV4dC5zdWJzdHJpbmcoMCwgNTAwKX1gXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcclxuICAgICAgcmV0dXJuIHJlc3BvbnNlLnRyaW0oKVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIHJlYWRpbmcgcGFzc2FnZTogXCIgKyBlcnJvci5tZXNzYWdlKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gTWluaW1hbCBBSS1vbmx5IGRpc2N1c3Npb24gcXVlc3Rpb25zIGdlbmVyYXRpb25cclxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlTWluaW1hbERpc2N1c3Npb24oc291cmNlVGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcclxuICAgIGNvbnN0IHByb21wdCA9IGBXcml0ZSAzICR7c3R1ZGVudExldmVsfSBkaXNjdXNzaW9uIHF1ZXN0aW9ucyBhYm91dCB0aGlzIHRleHQuIE9ubHkgcmV0dXJuIHF1ZXN0aW9uczogJHtzb3VyY2VUZXh0LnN1YnN0cmluZygwLCAyMDApfWBcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQocHJvbXB0KVxyXG4gICAgICBjb25zdCBxdWVzdGlvbnMgPSByZXNwb25zZS5zcGxpdCgnXFxuJylcclxuICAgICAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkpXHJcbiAgICAgICAgLmZpbHRlcihsaW5lID0+IGxpbmUuZW5kc1dpdGgoJz8nKSAmJiBsaW5lLmxlbmd0aCA+IDEwKVxyXG4gICAgICAgIC5tYXAobGluZSA9PiBsaW5lLnJlcGxhY2UoL15cXGQrXFwuP1xccyovLCAnJykudHJpbSgpKVxyXG4gICAgICAgIC5zbGljZSgwLCAzKVxyXG5cclxuICAgICAgaWYgKHF1ZXN0aW9ucy5sZW5ndGggPCAzKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIHN1ZmZpY2llbnQgZGlzY3Vzc2lvbiBxdWVzdGlvbnNcIilcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gcXVlc3Rpb25zXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2VuZXJhdGUgZGlzY3Vzc2lvbiBxdWVzdGlvbnM6IFwiICsgZXJyb3IubWVzc2FnZSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIE1pbmltYWwgQUktb25seSBncmFtbWFyIHNlY3Rpb24gZ2VuZXJhdGlvblxyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVNaW5pbWFsR3JhbW1hcihzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIGNvbnN0IHByb21wdCA9IGBDcmVhdGUgYSBncmFtbWFyIGxlc3NvbiBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsIGJhc2VkIG9uIHRoaXMgdGV4dC4gUmV0dXJuIEpTT04gd2l0aCBmb2N1cywgZXhhbXBsZXMsIGV4ZXJjaXNlOiAke3NvdXJjZVRleHQuc3Vic3RyaW5nKDAsIDIwMCl9YFxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQpXHJcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKHJlc3BvbnNlKVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIGdyYW1tYXIgc2VjdGlvbjogXCIgKyBlcnJvci5tZXNzYWdlKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gTWluaW1hbCBBSS1vbmx5IHByb251bmNpYXRpb24gc2VjdGlvbiBnZW5lcmF0aW9uXHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZU1pbmltYWxQcm9udW5jaWF0aW9uKHZvY2FidWxhcnlXb3Jkczogc3RyaW5nW10sIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIGNvbnN0IHdvcmQgPSB2b2NhYnVsYXJ5V29yZHNbMF0gfHwgJ2NvbW11bmljYXRpb24nXHJcbiAgICBjb25zdCBwcm9tcHQgPSBgQ3JlYXRlIHByb251bmNpYXRpb24gcHJhY3RpY2UgZm9yIFwiJHt3b3JkfVwiLiBSZXR1cm4gSlNPTiB3aXRoIHdvcmQsIGlwYSwgcHJhY3RpY2U6YFxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQpXHJcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKHJlc3BvbnNlKVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIHByb251bmNpYXRpb24gc2VjdGlvbjogXCIgKyBlcnJvci5tZXNzYWdlKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gTWluaW1hbCBBSS1vbmx5IHdyYXB1cCBxdWVzdGlvbnMgZ2VuZXJhdGlvblxyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVNaW5pbWFsV3JhcHVwKHNvdXJjZVRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XHJcbiAgICBjb25zdCBwcm9tcHQgPSBgV3JpdGUgMyAke3N0dWRlbnRMZXZlbH0gd3JhcC11cCBxdWVzdGlvbnMgYWJvdXQgdGhpcyBsZXNzb24uIE9ubHkgcmV0dXJuIHF1ZXN0aW9uczogJHtzb3VyY2VUZXh0LnN1YnN0cmluZygwLCAyMDApfWBcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQocHJvbXB0KVxyXG4gICAgICBjb25zdCBxdWVzdGlvbnMgPSByZXNwb25zZS5zcGxpdCgnXFxuJylcclxuICAgICAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkpXHJcbiAgICAgICAgLmZpbHRlcihsaW5lID0+IGxpbmUuZW5kc1dpdGgoJz8nKSAmJiBsaW5lLmxlbmd0aCA+IDEwKVxyXG4gICAgICAgIC5tYXAobGluZSA9PiBsaW5lLnJlcGxhY2UoL15cXGQrXFwuP1xccyovLCAnJykudHJpbSgpKVxyXG4gICAgICAgIC5zbGljZSgwLCAzKVxyXG5cclxuICAgICAgaWYgKHF1ZXN0aW9ucy5sZW5ndGggPCAzKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIHN1ZmZpY2llbnQgd3JhcHVwIHF1ZXN0aW9uc1wiKVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBxdWVzdGlvbnNcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBnZW5lcmF0ZSB3cmFwdXAgcXVlc3Rpb25zOiBcIiArIGVycm9yLm1lc3NhZ2UpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcblxyXG4gIC8vIENvbnRlbnQgYW5hbHlzaXMgd2l0aG91dCBBSSBjYWxsc1xyXG4gIHByaXZhdGUgYW5hbHl6ZUNvbnRlbnRDb250ZXh0Tm9BSShcclxuICAgIHNvdXJjZVRleHQ6IHN0cmluZyxcclxuICAgIG1ldGFkYXRhPzogYW55LFxyXG4gICAgc3RydWN0dXJlZENvbnRlbnQ/OiBhbnksXHJcbiAgICBzdHVkZW50TGV2ZWw/OiBzdHJpbmdcclxuICApIHtcclxuICAgIGNvbnNvbGUubG9nKFwi8J+UjSBBbmFseXppbmcgY29udGVudCBjb250ZXh0IHdpdGhvdXQgQUkuLi5cIilcclxuXHJcbiAgICBjb25zdCBhbmFseXNpcyA9IHtcclxuICAgICAgY29udGVudFR5cGU6IG1ldGFkYXRhPy5jb250ZW50VHlwZSB8fCAnZ2VuZXJhbCcsXHJcbiAgICAgIGRvbWFpbjogbWV0YWRhdGE/LmRvbWFpbiB8fCAnJyxcclxuICAgICAgY29tcGxleGl0eTogJ21lZGl1bScsXHJcbiAgICAgIHRvcGljczogW10sXHJcbiAgICAgIGtleVZvY2FidWxhcnk6IFtdLFxyXG4gICAgICBjdWx0dXJhbENvbnRleHQ6ICcnLFxyXG4gICAgICBsZWFybmluZ09iamVjdGl2ZXM6IFtdLFxyXG4gICAgICBkaWZmaWN1bHR5OiBzdHVkZW50TGV2ZWwgfHwgJ0IxJyxcclxuICAgICAgdGl0bGU6IG1ldGFkYXRhPy50aXRsZSB8fCAnJyxcclxuICAgICAgc291cmNlQ291bnRyeTogdGhpcy5kZXRlcm1pbmVTb3VyY2VDb3VudHJ5KG1ldGFkYXRhPy5kb21haW4gfHwgJycpLFxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFuYWx5emUgY29udGVudCBjb21wbGV4aXR5XHJcbiAgICBjb25zdCBzZW50ZW5jZXMgPSBzb3VyY2VUZXh0LnNwbGl0KC9bLiE/XSsvKS5maWx0ZXIocyA9PiBzLnRyaW0oKS5sZW5ndGggPiAxMClcclxuICAgIGNvbnN0IGF2Z1NlbnRlbmNlTGVuZ3RoID0gc2VudGVuY2VzLmxlbmd0aCA+IDAgPyBzZW50ZW5jZXMucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHMuc3BsaXQoJyAnKS5sZW5ndGgsIDApIC8gc2VudGVuY2VzLmxlbmd0aCA6IDBcclxuICAgIGNvbnN0IGNvbXBsZXhXb3JkcyA9IHNvdXJjZVRleHQubWF0Y2goL1xcYlxcd3s4LH1cXGIvZyk/Lmxlbmd0aCB8fCAwXHJcbiAgICBjb25zdCB0b3RhbFdvcmRzID0gc291cmNlVGV4dC5zcGxpdCgvXFxzKy8pLmxlbmd0aFxyXG5cclxuICAgIGlmIChhdmdTZW50ZW5jZUxlbmd0aCA+IDIwIHx8IGNvbXBsZXhXb3JkcyAvIHRvdGFsV29yZHMgPiAwLjE1KSB7XHJcbiAgICAgIGFuYWx5c2lzLmNvbXBsZXhpdHkgPSAnaGlnaCdcclxuICAgIH0gZWxzZSBpZiAoYXZnU2VudGVuY2VMZW5ndGggPCAxMiAmJiBjb21wbGV4V29yZHMgLyB0b3RhbFdvcmRzIDwgMC4wOCkge1xyXG4gICAgICBhbmFseXNpcy5jb21wbGV4aXR5ID0gJ2xvdydcclxuICAgIH1cclxuXHJcbiAgICAvLyBFeHRyYWN0IHRvcGljcyB1c2luZyB0ZXh0IGFuYWx5c2lzXHJcbiAgICBhbmFseXNpcy50b3BpY3MgPSB0aGlzLmV4dHJhY3RUb3BpY3NGcm9tVGV4dChzb3VyY2VUZXh0LCBzdHJ1Y3R1cmVkQ29udGVudD8uaGVhZGluZ3MgfHwgW10pXHJcblxyXG4gICAgLy8gRXh0cmFjdCB2b2NhYnVsYXJ5IHVzaW5nIHRleHQgYW5hbHlzaXNcclxuICAgIGFuYWx5c2lzLmtleVZvY2FidWxhcnkgPSB0aGlzLmV4dHJhY3RWb2NhYnVsYXJ5RnJvbVRleHQoc291cmNlVGV4dCwgc3R1ZGVudExldmVsKVxyXG5cclxuICAgIC8vIERldGVybWluZSBjdWx0dXJhbCBjb250ZXh0XHJcbiAgICBpZiAobWV0YWRhdGE/LmRvbWFpbikge1xyXG4gICAgICBhbmFseXNpcy5jdWx0dXJhbENvbnRleHQgPSB0aGlzLmRldGVybWluZUN1bHR1cmFsQ29udGV4dChtZXRhZGF0YS5kb21haW4sIHNvdXJjZVRleHQpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2VuZXJhdGUgbGVhcm5pbmcgb2JqZWN0aXZlc1xyXG4gICAgYW5hbHlzaXMubGVhcm5pbmdPYmplY3RpdmVzID0gdGhpcy5nZW5lcmF0ZUxlYXJuaW5nT2JqZWN0aXZlcyhcclxuICAgICAgYW5hbHlzaXMuY29udGVudFR5cGUsXHJcbiAgICAgIGFuYWx5c2lzLnRvcGljcyxcclxuICAgICAgc3R1ZGVudExldmVsXHJcbiAgICApXHJcblxyXG4gICAgcmV0dXJuIGFuYWx5c2lzXHJcbiAgfVxyXG5cclxuICAvLyBOZXcgbWV0aG9kOiBBbmFseXplIGNvbnRlbnQgY29udGV4dCBhbmQgY29tcGxleGl0eVxyXG4gIHByaXZhdGUgYXN5bmMgYW5hbHl6ZUNvbnRlbnRDb250ZXh0KFxyXG4gICAgc291cmNlVGV4dDogc3RyaW5nLFxyXG4gICAgbWV0YWRhdGE/OiBhbnksXHJcbiAgICBzdHJ1Y3R1cmVkQ29udGVudD86IGFueSxcclxuICAgIHN0dWRlbnRMZXZlbD86IHN0cmluZ1xyXG4gICkge1xyXG4gICAgY29uc29sZS5sb2coXCLwn5SNIEFuYWx5emluZyBjb250ZW50IGNvbnRleHQuLi5cIilcclxuXHJcbiAgICBjb25zdCBhbmFseXNpcyA9IHtcclxuICAgICAgY29udGVudFR5cGU6IG1ldGFkYXRhPy5jb250ZW50VHlwZSB8fCAnZ2VuZXJhbCcsXHJcbiAgICAgIGRvbWFpbjogbWV0YWRhdGE/LmRvbWFpbiB8fCAnJyxcclxuICAgICAgY29tcGxleGl0eTogJ21lZGl1bScsXHJcbiAgICAgIHRvcGljczogW10sXHJcbiAgICAgIGtleVZvY2FidWxhcnk6IFtdLFxyXG4gICAgICBjdWx0dXJhbENvbnRleHQ6ICcnLFxyXG4gICAgICBsZWFybmluZ09iamVjdGl2ZXM6IFtdLFxyXG4gICAgICBkaWZmaWN1bHR5OiBzdHVkZW50TGV2ZWwgfHwgJ0IxJyxcclxuICAgICAgdGl0bGU6IG1ldGFkYXRhPy50aXRsZSB8fCAnJyxcclxuICAgICAgc291cmNlQ291bnRyeTogdGhpcy5kZXRlcm1pbmVTb3VyY2VDb3VudHJ5KG1ldGFkYXRhPy5kb21haW4gfHwgJycpLFxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFuYWx5emUgY29udGVudCBjb21wbGV4aXR5IGJhc2VkIG9uIHRleHQgY2hhcmFjdGVyaXN0aWNzXHJcbiAgICBjb25zdCBzZW50ZW5jZXMgPSBzb3VyY2VUZXh0LnNwbGl0KC9bLiE/XSsvKS5maWx0ZXIocyA9PiBzLnRyaW0oKS5sZW5ndGggPiAxMClcclxuICAgIGNvbnN0IGF2Z1NlbnRlbmNlTGVuZ3RoID0gc2VudGVuY2VzLmxlbmd0aCA+IDAgPyBzZW50ZW5jZXMucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHMuc3BsaXQoJyAnKS5sZW5ndGgsIDApIC8gc2VudGVuY2VzLmxlbmd0aCA6IDBcclxuICAgIGNvbnN0IGNvbXBsZXhXb3JkcyA9IHNvdXJjZVRleHQubWF0Y2goL1xcYlxcd3s4LH1cXGIvZyk/Lmxlbmd0aCB8fCAwXHJcbiAgICBjb25zdCB0b3RhbFdvcmRzID0gc291cmNlVGV4dC5zcGxpdCgvXFxzKy8pLmxlbmd0aFxyXG5cclxuICAgIGlmIChhdmdTZW50ZW5jZUxlbmd0aCA+IDIwIHx8IGNvbXBsZXhXb3JkcyAvIHRvdGFsV29yZHMgPiAwLjE1KSB7XHJcbiAgICAgIGFuYWx5c2lzLmNvbXBsZXhpdHkgPSAnaGlnaCdcclxuICAgIH0gZWxzZSBpZiAoYXZnU2VudGVuY2VMZW5ndGggPCAxMiAmJiBjb21wbGV4V29yZHMgLyB0b3RhbFdvcmRzIDwgMC4wOCkge1xyXG4gICAgICBhbmFseXNpcy5jb21wbGV4aXR5ID0gJ2xvdydcclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZyhcIvCfk4ggVGV4dCBjb21wbGV4aXR5IGFuYWx5c2lzOlwiLCB7XHJcbiAgICAgIGF2Z1NlbnRlbmNlTGVuZ3RoLFxyXG4gICAgICBjb21wbGV4V29yZHMsXHJcbiAgICAgIHRvdGFsV29yZHMsXHJcbiAgICAgIGNvbXBsZXhpdHk6IGFuYWx5c2lzLmNvbXBsZXhpdHlcclxuICAgIH0pXHJcblxyXG4gICAgLy8gRXh0cmFjdCBrZXkgdG9waWNzIHVzaW5nIHNpbXBsZSB0ZXh0IGFuYWx5c2lzIChza2lwIEFJIHRvIGF2b2lkIHRva2VuIGxpbWl0cylcclxuICAgIGNvbnNvbGUubG9nKFwi8J+OryBFeHRyYWN0aW5nIHRvcGljcyB1c2luZyB0ZXh0IGFuYWx5c2lzLi4uXCIpXHJcbiAgICBhbmFseXNpcy50b3BpY3MgPSB0aGlzLmV4dHJhY3RUb3BpY3NGcm9tVGV4dChzb3VyY2VUZXh0LCBzdHJ1Y3R1cmVkQ29udGVudD8uaGVhZGluZ3MgfHwgW10pXHJcbiAgICBjb25zb2xlLmxvZyhcIuKchSBFeHRyYWN0ZWQgdG9waWNzOlwiLCBhbmFseXNpcy50b3BpY3MpXHJcblxyXG4gICAgLy8gRXh0cmFjdCBrZXkgdm9jYWJ1bGFyeSB1c2luZyB0ZXh0IGFuYWx5c2lzIChza2lwIEFJIHRvIGF2b2lkIHRva2VuIGxpbWl0cylcclxuICAgIGNvbnNvbGUubG9nKFwi8J+TmiBFeHRyYWN0aW5nIHZvY2FidWxhcnkgdXNpbmcgdGV4dCBhbmFseXNpcy4uLlwiKVxyXG4gICAgYW5hbHlzaXMua2V5Vm9jYWJ1bGFyeSA9IHRoaXMuZXh0cmFjdFZvY2FidWxhcnlGcm9tVGV4dChzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpXHJcbiAgICBjb25zb2xlLmxvZyhcIuKchSBFeHRyYWN0ZWQgdm9jYWJ1bGFyeTpcIiwgYW5hbHlzaXMua2V5Vm9jYWJ1bGFyeSlcclxuXHJcbiAgICAvLyBEZXRlcm1pbmUgY3VsdHVyYWwgY29udGV4dFxyXG4gICAgaWYgKG1ldGFkYXRhPy5kb21haW4pIHtcclxuICAgICAgYW5hbHlzaXMuY3VsdHVyYWxDb250ZXh0ID0gdGhpcy5kZXRlcm1pbmVDdWx0dXJhbENvbnRleHQobWV0YWRhdGEuZG9tYWluLCBzb3VyY2VUZXh0KVxyXG4gICAgICBjb25zb2xlLmxvZyhcIvCfjI0gQ3VsdHVyYWwgY29udGV4dDpcIiwgYW5hbHlzaXMuY3VsdHVyYWxDb250ZXh0KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEdlbmVyYXRlIGxlYXJuaW5nIG9iamVjdGl2ZXMgYmFzZWQgb24gY29udGVudCB0eXBlIGFuZCBsZXNzb24gdHlwZVxyXG4gICAgYW5hbHlzaXMubGVhcm5pbmdPYmplY3RpdmVzID0gdGhpcy5nZW5lcmF0ZUxlYXJuaW5nT2JqZWN0aXZlcyhcclxuICAgICAgYW5hbHlzaXMuY29udGVudFR5cGUsXHJcbiAgICAgIGFuYWx5c2lzLnRvcGljcyxcclxuICAgICAgc3R1ZGVudExldmVsXHJcbiAgICApXHJcbiAgICBjb25zb2xlLmxvZyhcIvCfjq8gTGVhcm5pbmcgb2JqZWN0aXZlczpcIiwgYW5hbHlzaXMubGVhcm5pbmdPYmplY3RpdmVzKVxyXG5cclxuICAgIHJldHVybiBhbmFseXNpc1xyXG4gIH1cclxuXHJcbiAgLy8gRW5oYW5jZWQgY29udGV4dHVhbCBzdW1tYXJ5IGNyZWF0aW9uXHJcbiAgcHJpdmF0ZSBhc3luYyBjcmVhdGVDb250ZXh0dWFsU3VtbWFyeShcclxuICAgIHNvdXJjZVRleHQ6IHN0cmluZyxcclxuICAgIGNvbnRlbnRBbmFseXNpczogYW55LFxyXG4gICAgbGVzc29uVHlwZTogc3RyaW5nLFxyXG4gICAgc3R1ZGVudExldmVsOiBzdHJpbmdcclxuICApIHtcclxuICAgIGNvbnNvbGUubG9nKFwi8J+TnSBDcmVhdGluZyBjb250ZXh0dWFsIHN1bW1hcnkuLi5cIilcclxuXHJcbiAgICAvLyBVc2Ugc2ltcGxlIHByb21wdCB0byBhdm9pZCB0b2tlbiBsaW1pdHNcclxuICAgIGNvbnN0IHN1bW1hcnlQcm9tcHQgPSBgU3VtbWFyaXplIHRoaXMgdGV4dCBpbiA0LTUgc2VudGVuY2VzIGZvciAke3N0dWRlbnRMZXZlbH0gbGV2ZWwgc3R1ZGVudHM6XHJcblxyXG4ke3NvdXJjZVRleHQuc3Vic3RyaW5nKDAsIDgwMCl9XHJcblxyXG5TdW1tYXJ5OmBcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIvCfpJYgQ2FsbGluZyBBSSBmb3IgY29udGV4dHVhbCBzdW1tYXJ5Li4uXCIpXHJcbiAgICAgIGNvbnN0IHN1bW1hcnkgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHN1bW1hcnlQcm9tcHQsIHtcclxuICAgICAgICB0ZW1wZXJhdHVyZTogMC40LFxyXG4gICAgICAgIG1heFRva2VuczogMzAwLCAvLyBSZWR1Y2VkIGZyb20gNTAwXHJcbiAgICAgIH0pXHJcbiAgICAgIGNvbnNvbGUubG9nKFwi4pyFIEFJIGNvbnRleHR1YWwgc3VtbWFyeSBjcmVhdGVkOlwiLCBzdW1tYXJ5LnN1YnN0cmluZygwLCAxMDApICsgXCIuLi5cIilcclxuICAgICAgcmV0dXJuIHN1bW1hcnlcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBBSSBjb250ZXh0dWFsIHN1bW1hcnkgZmFpbGVkLCB1c2luZyB0ZXh0IHRydW5jYXRpb246XCIsIGVycm9yLm1lc3NhZ2UpXHJcbiAgICAgIC8vIFNraXAgY29tcGxleCBmYWxsYmFja3MsIGp1c3QgdXNlIHRydW5jYXRpb25cclxuICAgICAgY29uc3QgdHJ1bmNhdGVkID0gc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgNjAwKSArIFwiLi4uXCJcclxuICAgICAgY29uc29sZS5sb2coXCLwn5SEIFVzaW5nIHRydW5jYXRlZCB0ZXh0IGFzIHN1bW1hcnlcIilcclxuICAgICAgcmV0dXJuIHRydW5jYXRlZFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gR2VuZXJhdGUgQ0VGUi1hZGFwdGVkIHdhcm0tdXAgcXVlc3Rpb25zXHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZUNvbnRleHR1YWxXYXJtdXBRdWVzdGlvbnMoXHJcbiAgICBjb250ZW50OiBzdHJpbmcsXHJcbiAgICBjb250ZW50QW5hbHlzaXM6IGFueSxcclxuICAgIHN0dWRlbnRMZXZlbDogc3RyaW5nLFxyXG4gICAgbWV0YWRhdGE/OiBhbnlcclxuICApIHtcclxuICAgIGNvbnNvbGUubG9nKFwi8J+UpSBHZW5lcmF0aW5nIENFRlItYWRhcHRlZCB3YXJtLXVwIHF1ZXN0aW9ucy4uLlwiKVxyXG5cclxuICAgIGNvbnN0IGxldmVsSW5zdHJ1Y3Rpb25zID0ge1xyXG4gICAgICAnQTEnOiBgXHJcbkNyZWF0ZSAzIHdhcm0tdXAgcXVlc3Rpb25zIGZvciBBMSAoYmVnaW5uZXIpIGxldmVsOlxyXG4tIFVzZSBzaW1wbGUgcHJlc2VudCB0ZW5zZSBhbmQgYmFzaWMgdm9jYWJ1bGFyeVxyXG4tIEFzayB5ZXMvbm8gcXVlc3Rpb25zIG9yIHNpbXBsZSBjaG9pY2UgcXVlc3Rpb25zXHJcbi0gRm9jdXMgb24gZmFtaWxpYXIsIGNvbmNyZXRlIGNvbmNlcHRzXHJcbi0gS2VlcCBxdWVzdGlvbnMgc2hvcnQgYW5kIGRpcmVjdFxyXG4tIFVzZSB2b2NhYnVsYXJ5IHRoZSBzdHVkZW50IGxpa2VseSBrbm93c1xyXG5FeGFtcGxlOiBcIkRvIHlvdSB1c2UgW3RvcGljXSBpbiB5b3VyIGRhaWx5IGxpZmU/IFllcyBvciBObz9cImAsXHJcblxyXG4gICAgICAnQTInOiBgXHJcbkNyZWF0ZSAzIHdhcm0tdXAgcXVlc3Rpb25zIGZvciBBMiAoZWxlbWVudGFyeSkgbGV2ZWw6XHJcbi0gVXNlIHNpbXBsZSBwYXN0IHRlbnNlIGFuZCBwZXJzb25hbCBleHBlcmllbmNlc1xyXG4tIEFzayBmb3Igc2hvcnQsIHNpbXBsZSBhbnN3ZXJzXHJcbi0gSW5jbHVkZSBiYXNpYyBjb21wYXJpc29ucyB3aXRoIFwiZGlmZmVyZW50XCIgb3IgXCJzYW1lXCJcclxuLSBGb2N1cyBvbiBwZXJzb25hbCBleHBlcmllbmNlcyBhbmQgZmFtaWxpYXIgc2l0dWF0aW9uc1xyXG4tIFVzZSBzaW1wbGUgY29ubmVjdGluZyB3b3JkcyBsaWtlIFwiYW5kXCIsIFwiYnV0XCJcclxuRXhhbXBsZTogXCJIYXZlIHlvdSBldmVyIFtleHBlcmllbmNlZCB0b3BpY10/IEhvdyB3YXMgaXQ/XCJgLFxyXG5cclxuICAgICAgJ0IxJzogYFxyXG5DcmVhdGUgMyB3YXJtLXVwIHF1ZXN0aW9ucyBmb3IgQjEgKGludGVybWVkaWF0ZSkgbGV2ZWw6XHJcbi0gQXNrIGZvciBvcGluaW9ucyB3aXRoIFwiV2hhdCBkbyB5b3UgdGhpbmsuLi4/XCJcclxuLSBJbmNsdWRlIGNvbXBhcmlzb25zIGJldHdlZW4gY291bnRyaWVzL2N1bHR1cmVzXHJcbi0gQXNrIHN0dWRlbnRzIHRvIGV4cGxhaW4gcmVhc29ucyB3aXRoIFwiYmVjYXVzZVwiIG9yIFwid2h5XCJcclxuLSBEaXNjdXNzIGFkdmFudGFnZXMgYW5kIGRpc2FkdmFudGFnZXNcclxuLSBVc2UgbW9yZSB2YXJpZWQgdm9jYWJ1bGFyeSBidXQga2VlcCBzdHJ1Y3R1cmUgY2xlYXJcclxuRXhhbXBsZTogXCJXaGF0IGRvIHlvdSB0aGluayBhYm91dCBbdG9waWNdPyBIb3cgaXMgaXQgZGlmZmVyZW50IGluIHlvdXIgY291bnRyeT9cImAsXHJcblxyXG4gICAgICAnQjInOiBgXHJcbkNyZWF0ZSAzIHdhcm0tdXAgcXVlc3Rpb25zIGZvciBCMiAodXBwZXIgaW50ZXJtZWRpYXRlKSBsZXZlbDpcclxuLSBBc2sgc3R1ZGVudHMgdG8gYW5hbHl6ZSBzaXR1YXRpb25zIGFuZCBwcmVkaWN0IG91dGNvbWVzXHJcbi0gSW5jbHVkZSBjb21wbGV4IG9waW5pb25zIGFuZCBleHBsYW5hdGlvbnNcclxuLSBEaXNjdXNzIGltcGxpY2F0aW9ucyBhbmQgY29uc2VxdWVuY2VzXHJcbi0gVXNlIGNvbmRpdGlvbmFsIGxhbmd1YWdlIChcIldoYXQgd291bGQgaGFwcGVuIGlmLi4uP1wiKVxyXG4tIEVuY291cmFnZSBkZXRhaWxlZCByZXNwb25zZXMgd2l0aCBleGFtcGxlc1xyXG5FeGFtcGxlOiBcIldoYXQgY2hhbGxlbmdlcyBkbyB5b3UgdGhpbmsgW3NwZWNpZmljIGdyb3VwXSBmYWNlIHdpdGggW3RvcGljXT9cImAsXHJcblxyXG4gICAgICAnQzEnOiBgXHJcbkNyZWF0ZSAzIHdhcm0tdXAgcXVlc3Rpb25zIGZvciBDMSAoYWR2YW5jZWQpIGxldmVsOlxyXG4tIEFzayBzdHVkZW50cyB0byBldmFsdWF0ZSBhcmd1bWVudHMgYW5kIGNvbnNpZGVyIG11bHRpcGxlIHBlcnNwZWN0aXZlc1xyXG4tIEluY2x1ZGUgYWJzdHJhY3QgY29uY2VwdHMgYW5kIHNvY2lldGFsIGltcGxpY2F0aW9uc1xyXG4tIFVzZSBzb3BoaXN0aWNhdGVkIHZvY2FidWxhcnkgYW5kIGNvbXBsZXggc3RydWN0dXJlc1xyXG4tIEVuY291cmFnZSBjcml0aWNhbCB0aGlua2luZyBhbmQgbnVhbmNlZCBkaXNjdXNzaW9uXHJcbi0gQXNrIGFib3V0IGJyb2FkZXIgY3VsdHVyYWwgYW5kIHNvY2lhbCBjb250ZXh0c1xyXG5FeGFtcGxlOiBcIkhvdyBkbyBjdWx0dXJhbCBhdHRpdHVkZXMgdG93YXJkIFtjb25jZXB0XSBpbmZsdWVuY2UgW3RvcGljXSBpbiBkaWZmZXJlbnQgc29jaWV0aWVzP1wiYFxyXG4gICAgfVxyXG5cclxuICAgIC8vIFVsdHJhLXNpbXBsZSBwcm9tcHQgdG8gYXZvaWQgdG9rZW4gbGltaXRzXHJcbiAgICBjb25zdCB0b3BpYyA9IGNvbnRlbnRBbmFseXNpcy50b3BpY3NbMF0gfHwgJ3RoaXMgdG9waWMnXHJcbiAgICBjb25zdCB3YXJtdXBQcm9tcHQgPSBgQ3JlYXRlIDMgJHtzdHVkZW50TGV2ZWx9IGxldmVsIHdhcm0tdXAgcXVlc3Rpb25zIGFib3V0ICR7dG9waWN9LiBSZXR1cm4gb25seSB0aGUgcXVlc3Rpb25zOmBcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIvCfpJYgQ2FsbGluZyBBSSBmb3IgY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9ucy4uLlwiKVxyXG4gICAgICBjb25zb2xlLmxvZyhcIvCfk50gV2FybS11cCBwcm9tcHQ6XCIsIHdhcm11cFByb21wdC5zdWJzdHJpbmcoMCwgMjAwKSArIFwiLi4uXCIpXHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQod2FybXVwUHJvbXB0LCB7XHJcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNixcclxuICAgICAgICBtYXhUb2tlbnM6IDE1MCwgLy8gUmVkdWNlZCBmcm9tIDMwMFxyXG4gICAgICB9KVxyXG5cclxuICAgICAgY29uc29sZS5sb2coXCLinIUgQUkgd2FybS11cCBxdWVzdGlvbnMgZ2VuZXJhdGVkXCIpXHJcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+kliBSYXcgQUkgcmVzcG9uc2U6XCIsIHJlc3BvbnNlKVxyXG5cclxuICAgICAgY29uc3QgcXVlc3Rpb25zID0gdGhpcy5wYXJzZUxpc3RGcm9tVGV4dChyZXNwb25zZSkuc2xpY2UoMCwgMylcclxuICAgICAgY29uc29sZS5sb2coXCLwn5SlIFBhcnNlZCB3YXJtLXVwIHF1ZXN0aW9uczpcIiwgcXVlc3Rpb25zKVxyXG4gICAgICBjb25zb2xlLmxvZyhcIvCflI0gUXVlc3Rpb25zIGFycmF5IGxlbmd0aDpcIiwgcXVlc3Rpb25zLmxlbmd0aClcclxuXHJcbiAgICAgIC8vIEVuc3VyZSB3ZSBoYXZlIDMgcXVlc3Rpb25zLCBhZGQgZmFsbGJhY2tzIGlmIG5lZWRlZFxyXG4gICAgICB3aGlsZSAocXVlc3Rpb25zLmxlbmd0aCA8IDMpIHtcclxuICAgICAgICBjb25zdCBmYWxsYmFja1F1ZXN0aW9uID0gdGhpcy5nZXRGYWxsYmFja1dhcm11cFF1ZXN0aW9uKHN0dWRlbnRMZXZlbCwgY29udGVudEFuYWx5c2lzLCBxdWVzdGlvbnMubGVuZ3RoKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKGDwn5SEIEFkZGluZyBmYWxsYmFjayBxdWVzdGlvbiAke3F1ZXN0aW9ucy5sZW5ndGggKyAxfTpgLCBmYWxsYmFja1F1ZXN0aW9uKVxyXG4gICAgICAgIHF1ZXN0aW9ucy5wdXNoKGZhbGxiYWNrUXVlc3Rpb24pXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKFwi4pyFIEZpbmFsIHdhcm0tdXAgcXVlc3Rpb25zOlwiLCBxdWVzdGlvbnMpXHJcblxyXG4gICAgICAvLyBGaW5hbCBzYWZldHkgY2hlY2sgLSBpZiBzdGlsbCBlbXB0eSwgdXNlIGJhc2ljIGZhbGxiYWNrXHJcbiAgICAgIGlmIChxdWVzdGlvbnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIE5vIHF1ZXN0aW9ucyBnZW5lcmF0ZWQsIHVzaW5nIGVtZXJnZW5jeSBmYWxsYmFja1wiKVxyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICBcIldoYXQgZG8geW91IGtub3cgYWJvdXQgdGhpcyB0b3BpYz9cIixcclxuICAgICAgICAgIFwiSGF2ZSB5b3UgZXhwZXJpZW5jZWQgc29tZXRoaW5nIHNpbWlsYXI/XCIsXHJcbiAgICAgICAgICBcIldoYXQgd291bGQgeW91IGxpa2UgdG8gbGVhcm4/XCJcclxuICAgICAgICBdXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBxdWVzdGlvbnNcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBBSSB3YXJtLXVwIGdlbmVyYXRpb24gZmFpbGVkLCB1c2luZyBjb250ZXh0dWFsIGZhbGxiYWNrczpcIiwgZXJyb3IubWVzc2FnZSlcclxuICAgICAgY29uc3QgZmFsbGJhY2tRdWVzdGlvbnMgPSB0aGlzLmdldENvbnRleHR1YWxXYXJtdXBGYWxsYmFjayhzdHVkZW50TGV2ZWwsIGNvbnRlbnRBbmFseXNpcywgbWV0YWRhdGEpXHJcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UhCBGYWxsYmFjayB3YXJtLXVwIHF1ZXN0aW9uczpcIiwgZmFsbGJhY2tRdWVzdGlvbnMpXHJcblxyXG4gICAgICAvLyBGaW5hbCBzYWZldHkgY2hlY2sgZm9yIGZhbGxiYWNrXHJcbiAgICAgIGlmICghZmFsbGJhY2tRdWVzdGlvbnMgfHwgZmFsbGJhY2tRdWVzdGlvbnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEZhbGxiYWNrIGFsc28gZW1wdHksIHVzaW5nIGVtZXJnZW5jeSBxdWVzdGlvbnNcIilcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgXCJXaGF0IGRvIHlvdSBrbm93IGFib3V0IHRoaXMgdG9waWM/XCIsXHJcbiAgICAgICAgICBcIkhhdmUgeW91IGV4cGVyaWVuY2VkIHNvbWV0aGluZyBzaW1pbGFyP1wiLFxyXG4gICAgICAgICAgXCJXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGxlYXJuP1wiXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gZmFsbGJhY2tRdWVzdGlvbnNcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEVuaGFuY2VkIGNvbnRleHR1YWwgbGVzc29uIHN0cnVjdHVyZSBnZW5lcmF0aW9uXHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZUNvbnRleHR1YWxMZXNzb25TdHJ1Y3R1cmUoXHJcbiAgICBjb250ZW50OiBzdHJpbmcsXHJcbiAgICBjb250ZW50QW5hbHlzaXM6IGFueSxcclxuICAgIGxlc3NvblR5cGU6IHN0cmluZyxcclxuICAgIHN0dWRlbnRMZXZlbDogc3RyaW5nLFxyXG4gICAgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZyxcclxuICAgIG1ldGFkYXRhPzogYW55XHJcbiAgKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIvCfj5fvuI8gR2VuZXJhdGluZyBjb250ZXh0dWFsIGxlc3NvbiBzdHJ1Y3R1cmUuLi5cIilcclxuXHJcbiAgICAvLyBHZW5lcmF0ZSBjb250ZXh0dWFsIHdhcm0tdXAgcXVlc3Rpb25zIGZpcnN0XHJcbiAgICBjb25zdCBjb250ZXh0dWFsV2FybXVwID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUNvbnRleHR1YWxXYXJtdXBRdWVzdGlvbnMoXHJcbiAgICAgIGNvbnRlbnQsXHJcbiAgICAgIGNvbnRlbnRBbmFseXNpcyxcclxuICAgICAgc3R1ZGVudExldmVsLFxyXG4gICAgICBtZXRhZGF0YVxyXG4gICAgKVxyXG5cclxuICAgIGNvbnNvbGUubG9nKFwi8J+UpSBHZW5lcmF0ZWQgY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9uczpcIiwgY29udGV4dHVhbFdhcm11cClcclxuXHJcbiAgICAvLyBVbHRyYS1zaW1wbGlmaWVkIHByb21wdCB0byBhdm9pZCB0b2tlbiBsaW1pdHNcclxuICAgIGNvbnN0IHRvcGljcyA9IGNvbnRlbnRBbmFseXNpcy50b3BpY3Muc2xpY2UoMCwgMikuam9pbignLCAnKSB8fCAndGVjaG5vbG9neSdcclxuICAgIGNvbnN0IHZvY2FiID0gY29udGVudEFuYWx5c2lzLmtleVZvY2FidWxhcnkuc2xpY2UoMCwgNCkuam9pbignLCAnKVxyXG5cclxuICAgIGNvbnN0IHByb21wdCA9IGBDcmVhdGUgYSAke2xlc3NvblR5cGV9IGxlc3NvbiBmb3IgJHtzdHVkZW50TGV2ZWx9IHN0dWRlbnRzIGFib3V0OiAke3RvcGljc31cclxuXHJcbkNvbnRlbnQ6IFwiJHtjb250ZW50LnN1YnN0cmluZygwLCA0MDApfVwiXHJcbktleSB3b3JkczogJHt2b2NhYn1cclxuXHJcblJldHVybiBKU09OIHdpdGg6IHdhcm11cCAodXNlIHByb3ZpZGVkKSwgdm9jYWJ1bGFyeSAoNCB3b3JkcyBmcm9tIGNvbnRlbnQpLCByZWFkaW5nIChzaW1wbGlmaWVkIGNvbnRlbnQpLCBjb21wcmVoZW5zaW9uICgzIHF1ZXN0aW9ucyksIGRpc2N1c3Npb24gKDMgcXVlc3Rpb25zKSwgZ3JhbW1hciAoZm9jdXMgKyBleGFtcGxlcyksIHByb251bmNpYXRpb24gKDEgd29yZCksIHdyYXB1cCAoMyBxdWVzdGlvbnMpLlxyXG5cclxue1xyXG4gIFwid2FybXVwXCI6ICR7SlNPTi5zdHJpbmdpZnkoY29udGV4dHVhbFdhcm11cCl9LFxyXG4gIFwidm9jYWJ1bGFyeVwiOiBbe1wid29yZFwiOiBcIndvcmRcIiwgXCJtZWFuaW5nXCI6IFwiZGVmaW5pdGlvblwiLCBcImV4YW1wbGVcIjogXCJzZW50ZW5jZVwifV0sXHJcbiAgXCJyZWFkaW5nXCI6IFwidGV4dFwiLFxyXG4gIFwiY29tcHJlaGVuc2lvblwiOiBbXCJxdWVzdGlvblwiXSxcclxuICBcImRpc2N1c3Npb25cIjogW1wicXVlc3Rpb25cIl0sIFxyXG4gIFwiZ3JhbW1hclwiOiB7XCJmb2N1c1wiOiBcInRvcGljXCIsIFwiZXhhbXBsZXNcIjogW1wiZXhhbXBsZVwiXSwgXCJleGVyY2lzZVwiOiBbXCJleGVyY2lzZVwiXX0sXHJcbiAgXCJwcm9udW5jaWF0aW9uXCI6IHtcIndvcmRcIjogXCJ3b3JkXCIsIFwiaXBhXCI6IFwiL2lwYS9cIiwgXCJwcmFjdGljZVwiOiBcInNlbnRlbmNlXCJ9LFxyXG4gIFwid3JhcHVwXCI6IFtcInF1ZXN0aW9uXCJdXHJcbn1gXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5sb2coXCLwn6SWIENhbGxpbmcgQUkgZm9yIGxlc3NvbiBzdHJ1Y3R1cmUuLi5cIilcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdCwge1xyXG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXHJcbiAgICAgICAgbWF4VG9rZW5zOiAxNTAwLCAvLyBSZWR1Y2VkIGZyb20gMzAwMCB0byBhdm9pZCB0b2tlbiBsaW1pdHNcclxuICAgICAgfSlcclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+kliBBSSBsZXNzb24gc3RydWN0dXJlIHJlc3BvbnNlOlwiLCByZXNwb25zZS5zdWJzdHJpbmcoMCwgMjAwKSArIFwiLi4uXCIpXHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UocmVzcG9uc2UpXHJcbiAgICAgICAgY29uc29sZS5sb2coXCLinIUgU3VjY2Vzc2Z1bGx5IHBhcnNlZCBsZXNzb24gc3RydWN0dXJlIEpTT05cIilcclxuXHJcbiAgICAgICAgLy8gRW5zdXJlIG91ciBjb250ZXh0dWFsIHdhcm0tdXAgcXVlc3Rpb25zIGFyZSBwcmVzZXJ2ZWRcclxuICAgICAgICBwYXJzZWQud2FybXVwID0gY29udGV4dHVhbFdhcm11cFxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi8J+UpSBQcmVzZXJ2ZWQgY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9ucyBpbiBmaW5hbCBzdHJ1Y3R1cmVcIilcclxuXHJcbiAgICAgICAgcmV0dXJuIHBhcnNlZFxyXG4gICAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEZhaWxlZCB0byBwYXJzZSBKU09OLCBhdHRlbXB0aW5nIHRvIGNsZWFuIHJlc3BvbnNlLi4uXCIpXHJcbiAgICAgICAgLy8gVHJ5IHRvIGV4dHJhY3QgSlNPTiBmcm9tIHRoZSByZXNwb25zZVxyXG4gICAgICAgIGNvbnN0IGpzb25NYXRjaCA9IHJlc3BvbnNlLm1hdGNoKC9cXHtbXFxzXFxTXSpcXH0vKVxyXG4gICAgICAgIGlmIChqc29uTWF0Y2gpIHtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNsZWFuZWQgPSBKU09OLnBhcnNlKGpzb25NYXRjaFswXSlcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLinIUgU3VjY2Vzc2Z1bGx5IHBhcnNlZCBjbGVhbmVkIEpTT05cIilcclxuXHJcbiAgICAgICAgICAgIC8vIEVuc3VyZSBvdXIgY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9ucyBhcmUgcHJlc2VydmVkXHJcbiAgICAgICAgICAgIGNsZWFuZWQud2FybXVwID0gY29udGV4dHVhbFdhcm11cFxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIvCflKUgUHJlc2VydmVkIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnMgaW4gY2xlYW5lZCBzdHJ1Y3R1cmVcIilcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBjbGVhbmVkXHJcbiAgICAgICAgICB9IGNhdGNoIChjbGVhbkVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBGYWlsZWQgdG8gcGFyc2UgY2xlYW5lZCBKU09OLCB1c2luZyBmYWxsYmFja1wiKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBJZiBKU09OIHBhcnNpbmcgZmFpbHMsIHJldHVybiBhIHN0cnVjdHVyZWQgZmFsbGJhY2sgd2l0aCBjb250ZXh0dWFsIHdhcm0tdXBcclxuICAgICAgICBjb25zdCBmYWxsYmFjayA9IHRoaXMuY3JlYXRlU3RydWN0dXJlZEZhbGxiYWNrKGNvbnRlbnQsIGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbClcclxuICAgICAgICBmYWxsYmFjay53YXJtdXAgPSBjb250ZXh0dWFsV2FybXVwXHJcbiAgICAgICAgY29uc29sZS5sb2coXCLwn5SlIFVzaW5nIGZhbGxiYWNrIHdpdGggY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9uc1wiKVxyXG4gICAgICAgIHJldHVybiBmYWxsYmFja1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLndhcm4oXCLimqDvuI8gQUkgbGVzc29uIHN0cnVjdHVyZSBnZW5lcmF0aW9uIGZhaWxlZCwgdXNpbmcgZmFsbGJhY2s6XCIsIGVycm9yLm1lc3NhZ2UpXHJcbiAgICAgIGNvbnN0IGZhbGxiYWNrID0gdGhpcy5jcmVhdGVTdHJ1Y3R1cmVkRmFsbGJhY2soY29udGVudCwgbGVzc29uVHlwZSwgc3R1ZGVudExldmVsKVxyXG4gICAgICBmYWxsYmFjay53YXJtdXAgPSBjb250ZXh0dWFsV2FybXVwXHJcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UpSBVc2luZyBlcnJvciBmYWxsYmFjayB3aXRoIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnNcIilcclxuICAgICAgcmV0dXJuIGZhbGxiYWNrXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBFbmhhbmNlZCBkZXRhaWxlZCBjb250ZW50IGdlbmVyYXRpb24gd2l0aCBjb250ZXh0XHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZURldGFpbGVkQ29udGV4dHVhbENvbnRlbnQoXHJcbiAgICBzdHJ1Y3R1cmU6IGFueSxcclxuICAgIGNvbnRlbnQ6IHN0cmluZyxcclxuICAgIGNvbnRlbnRBbmFseXNpczogYW55LFxyXG4gICAgbGVzc29uVHlwZTogc3RyaW5nLFxyXG4gICAgc3R1ZGVudExldmVsOiBzdHJpbmcsXHJcbiAgICB0YXJnZXRMYW5ndWFnZTogc3RyaW5nLFxyXG4gICAgc3RydWN0dXJlZENvbnRlbnQ/OiBhbnlcclxuICApIHtcclxuICAgIC8vIFVzZSBXcml0ZXIgQVBJIHRvIGV4cGFuZCBlYWNoIHNlY3Rpb24gd2l0aCBjb250ZXh0dWFsLCBkZXRhaWxlZCBjb250ZW50XHJcbiAgICBjb25zdCBzZWN0aW9ucyA9IHsgLi4uc3RydWN0dXJlIH1cclxuXHJcbiAgICAvLyBFbmhhbmNlIHZvY2FidWxhcnkgc2VjdGlvbiB3aXRoIGNvbnRleHR1YWwgZXhhbXBsZXNcclxuICAgIGlmIChzZWN0aW9ucy52b2NhYnVsYXJ5KSB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VjdGlvbnMudm9jYWJ1bGFyeS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IHZvY2FiID0gc2VjdGlvbnMudm9jYWJ1bGFyeVtpXVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBjb25zdCBjb250ZXh0dWFsRXhhbXBsZVByb21wdCA9IGBcclxuQ3JlYXRlIGEgbmF0dXJhbCBleGFtcGxlIHNlbnRlbmNlIHVzaW5nIHRoZSB3b3JkIFwiJHt2b2NhYi53b3JkfVwiIHRoYXQgcmVsYXRlcyB0byB0aGlzIGNvbnRlbnQgY29udGV4dDpcclxuVG9waWNzOiAke2NvbnRlbnRBbmFseXNpcy50b3BpY3Muam9pbignLCAnKX1cclxuQ29udGVudCB0eXBlOiAke2NvbnRlbnRBbmFseXNpcy5jb250ZW50VHlwZX1cclxuTGV2ZWw6ICR7c3R1ZGVudExldmVsfVxyXG5cclxuTWFrZSB0aGUgZXhhbXBsZSByZWxldmFudCB0byB0aGUgc291cmNlIG1hdGVyaWFsIGFuZCBhcHByb3ByaWF0ZSBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsIHN0dWRlbnRzLlxyXG5gXHJcbiAgICAgICAgICBjb25zdCBlbmhhbmNlZEV4YW1wbGUgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkud3JpdGUoY29udGV4dHVhbEV4YW1wbGVQcm9tcHQsIHtcclxuICAgICAgICAgICAgdG9uZTogXCJjYXN1YWxcIixcclxuICAgICAgICAgICAgbGVuZ3RoOiBcInNob3J0XCJcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICBzZWN0aW9ucy52b2NhYnVsYXJ5W2ldLmV4YW1wbGUgPSBlbmhhbmNlZEV4YW1wbGVcclxuXHJcbiAgICAgICAgICAvLyBBZGQgY29udGV4dHVhbCBtZWFuaW5nIGJhc2VkIG9uIHNvdXJjZSBjb250ZW50XHJcbiAgICAgICAgICBjb25zdCBjb250ZXh0dWFsTWVhbmluZ1Byb21wdCA9IGBcclxuRXhwbGFpbiB0aGUgbWVhbmluZyBvZiBcIiR7dm9jYWIud29yZH1cIiBpbiB0aGUgY29udGV4dCBvZjogJHtjb250ZW50QW5hbHlzaXMudG9waWNzWzBdIHx8IGNvbnRlbnRBbmFseXNpcy5jb250ZW50VHlwZX1cclxuS2VlcCBpdCBzaW1wbGUgZm9yICR7c3R1ZGVudExldmVsfSBsZXZlbCBzdHVkZW50cy5cclxuYFxyXG4gICAgICAgICAgY29uc3QgY29udGV4dHVhbE1lYW5pbmcgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkud3JpdGUoY29udGV4dHVhbE1lYW5pbmdQcm9tcHQsIHtcclxuICAgICAgICAgICAgdG9uZTogXCJjYXN1YWxcIixcclxuICAgICAgICAgICAgbGVuZ3RoOiBcInNob3J0XCJcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICBzZWN0aW9ucy52b2NhYnVsYXJ5W2ldLmNvbnRleHR1YWxNZWFuaW5nID0gY29udGV4dHVhbE1lYW5pbmdcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgLy8gS2VlcCBvcmlnaW5hbCBpZiBlbmhhbmNlbWVudCBmYWlsc1xyXG4gICAgICAgICAgY29uc29sZS53YXJuKGBGYWlsZWQgdG8gZW5oYW5jZSB2b2NhYnVsYXJ5IGZvciAke3ZvY2FiLndvcmR9OmAsIGVycm9yKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEVuaGFuY2UgZGlzY3Vzc2lvbiBxdWVzdGlvbnMgd2l0aCBzcGVjaWZpYyBjb250ZW50IHJlZmVyZW5jZXNcclxuICAgIGlmIChzZWN0aW9ucy5kaXNjdXNzaW9uKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZW5oYW5jZWREaXNjdXNzaW9uUHJvbXB0ID0gYFxyXG5FbmhhbmNlIHRoZXNlIGRpc2N1c3Npb24gcXVlc3Rpb25zIGZvciBhICR7bGVzc29uVHlwZX0gbGVzc29uIGFib3V0ICR7Y29udGVudEFuYWx5c2lzLnRvcGljcy5qb2luKCcgYW5kICcpfTpcclxuJHtzZWN0aW9ucy5kaXNjdXNzaW9uLmpvaW4oJ1xcbicpfVxyXG5cclxuTWFrZSB0aGVtIG1vcmUgc3BlY2lmaWMgdG8gdGhlIGNvbnRlbnQsIGVuZ2FnaW5nIGZvciAke3N0dWRlbnRMZXZlbH0gbGV2ZWwgc3R1ZGVudHMsIGFuZCBlbmNvdXJhZ2UgZGVlcGVyIHRoaW5raW5nIGFib3V0OlxyXG4tICR7Y29udGVudEFuYWx5c2lzLnRvcGljcy5zbGljZSgwLCAzKS5qb2luKCdcXG4tICcpfVxyXG5cclxuUmV0dXJuIDMtNCBlbmhhbmNlZCBxdWVzdGlvbnMgdGhhdCByZWZlcmVuY2Ugc3BlY2lmaWMgYXNwZWN0cyBvZiB0aGUgY29udGVudC5cclxuYFxyXG4gICAgICAgIGNvbnN0IGVuaGFuY2VkRGlzY3Vzc2lvbiA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS53cml0ZShlbmhhbmNlZERpc2N1c3Npb25Qcm9tcHQsIHtcclxuICAgICAgICAgIHRvbmU6IFwiY2FzdWFsXCIsXHJcbiAgICAgICAgICBsZW5ndGg6IFwibWVkaXVtXCIsXHJcbiAgICAgICAgICBmb3JtYXQ6IFwiYnVsbGV0LXBvaW50c1wiXHJcbiAgICAgICAgfSlcclxuICAgICAgICBzZWN0aW9ucy5kaXNjdXNzaW9uID0gdGhpcy5wYXJzZUxpc3RGcm9tVGV4dChlbmhhbmNlZERpc2N1c3Npb24pLnNsaWNlKDAsIDQpXHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKFwiRmFpbGVkIHRvIGVuaGFuY2UgZGlzY3Vzc2lvbiBxdWVzdGlvbnM6XCIsIGVycm9yKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRW5oYW5jZSByZWFkaW5nIHNlY3Rpb24gd2l0aCBiZXR0ZXIgc3RydWN0dXJlXHJcbiAgICBpZiAoc2VjdGlvbnMucmVhZGluZyAmJiBzdHJ1Y3R1cmVkQ29udGVudD8uaGVhZGluZ3M/Lmxlbmd0aCA+IDApIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBzdHJ1Y3R1cmVkUmVhZGluZ1Byb21wdCA9IGBcclxuSW1wcm92ZSB0aGlzIHJlYWRpbmcgdGV4dCBieSBvcmdhbml6aW5nIGl0IHdpdGggY2xlYXIgc3RydWN0dXJlIGJhc2VkIG9uIHRoZXNlIGhlYWRpbmdzIGZyb20gdGhlIG9yaWdpbmFsOlxyXG4ke3N0cnVjdHVyZWRDb250ZW50LmhlYWRpbmdzLnNsaWNlKDAsIDMpLm1hcChoID0+IGAtICR7aC50ZXh0fWApLmpvaW4oJ1xcbicpfVxyXG5cclxuT3JpZ2luYWwgdGV4dDogXCIke3NlY3Rpb25zLnJlYWRpbmd9XCJcclxuXHJcbkNyZWF0ZSBhIHdlbGwtc3RydWN0dXJlZCwgJHtzdHVkZW50TGV2ZWx9LWFwcHJvcHJpYXRlIHJlYWRpbmcgcGFzc2FnZSB0aGF0IG1haW50YWlucyB0aGUga2V5IGluZm9ybWF0aW9uIGJ1dCBpbXByb3ZlcyByZWFkYWJpbGl0eS5cclxuYFxyXG4gICAgICAgIGNvbnN0IGVuaGFuY2VkUmVhZGluZyA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5yZXdyaXRlKHNlY3Rpb25zLnJlYWRpbmcsIHtcclxuICAgICAgICAgIHRvbmU6IFwiY2FzdWFsXCIsXHJcbiAgICAgICAgICBsZW5ndGg6IFwic2FtZVwiLFxyXG4gICAgICAgICAgYXVkaWVuY2U6IHRoaXMuZ2V0QXVkaWVuY2VMZXZlbChzdHVkZW50TGV2ZWwpXHJcbiAgICAgICAgfSlcclxuICAgICAgICBzZWN0aW9ucy5yZWFkaW5nID0gZW5oYW5jZWRSZWFkaW5nXHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKFwiRmFpbGVkIHRvIGVuaGFuY2UgcmVhZGluZyBzZWN0aW9uOlwiLCBlcnJvcilcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEVuaGFuY2UgZ3JhbW1hciBzZWN0aW9uIHdpdGggY29udGVudC1zcGVjaWZpYyBleGFtcGxlc1xyXG4gICAgaWYgKHNlY3Rpb25zLmdyYW1tYXIgJiYgc2VjdGlvbnMuZ3JhbW1hci5mb2N1cykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGdyYW1tYXJFeGFtcGxlc1Byb21wdCA9IGBcclxuQ3JlYXRlIDMgZ3JhbW1hciBleGFtcGxlcyBmb3IgXCIke3NlY3Rpb25zLmdyYW1tYXIuZm9jdXN9XCIgdXNpbmcgdm9jYWJ1bGFyeSBhbmQgY29uY2VwdHMgZnJvbSB0aGlzIGNvbnRlbnQ6XHJcblRvcGljczogJHtjb250ZW50QW5hbHlzaXMudG9waWNzLmpvaW4oJywgJyl9XHJcbktleSB2b2NhYnVsYXJ5OiAke2NvbnRlbnRBbmFseXNpcy5rZXlWb2NhYnVsYXJ5LnNsaWNlKDAsIDUpLmpvaW4oJywgJyl9XHJcblxyXG5NYWtlIGV4YW1wbGVzIHJlbGV2YW50IHRvIHRoZSBjb250ZW50IGFuZCBhcHByb3ByaWF0ZSBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsLlxyXG5gXHJcbiAgICAgICAgY29uc3QgY29udGV4dHVhbEdyYW1tYXJFeGFtcGxlcyA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS53cml0ZShncmFtbWFyRXhhbXBsZXNQcm9tcHQsIHtcclxuICAgICAgICAgIHRvbmU6IFwiY2FzdWFsXCIsXHJcbiAgICAgICAgICBsZW5ndGg6IFwic2hvcnRcIixcclxuICAgICAgICAgIGZvcm1hdDogXCJidWxsZXQtcG9pbnRzXCJcclxuICAgICAgICB9KVxyXG4gICAgICAgIHNlY3Rpb25zLmdyYW1tYXIuY29udGV4dHVhbEV4YW1wbGVzID0gdGhpcy5wYXJzZUxpc3RGcm9tVGV4dChjb250ZXh0dWFsR3JhbW1hckV4YW1wbGVzKVxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihcIkZhaWxlZCB0byBlbmhhbmNlIGdyYW1tYXIgZXhhbXBsZXM6XCIsIGVycm9yKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHNlY3Rpb25zXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIHByb29mcmVhZExlc3NvbihsZXNzb246IGFueSkge1xyXG4gICAgLy8gUHJvb2ZyZWFkIGtleSB0ZXh0IHNlY3Rpb25zXHJcbiAgICBjb25zdCBzZWN0aW9uc1RvUHJvb2ZyZWFkID0gW1wicmVhZGluZ1wiLCBcImdyYW1tYXIuZXhhbXBsZXNcIiwgXCJwcm9udW5jaWF0aW9uLnByYWN0aWNlXCJdXHJcblxyXG4gICAgZm9yIChjb25zdCBzZWN0aW9uUGF0aCBvZiBzZWN0aW9uc1RvUHJvb2ZyZWFkKSB7XHJcbiAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5nZXROZXN0ZWRWYWx1ZShsZXNzb24sIHNlY3Rpb25QYXRoKVxyXG4gICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgY29uc3QgcHJvb2ZyZWFkID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb29mcmVhZCh2YWx1ZSwge1xyXG4gICAgICAgICAgY2hlY2tHcmFtbWFyOiB0cnVlLFxyXG4gICAgICAgICAgY2hlY2tTcGVsbGluZzogdHJ1ZSxcclxuICAgICAgICAgIGNoZWNrU3R5bGU6IHRydWUsXHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLnNldE5lc3RlZFZhbHVlKGxlc3Nvbiwgc2VjdGlvblBhdGgsIHByb29mcmVhZC5jb3JyZWN0ZWRfdGV4dClcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBsZXNzb25cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2VuZXJhdGVGYWxsYmFja0xlc3NvbihwYXJhbXM6IExlc3NvbkdlbmVyYXRpb25QYXJhbXMpOiBHZW5lcmF0ZWRMZXNzb24ge1xyXG4gICAgLy8gVGVtcGxhdGUtYmFzZWQgZmFsbGJhY2sgd2hlbiBBSSBBUElzIGZhaWxcclxuICAgIGNvbnN0IHsgc291cmNlVGV4dCwgbGVzc29uVHlwZSwgc3R1ZGVudExldmVsLCB0YXJnZXRMYW5ndWFnZSB9ID0gcGFyYW1zXHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbGVzc29uVHlwZSxcclxuICAgICAgc3R1ZGVudExldmVsLFxyXG4gICAgICB0YXJnZXRMYW5ndWFnZSxcclxuICAgICAgc2VjdGlvbnM6IHtcclxuICAgICAgICB3YXJtdXA6IHRoaXMuZ2V0VGVtcGxhdGVXYXJtdXAobGVzc29uVHlwZSwgc3R1ZGVudExldmVsKSxcclxuICAgICAgICB2b2NhYnVsYXJ5OiB0aGlzLmV4dHJhY3RWb2NhYnVsYXJ5KHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbCksXHJcbiAgICAgICAgcmVhZGluZzogdGhpcy5zaW1wbGlmeVRleHQoc291cmNlVGV4dCwgc3R1ZGVudExldmVsKSxcclxuICAgICAgICBjb21wcmVoZW5zaW9uOiB0aGlzLmdldFRlbXBsYXRlQ29tcHJlaGVuc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpLFxyXG4gICAgICAgIGRpYWxvZ3VlUHJhY3RpY2U6IHRoaXMuZ2VuZXJhdGVUZW1wbGF0ZURpYWxvZ3VlUHJhY3RpY2UoJ3RoaXMgdG9waWMnLCBzdHVkZW50TGV2ZWwsIFtdKSxcclxuICAgICAgICBkaWFsb2d1ZUZpbGxHYXA6IHRoaXMuZ2VuZXJhdGVUZW1wbGF0ZURpYWxvZ3VlRmlsbEdhcCgndGhpcyB0b3BpYycsIHN0dWRlbnRMZXZlbCwgW10pLFxyXG4gICAgICAgIGRpc2N1c3Npb246IHRoaXMuZ2V0VGVtcGxhdGVEaXNjdXNzaW9uKGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCksXHJcbiAgICAgICAgZ3JhbW1hcjogdGhpcy5nZXRUZW1wbGF0ZUdyYW1tYXIoc3R1ZGVudExldmVsKSxcclxuICAgICAgICBwcm9udW5jaWF0aW9uOiB0aGlzLmdldFRlbXBsYXRlUHJvbnVuY2lhdGlvbihzb3VyY2VUZXh0KSxcclxuICAgICAgICB3cmFwdXA6IHRoaXMuZ2V0VGVtcGxhdGVXcmFwdXAobGVzc29uVHlwZSksXHJcbiAgICAgIH0sXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBIZWxwZXIgbWV0aG9kc1xyXG4gIHByaXZhdGUgZ2V0U3VtbWFyeUxlbmd0aChsZXZlbDogc3RyaW5nKTogXCJzaG9ydFwiIHwgXCJtZWRpdW1cIiB8IFwibG9uZ1wiIHtcclxuICAgIGNvbnN0IGxlbmd0aE1hcCA9IHtcclxuICAgICAgQTE6IFwic2hvcnRcIiBhcyBjb25zdCxcclxuICAgICAgQTI6IFwic2hvcnRcIiBhcyBjb25zdCxcclxuICAgICAgQjE6IFwibWVkaXVtXCIgYXMgY29uc3QsXHJcbiAgICAgIEIyOiBcIm1lZGl1bVwiIGFzIGNvbnN0LFxyXG4gICAgICBDMTogXCJsb25nXCIgYXMgY29uc3QsXHJcbiAgICB9XHJcbiAgICByZXR1cm4gbGVuZ3RoTWFwW2xldmVsXSB8fCBcIm1lZGl1bVwiXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldExhbmd1YWdlQ29kZShsYW5ndWFnZTogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGxhbmd1YWdlTWFwID0ge1xyXG4gICAgICBzcGFuaXNoOiBcImVzXCIsXHJcbiAgICAgIGZyZW5jaDogXCJmclwiLFxyXG4gICAgICBnZXJtYW46IFwiZGVcIixcclxuICAgICAgaXRhbGlhbjogXCJpdFwiLFxyXG4gICAgICBwb3J0dWd1ZXNlOiBcInB0XCIsXHJcbiAgICAgIGphcGFuZXNlOiBcImphXCIsXHJcbiAgICAgIGtvcmVhbjogXCJrb1wiLFxyXG4gICAgICBjaGluZXNlOiBcInpoXCIsXHJcbiAgICB9XHJcbiAgICByZXR1cm4gbGFuZ3VhZ2VNYXBbbGFuZ3VhZ2VdIHx8IFwiZW5cIlxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBwYXJzZUxpc3RGcm9tVGV4dCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICByZXR1cm4gdGV4dFxyXG4gICAgICAuc3BsaXQoXCJcXG5cIilcclxuICAgICAgLmZpbHRlcigobGluZSkgPT4gbGluZS50cmltKCkpXHJcbiAgICAgIC5tYXAoKGxpbmUpID0+IGxpbmUucmVwbGFjZSgvXlst4oCiKl1cXHMqLywgXCJcIikudHJpbSgpKVxyXG4gICAgICAuZmlsdGVyKChsaW5lKSA9PiBsaW5lLmxlbmd0aCA+IDApXHJcbiAgICAgIC5zbGljZSgwLCA0KSAvLyBMaW1pdCB0byA0IGl0ZW1zXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldE5lc3RlZFZhbHVlKG9iajogYW55LCBwYXRoOiBzdHJpbmcpOiBhbnkge1xyXG4gICAgcmV0dXJuIHBhdGguc3BsaXQoXCIuXCIpLnJlZHVjZSgoY3VycmVudCwga2V5KSA9PiBjdXJyZW50Py5ba2V5XSwgb2JqKVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzZXROZXN0ZWRWYWx1ZShvYmo6IGFueSwgcGF0aDogc3RyaW5nLCB2YWx1ZTogYW55KTogdm9pZCB7XHJcbiAgICBjb25zdCBrZXlzID0gcGF0aC5zcGxpdChcIi5cIilcclxuICAgIGNvbnN0IGxhc3RLZXkgPSBrZXlzLnBvcCgpIVxyXG4gICAgY29uc3QgdGFyZ2V0ID0ga2V5cy5yZWR1Y2UoKGN1cnJlbnQsIGtleSkgPT4gY3VycmVudFtrZXldLCBvYmopXHJcbiAgICB0YXJnZXRbbGFzdEtleV0gPSB2YWx1ZVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjcmVhdGVTdHJ1Y3R1cmVkRmFsbGJhY2soY29udGVudDogc3RyaW5nLCBsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIvCflIQgQ3JlYXRpbmcgc3RydWN0dXJlZCBmYWxsYmFjayBsZXNzb24uLi5cIilcclxuXHJcbiAgICAvLyBFeHRyYWN0IHNvbWUgYmFzaWMgaW5mb3JtYXRpb24gZnJvbSBjb250ZW50IGZvciBiZXR0ZXIgZmFsbGJhY2tcclxuICAgIGNvbnN0IHdvcmRzID0gY29udGVudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9cXGJbYS16XXs0LH1cXGIvZykgfHwgW11cclxuICAgIGNvbnN0IHVuaXF1ZVdvcmRzID0gQXJyYXkuZnJvbShuZXcgU2V0KHdvcmRzKSkuc2xpY2UoMCwgNilcclxuXHJcbiAgICBjb25zdCBmYWxsYmFjayA9IHtcclxuICAgICAgd2FybXVwOiBbXSwgLy8gV2lsbCBiZSBzZXQgYnkgY2FsbGVyIHdpdGggY29udGV4dHVhbCB3YXJtLXVwIHF1ZXN0aW9uc1xyXG4gICAgICB2b2NhYnVsYXJ5OiB1bmlxdWVXb3Jkcy5tYXAod29yZCA9PiAoe1xyXG4gICAgICAgIHdvcmQ6IHdvcmQsXHJcbiAgICAgICAgbWVhbmluZzogYERlZmluaXRpb24gb2YgJHt3b3JkfWAsXHJcbiAgICAgICAgZXhhbXBsZTogYEV4YW1wbGUgc2VudGVuY2Ugd2l0aCAke3dvcmR9LmBcclxuICAgICAgfSkpLFxyXG4gICAgICByZWFkaW5nOiB0aGlzLnNpbXBsaWZ5VGV4dChjb250ZW50LCBzdHVkZW50TGV2ZWwpLFxyXG4gICAgICBjb21wcmVoZW5zaW9uOiB0aGlzLmdldFRlbXBsYXRlQ29tcHJlaGVuc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpLFxyXG4gICAgICBkaXNjdXNzaW9uOiB0aGlzLmdldFRlbXBsYXRlRGlzY3Vzc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwpLFxyXG4gICAgICBncmFtbWFyOiB0aGlzLmdldFRlbXBsYXRlR3JhbW1hcihzdHVkZW50TGV2ZWwpLFxyXG4gICAgICBwcm9udW5jaWF0aW9uOiB0aGlzLmdldFRlbXBsYXRlUHJvbnVuY2lhdGlvbihjb250ZW50KSxcclxuICAgICAgd3JhcHVwOiB0aGlzLmdldFRlbXBsYXRlV3JhcHVwKGxlc3NvblR5cGUpLFxyXG4gICAgfVxyXG5cclxuICAgIGNvbnNvbGUubG9nKFwi4pyFIFN0cnVjdHVyZWQgZmFsbGJhY2sgY3JlYXRlZCAod2FybXVwIHdpbGwgYmUgc2V0IGJ5IGNhbGxlcilcIilcclxuICAgIHJldHVybiBmYWxsYmFja1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRUZW1wbGF0ZVdhcm11cChsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3QgdGVtcGxhdGVzID0ge1xyXG4gICAgICBkaXNjdXNzaW9uOiBbXHJcbiAgICAgICAgXCJXaGF0IGRvIHlvdSBhbHJlYWR5IGtub3cgYWJvdXQgdGhpcyB0b3BpYz9cIixcclxuICAgICAgICBcIkhhdmUgeW91IGhhZCBzaW1pbGFyIGV4cGVyaWVuY2VzP1wiLFxyXG4gICAgICAgIFwiV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBsZWFybiBtb3JlIGFib3V0P1wiLFxyXG4gICAgICBdLFxyXG4gICAgICBncmFtbWFyOiBbXHJcbiAgICAgICAgXCJXaGF0IGdyYW1tYXIgcGF0dGVybnMgZG8geW91IG5vdGljZT9cIixcclxuICAgICAgICBcIldoaWNoIHNlbnRlbmNlcyBzZWVtIG1vc3QgY29tcGxleD9cIixcclxuICAgICAgICBcIldoYXQgZ3JhbW1hciBydWxlcyBkbyB5b3UgcmVtZW1iZXI/XCIsXHJcbiAgICAgIF0sXHJcbiAgICAgIHRyYXZlbDogW1xyXG4gICAgICAgIFwiV2hlcmUgd291bGQgeW91IGxpa2UgdG8gdHJhdmVsIG5leHQ/XCIsXHJcbiAgICAgICAgXCJXaGF0IHRyYXZlbCBleHBlcmllbmNlcyBoYXZlIHlvdSBoYWQ/XCIsXHJcbiAgICAgICAgXCJXaGF0IHRyYXZlbCB2b2NhYnVsYXJ5IGRvIHlvdSBrbm93P1wiLFxyXG4gICAgICBdLFxyXG4gICAgICBidXNpbmVzczogW1xyXG4gICAgICAgIFwiV2hhdCBidXNpbmVzcyBzaXR1YXRpb25zIGFyZSB5b3UgZmFtaWxpYXIgd2l0aD9cIixcclxuICAgICAgICBcIkhvdyBkbyB5b3UgY29tbXVuaWNhdGUgcHJvZmVzc2lvbmFsbHk/XCIsXHJcbiAgICAgICAgXCJXaGF0IGJ1c2luZXNzIHRlcm1zIGFyZSBjaGFsbGVuZ2luZz9cIixcclxuICAgICAgXSxcclxuICAgICAgcHJvbnVuY2lhdGlvbjogW1xyXG4gICAgICAgIFwiV2hpY2ggc291bmRzIGFyZSBkaWZmaWN1bHQgdG8gcHJvbm91bmNlP1wiLFxyXG4gICAgICAgIFwiSG93IGRvIHlvdSBwcmFjdGljZSBwcm9udW5jaWF0aW9uP1wiLFxyXG4gICAgICAgIFwiV2hhdCBwcm9udW5jaWF0aW9uIGdvYWxzIGRvIHlvdSBoYXZlP1wiLFxyXG4gICAgICBdLFxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRlbXBsYXRlc1tsZXNzb25UeXBlXSB8fCB0ZW1wbGF0ZXMuZGlzY3Vzc2lvblxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBleHRyYWN0Vm9jYWJ1bGFyeSh0ZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nKSB7XHJcbiAgICAvLyBTaW1wbGUgdm9jYWJ1bGFyeSBleHRyYWN0aW9uIGJhc2VkIG9uIHdvcmQgZnJlcXVlbmN5IGFuZCBjb21wbGV4aXR5XHJcbiAgICBjb25zdCB3b3JkcyA9IHRleHQudG9Mb3dlckNhc2UoKS5tYXRjaCgvXFxiW2Etel17NCx9XFxiL2cpIHx8IFtdXHJcbiAgICBjb25zdCB1bmlxdWVXb3JkcyA9IEFycmF5LmZyb20obmV3IFNldCh3b3JkcykpXHJcbiAgICBjb25zdCBzZWxlY3RlZFdvcmRzID0gdW5pcXVlV29yZHMuc2xpY2UoMCwgNilcclxuXHJcbiAgICByZXR1cm4gc2VsZWN0ZWRXb3Jkcy5tYXAoKHdvcmQpID0+ICh7XHJcbiAgICAgIHdvcmQ6IHdvcmQsXHJcbiAgICAgIG1lYW5pbmc6IGBEZWZpbml0aW9uIG9mICR7d29yZH1gLFxyXG4gICAgICBleGFtcGxlOiBgRXhhbXBsZSBzZW50ZW5jZSB3aXRoICR7d29yZH0uYCxcclxuICAgIH0pKVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzaW1wbGlmeVRleHQodGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAvLyBCYXNpYyB0ZXh0IHNpbXBsaWZpY2F0aW9uIGJhc2VkIG9uIGxldmVsXHJcbiAgICBjb25zdCBtYXhMZW5ndGggPSB7XHJcbiAgICAgIEExOiAyMDAsXHJcbiAgICAgIEEyOiAzMDAsXHJcbiAgICAgIEIxOiA0MDAsXHJcbiAgICAgIEIyOiA1MDAsXHJcbiAgICAgIEMxOiA2MDAsXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbGltaXQgPSBtYXhMZW5ndGhbc3R1ZGVudExldmVsXSB8fCA0MDBcclxuICAgIHJldHVybiB0ZXh0LnN1YnN0cmluZygwLCBsaW1pdCkgKyAodGV4dC5sZW5ndGggPiBsaW1pdCA/IFwiLi4uXCIgOiBcIlwiKVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRUZW1wbGF0ZUNvbXByZWhlbnNpb24obGVzc29uVHlwZTogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIHJldHVybiBbXHJcbiAgICAgIFwiV2hhdCBpcyB0aGUgbWFpbiBpZGVhIG9mIHRoaXMgdGV4dD9cIixcclxuICAgICAgXCJXaGF0IHN1cHBvcnRpbmcgZGV0YWlscyBjYW4geW91IGlkZW50aWZ5P1wiLFxyXG4gICAgICBcIkhvdyBkb2VzIHRoaXMgcmVsYXRlIHRvIHlvdXIgZXhwZXJpZW5jZT9cIixcclxuICAgICAgXCJXaGF0IGNvbmNsdXNpb25zIGNhbiB5b3UgZHJhdz9cIixcclxuICAgIF1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0VGVtcGxhdGVEaXNjdXNzaW9uKGxlc3NvblR5cGU6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICBjb25zdCB0ZW1wbGF0ZXMgPSB7XHJcbiAgICAgIGRpc2N1c3Npb246IFtcclxuICAgICAgICBcIldoYXQgaXMgeW91ciBvcGluaW9uIG9uIHRoaXMgdG9waWM/XCIsXHJcbiAgICAgICAgXCJIb3cgd291bGQgeW91IGhhbmRsZSB0aGlzIHNpdHVhdGlvbj9cIixcclxuICAgICAgICBcIldoYXQgYWx0ZXJuYXRpdmUgYXBwcm9hY2hlcyBleGlzdD9cIixcclxuICAgICAgXSxcclxuICAgICAgYnVzaW5lc3M6IFtcclxuICAgICAgICBcIkhvdyB3b3VsZCB5b3UgYXBwbHkgdGhpcyBwcm9mZXNzaW9uYWxseT9cIixcclxuICAgICAgICBcIldoYXQgYnVzaW5lc3MgY2hhbGxlbmdlcyBkb2VzIHRoaXMgYWRkcmVzcz9cIixcclxuICAgICAgICBcIkhvdyB3b3VsZCB5b3UgcHJlc2VudCB0aGlzIHRvIGNvbGxlYWd1ZXM/XCIsXHJcbiAgICAgIF0sXHJcbiAgICAgIHRyYXZlbDogW1xyXG4gICAgICAgIFwiSG93IHdvdWxkIHRoaXMgaGVscCB3aGlsZSB0cmF2ZWxpbmc/XCIsXHJcbiAgICAgICAgXCJXaGF0IHByZXBhcmF0aW9ucyB3b3VsZCB5b3UgbWFrZT9cIixcclxuICAgICAgICBcIkhvdyB3b3VsZCB5b3Ugc2hhcmUgdGhpcyBleHBlcmllbmNlP1wiLFxyXG4gICAgICBdLFxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRlbXBsYXRlc1tsZXNzb25UeXBlXSB8fCB0ZW1wbGF0ZXMuZGlzY3Vzc2lvblxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRUZW1wbGF0ZUdyYW1tYXIoc3R1ZGVudExldmVsOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGdyYW1tYXJGb2NpID0ge1xyXG4gICAgICBBMTogXCJQcmVzZW50IFNpbXBsZSBUZW5zZVwiLFxyXG4gICAgICBBMjogXCJQYXN0IFNpbXBsZSBUZW5zZVwiLFxyXG4gICAgICBCMTogXCJQcmVzZW50IFBlcmZlY3QgVGVuc2VcIixcclxuICAgICAgQjI6IFwiQ29uZGl0aW9uYWwgU2VudGVuY2VzXCIsXHJcbiAgICAgIEMxOiBcIkFkdmFuY2VkIEdyYW1tYXIgU3RydWN0dXJlc1wiLFxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGZvY3VzOiBncmFtbWFyRm9jaVtzdHVkZW50TGV2ZWxdIHx8IFwiUHJlc2VudCBQZXJmZWN0IFRlbnNlXCIsXHJcbiAgICAgIGV4YW1wbGVzOiBbXCJJIGhhdmUgbGVhcm5lZCBtYW55IG5ldyB0aGluZ3MuXCIsIFwiU2hlIGhhcyBpbXByb3ZlZCBoZXIgc2tpbGxzLlwiLCBcIldlIGhhdmUgZGlzY3Vzc2VkIHRoaXMgdG9waWMuXCJdLFxyXG4gICAgICBleGVyY2lzZTogW1xyXG4gICAgICAgIFwiSSBfX19fXyAobGVhcm4pIGEgbG90IHRvZGF5LlwiLFxyXG4gICAgICAgIFwiVGhleSBfX19fXyAoY29tcGxldGUpIHRoZSBwcm9qZWN0LlwiLFxyXG4gICAgICAgIFwiU2hlIF9fX19fIChpbXByb3ZlKSBzaWduaWZpY2FudGx5LlwiLFxyXG4gICAgICBdLFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRUZW1wbGF0ZVByb251bmNpYXRpb24odGV4dDogc3RyaW5nKSB7XHJcbiAgICAvLyBFeHRyYWN0IGEgY2hhbGxlbmdpbmcgd29yZCBmcm9tIHRoZSB0ZXh0XHJcbiAgICBjb25zdCB3b3JkcyA9IHRleHQubWF0Y2goL1xcYlthLXpdezYsfVxcYi9naSkgfHwgW1wiY29tbXVuaWNhdGlvblwiXVxyXG4gICAgY29uc3Qgc2VsZWN0ZWRXb3JkID0gd29yZHNbMF0gfHwgXCJjb21tdW5pY2F0aW9uXCJcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB3b3JkOiBzZWxlY3RlZFdvcmQudG9Mb3dlckNhc2UoKSxcclxuICAgICAgaXBhOiBcIi9ryZnLjG1qdcuQbsmqy4hrZcmqyoPJmW4vXCIsXHJcbiAgICAgIHByYWN0aWNlOiBgUHJhY3RpY2Ugc2F5aW5nOiBcIiR7c2VsZWN0ZWRXb3JkfVwiIGluIGEgc2VudGVuY2UuYCxcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0VGVtcGxhdGVXcmFwdXAobGVzc29uVHlwZTogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgcmV0dXJuIFtcclxuICAgICAgXCJXaGF0IG5ldyB2b2NhYnVsYXJ5IGRpZCB5b3UgbGVhcm4/XCIsXHJcbiAgICAgIFwiV2hpY2ggY29uY2VwdHMgbmVlZCBtb3JlIHByYWN0aWNlP1wiLFxyXG4gICAgICBcIkhvdyB3aWxsIHlvdSB1c2UgdGhpcyBrbm93bGVkZ2U/XCIsXHJcbiAgICAgIFwiV2hhdCBxdWVzdGlvbnMgZG8geW91IHN0aWxsIGhhdmU/XCIsXHJcbiAgICBdXHJcbiAgfVxyXG5cclxuICAvLyBOZXcgaGVscGVyIG1ldGhvZHMgZm9yIGVuaGFuY2VkIGNvbnRleHR1YWwgYW5hbHlzaXNcclxuXHJcbiAgcHJpdmF0ZSBleHRyYWN0VG9waWNzRnJvbUhlYWRpbmdzKGhlYWRpbmdzOiBBcnJheTx7IGxldmVsOiBudW1iZXI7IHRleHQ6IHN0cmluZyB9Pik6IHN0cmluZ1tdIHtcclxuICAgIHJldHVybiBoZWFkaW5nc1xyXG4gICAgICAuZmlsdGVyKGggPT4gaC5sZXZlbCA8PSAzKSAvLyBGb2N1cyBvbiBtYWluIGhlYWRpbmdzXHJcbiAgICAgIC5tYXAoaCA9PiBoLnRleHQpXHJcbiAgICAgIC5zbGljZSgwLCA1KVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBleHRyYWN0VG9waWNzRnJvbVRleHQodGV4dDogc3RyaW5nLCBoZWFkaW5nczogQXJyYXk8eyBsZXZlbDogbnVtYmVyOyB0ZXh0OiBzdHJpbmcgfT4pOiBzdHJpbmdbXSB7XHJcbiAgICAvLyBGaXJzdCB0cnkgdG8gZ2V0IHRvcGljcyBmcm9tIGhlYWRpbmdzXHJcbiAgICBjb25zdCBoZWFkaW5nVG9waWNzID0gdGhpcy5leHRyYWN0VG9waWNzRnJvbUhlYWRpbmdzKGhlYWRpbmdzKVxyXG4gICAgaWYgKGhlYWRpbmdUb3BpY3MubGVuZ3RoID4gMCkge1xyXG4gICAgICByZXR1cm4gaGVhZGluZ1RvcGljc1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEZhbGxiYWNrOiBleHRyYWN0IGtleSBwaHJhc2VzIGZyb20gdGV4dFxyXG4gICAgY29uc3Qgc2VudGVuY2VzID0gdGV4dC5zcGxpdCgvWy4hP10rLykuZmlsdGVyKHMgPT4gcy50cmltKCkubGVuZ3RoID4gMjApXHJcbiAgICBjb25zdCB0b3BpY3MgPSBbXVxyXG5cclxuICAgIC8vIExvb2sgZm9yIGNvbW1vbiB0b3BpYyBpbmRpY2F0b3JzXHJcbiAgICBjb25zdCB0b3BpY1BhdHRlcm5zID0gW1xyXG4gICAgICAvYWJvdXQgKC4rPykoPzpcXHN8LHxcXC4pL2dpLFxyXG4gICAgICAvZGlzY3VzcyAoLis/KSg/Olxcc3wsfFxcLikvZ2ksXHJcbiAgICAgIC9mb2N1cyBvbiAoLis/KSg/Olxcc3wsfFxcLikvZ2ksXHJcbiAgICAgIC9yZWdhcmRpbmcgKC4rPykoPzpcXHN8LHxcXC4pL2dpLFxyXG4gICAgXVxyXG5cclxuICAgIGZvciAoY29uc3Qgc2VudGVuY2Ugb2Ygc2VudGVuY2VzLnNsaWNlKDAsIDUpKSB7XHJcbiAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiB0b3BpY1BhdHRlcm5zKSB7XHJcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHNlbnRlbmNlLm1hdGNoKHBhdHRlcm4pXHJcbiAgICAgICAgaWYgKG1hdGNoZXMpIHtcclxuICAgICAgICAgIHRvcGljcy5wdXNoKC4uLm1hdGNoZXMubWFwKG0gPT4gbS5yZXBsYWNlKHBhdHRlcm4sICckMScpLnRyaW0oKSkuc2xpY2UoMCwgMikpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSWYgbm8gcGF0dGVybnMgZm91bmQsIGV4dHJhY3Qga2V5IG5vdW5zXHJcbiAgICBpZiAodG9waWNzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICBjb25zdCB3b3JkcyA9IHRleHQudG9Mb3dlckNhc2UoKS5tYXRjaCgvXFxiW2Etel17NCx9XFxiL2cpIHx8IFtdXHJcbiAgICAgIGNvbnN0IGNvbW1vbldvcmRzID0gWyd0aGlzJywgJ3RoYXQnLCAnd2l0aCcsICdmcm9tJywgJ3RoZXknLCAnaGF2ZScsICdiZWVuJywgJ3dpbGwnLCAnbW9yZScsICdzb21lJywgJ3doYXQnLCAnd2hlbicsICd3aGVyZScsICd3aGljaCcsICd0aGVpcicsICd3b3VsZCcsICdjb3VsZCcsICdzaG91bGQnXVxyXG4gICAgICBjb25zdCBrZXlXb3JkcyA9IHdvcmRzXHJcbiAgICAgICAgLmZpbHRlcih3b3JkID0+ICFjb21tb25Xb3Jkcy5pbmNsdWRlcyh3b3JkKSlcclxuICAgICAgICAuZmlsdGVyKCh3b3JkLCBpbmRleCwgYXJyKSA9PiBhcnIuaW5kZXhPZih3b3JkKSA9PT0gaW5kZXgpIC8vIHVuaXF1ZVxyXG4gICAgICAgIC5zbGljZSgwLCAzKVxyXG5cclxuICAgICAgcmV0dXJuIGtleVdvcmRzLmxlbmd0aCA+IDAgPyBrZXlXb3JkcyA6IFsnQUkgdGVjaG5vbG9neScsICdtb2JpbGUgZGV2aWNlcycsICdwcml2YWN5J11cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdG9waWNzLnNsaWNlKDAsIDMpXHJcbiAgfVxyXG5cclxuICAvLyBFeHRyYWN0IG1lYW5pbmdmdWwgdm9jYWJ1bGFyeSBmb3IgbGVzc29uIGNvbnRlbnQgKGltcHJvdmVkIGFsZ29yaXRobSlcclxuICBwcml2YXRlIGV4dHJhY3RNZWFuaW5nZnVsVm9jYWJ1bGFyeSh0ZXh0OiBzdHJpbmcsIGxldmVsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICBjb25zdCB3b3JkcyA9IHRleHQudG9Mb3dlckNhc2UoKS5tYXRjaCgvXFxiW2Etel17NCx9XFxiL2cpIHx8IFtdXHJcbiAgICBjb25zdCB1bmlxdWVXb3JkcyA9IEFycmF5LmZyb20obmV3IFNldCh3b3JkcykpXHJcblxyXG4gICAgLy8gRW5oYW5jZWQgZXhjbHVzaW9uIGxpc3QgZm9jdXNpbmcgb24gdHJ1bHkgYmFzaWMgd29yZHMgYW5kIHByb3BlciBuYW1lc1xyXG4gICAgY29uc3QgZXhjbHVkZVdvcmRzID0gbmV3IFNldChbXHJcbiAgICAgIC8vIEJhc2ljIGZ1bmN0aW9uIHdvcmRzXHJcbiAgICAgICd0aGUnLCAnYW5kJywgJ2ZvcicsICdhcmUnLCAnYnV0JywgJ25vdCcsICd5b3UnLCAnYWxsJywgJ2NhbicsICdoYWQnLCAnaGVyJywgJ3dhcycsICdvbmUnLCAnb3VyJywgJ291dCcsICdkYXknLCAnZ2V0JywgJ2hhcycsICdoaW0nLCAnaGlzJywgJ2hvdycsICdpdHMnLCAnbWF5JywgJ25ldycsICdub3cnLCAnb2xkJywgJ3NlZScsICd0d28nLCAnd2hvJywgJ2JveScsICdkaWQnLCAnc2hlJywgJ3VzZScsICd3YXknLCAnd2hhdCcsICd3aGVuJywgJ3doZXJlJywgJ3dpbGwnLCAnd2l0aCcsICdoYXZlJywgJ3RoaXMnLCAndGhhdCcsICd0aGV5JywgJ2JlZW4nLCAnc2FpZCcsICdlYWNoJywgJ3doaWNoJywgJ3RoZWlyJywgJ3RpbWUnLCAnd291bGQnLCAndGhlcmUnLCAnY291bGQnLCAnb3RoZXInLCAnYWZ0ZXInLCAnZmlyc3QnLCAnd2VsbCcsICd3YXRlcicsICd2ZXJ5JywgJ3doYXQnLCAna25vdycsICdqdXN0JywgJ3Blb3BsZScsICdpbnRvJywgJ292ZXInLCAndGhpbmsnLCAnYWxzbycsICdiYWNrJywgJ3dvcmsnLCAnbGlmZScsICdvbmx5JywgJ3llYXInLCAneWVhcnMnLCAnY29tZScsICdjYW1lJywgJ3JpZ2h0JywgJ2dvb2QnLCAnZWFjaCcsICd0aG9zZScsICdmZWVsJywgJ3NlZW0nLCAndGhlc2UnLCAnZ2l2ZScsICdtb3N0JywgJ2hhbmQnLCAnaGlnaCcsICdrZWVwJywgJ2xhc3QnLCAnbGVmdCcsICdsaWZlJywgJ2xpdmUnLCAnbG9vaycsICdtYWRlJywgJ21ha2UnLCAnbWFueScsICdtdWNoJywgJ211c3QnLCAnbmFtZScsICduZWVkJywgJ25leHQnLCAnb3BlbicsICdwYXJ0JywgJ3BsYXknLCAnc2FpZCcsICdzYW1lJywgJ3NlZW0nLCAnc2hvdycsICdzaWRlJywgJ3Rha2UnLCAndGVsbCcsICd0dXJuJywgJ3dhbnQnLCAnd2F5cycsICd3ZWxsJywgJ3dlbnQnLCAnd2VyZScsICdoZXJlJywgJ2hvbWUnLCAnbG9uZycsICdsb29rJywgJ21vdmUnLCAncGxhY2UnLCAncmlnaHQnLCAnc21hbGwnLCAnc291bmQnLCAnc3RpbGwnLCAnc3VjaCcsICd0aGluZycsICd0aGluaycsICd0aHJlZScsICd1bmRlcicsICd3YXRlcicsICd3aGVyZScsICd3aGlsZScsICd3b3JsZCcsICd3cml0ZScsICd5b3VuZycsXHJcbiAgICAgIC8vIFZlcnkgYmFzaWMgd29yZHMgdGhhdCBCMSsgc3R1ZGVudHMgc2hvdWxkIGtub3dcclxuICAgICAgJ3N0dWRlbnQnLCAnZW5nbGlzaCcsICdzZXB0ZW1iZXInLCAnb2N0b2JlcicsICdub3ZlbWJlcicsICdkZWNlbWJlcicsICdqYW51YXJ5JywgJ2ZlYnJ1YXJ5JywgJ21hcmNoJywgJ2FwcmlsJywgJ2p1bmUnLCAnanVseScsICdhdWd1c3QnLCAnc291dGgnLCAnYWZyaWNhJywgJ2ltYWdlcycsICdpbWFnZScsICdwaG90bycsICdwaWN0dXJlJywgJ2JsYWNrJywgJ3doaXRlJywgJ2NvbG91cmVkJywgJ2NvbG9yZWQnLFxyXG4gICAgICAvLyBQcm9ibGVtYXRpYyBvciBzZW5zaXRpdmUgdGVybXMgdG8gYXZvaWQgaW4gdm9jYWJ1bGFyeVxyXG4gICAgICAnc2x1cicsICdzbHVycycsICdyYWNpYWwnLCAncmFjaXN0JywgJ3JhY2lzbScsICdtY2tlbnppZScsICdhcGFydGhlaWQnLFxyXG4gICAgICAnbW9uZGF5JywgJ3R1ZXNkYXknLCAnd2VkbmVzZGF5JywgJ3RodXJzZGF5JywgJ2ZyaWRheScsICdzYXR1cmRheScsICdzdW5kYXknLFxyXG4gICAgICAndG9kYXknLCAneWVzdGVyZGF5JywgJ3RvbW9ycm93JywgJ21vcm5pbmcnLCAnYWZ0ZXJub29uJywgJ2V2ZW5pbmcnLCAnbmlnaHQnLFxyXG4gICAgICAvLyBDb21tb24gcHJvcGVyIG5hbWVzIHRvIGF2b2lkIChwZW9wbGUncyBuYW1lcyBhbmQgc3BlY2lmaWMgcGxhY2VzKVxyXG4gICAgICAnam9obicsICdtYXJ5JywgJ2RhdmlkJywgJ3NhcmFoJywgJ21pY2hhZWwnLCAnamVubmlmZXInLCAncm9iZXJ0JywgJ2xpc2EnLCAnd2lsbGlhbScsICdrYXJlbicsICdqYW1lcycsICdzdXNhbicsICdjaHJpc3RvcGhlcicsICdqZXNzaWNhJywgJ2RhbmllbCcsICduYW5jeScsICdtYXR0aGV3JywgJ2JldHR5JywgJ2FudGhvbnknLCAnaGVsZW4nLCAnbWFyaycsICdzYW5kcmEnLCAnZG9uYWxkJywgJ2Rvbm5hJywgJ3N0ZXZlbicsICdjYXJvbCcsICdwYXVsJywgJ3J1dGgnLCAnYW5kcmV3JywgJ3NoYXJvbicsICdqb3NodWEnLCAnbWljaGVsbGUnLCAna2VubmV0aCcsICdsYXVyYScsICdrZXZpbicsICdzYXJhaCcsICdicmlhbicsICdraW1iZXJseScsICdnZW9yZ2UnLCAnZGVib3JhaCcsICdlZHdhcmQnLCAnZG9yb3RoeScsICdyb25hbGQnLCAnbGlzYScsICd0aW1vdGh5JywgJ25hbmN5JywgJ2phc29uJywgJ2thcmVuJywgJ2plZmZyZXknLCAnYmV0dHknLCAncnlhbicsICdoZWxlbicsICdqYWNvYicsICdzYW5kcmEnLCAnZ2FyeScsICdkb25uYScsICduaWNob2xhcycsICdjYXJvbCcsICdlcmljJywgJ3J1dGgnLCAnam9uYXRoYW4nLCAnc2hhcm9uJywgJ3N0ZXBoZW4nLCAnbWljaGVsbGUnLCAnbGFycnknLCAnbGF1cmEnLCAnanVzdGluJywgJ3NhcmFoJywgJ3Njb3R0JywgJ2tpbWJlcmx5JywgJ2JyYW5kb24nLCAnZGVib3JhaCcsICdiZW5qYW1pbicsICdkb3JvdGh5JywgJ3NhbXVlbCcsICdsaXNhJywgJ2dyZWdvcnknLCAnbmFuY3knLCAnYWxleGFuZGVyJywgJ2thcmVuJywgJ3BhdHJpY2snLCAnYmV0dHknLCAnZnJhbmsnLCAnaGVsZW4nLCAncmF5bW9uZCcsICdzYW5kcmEnLCAnamFjaycsICdkb25uYScsICdkZW5uaXMnLCAnY2Fyb2wnLCAnamVycnknLCAncnV0aCcsICd0eWxlcicsICdzaGFyb24nLCAnYWFyb24nLCAnbWljaGVsbGUnLCAnam9zZScsICdsYXVyYScsICdoZW5yeScsICdzYXJhaCcsICdhZGFtJywgJ2tpbWJlcmx5JywgJ2RvdWdsYXMnLCAnZGVib3JhaCcsICduYXRoYW4nLCAnZG9yb3RoeScsICdwZXRlcicsICdsaXNhJywgJ3phY2hhcnknLCAnbmFuY3knLCAna3lsZScsICdrYXJlbicsICdqdWxpdXMnLCAnbWFsZW1hJ1xyXG4gICAgXSlcclxuXHJcbiAgICAvLyBGaWx0ZXIgYW5kIHNjb3JlIHdvcmRzIGZvciBlZHVjYXRpb25hbCB2YWx1ZVxyXG4gICAgY29uc3QgbWVhbmluZ2Z1bFdvcmRzID0gdW5pcXVlV29yZHMuZmlsdGVyKHdvcmQgPT4ge1xyXG4gICAgICBpZiAoZXhjbHVkZVdvcmRzLmhhcyh3b3JkKSkgcmV0dXJuIGZhbHNlXHJcbiAgICAgIGlmICgvXlxcZCskLy50ZXN0KHdvcmQpKSByZXR1cm4gZmFsc2UgLy8gU2tpcCBwdXJlIG51bWJlcnNcclxuICAgICAgaWYgKHdvcmQubGVuZ3RoIDwgNCkgcmV0dXJuIGZhbHNlIC8vIFNraXAgdmVyeSBzaG9ydCB3b3Jkc1xyXG4gICAgICBpZiAod29yZC5sZW5ndGggPiAxNSkgcmV0dXJuIGZhbHNlIC8vIFNraXAgdmVyeSBsb25nIHdvcmRzXHJcbiAgICAgIGlmICh0aGlzLmlzUHJvcGVyTmFtZSh3b3JkKSkgcmV0dXJuIGZhbHNlIC8vIFNraXAgcHJvcGVyIG5hbWVzXHJcbiAgICAgIHJldHVybiB0cnVlXHJcbiAgICB9KVxyXG5cclxuICAgIC8vIFNjb3JlIHdvcmRzIGJhc2VkIG9uIGVkdWNhdGlvbmFsIGFuZCBjb250ZXh0dWFsIHZhbHVlXHJcbiAgICBjb25zdCBzY29yZWRXb3JkcyA9IG1lYW5pbmdmdWxXb3Jkcy5tYXAod29yZCA9PiB7XHJcbiAgICAgIGxldCBzY29yZSA9IDBcclxuXHJcbiAgICAgIC8vIEhpZ2gtdmFsdWUgY29udGVudC1zcGVjaWZpYyB2b2NhYnVsYXJ5IChwb2xpdGljYWwsIGJ1c2luZXNzLCBhY2FkZW1pYyB0ZXJtcylcclxuICAgICAgaWYgKC9eKGFubm91bmNlbWVudHxvcHBvc2l0aW9ufHJlY29nbml0aW9ufGxlYWRlcnNoaXB8bWFuYWdlbWVudHxnb3Zlcm5tZW50fHBvbGl0aWNhbHxwYXJsaWFtZW50fGRlbW9jcmFjeXxlbGVjdGlvbnxwb2xpY3l8bGVnaXNsYXRpb258Y29uc3RpdHV0aW9ufHJpZ2h0c3xmcmVlZG9tfGp1c3RpY2V8ZXF1YWxpdHl8ZGV2ZWxvcG1lbnR8ZWNvbm9taWN8c29jaWFsfGN1bHR1cmFsfGVudmlyb25tZW50YWx8aW50ZXJuYXRpb25hbHxuYXRpb25hbHxyZWdpb25hbHxjb21tdW5pdHl8b3JnYW5pemF0aW9ufGluc3RpdHV0aW9ufGFkbWluaXN0cmF0aW9ufGF1dGhvcml0eXxyZXNwb25zaWJpbGl0eXxhY2NvdW50YWJpbGl0eXx0cmFuc3BhcmVuY3l8Z292ZXJuYW5jZXxyZWd1bGF0aW9ufGNvbXBsaWFuY2V8c3RyYXRlZ3l8aW1wbGVtZW50YXRpb258ZXZhbHVhdGlvbnxhc3Nlc3NtZW50fGFuYWx5c2lzfHJlc2VhcmNofGludmVzdGlnYXRpb258ZXhhbWluYXRpb258Y29uc2lkZXJhdGlvbnxkaXNjdXNzaW9ufG5lZ290aWF0aW9ufGFncmVlbWVudHxjb29wZXJhdGlvbnxjb2xsYWJvcmF0aW9ufHBhcnRuZXJzaGlwfHJlbGF0aW9uc2hpcHxjb21tdW5pY2F0aW9ufGluZm9ybWF0aW9ufGVkdWNhdGlvbnx0cmFpbmluZ3xrbm93bGVkZ2V8dW5kZXJzdGFuZGluZ3xhd2FyZW5lc3N8Y29uc2Npb3VzbmVzc3xwZXJzcGVjdGl2ZXxvcGluaW9ufGJlbGllZnxhdHRpdHVkZXxhcHByb2FjaHxtZXRob2R8dGVjaG5pcXVlfHByb2Nlc3N8c3lzdGVtfHN0cnVjdHVyZXxmcmFtZXdvcmt8cHJpbmNpcGxlfGNvbmNlcHR8dGhlb3J5fHByYWN0aWNlfGV4cGVyaWVuY2V8c2tpbGx8ZXhwZXJ0aXNlfHByb2Zlc3Npb25hbHxhY2FkZW1pY3xzY2llbnRpZmljfHRlY2huaWNhbHx0ZWNobm9sb2dpY2FsfGRpZ2l0YWx8aW5ub3ZhdGlvbnxjcmVhdGl2aXR5fGRldmVsb3BtZW50fGltcHJvdmVtZW50fGVuaGFuY2VtZW50fHRyYW5zZm9ybWF0aW9ufGNoYW5nZXxwcm9ncmVzc3xhZHZhbmNlbWVudHxhY2hpZXZlbWVudHxzdWNjZXNzfHBlcmZvcm1hbmNlfHF1YWxpdHl8ZWZmaWNpZW5jeXxlZmZlY3RpdmVuZXNzfHByb2R1Y3Rpdml0eXxzdXN0YWluYWJpbGl0eXxyZXNwb25zaWJpbGl0eXxjb21taXRtZW50fGRlZGljYXRpb258bW90aXZhdGlvbnxpbnNwaXJhdGlvbnxsZWFkZXJzaGlwfG1hbmFnZW1lbnR8Y29vcmRpbmF0aW9ufHN1cGVydmlzaW9ufGRpcmVjdGlvbnxndWlkYW5jZXxzdXBwb3J0fGFzc2lzdGFuY2V8c2VydmljZXxwcm92aXNpb258ZGVsaXZlcnl8aW1wbGVtZW50YXRpb258ZXhlY3V0aW9ufG9wZXJhdGlvbnxmdW5jdGlvbnxhY3Rpdml0eXxhY3Rpb258YmVoYXZpb3J8Y29uZHVjdHxwcmFjdGljZXxwcm9jZWR1cmV8cHJvdG9jb2x8c3RhbmRhcmR8Z3VpZGVsaW5lfHJlcXVpcmVtZW50fGNvbmRpdGlvbnxzaXR1YXRpb258Y2lyY3Vtc3RhbmNlfGNvbnRleHR8ZW52aXJvbm1lbnR8c2V0dGluZ3xiYWNrZ3JvdW5kfGhpc3Rvcnl8dHJhZGl0aW9ufGN1bHR1cmV8c29jaWV0eXxjb21tdW5pdHl8cG9wdWxhdGlvbnxncm91cHx0ZWFtfG9yZ2FuaXphdGlvbnxpbnN0aXR1dGlvbnxlc3RhYmxpc2htZW50fGF1dGhvcml0eXxnb3Zlcm5tZW50fGFkbWluaXN0cmF0aW9ufHBvbGljeXxyZWd1bGF0aW9ufGxhd3xydWxlfHN0YW5kYXJkfGd1aWRlbGluZXxwcm9jZWR1cmV8cHJvdG9jb2x8ZnJhbWV3b3JrfG1vZGVsfHBhdHRlcm58dGVtcGxhdGV8ZXhhbXBsZXxpbnN0YW5jZXxjYXNlfHNjZW5hcmlvKS8udGVzdCh3b3JkKSkge1xyXG4gICAgICAgIHNjb3JlICs9IDYgLy8gSGlnaGVzdCBwcmlvcml0eSBmb3IgbWVhbmluZ2Z1bCBjb250ZW50IHZvY2FidWxhcnlcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQnVzaW5lc3MgYW5kIHByb2Zlc3Npb25hbCB0ZXJtc1xyXG4gICAgICBpZiAoL14obWFuYWdlfGxlYWRlcnx0ZWFtfGNvbXBhbnl8YnVzaW5lc3N8c3RyYXRlZ3l8ZGV2ZWxvcHxjcmVhdGV8aW5ub3ZhdHx0ZWNobm9sb2d8ZGlnaXRhbHxnbG9iYWx8cHJvZmVzc2lvbmFsfGV4cGVyaWVuY2V8c2tpbGx8ZXhwZXJ0fGFuYWx5c2lzfHJlc2VhcmNofHByb2plY3R8c29sdXRpb258Y2hhbGxlbmdlfG9wcG9ydHVuaXR5fGdyb3d0aHxzdWNjZXNzfGFjaGlldmVtZW50fHBlcmZvcm1hbmNlfHF1YWxpdHl8ZWZmaWNpZW5jeXxwcm9kdWN0aXZpdHl8Y29sbGFib3JhdGlvbnxjb21tdW5pY2F0aW9ufGRlY2lzaW9ufHJlc3BvbnNpYmlsaXR5fG9iamVjdGl2ZXxnb2FsfHRhcmdldHxyZXN1bHR8b3V0Y29tZXxpbXBhY3R8YmVuZWZpdHxhZHZhbnRhZ2V8dmFsdWV8cHJvZml0fHJldmVudWV8aW52ZXN0bWVudHxtYXJrZXR8Y3VzdG9tZXJ8Y2xpZW50fHNlcnZpY2V8cHJvZHVjdHxicmFuZHxyZXB1dGF0aW9ufGNvbXBldGl0aXZlfGluZHVzdHJ5fHNlY3RvcnxlY29ub215fGVjb25vbWljfGZpbmFuY2lhbHxidWRnZXR8Y29zdHxwcmljZXxzYWxlc3xtYXJrZXRpbmd8YWR2ZXJ0aXNpbmd8cHJvbW90aW9ufGNhbXBhaWdufHN0cmF0ZWd5fHBsYW5uaW5nfGltcGxlbWVudGF0aW9ufGV4ZWN1dGlvbnxldmFsdWF0aW9ufGFzc2Vzc21lbnR8aW1wcm92ZW1lbnR8b3B0aW1pemF0aW9ufHRyYW5zZm9ybWF0aW9ufGNoYW5nZXxhZGFwdGF0aW9ufGZsZXhpYmlsaXR5fGFnaWxpdHl8cmVzaWxpZW5jZXxzdXN0YWluYWJpbGl0eXxlbnZpcm9ubWVudGFsfHNvY2lhbHxldGhpY2FsfGdvdmVybmFuY2V8Y29tcGxpYW5jZXxyZWd1bGF0aW9ufHBvbGljeXxwcm9jZWR1cmV8c3RhbmRhcmR8Z3VpZGVsaW5lfGZyYW1ld29ya3xtZXRob2RvbG9neXxhcHByb2FjaHx0ZWNobmlxdWV8bWV0aG9kfHByb2Nlc3N8c3lzdGVtfHN0cnVjdHVyZXxvcmdhbml6YXRpb258aGllcmFyY2h5fGRlcGFydG1lbnR8ZGl2aXNpb258ZnVuY3Rpb258cm9sZXxwb3NpdGlvbnx0aXRsZXxjYXJlZXJ8ZGV2ZWxvcG1lbnR8dHJhaW5pbmd8ZWR1Y2F0aW9ufGxlYXJuaW5nfGtub3dsZWRnZXxpbmZvcm1hdGlvbnxkYXRhfGluc2lnaHR8aW50ZWxsaWdlbmNlKS8udGVzdCh3b3JkKSkge1xyXG4gICAgICAgIHNjb3JlICs9IDRcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQWNhZGVtaWMgYW5kIGZvcm1hbCB2b2NhYnVsYXJ5XHJcbiAgICAgIGlmICgvXihyZXNlYXJjaHxzdHVkeXxhbmFseXNpc3x0aGVvcnl8Y29uY2VwdHxwcmluY2lwbGV8bWV0aG9kfGFwcHJvYWNofHRlY2huaXF1ZXxwcm9jZXNzfHN5c3RlbXxzdHJ1Y3R1cmV8ZnVuY3Rpb258cmVsYXRpb25zaGlwfGNvbm5lY3Rpb258aW50ZXJhY3Rpb258aW5mbHVlbmNlfGVmZmVjdHxpbXBhY3R8Y2F1c2V8cmVzdWx0fGNvbnNlcXVlbmNlfGZhY3RvcnxlbGVtZW50fGNvbXBvbmVudHxhc3BlY3R8ZmVhdHVyZXxjaGFyYWN0ZXJpc3RpY3xwcm9wZXJ0eXxxdWFsaXR5fGF0dHJpYnV0ZXxkaW1lbnNpb258bGV2ZWx8ZGVncmVlfGV4dGVudHxzY29wZXxyYW5nZXxzY2FsZXxtZWFzdXJlfG1lYXN1cmVtZW50fGV2YWx1YXRpb258YXNzZXNzbWVudHxjb21wYXJpc29ufGNvbnRyYXN0fHNpbWlsYXJpdHl8ZGlmZmVyZW5jZXx2YXJpYXRpb258Y2hhbmdlfGRldmVsb3BtZW50fGV2b2x1dGlvbnxwcm9ncmVzc3xhZHZhbmNlbWVudHxpbXByb3ZlbWVudHxlbmhhbmNlbWVudHxtb2RpZmljYXRpb258YWRqdXN0bWVudHxhZGFwdGF0aW9ufHRyYW5zZm9ybWF0aW9ufHJldm9sdXRpb258aW5ub3ZhdGlvbnxkaXNjb3Zlcnl8aW52ZW50aW9ufGNyZWF0aW9ufHByb2R1Y3Rpb258Y29uc3RydWN0aW9ufGRlc2lnbnxwbGFubmluZ3xvcmdhbml6YXRpb258bWFuYWdlbWVudHxhZG1pbmlzdHJhdGlvbnxvcGVyYXRpb258aW1wbGVtZW50YXRpb258ZXhlY3V0aW9ufHBlcmZvcm1hbmNlfGFjaGlldmVtZW50fGFjY29tcGxpc2htZW50KS8udGVzdCh3b3JkKSkge1xyXG4gICAgICAgIHNjb3JlICs9IDNcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQWN0aW9uIHdvcmRzIGFuZCBwcm9jZXNzZXMgKG9mdGVuIGdvb2QgZm9yIGxlYXJuaW5nKVxyXG4gICAgICBpZiAoL14oYW5ub3VuY2V8cmVvcmdhbml6ZXxtYW5hZ2V8ZGV2ZWxvcHxpbXBsZW1lbnR8YWNoaWV2ZXxpbXByb3ZlfHRyYW5zZm9ybXxjb21tdW5pY2F0ZXxjb2xsYWJvcmF0ZXxpbnZlc3RpZ2F0ZXxleHBsb3JlfGV4YW1pbmV8ZXZhbHVhdGV8YXNzZXNzfGNvbnNpZGVyfGRpc2N1c3N8bmVnb3RpYXRlfHByZXNlbnR8ZGVtb25zdHJhdGV8ZXhwbGFpbnxkZXNjcmliZXxpbGx1c3RyYXRlfGludGVycHJldHx0cmFuc2xhdGV8YWRhcHR8bW9kaWZ5fG9wdGltaXplfG9yZ2FuaXplfGNvb3JkaW5hdGV8YWRtaW5pc3RlcnxzdXBlcnZpc2V8b3BlcmF0ZXxleGVjdXRlfHBlcmZvcm18YWNjb21wbGlzaHxlc3RhYmxpc2h8bWFpbnRhaW58cHJlc2VydmV8Y29uc2VydmV8cHJvdGVjdHxwcmV2ZW50fHByb21vdGV8YWR2YW5jZXxlbmhhbmNlfGVucmljaHxlbXBvd2VyfGVuZ2FnZXxpbnZvbHZlfHBhcnRpY2lwYXRlfGNvbnRyaWJ1dGV8ZGVkaWNhdGV8Y29tbWl0fGludmVzdHxhbGxvY2F0ZXxkaXN0cmlidXRlfGNpcmN1bGF0ZXx0cmFuc21pdHx0cmFuc3BvcnR8ZGVsaXZlcnxwcm92aWRlfHN1cHBseXxzdXBwb3J0fGFzc2lzdHxndWlkZXxkaXJlY3R8aW5zdHJ1Y3R8ZWR1Y2F0ZXx0cmFpbnxwcmVwYXJlfHBsYW58c2NoZWR1bGV8YXJyYW5nZXxjb29yZGluYXRlfHN5bmNocm9uaXplfGludGVncmF0ZXxjb21iaW5lfGNvbm5lY3R8YXNzb2NpYXRlfHJlbGF0ZXxwYXJ0bmVyfGNvbGxhYm9yYXRlfGNvb3BlcmF0ZXxjb21wZXRlfGNvbXBhcmV8Y29udHJhc3R8ZGlmZmVyZW50aWF0ZXxkaXN0aW5ndWlzaHxpZGVudGlmeXxyZWNvZ25pemV8YWNrbm93bGVkZ2V8YXBwcmVjaWF0ZXx1bmRlcnN0YW5kfGNvbXByZWhlbmR8cmVhbGl6ZXxhd2FyZXxjb25zY2lvdXN8cGVyY2VpdmV8b2JzZXJ2ZXxtb25pdG9yfHRyYWNrfG1lYXN1cmV8Y2FsY3VsYXRlfGVzdGltYXRlfHByZWRpY3R8Zm9yZWNhc3R8cHJvamVjdHxhbnRpY2lwYXRlfGV4cGVjdHxhc3N1bWV8aHlwb3RoZXNpemV8c3BlY3VsYXRlfGludmVzdGlnYXRlfGV4cGxvcmV8cmVzZWFyY2h8YW5hbHl6ZXxzeW50aGVzaXplfGV2YWx1YXRlfGFzc2Vzc3xqdWRnZXxkZWNpZGV8Y2hvb3NlfHNlbGVjdHxwcmVmZXJ8cmVjb21tZW5kfHN1Z2dlc3R8cHJvcG9zZXxvZmZlcnxyZXF1ZXN0fGRlbWFuZHxyZXF1aXJlfHNwZWNpZnl8aW5zdHJ1Y3R8ZGlyZWN0fGd1aWRlfGFkdmlzZXxjb25zdWx0fGRpc2N1c3N8bmVnb3RpYXRlfGFncmVlfGNvbnRyYWN0fGRlYWx8dHJhbnNhY3Rpb258ZXhjaGFuZ2V8dHJhZGV8cHVyY2hhc2V8c2FsZXxpbnZlc3RtZW50fGZ1bmRpbmd8ZmluYW5jaW5nfHNwb25zb3JzaGlwfHN1cHBvcnR8YXNzaXN0YW5jZXxzZXJ2aWNlfHByb3Zpc2lvbnxkZWxpdmVyeXxkaXN0cmlidXRpb258YWxsb2NhdGlvbnxhc3NpZ25tZW50fGRlbGVnYXRpb258YXV0aG9yaXphdGlvbnxhcHByb3ZhbHxwZXJtaXNzaW9ufGNvbnNlbnR8YWNjZXB0YW5jZXxyZWplY3Rpb258cmVmdXNhbHxkZW5pYWx8cHJvaGliaXRpb258cmVzdHJpY3Rpb258bGltaXRhdGlvbnxjb25zdHJhaW50fHJlZ3VsYXRpb258Y29udHJvbHxtYW5hZ2VtZW50fGFkbWluaXN0cmF0aW9ufGdvdmVybmFuY2V8bGVhZGVyc2hpcHxzdXBlcnZpc2lvbnxvdmVyc2lnaHR8bW9uaXRvcmluZ3xldmFsdWF0aW9ufGFzc2Vzc21lbnR8cmV2aWV3fGF1ZGl0fGluc3BlY3Rpb258ZXhhbWluYXRpb258aW52ZXN0aWdhdGlvbnxpbnF1aXJ5KS8udGVzdCh3b3JkKSkge1xyXG4gICAgICAgIHNjb3JlICs9IDNcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gRnJlcXVlbmN5IGJvbnVzICh3b3JkcyB0aGF0IGFwcGVhciBtdWx0aXBsZSB0aW1lcyBhcmUgbGlrZWx5IGltcG9ydGFudClcclxuICAgICAgY29uc3QgZnJlcXVlbmN5ID0gKHRleHQudG9Mb3dlckNhc2UoKS5tYXRjaChuZXcgUmVnRXhwKGBcXFxcYiR7d29yZH1cXFxcYmAsICdnJykpIHx8IFtdKS5sZW5ndGhcclxuICAgICAgaWYgKGZyZXF1ZW5jeSA+IDEpIHNjb3JlICs9IGZyZXF1ZW5jeSAqIDJcclxuXHJcbiAgICAgIC8vIExlbmd0aCBib251cyBmb3Igc3Vic3RhbnRpYWwgd29yZHNcclxuICAgICAgaWYgKHdvcmQubGVuZ3RoID49IDYgJiYgd29yZC5sZW5ndGggPD0gMTIpIHNjb3JlICs9IDFcclxuXHJcbiAgICAgIHJldHVybiB7IHdvcmQsIHNjb3JlIH1cclxuICAgIH0pXHJcblxyXG4gICAgLy8gU29ydCBieSBzY29yZSBhbmQgcmV0dXJuIHRvcCB3b3Jkc1xyXG4gICAgY29uc3QgdG9wV29yZHMgPSBzY29yZWRXb3Jkc1xyXG4gICAgICAuc29ydCgoYSwgYikgPT4gYi5zY29yZSAtIGEuc2NvcmUpXHJcbiAgICAgIC5zbGljZSgwLCA4KSAvLyBUYWtlIHRvcCA4IHdvcmRzXHJcbiAgICAgIC5tYXAoaXRlbSA9PiBpdGVtLndvcmQpXHJcblxyXG4gICAgY29uc29sZS5sb2coXCLwn5OaIE1lYW5pbmdmdWwgdm9jYWJ1bGFyeSBleHRyYWN0aW9uIHJlc3VsdHM6XCIsIHRvcFdvcmRzLm1hcCh3ID0+IGAke3d9IChzY29yZTogJHtzY29yZWRXb3Jkcy5maW5kKHMgPT4gcy53b3JkID09PSB3KT8uc2NvcmV9KWApKVxyXG4gICAgcmV0dXJuIHRvcFdvcmRzXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGV4dHJhY3RWb2NhYnVsYXJ5RnJvbVRleHQodGV4dDogc3RyaW5nLCBsZXZlbDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgLy8gU21hcnQgdm9jYWJ1bGFyeSBleHRyYWN0aW9uIGZvY3VzaW5nIG9uIG1lYW5pbmdmdWwsIGVkdWNhdGlvbmFsIHdvcmRzXHJcbiAgICBjb25zdCB3b3JkcyA9IHRleHQudG9Mb3dlckNhc2UoKS5tYXRjaCgvXFxiW2Etel17Myx9XFxiL2cpIHx8IFtdXHJcbiAgICBjb25zdCB1bmlxdWVXb3JkcyA9IEFycmF5LmZyb20obmV3IFNldCh3b3JkcykpXHJcblxyXG4gICAgLy8gV29yZHMgdG8gZXhjbHVkZSAoY29tbW9uLCBub24tZWR1Y2F0aW9uYWwgd29yZHMpXHJcbiAgICBjb25zdCBleGNsdWRlV29yZHMgPSBuZXcgU2V0KFtcclxuICAgICAgLy8gQ29tbW9uIHdvcmRzXHJcbiAgICAgICd0aGUnLCAnYW5kJywgJ2ZvcicsICdhcmUnLCAnYnV0JywgJ25vdCcsICd5b3UnLCAnYWxsJywgJ2NhbicsICdoYWQnLCAnaGVyJywgJ3dhcycsICdvbmUnLCAnb3VyJywgJ291dCcsICdkYXknLCAnZ2V0JywgJ2hhcycsICdoaW0nLCAnaGlzJywgJ2hvdycsICdpdHMnLCAnbWF5JywgJ25ldycsICdub3cnLCAnb2xkJywgJ3NlZScsICd0d28nLCAnd2hvJywgJ2JveScsICdkaWQnLCAnc2hlJywgJ3VzZScsICd3YXknLCAnd2hhdCcsICd3aGVuJywgJ3doZXJlJywgJ3dpbGwnLCAnd2l0aCcsICdoYXZlJywgJ3RoaXMnLCAndGhhdCcsICd0aGV5JywgJ2JlZW4nLCAnc2FpZCcsICdlYWNoJywgJ3doaWNoJywgJ3RoZWlyJywgJ3RpbWUnLCAnd291bGQnLCAndGhlcmUnLCAnY291bGQnLCAnb3RoZXInLCAnYWZ0ZXInLCAnZmlyc3QnLCAnd2VsbCcsICd3YXRlcicsICd2ZXJ5JywgJ3doYXQnLCAna25vdycsICdqdXN0JywgJ3Blb3BsZScsICdpbnRvJywgJ292ZXInLCAndGhpbmsnLCAnYWxzbycsICdiYWNrJywgJ3dvcmsnLCAnbGlmZScsICdvbmx5JywgJ3llYXInLCAneWVhcnMnLCAnY29tZScsICdjYW1lJywgJ3JpZ2h0JywgJ2dvb2QnLCAnZWFjaCcsICd0aG9zZScsICdmZWVsJywgJ3NlZW0nLCAndGhlc2UnLCAnZ2l2ZScsICdtb3N0JywgJ2hhbmQnLCAnaGlnaCcsICdrZWVwJywgJ2xhc3QnLCAnbGVmdCcsICdsaWZlJywgJ2xpdmUnLCAnbG9vaycsICdtYWRlJywgJ21ha2UnLCAnbWFueScsICdtdWNoJywgJ211c3QnLCAnbmFtZScsICduZWVkJywgJ25leHQnLCAnb3BlbicsICdwYXJ0JywgJ3BsYXknLCAnc2FpZCcsICdzYW1lJywgJ3NlZW0nLCAnc2hvdycsICdzaWRlJywgJ3Rha2UnLCAndGVsbCcsICd0dXJuJywgJ3dhbnQnLCAnd2F5cycsICd3ZWxsJywgJ3dlbnQnLCAnd2VyZScsICdoZXJlJywgJ2hvbWUnLCAnbG9uZycsICdsb29rJywgJ21vdmUnLCAncGxhY2UnLCAncmlnaHQnLCAnc21hbGwnLCAnc291bmQnLCAnc3RpbGwnLCAnc3VjaCcsICd0aGluZycsICd0aGluaycsICd0aHJlZScsICd1bmRlcicsICd3YXRlcicsICd3aGVyZScsICd3aGlsZScsICd3b3JsZCcsICd3cml0ZScsICd5b3VuZycsXHJcbiAgICAgIC8vIERhdGVzLCBudW1iZXJzLCBuYW1lcyAob2Z0ZW4gbm90IHVzZWZ1bCBmb3Igdm9jYWJ1bGFyeSlcclxuICAgICAgJ2phbnVhcnknLCAnZmVicnVhcnknLCAnbWFyY2gnLCAnYXByaWwnLCAnanVuZScsICdqdWx5JywgJ2F1Z3VzdCcsICdzZXB0ZW1iZXInLCAnb2N0b2JlcicsICdub3ZlbWJlcicsICdkZWNlbWJlcicsXHJcbiAgICAgICdtb25kYXknLCAndHVlc2RheScsICd3ZWRuZXNkYXknLCAndGh1cnNkYXknLCAnZnJpZGF5JywgJ3NhdHVyZGF5JywgJ3N1bmRheScsXHJcbiAgICAgICd0b2RheScsICd5ZXN0ZXJkYXknLCAndG9tb3Jyb3cnLCAnbW9ybmluZycsICdhZnRlcm5vb24nLCAnZXZlbmluZycsICduaWdodCcsXHJcbiAgICAgIC8vIENvbW1vbiBwcm9wZXIgbm91bnMgdGhhdCBhcmUgb2Z0ZW4gbm90IGVkdWNhdGlvbmFsXHJcbiAgICAgICdmcmFuY2lzY28nLCAnY2FsaWZvcm5pYScsICdhbWVyaWNhJywgJ2FtZXJpY2FuJywgJ3VuaXRlZCcsICdzdGF0ZXMnLCAneW9yaycsICdsb25kb24nLCAncGFyaXMnLCAndG9reW8nXHJcbiAgICBdKVxyXG5cclxuICAgIC8vIFByaW9yaXRpemUgbWVhbmluZ2Z1bCB2b2NhYnVsYXJ5IGNhdGVnb3JpZXNcclxuICAgIGNvbnN0IG1lYW5pbmdmdWxXb3JkcyA9IHVuaXF1ZVdvcmRzLmZpbHRlcih3b3JkID0+IHtcclxuICAgICAgLy8gU2tpcCBleGNsdWRlZCB3b3Jkc1xyXG4gICAgICBpZiAoZXhjbHVkZVdvcmRzLmhhcyh3b3JkKSkgcmV0dXJuIGZhbHNlXHJcblxyXG4gICAgICAvLyBTa2lwIHB1cmUgbnVtYmVycyBvciBkYXRlc1xyXG4gICAgICBpZiAoL15cXGQrJC8udGVzdCh3b3JkKSB8fCAvXlxcZHs0fSQvLnRlc3Qod29yZCkpIHJldHVybiBmYWxzZVxyXG5cclxuICAgICAgLy8gU2tpcCB2ZXJ5IHNob3J0IHdvcmRzIChsZXNzIHRoYW4gNCBsZXR0ZXJzKSB1bmxlc3MgdGhleSdyZSBpbXBvcnRhbnRcclxuICAgICAgaWYgKHdvcmQubGVuZ3RoIDwgNCkgcmV0dXJuIGZhbHNlXHJcblxyXG4gICAgICAvLyBTa2lwIHZlcnkgbG9uZyB3b3JkcyB0aGF0IG1pZ2h0IGJlIHRvbyBjb21wbGV4XHJcbiAgICAgIGlmICh3b3JkLmxlbmd0aCA+IDE1KSByZXR1cm4gZmFsc2VcclxuXHJcbiAgICAgIHJldHVybiB0cnVlXHJcbiAgICB9KVxyXG5cclxuICAgIC8vIFNjb3JlIHdvcmRzIGJhc2VkIG9uIGVkdWNhdGlvbmFsIHZhbHVlXHJcbiAgICBjb25zdCBzY29yZWRXb3JkcyA9IG1lYW5pbmdmdWxXb3Jkcy5tYXAod29yZCA9PiB7XHJcbiAgICAgIGxldCBzY29yZSA9IDBcclxuXHJcbiAgICAgIC8vIEJ1c2luZXNzL3Byb2Zlc3Npb25hbCB2b2NhYnVsYXJ5XHJcbiAgICAgIGlmICgvXihtYW5hZ2V8bGVhZGVyfHRlYW18Y29tcGFueXxidXNpbmVzc3xzdHJhdGVneXxkZXZlbG9wfGNyZWF0ZXxpbm5vdmF0fHRlY2hub2xvZ3xkaWdpdGFsfGdsb2JhbHxpbnRlcm5hdGlvbmFsfHByb2Zlc3Npb25hbHxleHBlcmllbmNlfHNraWxsfGV4cGVydHxhbmFseXNpc3xyZXNlYXJjaHxwcm9qZWN0fHNvbHV0aW9ufGNoYWxsZW5nZXxvcHBvcnR1bml0eXxncm93dGh8c3VjY2Vzc3xhY2hpZXZlbWVudHxwZXJmb3JtYW5jZXxxdWFsaXR5fGVmZmljaWVuY3l8cHJvZHVjdGl2aXR5fGNvbGxhYm9yYXRpb258Y29tbXVuaWNhdGlvbnxkZWNpc2lvbnxyZXNwb25zaWJpbGl0eXxvYmplY3RpdmV8Z29hbHx0YXJnZXR8cmVzdWx0fG91dGNvbWV8aW1wYWN0fGJlbmVmaXR8YWR2YW50YWdlfHZhbHVlfHByb2ZpdHxyZXZlbnVlfGludmVzdG1lbnR8bWFya2V0fGN1c3RvbWVyfGNsaWVudHxzZXJ2aWNlfHByb2R1Y3R8YnJhbmR8cmVwdXRhdGlvbnxjb21wZXRpdGl2ZXxpbmR1c3RyeXxzZWN0b3J8ZWNvbm9teXxlY29ub21pY3xmaW5hbmNpYWx8YnVkZ2V0fGNvc3R8cHJpY2V8c2FsZXN8bWFya2V0aW5nfGFkdmVydGlzaW5nfHByb21vdGlvbnxjYW1wYWlnbnxzdHJhdGVneXxwbGFubmluZ3xpbXBsZW1lbnRhdGlvbnxleGVjdXRpb258ZXZhbHVhdGlvbnxhc3Nlc3NtZW50fGltcHJvdmVtZW50fG9wdGltaXphdGlvbnx0cmFuc2Zvcm1hdGlvbnxjaGFuZ2V8YWRhcHRhdGlvbnxmbGV4aWJpbGl0eXxhZ2lsaXR5fHJlc2lsaWVuY2V8c3VzdGFpbmFiaWxpdHl8ZW52aXJvbm1lbnRhbHxzb2NpYWx8ZXRoaWNhbHxnb3Zlcm5hbmNlfGNvbXBsaWFuY2V8cmVndWxhdGlvbnxwb2xpY3l8cHJvY2VkdXJlfHN0YW5kYXJkfGd1aWRlbGluZXxmcmFtZXdvcmt8bWV0aG9kb2xvZ3l8YXBwcm9hY2h8dGVjaG5pcXVlfG1ldGhvZHxwcm9jZXNzfHN5c3RlbXxzdHJ1Y3R1cmV8b3JnYW5pemF0aW9ufGhpZXJhcmNoeXxkZXBhcnRtZW50fGRpdmlzaW9ufGZ1bmN0aW9ufHJvbGV8cG9zaXRpb258dGl0bGV8Y2FyZWVyfGRldmVsb3BtZW50fHRyYWluaW5nfGVkdWNhdGlvbnxsZWFybmluZ3xrbm93bGVkZ2V8aW5mb3JtYXRpb258ZGF0YXxpbnNpZ2h0fGludGVsbGlnZW5jZXx3aXNkb218dW5kZXJzdGFuZGluZ3xjb21wcmVoZW5zaW9ufGF3YXJlbmVzc3xjb25zY2lvdXNuZXNzfHBlcmNlcHRpb258cGVyc3BlY3RpdmV8dmlld3BvaW50fG9waW5pb258YmVsaWVmfGF0dGl0dWRlfG1pbmRzZXR8Y3VsdHVyZXx2YWx1ZXN8cHJpbmNpcGxlc3xldGhpY3N8aW50ZWdyaXR5fGhvbmVzdHl8dHJhbnNwYXJlbmN5fGFjY291bnRhYmlsaXR5fHJlc3BvbnNpYmlsaXR5fGNvbW1pdG1lbnR8ZGVkaWNhdGlvbnxwYXNzaW9ufG1vdGl2YXRpb258aW5zcGlyYXRpb258Y3JlYXRpdml0eXxpbm5vdmF0aW9ufGltYWdpbmF0aW9ufHZpc2lvbnxtaXNzaW9ufHB1cnBvc2V8bWVhbmluZ3xzaWduaWZpY2FuY2V8aW1wb3J0YW5jZXxyZWxldmFuY2V8cHJpb3JpdHl8dXJnZW5jeXxjcml0aWNhbHxlc3NlbnRpYWx8ZnVuZGFtZW50YWx8YmFzaWN8YWR2YW5jZWR8Y29tcGxleHxzb3BoaXN0aWNhdGVkfGNvbXByZWhlbnNpdmV8ZGV0YWlsZWR8c3BlY2lmaWN8cGFydGljdWxhcnxnZW5lcmFsfG92ZXJhbGx8dG90YWx8Y29tcGxldGV8ZnVsbHxlbnRpcmV8d2hvbGV8cGFydGlhbHxsaW1pdGVkfHJlc3RyaWN0ZWR8ZXhjbHVzaXZlfGluY2x1c2l2ZXxkaXZlcnNlfHZhcmllZHxkaWZmZXJlbnR8c2ltaWxhcnxjb21wYXJhYmxlfGVxdWl2YWxlbnR8ZXF1YWx8ZmFpcnxqdXN0fHJlYXNvbmFibGV8bG9naWNhbHxyYXRpb25hbHxwcmFjdGljYWx8cmVhbGlzdGljfGFjaGlldmFibGV8ZmVhc2libGV8cG9zc2libGV8cHJvYmFibGV8bGlrZWx5fHVubGlrZWx5fGltcG9zc2libGV8Y2VydGFpbnx1bmNlcnRhaW58Y29uZmlkZW50fGRvdWJ0ZnVsfG9wdGltaXN0aWN8cGVzc2ltaXN0aWN8cG9zaXRpdmV8bmVnYXRpdmV8bmV1dHJhbHxvYmplY3RpdmV8c3ViamVjdGl2ZXxwZXJzb25hbHxpbmRpdmlkdWFsfGNvbGxlY3RpdmV8c29jaWFsfHB1YmxpY3xwcml2YXRlfGludGVybmFsfGV4dGVybmFsfGxvY2FsfHJlZ2lvbmFsfG5hdGlvbmFsfGludGVybmF0aW9uYWx8Z2xvYmFsfHdvcmxkd2lkZXx1bml2ZXJzYWwpLy50ZXN0KHdvcmQpKSB7XHJcbiAgICAgICAgc2NvcmUgKz0gM1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBBY2FkZW1pYy9lZHVjYXRpb25hbCB2b2NhYnVsYXJ5XHJcbiAgICAgIGlmICgvXihyZXNlYXJjaHxzdHVkeXxhbmFseXNpc3x0aGVvcnl8Y29uY2VwdHxwcmluY2lwbGV8bWV0aG9kfGFwcHJvYWNofHRlY2huaXF1ZXxwcm9jZXNzfHN5c3RlbXxzdHJ1Y3R1cmV8ZnVuY3Rpb258cmVsYXRpb25zaGlwfGNvbm5lY3Rpb258aW50ZXJhY3Rpb258aW5mbHVlbmNlfGVmZmVjdHxpbXBhY3R8Y2F1c2V8cmVzdWx0fGNvbnNlcXVlbmNlfGZhY3RvcnxlbGVtZW50fGNvbXBvbmVudHxhc3BlY3R8ZmVhdHVyZXxjaGFyYWN0ZXJpc3RpY3xwcm9wZXJ0eXxxdWFsaXR5fGF0dHJpYnV0ZXxkaW1lbnNpb258bGV2ZWx8ZGVncmVlfGV4dGVudHxzY29wZXxyYW5nZXxzY2FsZXxtZWFzdXJlfG1lYXN1cmVtZW50fGV2YWx1YXRpb258YXNzZXNzbWVudHxjb21wYXJpc29ufGNvbnRyYXN0fHNpbWlsYXJpdHl8ZGlmZmVyZW5jZXx2YXJpYXRpb258Y2hhbmdlfGRldmVsb3BtZW50fGV2b2x1dGlvbnxwcm9ncmVzc3xhZHZhbmNlbWVudHxpbXByb3ZlbWVudHxlbmhhbmNlbWVudHxtb2RpZmljYXRpb258YWRqdXN0bWVudHxhZGFwdGF0aW9ufHRyYW5zZm9ybWF0aW9ufHJldm9sdXRpb258aW5ub3ZhdGlvbnxkaXNjb3Zlcnl8aW52ZW50aW9ufGNyZWF0aW9ufHByb2R1Y3Rpb258Y29uc3RydWN0aW9ufGRlc2lnbnxwbGFubmluZ3xvcmdhbml6YXRpb258bWFuYWdlbWVudHxhZG1pbmlzdHJhdGlvbnxvcGVyYXRpb258aW1wbGVtZW50YXRpb258ZXhlY3V0aW9ufHBlcmZvcm1hbmNlfGFjaGlldmVtZW50fGFjY29tcGxpc2htZW50fHN1Y2Nlc3N8ZmFpbHVyZXxjaGFsbGVuZ2V8cHJvYmxlbXxpc3N1ZXxkaWZmaWN1bHR5fG9ic3RhY2xlfGJhcnJpZXJ8bGltaXRhdGlvbnxjb25zdHJhaW50fHJlc3RyaWN0aW9ufHJlcXVpcmVtZW50fGNvbmRpdGlvbnxzaXR1YXRpb258Y2lyY3Vtc3RhbmNlfGNvbnRleHR8ZW52aXJvbm1lbnR8c2V0dGluZ3xiYWNrZ3JvdW5kfGhpc3Rvcnl8dHJhZGl0aW9ufGN1bHR1cmV8c29jaWV0eXxjb21tdW5pdHl8cG9wdWxhdGlvbnxncm91cHx0ZWFtfG9yZ2FuaXphdGlvbnxpbnN0aXR1dGlvbnxlc3RhYmxpc2htZW50fGF1dGhvcml0eXxnb3Zlcm5tZW50fGFkbWluaXN0cmF0aW9ufHBvbGljeXxyZWd1bGF0aW9ufGxhd3xydWxlfHN0YW5kYXJkfGd1aWRlbGluZXxwcm9jZWR1cmV8cHJvdG9jb2x8ZnJhbWV3b3JrfG1vZGVsfHBhdHRlcm58dGVtcGxhdGV8ZXhhbXBsZXxpbnN0YW5jZXxjYXNlfHNjZW5hcmlvfHNpdHVhdGlvbnxjb25kaXRpb258c3RhdGV8c3RhdHVzfHBvc2l0aW9ufGxvY2F0aW9ufHBsYWNlfGFyZWF8cmVnaW9ufHpvbmV8dGVycml0b3J5fGRvbWFpbnxmaWVsZHxzZWN0b3J8aW5kdXN0cnl8bWFya2V0fGVjb25vbXl8YnVzaW5lc3N8Y29tbWVyY2V8dHJhZGV8ZXhjaGFuZ2V8dHJhbnNhY3Rpb258ZGVhbHxhZ3JlZW1lbnR8Y29udHJhY3R8cGFydG5lcnNoaXB8Y29sbGFib3JhdGlvbnxjb29wZXJhdGlvbnxjb29yZGluYXRpb258Y29tbXVuaWNhdGlvbnxpbnRlcmFjdGlvbnxyZWxhdGlvbnNoaXB8Y29ubmVjdGlvbnxuZXR3b3JrfHN5c3RlbXxzdHJ1Y3R1cmV8b3JnYW5pemF0aW9ufGhpZXJhcmNoeXxsZXZlbHxyYW5rfGdyYWRlfGNsYXNzfGNhdGVnb3J5fHR5cGV8a2luZHxzb3J0fHZhcmlldHl8ZGl2ZXJzaXR5fHJhbmdlfHNwZWN0cnVtKS8udGVzdCh3b3JkKSkge1xyXG4gICAgICAgIHNjb3JlICs9IDJcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gVGVjaG5pY2FsL3NwZWNpYWxpemVkIHZvY2FidWxhcnlcclxuICAgICAgaWYgKC9eKHRlY2hub2xvZ3xkaWdpdGFsfGNvbXB1dGVyfHNvZnR3YXJlfGhhcmR3YXJlfGludGVybmV0fG9ubGluZXx3ZWJzaXRlfHBsYXRmb3JtfGFwcGxpY2F0aW9ufHByb2dyYW18Y29kZXxkYXRhfGluZm9ybWF0aW9ufG5ldHdvcmt8c3lzdGVtfHNlY3VyaXR5fHByaXZhY3l8ZW5jcnlwdGlvbnxhbGdvcml0aG18YXJ0aWZpY2lhbHxpbnRlbGxpZ2VuY2V8bWFjaGluZXxsZWFybmluZ3xhdXRvbWF0aW9ufHJvYm90fGlubm92YXRpb258ZGV2ZWxvcG1lbnR8ZW5naW5lZXJpbmd8c2NpZW5jZXxzY2llbnRpZmljfG1lZGljYWx8aGVhbHRofHRyZWF0bWVudHxkaWFnbm9zaXN8cmVzZWFyY2h8ZXhwZXJpbWVudHxsYWJvcmF0b3J5fGVxdWlwbWVudHxpbnN0cnVtZW50fGRldmljZXx0b29sfG1hY2hpbmV8bWVjaGFuaXNtfHByb2Nlc3N8cHJvY2VkdXJlfHRlY2huaXF1ZXxtZXRob2R8YXBwcm9hY2h8c3RyYXRlZ3l8c29sdXRpb258cHJvYmxlbXxjaGFsbGVuZ2V8b3Bwb3J0dW5pdHl8YWR2YW50YWdlfGJlbmVmaXR8cmlza3x0aHJlYXR8ZGFuZ2VyfHNhZmV0eXxwcm90ZWN0aW9ufHByZXZlbnRpb258Y29udHJvbHxtYW5hZ2VtZW50fG1vbml0b3Jpbmd8c3VwZXJ2aXNpb258b3ZlcnNpZ2h0fGdvdmVybmFuY2V8cmVndWxhdGlvbnxjb21wbGlhbmNlfHN0YW5kYXJkfHF1YWxpdHl8cGVyZm9ybWFuY2V8ZWZmaWNpZW5jeXxlZmZlY3RpdmVuZXNzfHByb2R1Y3Rpdml0eXxvcHRpbWl6YXRpb258aW1wcm92ZW1lbnR8ZW5oYW5jZW1lbnR8dXBncmFkZXx1cGRhdGV8bW9kaWZpY2F0aW9ufGN1c3RvbWl6YXRpb258cGVyc29uYWxpemF0aW9ufGFkYXB0YXRpb258ZmxleGliaWxpdHl8c2NhbGFiaWxpdHl8c3VzdGFpbmFiaWxpdHl8cmVsaWFiaWxpdHl8ZHVyYWJpbGl0eXxzdGFiaWxpdHl8Y29uc2lzdGVuY3l8YWNjdXJhY3l8cHJlY2lzaW9ufHZhbGlkaXR5fGNyZWRpYmlsaXR5fGF1dGhlbnRpY2l0eXx0cmFuc3BhcmVuY3l8YWNjb3VudGFiaWxpdHl8cmVzcG9uc2liaWxpdHl8aW50ZWdyaXR5fGV0aGljc3xtb3JhbGl0eXx2YWx1ZXN8cHJpbmNpcGxlc3xiZWxpZWZzfGF0dGl0dWRlc3xwZXJzcGVjdGl2ZXN8b3BpbmlvbnN8dmlld3N8dGhvdWdodHN8aWRlYXN8Y29uY2VwdHN8dGhlb3JpZXN8bW9kZWxzfGZyYW1ld29ya3N8cGFyYWRpZ21zfGFwcHJvYWNoZXN8bWV0aG9kb2xvZ2llc3xzdHJhdGVnaWVzfHRhY3RpY3N8dGVjaG5pcXVlc3xwcm9jZWR1cmVzfHByb3RvY29scykvLnRlc3Qod29yZCkpIHtcclxuICAgICAgICBzY29yZSArPSAyXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEFjdGlvbi9wcm9jZXNzIHdvcmRzICh2ZXJicyBpbiBub3VuIGZvcm0gb3IgZ2VydW5kcylcclxuICAgICAgaWYgKC9eKGFubm91bmNlbWVudHxsZWFkZXJzaGlwfG1hbmFnZW1lbnR8ZGV2ZWxvcG1lbnR8aW1wbGVtZW50YXRpb258YWNoaWV2ZW1lbnR8aW1wcm92ZW1lbnR8dHJhbnNmb3JtYXRpb258Y29tbXVuaWNhdGlvbnxjb2xsYWJvcmF0aW9ufGludmVzdGlnYXRpb258ZXhwbG9yYXRpb258ZXhhbWluYXRpb258ZXZhbHVhdGlvbnxhc3Nlc3NtZW50fGNvbnNpZGVyYXRpb258ZGlzY3Vzc2lvbnxuZWdvdGlhdGlvbnxwcmVzZW50YXRpb258ZGVtb25zdHJhdGlvbnxleHBsYW5hdGlvbnxkZXNjcmlwdGlvbnxpbGx1c3RyYXRpb258aW50ZXJwcmV0YXRpb258dHJhbnNsYXRpb258YWRhcHRhdGlvbnxtb2RpZmljYXRpb258b3B0aW1pemF0aW9ufG9yZ2FuaXphdGlvbnxjb29yZGluYXRpb258YWRtaW5pc3RyYXRpb258c3VwZXJ2aXNpb258b3BlcmF0aW9ufGV4ZWN1dGlvbnxwZXJmb3JtYW5jZXxhY2NvbXBsaXNobWVudHxlc3RhYmxpc2htZW50fG1haW50ZW5hbmNlfHByZXNlcnZhdGlvbnxjb25zZXJ2YXRpb258cHJvdGVjdGlvbnxwcmV2ZW50aW9ufHByb21vdGlvbnxhZHZhbmNlbWVudHxlbmhhbmNlbWVudHxlbnJpY2htZW50fGVtcG93ZXJtZW50fGVuZ2FnZW1lbnR8aW52b2x2ZW1lbnR8cGFydGljaXBhdGlvbnxjb250cmlidXRpb258ZGVkaWNhdGlvbnxjb21taXRtZW50fGludmVzdG1lbnR8YWxsb2NhdGlvbnxkaXN0cmlidXRpb258Y2lyY3VsYXRpb258dHJhbnNtaXNzaW9ufHRyYW5zcG9ydGF0aW9ufGRlbGl2ZXJ5fHByb3Zpc2lvbnxzdXBwbHl8c3VwcG9ydHxhc3Npc3RhbmNlfGd1aWRhbmNlfGRpcmVjdGlvbnxpbnN0cnVjdGlvbnxlZHVjYXRpb258dHJhaW5pbmd8cHJlcGFyYXRpb258cGxhbm5pbmd8c2NoZWR1bGluZ3xhcnJhbmdlbWVudHxjb29yZGluYXRpb258c3luY2hyb25pemF0aW9ufGludGVncmF0aW9ufGNvbWJpbmF0aW9ufGNvbm5lY3Rpb258YXNzb2NpYXRpb258cmVsYXRpb25zaGlwfHBhcnRuZXJzaGlwfGNvbGxhYm9yYXRpb258Y29vcGVyYXRpb258Y29tcGV0aXRpb258Y29tcGFyaXNvbnxjb250cmFzdHxkaWZmZXJlbnRpYXRpb258ZGlzdGluY3Rpb258aWRlbnRpZmljYXRpb258cmVjb2duaXRpb258YWNrbm93bGVkZ21lbnR8YXBwcmVjaWF0aW9ufHVuZGVyc3RhbmRpbmd8Y29tcHJlaGVuc2lvbnxyZWFsaXphdGlvbnxhd2FyZW5lc3N8Y29uc2Npb3VzbmVzc3xwZXJjZXB0aW9ufG9ic2VydmF0aW9ufG1vbml0b3Jpbmd8dHJhY2tpbmd8bWVhc3VyZW1lbnR8Y2FsY3VsYXRpb258ZXN0aW1hdGlvbnxwcmVkaWN0aW9ufGZvcmVjYXN0aW5nfHByb2plY3Rpb258YW50aWNpcGF0aW9ufGV4cGVjdGF0aW9ufGFzc3VtcHRpb258aHlwb3RoZXNpc3xzcGVjdWxhdGlvbnxpbnZlc3RpZ2F0aW9ufGV4cGxvcmF0aW9ufHJlc2VhcmNofGFuYWx5c2lzfHN5bnRoZXNpc3xldmFsdWF0aW9ufGFzc2Vzc21lbnR8anVkZ21lbnR8ZGVjaXNpb258Y2hvaWNlfHNlbGVjdGlvbnxwcmVmZXJlbmNlfHJlY29tbWVuZGF0aW9ufHN1Z2dlc3Rpb258cHJvcG9zYWx8b2ZmZXJ8cmVxdWVzdHxkZW1hbmR8cmVxdWlyZW1lbnR8c3BlY2lmaWNhdGlvbnxpbnN0cnVjdGlvbnxkaXJlY3Rpb258Z3VpZGFuY2V8YWR2aWNlfGNvbnN1bHRhdGlvbnxkaXNjdXNzaW9ufG5lZ290aWF0aW9ufGFncmVlbWVudHxjb250cmFjdHxkZWFsfHRyYW5zYWN0aW9ufGV4Y2hhbmdlfHRyYWRlfHB1cmNoYXNlfHNhbGV8aW52ZXN0bWVudHxmdW5kaW5nfGZpbmFuY2luZ3xzcG9uc29yc2hpcHxzdXBwb3J0fGFzc2lzdGFuY2V8c2VydmljZXxwcm92aXNpb258ZGVsaXZlcnl8ZGlzdHJpYnV0aW9ufGFsbG9jYXRpb258YXNzaWdubWVudHxkZWxlZ2F0aW9ufGF1dGhvcml6YXRpb258YXBwcm92YWx8cGVybWlzc2lvbnxjb25zZW50fGFjY2VwdGFuY2V8cmVqZWN0aW9ufHJlZnVzYWx8ZGVuaWFsfHByb2hpYml0aW9ufHJlc3RyaWN0aW9ufGxpbWl0YXRpb258Y29uc3RyYWludHxyZWd1bGF0aW9ufGNvbnRyb2x8bWFuYWdlbWVudHxhZG1pbmlzdHJhdGlvbnxnb3Zlcm5hbmNlfGxlYWRlcnNoaXB8c3VwZXJ2aXNpb258b3ZlcnNpZ2h0fG1vbml0b3Jpbmd8ZXZhbHVhdGlvbnxhc3Nlc3NtZW50fHJldmlld3xhdWRpdHxpbnNwZWN0aW9ufGV4YW1pbmF0aW9ufGludmVzdGlnYXRpb258aW5xdWlyeXxyZXNlYXJjaHxzdHVkeXxhbmFseXNpc3xpbnRlcnByZXRhdGlvbnxleHBsYW5hdGlvbnxjbGFyaWZpY2F0aW9ufHNwZWNpZmljYXRpb258ZGVmaW5pdGlvbnxkZXNjcmlwdGlvbnxpbGx1c3RyYXRpb258ZGVtb25zdHJhdGlvbnxwcmVzZW50YXRpb258ZXhoaWJpdGlvbnxkaXNwbGF5fHNob3d8cGVyZm9ybWFuY2V8ZXhlY3V0aW9ufGltcGxlbWVudGF0aW9ufGFwcGxpY2F0aW9ufHV0aWxpemF0aW9ufGVtcGxveW1lbnR8dXNhZ2V8b3BlcmF0aW9ufGZ1bmN0aW9ufGFjdGl2aXR5fGFjdGlvbnxiZWhhdmlvcnxjb25kdWN0fHByYWN0aWNlfHByb2NlZHVyZXxwcm9jZXNzfG1ldGhvZHx0ZWNobmlxdWV8YXBwcm9hY2h8c3RyYXRlZ3l8cGxhbnxzY2hlbWV8cHJvZ3JhbXxwcm9qZWN0fGluaXRpYXRpdmV8Y2FtcGFpZ258bW92ZW1lbnR8ZWZmb3J0fGF0dGVtcHR8dHJpYWx8ZXhwZXJpbWVudHx0ZXN0fGV4YW1pbmF0aW9ufGV2YWx1YXRpb258YXNzZXNzbWVudHxtZWFzdXJlbWVudHxjYWxjdWxhdGlvbnxlc3RpbWF0aW9ufGRldGVybWluYXRpb258aWRlbnRpZmljYXRpb258cmVjb2duaXRpb258ZGlzY292ZXJ5fGludmVudGlvbnxjcmVhdGlvbnxwcm9kdWN0aW9ufGNvbnN0cnVjdGlvbnxidWlsZGluZ3xkZXZlbG9wbWVudHxncm93dGh8ZXhwYW5zaW9ufGV4dGVuc2lvbnxlbmxhcmdlbWVudHxpbmNyZWFzZXxpbXByb3ZlbWVudHxlbmhhbmNlbWVudHx1cGdyYWRlfGFkdmFuY2VtZW50fHByb2dyZXNzfGV2b2x1dGlvbnx0cmFuc2Zvcm1hdGlvbnxjaGFuZ2V8bW9kaWZpY2F0aW9ufGFkanVzdG1lbnR8YWRhcHRhdGlvbnxjdXN0b21pemF0aW9ufHBlcnNvbmFsaXphdGlvbnxvcHRpbWl6YXRpb258cmVmaW5lbWVudHxwZXJmZWN0aW9ufGNvbXBsZXRpb258YWNoaWV2ZW1lbnR8YWNjb21wbGlzaG1lbnR8c3VjY2Vzc3x2aWN0b3J5fHRyaXVtcGh8Y29ucXVlc3R8ZGVmZWF0fGZhaWx1cmV8bG9zc3xtaXN0YWtlfGVycm9yfHByb2JsZW18aXNzdWV8ZGlmZmljdWx0eXxjaGFsbGVuZ2V8b2JzdGFjbGV8YmFycmllcnxsaW1pdGF0aW9ufGNvbnN0cmFpbnR8cmVzdHJpY3Rpb258cmVxdWlyZW1lbnR8Y29uZGl0aW9ufHNpdHVhdGlvbnxjaXJjdW1zdGFuY2V8Y29udGV4dHxlbnZpcm9ubWVudHxzZXR0aW5nfGF0bW9zcGhlcmV8Y2xpbWF0ZXxjdWx0dXJlfHRyYWRpdGlvbnxjdXN0b218aGFiaXR8cm91dGluZXxwYXR0ZXJufHRyZW5kfHRlbmRlbmN5fGluY2xpbmF0aW9ufHByZWZlcmVuY2V8Y2hvaWNlfG9wdGlvbnxhbHRlcm5hdGl2ZXxwb3NzaWJpbGl0eXxvcHBvcnR1bml0eXxjaGFuY2V8cHJvYmFiaWxpdHl8bGlrZWxpaG9vZHxjZXJ0YWludHl8dW5jZXJ0YWludHl8ZG91YnR8Y29uZmlkZW5jZXx0cnVzdHxmYWl0aHxiZWxpZWZ8Y29udmljdGlvbnxvcGluaW9ufHZpZXd8cGVyc3BlY3RpdmV8c3RhbmRwb2ludHxwb3NpdGlvbnxzdGFuY2V8YXR0aXR1ZGV8YXBwcm9hY2h8bWluZHNldHxtZW50YWxpdHl8cHN5Y2hvbG9neXxwaGlsb3NvcGh5fGlkZW9sb2d5fHRoZW9yeXxjb25jZXB0fGlkZWF8bm90aW9ufHRob3VnaHR8Y29uc2lkZXJhdGlvbnxyZWZsZWN0aW9ufGNvbnRlbXBsYXRpb258bWVkaXRhdGlvbnxjb25jZW50cmF0aW9ufGZvY3VzfGF0dGVudGlvbnxpbnRlcmVzdHxjdXJpb3NpdHl8d29uZGVyfGFtYXplbWVudHxzdXJwcmlzZXxzaG9ja3xhc3RvbmlzaG1lbnR8YmV3aWxkZXJtZW50fGNvbmZ1c2lvbnx1bmNlcnRhaW50eXxjbGFyaXR5fHVuZGVyc3RhbmRpbmd8Y29tcHJlaGVuc2lvbnxrbm93bGVkZ2V8aW5mb3JtYXRpb258ZGF0YXxmYWN0c3xkZXRhaWxzfHNwZWNpZmljc3xwYXJ0aWN1bGFyc3xjaGFyYWN0ZXJpc3RpY3N8ZmVhdHVyZXN8YXR0cmlidXRlc3xwcm9wZXJ0aWVzfHF1YWxpdGllc3xhc3BlY3RzfGVsZW1lbnRzfGNvbXBvbmVudHN8cGFydHN8c2VjdGlvbnN8c2VnbWVudHN8ZGl2aXNpb25zfGNhdGVnb3JpZXN8dHlwZXN8a2luZHN8dmFyaWV0aWVzfGZvcm1zfHNoYXBlc3xzaXplc3xkaW1lbnNpb25zfG1lYXN1cmVtZW50c3xxdWFudGl0aWVzfGFtb3VudHN8bnVtYmVyc3xmaWd1cmVzfHN0YXRpc3RpY3N8cGVyY2VudGFnZXN8cHJvcG9ydGlvbnN8cmF0aW9zfHJhdGVzfHNwZWVkc3xmcmVxdWVuY2llc3xpbnRlcnZhbHN8cGVyaW9kc3xkdXJhdGlvbnN8dGltZXN8bW9tZW50c3xpbnN0YW5jZXN8b2NjYXNpb25zfGV2ZW50c3xpbmNpZGVudHN8b2NjdXJyZW5jZXN8aGFwcGVuaW5nc3xkZXZlbG9wbWVudHN8Y2hhbmdlc3xtb2RpZmljYXRpb25zfGFsdGVyYXRpb25zfGFkanVzdG1lbnRzfGltcHJvdmVtZW50c3xlbmhhbmNlbWVudHN8dXBncmFkZXN8dXBkYXRlc3xyZXZpc2lvbnN8Y29ycmVjdGlvbnN8Zml4ZXN8cmVwYWlyc3xtYWludGVuYW5jZXxwcmVzZXJ2YXRpb258Y29uc2VydmF0aW9ufHByb3RlY3Rpb258c2VjdXJpdHl8c2FmZXR5fGRlZmVuc2V8cHJldmVudGlvbnxwcmVjYXV0aW9ufHByZXBhcmF0aW9ufHJlYWRpbmVzc3xhdmFpbGFiaWxpdHl8YWNjZXNzaWJpbGl0eXxjb252ZW5pZW5jZXxjb21mb3J0fGVhc2V8c2ltcGxpY2l0eXxjb21wbGV4aXR5fGRpZmZpY3VsdHl8Y2hhbGxlbmdlfGNvbXBsaWNhdGlvbnxzb3BoaXN0aWNhdGlvbnxhZHZhbmNlbWVudHxwcm9ncmVzc3xkZXZlbG9wbWVudHxncm93dGh8ZXhwYW5zaW9ufGV4dGVuc2lvbnxpbmNyZWFzZXxyaXNlfGltcHJvdmVtZW50fGVuaGFuY2VtZW50fGJldHRlcm1lbnR8YW1lbGlvcmF0aW9ufG9wdGltaXphdGlvbnxwZXJmZWN0aW9ufGV4Y2VsbGVuY2V8cXVhbGl0eXxzdGFuZGFyZHxsZXZlbHxncmFkZXxyYW5rfHN0YXR1c3xwb3NpdGlvbnxsb2NhdGlvbnxwbGFjZXxzaXRlfHNwb3R8cG9pbnR8YXJlYXxyZWdpb258em9uZXx0ZXJyaXRvcnl8ZG9tYWlufGZpZWxkfHNlY3RvcnxpbmR1c3RyeXxtYXJrZXR8ZWNvbm9teXxidXNpbmVzc3xlbnRlcnByaXNlfG9yZ2FuaXphdGlvbnxpbnN0aXR1dGlvbnxlc3RhYmxpc2htZW50fGNvbXBhbnl8Y29ycG9yYXRpb258ZmlybXxhZ2VuY3l8ZGVwYXJ0bWVudHxkaXZpc2lvbnxzZWN0aW9ufHVuaXR8dGVhbXxncm91cHxjb21taXR0ZWV8Ym9hcmR8Y291bmNpbHxhc3NlbWJseXxhc3NvY2lhdGlvbnxzb2NpZXR5fGNvbW11bml0eXxwb3B1bGF0aW9ufHB1YmxpY3xhdWRpZW5jZXxjdXN0b21lcnN8Y2xpZW50c3x1c2Vyc3xjb25zdW1lcnN8YnV5ZXJzfHB1cmNoYXNlcnN8aW52ZXN0b3JzfHN0YWtlaG9sZGVyc3xzaGFyZWhvbGRlcnN8cGFydG5lcnN8Y29sbGFib3JhdG9yc3xjb2xsZWFndWVzfGFzc29jaWF0ZXN8bWVtYmVyc3xwYXJ0aWNpcGFudHN8Y29udHJpYnV0b3JzfHN1cHBvcnRlcnN8YWR2b2NhdGVzfHJlcHJlc2VudGF0aXZlc3xkZWxlZ2F0ZXN8YW1iYXNzYWRvcnN8c3Bva2VzcGVyc29uc3xsZWFkZXJzfG1hbmFnZXJzfGRpcmVjdG9yc3xleGVjdXRpdmVzfGFkbWluaXN0cmF0b3JzfHN1cGVydmlzb3JzfGNvb3JkaW5hdG9yc3xvcmdhbml6ZXJzfHBsYW5uZXJzfGRlc2lnbmVyc3xkZXZlbG9wZXJzfGNyZWF0b3JzfHByb2R1Y2Vyc3xtYW51ZmFjdHVyZXJzfHN1cHBsaWVyc3xwcm92aWRlcnN8ZGlzdHJpYnV0b3JzfHJldGFpbGVyc3xzZWxsZXJzfHZlbmRvcnN8Y29udHJhY3RvcnN8Y29uc3VsdGFudHN8YWR2aXNvcnN8ZXhwZXJ0c3xzcGVjaWFsaXN0c3xwcm9mZXNzaW9uYWxzfHByYWN0aXRpb25lcnN8dGVjaG5pY2lhbnN8b3BlcmF0b3JzfHdvcmtlcnN8ZW1wbG95ZWVzfHN0YWZmfHBlcnNvbm5lbHx3b3JrZm9yY2V8bGFib3J8aHVtYW58cmVzb3VyY2VzfGNhcGl0YWx8YXNzZXRzfGludmVzdG1lbnRzfGZ1bmRzfGZpbmFuY2VzfGJ1ZGdldHxjb3N0c3xleHBlbnNlc3xyZXZlbnVlc3xpbmNvbWV8cHJvZml0c3xlYXJuaW5nc3xyZXR1cm5zfGJlbmVmaXRzfGFkdmFudGFnZXN8Z2FpbnN8bG9zc2VzfHJpc2tzfHRocmVhdHN8ZGFuZ2Vyc3xoYXphcmRzfGNoYWxsZW5nZXN8cHJvYmxlbXN8aXNzdWVzfGRpZmZpY3VsdGllc3xvYnN0YWNsZXN8YmFycmllcnN8bGltaXRhdGlvbnN8Y29uc3RyYWludHN8cmVzdHJpY3Rpb25zfHJlcXVpcmVtZW50c3xjb25kaXRpb25zfHRlcm1zfHNwZWNpZmljYXRpb25zfHN0YW5kYXJkc3xjcml0ZXJpYXxndWlkZWxpbmVzfHJ1bGVzfHJlZ3VsYXRpb25zfHBvbGljaWVzfHByb2NlZHVyZXN8cHJvdG9jb2xzfHByb2Nlc3Nlc3xtZXRob2RzfHRlY2huaXF1ZXN8YXBwcm9hY2hlc3xzdHJhdGVnaWVzfHBsYW5zfHByb2dyYW1zfHByb2plY3RzfGluaXRpYXRpdmVzfGNhbXBhaWduc3xlZmZvcnRzfGFjdGl2aXRpZXN8YWN0aW9uc3xvcGVyYXRpb25zfGZ1bmN0aW9uc3xzZXJ2aWNlc3xwcm9kdWN0c3xnb29kc3xpdGVtc3xhcnRpY2xlc3xvYmplY3RzfHRoaW5nc3xtYXRlcmlhbHN8c3Vic3RhbmNlc3xlbGVtZW50c3xjb21wb25lbnRzfGluZ3JlZGllbnRzfGNvbnRlbnRzKSQvLnRlc3Qod29yZCkpIHtcclxuICAgICAgICBzY29yZSArPSAzXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEJvbnVzIGZvciB3b3JkcyB0aGF0IGFwcGVhciBtdWx0aXBsZSB0aW1lcyAoaW5kaWNhdGluZyBpbXBvcnRhbmNlKVxyXG4gICAgICBjb25zdCBmcmVxdWVuY3kgPSAodGV4dC50b0xvd2VyQ2FzZSgpLm1hdGNoKG5ldyBSZWdFeHAoYFxcXFxiJHt3b3JkfVxcXFxiYCwgJ2cnKSkgfHwgW10pLmxlbmd0aFxyXG4gICAgICBpZiAoZnJlcXVlbmN5ID4gMSkgc2NvcmUgKz0gZnJlcXVlbmN5XHJcblxyXG4gICAgICByZXR1cm4geyB3b3JkLCBzY29yZSB9XHJcbiAgICB9KVxyXG5cclxuICAgIC8vIFNvcnQgYnkgc2NvcmUgYW5kIHJldHVybiB0b3Agd29yZHNcclxuICAgIGNvbnN0IHRvcFdvcmRzID0gc2NvcmVkV29yZHNcclxuICAgICAgLnNvcnQoKGEsIGIpID0+IGIuc2NvcmUgLSBhLnNjb3JlKVxyXG4gICAgICAuc2xpY2UoMCwgMTApXHJcbiAgICAgIC5tYXAoaXRlbSA9PiBpdGVtLndvcmQpXHJcblxyXG4gICAgY29uc29sZS5sb2coXCLwn5OaIFNtYXJ0IHZvY2FidWxhcnkgZXh0cmFjdGlvbiByZXN1bHRzOlwiLCB0b3BXb3JkcylcclxuICAgIHJldHVybiB0b3BXb3Jkc1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBkZXRlcm1pbmVDdWx0dXJhbENvbnRleHQoZG9tYWluOiBzdHJpbmcsIHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAvLyBEZXRlcm1pbmUgY3VsdHVyYWwgY29udGV4dCBiYXNlZCBvbiBkb21haW4gYW5kIGNvbnRlbnRcclxuICAgIGNvbnN0IGN1bHR1cmFsSW5kaWNhdG9ycyA9IHtcclxuICAgICAgJ2JiYy5jb20nOiAnQnJpdGlzaCBFbmdsaXNoLCBVSyBjdWx0dXJlJyxcclxuICAgICAgJ2Nubi5jb20nOiAnQW1lcmljYW4gRW5nbGlzaCwgVVMgY3VsdHVyZScsXHJcbiAgICAgICd3aWtpcGVkaWEub3JnJzogJ0ludGVybmF0aW9uYWwsIGVuY3ljbG9wZWRpYycsXHJcbiAgICAgICdueXRpbWVzLmNvbSc6ICdBbWVyaWNhbiBFbmdsaXNoLCBVUyBwZXJzcGVjdGl2ZScsXHJcbiAgICAgICd0aGVndWFyZGlhbi5jb20nOiAnQnJpdGlzaCBFbmdsaXNoLCBVSyBwZXJzcGVjdGl2ZScsXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGN1bHR1cmFsSW5kaWNhdG9yc1tkb21haW5dKSB7XHJcbiAgICAgIHJldHVybiBjdWx0dXJhbEluZGljYXRvcnNbZG9tYWluXVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFuYWx5emUgdGV4dCBmb3IgY3VsdHVyYWwgbWFya2Vyc1xyXG4gICAgY29uc3QgYW1lcmljYW5NYXJrZXJzID0gWydkb2xsYXInLCAncHJlc2lkZW50JywgJ2NvbmdyZXNzJywgJ3N0YXRlJywgJ2ZlZGVyYWwnXVxyXG4gICAgY29uc3QgYnJpdGlzaE1hcmtlcnMgPSBbJ3BvdW5kJywgJ21pbmlzdGVyJywgJ3BhcmxpYW1lbnQnLCAnY291bmNpbCcsICdnb3Zlcm5tZW50J11cclxuXHJcbiAgICBjb25zdCBhbWVyaWNhbkNvdW50ID0gYW1lcmljYW5NYXJrZXJzLmZpbHRlcihtYXJrZXIgPT5cclxuICAgICAgdGV4dC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKG1hcmtlcilcclxuICAgICkubGVuZ3RoXHJcblxyXG4gICAgY29uc3QgYnJpdGlzaENvdW50ID0gYnJpdGlzaE1hcmtlcnMuZmlsdGVyKG1hcmtlciA9PlxyXG4gICAgICB0ZXh0LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobWFya2VyKVxyXG4gICAgKS5sZW5ndGhcclxuXHJcbiAgICBpZiAoYW1lcmljYW5Db3VudCA+IGJyaXRpc2hDb3VudCkge1xyXG4gICAgICByZXR1cm4gJ0FtZXJpY2FuIEVuZ2xpc2ggY29udGV4dCdcclxuICAgIH0gZWxzZSBpZiAoYnJpdGlzaENvdW50ID4gYW1lcmljYW5Db3VudCkge1xyXG4gICAgICByZXR1cm4gJ0JyaXRpc2ggRW5nbGlzaCBjb250ZXh0J1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiAnSW50ZXJuYXRpb25hbCBjb250ZXh0J1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZW5lcmF0ZUxlYXJuaW5nT2JqZWN0aXZlcyhjb250ZW50VHlwZTogc3RyaW5nLCB0b3BpY3M6IHN0cmluZ1tdLCBsZXZlbDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3Qgb2JqZWN0aXZlcyA9IFtdXHJcblxyXG4gICAgLy8gQmFzZSBvYmplY3RpdmVzIG9uIGNvbnRlbnQgdHlwZVxyXG4gICAgc3dpdGNoIChjb250ZW50VHlwZSkge1xyXG4gICAgICBjYXNlICduZXdzJzpcclxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ1VuZGVyc3RhbmQgY3VycmVudCBldmVudHMgdm9jYWJ1bGFyeScpXHJcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdQcmFjdGljZSByZWFkaW5nIG5ld3MgYXJ0aWNsZXMnKVxyXG4gICAgICAgIGJyZWFrXHJcbiAgICAgIGNhc2UgJ2Jsb2cnOlxyXG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnTGVhcm4gaW5mb3JtYWwgd3JpdGluZyBzdHlsZScpXHJcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdVbmRlcnN0YW5kIHBlcnNvbmFsIG9waW5pb25zIGFuZCBleHBlcmllbmNlcycpXHJcbiAgICAgICAgYnJlYWtcclxuICAgICAgY2FzZSAndHV0b3JpYWwnOlxyXG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnRm9sbG93IHN0ZXAtYnktc3RlcCBpbnN0cnVjdGlvbnMnKVxyXG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnTGVhcm4gdGVjaG5pY2FsIHZvY2FidWxhcnknKVxyXG4gICAgICAgIGJyZWFrXHJcbiAgICAgIGNhc2UgJ2VuY3ljbG9wZWRpYSc6XHJcbiAgICAgICAgb2JqZWN0aXZlcy5wdXNoKCdVbmRlcnN0YW5kIGZhY3R1YWwgaW5mb3JtYXRpb24nKVxyXG4gICAgICAgIG9iamVjdGl2ZXMucHVzaCgnTGVhcm4gYWNhZGVtaWMgdm9jYWJ1bGFyeScpXHJcbiAgICAgICAgYnJlYWtcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ0ltcHJvdmUgcmVhZGluZyBjb21wcmVoZW5zaW9uJylcclxuICAgICAgICBvYmplY3RpdmVzLnB1c2goJ0V4cGFuZCB2b2NhYnVsYXJ5IGtub3dsZWRnZScpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWRkIHRvcGljLXNwZWNpZmljIG9iamVjdGl2ZXNcclxuICAgIHRvcGljcy5zbGljZSgwLCAyKS5mb3JFYWNoKHRvcGljID0+IHtcclxuICAgICAgb2JqZWN0aXZlcy5wdXNoKGBEaXNjdXNzIHRvcGljcyByZWxhdGVkIHRvICR7dG9waWMudG9Mb3dlckNhc2UoKX1gKVxyXG4gICAgfSlcclxuXHJcbiAgICByZXR1cm4gb2JqZWN0aXZlcy5zbGljZSgwLCA0KVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRBdWRpZW5jZUxldmVsKGNlZnJMZXZlbDogc3RyaW5nKTogXCJnZW5lcmFsXCIgfCBcImV4cGVydFwiIHwgXCJiZWdpbm5lclwiIHtcclxuICAgIGNvbnN0IGxldmVsTWFwID0ge1xyXG4gICAgICAnQTEnOiAnYmVnaW5uZXInIGFzIGNvbnN0LFxyXG4gICAgICAnQTInOiAnYmVnaW5uZXInIGFzIGNvbnN0LFxyXG4gICAgICAnQjEnOiAnZ2VuZXJhbCcgYXMgY29uc3QsXHJcbiAgICAgICdCMic6ICdnZW5lcmFsJyBhcyBjb25zdCxcclxuICAgICAgJ0MxJzogJ2V4cGVydCcgYXMgY29uc3QsXHJcbiAgICB9XHJcbiAgICByZXR1cm4gbGV2ZWxNYXBbY2VmckxldmVsXSB8fCAnZ2VuZXJhbCdcclxuICB9XHJcblxyXG4gIC8vIEVuaGFuY2VkIGZhbGxiYWNrIGxlc3NvbiBnZW5lcmF0aW9uIHdpdGggY29udGV4dFxyXG4gIHByaXZhdGUgZ2VuZXJhdGVFbmhhbmNlZEZhbGxiYWNrTGVzc29uKHBhcmFtczogTGVzc29uR2VuZXJhdGlvblBhcmFtcyk6IEdlbmVyYXRlZExlc3NvbiB7XHJcbiAgICBjb25zdCB7XHJcbiAgICAgIHNvdXJjZVRleHQsXHJcbiAgICAgIGxlc3NvblR5cGUsXHJcbiAgICAgIHN0dWRlbnRMZXZlbCxcclxuICAgICAgdGFyZ2V0TGFuZ3VhZ2UsXHJcbiAgICAgIGNvbnRlbnRNZXRhZGF0YSxcclxuICAgICAgc3RydWN0dXJlZENvbnRlbnRcclxuICAgIH0gPSBwYXJhbXNcclxuXHJcbiAgICBjb25zb2xlLmxvZyhcIvCflIQgR2VuZXJhdGluZyBlbmhhbmNlZCBmYWxsYmFjayBsZXNzb24gd2l0aCBjb250ZXh0dWFsIHdhcm0tdXAuLi5cIilcclxuXHJcbiAgICAvLyBVc2UgYXZhaWxhYmxlIGNvbnRleHQgZXZlbiBpbiBmYWxsYmFja1xyXG4gICAgY29uc3QgdG9waWNzID0gc3RydWN0dXJlZENvbnRlbnQ/LmhlYWRpbmdzPy5tYXAoaCA9PiBoLnRleHQpLnNsaWNlKDAsIDMpIHx8IFtdXHJcbiAgICBjb25zdCBjb250ZW50VHlwZSA9IGNvbnRlbnRNZXRhZGF0YT8uY29udGVudFR5cGUgfHwgJ2dlbmVyYWwnXHJcblxyXG4gICAgLy8gQ3JlYXRlIG1vY2sgY29udGVudCBhbmFseXNpcyBmb3IgZmFsbGJhY2sgd2FybS11cCBnZW5lcmF0aW9uXHJcbiAgICBjb25zdCBtb2NrQ29udGVudEFuYWx5c2lzID0ge1xyXG4gICAgICB0b3BpY3M6IHRvcGljcyxcclxuICAgICAgY29udGVudFR5cGU6IGNvbnRlbnRUeXBlLFxyXG4gICAgICBzb3VyY2VDb3VudHJ5OiB0aGlzLmRldGVybWluZVNvdXJjZUNvdW50cnkoY29udGVudE1ldGFkYXRhPy5kb21haW4gfHwgJycpLFxyXG4gICAgICBjdWx0dXJhbENvbnRleHQ6IHRoaXMuZGV0ZXJtaW5lQ3VsdHVyYWxDb250ZXh0KGNvbnRlbnRNZXRhZGF0YT8uZG9tYWluIHx8ICcnLCBzb3VyY2VUZXh0KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEdlbmVyYXRlIGNvbnRleHR1YWwgd2FybS11cCBxdWVzdGlvbnMgZXZlbiBpbiBmYWxsYmFja1xyXG4gICAgY29uc3QgY29udGV4dHVhbFdhcm11cCA9IHRoaXMuZ2V0Q29udGV4dHVhbFdhcm11cEZhbGxiYWNrKHN0dWRlbnRMZXZlbCwgbW9ja0NvbnRlbnRBbmFseXNpcywgY29udGVudE1ldGFkYXRhKVxyXG5cclxuICAgIGNvbnNvbGUubG9nKFwi8J+UpSBHZW5lcmF0ZWQgZmFsbGJhY2sgY29udGV4dHVhbCB3YXJtLXVwOlwiLCBjb250ZXh0dWFsV2FybXVwKVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGxlc3NvblR5cGUsXHJcbiAgICAgIHN0dWRlbnRMZXZlbCxcclxuICAgICAgdGFyZ2V0TGFuZ3VhZ2UsXHJcbiAgICAgIHNlY3Rpb25zOiB7XHJcbiAgICAgICAgd2FybXVwOiBjb250ZXh0dWFsV2FybXVwLFxyXG4gICAgICAgIHZvY2FidWxhcnk6IHRoaXMuZXh0cmFjdENvbnRleHR1YWxWb2NhYnVsYXJ5KHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbCwgdG9waWNzKSxcclxuICAgICAgICByZWFkaW5nOiB0aGlzLnNpbXBsaWZ5VGV4dChzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpLFxyXG4gICAgICAgIGNvbXByZWhlbnNpb246IHRoaXMuZ2V0Q29udGV4dHVhbENvbXByZWhlbnNpb24obGVzc29uVHlwZSwgc3R1ZGVudExldmVsLCB0b3BpY3MpLFxyXG4gICAgICAgIGRpYWxvZ3VlUHJhY3RpY2U6IHRoaXMuZ2VuZXJhdGVUZW1wbGF0ZURpYWxvZ3VlUHJhY3RpY2UodG9waWNzWzBdIHx8ICd0aGlzIHRvcGljJywgc3R1ZGVudExldmVsLCBbXSksXHJcbiAgICAgICAgZGlhbG9ndWVGaWxsR2FwOiB0aGlzLmdlbmVyYXRlVGVtcGxhdGVEaWFsb2d1ZUZpbGxHYXAodG9waWNzWzBdIHx8ICd0aGlzIHRvcGljJywgc3R1ZGVudExldmVsLCBbXSksXHJcbiAgICAgICAgZGlzY3Vzc2lvbjogdGhpcy5nZXRDb250ZXh0dWFsRGlzY3Vzc2lvbihsZXNzb25UeXBlLCBzdHVkZW50TGV2ZWwsIHRvcGljcyksXHJcbiAgICAgICAgZ3JhbW1hcjogdGhpcy5nZXRUZW1wbGF0ZUdyYW1tYXIoc3R1ZGVudExldmVsKSxcclxuICAgICAgICBwcm9udW5jaWF0aW9uOiB0aGlzLmdldFRlbXBsYXRlUHJvbnVuY2lhdGlvbihzb3VyY2VUZXh0KSxcclxuICAgICAgICB3cmFwdXA6IHRoaXMuZ2V0Q29udGV4dHVhbFdyYXB1cChsZXNzb25UeXBlLCB0b3BpY3MpLFxyXG4gICAgICB9LFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRDb250ZXh0dWFsV2FybXVwKGxlc3NvblR5cGU6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcsIHRvcGljczogc3RyaW5nW10sIGNvbnRlbnRUeXBlOiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICAvLyBVc2UgdGhlIHNhbWUgY29udGV4dHVhbCBmYWxsYmFjayBsb2dpY1xyXG4gICAgY29uc3QgbW9ja0FuYWx5c2lzID0ge1xyXG4gICAgICB0b3BpY3M6IHRvcGljcyxcclxuICAgICAgY29udGVudFR5cGU6IGNvbnRlbnRUeXBlLFxyXG4gICAgICBzb3VyY2VDb3VudHJ5OiAnSW50ZXJuYXRpb25hbCdcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGhpcy5nZXRDb250ZXh0dWFsV2FybXVwRmFsbGJhY2soc3R1ZGVudExldmVsLCBtb2NrQW5hbHlzaXMsIHsgdGl0bGU6IHRvcGljc1swXSB8fCAnQ29udGVudCcgfSlcclxuICB9XHJcblxyXG4gIC8vIEJhc2ljIGZhbGxiYWNrIGZvciBjb21wbGV0ZSBmYWlsdXJlc1xyXG4gIHByaXZhdGUgZ2VuZXJhdGVCYXNpY0ZhbGxiYWNrTGVzc29uKHBhcmFtczogTGVzc29uR2VuZXJhdGlvblBhcmFtcyk6IEdlbmVyYXRlZExlc3NvbiB7XHJcbiAgICBjb25zdCB7IHNvdXJjZVRleHQsIGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCwgdGFyZ2V0TGFuZ3VhZ2UgfSA9IHBhcmFtc1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGxlc3NvblR5cGUsXHJcbiAgICAgIHN0dWRlbnRMZXZlbCxcclxuICAgICAgdGFyZ2V0TGFuZ3VhZ2UsXHJcbiAgICAgIHNlY3Rpb25zOiB7XHJcbiAgICAgICAgd2FybXVwOiBbXCJXaGF0IGRvIHlvdSBhbHJlYWR5IGtub3cgYWJvdXQgdGhpcyB0b3BpYz9cIiwgXCJIYXZlIHlvdSBoYWQgc2ltaWxhciBleHBlcmllbmNlcz9cIiwgXCJXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGxlYXJuP1wiXSxcclxuICAgICAgICB2b2NhYnVsYXJ5OiBbXSxcclxuICAgICAgICByZWFkaW5nOiBzb3VyY2VUZXh0LnN1YnN0cmluZygwLCA0MDApLFxyXG4gICAgICAgIGNvbXByZWhlbnNpb246IFtcIldoYXQgaXMgdGhlIG1haW4gaWRlYT9cIiwgXCJXaGF0IGRldGFpbHMgY2FuIHlvdSBpZGVudGlmeT9cIl0sXHJcbiAgICAgICAgZGlhbG9ndWVQcmFjdGljZTogdGhpcy5nZW5lcmF0ZVRlbXBsYXRlRGlhbG9ndWVQcmFjdGljZSgndGhpcyB0b3BpYycsIHN0dWRlbnRMZXZlbCwgW10pLFxyXG4gICAgICAgIGRpYWxvZ3VlRmlsbEdhcDogdGhpcy5nZW5lcmF0ZVRlbXBsYXRlRGlhbG9ndWVGaWxsR2FwKCd0aGlzIHRvcGljJywgc3R1ZGVudExldmVsLCBbXSksXHJcbiAgICAgICAgZGlzY3Vzc2lvbjogW1wiV2hhdCBpcyB5b3VyIG9waW5pb24/XCIsIFwiSG93IHdvdWxkIHlvdSBoYW5kbGUgdGhpcz9cIl0sXHJcbiAgICAgICAgZ3JhbW1hcjogdGhpcy5nZXRUZW1wbGF0ZUdyYW1tYXIoc3R1ZGVudExldmVsKSxcclxuICAgICAgICBwcm9udW5jaWF0aW9uOiB7IHdvcmQ6IFwiZXhhbXBsZVwiLCBpcGE6IFwiL8mqyaHLiHrDpm1wyZlsL1wiLCBwcmFjdGljZTogXCJQcmFjdGljZSBzYXlpbmcgZXhhbXBsZS5cIiB9LFxyXG4gICAgICAgIHdyYXB1cDogW1wiV2hhdCBkaWQgeW91IGxlYXJuP1wiLCBcIldoYXQgbmVlZHMgbW9yZSBwcmFjdGljZT9cIl1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBleHRyYWN0Q29udGV4dHVhbFZvY2FidWxhcnkodGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZywgdG9waWNzOiBzdHJpbmdbXSkge1xyXG4gICAgY29uc3Qgdm9jYWJ1bGFyeSA9IHRoaXMuZXh0cmFjdFZvY2FidWxhcnkodGV4dCwgc3R1ZGVudExldmVsKVxyXG5cclxuICAgIC8vIEVuaGFuY2Ugd2l0aCB0b3BpYyBjb250ZXh0IGlmIGF2YWlsYWJsZVxyXG4gICAgaWYgKHRvcGljcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHJldHVybiB2b2NhYnVsYXJ5Lm1hcCgodm9jYWIsIGluZGV4KSA9PiAoe1xyXG4gICAgICAgIC4uLnZvY2FiLFxyXG4gICAgICAgIGNvbnRleHQ6IGluZGV4IDwgdG9waWNzLmxlbmd0aCA/IGBSZWxhdGVkIHRvICR7dG9waWNzW2luZGV4XS50b0xvd2VyQ2FzZSgpfWAgOiB2b2NhYi5tZWFuaW5nLFxyXG4gICAgICB9KSlcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdm9jYWJ1bGFyeVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRDb250ZXh0dWFsQ29tcHJlaGVuc2lvbihsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nLCB0b3BpY3M6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3QgYmFzZVF1ZXN0aW9ucyA9IHRoaXMuZ2V0VGVtcGxhdGVDb21wcmVoZW5zaW9uKGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbClcclxuXHJcbiAgICBpZiAodG9waWNzLmxlbmd0aCA+IDApIHtcclxuICAgICAgcmV0dXJuIFtcclxuICAgICAgICBgV2hhdCBpcyB0aGUgbWFpbiBwb2ludCBhYm91dCAke3RvcGljc1swXT8udG9Mb3dlckNhc2UoKX0/YCxcclxuICAgICAgICBgSG93IGRvZXMgdGhlIHRleHQgZXhwbGFpbiAke3RvcGljc1sxXT8udG9Mb3dlckNhc2UoKSB8fCAndGhlIHRvcGljJ30/YCxcclxuICAgICAgICBcIldoYXQgc3VwcG9ydGluZyBkZXRhaWxzIGNhbiB5b3UgaWRlbnRpZnk/XCIsXHJcbiAgICAgICAgXCJXaGF0IGNvbmNsdXNpb25zIGNhbiB5b3UgZHJhdyBmcm9tIHRoaXMgaW5mb3JtYXRpb24/XCIsXHJcbiAgICAgIF1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gYmFzZVF1ZXN0aW9uc1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRDb250ZXh0dWFsRGlzY3Vzc2lvbihsZXNzb25UeXBlOiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogc3RyaW5nLCB0b3BpY3M6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3QgYmFzZVF1ZXN0aW9ucyA9IHRoaXMuZ2V0VGVtcGxhdGVEaXNjdXNzaW9uKGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbClcclxuXHJcbiAgICBpZiAodG9waWNzLmxlbmd0aCA+IDApIHtcclxuICAgICAgcmV0dXJuIFtcclxuICAgICAgICBgV2hhdCBpcyB5b3VyIG9waW5pb24gYWJvdXQgJHt0b3BpY3NbMF0/LnRvTG93ZXJDYXNlKCl9P2AsXHJcbiAgICAgICAgYEhvdyB3b3VsZCB5b3UgYXBwbHkgdGhpcyBpbmZvcm1hdGlvbiBhYm91dCAke3RvcGljc1sxXT8udG9Mb3dlckNhc2UoKSB8fCAndGhpcyB0b3BpYyd9P2AsXHJcbiAgICAgICAgYFdoYXQgYXJlIHRoZSBpbXBsaWNhdGlvbnMgb2Ygd2hhdCB5b3UgbGVhcm5lZCBhYm91dCAke3RvcGljc1swXT8udG9Mb3dlckNhc2UoKX0/YCxcclxuICAgICAgXVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBiYXNlUXVlc3Rpb25zXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldENvbnRleHR1YWxXcmFwdXAobGVzc29uVHlwZTogc3RyaW5nLCB0b3BpY3M6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xyXG4gICAgaWYgKHRvcGljcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHJldHVybiBbXHJcbiAgICAgICAgYFdoYXQgbmV3IHZvY2FidWxhcnkgZGlkIHlvdSBsZWFybiBhYm91dCAke3RvcGljc1swXT8udG9Mb3dlckNhc2UoKX0/YCxcclxuICAgICAgICBgV2hpY2ggY29uY2VwdHMgYWJvdXQgJHt0b3BpY3NbMV0/LnRvTG93ZXJDYXNlKCkgfHwgJ3RoaXMgdG9waWMnfSBuZWVkIG1vcmUgcHJhY3RpY2U/YCxcclxuICAgICAgICBcIkhvdyB3aWxsIHlvdSB1c2UgdGhpcyBrbm93bGVkZ2UgaW4gcmVhbCBzaXR1YXRpb25zP1wiLFxyXG4gICAgICAgIFwiV2hhdCBxdWVzdGlvbnMgZG8geW91IHN0aWxsIGhhdmUgYWJvdXQgdGhpcyBjb250ZW50P1wiLFxyXG4gICAgICBdXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuZ2V0VGVtcGxhdGVXcmFwdXAobGVzc29uVHlwZSlcclxuICB9XHJcblxyXG4gIC8vIFRlbXBsYXRlIGRpYWxvZ3VlIGdlbmVyYXRpb24gbWV0aG9kc1xyXG4gIHByaXZhdGUgZ2VuZXJhdGVUZW1wbGF0ZURpYWxvZ3VlUHJhY3RpY2UodG9waWM6IHN0cmluZywgc3R1ZGVudExldmVsOiBzdHJpbmcsIHZvY2FidWxhcnlXb3Jkczogc3RyaW5nW10pOiBhbnkge1xyXG4gICAgY29uc3QgbGV2ZWxEaWFsb2d1ZXMgPSB7XHJcbiAgICAgICdBMSc6IHtcclxuICAgICAgICBpbnN0cnVjdGlvbjogXCJQcmFjdGljZSB0aGlzIHNpbXBsZSBjb252ZXJzYXRpb24gd2l0aCB5b3VyIHR1dG9yOlwiLFxyXG4gICAgICAgIGRpYWxvZ3VlOiBbXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJTdHVkZW50XCIsIGxpbmU6IGBJIHdhbnQgdG8gbGVhcm4gYWJvdXQgJHt0b3BpY30uYCB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiVHV0b3JcIiwgbGluZTogYFRoYXQncyBncmVhdCEgV2hhdCBkbyB5b3UgYWxyZWFkeSBrbm93IGFib3V0ICR7dG9waWN9P2AgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlN0dWRlbnRcIiwgbGluZTogXCJJIGtub3cgYSBsaXR0bGUgYml0LlwiIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJUdXRvclwiLCBsaW5lOiBgTGV0J3MgZXhwbG9yZSAke3RvcGljfSB0b2dldGhlci5gIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIGZvbGxvd1VwUXVlc3Rpb25zOiBbXHJcbiAgICAgICAgICBgV2hhdCBpbnRlcmVzdHMgeW91IG1vc3QgYWJvdXQgJHt0b3BpY30/YCxcclxuICAgICAgICAgIFwiV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBrbm93IG1vcmUgYWJvdXQ/XCIsXHJcbiAgICAgICAgICBcIkhvdyBjYW4gdGhpcyBoZWxwIHlvdSBpbiBkYWlseSBsaWZlP1wiXHJcbiAgICAgICAgXVxyXG4gICAgICB9LFxyXG4gICAgICAnQTInOiB7XHJcbiAgICAgICAgaW5zdHJ1Y3Rpb246IFwiUHJhY3RpY2UgdGhpcyBjb252ZXJzYXRpb24gd2l0aCB5b3VyIHR1dG9yOlwiLFxyXG4gICAgICAgIGRpYWxvZ3VlOiBbXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJTdHVkZW50XCIsIGxpbmU6IGBJJ3ZlIGJlZW4gcmVhZGluZyBhYm91dCAke3RvcGljfS4gSXQncyBxdWl0ZSBpbnRlcmVzdGluZy5gIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJUdXRvclwiLCBsaW5lOiBgV2hhdCBkaWQgeW91IGZpbmQgbW9zdCBpbnRlcmVzdGluZyBhYm91dCAke3RvcGljfT9gIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJTdHVkZW50XCIsIGxpbmU6IFwiSSBsZWFybmVkIHNvbWUgbmV3IHRoaW5ncyBJIGRpZG4ndCBrbm93IGJlZm9yZS5cIiB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiVHV0b3JcIiwgbGluZTogYENhbiB5b3Ugc2hhcmUgd2hhdCB5b3UgbGVhcm5lZCBhYm91dCAke3RvcGljfT9gIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIGZvbGxvd1VwUXVlc3Rpb25zOiBbXHJcbiAgICAgICAgICBgSG93IGRvZXMgJHt0b3BpY30gcmVsYXRlIHRvIHlvdXIgZXhwZXJpZW5jZT9gLFxyXG4gICAgICAgICAgXCJXaGF0IHN1cnByaXNlZCB5b3UgdGhlIG1vc3Q/XCIsXHJcbiAgICAgICAgICBcIldvdWxkIHlvdSByZWNvbW1lbmQgdGhpcyB0b3BpYyB0byBvdGhlcnM/XCJcclxuICAgICAgICBdXHJcbiAgICAgIH0sXHJcbiAgICAgICdCMSc6IHtcclxuICAgICAgICBpbnN0cnVjdGlvbjogXCJQcmFjdGljZSB0aGlzIGRpc2N1c3Npb24gd2l0aCB5b3VyIHR1dG9yOlwiLFxyXG4gICAgICAgIGRpYWxvZ3VlOiBbXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJTdHVkZW50XCIsIGxpbmU6IGBJJ3ZlIGJlZW4gdGhpbmtpbmcgYWJvdXQgJHt0b3BpY30gYW5kIGl0cyBpbXBsaWNhdGlvbnMuYCB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiVHV0b3JcIiwgbGluZTogYFRoYXQncyBhIGNvbXBsZXggdG9waWMuIFdoYXQgYXNwZWN0cyBvZiAke3RvcGljfSBpbnRlcmVzdCB5b3UgbW9zdD9gIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJTdHVkZW50XCIsIGxpbmU6IFwiVGhlcmUgYXJlIHNldmVyYWwgZmFjdG9ycyB0byBjb25zaWRlciB3aGVuIGRpc2N1c3NpbmcgdGhpcy5cIiB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiVHV0b3JcIiwgbGluZTogYExldCdzIGV4cGxvcmUgdGhvc2UgZmFjdG9ycy4gV2hhdCBkbyB5b3UgdGhpbmsgaXMgbW9zdCBpbXBvcnRhbnQgYWJvdXQgJHt0b3BpY30/YCB9XHJcbiAgICAgICAgXSxcclxuICAgICAgICBmb2xsb3dVcFF1ZXN0aW9uczogW1xyXG4gICAgICAgICAgYFdoYXQgYXJlIHRoZSBhZHZhbnRhZ2VzIGFuZCBkaXNhZHZhbnRhZ2VzIG9mICR7dG9waWN9P2AsXHJcbiAgICAgICAgICBcIkhvdyBtaWdodCB0aGlzIGltcGFjdCBkaWZmZXJlbnQgZ3JvdXBzIG9mIHBlb3BsZT9cIixcclxuICAgICAgICAgIFwiV2hhdCBzb2x1dGlvbnMgd291bGQgeW91IHByb3Bvc2U/XCJcclxuICAgICAgICBdXHJcbiAgICAgIH0sXHJcbiAgICAgICdCMic6IHtcclxuICAgICAgICBpbnN0cnVjdGlvbjogXCJFbmdhZ2UgaW4gdGhpcyBhbmFseXRpY2FsIGRpc2N1c3Npb24gd2l0aCB5b3VyIHR1dG9yOlwiLFxyXG4gICAgICAgIGRpYWxvZ3VlOiBbXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJTdHVkZW50XCIsIGxpbmU6IGBUaGUgY29tcGxleGl0eSBvZiAke3RvcGljfSByZXF1aXJlcyBjYXJlZnVsIGFuYWx5c2lzIG9mIG11bHRpcGxlIHBlcnNwZWN0aXZlcy5gIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJUdXRvclwiLCBsaW5lOiBgRXhjZWxsZW50IHBvaW50LiBIb3cgZG8geW91IHRoaW5rIGRpZmZlcmVudCBzdGFrZWhvbGRlcnMgdmlldyAke3RvcGljfT9gIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJTdHVkZW50XCIsIGxpbmU6IFwiRWFjaCBwZXJzcGVjdGl2ZSBicmluZ3MgdW5pcXVlIGluc2lnaHRzIGFuZCBjaGFsbGVuZ2VzIHRvIGNvbnNpZGVyLlwiIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJUdXRvclwiLCBsaW5lOiBgV2hhdCBldmlkZW5jZSBzdXBwb3J0cyB5b3VyIGFuYWx5c2lzIG9mICR7dG9waWN9P2AgfVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgZm9sbG93VXBRdWVzdGlvbnM6IFtcclxuICAgICAgICAgIGBIb3cgZG8gY3VsdHVyYWwgZGlmZmVyZW5jZXMgaW5mbHVlbmNlIHBlcnNwZWN0aXZlcyBvbiAke3RvcGljfT9gLFxyXG4gICAgICAgICAgXCJXaGF0IGxvbmctdGVybSBjb25zZXF1ZW5jZXMgc2hvdWxkIHdlIGNvbnNpZGVyP1wiLFxyXG4gICAgICAgICAgXCJIb3cgd291bGQgeW91IGV2YWx1YXRlIHRoZSBlZmZlY3RpdmVuZXNzIG9mIGN1cnJlbnQgYXBwcm9hY2hlcz9cIlxyXG4gICAgICAgIF1cclxuICAgICAgfSxcclxuICAgICAgJ0MxJzoge1xyXG4gICAgICAgIGluc3RydWN0aW9uOiBcIlBhcnRpY2lwYXRlIGluIHRoaXMgc29waGlzdGljYXRlZCBkaXNjb3Vyc2Ugd2l0aCB5b3VyIHR1dG9yOlwiLFxyXG4gICAgICAgIGRpYWxvZ3VlOiBbXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJTdHVkZW50XCIsIGxpbmU6IGBUaGUgbnVhbmNlZCBuYXR1cmUgb2YgJHt0b3BpY30gZGVtYW5kcyBhIG11bHRpZmFjZXRlZCBhcHByb2FjaCB0byB1bmRlcnN0YW5kaW5nLmAgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlR1dG9yXCIsIGxpbmU6IGBJbmRlZWQuIEhvdyBkbyB5b3UgcmVjb25jaWxlIHRoZSBhcHBhcmVudCBjb250cmFkaWN0aW9ucyB3aXRoaW4gJHt0b3BpY30/YCB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiU3R1ZGVudFwiLCBsaW5lOiBcIlRoZSBwYXJhZG94ZXMgaW5oZXJlbnQgaW4gdGhpcyBzdWJqZWN0IHJlZmxlY3QgYnJvYWRlciBzb2NpZXRhbCBjb21wbGV4aXRpZXMuXCIgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlR1dG9yXCIsIGxpbmU6IGBXaGF0IHRoZW9yZXRpY2FsIGZyYW1ld29ya3MgYmVzdCBpbGx1bWluYXRlIHRoZSBpbnRyaWNhY2llcyBvZiAke3RvcGljfT9gIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIGZvbGxvd1VwUXVlc3Rpb25zOiBbXHJcbiAgICAgICAgICBgSG93IGRvIHBoaWxvc29waGljYWwgdW5kZXJwaW5uaW5ncyBzaGFwZSBvdXIgdW5kZXJzdGFuZGluZyBvZiAke3RvcGljfT9gLFxyXG4gICAgICAgICAgXCJXaGF0IHBhcmFkaWdtIHNoaWZ0cyBtaWdodCBiZSBuZWNlc3NhcnkgZm9yIHByb2dyZXNzP1wiLFxyXG4gICAgICAgICAgXCJIb3cgZG8geW91IGVudmlzaW9uIHRoZSBldm9sdXRpb24gb2YgdGhvdWdodCByZWdhcmRpbmcgdGhpcyBtYXR0ZXI/XCJcclxuICAgICAgICBdXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbGV2ZWxEaWFsb2d1ZXNbc3R1ZGVudExldmVsIGFzIGtleW9mIHR5cGVvZiBsZXZlbERpYWxvZ3Vlc10gfHwgbGV2ZWxEaWFsb2d1ZXNbJ0IxJ11cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2VuZXJhdGVUZW1wbGF0ZURpYWxvZ3VlRmlsbEdhcCh0b3BpYzogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IHN0cmluZywgdm9jYWJ1bGFyeVdvcmRzOiBzdHJpbmdbXSk6IGFueSB7XHJcbiAgICBjb25zdCBsZXZlbEdhcERpYWxvZ3VlcyA9IHtcclxuICAgICAgJ0ExJzoge1xyXG4gICAgICAgIGluc3RydWN0aW9uOiBcIkZpbGwgaW4gdGhlIGdhcHMgaW4gdGhpcyBjb252ZXJzYXRpb246XCIsXHJcbiAgICAgICAgZGlhbG9ndWU6IFtcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlN0dWRlbnRcIiwgbGluZTogYEkgX19fX18gdG8gbGVhcm4gYWJvdXQgJHt0b3BpY30uYCwgaXNHYXA6IHRydWUgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlR1dG9yXCIsIGxpbmU6IGBUaGF0J3MgZ3JlYXQhIFdoYXQgX19fX18geW91IGFscmVhZHkga25vdz9gLCBpc0dhcDogdHJ1ZSB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiU3R1ZGVudFwiLCBsaW5lOiBcIkkga25vdyBfX19fXyBsaXR0bGUgYml0LlwiLCBpc0dhcDogdHJ1ZSB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiVHV0b3JcIiwgbGluZTogYExldCdzIF9fX19fIHRvZ2V0aGVyLmAsIGlzR2FwOiB0cnVlIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIGFuc3dlcnM6IFtcIndhbnRcIiwgXCJkb1wiLCBcImFcIiwgXCJsZWFyblwiXVxyXG4gICAgICB9LFxyXG4gICAgICAnQTInOiB7XHJcbiAgICAgICAgaW5zdHJ1Y3Rpb246IFwiQ29tcGxldGUgdGhpcyBjb252ZXJzYXRpb24gd2l0aCB0aGUgbWlzc2luZyB3b3JkczpcIixcclxuICAgICAgICBkaWFsb2d1ZTogW1xyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiU3R1ZGVudFwiLCBsaW5lOiBgSSd2ZSBiZWVuIF9fX19fIGFib3V0ICR7dG9waWN9LmAsIGlzR2FwOiB0cnVlIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJUdXRvclwiLCBsaW5lOiBgV2hhdCBkaWQgeW91IF9fX19fIG1vc3QgaW50ZXJlc3Rpbmc/YCwgaXNHYXA6IHRydWUgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlN0dWRlbnRcIiwgbGluZTogXCJJIF9fX19fIHNvbWUgbmV3IHRoaW5ncy5cIiwgaXNHYXA6IHRydWUgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlR1dG9yXCIsIGxpbmU6IGBDYW4geW91IF9fX19fIHdoYXQgeW91IGxlYXJuZWQ/YCwgaXNHYXA6IHRydWUgfVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgYW5zd2VyczogW1wicmVhZGluZ1wiLCBcImZpbmRcIiwgXCJsZWFybmVkXCIsIFwic2hhcmVcIl1cclxuICAgICAgfSxcclxuICAgICAgJ0IxJzoge1xyXG4gICAgICAgIGluc3RydWN0aW9uOiBcIkZpbGwgaW4gdGhlIGJsYW5rcyB0byBjb21wbGV0ZSB0aGlzIGRpc2N1c3Npb246XCIsXHJcbiAgICAgICAgZGlhbG9ndWU6IFtcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlN0dWRlbnRcIiwgbGluZTogYEkndmUgYmVlbiBfX19fXyBhYm91dCAke3RvcGljfSBhbmQgaXRzIGltcGxpY2F0aW9ucy5gLCBpc0dhcDogdHJ1ZSB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiVHV0b3JcIiwgbGluZTogYFdoYXQgX19fX18gaW50ZXJlc3QgeW91IG1vc3Q/YCwgaXNHYXA6IHRydWUgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlN0dWRlbnRcIiwgbGluZTogXCJUaGVyZSBhcmUgc2V2ZXJhbCBfX19fXyB0byBjb25zaWRlci5cIiwgaXNHYXA6IHRydWUgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlR1dG9yXCIsIGxpbmU6IGBXaGF0IGRvIHlvdSB0aGluayBpcyBtb3N0IF9fX19fID9gLCBpc0dhcDogdHJ1ZSB9XHJcbiAgICAgICAgXSxcclxuICAgICAgICBhbnN3ZXJzOiBbXCJ0aGlua2luZ1wiLCBcImFzcGVjdHNcIiwgXCJmYWN0b3JzXCIsIFwiaW1wb3J0YW50XCJdXHJcbiAgICAgIH0sXHJcbiAgICAgICdCMic6IHtcclxuICAgICAgICBpbnN0cnVjdGlvbjogXCJDb21wbGV0ZSB0aGlzIGFuYWx5dGljYWwgZGlzY3Vzc2lvbjpcIixcclxuICAgICAgICBkaWFsb2d1ZTogW1xyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiU3R1ZGVudFwiLCBsaW5lOiBgVGhlIF9fX19fIG9mICR7dG9waWN9IHJlcXVpcmVzIGNhcmVmdWwgYW5hbHlzaXMuYCwgaXNHYXA6IHRydWUgfSxcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlR1dG9yXCIsIGxpbmU6IGBIb3cgZG8gZGlmZmVyZW50IF9fX19fIHZpZXcgdGhpcyB0b3BpYz9gLCBpc0dhcDogdHJ1ZSB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiU3R1ZGVudFwiLCBsaW5lOiBcIkVhY2ggcGVyc3BlY3RpdmUgYnJpbmdzIHVuaXF1ZSBfX19fXyAuXCIsIGlzR2FwOiB0cnVlIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJUdXRvclwiLCBsaW5lOiBgV2hhdCBfX19fXyBzdXBwb3J0cyB5b3VyIGFuYWx5c2lzP2AsIGlzR2FwOiB0cnVlIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIGFuc3dlcnM6IFtcImNvbXBsZXhpdHlcIiwgXCJzdGFrZWhvbGRlcnNcIiwgXCJpbnNpZ2h0c1wiLCBcImV2aWRlbmNlXCJdXHJcbiAgICAgIH0sXHJcbiAgICAgICdDMSc6IHtcclxuICAgICAgICBpbnN0cnVjdGlvbjogXCJGaWxsIGluIHRoZSBzb3BoaXN0aWNhdGVkIHZvY2FidWxhcnk6XCIsXHJcbiAgICAgICAgZGlhbG9ndWU6IFtcclxuICAgICAgICAgIHsgY2hhcmFjdGVyOiBcIlN0dWRlbnRcIiwgbGluZTogYFRoZSBfX19fXyBuYXR1cmUgb2YgJHt0b3BpY30gZGVtYW5kcyBhIG11bHRpZmFjZXRlZCBhcHByb2FjaC5gLCBpc0dhcDogdHJ1ZSB9LFxyXG4gICAgICAgICAgeyBjaGFyYWN0ZXI6IFwiVHV0b3JcIiwgbGluZTogYEhvdyBkbyB5b3UgX19fX18gdGhlIGFwcGFyZW50IGNvbnRyYWRpY3Rpb25zP2AsIGlzR2FwOiB0cnVlIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJTdHVkZW50XCIsIGxpbmU6IFwiVGhlIF9fX19fIHJlZmxlY3QgYnJvYWRlciBjb21wbGV4aXRpZXMuXCIsIGlzR2FwOiB0cnVlIH0sXHJcbiAgICAgICAgICB7IGNoYXJhY3RlcjogXCJUdXRvclwiLCBsaW5lOiBgV2hhdCB0aGVvcmV0aWNhbCBfX19fXyBiZXN0IGlsbHVtaW5hdGUgdGhpcz9gLCBpc0dhcDogdHJ1ZSB9XHJcbiAgICAgICAgXSxcclxuICAgICAgICBhbnN3ZXJzOiBbXCJudWFuY2VkXCIsIFwicmVjb25jaWxlXCIsIFwicGFyYWRveGVzXCIsIFwiZnJhbWV3b3Jrc1wiXVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGxldmVsR2FwRGlhbG9ndWVzW3N0dWRlbnRMZXZlbCBhcyBrZXlvZiB0eXBlb2YgbGV2ZWxHYXBEaWFsb2d1ZXNdIHx8IGxldmVsR2FwRGlhbG9ndWVzWydCMSddXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgbGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3IgPSBuZXcgTGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3IoKVxyXG4iXSwibmFtZXMiOlsibWV0YWRhdGEiLCJjcmVhdGVHb29nbGVBSVNlcnZlclNlcnZpY2UiLCJQcm9ncmVzc2l2ZUdlbmVyYXRvckltcGwiLCJ1c2FnZU1vbml0b3IiLCJMZXNzb25BSVNlcnZlckdlbmVyYXRvciIsImdldEdvb2dsZUFJIiwiZ29vZ2xlQUkiLCJnZXRQcm9ncmVzc2l2ZUdlbmVyYXRvciIsInByb2dyZXNzaXZlR2VuZXJhdG9yIiwic3VtbWFyaXplQW5kQWRhcHRDb250ZW50Iiwic291cmNlVGV4dCIsInN0dWRlbnRMZXZlbCIsInRhcmdldExhbmd1YWdlIiwibGV2ZWxHdWlkYW5jZSIsImd1aWRhbmNlIiwicHJvbXB0Iiwic3Vic3RyaW5nIiwiY29uc29sZSIsImxvZyIsImxlbmd0aCIsInJlc3BvbnNlIiwidHJpbSIsImVycm9yIiwiZ2VuZXJhdGVMZXNzb24iLCJwYXJhbXMiLCJsZXNzb25UeXBlIiwic291cmNlVXJsIiwiY29udGVudE1ldGFkYXRhIiwic3RydWN0dXJlZENvbnRlbnQiLCJ3b3JkQ291bnQiLCJyZWFkaW5nVGltZSIsIm9uUHJvZ3Jlc3MiLCJnZW5lcmF0aW9uQ29udGV4dCIsImxlc3NvbklkIiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0ciIsImRpZmZpY3VsdHlMZXZlbCIsImNvbnRlbnRMZW5ndGgiLCJ0aW1lc3RhbXAiLCJFcnJvciIsInRleHRMZW5ndGgiLCJoYXNNZXRhZGF0YSIsImhhc1N0cnVjdHVyZWRDb250ZW50IiwiYWRhcHRhdGlvblN0YXJ0VGltZSIsImFkYXB0ZWRDb250ZW50IiwiYWRhcHRhdGlvbkVuZFRpbWUiLCJsb2dUb2tlblVzYWdlIiwiY2VpbCIsImxlc3NvbkdlbmVyYXRpb25TdGFydFRpbWUiLCJsZXNzb25TdHJ1Y3R1cmUiLCJnZW5lcmF0ZU1pbmltYWxBSUxlc3NvbiIsImxlc3NvbkdlbmVyYXRpb25FbmRUaW1lIiwiT2JqZWN0Iiwia2V5cyIsImZpbmFsTGVzc29uIiwibGVzc29uVGl0bGUiLCJzZWN0aW9ucyIsInVuZGVmaW5lZCIsInNlY3Rpb25zQ291bnQiLCJ3YXJtdXBDb3VudCIsIndhcm11cCIsInZvY2FidWxhcnlDb3VudCIsInZvY2FidWxhcnkiLCJoYXNCYW5uZXJJbWFnZXMiLCJiYW5uZXJJbWFnZXMiLCJtZXRhZGF0YUtleXMiLCJiYW5uZXJJbWFnZXNDb3VudCIsIkpTT04iLCJzdHJpbmdpZnkiLCJsb2dFcnJvciIsInByb2dyZXNzaXZlR2VuIiwic2V0UHJvZ3Jlc3NDYWxsYmFjayIsInNoYXJlZENvbnRleHQiLCJidWlsZFNoYXJlZENvbnRleHQiLCJsZXNzb25TZWN0aW9ucyIsIm5hbWUiLCJwcmlvcml0eSIsImRlcGVuZGVuY2llcyIsImdlbmVyYXRlZFNlY3Rpb25zIiwiY3VycmVudENvbnRleHQiLCJzZWN0aW9uIiwiZ2VuZXJhdGVkU2VjdGlvbiIsImdlbmVyYXRlU2VjdGlvbiIsInB1c2giLCJ1cGRhdGVDb250ZXh0IiwiZGlhbG9ndWVQcmFjdGljZSIsImdlbmVyYXRlRGlhbG9ndWVQcmFjdGljZVdpdGhDb250ZXh0IiwiZGlhbG9ndWVGaWxsR2FwIiwiZ2VuZXJhdGVEaWFsb2d1ZUZpbGxHYXBXaXRoQ29udGV4dCIsInNlY3Rpb25OYW1lIiwiY29udGVudCIsImdlbmVyYXRlTWluaW1hbFdhcm11cCIsInRvcGljcyIsImV4dHJhY3RCZXR0ZXJUb3BpY3MiLCJtYWluVG9waWMiLCJxdWVzdGlvbnMiLCJzcGxpdCIsIm1hcCIsImxpbmUiLCJmaWx0ZXIiLCJlbmRzV2l0aCIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJyZXBsYWNlIiwic2xpY2UiLCJtZXNzYWdlIiwiYWRkV2FybXVwSW5zdHJ1Y3Rpb25zIiwiaW5zdHJ1Y3Rpb24iLCJhZGRDb21wcmVoZW5zaW9uSW5zdHJ1Y3Rpb25zIiwiYWRkRGlzY3Vzc2lvbkluc3RydWN0aW9ucyIsImFkZFdyYXB1cEluc3RydWN0aW9ucyIsImFkZFZvY2FidWxhcnlJbnN0cnVjdGlvbnMiLCJ3b3JkIiwibWVhbmluZyIsImV4YW1wbGUiLCJhZGRSZWFkaW5nSW5zdHJ1Y3Rpb25zIiwicmVhZGluZ1RleHQiLCJ0ZXh0IiwiY29tcG91bmRQYXR0ZXJucyIsInBhdHRlcm4iLCJtYXRjaGVzIiwibWF0Y2giLCJtIiwid29yZHMiLCJjb21tb25Xb3JkcyIsImZvdW5kV29yZHMiLCJnZW5lcmF0ZU1pbmltYWxWb2NhYnVsYXJ5IiwibWVhbmluZ2Z1bFdvcmRzIiwiZXh0cmFjdE1lYW5pbmdmdWxWb2NhYnVsYXJ5IiwiY2FwaXRhbGl6ZWRXb3JkIiwiY2FwaXRhbGl6ZVdvcmQiLCJkZWZpbml0aW9uUHJvbXB0IiwicmF3TWVhbmluZyIsImNsZWFuRGVmaW5pdGlvbiIsImV4YW1wbGVzIiwiZ2VuZXJhdGVBSUV4YW1wbGVTZW50ZW5jZXMiLCJnZW5lcmF0ZUNvbnRleHR1YWxXb3JkTWVhbmluZyIsImdlbmVyYXRlTWluaW1hbENvbXByZWhlbnNpb24iLCJzaG9ydFRleHQiLCJnZW5lcmF0ZU1pbmltYWxSZWFkaW5nIiwiZ2VuZXJhdGVNaW5pbWFsRGlzY3Vzc2lvbiIsImdlbmVyYXRlTWluaW1hbEdyYW1tYXIiLCJwYXJzZSIsImdlbmVyYXRlTWluaW1hbFByb251bmNpYXRpb24iLCJ2b2NhYnVsYXJ5V29yZHMiLCJnZW5lcmF0ZU1pbmltYWxXcmFwdXAiLCJhbmFseXplQ29udGVudENvbnRleHROb0FJIiwiYW5hbHlzaXMiLCJjb250ZW50VHlwZSIsImRvbWFpbiIsImNvbXBsZXhpdHkiLCJrZXlWb2NhYnVsYXJ5IiwiY3VsdHVyYWxDb250ZXh0IiwibGVhcm5pbmdPYmplY3RpdmVzIiwiZGlmZmljdWx0eSIsInRpdGxlIiwic291cmNlQ291bnRyeSIsImRldGVybWluZVNvdXJjZUNvdW50cnkiLCJzZW50ZW5jZXMiLCJzIiwiYXZnU2VudGVuY2VMZW5ndGgiLCJyZWR1Y2UiLCJzdW0iLCJjb21wbGV4V29yZHMiLCJ0b3RhbFdvcmRzIiwiZXh0cmFjdFRvcGljc0Zyb21UZXh0IiwiaGVhZGluZ3MiLCJleHRyYWN0Vm9jYWJ1bGFyeUZyb21UZXh0IiwiZGV0ZXJtaW5lQ3VsdHVyYWxDb250ZXh0IiwiZ2VuZXJhdGVMZWFybmluZ09iamVjdGl2ZXMiLCJhbmFseXplQ29udGVudENvbnRleHQiLCJjcmVhdGVDb250ZXh0dWFsU3VtbWFyeSIsImNvbnRlbnRBbmFseXNpcyIsInN1bW1hcnlQcm9tcHQiLCJzdW1tYXJ5IiwidGVtcGVyYXR1cmUiLCJtYXhUb2tlbnMiLCJ3YXJuIiwidHJ1bmNhdGVkIiwiZ2VuZXJhdGVDb250ZXh0dWFsV2FybXVwUXVlc3Rpb25zIiwibGV2ZWxJbnN0cnVjdGlvbnMiLCJ0b3BpYyIsIndhcm11cFByb21wdCIsInBhcnNlTGlzdEZyb21UZXh0IiwiZmFsbGJhY2tRdWVzdGlvbiIsImdldEZhbGxiYWNrV2FybXVwUXVlc3Rpb24iLCJmYWxsYmFja1F1ZXN0aW9ucyIsImdldENvbnRleHR1YWxXYXJtdXBGYWxsYmFjayIsImdlbmVyYXRlQ29udGV4dHVhbExlc3NvblN0cnVjdHVyZSIsImNvbnRleHR1YWxXYXJtdXAiLCJqb2luIiwidm9jYWIiLCJwYXJzZWQiLCJwYXJzZUVycm9yIiwianNvbk1hdGNoIiwiY2xlYW5lZCIsImNsZWFuRXJyb3IiLCJmYWxsYmFjayIsImNyZWF0ZVN0cnVjdHVyZWRGYWxsYmFjayIsImdlbmVyYXRlRGV0YWlsZWRDb250ZXh0dWFsQ29udGVudCIsInN0cnVjdHVyZSIsImkiLCJjb250ZXh0dWFsRXhhbXBsZVByb21wdCIsImVuaGFuY2VkRXhhbXBsZSIsIndyaXRlIiwidG9uZSIsImNvbnRleHR1YWxNZWFuaW5nUHJvbXB0IiwiY29udGV4dHVhbE1lYW5pbmciLCJkaXNjdXNzaW9uIiwiZW5oYW5jZWREaXNjdXNzaW9uUHJvbXB0IiwiZW5oYW5jZWREaXNjdXNzaW9uIiwiZm9ybWF0IiwicmVhZGluZyIsInN0cnVjdHVyZWRSZWFkaW5nUHJvbXB0IiwiaCIsImVuaGFuY2VkUmVhZGluZyIsInJld3JpdGUiLCJhdWRpZW5jZSIsImdldEF1ZGllbmNlTGV2ZWwiLCJncmFtbWFyIiwiZm9jdXMiLCJncmFtbWFyRXhhbXBsZXNQcm9tcHQiLCJjb250ZXh0dWFsR3JhbW1hckV4YW1wbGVzIiwiY29udGV4dHVhbEV4YW1wbGVzIiwicHJvb2ZyZWFkTGVzc29uIiwibGVzc29uIiwic2VjdGlvbnNUb1Byb29mcmVhZCIsInNlY3Rpb25QYXRoIiwidmFsdWUiLCJnZXROZXN0ZWRWYWx1ZSIsInByb29mcmVhZCIsImNoZWNrR3JhbW1hciIsImNoZWNrU3BlbGxpbmciLCJjaGVja1N0eWxlIiwic2V0TmVzdGVkVmFsdWUiLCJjb3JyZWN0ZWRfdGV4dCIsImdlbmVyYXRlRmFsbGJhY2tMZXNzb24iLCJnZXRUZW1wbGF0ZVdhcm11cCIsImV4dHJhY3RWb2NhYnVsYXJ5Iiwic2ltcGxpZnlUZXh0IiwiY29tcHJlaGVuc2lvbiIsImdldFRlbXBsYXRlQ29tcHJlaGVuc2lvbiIsImdlbmVyYXRlVGVtcGxhdGVEaWFsb2d1ZVByYWN0aWNlIiwiZ2VuZXJhdGVUZW1wbGF0ZURpYWxvZ3VlRmlsbEdhcCIsImdldFRlbXBsYXRlRGlzY3Vzc2lvbiIsImdldFRlbXBsYXRlR3JhbW1hciIsInByb251bmNpYXRpb24iLCJnZXRUZW1wbGF0ZVByb251bmNpYXRpb24iLCJ3cmFwdXAiLCJnZXRUZW1wbGF0ZVdyYXB1cCIsImdldFN1bW1hcnlMZW5ndGgiLCJsZXZlbCIsImxlbmd0aE1hcCIsIkExIiwiQTIiLCJCMSIsIkIyIiwiQzEiLCJnZXRMYW5ndWFnZUNvZGUiLCJsYW5ndWFnZSIsImxhbmd1YWdlTWFwIiwic3BhbmlzaCIsImZyZW5jaCIsImdlcm1hbiIsIml0YWxpYW4iLCJwb3J0dWd1ZXNlIiwiamFwYW5lc2UiLCJrb3JlYW4iLCJjaGluZXNlIiwib2JqIiwicGF0aCIsImN1cnJlbnQiLCJrZXkiLCJsYXN0S2V5IiwicG9wIiwidGFyZ2V0IiwidW5pcXVlV29yZHMiLCJBcnJheSIsImZyb20iLCJTZXQiLCJ0ZW1wbGF0ZXMiLCJ0cmF2ZWwiLCJidXNpbmVzcyIsInNlbGVjdGVkV29yZHMiLCJtYXhMZW5ndGgiLCJsaW1pdCIsImdyYW1tYXJGb2NpIiwiZXhlcmNpc2UiLCJzZWxlY3RlZFdvcmQiLCJpcGEiLCJwcmFjdGljZSIsImV4dHJhY3RUb3BpY3NGcm9tSGVhZGluZ3MiLCJoZWFkaW5nVG9waWNzIiwidG9waWNQYXR0ZXJucyIsInNlbnRlbmNlIiwia2V5V29yZHMiLCJpbmRleCIsImFyciIsImluZGV4T2YiLCJleGNsdWRlV29yZHMiLCJoYXMiLCJ0ZXN0IiwiaXNQcm9wZXJOYW1lIiwic2NvcmVkV29yZHMiLCJzY29yZSIsImZyZXF1ZW5jeSIsIlJlZ0V4cCIsInRvcFdvcmRzIiwic29ydCIsImEiLCJiIiwiaXRlbSIsInciLCJmaW5kIiwiY3VsdHVyYWxJbmRpY2F0b3JzIiwiYW1lcmljYW5NYXJrZXJzIiwiYnJpdGlzaE1hcmtlcnMiLCJhbWVyaWNhbkNvdW50IiwibWFya2VyIiwiYnJpdGlzaENvdW50Iiwib2JqZWN0aXZlcyIsImZvckVhY2giLCJjZWZyTGV2ZWwiLCJsZXZlbE1hcCIsImdlbmVyYXRlRW5oYW5jZWRGYWxsYmFja0xlc3NvbiIsIm1vY2tDb250ZW50QW5hbHlzaXMiLCJleHRyYWN0Q29udGV4dHVhbFZvY2FidWxhcnkiLCJnZXRDb250ZXh0dWFsQ29tcHJlaGVuc2lvbiIsImdldENvbnRleHR1YWxEaXNjdXNzaW9uIiwiZ2V0Q29udGV4dHVhbFdyYXB1cCIsImdldENvbnRleHR1YWxXYXJtdXAiLCJtb2NrQW5hbHlzaXMiLCJnZW5lcmF0ZUJhc2ljRmFsbGJhY2tMZXNzb24iLCJjb250ZXh0IiwiYmFzZVF1ZXN0aW9ucyIsImxldmVsRGlhbG9ndWVzIiwiZGlhbG9ndWUiLCJjaGFyYWN0ZXIiLCJmb2xsb3dVcFF1ZXN0aW9ucyIsImxldmVsR2FwRGlhbG9ndWVzIiwiaXNHYXAiLCJhbnN3ZXJzIiwibGVzc29uQUlTZXJ2ZXJHZW5lcmF0b3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/lesson-ai-generator-server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/progressive-generator.ts":
/*!**************************************!*\
  !*** ./lib/progressive-generator.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DEFAULT_PHASE_WEIGHTS: () => (/* binding */ DEFAULT_PHASE_WEIGHTS),\n/* harmony export */   ProgressiveGeneratorImpl: () => (/* binding */ ProgressiveGeneratorImpl),\n/* harmony export */   safeProgressCallback: () => (/* binding */ safeProgressCallback)\n/* harmony export */ });\n/* harmony import */ var _google_ai_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./google-ai-server */ \"(rsc)/./lib/google-ai-server.ts\");\n/* harmony import */ var _warmup_validator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./warmup-validator */ \"(rsc)/./lib/warmup-validator.ts\");\n/* harmony import */ var _section_validators__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./section-validators */ \"(rsc)/./lib/section-validators.ts\");\n/* harmony import */ var _quality_metrics__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./quality-metrics */ \"(rsc)/./lib/quality-metrics.ts\");\n\n\n\n\nconst DEFAULT_PHASE_WEIGHTS = {\n    warmup: 10,\n    vocabulary: 15,\n    reading: 20,\n    comprehension: 10,\n    discussion: 10,\n    dialogue: 15,\n    grammar: 15,\n    pronunciation: 15,\n    wrapup: 5\n};\n/**\r\n * Safe wrapper for progress callbacks that isolates errors\r\n * Ensures callback failures don't break the generation process\r\n * \r\n * @param callback - Optional progress callback function\r\n * @param update - Progress update data to send to callback\r\n */ function safeProgressCallback(callback, update) {\n    // If no callback provided, do nothing\n    if (!callback) {\n        return;\n    }\n    try {\n        // Invoke the callback with the progress update\n        callback(update);\n    } catch (error) {\n        // Log error but don't throw - generation should continue\n        console.error(\"Progress callback error:\", error);\n        console.error(\"Progress update that caused error:\", update);\n        // Optionally log stack trace for debugging\n        if (error instanceof Error && error.stack) {\n            console.error(\"Stack trace:\", error.stack);\n        }\n    }\n}\n// Implementation of Progressive Generator\nclass ProgressiveGeneratorImpl {\n    constructor(){\n        this.googleAI = null;\n        this.completedSections = [];\n        this.currentLessonType = \"\";\n        this.phaseWeights = DEFAULT_PHASE_WEIGHTS;\n        this.warmupValidator = new _warmup_validator__WEBPACK_IMPORTED_MODULE_1__.WarmupValidator();\n    }\n    /**\r\n   * Set the progress callback for this generator instance\r\n   * Should be called before starting generation\r\n   */ setProgressCallback(callback, lessonType) {\n        this.progressCallback = callback;\n        this.currentLessonType = lessonType;\n        this.completedSections = [];\n    }\n    /**\r\n   * Get quality metrics for the current lesson generation\r\n   */ getQualityMetrics() {\n        return _quality_metrics__WEBPACK_IMPORTED_MODULE_3__.qualityMetricsTracker.getQualityReport();\n    }\n    /**\r\n   * Log quality summary for the lesson\r\n   */ logQualitySummary() {\n        _quality_metrics__WEBPACK_IMPORTED_MODULE_3__.qualityMetricsTracker.logSummary();\n    }\n    /**\r\n   * Reset quality metrics for new lesson generation\r\n   */ resetQualityMetrics() {\n        _quality_metrics__WEBPACK_IMPORTED_MODULE_3__.qualityMetricsTracker.reset();\n    }\n    getGoogleAI() {\n        if (!this.googleAI) {\n            this.googleAI = (0,_google_ai_server__WEBPACK_IMPORTED_MODULE_0__.createGoogleAIServerService)();\n        }\n        return this.googleAI;\n    }\n    /**\r\n   * Calculate progress percentage based on phase weights and lesson type\r\n   * Handles different lesson types with varying section combinations\r\n   */ calculateProgress(completedSections, currentSection, lessonType, phaseWeights = DEFAULT_PHASE_WEIGHTS) {\n        // Determine which sections are included in this lesson type\n        const activeSections = this.getActiveSectionsForLessonType(lessonType);\n        // Calculate total weight for active sections only\n        const totalWeight = activeSections.reduce((sum, section)=>{\n            return sum + (phaseWeights[section] || 0);\n        }, 0);\n        if (totalWeight === 0) {\n            return 0;\n        }\n        // Deduplicate completed sections to avoid counting the same section multiple times\n        const uniqueCompletedSections = Array.from(new Set(completedSections));\n        // Calculate weight of completed sections\n        const completedWeight = uniqueCompletedSections.reduce((sum, section)=>{\n            if (activeSections.includes(section)) {\n                return sum + (phaseWeights[section] || 0);\n            }\n            return sum;\n        }, 0);\n        // Calculate progress percentage\n        const progress = Math.round(completedWeight / totalWeight * 100);\n        return Math.min(progress, 100);\n    }\n    /**\r\n   * Get the list of active sections for a given lesson type\r\n   * Different lesson types include different sections\r\n   */ getActiveSectionsForLessonType(lessonType) {\n        // Base sections included in all lesson types\n        const baseSections = [\n            \"warmup\",\n            \"vocabulary\",\n            \"reading\",\n            \"comprehension\",\n            \"wrapup\"\n        ];\n        // Additional sections based on lesson type\n        const lessonTypeMap = {\n            \"discussion\": [\n                ...baseSections,\n                \"discussion\"\n            ],\n            \"grammar\": [\n                ...baseSections,\n                \"grammar\"\n            ],\n            \"pronunciation\": [\n                ...baseSections,\n                \"pronunciation\"\n            ],\n            \"travel\": [\n                ...baseSections,\n                \"dialogue\"\n            ],\n            \"business\": [\n                ...baseSections,\n                \"dialogue\"\n            ],\n            \"dialogue\": [\n                ...baseSections,\n                \"dialogue\"\n            ]\n        };\n        // Return sections for the specific lesson type, or base sections if type not found\n        return lessonTypeMap[lessonType.toLowerCase()] || baseSections;\n    }\n    /**\r\n   * Build shared context that will be reused across all lesson sections\r\n   */ async buildSharedContext(sourceText, lessonType, studentLevel, targetLanguage, metadata) {\n        console.log(\"\\uD83C\\uDFD7 Building shared context for progressive generation...\");\n        try {\n            // Generate contextual lesson title (with fallback to metadata)\n            const lessonTitle = await this.generateLessonTitle(sourceText, lessonType, studentLevel, metadata);\n            // Extract key vocabulary using AI optimization\n            const keyVocabulary = await this.extractKeyVocabulary(sourceText, studentLevel);\n            // Extract main themes\n            const mainThemes = await this.extractMainThemes(sourceText, studentLevel);\n            // Create content summary\n            const contentSummary = await this.createContentSummary(sourceText, studentLevel);\n            const sharedContext = {\n                lessonTitle,\n                keyVocabulary,\n                mainThemes,\n                difficultyLevel: studentLevel,\n                contentSummary,\n                sourceText: sourceText.substring(0, 1000),\n                lessonType,\n                targetLanguage\n            };\n            console.log(\" Shared context built:\", {\n                lessonTitle,\n                vocabularyCount: keyVocabulary.length,\n                themesCount: mainThemes.length,\n                summaryLength: contentSummary.length\n            });\n            return sharedContext;\n        } catch (error) {\n            console.error(\" Failed to build shared context:\", error);\n            throw new Error(\"Failed to build shared context: \" + error.message);\n        }\n    }\n    /**\r\n   * Generate a specific lesson section using shared context\r\n   * Now includes quality validation and metrics tracking\r\n   */ async generateSection(section, sharedContext, previousSections) {\n        console.log(` Generating section: ${section.name}`);\n        // Report progress at start of section generation\n        const startProgress = this.calculateProgress(this.completedSections, section.name, this.currentLessonType || sharedContext.lessonType, this.phaseWeights);\n        safeProgressCallback(this.progressCallback, {\n            step: `Generating ${section.name}`,\n            progress: startProgress,\n            phase: section.name,\n            section: section.name\n        });\n        const startTime = Date.now();\n        let content;\n        let tokensUsed = 0;\n        let generationStrategy = \"progressive\";\n        try {\n            switch(section.name){\n                case \"warmup\":\n                    content = await this.generateWarmupWithContext(sharedContext, previousSections);\n                    break;\n                case \"vocabulary\":\n                    content = await this.generateVocabularyWithContext(sharedContext, previousSections);\n                    break;\n                case \"reading\":\n                    content = await this.generateReadingWithContext(sharedContext, previousSections);\n                    break;\n                case \"comprehension\":\n                    content = await this.generateComprehensionWithContext(sharedContext, previousSections);\n                    break;\n                case \"discussion\":\n                    content = await this.generateDiscussionWithContext(sharedContext, previousSections);\n                    break;\n                case \"grammar\":\n                    content = await this.generateGrammarWithContext(sharedContext, previousSections);\n                    break;\n                case \"pronunciation\":\n                    content = await this.generatePronunciationWithContext(sharedContext, previousSections);\n                    break;\n                case \"wrapup\":\n                    content = await this.generateWrapupWithContext(sharedContext, previousSections);\n                    break;\n                default:\n                    throw new Error(`Unknown section: ${section.name}`);\n            }\n            const generationTime = Date.now() - startTime;\n            console.log(` Section ${section.name} generated in ${generationTime}ms`);\n            // Mark section as completed and report progress\n            this.completedSections.push(section.name);\n            const completionProgress = this.calculateProgress(this.completedSections, section.name, this.currentLessonType || sharedContext.lessonType, this.phaseWeights);\n            safeProgressCallback(this.progressCallback, {\n                step: `Completed ${section.name}`,\n                progress: completionProgress,\n                phase: section.name,\n                section: section.name\n            });\n            return {\n                sectionName: section.name,\n                content,\n                tokensUsed,\n                generationStrategy\n            };\n        } catch (error) {\n            console.error(` Failed to generate section ${section.name}:`, error);\n            throw new Error(`Failed to generate ${section.name} section: ${error.message}`);\n        }\n    }\n    /**\r\n   * Update shared context with information from newly generated section\r\n   */ updateContext(context, newSection) {\n        console.log(` Updating context with ${newSection.sectionName} section`);\n        const updatedContext = {\n            ...context\n        };\n        // Update vocabulary if new words were introduced\n        if (newSection.sectionName === \"vocabulary\" && Array.isArray(newSection.content)) {\n            const newWords = newSection.content.filter((item)=>item.word && item.word !== \"INSTRUCTION\").map((item)=>item.word.toLowerCase());\n            updatedContext.keyVocabulary = [\n                ...new Set([\n                    ...updatedContext.keyVocabulary,\n                    ...newWords\n                ])\n            ];\n        }\n        // Update themes if new ones were identified\n        if (newSection.sectionName === \"reading\" && typeof newSection.content === \"string\") {\n            // Extract any new themes from the reading passage\n            const newThemes = this.extractThemesFromText(newSection.content);\n            updatedContext.mainThemes = [\n                ...new Set([\n                    ...updatedContext.mainThemes,\n                    ...newThemes\n                ])\n            ];\n        }\n        console.log(` Context updated for ${newSection.sectionName}`);\n        return updatedContext;\n    }\n    // Private helper methods for extracting shared context\n    async generateLessonTitle(sourceText, lessonType, studentLevel, metadata) {\n        console.log(\"\\uD83C\\uDFAF Generating lesson title with format: 'Original Title - AI Generated Title'...\");\n        // Extract original article title from metadata\n        const originalTitle = metadata?.title ? metadata.title.replace(/\\s*-\\s*Wikipedia$/i, \"\").replace(/\\s*\\|\\s*.+$/i, \"\").trim().substring(0, 60) : null;\n        console.log(\"\\uD83D\\uDCF0 Original article title:\", originalTitle || \"Not available\");\n        try {\n            // Create Engoo-style title prompt with examples\n            const engooPrompt = `Create an engaging lesson title in Engoo style for ${studentLevel} level ${lessonType} lesson.\r\n\r\nContent: ${sourceText.substring(0, 200)}\r\n\r\nEngoo-style titles are:\r\n- Engaging and conversational (3-8 words)\r\n- Focus on the main topic or theme\r\n- Avoid generic words like \"lesson\", \"article\", \"story\"\r\n- Use active, interesting language\r\n- Examples: \"Tech Giants Go Nuclear\", \"The Rise of Digital Nomads\", \"Climate Change Solutions\"\r\n\r\nGenerate title:`;\n            const response = await this.getGoogleAI().prompt(engooPrompt, {\n                maxTokens: 60\n            });\n            const aiTitle = response.trim().replace(/['\"]/g, \"\").replace(/^(Title:?|Generate title:?)\\s*/i, \"\").replace(/\\.$/, \"\") // Remove trailing period\n            .substring(0, 60);\n            console.log(\"\\uD83E\\uDD16 AI generated Engoo-style title:\", aiTitle);\n            // Validate the AI title - should be engaging and appropriate length\n            if (aiTitle.length > 5 && aiTitle.length < 80 && !aiTitle.toLowerCase().includes(\"lesson\") && !aiTitle.toLowerCase().includes(\"article\") && aiTitle.split(\" \").length >= 2 && aiTitle.split(\" \").length <= 8) {\n                // Format: \"Original Title - AI Generated Title\"\n                if (originalTitle) {\n                    const fullTitle = `${originalTitle} - ${aiTitle}`;\n                    console.log(\" Using combined title:\", fullTitle);\n                    return fullTitle;\n                } else {\n                    console.log(\" Using AI-generated title only:\", aiTitle);\n                    return aiTitle;\n                }\n            }\n            console.warn(\" AI generated invalid title, using fallback\");\n        } catch (error) {\n            console.warn(\" AI title generation failed, using fallback:\", error.message);\n        }\n        // PRAGMATIC FALLBACK: Use metadata or generate simple title\n        // This ensures lesson generation NEVER fails due to title issues\n        // Option 1: Use original title with lesson type\n        if (originalTitle) {\n            const lessonTypeLabel = lessonType.charAt(0).toUpperCase() + lessonType.slice(1);\n            const fallbackTitle = `${originalTitle} - ${lessonTypeLabel} Lesson`;\n            console.log(\" Using original title with lesson type:\", fallbackTitle);\n            return fallbackTitle;\n        }\n        // Option 2: Generate from first sentence\n        const firstSentence = sourceText.split(/[.!?]/)[0]?.trim();\n        if (firstSentence && firstSentence.length > 10 && firstSentence.length < 100) {\n            const simpleTitle = firstSentence.substring(0, 60) + (firstSentence.length > 60 ? \"...\" : \"\");\n            console.log(\" Using content-based title:\", simpleTitle);\n            return simpleTitle;\n        }\n        // Option 3: Generic but functional fallback\n        const lessonTypeLabel = lessonType.charAt(0).toUpperCase() + lessonType.slice(1);\n        const genericTitle = `${lessonTypeLabel} Lesson - ${studentLevel} Level`;\n        console.log(\" Using generic title:\", genericTitle);\n        return genericTitle;\n    }\n    async extractKeyVocabulary(sourceText, studentLevel) {\n        const prompt = `Extract 8-12 key vocabulary words from this text for ${studentLevel} level students. Return only the words, one per line:\r\n\r\n${sourceText.substring(0, 500)}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const words = response.split(\"\\n\").map((line)=>line.trim().toLowerCase()).filter((word)=>word.length > 2 && word.length < 20).slice(0, 12);\n            return words.length >= 6 ? words : this.extractVocabularyFallback(sourceText, studentLevel);\n        } catch (error) {\n            console.log(\" AI vocabulary extraction failed, using fallback\");\n            return this.extractVocabularyFallback(sourceText, studentLevel);\n        }\n    }\n    async extractMainThemes(sourceText, studentLevel) {\n        const prompt = `Identify 3-5 main themes or topics in this text for ${studentLevel} level students. Return only the themes, one per line:\r\n\r\n${sourceText.substring(0, 400)}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const themes = response.split(\"\\n\").map((line)=>line.trim().toLowerCase()).filter((theme)=>theme.length > 3 && theme.length < 50).slice(0, 5);\n            return themes.length >= 2 ? themes : this.extractThemesFallback(sourceText);\n        } catch (error) {\n            console.log(\" AI theme extraction failed, using fallback\");\n            return this.extractThemesFallback(sourceText);\n        }\n    }\n    async createContentSummary(sourceText, studentLevel) {\n        const prompt = `Summarize this text in 2-3 sentences for ${studentLevel} level students:\r\n\r\n${sourceText.substring(0, 600)}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            return response.trim().substring(0, 300);\n        } catch (error) {\n            console.log(\" AI summary failed, using truncation\");\n            return sourceText.substring(0, 200) + \"...\";\n        }\n    }\n    // Section generation methods using shared context\n    /**\r\n   * Build level-specific warm-up prompt with content assumption detection\r\n   */ buildWarmupPrompt(context) {\n        const mainTheme = context.mainThemes[0] || \"this topic\";\n        // CEFR-specific instructions\n        const levelInstructions = {\n            \"A1\": \"Use very simple present tense questions with basic vocabulary. Questions should be about personal experiences and familiar situations.\",\n            \"A2\": \"Use simple questions with present and past tenses. Focus on personal experiences and everyday situations.\",\n            \"B1\": \"Use varied question structures with different tenses. Include questions about opinions and experiences.\",\n            \"B2\": \"Use complex question structures. Include hypothetical and analytical questions about experiences.\",\n            \"C1\": \"Use sophisticated question structures. Include abstract and evaluative questions that encourage critical thinking.\"\n        };\n        const levelInstruction = levelInstructions[context.difficultyLevel];\n        // Build prompt that explicitly avoids content assumptions\n        const prompt = `Create 3 warm-up questions for ${context.difficultyLevel} level students about the general topic of \"${mainTheme}\".\r\n\r\nCRITICAL REQUIREMENTS:\r\n1. DO NOT reference specific events, people, names, dates, or outcomes from any text\r\n2. DO NOT assume students have read or know anything about specific content\r\n3. FOCUS on students' personal experiences, opinions, and general knowledge\r\n4. Questions should activate prior knowledge about the TOPIC, not test knowledge of specific content\r\n5. Questions should build interest and mental focus for learning about this topic\r\n6. ${levelInstruction}\r\n\r\nEXAMPLES OF GOOD QUESTIONS (activate prior knowledge without content assumptions):\r\n- \"Have you ever experienced [general situation related to topic]?\"\r\n- \"What do you think about [general concept related to topic]?\"\r\n- \"In your opinion, why is [general aspect of topic] important?\"\r\n\r\nEXAMPLES OF BAD QUESTIONS (assume content knowledge):\r\n- \"What happened when [specific person] did [specific event]?\"\r\n- \"Why did [specific outcome] occur in the story?\"\r\n- \"What do you remember about [specific detail]?\"\r\n\r\nReturn ONLY 3 questions, one per line, with no numbering or extra text:`;\n        return prompt;\n    }\n    /**\r\n   * Validate warm-up questions using the comprehensive WarmupValidator\r\n   */ validateWarmupQuestions(questions, context) {\n        // Use the comprehensive validator\n        const validationResult = this.warmupValidator.validate(questions, context.difficultyLevel, {\n            mainThemes: context.mainThemes\n        });\n        // Convert validation issues to simple string array for backward compatibility\n        const issues = [\n            ...validationResult.issues.map((issue)=>issue.questionIndex !== undefined ? `${issue.message} (Question ${issue.questionIndex + 1})` : issue.message),\n            ...validationResult.warnings.map((warning)=>warning.questionIndex !== undefined ? `Warning: ${warning.message} (Question ${warning.questionIndex + 1})` : `Warning: ${warning.message}`)\n        ];\n        console.log(` Warmup validation score: ${validationResult.score}/100`);\n        return {\n            isValid: validationResult.isValid,\n            issues\n        };\n    }\n    async generateWarmupWithContext(context, _previousSections) {\n        const maxAttempts = 2;\n        let attempt = 0;\n        const sectionStartTime = Date.now();\n        // Report progress at start of warmup generation\n        safeProgressCallback(this.progressCallback, {\n            step: \"Generating warmup questions\",\n            progress: this.calculateProgress(this.completedSections, \"warmup\", context.lessonType, this.phaseWeights),\n            phase: \"warmup\",\n            section: \"warmup\"\n        });\n        while(attempt < maxAttempts){\n            attempt++;\n            console.log(` Generating warm-up questions (attempt ${attempt}/${maxAttempts})`);\n            try {\n                // Build enhanced prompt\n                const prompt = this.buildWarmupPrompt(context);\n                // Generate questions\n                const response = await this.getGoogleAI().prompt(prompt);\n                const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.length > 0).map((line)=>{\n                    // Remove numbering if present\n                    return line.replace(/^\\d+[\\.)]\\s*/, \"\").trim();\n                }).filter((line)=>line.endsWith(\"?\") && line.length > 10).slice(0, 3);\n                if (questions.length < 3) {\n                    console.log(` Only ${questions.length} questions generated, need 3`);\n                    if (attempt < maxAttempts) continue;\n                    throw new Error(\"Insufficient questions generated after retries\");\n                }\n                // Validate questions\n                const validation = this.validateWarmupQuestions(questions, context);\n                if (!validation.isValid) {\n                    console.log(` Validation failed:`, validation.issues);\n                    if (attempt < maxAttempts) {\n                        console.log(` Retrying with adjusted prompt...`);\n                        continue;\n                    }\n                    console.log(` Using questions despite validation issues (max attempts reached)`);\n                } else {\n                    console.log(` Warm-up questions validated successfully`);\n                }\n                // Track quality metrics\n                const generationTime = Date.now() - sectionStartTime;\n                _quality_metrics__WEBPACK_IMPORTED_MODULE_3__.qualityMetricsTracker.recordSection(\"warmup\", validation.isValid ? 100 : 70, attempt, generationTime, validation.issues.length, 0);\n                const instruction = \"Have the following conversations or discussions with your tutor before reading the text:\";\n                return [\n                    instruction,\n                    ...questions\n                ];\n            } catch (error) {\n                console.error(` Attempt ${attempt} failed:`, error);\n                if (attempt >= maxAttempts) {\n                    // Track failed generation\n                    _quality_metrics__WEBPACK_IMPORTED_MODULE_3__.qualityMetricsTracker.recordSection(\"warmup\", 0, attempt, Date.now() - sectionStartTime, 1, 0);\n                    throw new Error(\"Failed to generate warmup questions: \" + error.message);\n                }\n            }\n        }\n        throw new Error(\"Failed to generate warmup questions after all attempts\");\n    }\n    /**\r\n   * Get the number of example sentences required for each CEFR level\r\n   */ getExampleCountForLevel(level) {\n        const exampleCounts = {\n            \"A1\": 5,\n            \"A2\": 5,\n            \"B1\": 4,\n            \"B2\": 3,\n            \"C1\": 2\n        };\n        return exampleCounts[level];\n    }\n    /**\r\n   * Build level-specific vocabulary example prompt with contextual relevance\r\n   * OPTIMIZED: Reduced token count by 60% while maintaining quality\r\n   */ buildVocabularyExamplePrompt(word, context, exampleCount) {\n        // Concise CEFR complexity guidelines\n        const levelGuidelines = {\n            \"A1\": \"5-8 words, present tense, basic vocabulary\",\n            \"A2\": \"8-12 words, simple past/future, common words\",\n            \"B1\": \"10-15 words, varied tenses, compound sentences\",\n            \"B2\": \"12-18 words, complex structures, relative clauses\",\n            \"C1\": \"15-20 words, sophisticated grammar, nuanced expressions\"\n        };\n        const themes = context.mainThemes.slice(0, 2).join(\", \");\n        const contextSnippet = context.contentSummary.substring(0, 150);\n        const prompt = `Create ${exampleCount} sentences using \"${word}\" for ${context.difficultyLevel} level.\r\n\r\nContext: ${contextSnippet}\r\nTopic: ${themes}\r\n\r\nRequirements:\r\n- Relate to the topic (${themes})\r\n- Match ${context.difficultyLevel} level: ${levelGuidelines[context.difficultyLevel]}\r\n- Show different uses of \"${word}\"\r\n- Use context-specific terms\r\n\r\nReturn ${exampleCount} sentences, one per line, no numbering:`;\n        return prompt;\n    }\n    /**\r\n   * Validate vocabulary examples for quality and relevance\r\n   */ validateVocabularyExamples(word, examples, context, expectedCount) {\n        const issues = [];\n        const warnings = [];\n        // Check example count\n        if (examples.length < expectedCount) {\n            issues.push(`Insufficient examples: expected ${expectedCount}, got ${examples.length}`);\n        }\n        // Track contextual relevance across all examples\n        let contextuallyRelevantCount = 0;\n        // Check each example for quality\n        for(let i = 0; i < examples.length; i++){\n            const example = examples[i];\n            const exampleLower = example.toLowerCase();\n            // Check if word is actually used in the example\n            const wordLower = word.toLowerCase();\n            if (!exampleLower.includes(wordLower)) {\n                issues.push(`Example ${i + 1} does not contain the word \"${word}\"`);\n            }\n            // Check minimum and maximum length based on CEFR level\n            const lengthRanges = {\n                \"A1\": {\n                    min: 5,\n                    max: 10\n                },\n                \"A2\": {\n                    min: 8,\n                    max: 15\n                },\n                \"B1\": {\n                    min: 10,\n                    max: 18\n                },\n                \"B2\": {\n                    min: 12,\n                    max: 22\n                },\n                \"C1\": {\n                    min: 15,\n                    max: 25\n                }\n            };\n            const range = lengthRanges[context.difficultyLevel];\n            const wordCount = example.split(/\\s+/).length;\n            if (wordCount < range.min) {\n                issues.push(`Example ${i + 1} too short: ${wordCount} words (minimum ${range.min} for ${context.difficultyLevel})`);\n            } else if (wordCount > range.max) {\n                warnings.push(`Example ${i + 1} may be too long: ${wordCount} words (recommended max ${range.max} for ${context.difficultyLevel})`);\n            }\n            // Check for proper sentence structure (starts with capital, ends with punctuation)\n            if (!/^[A-Z]/.test(example)) {\n                issues.push(`Example ${i + 1} should start with a capital letter`);\n            }\n            if (!/[.!?]$/.test(example)) {\n                issues.push(`Example ${i + 1} should end with punctuation`);\n            }\n            // Enhanced contextual relevance check\n            let relevanceScore = 0;\n            // Check for theme keywords (weighted heavily)\n            // Split themes into individual words and check for any significant word matches\n            const hasThemeKeyword = context.mainThemes.some((theme)=>{\n                const themeWords = theme.toLowerCase().split(/\\s+/);\n                return themeWords.some((themeWord)=>themeWord.length > 3 && ![\n                        \"the\",\n                        \"and\",\n                        \"for\",\n                        \"with\",\n                        \"from\",\n                        \"about\"\n                    ].includes(themeWord) && exampleLower.includes(themeWord));\n            });\n            if (hasThemeKeyword) relevanceScore += 2;\n            // Check for related vocabulary (moderate weight)\n            const hasRelatedVocab = context.keyVocabulary.some((vocab)=>vocab !== wordLower && vocab.length > 3 && exampleLower.includes(vocab));\n            if (hasRelatedVocab) relevanceScore += 1;\n            // Check for content summary keywords (light weight)\n            const summaryWords = context.contentSummary.toLowerCase().split(/\\s+/).filter((w)=>w.length > 4 && ![\n                    \"about\",\n                    \"their\",\n                    \"which\",\n                    \"these\",\n                    \"those\",\n                    \"there\",\n                    \"where\"\n                ].includes(w));\n            const hasSummaryKeyword = summaryWords.some((summaryWord)=>exampleLower.includes(summaryWord));\n            if (hasSummaryKeyword) relevanceScore += 1;\n            // Track contextually relevant examples\n            if (relevanceScore > 0) {\n                contextuallyRelevantCount++;\n            } else if (context.mainThemes.length > 0) {\n                warnings.push(`Example ${i + 1} may lack contextual relevance to topic (${context.mainThemes.join(\", \")})`);\n            }\n            // Check for generic/overly simple examples at higher levels\n            if ([\n                \"B2\",\n                \"C1\"\n            ].includes(context.difficultyLevel)) {\n                const genericPatterns = [\n                    /^(I|You|We|They|He|She)\\s+(am|is|are|was|were|have|has|had)\\s+/i,\n                    /\\b(very|really|so|quite)\\s+\\w+\\b/i\n                ];\n                const isGeneric = genericPatterns.some((pattern)=>pattern.test(example));\n                if (isGeneric && relevanceScore === 0) {\n                    warnings.push(`Example ${i + 1} may be too generic for ${context.difficultyLevel} level`);\n                }\n            }\n        }\n        // Check overall contextual relevance\n        const relevanceThreshold = Math.ceil(examples.length * 0.6) // At least 60% should be contextually relevant\n        ;\n        if (contextuallyRelevantCount < relevanceThreshold && context.mainThemes.length > 0) {\n            issues.push(`Only ${contextuallyRelevantCount}/${examples.length} examples are contextually relevant (need at least ${relevanceThreshold})`);\n        }\n        // Check for diversity in examples (avoid repetitive sentence structures)\n        const sentenceStarts = examples.map((ex)=>ex.split(/\\s+/).slice(0, 2).join(\" \").toLowerCase());\n        const uniqueStarts = new Set(sentenceStarts);\n        if (uniqueStarts.size < examples.length * 0.7) {\n            warnings.push(`Examples may lack structural diversity (${uniqueStarts.size} unique starts out of ${examples.length} examples)`);\n        }\n        // Log warnings for visibility but don't fail validation\n        if (warnings.length > 0) {\n            console.log(` Vocabulary validation warnings for \"${word}\":`, warnings);\n        }\n        return {\n            isValid: issues.length === 0,\n            issues\n        };\n    }\n    async generateVocabularyWithContext(context, _previousSections) {\n        const vocabulary = [];\n        const exampleCount = this.getExampleCountForLevel(context.difficultyLevel);\n        const maxAttempts = 2;\n        // Report progress at start of vocabulary generation\n        safeProgressCallback(this.progressCallback, {\n            step: \"Generating vocabulary items\",\n            progress: this.calculateProgress(this.completedSections, \"vocabulary\", context.lessonType, this.phaseWeights),\n            phase: \"vocabulary\",\n            section: \"vocabulary\"\n        });\n        console.log(` Generating vocabulary with ${exampleCount} examples per word for ${context.difficultyLevel} level`);\n        for (const word of context.keyVocabulary.slice(0, 8)){\n            let attempt = 0;\n            let examples = [];\n            let validationPassed = false;\n            while(attempt < maxAttempts && !validationPassed){\n                attempt++;\n                try {\n                    // Generate definition\n                    const definitionPrompt = `Define \"${word}\" simply for ${context.difficultyLevel} level. Context: ${context.contentSummary.substring(0, 100)}. Give only the definition:`;\n                    const meaning = await this.getGoogleAI().prompt(definitionPrompt);\n                    // Generate contextually relevant examples with enhanced prompt\n                    const examplesPrompt = this.buildVocabularyExamplePrompt(word, context, exampleCount);\n                    let examplesResponse;\n                    try {\n                        examplesResponse = await this.getGoogleAI().prompt(examplesPrompt);\n                    } catch (promptError) {\n                        // Handle MAX_TOKENS error gracefully - accept partial response\n                        if (promptError.code === \"MAX_TOKENS\" && promptError.message) {\n                            console.log(` MAX_TOKENS hit for \"${word}\", using partial response`);\n                            examplesResponse = promptError.message;\n                        } else {\n                            throw promptError;\n                        }\n                    }\n                    examples = examplesResponse.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.length > 0).map((line)=>{\n                        // Remove numbering if present\n                        return line.replace(/^\\d+[\\.)]\\s*/, \"\").trim();\n                    }).filter((line)=>line.length > 10).slice(0, exampleCount);\n                    // If we got at least 2 examples, consider it acceptable\n                    if (examples.length >= Math.min(2, exampleCount)) {\n                        console.log(` Generated ${examples.length} examples for \"${word}\" (target: ${exampleCount})`);\n                        vocabulary.push({\n                            word: this.capitalizeWord(word),\n                            meaning: meaning.trim().substring(0, 150),\n                            examples: examples\n                        });\n                        break; // Success, move to next word\n                    }\n                    // Validate examples only if we have enough\n                    const validation = this.validateVocabularyExamples(word, examples, context, exampleCount);\n                    if (!validation.isValid) {\n                        console.log(` Validation failed for \"${word}\" (attempt ${attempt}/${maxAttempts}):`, validation.issues);\n                        if (attempt < maxAttempts) {\n                            console.log(` Retrying with adjusted prompt...`);\n                            continue;\n                        } else {\n                            console.log(` Using examples despite validation issues (max attempts reached)`);\n                        }\n                    } else {\n                        console.log(` Examples validated successfully for \"${word}\"`);\n                        validationPassed = true;\n                    }\n                    vocabulary.push({\n                        word: this.capitalizeWord(word),\n                        meaning: meaning.trim().substring(0, 150),\n                        examples: examples\n                    });\n                    break; // Success, move to next word\n                } catch (error) {\n                    console.log(` Attempt ${attempt} failed for \"${word}\":`, error);\n                    if (attempt >= maxAttempts) {\n                        console.log(` Failed to generate vocabulary for ${word} after ${maxAttempts} attempts`);\n                        break;\n                    }\n                }\n            }\n        }\n        const instruction = {\n            word: \"INSTRUCTION\",\n            meaning: \"Study the following words with your tutor before reading the text:\",\n            examples: []\n        };\n        return [\n            instruction,\n            ...vocabulary\n        ];\n    }\n    async generateReadingWithContext(context, _previousSections) {\n        // Report progress at start of reading generation\n        safeProgressCallback(this.progressCallback, {\n            step: \"Generating reading passage\",\n            progress: this.calculateProgress(this.completedSections, \"reading\", context.lessonType, this.phaseWeights),\n            phase: \"reading\",\n            section: \"reading\"\n        });\n        // Use vocabulary from previous sections if available\n        const vocabularySection = _previousSections.find((s)=>s.sectionName === \"vocabulary\");\n        const vocabularyWords = vocabularySection ? vocabularySection.content.filter((item)=>item.word !== \"INSTRUCTION\").map((item)=>item.word).slice(0, 5) : context.keyVocabulary.slice(0, 5);\n        const prompt = `Rewrite this text for ${context.difficultyLevel} level students. \r\nUse these vocabulary words: ${vocabularyWords.join(\", \")}\r\nKeep it 200-400 words:\r\n\r\n${context.sourceText}`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const instruction = \"Read the following text carefully. Your tutor will help you with any difficult words or concepts:\";\n            return `${instruction}\\n\\n${response.trim()}`;\n        } catch (error) {\n            throw new Error(\"Failed to generate reading passage: \" + error.message);\n        }\n    }\n    async generateComprehensionWithContext(context, _previousSections) {\n        // Report progress at start of comprehension generation\n        safeProgressCallback(this.progressCallback, {\n            step: \"Generating comprehension questions\",\n            progress: this.calculateProgress(this.completedSections, \"comprehension\", context.lessonType, this.phaseWeights),\n            phase: \"comprehension\",\n            section: \"comprehension\"\n        });\n        const prompt = `Create 5 ${context.difficultyLevel} comprehension questions about this content:\r\n${context.contentSummary}\r\nReturn only questions, one per line:`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.endsWith(\"?\") && line.length > 10).slice(0, 5);\n            // PRAGMATIC: Accept 3+ questions instead of requiring exactly 5\n            // Better to have a lesson with 3 questions than no lesson at all\n            if (questions.length < 3) {\n                console.warn(` Only generated ${questions.length} comprehension questions, need at least 3`);\n                throw new Error(\"Insufficient comprehension questions generated\");\n            }\n            if (questions.length < 5) {\n                console.warn(` Generated ${questions.length} comprehension questions (target was 5, but acceptable)`);\n            }\n            const instruction = \"After reading the text, answer these comprehension questions:\";\n            return [\n                instruction,\n                ...questions\n            ];\n        } catch (error) {\n            throw new Error(\"Failed to generate comprehension questions: \" + error.message);\n        }\n    }\n    /**\r\n   * Build level-specific discussion question prompt with appropriate complexity\r\n   */ buildDiscussionPrompt(context) {\n        const themes = context.mainThemes.slice(0, 2).join(\" and \");\n        // CEFR-specific question type instructions with detailed guidance\n        const levelInstructions = {\n            \"A1\": {\n                description: \"Simple question structures with basic vocabulary focusing on familiar topics and personal experiences\",\n                questionTypes: [\n                    'Yes/No questions: \"Do you like...?\", \"Have you ever...?\", \"Can you...?\"',\n                    'Simple Wh- questions: \"What is your favorite...?\", \"Where do you...?\", \"When do you...?\"',\n                    'Personal preference questions: \"Which do you prefer...?\", \"What do you enjoy...?\"'\n                ],\n                structures: [\n                    \"Use present simple and simple past tenses only\",\n                    \"Keep questions short (4-10 words)\",\n                    \"Use common, everyday vocabulary\",\n                    \"Focus on concrete, tangible topics\"\n                ],\n                responseExpectation: \"Students should be able to answer with 1-3 simple sentences using basic vocabulary\"\n            },\n            \"A2\": {\n                description: \"Simple questions with multiple tenses focusing on personal experiences and everyday situations\",\n                questionTypes: [\n                    'Opinion questions: \"What do you think about...?\", \"Do you agree that...?\"',\n                    'Experience questions: \"Can you describe...?\", \"What happened when...?\"',\n                    'Simple hypotheticals: \"What would you do if...?\", \"Where would you go...?\"'\n                ],\n                structures: [\n                    \"Use present, past, and future tenses\",\n                    \"Include simple conditionals (first conditional)\",\n                    \"Keep questions moderate length (5-12 words)\",\n                    \"Use familiar vocabulary with some new words\"\n                ],\n                responseExpectation: \"Students should be able to answer with 3-5 sentences, expressing simple opinions and describing experiences\"\n            },\n            \"B1\": {\n                description: \"Varied question structures including opinion questions and comparisons\",\n                questionTypes: [\n                    'Opinion and justification: \"Why do you think...?\", \"Do you believe that...? Why?\"',\n                    'Comparison questions: \"How does X compare to Y?\", \"What are the differences between...?\"',\n                    'Advantage/disadvantage questions: \"What are the advantages of...?\", \"What are the pros and cons of...?\"'\n                ],\n                structures: [\n                    \"Use varied tenses including present perfect\",\n                    \"Include first and second conditionals\",\n                    \"Use moderate complexity (6-15 words)\",\n                    \"Incorporate topic-specific vocabulary\"\n                ],\n                responseExpectation: \"Students should provide 5-8 sentences with explanations, examples, and personal opinions\"\n            },\n            \"B2\": {\n                description: \"Complex question structures requiring analytical thinking and justification\",\n                questionTypes: [\n                    'Analytical questions: \"To what extent do you agree that...?\", \"What might be the consequences of...?\"',\n                    'Evaluation questions: \"How would you evaluate...?\", \"What are the implications of...?\"',\n                    'Hypothetical scenarios: \"How would the situation change if...?\", \"What might happen if...?\"'\n                ],\n                structures: [\n                    \"Use complex tenses including conditionals (types 1-3)\",\n                    \"Include passive voice and modal verbs\",\n                    \"Use sophisticated vocabulary and expressions\",\n                    \"Questions should be 8-18 words\"\n                ],\n                responseExpectation: \"Students should provide detailed responses (8-12 sentences) with analysis, examples, and counterarguments\"\n            },\n            \"C1\": {\n                description: \"Sophisticated question structures requiring evaluative and critical thinking\",\n                questionTypes: [\n                    'Evaluative questions: \"What are the broader implications of...?\", \"How might one assess...?\"',\n                    'Critical analysis: \"In what ways could this be interpreted...?\", \"To what degree does...?\"',\n                    'Abstract reasoning: \"How might one reconcile...?\", \"What underlying assumptions...?\"'\n                ],\n                structures: [\n                    \"Use advanced grammatical structures and nuanced expressions\",\n                    \"Include abstract concepts and theoretical frameworks\",\n                    \"Use sophisticated vocabulary and idiomatic expressions\",\n                    \"Questions should be 10-20 words with complex syntax\"\n                ],\n                responseExpectation: \"Students should provide comprehensive responses (12+ sentences) with critical analysis, multiple perspectives, and sophisticated argumentation\"\n            }\n        };\n        const levelConfig = levelInstructions[context.difficultyLevel];\n        const prompt = `Create exactly 5 discussion questions for ${context.difficultyLevel} level students about ${themes}.\r\n\r\nSOURCE CONTEXT: ${context.contentSummary}\r\nRELATED VOCABULARY: ${context.keyVocabulary.slice(0, 5).join(\", \")}\r\n\r\nLEVEL-SPECIFIC REQUIREMENTS FOR ${context.difficultyLevel}:\r\n${levelConfig.description}\r\n\r\nQUESTION TYPES TO USE:\r\n${levelConfig.questionTypes.map((type, i)=>`${i + 1}. ${type}`).join(\"\\n\")}\r\n\r\nSTRUCTURAL GUIDELINES:\r\n${levelConfig.structures.map((struct, i)=>`- ${struct}`).join(\"\\n\")}\r\n\r\nRESPONSE EXPECTATION:\r\n${levelConfig.responseExpectation}\r\n\r\nCRITICAL REQUIREMENTS:\r\n1. Generate EXACTLY 5 questions - no more, no less\r\n2. Questions MUST relate directly to the source material themes: ${themes}\r\n3. Use vocabulary from the source context when appropriate: ${context.keyVocabulary.slice(0, 5).join(\", \")}\r\n4. Each question should explore a DIFFERENT aspect of the topic\r\n5. Questions should encourage EXTENDED responses appropriate to ${context.difficultyLevel} level\r\n6. Vary question types across the 5 questions (don't repeat the same structure)\r\n7. Questions should progress in complexity within the ${context.difficultyLevel} level range\r\n\r\nQUESTION PROGRESSION STRATEGY:\r\n- Question 1: Personal connection or basic understanding (easiest within level)\r\n- Question 2: Specific aspect from source material\r\n- Question 3: Comparison, contrast, or different perspective\r\n- Question 4: Application or implication of concepts\r\n- Question 5: Evaluation or broader significance (most challenging within level)\r\n\r\nEXAMPLES OF GOOD ${context.difficultyLevel} QUESTIONS:\r\n${this.getDiscussionExamples(context.difficultyLevel, themes)}\r\n\r\nReturn ONLY 5 questions, one per line, with no numbering, bullets, or extra text:`;\n        return prompt;\n    }\n    /**\r\n   * Get example questions for each CEFR level to guide AI generation\r\n   */ getDiscussionExamples(level, themes) {\n        const examples = {\n            \"A1\": [\n                `\"Do you like ${themes}?\"`,\n                `\"What is your favorite thing about ${themes}?\"`,\n                `\"Have you ever tried ${themes}?\"`\n            ],\n            \"A2\": [\n                `\"What do you think about ${themes}?\"`,\n                `\"Can you describe your experience with ${themes}?\"`,\n                `\"What would you do if you could learn more about ${themes}?\"`\n            ],\n            \"B1\": [\n                `\"Why do you think ${themes} is important?\"`,\n                `\"How does ${themes} compare to similar topics?\"`,\n                `\"What are the advantages and disadvantages of ${themes}?\"`\n            ],\n            \"B2\": [\n                `\"To what extent do you agree that ${themes} has changed society?\"`,\n                `\"What might be the long-term consequences of ${themes}?\"`,\n                `\"How would you evaluate the impact of ${themes}?\"`\n            ],\n            \"C1\": [\n                `\"What are the broader implications of ${themes} for modern society?\"`,\n                `\"In what ways could different perspectives on ${themes} be reconciled?\"`,\n                `\"How might one critically assess the underlying assumptions about ${themes}?\"`\n            ]\n        };\n        return examples[level].join(\"\\n\");\n    }\n    /**\r\n   * Validate discussion questions for count and complexity\r\n   */ validateDiscussionQuestions(questions, context) {\n        const issues = [];\n        const warnings = [];\n        // Check exact count (requirement 4.1)\n        if (questions.length !== 5) {\n            issues.push(`Incorrect question count: expected exactly 5, got ${questions.length}`);\n        }\n        // Check each question for quality\n        for(let i = 0; i < questions.length; i++){\n            const question = questions[i];\n            const questionLower = question.toLowerCase();\n            // Check that it's actually a question\n            if (!question.endsWith(\"?\")) {\n                issues.push(`Question ${i + 1} does not end with a question mark`);\n            }\n            // Check minimum length\n            if (question.length < 15) {\n                issues.push(`Question ${i + 1} is too short (${question.length} characters)`);\n            }\n            // Check that it starts with a capital letter\n            if (!/^[A-Z]/.test(question)) {\n                issues.push(`Question ${i + 1} should start with a capital letter`);\n            }\n            // Check for appropriate question words/structures based on CEFR level\n            const questionWords = [\n                \"what\",\n                \"why\",\n                \"how\",\n                \"when\",\n                \"where\",\n                \"who\",\n                \"which\",\n                \"do\",\n                \"does\",\n                \"did\",\n                \"can\",\n                \"could\",\n                \"would\",\n                \"should\",\n                \"have\",\n                \"has\",\n                \"is\",\n                \"are\",\n                \"was\",\n                \"were\",\n                \"to\"\n            ];\n            const startsWithQuestionWord = questionWords.some((word)=>questionLower.startsWith(word + \" \") || questionLower.startsWith(word + \"'\"));\n            if (!startsWithQuestionWord) {\n                warnings.push(`Question ${i + 1} may not have a proper question structure`);\n            }\n            // Check complexity appropriateness for level (requirements 4.2, 4.3, 4.4)\n            const complexityCheck = this.checkQuestionComplexity(question, context.difficultyLevel);\n            if (!complexityCheck.isAppropriate) {\n                warnings.push(`Question ${i + 1}: ${complexityCheck.warning}`);\n            }\n            // Check if question encourages extended responses (requirement 4.6)\n            const extendedResponseCheck = this.checkExtendedResponsePotential(question, context.difficultyLevel);\n            if (!extendedResponseCheck.encouragesExtended) {\n                warnings.push(`Question ${i + 1}: ${extendedResponseCheck.warning}`);\n            }\n        }\n        // Check for diversity in question types\n        const questionStarts = questions.map((q)=>q.split(/\\s+/).slice(0, 2).join(\" \").toLowerCase());\n        const uniqueStarts = new Set(questionStarts);\n        if (uniqueStarts.size < 3) {\n            warnings.push(`Questions lack diversity (only ${uniqueStarts.size} unique question types)`);\n        }\n        // Check for source material relevance (requirement 4.5)\n        const hasRelevance = this.checkDiscussionRelevance(questions, context);\n        if (!hasRelevance) {\n            warnings.push(\"Questions may not sufficiently relate to the source material\");\n        }\n        // Log warnings for visibility\n        if (warnings.length > 0) {\n            console.log(` Discussion validation warnings:`, warnings);\n        }\n        return {\n            isValid: issues.length === 0,\n            issues\n        };\n    }\n    /**\r\n   * Check if question encourages extended responses appropriate to level (requirement 4.6)\r\n   */ checkExtendedResponsePotential(question, level) {\n        const questionLower = question.toLowerCase();\n        // Yes/No questions generally don't encourage extended responses\n        // However, they can be acceptable at A1/A2 if they're open to elaboration\n        const isYesNoQuestion = /^(do|does|did|can|could|would|should|have|has|had|is|are|was|were)\\s+/i.test(question);\n        if (isYesNoQuestion) {\n            // At higher levels, yes/no questions are problematic\n            if ([\n                \"B2\",\n                \"C1\"\n            ].includes(level)) {\n                return {\n                    encouragesExtended: false,\n                    warning: `Yes/No question structure may not encourage extended responses at ${level} level`\n                };\n            }\n            // At B1, warn but don't fail\n            if (level === \"B1\") {\n                return {\n                    encouragesExtended: true,\n                    warning: `Yes/No question - ensure it encourages elaboration beyond yes/no`\n                };\n            }\n        // At A1/A2, yes/no questions are acceptable\n        }\n        // Check for open-ended question words that encourage extended responses\n        const openEndedStarters = {\n            \"A1\": [\n                \"what\",\n                \"where\",\n                \"when\",\n                \"who\"\n            ],\n            \"A2\": [\n                \"what\",\n                \"where\",\n                \"when\",\n                \"who\",\n                \"why\",\n                \"how\"\n            ],\n            \"B1\": [\n                \"why\",\n                \"how\",\n                \"what do you think\",\n                \"what are\"\n            ],\n            \"B2\": [\n                \"why\",\n                \"how\",\n                \"to what extent\",\n                \"what might\",\n                \"how would\",\n                \"what are the\"\n            ],\n            \"C1\": [\n                \"why\",\n                \"how\",\n                \"to what extent\",\n                \"in what ways\",\n                \"what are the implications\",\n                \"how might one\"\n            ]\n        };\n        const expectedStarters = openEndedStarters[level];\n        const hasOpenEndedStarter = expectedStarters.some((starter)=>questionLower.startsWith(starter));\n        // For higher levels, check for analytical/evaluative language\n        if ([\n            \"B2\",\n            \"C1\"\n        ].includes(level)) {\n            const analyticalWords = [\n                \"why\",\n                \"how\",\n                \"extent\",\n                \"implications\",\n                \"consequences\",\n                \"evaluate\",\n                \"analyze\",\n                \"compare\",\n                \"contrast\",\n                \"assess\",\n                \"consider\",\n                \"might\",\n                \"could\",\n                \"would\",\n                \"perspectives\",\n                \"interpret\",\n                \"reconcile\"\n            ];\n            const hasAnalyticalLanguage = analyticalWords.some((word)=>questionLower.includes(word));\n            if (!hasAnalyticalLanguage && !hasOpenEndedStarter) {\n                return {\n                    encouragesExtended: false,\n                    warning: `Question lacks analytical language expected at ${level} level to encourage extended responses`\n                };\n            }\n        }\n        // For B1, check for opinion/comparison language\n        if (level === \"B1\") {\n            const opinionWords = [\n                \"think\",\n                \"believe\",\n                \"opinion\",\n                \"compare\",\n                \"prefer\",\n                \"advantages\",\n                \"disadvantages\",\n                \"why\",\n                \"how\"\n            ];\n            const hasOpinionLanguage = opinionWords.some((word)=>questionLower.includes(word));\n            if (!hasOpinionLanguage && !hasOpenEndedStarter) {\n                return {\n                    encouragesExtended: true,\n                    warning: `Question could benefit from opinion/comparison language to encourage extended responses at B1 level`\n                };\n            }\n        }\n        return {\n            encouragesExtended: true\n        };\n    }\n    /**\r\n   * Check if question complexity matches CEFR level\r\n   */ checkQuestionComplexity(question, level) {\n        const questionLower = question.toLowerCase();\n        const wordCount = question.split(/\\s+/).length;\n        // Define complexity indicators for each level\n        const complexityIndicators = {\n            \"A1\": {\n                minWords: 4,\n                maxWords: 12,\n                expectedPatterns: [\n                    \"do you\",\n                    \"what is\",\n                    \"can you\",\n                    \"have you\"\n                ],\n                avoidPatterns: [\n                    \"to what extent\",\n                    \"how might\",\n                    \"in what ways\"\n                ]\n            },\n            \"A2\": {\n                minWords: 5,\n                maxWords: 15,\n                expectedPatterns: [\n                    \"what do you think\",\n                    \"can you describe\",\n                    \"what would you\"\n                ],\n                avoidPatterns: [\n                    \"to what extent\",\n                    \"how might one\",\n                    \"what are the implications\"\n                ]\n            },\n            \"B1\": {\n                minWords: 6,\n                maxWords: 18,\n                expectedPatterns: [\n                    \"why do you think\",\n                    \"how does\",\n                    \"what are the\",\n                    \"do you agree\"\n                ],\n                avoidPatterns: [\n                    \"to what extent\",\n                    \"how might one reconcile\"\n                ]\n            },\n            \"B2\": {\n                minWords: 8,\n                maxWords: 22,\n                expectedPatterns: [\n                    \"to what extent\",\n                    \"what might be\",\n                    \"how would you\",\n                    \"what are the consequences\"\n                ],\n                avoidPatterns: []\n            },\n            \"C1\": {\n                minWords: 10,\n                maxWords: 25,\n                expectedPatterns: [\n                    \"what are the implications\",\n                    \"how might one\",\n                    \"in what ways\",\n                    \"to what extent\"\n                ],\n                avoidPatterns: []\n            }\n        };\n        const indicators = complexityIndicators[level];\n        // Check word count\n        if (wordCount < indicators.minWords) {\n            return {\n                isAppropriate: false,\n                warning: `Question may be too simple for ${level} level (${wordCount} words, expected ${indicators.minWords}+)`\n            };\n        }\n        if (wordCount > indicators.maxWords) {\n            return {\n                isAppropriate: true,\n                warning: `Question may be too complex for ${level} level (${wordCount} words, recommended max ${indicators.maxWords})`\n            };\n        }\n        // Check for inappropriate patterns (too complex for level)\n        if (indicators.avoidPatterns.length > 0) {\n            const hasAvoidPattern = indicators.avoidPatterns.some((pattern)=>questionLower.includes(pattern));\n            if (hasAvoidPattern) {\n                return {\n                    isAppropriate: false,\n                    warning: `Question structure may be too advanced for ${level} level`\n                };\n            }\n        }\n        // For lower levels, check if question is too complex\n        if ([\n            \"A1\",\n            \"A2\"\n        ].includes(level)) {\n            const complexPatterns = [\n                \"implications\",\n                \"consequences\",\n                \"reconcile\",\n                \"evaluate\",\n                \"analyze\",\n                \"synthesize\"\n            ];\n            const hasComplexPattern = complexPatterns.some((pattern)=>questionLower.includes(pattern));\n            if (hasComplexPattern) {\n                return {\n                    isAppropriate: false,\n                    warning: `Question vocabulary may be too advanced for ${level} level`\n                };\n            }\n        }\n        return {\n            isAppropriate: true\n        };\n    }\n    /**\r\n   * Check if discussion questions relate to source material\r\n   */ checkDiscussionRelevance(questions, context) {\n        let relevantCount = 0;\n        for (const question of questions){\n            const questionLower = question.toLowerCase();\n            // Check for theme keywords\n            const hasThemeKeyword = context.mainThemes.some((theme)=>{\n                const themeWords = theme.toLowerCase().split(/\\s+/);\n                return themeWords.some((themeWord)=>themeWord.length > 3 && ![\n                        \"the\",\n                        \"and\",\n                        \"for\",\n                        \"with\",\n                        \"from\",\n                        \"about\",\n                        \"that\",\n                        \"this\"\n                    ].includes(themeWord) && questionLower.includes(themeWord));\n            });\n            // Check for vocabulary keywords\n            const hasVocabKeyword = context.keyVocabulary.some((vocab)=>vocab.length > 3 && questionLower.includes(vocab));\n            // Check for summary keywords\n            const summaryWords = context.contentSummary.toLowerCase().split(/\\s+/).filter((w)=>w.length > 4 && ![\n                    \"about\",\n                    \"their\",\n                    \"which\",\n                    \"these\",\n                    \"those\",\n                    \"there\",\n                    \"where\",\n                    \"would\",\n                    \"could\",\n                    \"should\"\n                ].includes(w));\n            const hasSummaryKeyword = summaryWords.some((summaryWord)=>questionLower.includes(summaryWord));\n            if (hasThemeKeyword || hasVocabKeyword || hasSummaryKeyword) {\n                relevantCount++;\n            }\n        }\n        // At least 60% of questions should be contextually relevant\n        return relevantCount >= Math.ceil(questions.length * 0.6);\n    }\n    async generateDiscussionWithContext(context, _previousSections) {\n        const maxAttempts = 2;\n        let attempt = 0;\n        const sectionStartTime = Date.now();\n        // Report progress at start of discussion generation\n        safeProgressCallback(this.progressCallback, {\n            step: \"Generating discussion questions\",\n            progress: this.calculateProgress(this.completedSections, \"discussion\", context.lessonType, this.phaseWeights),\n            phase: \"discussion\",\n            section: \"discussion\"\n        });\n        while(attempt < maxAttempts){\n            attempt++;\n            console.log(` Generating discussion questions (attempt ${attempt}/${maxAttempts})`);\n            try {\n                // Build enhanced prompt\n                const prompt = this.buildDiscussionPrompt(context);\n                // Generate questions\n                const response = await this.getGoogleAI().prompt(prompt);\n                const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.length > 0).map((line)=>{\n                    // Remove numbering if present\n                    return line.replace(/^\\d+[\\.)]\\s*/, \"\").trim();\n                }).filter((line)=>line.endsWith(\"?\") && line.length > 10).slice(0, 5);\n                // Validate questions using new validator\n                const validation = _section_validators__WEBPACK_IMPORTED_MODULE_2__.discussionValidator.validate(questions, context.difficultyLevel);\n                if (!validation.isValid) {\n                    console.log(` Validation failed:`, validation.issues);\n                    if (attempt < maxAttempts) {\n                        console.log(` Retrying with adjusted prompt...`);\n                        continue;\n                    }\n                    console.log(` Using questions despite validation issues (max attempts reached)`);\n                } else {\n                    console.log(` Discussion questions validated successfully`);\n                }\n                // Track quality metrics\n                const generationTime = Date.now() - sectionStartTime;\n                _quality_metrics__WEBPACK_IMPORTED_MODULE_3__.qualityMetricsTracker.recordSection(\"discussion\", validation.score, attempt, generationTime, validation.issues.length, validation.warnings.length);\n                const instruction = \"Discuss these questions with your tutor to explore the topic in depth:\";\n                return [\n                    instruction,\n                    ...questions\n                ];\n            } catch (error) {\n                console.error(` Attempt ${attempt} failed:`, error);\n                if (attempt >= maxAttempts) {\n                    // Track failed generation\n                    _quality_metrics__WEBPACK_IMPORTED_MODULE_3__.qualityMetricsTracker.recordSection(\"discussion\", 0, attempt, Date.now() - sectionStartTime, 1, 0);\n                    throw new Error(\"Failed to generate discussion questions: \" + error.message);\n                }\n            }\n        }\n        throw new Error(\"Failed to generate discussion questions after all attempts\");\n    }\n    /**\r\n   * Repair incomplete JSON by closing open structures\r\n   */ repairIncompleteJSON(jsonStr) {\n        let repaired = jsonStr.trim();\n        // Count open and close braces/brackets\n        const openBraces = (repaired.match(/\\{/g) || []).length;\n        const closeBraces = (repaired.match(/\\}/g) || []).length;\n        const openBrackets = (repaired.match(/\\[/g) || []).length;\n        const closeBrackets = (repaired.match(/\\]/g) || []).length;\n        // Close incomplete strings\n        const quoteCount = (repaired.match(/\"/g) || []).length;\n        if (quoteCount % 2 !== 0) {\n            repaired += '\"';\n        }\n        // Close incomplete arrays\n        for(let i = 0; i < openBrackets - closeBrackets; i++){\n            repaired += \"]\";\n        }\n        // Close incomplete objects\n        for(let i = 0; i < openBraces - closeBraces; i++){\n            repaired += \"}\";\n        }\n        console.log(` Repaired JSON: added ${openBraces - closeBraces} braces, ${openBrackets - closeBrackets} brackets`);\n        return repaired;\n    }\n    /**\r\n   * Build comprehensive grammar prompt with form, usage, and practice exercises\r\n   * OPTIMIZED: Reduced token count by 70% and requesting concise output\r\n   */ buildGrammarPrompt(context) {\n        // Concise level-appropriate grammar points\n        const levelPoints = {\n            \"A1\": \"present simple, articles, basic prepositions\",\n            \"A2\": \"past simple, comparatives, modal verbs\",\n            \"B1\": \"present perfect, conditionals, passive voice\",\n            \"B2\": \"relative clauses, advanced conditionals, reported speech\",\n            \"C1\": \"subjunctive, cleft sentences, inversion\"\n        };\n        const prompt = `Identify ONE grammar point from this text for ${context.difficultyLevel} level.\r\n\r\nText: ${context.sourceText.substring(0, 200)}\r\n\r\nSuggested: ${levelPoints[context.difficultyLevel]}\r\n\r\nReturn CONCISE JSON (brief explanations, 3 examples, 3 exercises):\r\n{\r\n  \"grammarPoint\": \"Name\",\r\n  \"explanation\": {\r\n    \"form\": \"How to form (1 sentence)\",\r\n    \"usage\": \"When to use (1 sentence)\",\r\n    \"levelNotes\": \"Level note (1 sentence)\"\r\n  },\r\n  \"examples\": [\"example 1\", \"example 2\", \"example 3\"],\r\n  \"exercises\": [\r\n    {\"prompt\": \"Exercise 1\", \"answer\": \"Answer 1\", \"explanation\": \"Why\"},\r\n    {\"prompt\": \"Exercise 2\", \"answer\": \"Answer 2\", \"explanation\": \"Why\"},\r\n    {\"prompt\": \"Exercise 3\", \"answer\": \"Answer 3\", \"explanation\": \"Why\"}\r\n  ]\r\n}`;\n        return prompt;\n    }\n    /**\r\n   * Validate grammar section for completeness and quality\r\n   */ validateGrammarSection(grammarData, context) {\n        const issues = [];\n        // Check required fields exist\n        if (!grammarData.grammarPoint || typeof grammarData.grammarPoint !== \"string\") {\n            issues.push(\"Missing or invalid grammarPoint\");\n        }\n        if (!grammarData.explanation || typeof grammarData.explanation !== \"object\") {\n            issues.push(\"Missing or invalid explanation object\");\n        } else {\n            // Check explanation has both form and usage\n            if (!grammarData.explanation.form || grammarData.explanation.form.length < 20) {\n                issues.push(\"Missing or insufficient form explanation (minimum 20 characters)\");\n            }\n            if (!grammarData.explanation.usage || grammarData.explanation.usage.length < 30) {\n                issues.push(\"Missing or insufficient usage explanation (minimum 30 characters)\");\n            }\n        }\n        // Check examples array\n        if (!Array.isArray(grammarData.examples)) {\n            issues.push(\"Examples must be an array\");\n        } else {\n            if (grammarData.examples.length < 3) {\n                issues.push(`Insufficient examples: expected minimum 3, got ${grammarData.examples.length}`);\n            }\n            // Validate each example\n            grammarData.examples.forEach((example, index)=>{\n                if (typeof example !== \"string\") {\n                    issues.push(`Example ${index + 1} must be a string`);\n                } else if (example.length < 10) {\n                    issues.push(`Example ${index + 1} too short (minimum 10 characters)`);\n                } else if (!/^[A-Z]/.test(example)) {\n                    issues.push(`Example ${index + 1} should start with capital letter`);\n                } else if (!/[.!?]$/.test(example)) {\n                    issues.push(`Example ${index + 1} should end with punctuation`);\n                }\n            });\n        }\n        // Check exercises array\n        if (!Array.isArray(grammarData.exercises)) {\n            issues.push(\"Exercises must be an array\");\n        } else {\n            if (grammarData.exercises.length < 3) {\n                issues.push(`Insufficient exercises: expected minimum 3, got ${grammarData.exercises.length}`);\n            }\n            // Validate each exercise\n            grammarData.exercises.forEach((exercise, index)=>{\n                if (typeof exercise !== \"object\") {\n                    issues.push(`Exercise ${index + 1} must be an object`);\n                } else {\n                    if (!exercise.prompt || typeof exercise.prompt !== \"string\" || exercise.prompt.length < 10) {\n                        issues.push(`Exercise ${index + 1} missing or invalid prompt`);\n                    }\n                    if (!exercise.answer || typeof exercise.answer !== \"string\" || exercise.answer.length < 1) {\n                        issues.push(`Exercise ${index + 1} missing or invalid answer`);\n                    }\n                }\n            });\n        }\n        // Check contextual relevance\n        if (grammarData.examples && Array.isArray(grammarData.examples)) {\n            const hasContextualRelevance = grammarData.examples.some((example)=>{\n                const exampleLower = example.toLowerCase();\n                return context.mainThemes.some((theme)=>{\n                    const themeWords = theme.toLowerCase().split(/\\s+/);\n                    return themeWords.some((word)=>word.length > 3 && exampleLower.includes(word));\n                });\n            });\n            if (!hasContextualRelevance && context.mainThemes.length > 0) {\n                issues.push(\"Examples lack contextual relevance to source material\");\n            }\n        }\n        return {\n            isValid: issues.length === 0,\n            issues\n        };\n    }\n    async generateGrammarWithContext(context, _previousSections) {\n        const maxAttempts = 2;\n        let attempt = 0;\n        const sectionStartTime = Date.now();\n        // Report progress at start of grammar generation\n        safeProgressCallback(this.progressCallback, {\n            step: \"Generating grammar section\",\n            progress: this.calculateProgress(this.completedSections, \"grammar\", context.lessonType, this.phaseWeights),\n            phase: \"grammar\",\n            section: \"grammar\"\n        });\n        while(attempt < maxAttempts){\n            attempt++;\n            console.log(` Generating comprehensive grammar section (attempt ${attempt}/${maxAttempts})`);\n            try {\n                // Build enhanced grammar prompt\n                const prompt = this.buildGrammarPrompt(context);\n                // Generate grammar section with increased token limit\n                let response;\n                try {\n                    // Increase maxOutputTokens to 3000 to allow complete JSON response\n                    response = await this.getGoogleAI().prompt(prompt, {\n                        maxTokens: 3000\n                    });\n                } catch (promptError) {\n                    // Handle MAX_TOKENS error - accept partial response if available\n                    if (promptError.code === \"MAX_TOKENS\") {\n                        console.log(` MAX_TOKENS hit in grammar generation`);\n                        // Don't retry - the error means we got no content at all\n                        // If we got partial content, it would have been returned\n                        throw new Error(\"Grammar generation failed: No content returned due to MAX_TOKENS\");\n                    } else {\n                        throw promptError;\n                    }\n                }\n                console.log(` Raw grammar response (${response.length} chars)`);\n                // Parse JSON response with better error handling and repair\n                let grammarData;\n                try {\n                    // Remove markdown code blocks if present\n                    let cleanResponse = response.replace(/```json\\s*/g, \"\").replace(/```\\s*/g, \"\").trim();\n                    // Try to extract JSON from response\n                    const jsonMatch = cleanResponse.match(/\\{[\\s\\S]*\\}/);\n                    if (jsonMatch) {\n                        let jsonStr = jsonMatch[0];\n                        console.log(` Attempting to parse JSON (${jsonStr.length} chars)`);\n                        // Try to repair incomplete JSON\n                        if (!jsonStr.trim().endsWith(\"}\")) {\n                            console.log(` JSON appears incomplete, attempting repair...`);\n                            // Try to close incomplete structures\n                            jsonStr = this.repairIncompleteJSON(jsonStr);\n                        }\n                        try {\n                            grammarData = JSON.parse(jsonStr);\n                            console.log(` JSON parsed successfully`);\n                        } catch (parseErr) {\n                            console.log(` JSON parsing failed after repair attempt`);\n                            if (attempt < maxAttempts) {\n                                console.log(` Retrying with adjusted prompt...`);\n                                continue;\n                            }\n                            throw parseErr;\n                        }\n                    } else {\n                        console.log(` No JSON found in response`);\n                        if (attempt < maxAttempts) {\n                            console.log(` Retrying...`);\n                            continue;\n                        }\n                        throw new Error(\"No JSON found in response\");\n                    }\n                } catch (parseError) {\n                    console.log(` JSON parsing failed:`, parseError);\n                    if (attempt < maxAttempts) {\n                        console.log(` Retrying with adjusted prompt...`);\n                        continue;\n                    }\n                    throw new Error(\"Failed to parse grammar JSON response\");\n                }\n                // Validate grammar section using new validator\n                const grammarSection = {\n                    rule: grammarData.explanation?.form || \"\",\n                    form: grammarData.explanation?.form || \"\",\n                    usage: grammarData.explanation?.usage || \"\",\n                    examples: grammarData.examples || [],\n                    exercises: grammarData.exercises || []\n                };\n                const validation = _section_validators__WEBPACK_IMPORTED_MODULE_2__.grammarValidator.validate(grammarSection, context.difficultyLevel);\n                if (!validation.isValid) {\n                    console.log(` Grammar validation failed:`, validation.issues);\n                    if (attempt < maxAttempts) {\n                        console.log(` Retrying with adjusted prompt...`);\n                        continue;\n                    }\n                    console.log(` Using grammar section despite validation issues (max attempts reached)`);\n                } else {\n                    console.log(` Grammar section validated successfully`);\n                }\n                // Track quality metrics\n                const generationTime = Date.now() - sectionStartTime;\n                _quality_metrics__WEBPACK_IMPORTED_MODULE_3__.qualityMetricsTracker.recordSection(\"grammar\", validation.score, attempt, generationTime, validation.issues.length, validation.warnings.length);\n                // Return the comprehensive grammar structure\n                return {\n                    focus: grammarData.grammarPoint,\n                    explanation: grammarData.explanation,\n                    examples: grammarData.examples,\n                    exercises: grammarData.exercises\n                };\n            } catch (error) {\n                console.error(` Attempt ${attempt} failed:`, error);\n                if (attempt >= maxAttempts) {\n                    // Track failed generation\n                    _quality_metrics__WEBPACK_IMPORTED_MODULE_3__.qualityMetricsTracker.recordSection(\"grammar\", 0, attempt, Date.now() - sectionStartTime, 1, 0);\n                    throw new Error(`Failed to generate grammar section after ${maxAttempts} attempts: ${error.message}`);\n                }\n            }\n        }\n        throw new Error(\"Failed to generate grammar section after all attempts\");\n    }\n    /**\r\n   * Parse pronunciation word response from structured text format\r\n   */ parsePronunciationWordResponse(response, word) {\n        const lines = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.length > 0);\n        const result = {\n            word: word,\n            ipa: \"\",\n            difficultSounds: [],\n            tips: [],\n            practiceSentence: \"\"\n        };\n        for (const line of lines){\n            if (line.startsWith(\"WORD:\")) {\n                result.word = line.substring(5).trim();\n            } else if (line.startsWith(\"IPA:\")) {\n                result.ipa = line.substring(4).trim();\n            } else if (line.startsWith(\"DIFFICULT_SOUNDS:\")) {\n                const sounds = line.substring(17).trim();\n                result.difficultSounds = sounds.split(\",\").map((s)=>s.trim()).filter((s)=>s.length > 0);\n            } else if (line.startsWith(\"TIP_\")) {\n                const tip = line.substring(line.indexOf(\":\") + 1).trim();\n                if (tip.length > 0) {\n                    result.tips.push(tip);\n                }\n            } else if (line.startsWith(\"PRACTICE:\")) {\n                result.practiceSentence = line.substring(9).trim();\n            }\n        }\n        return result;\n    }\n    /**\r\n   * Parse tongue twister response from structured text format\r\n   */ parseTongueTwisterResponse(response, expectedCount) {\n        const lines = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.length > 0);\n        const twisters = [];\n        let currentTwister = null;\n        let currentIndex = -1;\n        for (const line of lines){\n            const twisterMatch = line.match(/^TWISTER_(\\d+):(.+)/);\n            if (twisterMatch) {\n                currentIndex = parseInt(twisterMatch[1]) - 1;\n                currentTwister = {\n                    text: twisterMatch[2].trim(),\n                    targetSounds: [],\n                    difficulty: \"moderate\"\n                };\n                twisters[currentIndex] = currentTwister;\n                continue;\n            }\n            const soundsMatch = line.match(/^SOUNDS_(\\d+):(.+)/);\n            if (soundsMatch && currentTwister) {\n                const sounds = soundsMatch[2].trim();\n                currentTwister.targetSounds = sounds.split(\",\").map((s)=>s.trim()).filter((s)=>s.length > 0);\n                continue;\n            }\n            const difficultyMatch = line.match(/^DIFFICULTY_(\\d+):(.+)/);\n            if (difficultyMatch && currentTwister) {\n                currentTwister.difficulty = difficultyMatch[2].trim();\n                continue;\n            }\n        }\n        // Filter out any null entries\n        return twisters.filter((t)=>t && t.text && t.text.length > 0);\n    }\n    /**\r\n   * Select challenging words for pronunciation practice\r\n   * Implements Requirements 6.5, 6.6 - Select words with challenging sounds for target language learners\r\n   */ selectChallengingWords(context, count) {\n        // Get vocabulary from context - ensure words are from lesson vocabulary\n        const vocabularySection = context.keyVocabulary;\n        if (vocabularySection.length === 0) {\n            console.log(\" No vocabulary available for pronunciation selection\");\n            return [];\n        }\n        console.log(` Selecting ${count} challenging words from ${vocabularySection.length} vocabulary words`);\n        // Score words by pronunciation difficulty with enhanced criteria\n        const scoredWords = vocabularySection.map((word)=>{\n            let score = 0;\n            const wordLower = word.toLowerCase();\n            const challengingSounds = [];\n            // Base score: Longer words are typically more challenging (but cap to avoid over-weighting)\n            score += Math.min(word.length, 12);\n            // HIGH PRIORITY: Consonant digraphs and difficult consonant sounds (most challenging for learners)\n            const consonantPatterns = [\n                {\n                    pattern: /th/gi,\n                    sound: \"// or /\\xf0/\",\n                    weight: 5\n                },\n                {\n                    pattern: /ch/gi,\n                    sound: \"/t/\",\n                    weight: 4\n                },\n                {\n                    pattern: /sh/gi,\n                    sound: \"//\",\n                    weight: 4\n                },\n                {\n                    pattern: /ph/gi,\n                    sound: \"/f/\",\n                    weight: 3\n                },\n                {\n                    pattern: /gh/gi,\n                    sound: \"/g/ or /f/\",\n                    weight: 4\n                },\n                {\n                    pattern: /ng/gi,\n                    sound: \"//\",\n                    weight: 3\n                },\n                {\n                    pattern: /wh/gi,\n                    sound: \"/w/ or /hw/\",\n                    weight: 3\n                },\n                {\n                    pattern: /[^aeiou]r/gi,\n                    sound: \"/r/\",\n                    weight: 4\n                }\n            ];\n            consonantPatterns.forEach(({ pattern, sound, weight })=>{\n                const matches = wordLower.match(pattern);\n                if (matches) {\n                    score += weight * matches.length;\n                    challengingSounds.push(sound);\n                }\n            });\n            // MEDIUM PRIORITY: Complex vowel combinations (challenging for pronunciation)\n            const vowelPatterns = [\n                {\n                    pattern: /ough|augh/gi,\n                    sound: \"// or /f/\",\n                    weight: 5\n                },\n                {\n                    pattern: /eau/gi,\n                    sound: \"/o/\",\n                    weight: 4\n                },\n                {\n                    pattern: /ieu/gi,\n                    sound: \"/ju/\",\n                    weight: 4\n                },\n                {\n                    pattern: /ou/gi,\n                    sound: \"/a/ or /u/\",\n                    weight: 3\n                },\n                {\n                    pattern: /oo/gi,\n                    sound: \"/u/ or //\",\n                    weight: 3\n                },\n                {\n                    pattern: /ea/gi,\n                    sound: \"/i/ or /e/\",\n                    weight: 3\n                },\n                {\n                    pattern: /au|aw/gi,\n                    sound: \"//\",\n                    weight: 3\n                },\n                {\n                    pattern: /oi|oy/gi,\n                    sound: \"//\",\n                    weight: 3\n                },\n                {\n                    pattern: /ei|ey/gi,\n                    sound: \"/e/ or /i/\",\n                    weight: 2\n                },\n                {\n                    pattern: /ie/gi,\n                    sound: \"/i/ or /a/\",\n                    weight: 2\n                }\n            ];\n            vowelPatterns.forEach(({ pattern, sound, weight })=>{\n                const matches = wordLower.match(pattern);\n                if (matches) {\n                    score += weight * matches.length;\n                    challengingSounds.push(sound);\n                }\n            });\n            // MEDIUM PRIORITY: Common difficult endings\n            const endingPatterns = [\n                {\n                    pattern: /tion$/gi,\n                    sound: \"/n/\",\n                    weight: 3\n                },\n                {\n                    pattern: /sion$/gi,\n                    sound: \"/n/ or /n/\",\n                    weight: 3\n                },\n                {\n                    pattern: /ture$/gi,\n                    sound: \"/tr/\",\n                    weight: 3\n                },\n                {\n                    pattern: /sure$/gi,\n                    sound: \"/r/\",\n                    weight: 3\n                },\n                {\n                    pattern: /cious$/gi,\n                    sound: \"/s/\",\n                    weight: 2\n                },\n                {\n                    pattern: /tious$/gi,\n                    sound: \"/s/\",\n                    weight: 2\n                }\n            ];\n            endingPatterns.forEach(({ pattern, sound, weight })=>{\n                if (pattern.test(wordLower)) {\n                    score += weight;\n                    challengingSounds.push(sound);\n                }\n            });\n            // HIGH PRIORITY: Silent letters (very confusing for learners)\n            const silentLetterPatterns = [\n                {\n                    pattern: /\\bkn/gi,\n                    sound: \"silent k\",\n                    weight: 5\n                },\n                {\n                    pattern: /\\bgn/gi,\n                    sound: \"silent g\",\n                    weight: 5\n                },\n                {\n                    pattern: /\\bwr/gi,\n                    sound: \"silent w\",\n                    weight: 5\n                },\n                {\n                    pattern: /\\bps/gi,\n                    sound: \"silent p\",\n                    weight: 5\n                },\n                {\n                    pattern: /mb$/gi,\n                    sound: \"silent b\",\n                    weight: 4\n                },\n                {\n                    pattern: /bt$/gi,\n                    sound: \"silent b\",\n                    weight: 4\n                },\n                {\n                    pattern: /lm$/gi,\n                    sound: \"silent l\",\n                    weight: 4\n                },\n                {\n                    pattern: /lk$/gi,\n                    sound: \"silent l\",\n                    weight: 4\n                },\n                {\n                    pattern: /[aeiou]gh/gi,\n                    sound: \"silent gh\",\n                    weight: 3\n                }\n            ];\n            silentLetterPatterns.forEach(({ pattern, sound, weight })=>{\n                if (pattern.test(wordLower)) {\n                    score += weight;\n                    challengingSounds.push(sound);\n                }\n            });\n            // MEDIUM PRIORITY: Consonant clusters (difficult for many learners)\n            const clusterPatterns = [\n                {\n                    pattern: /[^aeiou]{3,}/gi,\n                    sound: \"consonant cluster\",\n                    weight: 3\n                },\n                {\n                    pattern: /[aeiou]{3,}/gi,\n                    sound: \"vowel cluster\",\n                    weight: 2\n                }\n            ];\n            clusterPatterns.forEach(({ pattern, sound, weight })=>{\n                const matches = wordLower.match(pattern);\n                if (matches) {\n                    score += weight * matches.length;\n                    challengingSounds.push(sound);\n                }\n            });\n            // BONUS: Words with stress pattern changes (advanced)\n            // Words ending in -ate, -tion, -ic often have specific stress patterns\n            if (/ate$|tion$|ic$/i.test(wordLower) && word.length > 6) {\n                score += 2;\n                challengingSounds.push(\"stress pattern\");\n            }\n            // Log scoring for debugging\n            if (score > 10) {\n                console.log(`   \"${word}\": score=${score}, sounds=[${challengingSounds.join(\", \")}]`);\n            }\n            return {\n                word,\n                score,\n                challengingSounds: [\n                    ...new Set(challengingSounds)\n                ]\n            };\n        });\n        // Sort by score (descending) and take top words\n        const sortedWords = scoredWords.sort((a, b)=>b.score - a.score);\n        // Select top challenging words, ensuring diversity of challenging sounds\n        const selectedWords = [];\n        const selectedSounds = new Set();\n        // First pass: Select words with unique challenging sounds\n        for (const item of sortedWords){\n            if (selectedWords.length >= count) break;\n            // Check if this word introduces new challenging sounds\n            const newSounds = item.challengingSounds.filter((s)=>!selectedSounds.has(s));\n            if (newSounds.length > 0 || selectedWords.length < Math.ceil(count / 2)) {\n                selectedWords.push(item.word);\n                item.challengingSounds.forEach((s)=>selectedSounds.add(s));\n                console.log(`   Selected \"${item.word}\" (score: ${item.score}, new sounds: ${newSounds.length})`);\n            }\n        }\n        // Second pass: Fill remaining slots with highest-scoring words\n        if (selectedWords.length < count) {\n            for (const item of sortedWords){\n                if (selectedWords.length >= count) break;\n                if (!selectedWords.includes(item.word)) {\n                    selectedWords.push(item.word);\n                    console.log(`   Selected \"${item.word}\" (score: ${item.score}, filling remaining slots)`);\n                }\n            }\n        }\n        // If we still don't have enough words, add remaining vocabulary\n        if (selectedWords.length < count) {\n            const remaining = vocabularySection.filter((w)=>!selectedWords.includes(w)).slice(0, count - selectedWords.length);\n            selectedWords.push(...remaining);\n            console.log(`   Added ${remaining.length} additional words to meet count requirement`);\n        }\n        console.log(` Selected ${selectedWords.length} challenging words: ${selectedWords.join(\", \")}`);\n        console.log(` Challenging sounds covered: ${Array.from(selectedSounds).join(\", \")}`);\n        return selectedWords;\n    }\n    /**\r\n   * Build pronunciation word generation prompt\r\n   * Implements Requirement 6.6 - Generate practice sentences using the target words\r\n   */ buildPronunciationWordPrompt(word, context) {\n        const mainTheme = context.mainThemes[0] || \"general topics\";\n        const contextSummary = context.contentSummary.substring(0, 200);\n        // Get related vocabulary for context\n        const relatedWords = context.keyVocabulary.filter((w)=>w.toLowerCase() !== word.toLowerCase()).slice(0, 3).join(\", \");\n        const prompt = `Create pronunciation practice for the word \"${word}\" for ${context.difficultyLevel} level students.\r\n\r\nCONTEXT: ${contextSummary}\r\nTOPIC: ${mainTheme}\r\nRELATED VOCABULARY: ${relatedWords}\r\n\r\nCRITICAL REQUIREMENTS:\r\n1. Provide accurate IPA (International Phonetic Alphabet) transcription\r\n2. Identify 2-3 specific difficult sounds in the word that are challenging for English learners\r\n3. Give practical, actionable pronunciation tips focusing on mouth/tongue position\r\n4. Create a practice sentence that:\r\n   - Uses \"${word}\" naturally in context\r\n   - Relates to the topic (${mainTheme})\r\n   - Is appropriate for ${context.difficultyLevel} level\r\n   - Helps reinforce correct pronunciation through context\r\n   - Ideally includes other words with similar challenging sounds\r\n\r\nProvide the following information in this exact format:\r\n\r\nWORD: ${word}\r\nIPA: [provide accurate IPA transcription using standard IPA symbols]\r\nDIFFICULT_SOUNDS: [list 2-3 specific IPA sounds that are challenging, e.g., //, //, /r/]\r\nTIP_1: [specific tip about mouth/tongue position for first difficult sound]\r\nTIP_2: [specific tip about mouth/tongue position for second difficult sound]\r\nPRACTICE: [a contextually relevant sentence using \"${word}\" that relates to ${mainTheme}]\r\n\r\nExample for \"through\" in sports context:\r\nWORD: through\r\nIPA: /ru/\r\nDIFFICULT_SOUNDS: //, /u/\r\nTIP_1: Place your tongue between your teeth for the 'th' sound (//)\r\nTIP_2: Round your lips and make them tense for the long 'oo' sound (/u/)\r\nPRACTICE: The athlete ran through the finish line with determination.\r\n\r\nExample for \"strength\" in fitness context:\r\nWORD: strength\r\nIPA: /stre/\r\nDIFFICULT_SOUNDS: /str/, //, //\r\nTIP_1: Blend the 's', 't', and 'r' sounds smoothly without adding extra vowels\r\nTIP_2: For the final 'th' (//), place your tongue between your teeth\r\nPRACTICE: Building strength requires consistent training and proper nutrition.`;\n        return prompt;\n    }\n    /**\r\n   * Build tongue twister generation prompt\r\n   */ buildTongueTwisterPrompt(context, count) {\n        const themes = context.mainThemes.slice(0, 2).join(\" and \");\n        const targetWords = context.keyVocabulary.slice(0, 5).join(\", \");\n        const prompt = `Create ${count} tongue twisters for ${context.difficultyLevel} level students about \"${themes}\".\r\n\r\nRequirements:\r\n- Related to: ${themes}\r\n- Try to use words: ${targetWords}\r\n- Focus on challenging sounds (th, r, l, s, sh, ch)\r\n- 6-12 words each\r\n- Appropriate for ${context.difficultyLevel} level\r\n\r\nProvide in this exact format:\r\n\r\nTWISTER_1: [first tongue twister text]\r\nSOUNDS_1: [target sounds separated by commas, e.g., //, /s/]\r\nDIFFICULTY_1: moderate\r\n\r\nTWISTER_2: [second tongue twister text]\r\nSOUNDS_2: [target sounds separated by commas]\r\nDIFFICULTY_2: moderate\r\n\r\nExample:\r\nTWISTER_1: Three athletes threw the ball through the thick crowd\r\nSOUNDS_1: //, /r/\r\nDIFFICULTY_1: moderate\r\n\r\nTWISTER_2: Six successful salespeople sold several similar services\r\nSOUNDS_2: /s/, /l/\r\nDIFFICULTY_2: moderate`;\n        return prompt;\n    }\n    /**\r\n   * Validate pronunciation section for completeness\r\n   * Implements Requirements 6.1, 6.2, 6.3, 6.4, 6.5, 6.6 - Comprehensive validation\r\n   */ validatePronunciationSection(words, tongueTwisters, minWords, minTongueTwisters, context) {\n        const issues = [];\n        const warnings = [];\n        console.log(` Validating pronunciation section: ${words.length} words, ${tongueTwisters.length} twisters`);\n        // Requirement 6.1: Check minimum word count (at least 5 advanced words)\n        if (words.length < minWords) {\n            issues.push(`Insufficient pronunciation words: expected at least ${minWords}, got ${words.length}`);\n        }\n        // Requirement 6.4: Check minimum tongue twister count (at least 2)\n        if (tongueTwisters.length < minTongueTwisters) {\n            issues.push(`Insufficient tongue twisters: expected at least ${minTongueTwisters}, got ${tongueTwisters.length}`);\n        }\n        // Validate each word has required fields and quality\n        for(let i = 0; i < words.length; i++){\n            const word = words[i];\n            const wordNum = i + 1;\n            // Basic field validation\n            if (!word.word || typeof word.word !== \"string\") {\n                issues.push(`Word ${wordNum} missing 'word' field`);\n                continue;\n            }\n            // Requirement 6.2: Validate IPA transcription exists\n            if (!word.ipa || typeof word.ipa !== \"string\") {\n                issues.push(`Word ${wordNum} (\"${word.word}\") missing IPA transcription`);\n            } else {\n                // Check if IPA looks valid (should contain IPA characters or slashes)\n                if (!word.ipa.includes(\"/\") && !word.ipa.match(/[]/)) {\n                    warnings.push(`Word ${wordNum} (\"${word.word}\") IPA may be invalid: \"${word.ipa}\"`);\n                }\n            }\n            // Requirement 6.3: Validate pronunciation tips exist\n            if (!word.tips || !Array.isArray(word.tips) || word.tips.length === 0) {\n                issues.push(`Word ${wordNum} (\"${word.word}\") missing pronunciation tips`);\n            } else {\n                // Check tip quality - should be actionable and specific\n                const hasActionableTips = word.tips.some((tip)=>tip.length > 15 && (tip.toLowerCase().includes(\"tongue\") || tip.toLowerCase().includes(\"lip\") || tip.toLowerCase().includes(\"mouth\") || tip.toLowerCase().includes(\"sound\") || tip.toLowerCase().includes(\"place\")));\n                if (!hasActionableTips) {\n                    warnings.push(`Word ${wordNum} (\"${word.word}\") tips may lack specific pronunciation guidance`);\n                }\n            }\n            // Requirement 6.6: Validate practice sentence exists and uses the word\n            if (!word.practiceSentence || typeof word.practiceSentence !== \"string\") {\n                issues.push(`Word ${wordNum} (\"${word.word}\") missing practice sentence`);\n            } else {\n                // Check if practice sentence actually contains the word\n                const sentenceLower = word.practiceSentence.toLowerCase();\n                const wordLower = word.word.toLowerCase();\n                if (!sentenceLower.includes(wordLower)) {\n                    issues.push(`Word ${wordNum} (\"${word.word}\") practice sentence doesn't contain the word`);\n                }\n                // Check sentence length is appropriate\n                const wordCount = word.practiceSentence.split(/\\s+/).length;\n                if (wordCount < 5) {\n                    warnings.push(`Word ${wordNum} (\"${word.word}\") practice sentence is very short (${wordCount} words)`);\n                } else if (wordCount > 25) {\n                    warnings.push(`Word ${wordNum} (\"${word.word}\") practice sentence is very long (${wordCount} words)`);\n                }\n                // Check sentence has proper capitalization and punctuation\n                if (!/^[A-Z]/.test(word.practiceSentence)) {\n                    warnings.push(`Word ${wordNum} (\"${word.word}\") practice sentence should start with capital letter`);\n                }\n                if (!/[.!?]$/.test(word.practiceSentence)) {\n                    warnings.push(`Word ${wordNum} (\"${word.word}\") practice sentence should end with punctuation`);\n                }\n            }\n            // Requirement 6.5: Validate word has challenging sounds (if difficultSounds field exists)\n            if (word.difficultSounds && Array.isArray(word.difficultSounds)) {\n                if (word.difficultSounds.length === 0) {\n                    warnings.push(`Word ${wordNum} (\"${word.word}\") has no difficult sounds identified`);\n                }\n            }\n            // Check if word is from lesson vocabulary (if context provided)\n            if (context && context.keyVocabulary.length > 0) {\n                const isFromVocabulary = context.keyVocabulary.some((v)=>v.toLowerCase() === word.word.toLowerCase());\n                if (!isFromVocabulary) {\n                    warnings.push(`Word ${wordNum} (\"${word.word}\") is not from lesson vocabulary`);\n                }\n            }\n        }\n        // Validate each tongue twister has required fields and quality\n        for(let i = 0; i < tongueTwisters.length; i++){\n            const twister = tongueTwisters[i];\n            const twisterNum = i + 1;\n            if (!twister.text || typeof twister.text !== \"string\") {\n                issues.push(`Tongue twister ${twisterNum} missing text`);\n                continue;\n            }\n            // Check tongue twister length (should be 6-15 words for effectiveness)\n            const wordCount = twister.text.split(/\\s+/).length;\n            if (wordCount < 6) {\n                warnings.push(`Tongue twister ${twisterNum} is too short (${wordCount} words, recommended 6-15)`);\n            } else if (wordCount > 15) {\n                warnings.push(`Tongue twister ${twisterNum} is too long (${wordCount} words, recommended 6-15)`);\n            }\n            // Validate target sounds exist\n            if (!twister.targetSounds || !Array.isArray(twister.targetSounds)) {\n                issues.push(`Tongue twister ${twisterNum} missing target sounds`);\n            } else if (twister.targetSounds.length === 0) {\n                issues.push(`Tongue twister ${twisterNum} has no target sounds specified`);\n            }\n            // Check if tongue twister relates to lesson topic (if context provided)\n            if (context && context.mainThemes.length > 0) {\n                const twisterLower = twister.text.toLowerCase();\n                const hasTopicRelevance = context.mainThemes.some((theme)=>{\n                    const themeWords = theme.toLowerCase().split(/\\s+/);\n                    return themeWords.some((word)=>word.length > 3 && twisterLower.includes(word));\n                });\n                if (!hasTopicRelevance) {\n                    warnings.push(`Tongue twister ${twisterNum} may not relate to lesson topic`);\n                }\n            }\n        }\n        // Check for sound diversity across all words\n        const allDifficultSounds = new Set();\n        words.forEach((word)=>{\n            if (word.difficultSounds && Array.isArray(word.difficultSounds)) {\n                word.difficultSounds.forEach((sound)=>allDifficultSounds.add(sound));\n            }\n        });\n        if (allDifficultSounds.size < 3 && words.length >= 3) {\n            warnings.push(`Limited sound diversity: only ${allDifficultSounds.size} different challenging sounds across all words`);\n        }\n        // Log warnings for visibility\n        if (warnings.length > 0) {\n            console.log(` Pronunciation validation warnings:`, warnings);\n        }\n        // Log validation summary\n        if (issues.length === 0) {\n            console.log(` Pronunciation section validation passed (${words.length} words, ${tongueTwisters.length} twisters, ${allDifficultSounds.size} unique sounds)`);\n        } else {\n            console.log(` Pronunciation section validation failed with ${issues.length} issues`);\n        }\n        return {\n            isValid: issues.length === 0,\n            issues: [\n                ...issues,\n                ...warnings.map((w)=>`Warning: ${w}`)\n            ]\n        };\n    }\n    async generatePronunciationWithContext(context, _previousSections) {\n        const minWords = 5;\n        const minTongueTwisters = 2;\n        const maxAttempts = 2;\n        let attempt = 0;\n        const sectionStartTime = Date.now();\n        // Report progress at start of pronunciation generation\n        safeProgressCallback(this.progressCallback, {\n            step: \"Generating pronunciation section\",\n            progress: this.calculateProgress(this.completedSections, \"pronunciation\", context.lessonType, this.phaseWeights),\n            phase: \"pronunciation\",\n            section: \"pronunciation\"\n        });\n        console.log(` Generating pronunciation section with ${minWords} words and ${minTongueTwisters} tongue twisters`);\n        while(attempt < maxAttempts){\n            attempt++;\n            console.log(` Pronunciation generation attempt ${attempt}/${maxAttempts}`);\n            try {\n                // Select challenging words for pronunciation practice\n                const selectedWords = this.selectChallengingWords(context, minWords);\n                console.log(` Selected words for pronunciation:`, selectedWords);\n                // Generate pronunciation details for each word\n                const pronunciationWords = [];\n                for (const word of selectedWords){\n                    try {\n                        const wordPrompt = this.buildPronunciationWordPrompt(word, context);\n                        const wordResponse = await this.getGoogleAI().prompt(wordPrompt);\n                        console.log(` Raw AI response for \"${word}\":`, wordResponse.substring(0, 200));\n                        // Parse structured text response\n                        const wordData = this.parsePronunciationWordResponse(wordResponse, word);\n                        console.log(` Parsed data for \"${word}\":`, JSON.stringify(wordData, null, 2));\n                        // Validate required fields\n                        if (!wordData.word || !wordData.ipa || !wordData.tips || wordData.tips.length === 0 || !wordData.practiceSentence) {\n                            console.log(` Validation failed for \"${word}\":`, {\n                                hasWord: !!wordData.word,\n                                hasIpa: !!wordData.ipa,\n                                hasTips: !!wordData.tips,\n                                tipsLength: wordData.tips?.length || 0,\n                                hasPractice: !!wordData.practiceSentence\n                            });\n                            throw new Error(\"Missing required fields in response\");\n                        }\n                        pronunciationWords.push(wordData);\n                        console.log(` Generated pronunciation for \"${word}\": ${wordData.ipa}`);\n                    } catch (error) {\n                        console.log(` Failed to generate pronunciation for \"${word}\":`, error);\n                        console.log(` Error details:`, error.message);\n                        // NO FALLBACK CONTENT - fail the generation if AI cannot provide quality content\n                        throw new Error(`Failed to generate pronunciation for word \"${word}\": ${error.message}`);\n                    }\n                }\n                // Generate tongue twisters\n                let tongueTwisters = [];\n                try {\n                    const twisterPrompt = this.buildTongueTwisterPrompt(context, minTongueTwisters);\n                    const twisterResponse = await this.getGoogleAI().prompt(twisterPrompt);\n                    // Parse structured text response\n                    tongueTwisters = this.parseTongueTwisterResponse(twisterResponse, minTongueTwisters);\n                    if (tongueTwisters.length < minTongueTwisters) {\n                        throw new Error(`Only ${tongueTwisters.length} valid tongue twisters generated`);\n                    }\n                    console.log(` Generated ${tongueTwisters.length} tongue twisters`);\n                } catch (error) {\n                    console.log(` Failed to generate tongue twisters:`, error);\n                    // NO FALLBACK CONTENT - fail the generation if AI cannot provide quality content\n                    throw new Error(`Failed to generate tongue twisters: ${error.message}`);\n                }\n                // Validate the pronunciation section using new validator\n                const pronunciationSection = {\n                    words: pronunciationWords,\n                    tongueTwisters: tongueTwisters\n                };\n                const validation = _section_validators__WEBPACK_IMPORTED_MODULE_2__.pronunciationValidator.validate(pronunciationSection);\n                if (!validation.isValid) {\n                    console.log(` Validation failed (attempt ${attempt}/${maxAttempts}):`, validation.issues);\n                    if (attempt < maxAttempts) {\n                        console.log(` Retrying pronunciation generation...`);\n                        continue;\n                    } else {\n                        console.log(` Using pronunciation section despite validation issues (max attempts reached)`);\n                    }\n                } else {\n                    console.log(` Pronunciation section validated successfully`);\n                }\n                // Track quality metrics\n                const generationTime = Date.now() - sectionStartTime;\n                _quality_metrics__WEBPACK_IMPORTED_MODULE_3__.qualityMetricsTracker.recordSection(\"pronunciation\", validation.score, attempt, generationTime, validation.issues.length, validation.warnings.length);\n                // Build the final pronunciation section\n                return {\n                    instruction: \"Practice pronunciation with your tutor. Focus on the difficult sounds and try the tongue twisters:\",\n                    words: pronunciationWords,\n                    tongueTwisters: tongueTwisters\n                };\n            } catch (error) {\n                console.error(` Attempt ${attempt} failed:`, error);\n                if (attempt >= maxAttempts) {\n                    // Track failed generation\n                    _quality_metrics__WEBPACK_IMPORTED_MODULE_3__.qualityMetricsTracker.recordSection(\"pronunciation\", 0, attempt, Date.now() - sectionStartTime, 1, 0);\n                    throw new Error(\"Failed to generate pronunciation section: \" + error.message);\n                }\n            }\n        }\n        throw new Error(\"Failed to generate pronunciation section after all attempts\");\n    }\n    async generateWrapupWithContext(context, _previousSections) {\n        // Report progress at start of wrapup generation\n        safeProgressCallback(this.progressCallback, {\n            step: \"Generating wrap-up questions\",\n            progress: this.calculateProgress(this.completedSections, \"wrapup\", context.lessonType, this.phaseWeights),\n            phase: \"wrapup\",\n            section: \"wrapup\"\n        });\n        const prompt = `Create 3 ${context.difficultyLevel} wrap-up questions about this lesson:\r\n${context.contentSummary}\r\nReturn only questions, one per line:`;\n        try {\n            const response = await this.getGoogleAI().prompt(prompt);\n            const questions = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.endsWith(\"?\") && line.length > 10).slice(0, 3);\n            if (questions.length < 3) {\n                throw new Error(\"Insufficient wrapup questions generated\");\n            }\n            const instruction = \"Reflect on your learning by discussing these wrap-up questions:\";\n            return [\n                instruction,\n                ...questions\n            ];\n        } catch (error) {\n            throw new Error(\"Failed to generate wrapup questions: \" + error.message);\n        }\n    }\n    /**\r\n   * Build level-specific dialogue prompt with length and complexity requirements\r\n   * Implements Requirements 3.3, 3.4, 3.5, 3.6, 3.7\r\n   */ buildDialoguePrompt(context, vocabularyWords, type) {\n        const mainTheme = context.mainThemes[0] || \"this topic\";\n        // CEFR-specific complexity instructions with detailed vocabulary and grammar guidance\n        const levelComplexityInstructions = {\n            \"A1\": {\n                vocabulary: \"Use ONLY the most common everyday words (top 500-1000 words). Examples: go, come, like, want, have, be, do, make, get, see, know, think, say, tell, ask.\",\n                grammar: \"Use ONLY simple present tense (I go, she likes) and simple past tense (I went, she liked). Use basic subject-verb-object structure. NO complex grammar, NO perfect tenses, NO conditionals, NO passive voice.\",\n                sentenceLength: \"Keep sentences very short: 5-8 words maximum. One idea per sentence.\",\n                examples: 'Good: \"I like this topic.\" / \"Do you know about it?\" / \"Yes, I read about it yesterday.\" Bad: \"I\\'ve been interested in this topic for a while.\" (too complex)'\n            },\n            \"A2\": {\n                vocabulary: \"Use simple, familiar vocabulary (top 1000-2000 words). Include common adjectives and adverbs. Examples: interesting, important, different, usually, sometimes, often, really, very.\",\n                grammar: 'Use present simple, past simple, present continuous (I am doing), and future with \"going to\" and \"will\". Use simple conjunctions (and, but, or, because). NO present perfect, NO complex conditionals, NO passive voice.',\n                sentenceLength: 'Keep sentences clear and direct: 8-12 words. Can combine two simple ideas with \"and\" or \"but\".',\n                examples: 'Good: \"I\\'m reading about this topic because it\\'s interesting.\" / \"I want to learn more about it.\" Bad: \"I\\'ve been studying this topic which has fascinated me.\" (too complex)'\n            },\n            \"B1\": {\n                vocabulary: \"Use intermediate vocabulary with some less common words. Include phrasal verbs (find out, look into, come across, deal with). Use descriptive language and opinion expressions (I think, in my opinion, it seems).\",\n                grammar: \"Use varied tenses including present perfect (I have done), past continuous (I was doing), and first conditional (If I do, I will). Include compound sentences with coordinating conjunctions. Use some relative clauses (that, which, who).\",\n                sentenceLength: \"Use varied sentence lengths: 10-15 words average. Mix simple and compound sentences.\",\n                examples: 'Good: \"I\\'ve been looking into this topic, and I\\'ve found some interesting information.\" / \"If we discuss it more, I think I\\'ll understand it better.\" Bad: \"I go to library.\" (too simple) / \"Having contemplated the multifaceted nature...\" (too complex)'\n            },\n            \"B2\": {\n                vocabulary: \"Use advanced vocabulary including abstract concepts, idiomatic expressions, and sophisticated descriptive language. Include collocations (make a decision, take into account, come to terms with). Use nuanced expressions (somewhat, rather, fairly, considerably).\",\n                grammar: \"Use complex sentence structures with relative clauses, second and third conditionals (If I had done, I would have), passive voice (is considered, has been shown), and perfect tenses. Include subordinating conjunctions (although, whereas, despite, unless).\",\n                sentenceLength: \"Use sophisticated sentences: 12-18 words. Combine multiple clauses naturally.\",\n                examples: 'Good: \"Although I\\'ve studied this topic extensively, there are aspects that remain somewhat unclear.\" / \"The implications of this could be far-reaching if we consider the broader context.\" Bad: \"I like this topic.\" (too simple)'\n            },\n            \"C1\": {\n                vocabulary: \"Use sophisticated, nuanced vocabulary including academic language, subtle distinctions, and native-like expressions. Include advanced idioms, metaphors, and specialized terminology. Use hedging language (arguably, presumably, ostensibly, to some extent).\",\n                grammar: \"Use complex grammatical structures including inversion (Rarely have I seen...), cleft sentences (What interests me is...), subjunctive mood (I suggest that he be...), and advanced conditionals (Were I to consider...). Demonstrate mastery of all tenses and aspects.\",\n                sentenceLength: \"Use sophisticated, flowing sentences: 15-20 words. Create complex, multi-clause sentences that sound natural.\",\n                examples: 'Good: \"What strikes me as particularly intriguing is the way in which this topic intersects with broader societal concerns.\" / \"Were we to delve deeper into this matter, we might uncover some rather unexpected insights.\" Bad: \"This topic is interesting.\" (too simple) / \"I think about this topic.\" (too simple)'\n            }\n        };\n        const levelInstructions = levelComplexityInstructions[context.difficultyLevel];\n        // Vocabulary integration instruction with emphasis on natural use\n        const vocabInstruction = vocabularyWords.length > 0 ? `VOCABULARY INTEGRATION: Naturally incorporate 3-4 of these lesson vocabulary words into the dialogue: ${vocabularyWords.slice(0, 5).join(\", \")}. Use them in context where they fit naturally, not forced.` : \"\";\n        if (type === \"practice\") {\n            const prompt = `Create a natural conversation between a Student and a Tutor about \"${mainTheme}\" for ${context.difficultyLevel} level students.\r\n\r\nCONTEXT: ${context.contentSummary}\r\n\r\nTOPIC THEMES: ${context.mainThemes.join(\", \")}\r\n\r\nCRITICAL REQUIREMENTS:\r\n1. Create EXACTLY 14 dialogue lines (alternating between Student and Tutor) - THIS IS MANDATORY\r\n2. Start with Student speaking first\r\n3. Make the conversation natural and engaging about the topic\r\n4. The conversation should relate to the source material context and themes\r\n5. Ensure natural conversational flow with appropriate responses and follow-up questions\r\n6. ${vocabInstruction}\r\n7. COUNT YOUR LINES - you must have at least 14 lines total (7 Student + 7 Tutor)\r\n\r\nLEVEL-SPECIFIC REQUIREMENTS FOR ${context.difficultyLevel}:\r\n\r\nVOCABULARY REQUIREMENTS:\r\n${levelInstructions.vocabulary}\r\n\r\nGRAMMAR REQUIREMENTS:\r\n${levelInstructions.grammar}\r\n\r\nSENTENCE LENGTH:\r\n${levelInstructions.sentenceLength}\r\n\r\nEXAMPLES OF APPROPRIATE LANGUAGE:\r\n${levelInstructions.examples}\r\n\r\nCONVERSATIONAL FLOW REQUIREMENTS:\r\n- Student should ask questions, express opinions, and show engagement\r\n- Tutor should respond naturally, ask follow-up questions, and guide the discussion\r\n- Each response should logically follow from the previous line\r\n- Include natural conversation markers appropriate to the level (e.g., A1: \"Oh, I see\", B2: \"That's an interesting perspective\", C1: \"That's a rather compelling argument\")\r\n- Show progression in the conversation - start with introduction, develop the topic, conclude naturally\r\n\r\nFORMAT:\r\nReturn ONLY the dialogue lines in this exact format:\r\nStudent: [first line]\r\nTutor: [response]\r\nStudent: [next line]\r\nTutor: [response]\r\nStudent: [next line]\r\nTutor: [response]\r\nStudent: [next line]\r\nTutor: [response]\r\nStudent: [next line]\r\nTutor: [response]\r\nStudent: [next line]\r\nTutor: [response]\r\nStudent: [next line]\r\nTutor: [response]\r\n\r\nDo NOT include any numbering, explanations, or extra text. Just the dialogue lines.`;\n            return prompt;\n        } else {\n            // fill-in-gap type\n            const prompt = `Create a natural conversation between a Student and a Tutor about \"${mainTheme}\" for ${context.difficultyLevel} level students with fill-in-the-gap exercises.\r\n\r\nCONTEXT: ${context.contentSummary}\r\n\r\nTOPIC THEMES: ${context.mainThemes.join(\", \")}\r\n\r\nCRITICAL REQUIREMENTS:\r\n1. Create EXACTLY 14 dialogue lines (alternating between Student and Tutor) - THIS IS MANDATORY\r\n2. Start with Student speaking first\r\n3. Replace 1-2 key words in SOME lines (about 4-6 lines total) with _____ (blank)\r\n4. The conversation should relate to the source material context and themes\r\n5. Ensure natural conversational flow with appropriate responses\r\n6. ${vocabInstruction}\r\n7. Choose meaningful words to blank out (verbs, nouns, adjectives - NOT articles, prepositions, or pronouns)\r\n8. Blank out words that are appropriate for the ${context.difficultyLevel} level\r\n9. COUNT YOUR LINES - you must have at least 14 lines total (7 Student + 7 Tutor)\r\n\r\nLEVEL-SPECIFIC REQUIREMENTS FOR ${context.difficultyLevel}:\r\n\r\nVOCABULARY REQUIREMENTS:\r\n${levelInstructions.vocabulary}\r\n\r\nGRAMMAR REQUIREMENTS:\r\n${levelInstructions.grammar}\r\n\r\nSENTENCE LENGTH:\r\n${levelInstructions.sentenceLength}\r\n\r\nEXAMPLES OF APPROPRIATE LANGUAGE:\r\n${levelInstructions.examples}\r\n\r\nGAP SELECTION GUIDELINES:\r\n- A1/A2: Blank out common verbs (go, like, want) or simple nouns (topic, idea, question)\r\n- B1: Blank out phrasal verbs (find out, look into) or intermediate vocabulary\r\n- B2/C1: Blank out sophisticated vocabulary, collocations, or idiomatic expressions\r\n- Ensure the gap can be filled from context clues in the conversation\r\n- Vary the types of words you blank out (don't just blank verbs)\r\n\r\nCONVERSATIONAL FLOW REQUIREMENTS:\r\n- Student should ask questions, express opinions, and show engagement\r\n- Tutor should respond naturally, ask follow-up questions, and guide the discussion\r\n- Each response should logically follow from the previous line\r\n- Include natural conversation markers appropriate to the level\r\n- Show progression in the conversation - start with introduction, develop the topic, conclude naturally\r\n\r\nFORMAT:\r\nReturn ONLY the dialogue lines in this exact format:\r\nStudent: [line with possible _____ for gap]\r\nTutor: [line with possible _____ for gap]\r\nStudent: [line with possible _____ for gap]\r\nTutor: [line with possible _____ for gap]\r\nStudent: [line with possible _____ for gap]\r\nTutor: [line with possible _____ for gap]\r\nStudent: [line with possible _____ for gap]\r\nTutor: [line with possible _____ for gap]\r\nStudent: [line with possible _____ for gap]\r\nTutor: [line with possible _____ for gap]\r\nStudent: [line with possible _____ for gap]\r\nTutor: [line with possible _____ for gap]\r\nStudent: [line with possible _____ for gap]\r\nTutor: [line with possible _____ for gap]\r\n\r\nEXAMPLE FOR ${context.difficultyLevel} LEVEL:\r\n${context.difficultyLevel === \"A1\" ? \"Student: I _____ to learn about this.\\nTutor: What do you _____ about it?\" : context.difficultyLevel === \"A2\" ? \"Student: I've been _____ about this topic.\\nTutor: What did you _____ most interesting?\" : context.difficultyLevel === \"B1\" ? \"Student: I've been _____ into this topic recently.\\nTutor: What aspects have you _____ across?\" : context.difficultyLevel === \"B2\" ? \"Student: The _____ of this topic requires careful analysis.\\nTutor: How do you _____ the different perspectives?\" : \"Student: The _____ nature of this topic is fascinating.\\nTutor: How would you _____ the apparent contradictions?\"}\r\n\r\nDo NOT include any numbering, explanations, or extra text. Just the dialogue lines with gaps.`;\n            return prompt;\n        }\n    }\n    /**\r\n   * Validate dialogue length, structure, and CEFR-appropriate complexity\r\n   * Implements Requirements 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7\r\n   */ validateDialogue(dialogueLines, context, type) {\n        const issues = [];\n        const warnings = [];\n        // Check minimum line count (requirement 3.1, 3.2)\n        const minLines = 12;\n        if (dialogueLines.length < minLines) {\n            issues.push(`Insufficient dialogue lines: expected at least ${minLines}, got ${dialogueLines.length}`);\n        }\n        // Check alternating speakers (requirement 3.6 - natural conversational flow)\n        for(let i = 0; i < dialogueLines.length - 1; i++){\n            if (dialogueLines[i].character === dialogueLines[i + 1].character) {\n                warnings.push(`Lines ${i + 1} and ${i + 2} have the same speaker (should alternate)`);\n            }\n        }\n        // Check that dialogue starts with Student\n        if (dialogueLines.length > 0 && dialogueLines[0].character !== \"Student\") {\n            warnings.push(\"Dialogue should start with Student speaking\");\n        }\n        // Check line length appropriateness for CEFR level (requirements 3.3, 3.4, 3.5)\n        const lengthRanges = {\n            \"A1\": {\n                min: 3,\n                max: 12\n            },\n            \"A2\": {\n                min: 5,\n                max: 18\n            },\n            \"B1\": {\n                min: 7,\n                max: 22\n            },\n            \"B2\": {\n                min: 8,\n                max: 25\n            },\n            \"C1\": {\n                min: 10,\n                max: 30\n            }\n        };\n        const range = lengthRanges[context.difficultyLevel];\n        let tooShortCount = 0;\n        let tooLongCount = 0;\n        for(let i = 0; i < dialogueLines.length; i++){\n            const line = dialogueLines[i].line;\n            const wordCount = line.split(/\\s+/).length;\n            if (wordCount < range.min) {\n                tooShortCount++;\n            } else if (wordCount > range.max) {\n                tooLongCount++;\n            }\n        }\n        if (tooShortCount > dialogueLines.length * 0.3) {\n            warnings.push(`${tooShortCount} lines may be too short for ${context.difficultyLevel} level`);\n        }\n        if (tooLongCount > dialogueLines.length * 0.3) {\n            warnings.push(`${tooLongCount} lines may be too long for ${context.difficultyLevel} level`);\n        }\n        // Check vocabulary complexity (requirement 3.3, 3.4, 3.5)\n        const vocabularyComplexityCheck = this.checkVocabularyComplexity(dialogueLines, context.difficultyLevel);\n        if (!vocabularyComplexityCheck.isAppropriate) {\n            warnings.push(...vocabularyComplexityCheck.warnings);\n        }\n        // Check grammar complexity (requirement 3.3, 3.4, 3.5)\n        const grammarComplexityCheck = this.checkGrammarComplexity(dialogueLines, context.difficultyLevel);\n        if (!grammarComplexityCheck.isAppropriate) {\n            warnings.push(...grammarComplexityCheck.warnings);\n        }\n        // Check vocabulary integration (requirement 3.7)\n        const vocabIntegrationCheck = this.checkVocabularyIntegration(dialogueLines, context.keyVocabulary);\n        if (!vocabIntegrationCheck.hasIntegration) {\n            warnings.push(\"Dialogue should incorporate lesson vocabulary words\");\n        }\n        // For fill-in-gap, check that there are gaps\n        if (type === \"fill-in-gap\") {\n            const gapCount = dialogueLines.filter((line)=>line.line.includes(\"_____\")).length;\n            if (gapCount < 3) {\n                warnings.push(`Fill-in-gap dialogue should have at least 3 gaps, found ${gapCount}`);\n            }\n        }\n        // Log warnings for visibility\n        if (warnings.length > 0) {\n            console.log(` Dialogue validation warnings:`, warnings);\n        }\n        return {\n            isValid: issues.length === 0,\n            issues\n        };\n    }\n    /**\r\n   * Check if vocabulary complexity matches CEFR level\r\n   */ checkVocabularyComplexity(dialogueLines, level) {\n        const warnings = [];\n        const allText = dialogueLines.map((line)=>line.line.toLowerCase()).join(\" \");\n        // Check for overly complex words at lower levels\n        if (level === \"A1\" || level === \"A2\") {\n            const complexWords = [\n                \"sophisticated\",\n                \"comprehensive\",\n                \"multifaceted\",\n                \"nuanced\",\n                \"intricate\",\n                \"elaborate\",\n                \"substantial\",\n                \"considerable\",\n                \"significant\",\n                \"fundamental\",\n                \"nevertheless\",\n                \"furthermore\",\n                \"consequently\",\n                \"subsequently\",\n                \"whereby\"\n            ];\n            const foundComplexWords = complexWords.filter((word)=>allText.includes(word));\n            if (foundComplexWords.length > 0) {\n                warnings.push(`Found complex vocabulary inappropriate for ${level}: ${foundComplexWords.join(\", \")}`);\n            }\n        }\n        // Check for overly simple vocabulary at higher levels\n        if (level === \"B2\" || level === \"C1\") {\n            const allWords = allText.split(/\\s+/);\n            const verySimpleWords = [\n                \"good\",\n                \"bad\",\n                \"nice\",\n                \"big\",\n                \"small\",\n                \"like\",\n                \"want\",\n                \"go\",\n                \"come\",\n                \"get\"\n            ];\n            const simpleWordCount = allWords.filter((word)=>verySimpleWords.includes(word)).length;\n            const simpleWordRatio = simpleWordCount / allWords.length;\n            if (simpleWordRatio > 0.15) {\n                warnings.push(`Vocabulary may be too simple for ${level} level (${Math.round(simpleWordRatio * 100)}% basic words)`);\n            }\n        }\n        return {\n            isAppropriate: warnings.length === 0,\n            warnings\n        };\n    }\n    /**\r\n   * Check if grammar complexity matches CEFR level\r\n   */ checkGrammarComplexity(dialogueLines, level) {\n        const warnings = [];\n        const allText = dialogueLines.map((line)=>line.line).join(\" \");\n        // Check for complex grammar at lower levels (should be avoided)\n        if (level === \"A1\" || level === \"A2\") {\n            // Check for present perfect (have/has + past participle)\n            if (/\\b(have|has)\\s+\\w+ed\\b/i.test(allText) || /\\b(have|has)\\s+(been|gone|done|seen|made)\\b/i.test(allText)) {\n                warnings.push(`Present perfect tense may be too complex for ${level} level`);\n            }\n            // Check for passive voice\n            if (/\\b(is|are|was|were|been)\\s+\\w+ed\\b/i.test(allText)) {\n                warnings.push(`Passive voice may be too complex for ${level} level`);\n            }\n        }\n        // Check for lack of complex grammar at higher levels (should be present)\n        if (level === \"B2\" || level === \"C1\") {\n            let hasComplexGrammar = false;\n            // Check for relative clauses\n            if (/\\b(which|that|who|whom|whose)\\b/i.test(allText)) {\n                hasComplexGrammar = true;\n            }\n            // Check for conditionals\n            if (/\\b(if|unless|provided|assuming)\\b.*\\b(would|could|might)\\b/i.test(allText)) {\n                hasComplexGrammar = true;\n            }\n            // Check for perfect tenses\n            if (/\\b(have|has|had)\\s+(been|gone|done|seen|made)\\b/i.test(allText)) {\n                hasComplexGrammar = true;\n            }\n            if (!hasComplexGrammar && dialogueLines.length >= 12) {\n                warnings.push(`Dialogue lacks complex grammar structures expected for ${level} level`);\n            }\n        }\n        return {\n            isAppropriate: warnings.length === 0,\n            warnings\n        };\n    }\n    /**\r\n   * Check if lesson vocabulary is integrated into dialogue\r\n   */ checkVocabularyIntegration(dialogueLines, vocabularyWords) {\n        const allText = dialogueLines.map((line)=>line.line.toLowerCase()).join(\" \");\n        const integratedWords = vocabularyWords.filter((word)=>allText.includes(word.toLowerCase()));\n        return {\n            hasIntegration: integratedWords.length >= 2,\n            integratedWords\n        };\n    }\n    /**\r\n   * Generate dialogue practice section with AI\r\n   */ async generateDialoguePracticeWithContext(context, previousSections) {\n        const maxAttempts = 2;\n        let attempt = 0;\n        const sectionStartTime = Date.now();\n        // Get vocabulary words from previous sections\n        const vocabularySection = previousSections.find((s)=>s.sectionName === \"vocabulary\");\n        const vocabularyWords = vocabularySection ? vocabularySection.content.filter((item)=>item.word !== \"INSTRUCTION\").map((item)=>item.word).slice(0, 5) : context.keyVocabulary.slice(0, 5);\n        while(attempt < maxAttempts){\n            attempt++;\n            console.log(` Generating dialogue practice (attempt ${attempt}/${maxAttempts})`);\n            try {\n                // Build enhanced prompt\n                const prompt = this.buildDialoguePrompt(context, vocabularyWords, \"practice\");\n                // Generate dialogue\n                const response = await this.getGoogleAI().prompt(prompt);\n                // Parse dialogue lines\n                const dialogueLines = response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.length > 0).map((line)=>{\n                    // Parse \"Speaker: text\" format\n                    const match = line.match(/^(Student|Tutor):\\s*(.+)$/i);\n                    if (match) {\n                        return {\n                            speaker: match[1].charAt(0).toUpperCase() + match[1].slice(1).toLowerCase(),\n                            text: match[2].trim()\n                        };\n                    }\n                    return null;\n                }).filter((line)=>line !== null);\n                // Validate dialogue using new validator\n                const validation = _section_validators__WEBPACK_IMPORTED_MODULE_2__.dialogueValidator.validate(dialogueLines, context.difficultyLevel, vocabularyWords);\n                if (!validation.isValid) {\n                    console.log(` Validation failed:`, validation.issues);\n                    if (attempt < maxAttempts) {\n                        console.log(` Retrying with adjusted prompt...`);\n                        continue;\n                    }\n                    console.log(` Using dialogue despite validation issues (max attempts reached)`);\n                } else {\n                    console.log(` Dialogue practice validated successfully (${dialogueLines.length} lines)`);\n                }\n                // Track quality metrics\n                const generationTime = Date.now() - sectionStartTime;\n                _quality_metrics__WEBPACK_IMPORTED_MODULE_3__.qualityMetricsTracker.recordSection(\"dialogue-practice\", validation.score, attempt, generationTime, validation.issues.length, validation.warnings.length);\n                // Generate follow-up questions\n                const followUpPrompt = `Create 3 follow-up discussion questions for ${context.difficultyLevel} level students about the dialogue topic. Return only questions, one per line:`;\n                const followUpResponse = await this.getGoogleAI().prompt(followUpPrompt);\n                const followUpQuestions = followUpResponse.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.endsWith(\"?\") && line.length > 10).slice(0, 3);\n                // Convert back to original format for compatibility\n                const formattedDialogue = dialogueLines.map((line)=>({\n                        character: line.speaker,\n                        line: line.text\n                    }));\n                return {\n                    instruction: \"Practice this conversation with your tutor:\",\n                    dialogue: formattedDialogue,\n                    followUpQuestions: followUpQuestions.length >= 3 ? followUpQuestions : [\n                        \"What did you learn from this conversation?\",\n                        \"How would you continue this discussion?\",\n                        \"What questions would you ask next?\"\n                    ]\n                };\n            } catch (error) {\n                console.error(` Attempt ${attempt} failed:`, error);\n                if (attempt >= maxAttempts) {\n                    // Track failed generation\n                    _quality_metrics__WEBPACK_IMPORTED_MODULE_3__.qualityMetricsTracker.recordSection(\"dialogue-practice\", 0, attempt, Date.now() - sectionStartTime, 1, 0);\n                    throw new Error(\"Failed to generate dialogue practice: \" + error.message);\n                }\n            }\n        }\n        throw new Error(\"Failed to generate dialogue practice after all attempts\");\n    }\n    /**\r\n   * Generate dialogue fill-in-gap section with AI\r\n   */ async generateDialogueFillGapWithContext(context, previousSections) {\n        const maxAttempts = 2;\n        let attempt = 0;\n        // Get vocabulary words from previous sections\n        const vocabularySection = previousSections.find((s)=>s.sectionName === \"vocabulary\");\n        const vocabularyWords = vocabularySection ? vocabularySection.content.filter((item)=>item.word !== \"INSTRUCTION\").map((item)=>item.word).slice(0, 5) : context.keyVocabulary.slice(0, 5);\n        while(attempt < maxAttempts){\n            attempt++;\n            console.log(` Generating dialogue fill-in-gap (attempt ${attempt}/${maxAttempts})`);\n            try {\n                // Build enhanced prompt\n                const prompt = this.buildDialoguePrompt(context, vocabularyWords, \"fill-in-gap\");\n                // Generate dialogue\n                const response = await this.getGoogleAI().prompt(prompt);\n                // Parse dialogue lines and extract answers\n                const dialogueLines = [];\n                const answers = [];\n                response.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.length > 0).forEach((line)=>{\n                    // Parse \"Speaker: text\" format\n                    const match = line.match(/^(Student|Tutor):\\s*(.+)$/i);\n                    if (match) {\n                        const character = match[1].charAt(0).toUpperCase() + match[1].slice(1).toLowerCase();\n                        const text = match[2].trim();\n                        // Check if line has gaps\n                        const hasGap = text.includes(\"_____\");\n                        if (hasGap) {\n                            // Extract the missing word(s) - this is a simplified approach\n                            // In a real scenario, we'd need the AI to provide answers separately\n                            dialogueLines.push({\n                                character,\n                                line: text,\n                                isGap: true\n                            });\n                        // Try to infer what word should go in the gap (simplified)\n                        // For now, we'll ask AI to provide answers separately\n                        } else {\n                            dialogueLines.push({\n                                character,\n                                line: text\n                            });\n                        }\n                    }\n                });\n                // Generate answers for the gaps\n                const gapCount = dialogueLines.filter((line)=>line.isGap).length;\n                if (gapCount > 0) {\n                    const answersPrompt = `For the dialogue with ${gapCount} gaps marked with _____, provide the missing words. Return only the words, one per line, in order:`;\n                    try {\n                        const answersResponse = await this.getGoogleAI().prompt(answersPrompt);\n                        const extractedAnswers = answersResponse.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.length > 0).slice(0, gapCount);\n                        answers.push(...extractedAnswers);\n                    } catch (error) {\n                        console.log(\" Failed to extract answers, using placeholders\");\n                        for(let i = 0; i < gapCount; i++){\n                            answers.push(\"[answer]\");\n                        }\n                    }\n                }\n                // Validate dialogue\n                const validation = this.validateDialogue(dialogueLines, context, \"fill-in-gap\");\n                if (!validation.isValid) {\n                    console.log(` Validation failed:`, validation.issues);\n                    if (attempt < maxAttempts) {\n                        console.log(` Retrying with adjusted prompt...`);\n                        continue;\n                    }\n                    console.log(` Using dialogue despite validation issues (max attempts reached)`);\n                } else {\n                    console.log(` Dialogue fill-in-gap validated successfully (${dialogueLines.length} lines)`);\n                }\n                return {\n                    instruction: \"Fill in the gaps in this conversation:\",\n                    dialogue: dialogueLines,\n                    answers: answers.length > 0 ? answers : [\n                        \"answer1\",\n                        \"answer2\",\n                        \"answer3\"\n                    ]\n                };\n            } catch (error) {\n                console.error(` Attempt ${attempt} failed:`, error);\n                if (attempt >= maxAttempts) {\n                    throw new Error(\"Failed to generate dialogue fill-in-gap: \" + error.message);\n                }\n            }\n        }\n        throw new Error(\"Failed to generate dialogue fill-in-gap after all attempts\");\n    }\n    // Fallback methods for when AI extraction fails\n    extractVocabularyFallback(sourceText, _studentLevel) {\n        const words = sourceText.toLowerCase().match(/\\b[a-z]{4,12}\\b/g) || [];\n        const commonWords = [\n            \"the\",\n            \"and\",\n            \"that\",\n            \"have\",\n            \"for\",\n            \"not\",\n            \"with\",\n            \"you\",\n            \"this\",\n            \"but\",\n            \"his\",\n            \"from\",\n            \"they\"\n        ];\n        const filteredWords = words.filter((word)=>!commonWords.includes(word)).filter((word, index, arr)=>arr.indexOf(word) === index).slice(0, 8);\n        return filteredWords.length >= 4 ? filteredWords : [\n            \"communication\",\n            \"important\",\n            \"different\",\n            \"example\",\n            \"information\",\n            \"situation\"\n        ];\n    }\n    extractThemesFallback(sourceText) {\n        const text = sourceText.toLowerCase();\n        const themes = [];\n        // Look for common themes\n        if (text.includes(\"sport\") || text.includes(\"game\") || text.includes(\"team\")) themes.push(\"sports\");\n        if (text.includes(\"business\") || text.includes(\"company\") || text.includes(\"work\")) themes.push(\"business\");\n        if (text.includes(\"travel\") || text.includes(\"country\") || text.includes(\"culture\")) themes.push(\"travel\");\n        if (text.includes(\"technology\") || text.includes(\"computer\") || text.includes(\"internet\")) themes.push(\"technology\");\n        if (text.includes(\"health\") || text.includes(\"medical\") || text.includes(\"doctor\")) themes.push(\"health\");\n        return themes.length > 0 ? themes : [\n            \"general topic\",\n            \"communication\",\n            \"daily life\"\n        ];\n    }\n    extractThemesFromText(text) {\n        return this.extractThemesFallback(text);\n    }\n    capitalizeWord(word) {\n        return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUltTixLQUFLdFEsUUFBUSxDQUFDLGFBQWFzUSxLQUFLdFEsUUFBUSxDQUFDLGNBQWNzUSxLQUFLdFEsUUFBUSxDQUFDLFlBQVl5RixPQUFPdEMsSUFBSSxDQUFDO1FBQ2pHLElBQUltTixLQUFLdFEsUUFBUSxDQUFDLGlCQUFpQnNRLEtBQUt0USxRQUFRLENBQUMsZUFBZXNRLEtBQUt0USxRQUFRLENBQUMsYUFBYXlGLE9BQU90QyxJQUFJLENBQUM7UUFDdkcsSUFBSW1OLEtBQUt0USxRQUFRLENBQUMsYUFBYXNRLEtBQUt0USxRQUFRLENBQUMsY0FBY3NRLEtBQUt0USxRQUFRLENBQUMsV0FBV3lGLE9BQU90QyxJQUFJLENBQUM7UUFFaEcsT0FBT3NDLE9BQU8vRCxNQUFNLEdBQUcsSUFBSStELFNBQVM7WUFBQztZQUFpQjtZQUFpQjtTQUFhO0lBQ3RGO0lBRVF4QixzQkFBc0JxTSxJQUFZLEVBQVk7UUFDcEQsT0FBTyxJQUFJLENBQUMzSyxxQkFBcUIsQ0FBQzJLO0lBQ3BDO0lBRVFsRyxlQUFldEcsSUFBWSxFQUFVO1FBQzNDLE9BQU9BLEtBQUtpQixNQUFNLENBQUMsR0FBR0MsV0FBVyxLQUFLbEIsS0FBS21CLEtBQUssQ0FBQyxHQUFHMUUsV0FBVztJQUNqRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktdjAtcHJvamVjdC8uL2xpYi9wcm9ncmVzc2l2ZS1nZW5lcmF0b3IudHM/ZTk2YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVHb29nbGVBSVNlcnZlclNlcnZpY2UgfSBmcm9tIFwiLi9nb29nbGUtYWktc2VydmVyXCJcclxuaW1wb3J0IHsgV2FybXVwVmFsaWRhdG9yIH0gZnJvbSBcIi4vd2FybXVwLXZhbGlkYXRvclwiXHJcbmltcG9ydCB7XHJcbiAgZGlhbG9ndWVWYWxpZGF0b3IsXHJcbiAgZGlzY3Vzc2lvblZhbGlkYXRvcixcclxuICBncmFtbWFyVmFsaWRhdG9yLFxyXG4gIHByb251bmNpYXRpb25WYWxpZGF0b3IsXHJcbiAgdHlwZSBWYWxpZGF0aW9uUmVzdWx0XHJcbn0gZnJvbSBcIi4vc2VjdGlvbi12YWxpZGF0b3JzXCJcclxuaW1wb3J0IHsgcXVhbGl0eU1ldHJpY3NUcmFja2VyIH0gZnJvbSBcIi4vcXVhbGl0eS1tZXRyaWNzXCJcclxuXHJcbi8vIFByb2dyZXNzIHRyYWNraW5nIHR5cGVzXHJcbmV4cG9ydCBpbnRlcmZhY2UgUHJvZ3Jlc3NVcGRhdGUge1xyXG4gIHN0ZXA6IHN0cmluZyAgICAgICAgICAgLy8gSHVtYW4tcmVhZGFibGUgc3RlcCBuYW1lIChlLmcuLCBcIkdlbmVyYXRpbmcgdm9jYWJ1bGFyeVwiKVxyXG4gIHByb2dyZXNzOiBudW1iZXIgICAgICAgLy8gUGVyY2VudGFnZSBjb21wbGV0ZSAoMC0xMDApXHJcbiAgcGhhc2U6IHN0cmluZyAgICAgICAgICAvLyBQaGFzZSBpZGVudGlmaWVyIChlLmcuLCBcInZvY2FidWxhcnlcIiwgXCJyZWFkaW5nXCIpXHJcbiAgc2VjdGlvbj86IHN0cmluZyAgICAgICAvLyBPcHRpb25hbCBzZWN0aW9uIGlkZW50aWZpZXIgZm9yIG11bHRpLXBhcnQgcGhhc2VzXHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIFByb2dyZXNzQ2FsbGJhY2sgPSAodXBkYXRlOiBQcm9ncmVzc1VwZGF0ZSkgPT4gdm9pZFxyXG5cclxuLy8gR2VuZXJhdGlvbiBvcHRpb25zIGludGVyZmFjZVxyXG5leHBvcnQgaW50ZXJmYWNlIEdlbmVyYXRlT3B0aW9ucyB7XHJcbiAgY29udGVudDogc3RyaW5nXHJcbiAgbGV2ZWw6IENFRlJMZXZlbFxyXG4gIGxlc3NvblR5cGU6IHN0cmluZ1xyXG4gIHRhcmdldExhbmd1YWdlPzogc3RyaW5nXHJcbiAgbWV0YWRhdGE/OiBhbnlcclxuICBvblByb2dyZXNzPzogUHJvZ3Jlc3NDYWxsYmFjayAgLy8gT3B0aW9uYWwgY2FsbGJhY2sgZm9yIHByb2dyZXNzIHRyYWNraW5nXHJcbn1cclxuXHJcbi8vIFR5cGVzIGZvciBwcm9ncmVzc2l2ZSBnZW5lcmF0aW9uXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2hhcmVkQ29udGV4dCB7XHJcbiAgbGVzc29uVGl0bGU6IHN0cmluZ1xyXG4gIGtleVZvY2FidWxhcnk6IHN0cmluZ1tdXHJcbiAgbWFpblRoZW1lczogc3RyaW5nW11cclxuICBkaWZmaWN1bHR5TGV2ZWw6IENFRlJMZXZlbFxyXG4gIGNvbnRlbnRTdW1tYXJ5OiBzdHJpbmdcclxuICBzb3VyY2VUZXh0OiBzdHJpbmdcclxuICBsZXNzb25UeXBlOiBzdHJpbmdcclxuICB0YXJnZXRMYW5ndWFnZTogc3RyaW5nXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgR2VuZXJhdGVkU2VjdGlvbiB7XHJcbiAgc2VjdGlvbk5hbWU6IHN0cmluZ1xyXG4gIGNvbnRlbnQ6IGFueVxyXG4gIHRva2Vuc1VzZWQ6IG51bWJlclxyXG4gIGdlbmVyYXRpb25TdHJhdGVneTogc3RyaW5nXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgTGVzc29uU2VjdGlvbiB7XHJcbiAgbmFtZTogc3RyaW5nXHJcbiAgcHJpb3JpdHk6IG51bWJlclxyXG4gIGRlcGVuZGVuY2llczogc3RyaW5nW11cclxufVxyXG5cclxuZXhwb3J0IHR5cGUgQ0VGUkxldmVsID0gJ0ExJyB8ICdBMicgfCAnQjEnIHwgJ0IyJyB8ICdDMSdcclxuXHJcbi8vIFBoYXNlIHdlaWdodCBjb25maWd1cmF0aW9uIGZvciBwcm9wb3J0aW9uYWwgcHJvZ3Jlc3MgY2FsY3VsYXRpb25cclxuZXhwb3J0IGludGVyZmFjZSBQaGFzZVdlaWdodHMge1xyXG4gIFtwaGFzZTogc3RyaW5nXTogbnVtYmVyXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1BIQVNFX1dFSUdIVFM6IFBoYXNlV2VpZ2h0cyA9IHtcclxuICB3YXJtdXA6IDEwLFxyXG4gIHZvY2FidWxhcnk6IDE1LFxyXG4gIHJlYWRpbmc6IDIwLFxyXG4gIGNvbXByZWhlbnNpb246IDEwLFxyXG4gIGRpc2N1c3Npb246IDEwLFxyXG4gIGRpYWxvZ3VlOiAxNSxcclxuICBncmFtbWFyOiAxNSxcclxuICBwcm9udW5jaWF0aW9uOiAxNSxcclxuICB3cmFwdXA6IDVcclxufVxyXG5cclxuLyoqXHJcbiAqIFNhZmUgd3JhcHBlciBmb3IgcHJvZ3Jlc3MgY2FsbGJhY2tzIHRoYXQgaXNvbGF0ZXMgZXJyb3JzXHJcbiAqIEVuc3VyZXMgY2FsbGJhY2sgZmFpbHVyZXMgZG9uJ3QgYnJlYWsgdGhlIGdlbmVyYXRpb24gcHJvY2Vzc1xyXG4gKiBcclxuICogQHBhcmFtIGNhbGxiYWNrIC0gT3B0aW9uYWwgcHJvZ3Jlc3MgY2FsbGJhY2sgZnVuY3Rpb25cclxuICogQHBhcmFtIHVwZGF0ZSAtIFByb2dyZXNzIHVwZGF0ZSBkYXRhIHRvIHNlbmQgdG8gY2FsbGJhY2tcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBzYWZlUHJvZ3Jlc3NDYWxsYmFjayhcclxuICBjYWxsYmFjazogUHJvZ3Jlc3NDYWxsYmFjayB8IHVuZGVmaW5lZCxcclxuICB1cGRhdGU6IFByb2dyZXNzVXBkYXRlXHJcbik6IHZvaWQge1xyXG4gIC8vIElmIG5vIGNhbGxiYWNrIHByb3ZpZGVkLCBkbyBub3RoaW5nXHJcbiAgaWYgKCFjYWxsYmFjaykge1xyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgLy8gSW52b2tlIHRoZSBjYWxsYmFjayB3aXRoIHRoZSBwcm9ncmVzcyB1cGRhdGVcclxuICAgIGNhbGxiYWNrKHVwZGF0ZSlcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgLy8gTG9nIGVycm9yIGJ1dCBkb24ndCB0aHJvdyAtIGdlbmVyYXRpb24gc2hvdWxkIGNvbnRpbnVlXHJcbiAgICBjb25zb2xlLmVycm9yKCdQcm9ncmVzcyBjYWxsYmFjayBlcnJvcjonLCBlcnJvcilcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1Byb2dyZXNzIHVwZGF0ZSB0aGF0IGNhdXNlZCBlcnJvcjonLCB1cGRhdGUpXHJcbiAgICBcclxuICAgIC8vIE9wdGlvbmFsbHkgbG9nIHN0YWNrIHRyYWNlIGZvciBkZWJ1Z2dpbmdcclxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLnN0YWNrKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1N0YWNrIHRyYWNlOicsIGVycm9yLnN0YWNrKVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLy8gUHJvZ3Jlc3NpdmUgR2VuZXJhdG9yIEludGVyZmFjZVxyXG5leHBvcnQgaW50ZXJmYWNlIFByb2dyZXNzaXZlR2VuZXJhdG9yIHtcclxuICBnZW5lcmF0ZVNlY3Rpb24oXHJcbiAgICBzZWN0aW9uOiBMZXNzb25TZWN0aW9uLFxyXG4gICAgc2hhcmVkQ29udGV4dDogU2hhcmVkQ29udGV4dCxcclxuICAgIHByZXZpb3VzU2VjdGlvbnM6IEdlbmVyYXRlZFNlY3Rpb25bXVxyXG4gICk6IFByb21pc2U8R2VuZXJhdGVkU2VjdGlvbj5cclxuXHJcbiAgYnVpbGRTaGFyZWRDb250ZXh0KFxyXG4gICAgc291cmNlVGV4dDogc3RyaW5nLFxyXG4gICAgbGVzc29uVHlwZTogc3RyaW5nLFxyXG4gICAgc3R1ZGVudExldmVsOiBDRUZSTGV2ZWwsXHJcbiAgICB0YXJnZXRMYW5ndWFnZTogc3RyaW5nXHJcbiAgKTogUHJvbWlzZTxTaGFyZWRDb250ZXh0PlxyXG5cclxuICB1cGRhdGVDb250ZXh0KFxyXG4gICAgY29udGV4dDogU2hhcmVkQ29udGV4dCxcclxuICAgIG5ld1NlY3Rpb246IEdlbmVyYXRlZFNlY3Rpb25cclxuICApOiBTaGFyZWRDb250ZXh0XHJcbn1cclxuXHJcbi8vIEltcGxlbWVudGF0aW9uIG9mIFByb2dyZXNzaXZlIEdlbmVyYXRvclxyXG5leHBvcnQgY2xhc3MgUHJvZ3Jlc3NpdmVHZW5lcmF0b3JJbXBsIGltcGxlbWVudHMgUHJvZ3Jlc3NpdmVHZW5lcmF0b3Ige1xyXG4gIHByaXZhdGUgZ29vZ2xlQUk6IFJldHVyblR5cGU8dHlwZW9mIGNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZT4gfCBudWxsID0gbnVsbFxyXG4gIHByaXZhdGUgd2FybXVwVmFsaWRhdG9yOiBXYXJtdXBWYWxpZGF0b3JcclxuICBwcml2YXRlIHByb2dyZXNzQ2FsbGJhY2s/OiBQcm9ncmVzc0NhbGxiYWNrXHJcbiAgcHJpdmF0ZSBjb21wbGV0ZWRTZWN0aW9uczogc3RyaW5nW10gPSBbXVxyXG4gIHByaXZhdGUgY3VycmVudExlc3NvblR5cGU6IHN0cmluZyA9ICcnXHJcbiAgcHJpdmF0ZSBwaGFzZVdlaWdodHM6IFBoYXNlV2VpZ2h0cyA9IERFRkFVTFRfUEhBU0VfV0VJR0hUU1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMud2FybXVwVmFsaWRhdG9yID0gbmV3IFdhcm11cFZhbGlkYXRvcigpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXQgdGhlIHByb2dyZXNzIGNhbGxiYWNrIGZvciB0aGlzIGdlbmVyYXRvciBpbnN0YW5jZVxyXG4gICAqIFNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIHN0YXJ0aW5nIGdlbmVyYXRpb25cclxuICAgKi9cclxuICBzZXRQcm9ncmVzc0NhbGxiYWNrKGNhbGxiYWNrOiBQcm9ncmVzc0NhbGxiYWNrIHwgdW5kZWZpbmVkLCBsZXNzb25UeXBlOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIHRoaXMucHJvZ3Jlc3NDYWxsYmFjayA9IGNhbGxiYWNrXHJcbiAgICB0aGlzLmN1cnJlbnRMZXNzb25UeXBlID0gbGVzc29uVHlwZVxyXG4gICAgdGhpcy5jb21wbGV0ZWRTZWN0aW9ucyA9IFtdXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgcXVhbGl0eSBtZXRyaWNzIGZvciB0aGUgY3VycmVudCBsZXNzb24gZ2VuZXJhdGlvblxyXG4gICAqL1xyXG4gIGdldFF1YWxpdHlNZXRyaWNzKCkge1xyXG4gICAgcmV0dXJuIHF1YWxpdHlNZXRyaWNzVHJhY2tlci5nZXRRdWFsaXR5UmVwb3J0KClcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIExvZyBxdWFsaXR5IHN1bW1hcnkgZm9yIHRoZSBsZXNzb25cclxuICAgKi9cclxuICBsb2dRdWFsaXR5U3VtbWFyeSgpIHtcclxuICAgIHF1YWxpdHlNZXRyaWNzVHJhY2tlci5sb2dTdW1tYXJ5KClcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc2V0IHF1YWxpdHkgbWV0cmljcyBmb3IgbmV3IGxlc3NvbiBnZW5lcmF0aW9uXHJcbiAgICovXHJcbiAgcmVzZXRRdWFsaXR5TWV0cmljcygpIHtcclxuICAgIHF1YWxpdHlNZXRyaWNzVHJhY2tlci5yZXNldCgpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEdvb2dsZUFJKCkge1xyXG4gICAgaWYgKCF0aGlzLmdvb2dsZUFJKSB7XHJcbiAgICAgIHRoaXMuZ29vZ2xlQUkgPSBjcmVhdGVHb29nbGVBSVNlcnZlclNlcnZpY2UoKVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMuZ29vZ2xlQUlcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGN1bGF0ZSBwcm9ncmVzcyBwZXJjZW50YWdlIGJhc2VkIG9uIHBoYXNlIHdlaWdodHMgYW5kIGxlc3NvbiB0eXBlXHJcbiAgICogSGFuZGxlcyBkaWZmZXJlbnQgbGVzc29uIHR5cGVzIHdpdGggdmFyeWluZyBzZWN0aW9uIGNvbWJpbmF0aW9uc1xyXG4gICAqL1xyXG4gIGNhbGN1bGF0ZVByb2dyZXNzKFxyXG4gICAgY29tcGxldGVkU2VjdGlvbnM6IHN0cmluZ1tdLFxyXG4gICAgY3VycmVudFNlY3Rpb246IHN0cmluZyxcclxuICAgIGxlc3NvblR5cGU6IHN0cmluZyxcclxuICAgIHBoYXNlV2VpZ2h0czogUGhhc2VXZWlnaHRzID0gREVGQVVMVF9QSEFTRV9XRUlHSFRTXHJcbiAgKTogbnVtYmVyIHtcclxuICAgIC8vIERldGVybWluZSB3aGljaCBzZWN0aW9ucyBhcmUgaW5jbHVkZWQgaW4gdGhpcyBsZXNzb24gdHlwZVxyXG4gICAgY29uc3QgYWN0aXZlU2VjdGlvbnMgPSB0aGlzLmdldEFjdGl2ZVNlY3Rpb25zRm9yTGVzc29uVHlwZShsZXNzb25UeXBlKVxyXG4gICAgXHJcbiAgICAvLyBDYWxjdWxhdGUgdG90YWwgd2VpZ2h0IGZvciBhY3RpdmUgc2VjdGlvbnMgb25seVxyXG4gICAgY29uc3QgdG90YWxXZWlnaHQgPSBhY3RpdmVTZWN0aW9ucy5yZWR1Y2UoKHN1bSwgc2VjdGlvbikgPT4ge1xyXG4gICAgICByZXR1cm4gc3VtICsgKHBoYXNlV2VpZ2h0c1tzZWN0aW9uXSB8fCAwKVxyXG4gICAgfSwgMClcclxuICAgIFxyXG4gICAgaWYgKHRvdGFsV2VpZ2h0ID09PSAwKSB7XHJcbiAgICAgIHJldHVybiAwXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIERlZHVwbGljYXRlIGNvbXBsZXRlZCBzZWN0aW9ucyB0byBhdm9pZCBjb3VudGluZyB0aGUgc2FtZSBzZWN0aW9uIG11bHRpcGxlIHRpbWVzXHJcbiAgICBjb25zdCB1bmlxdWVDb21wbGV0ZWRTZWN0aW9ucyA9IEFycmF5LmZyb20obmV3IFNldChjb21wbGV0ZWRTZWN0aW9ucykpXHJcbiAgICBcclxuICAgIC8vIENhbGN1bGF0ZSB3ZWlnaHQgb2YgY29tcGxldGVkIHNlY3Rpb25zXHJcbiAgICBjb25zdCBjb21wbGV0ZWRXZWlnaHQgPSB1bmlxdWVDb21wbGV0ZWRTZWN0aW9ucy5yZWR1Y2UoKHN1bSwgc2VjdGlvbikgPT4ge1xyXG4gICAgICBpZiAoYWN0aXZlU2VjdGlvbnMuaW5jbHVkZXMoc2VjdGlvbikpIHtcclxuICAgICAgICByZXR1cm4gc3VtICsgKHBoYXNlV2VpZ2h0c1tzZWN0aW9uXSB8fCAwKVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBzdW1cclxuICAgIH0sIDApXHJcbiAgICBcclxuICAgIC8vIENhbGN1bGF0ZSBwcm9ncmVzcyBwZXJjZW50YWdlXHJcbiAgICBjb25zdCBwcm9ncmVzcyA9IE1hdGgucm91bmQoKGNvbXBsZXRlZFdlaWdodCAvIHRvdGFsV2VpZ2h0KSAqIDEwMClcclxuICAgIFxyXG4gICAgcmV0dXJuIE1hdGgubWluKHByb2dyZXNzLCAxMDApXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgdGhlIGxpc3Qgb2YgYWN0aXZlIHNlY3Rpb25zIGZvciBhIGdpdmVuIGxlc3NvbiB0eXBlXHJcbiAgICogRGlmZmVyZW50IGxlc3NvbiB0eXBlcyBpbmNsdWRlIGRpZmZlcmVudCBzZWN0aW9uc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0QWN0aXZlU2VjdGlvbnNGb3JMZXNzb25UeXBlKGxlc3NvblR5cGU6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIC8vIEJhc2Ugc2VjdGlvbnMgaW5jbHVkZWQgaW4gYWxsIGxlc3NvbiB0eXBlc1xyXG4gICAgY29uc3QgYmFzZVNlY3Rpb25zID0gWyd3YXJtdXAnLCAndm9jYWJ1bGFyeScsICdyZWFkaW5nJywgJ2NvbXByZWhlbnNpb24nLCAnd3JhcHVwJ11cclxuICAgIFxyXG4gICAgLy8gQWRkaXRpb25hbCBzZWN0aW9ucyBiYXNlZCBvbiBsZXNzb24gdHlwZVxyXG4gICAgY29uc3QgbGVzc29uVHlwZU1hcDogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0ge1xyXG4gICAgICAnZGlzY3Vzc2lvbic6IFsuLi5iYXNlU2VjdGlvbnMsICdkaXNjdXNzaW9uJ10sXHJcbiAgICAgICdncmFtbWFyJzogWy4uLmJhc2VTZWN0aW9ucywgJ2dyYW1tYXInXSxcclxuICAgICAgJ3Byb251bmNpYXRpb24nOiBbLi4uYmFzZVNlY3Rpb25zLCAncHJvbnVuY2lhdGlvbiddLFxyXG4gICAgICAndHJhdmVsJzogWy4uLmJhc2VTZWN0aW9ucywgJ2RpYWxvZ3VlJ10sXHJcbiAgICAgICdidXNpbmVzcyc6IFsuLi5iYXNlU2VjdGlvbnMsICdkaWFsb2d1ZSddLFxyXG4gICAgICAnZGlhbG9ndWUnOiBbLi4uYmFzZVNlY3Rpb25zLCAnZGlhbG9ndWUnXVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBSZXR1cm4gc2VjdGlvbnMgZm9yIHRoZSBzcGVjaWZpYyBsZXNzb24gdHlwZSwgb3IgYmFzZSBzZWN0aW9ucyBpZiB0eXBlIG5vdCBmb3VuZFxyXG4gICAgcmV0dXJuIGxlc3NvblR5cGVNYXBbbGVzc29uVHlwZS50b0xvd2VyQ2FzZSgpXSB8fCBiYXNlU2VjdGlvbnNcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEJ1aWxkIHNoYXJlZCBjb250ZXh0IHRoYXQgd2lsbCBiZSByZXVzZWQgYWNyb3NzIGFsbCBsZXNzb24gc2VjdGlvbnNcclxuICAgKi9cclxuICBhc3luYyBidWlsZFNoYXJlZENvbnRleHQoXHJcbiAgICBzb3VyY2VUZXh0OiBzdHJpbmcsXHJcbiAgICBsZXNzb25UeXBlOiBzdHJpbmcsXHJcbiAgICBzdHVkZW50TGV2ZWw6IENFRlJMZXZlbCxcclxuICAgIHRhcmdldExhbmd1YWdlOiBzdHJpbmcsXHJcbiAgICBtZXRhZGF0YT86IGFueVxyXG4gICk6IFByb21pc2U8U2hhcmVkQ29udGV4dD4ge1xyXG4gICAgY29uc29sZS5sb2coXCLwn4+X77iPIEJ1aWxkaW5nIHNoYXJlZCBjb250ZXh0IGZvciBwcm9ncmVzc2l2ZSBnZW5lcmF0aW9uLi4uXCIpXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gR2VuZXJhdGUgY29udGV4dHVhbCBsZXNzb24gdGl0bGUgKHdpdGggZmFsbGJhY2sgdG8gbWV0YWRhdGEpXHJcbiAgICAgIGNvbnN0IGxlc3NvblRpdGxlID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUxlc3NvblRpdGxlKHNvdXJjZVRleHQsIGxlc3NvblR5cGUsIHN0dWRlbnRMZXZlbCwgbWV0YWRhdGEpXHJcblxyXG4gICAgICAvLyBFeHRyYWN0IGtleSB2b2NhYnVsYXJ5IHVzaW5nIEFJIG9wdGltaXphdGlvblxyXG4gICAgICBjb25zdCBrZXlWb2NhYnVsYXJ5ID0gYXdhaXQgdGhpcy5leHRyYWN0S2V5Vm9jYWJ1bGFyeShzb3VyY2VUZXh0LCBzdHVkZW50TGV2ZWwpXHJcblxyXG4gICAgICAvLyBFeHRyYWN0IG1haW4gdGhlbWVzXHJcbiAgICAgIGNvbnN0IG1haW5UaGVtZXMgPSBhd2FpdCB0aGlzLmV4dHJhY3RNYWluVGhlbWVzKHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbClcclxuXHJcbiAgICAgIC8vIENyZWF0ZSBjb250ZW50IHN1bW1hcnlcclxuICAgICAgY29uc3QgY29udGVudFN1bW1hcnkgPSBhd2FpdCB0aGlzLmNyZWF0ZUNvbnRlbnRTdW1tYXJ5KHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbClcclxuXHJcbiAgICAgIGNvbnN0IHNoYXJlZENvbnRleHQ6IFNoYXJlZENvbnRleHQgPSB7XHJcbiAgICAgICAgbGVzc29uVGl0bGUsXHJcbiAgICAgICAga2V5Vm9jYWJ1bGFyeSxcclxuICAgICAgICBtYWluVGhlbWVzLFxyXG4gICAgICAgIGRpZmZpY3VsdHlMZXZlbDogc3R1ZGVudExldmVsLFxyXG4gICAgICAgIGNvbnRlbnRTdW1tYXJ5LFxyXG4gICAgICAgIHNvdXJjZVRleHQ6IHNvdXJjZVRleHQuc3Vic3RyaW5nKDAsIDEwMDApLCAvLyBMaW1pdCBmb3IgdG9rZW4gb3B0aW1pemF0aW9uXHJcbiAgICAgICAgbGVzc29uVHlwZSxcclxuICAgICAgICB0YXJnZXRMYW5ndWFnZVxyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhcIuKchSBTaGFyZWQgY29udGV4dCBidWlsdDpcIiwge1xyXG4gICAgICAgIGxlc3NvblRpdGxlLFxyXG4gICAgICAgIHZvY2FidWxhcnlDb3VudDoga2V5Vm9jYWJ1bGFyeS5sZW5ndGgsXHJcbiAgICAgICAgdGhlbWVzQ291bnQ6IG1haW5UaGVtZXMubGVuZ3RoLFxyXG4gICAgICAgIHN1bW1hcnlMZW5ndGg6IGNvbnRlbnRTdW1tYXJ5Lmxlbmd0aFxyXG4gICAgICB9KVxyXG5cclxuICAgICAgcmV0dXJuIHNoYXJlZENvbnRleHRcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgRmFpbGVkIHRvIGJ1aWxkIHNoYXJlZCBjb250ZXh0OlwiLCBlcnJvcilcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGJ1aWxkIHNoYXJlZCBjb250ZXh0OiBcIiArIChlcnJvciBhcyBFcnJvcikubWVzc2FnZSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdlbmVyYXRlIGEgc3BlY2lmaWMgbGVzc29uIHNlY3Rpb24gdXNpbmcgc2hhcmVkIGNvbnRleHRcclxuICAgKiBOb3cgaW5jbHVkZXMgcXVhbGl0eSB2YWxpZGF0aW9uIGFuZCBtZXRyaWNzIHRyYWNraW5nXHJcbiAgICovXHJcbiAgYXN5bmMgZ2VuZXJhdGVTZWN0aW9uKFxyXG4gICAgc2VjdGlvbjogTGVzc29uU2VjdGlvbixcclxuICAgIHNoYXJlZENvbnRleHQ6IFNoYXJlZENvbnRleHQsXHJcbiAgICBwcmV2aW91c1NlY3Rpb25zOiBHZW5lcmF0ZWRTZWN0aW9uW11cclxuICApOiBQcm9taXNlPEdlbmVyYXRlZFNlY3Rpb24+IHtcclxuICAgIGNvbnNvbGUubG9nKGDwn46vIEdlbmVyYXRpbmcgc2VjdGlvbjogJHtzZWN0aW9uLm5hbWV9YClcclxuXHJcbiAgICAvLyBSZXBvcnQgcHJvZ3Jlc3MgYXQgc3RhcnQgb2Ygc2VjdGlvbiBnZW5lcmF0aW9uXHJcbiAgICBjb25zdCBzdGFydFByb2dyZXNzID0gdGhpcy5jYWxjdWxhdGVQcm9ncmVzcyhcclxuICAgICAgdGhpcy5jb21wbGV0ZWRTZWN0aW9ucyxcclxuICAgICAgc2VjdGlvbi5uYW1lLFxyXG4gICAgICB0aGlzLmN1cnJlbnRMZXNzb25UeXBlIHx8IHNoYXJlZENvbnRleHQubGVzc29uVHlwZSxcclxuICAgICAgdGhpcy5waGFzZVdlaWdodHNcclxuICAgIClcclxuICAgIFxyXG4gICAgc2FmZVByb2dyZXNzQ2FsbGJhY2sodGhpcy5wcm9ncmVzc0NhbGxiYWNrLCB7XHJcbiAgICAgIHN0ZXA6IGBHZW5lcmF0aW5nICR7c2VjdGlvbi5uYW1lfWAsXHJcbiAgICAgIHByb2dyZXNzOiBzdGFydFByb2dyZXNzLFxyXG4gICAgICBwaGFzZTogc2VjdGlvbi5uYW1lLFxyXG4gICAgICBzZWN0aW9uOiBzZWN0aW9uLm5hbWVcclxuICAgIH0pXHJcblxyXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKVxyXG4gICAgbGV0IGNvbnRlbnQ6IGFueVxyXG4gICAgbGV0IHRva2Vuc1VzZWQgPSAwXHJcbiAgICBsZXQgZ2VuZXJhdGlvblN0cmF0ZWd5ID0gJ3Byb2dyZXNzaXZlJ1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIHN3aXRjaCAoc2VjdGlvbi5uYW1lKSB7XHJcbiAgICAgICAgY2FzZSAnd2FybXVwJzpcclxuICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB0aGlzLmdlbmVyYXRlV2FybXVwV2l0aENvbnRleHQoc2hhcmVkQ29udGV4dCwgcHJldmlvdXNTZWN0aW9ucylcclxuICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgY2FzZSAndm9jYWJ1bGFyeSc6XHJcbiAgICAgICAgICBjb250ZW50ID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVZvY2FidWxhcnlXaXRoQ29udGV4dChzaGFyZWRDb250ZXh0LCBwcmV2aW91c1NlY3Rpb25zKVxyXG4gICAgICAgICAgYnJlYWtcclxuICAgICAgICBjYXNlICdyZWFkaW5nJzpcclxuICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB0aGlzLmdlbmVyYXRlUmVhZGluZ1dpdGhDb250ZXh0KHNoYXJlZENvbnRleHQsIHByZXZpb3VzU2VjdGlvbnMpXHJcbiAgICAgICAgICBicmVha1xyXG4gICAgICAgIGNhc2UgJ2NvbXByZWhlbnNpb24nOlxyXG4gICAgICAgICAgY29udGVudCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVDb21wcmVoZW5zaW9uV2l0aENvbnRleHQoc2hhcmVkQ29udGV4dCwgcHJldmlvdXNTZWN0aW9ucylcclxuICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgY2FzZSAnZGlzY3Vzc2lvbic6XHJcbiAgICAgICAgICBjb250ZW50ID0gYXdhaXQgdGhpcy5nZW5lcmF0ZURpc2N1c3Npb25XaXRoQ29udGV4dChzaGFyZWRDb250ZXh0LCBwcmV2aW91c1NlY3Rpb25zKVxyXG4gICAgICAgICAgYnJlYWtcclxuICAgICAgICBjYXNlICdncmFtbWFyJzpcclxuICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB0aGlzLmdlbmVyYXRlR3JhbW1hcldpdGhDb250ZXh0KHNoYXJlZENvbnRleHQsIHByZXZpb3VzU2VjdGlvbnMpXHJcbiAgICAgICAgICBicmVha1xyXG4gICAgICAgIGNhc2UgJ3Byb251bmNpYXRpb24nOlxyXG4gICAgICAgICAgY29udGVudCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVQcm9udW5jaWF0aW9uV2l0aENvbnRleHQoc2hhcmVkQ29udGV4dCwgcHJldmlvdXNTZWN0aW9ucylcclxuICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgY2FzZSAnd3JhcHVwJzpcclxuICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB0aGlzLmdlbmVyYXRlV3JhcHVwV2l0aENvbnRleHQoc2hhcmVkQ29udGV4dCwgcHJldmlvdXNTZWN0aW9ucylcclxuICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBzZWN0aW9uOiAke3NlY3Rpb24ubmFtZX1gKVxyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBnZW5lcmF0aW9uVGltZSA9IERhdGUubm93KCkgLSBzdGFydFRpbWVcclxuICAgICAgY29uc29sZS5sb2coYOKchSBTZWN0aW9uICR7c2VjdGlvbi5uYW1lfSBnZW5lcmF0ZWQgaW4gJHtnZW5lcmF0aW9uVGltZX1tc2ApXHJcblxyXG4gICAgICAvLyBNYXJrIHNlY3Rpb24gYXMgY29tcGxldGVkIGFuZCByZXBvcnQgcHJvZ3Jlc3NcclxuICAgICAgdGhpcy5jb21wbGV0ZWRTZWN0aW9ucy5wdXNoKHNlY3Rpb24ubmFtZSlcclxuICAgICAgY29uc3QgY29tcGxldGlvblByb2dyZXNzID0gdGhpcy5jYWxjdWxhdGVQcm9ncmVzcyhcclxuICAgICAgICB0aGlzLmNvbXBsZXRlZFNlY3Rpb25zLFxyXG4gICAgICAgIHNlY3Rpb24ubmFtZSxcclxuICAgICAgICB0aGlzLmN1cnJlbnRMZXNzb25UeXBlIHx8IHNoYXJlZENvbnRleHQubGVzc29uVHlwZSxcclxuICAgICAgICB0aGlzLnBoYXNlV2VpZ2h0c1xyXG4gICAgICApXHJcbiAgICAgIFxyXG4gICAgICBzYWZlUHJvZ3Jlc3NDYWxsYmFjayh0aGlzLnByb2dyZXNzQ2FsbGJhY2ssIHtcclxuICAgICAgICBzdGVwOiBgQ29tcGxldGVkICR7c2VjdGlvbi5uYW1lfWAsXHJcbiAgICAgICAgcHJvZ3Jlc3M6IGNvbXBsZXRpb25Qcm9ncmVzcyxcclxuICAgICAgICBwaGFzZTogc2VjdGlvbi5uYW1lLFxyXG4gICAgICAgIHNlY3Rpb246IHNlY3Rpb24ubmFtZVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzZWN0aW9uTmFtZTogc2VjdGlvbi5uYW1lLFxyXG4gICAgICAgIGNvbnRlbnQsXHJcbiAgICAgICAgdG9rZW5zVXNlZCxcclxuICAgICAgICBnZW5lcmF0aW9uU3RyYXRlZ3lcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihg4p2MIEZhaWxlZCB0byBnZW5lcmF0ZSBzZWN0aW9uICR7c2VjdGlvbi5uYW1lfTpgLCBlcnJvcilcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZ2VuZXJhdGUgJHtzZWN0aW9uLm5hbWV9IHNlY3Rpb246ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfWApXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgc2hhcmVkIGNvbnRleHQgd2l0aCBpbmZvcm1hdGlvbiBmcm9tIG5ld2x5IGdlbmVyYXRlZCBzZWN0aW9uXHJcbiAgICovXHJcbiAgdXBkYXRlQ29udGV4dChcclxuICAgIGNvbnRleHQ6IFNoYXJlZENvbnRleHQsXHJcbiAgICBuZXdTZWN0aW9uOiBHZW5lcmF0ZWRTZWN0aW9uXHJcbiAgKTogU2hhcmVkQ29udGV4dCB7XHJcbiAgICBjb25zb2xlLmxvZyhg8J+UhCBVcGRhdGluZyBjb250ZXh0IHdpdGggJHtuZXdTZWN0aW9uLnNlY3Rpb25OYW1lfSBzZWN0aW9uYClcclxuXHJcbiAgICBjb25zdCB1cGRhdGVkQ29udGV4dCA9IHsgLi4uY29udGV4dCB9XHJcblxyXG4gICAgLy8gVXBkYXRlIHZvY2FidWxhcnkgaWYgbmV3IHdvcmRzIHdlcmUgaW50cm9kdWNlZFxyXG4gICAgaWYgKG5ld1NlY3Rpb24uc2VjdGlvbk5hbWUgPT09ICd2b2NhYnVsYXJ5JyAmJiBBcnJheS5pc0FycmF5KG5ld1NlY3Rpb24uY29udGVudCkpIHtcclxuICAgICAgY29uc3QgbmV3V29yZHMgPSBuZXdTZWN0aW9uLmNvbnRlbnRcclxuICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS53b3JkICYmIGl0ZW0ud29yZCAhPT0gJ0lOU1RSVUNUSU9OJylcclxuICAgICAgICAubWFwKGl0ZW0gPT4gaXRlbS53b3JkLnRvTG93ZXJDYXNlKCkpXHJcblxyXG4gICAgICB1cGRhdGVkQ29udGV4dC5rZXlWb2NhYnVsYXJ5ID0gW1xyXG4gICAgICAgIC4uLm5ldyBTZXQoWy4uLnVwZGF0ZWRDb250ZXh0LmtleVZvY2FidWxhcnksIC4uLm5ld1dvcmRzXSlcclxuICAgICAgXVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSB0aGVtZXMgaWYgbmV3IG9uZXMgd2VyZSBpZGVudGlmaWVkXHJcbiAgICBpZiAobmV3U2VjdGlvbi5zZWN0aW9uTmFtZSA9PT0gJ3JlYWRpbmcnICYmIHR5cGVvZiBuZXdTZWN0aW9uLmNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIC8vIEV4dHJhY3QgYW55IG5ldyB0aGVtZXMgZnJvbSB0aGUgcmVhZGluZyBwYXNzYWdlXHJcbiAgICAgIGNvbnN0IG5ld1RoZW1lcyA9IHRoaXMuZXh0cmFjdFRoZW1lc0Zyb21UZXh0KG5ld1NlY3Rpb24uY29udGVudClcclxuICAgICAgdXBkYXRlZENvbnRleHQubWFpblRoZW1lcyA9IFtcclxuICAgICAgICAuLi5uZXcgU2V0KFsuLi51cGRhdGVkQ29udGV4dC5tYWluVGhlbWVzLCAuLi5uZXdUaGVtZXNdKVxyXG4gICAgICBdXHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coYOKchSBDb250ZXh0IHVwZGF0ZWQgZm9yICR7bmV3U2VjdGlvbi5zZWN0aW9uTmFtZX1gKVxyXG4gICAgcmV0dXJuIHVwZGF0ZWRDb250ZXh0XHJcbiAgfVxyXG5cclxuICAvLyBQcml2YXRlIGhlbHBlciBtZXRob2RzIGZvciBleHRyYWN0aW5nIHNoYXJlZCBjb250ZXh0XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVMZXNzb25UaXRsZShzb3VyY2VUZXh0OiBzdHJpbmcsIGxlc3NvblR5cGU6IHN0cmluZywgc3R1ZGVudExldmVsOiBDRUZSTGV2ZWwsIG1ldGFkYXRhPzogYW55KTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgIGNvbnNvbGUubG9nKFwi8J+OryBHZW5lcmF0aW5nIGxlc3NvbiB0aXRsZSB3aXRoIGZvcm1hdDogJ09yaWdpbmFsIFRpdGxlIC0gQUkgR2VuZXJhdGVkIFRpdGxlJy4uLlwiKVxyXG4gICAgXHJcbiAgICAvLyBFeHRyYWN0IG9yaWdpbmFsIGFydGljbGUgdGl0bGUgZnJvbSBtZXRhZGF0YVxyXG4gICAgY29uc3Qgb3JpZ2luYWxUaXRsZSA9IG1ldGFkYXRhPy50aXRsZSBcclxuICAgICAgPyBtZXRhZGF0YS50aXRsZVxyXG4gICAgICAgICAgLnJlcGxhY2UoL1xccyotXFxzKldpa2lwZWRpYSQvaSwgJycpXHJcbiAgICAgICAgICAucmVwbGFjZSgvXFxzKlxcfFxccyouKyQvaSwgJycpXHJcbiAgICAgICAgICAudHJpbSgpXHJcbiAgICAgICAgICAuc3Vic3RyaW5nKDAsIDYwKVxyXG4gICAgICA6IG51bGxcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coXCLwn5OwIE9yaWdpbmFsIGFydGljbGUgdGl0bGU6XCIsIG9yaWdpbmFsVGl0bGUgfHwgXCJOb3QgYXZhaWxhYmxlXCIpXHJcbiAgICBcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIENyZWF0ZSBFbmdvby1zdHlsZSB0aXRsZSBwcm9tcHQgd2l0aCBleGFtcGxlc1xyXG4gICAgICBjb25zdCBlbmdvb1Byb21wdCA9IGBDcmVhdGUgYW4gZW5nYWdpbmcgbGVzc29uIHRpdGxlIGluIEVuZ29vIHN0eWxlIGZvciAke3N0dWRlbnRMZXZlbH0gbGV2ZWwgJHtsZXNzb25UeXBlfSBsZXNzb24uXHJcblxyXG5Db250ZW50OiAke3NvdXJjZVRleHQuc3Vic3RyaW5nKDAsIDIwMCl9XHJcblxyXG5Fbmdvby1zdHlsZSB0aXRsZXMgYXJlOlxyXG4tIEVuZ2FnaW5nIGFuZCBjb252ZXJzYXRpb25hbCAoMy04IHdvcmRzKVxyXG4tIEZvY3VzIG9uIHRoZSBtYWluIHRvcGljIG9yIHRoZW1lXHJcbi0gQXZvaWQgZ2VuZXJpYyB3b3JkcyBsaWtlIFwibGVzc29uXCIsIFwiYXJ0aWNsZVwiLCBcInN0b3J5XCJcclxuLSBVc2UgYWN0aXZlLCBpbnRlcmVzdGluZyBsYW5ndWFnZVxyXG4tIEV4YW1wbGVzOiBcIlRlY2ggR2lhbnRzIEdvIE51Y2xlYXJcIiwgXCJUaGUgUmlzZSBvZiBEaWdpdGFsIE5vbWFkc1wiLCBcIkNsaW1hdGUgQ2hhbmdlIFNvbHV0aW9uc1wiXHJcblxyXG5HZW5lcmF0ZSB0aXRsZTpgXHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQoZW5nb29Qcm9tcHQsIHsgbWF4VG9rZW5zOiA2MCB9KVxyXG4gICAgICBjb25zdCBhaVRpdGxlID0gcmVzcG9uc2UudHJpbSgpXHJcbiAgICAgICAgLnJlcGxhY2UoL1snXCJdL2csICcnKVxyXG4gICAgICAgIC5yZXBsYWNlKC9eKFRpdGxlOj98R2VuZXJhdGUgdGl0bGU6PylcXHMqL2ksICcnKVxyXG4gICAgICAgIC5yZXBsYWNlKC9cXC4kLywgJycpIC8vIFJlbW92ZSB0cmFpbGluZyBwZXJpb2RcclxuICAgICAgICAuc3Vic3RyaW5nKDAsIDYwKVxyXG4gICAgICBcclxuICAgICAgY29uc29sZS5sb2coXCLwn6SWIEFJIGdlbmVyYXRlZCBFbmdvby1zdHlsZSB0aXRsZTpcIiwgYWlUaXRsZSlcclxuICAgICAgXHJcbiAgICAgIC8vIFZhbGlkYXRlIHRoZSBBSSB0aXRsZSAtIHNob3VsZCBiZSBlbmdhZ2luZyBhbmQgYXBwcm9wcmlhdGUgbGVuZ3RoXHJcbiAgICAgIGlmIChhaVRpdGxlLmxlbmd0aCA+IDUgJiYgYWlUaXRsZS5sZW5ndGggPCA4MCAmJiBcclxuICAgICAgICAgICFhaVRpdGxlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2xlc3NvbicpICYmIFxyXG4gICAgICAgICAgIWFpVGl0bGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnYXJ0aWNsZScpICYmXHJcbiAgICAgICAgICBhaVRpdGxlLnNwbGl0KCcgJykubGVuZ3RoID49IDIgJiYgYWlUaXRsZS5zcGxpdCgnICcpLmxlbmd0aCA8PSA4KSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRm9ybWF0OiBcIk9yaWdpbmFsIFRpdGxlIC0gQUkgR2VuZXJhdGVkIFRpdGxlXCJcclxuICAgICAgICBpZiAob3JpZ2luYWxUaXRsZSkge1xyXG4gICAgICAgICAgY29uc3QgZnVsbFRpdGxlID0gYCR7b3JpZ2luYWxUaXRsZX0gLSAke2FpVGl0bGV9YFxyXG4gICAgICAgICAgY29uc29sZS5sb2coXCLinIUgVXNpbmcgY29tYmluZWQgdGl0bGU6XCIsIGZ1bGxUaXRsZSlcclxuICAgICAgICAgIHJldHVybiBmdWxsVGl0bGVcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coXCLinIUgVXNpbmcgQUktZ2VuZXJhdGVkIHRpdGxlIG9ubHk6XCIsIGFpVGl0bGUpXHJcbiAgICAgICAgICByZXR1cm4gYWlUaXRsZVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEFJIGdlbmVyYXRlZCBpbnZhbGlkIHRpdGxlLCB1c2luZyBmYWxsYmFja1wiKVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEFJIHRpdGxlIGdlbmVyYXRpb24gZmFpbGVkLCB1c2luZyBmYWxsYmFjazpcIiwgZXJyb3IubWVzc2FnZSlcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gUFJBR01BVElDIEZBTExCQUNLOiBVc2UgbWV0YWRhdGEgb3IgZ2VuZXJhdGUgc2ltcGxlIHRpdGxlXHJcbiAgICAvLyBUaGlzIGVuc3VyZXMgbGVzc29uIGdlbmVyYXRpb24gTkVWRVIgZmFpbHMgZHVlIHRvIHRpdGxlIGlzc3Vlc1xyXG4gICAgXHJcbiAgICAvLyBPcHRpb24gMTogVXNlIG9yaWdpbmFsIHRpdGxlIHdpdGggbGVzc29uIHR5cGVcclxuICAgIGlmIChvcmlnaW5hbFRpdGxlKSB7XHJcbiAgICAgIGNvbnN0IGxlc3NvblR5cGVMYWJlbCA9IGxlc3NvblR5cGUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBsZXNzb25UeXBlLnNsaWNlKDEpXHJcbiAgICAgIGNvbnN0IGZhbGxiYWNrVGl0bGUgPSBgJHtvcmlnaW5hbFRpdGxlfSAtICR7bGVzc29uVHlwZUxhYmVsfSBMZXNzb25gXHJcbiAgICAgIGNvbnNvbGUubG9nKFwi4pyFIFVzaW5nIG9yaWdpbmFsIHRpdGxlIHdpdGggbGVzc29uIHR5cGU6XCIsIGZhbGxiYWNrVGl0bGUpXHJcbiAgICAgIHJldHVybiBmYWxsYmFja1RpdGxlXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIE9wdGlvbiAyOiBHZW5lcmF0ZSBmcm9tIGZpcnN0IHNlbnRlbmNlXHJcbiAgICBjb25zdCBmaXJzdFNlbnRlbmNlID0gc291cmNlVGV4dC5zcGxpdCgvWy4hP10vKVswXT8udHJpbSgpXHJcbiAgICBpZiAoZmlyc3RTZW50ZW5jZSAmJiBmaXJzdFNlbnRlbmNlLmxlbmd0aCA+IDEwICYmIGZpcnN0U2VudGVuY2UubGVuZ3RoIDwgMTAwKSB7XHJcbiAgICAgIGNvbnN0IHNpbXBsZVRpdGxlID0gZmlyc3RTZW50ZW5jZS5zdWJzdHJpbmcoMCwgNjApICsgKGZpcnN0U2VudGVuY2UubGVuZ3RoID4gNjAgPyAnLi4uJyA6ICcnKVxyXG4gICAgICBjb25zb2xlLmxvZyhcIuKchSBVc2luZyBjb250ZW50LWJhc2VkIHRpdGxlOlwiLCBzaW1wbGVUaXRsZSlcclxuICAgICAgcmV0dXJuIHNpbXBsZVRpdGxlXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIE9wdGlvbiAzOiBHZW5lcmljIGJ1dCBmdW5jdGlvbmFsIGZhbGxiYWNrXHJcbiAgICBjb25zdCBsZXNzb25UeXBlTGFiZWwgPSBsZXNzb25UeXBlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbGVzc29uVHlwZS5zbGljZSgxKVxyXG4gICAgY29uc3QgZ2VuZXJpY1RpdGxlID0gYCR7bGVzc29uVHlwZUxhYmVsfSBMZXNzb24gLSAke3N0dWRlbnRMZXZlbH0gTGV2ZWxgXHJcbiAgICBjb25zb2xlLmxvZyhcIuKchSBVc2luZyBnZW5lcmljIHRpdGxlOlwiLCBnZW5lcmljVGl0bGUpXHJcbiAgICByZXR1cm4gZ2VuZXJpY1RpdGxlXHJcbiAgfVxyXG5cclxuXHJcblxyXG4gIHByaXZhdGUgYXN5bmMgZXh0cmFjdEtleVZvY2FidWxhcnkoc291cmNlVGV4dDogc3RyaW5nLCBzdHVkZW50TGV2ZWw6IENFRlJMZXZlbCk6IFByb21pc2U8c3RyaW5nW10+IHtcclxuICAgIGNvbnN0IHByb21wdCA9IGBFeHRyYWN0IDgtMTIga2V5IHZvY2FidWxhcnkgd29yZHMgZnJvbSB0aGlzIHRleHQgZm9yICR7c3R1ZGVudExldmVsfSBsZXZlbCBzdHVkZW50cy4gUmV0dXJuIG9ubHkgdGhlIHdvcmRzLCBvbmUgcGVyIGxpbmU6XHJcblxyXG4ke3NvdXJjZVRleHQuc3Vic3RyaW5nKDAsIDUwMCl9YFxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQpXHJcbiAgICAgIGNvbnN0IHdvcmRzID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpXHJcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpLnRvTG93ZXJDYXNlKCkpXHJcbiAgICAgICAgLmZpbHRlcih3b3JkID0+IHdvcmQubGVuZ3RoID4gMiAmJiB3b3JkLmxlbmd0aCA8IDIwKVxyXG4gICAgICAgIC5zbGljZSgwLCAxMilcclxuXHJcbiAgICAgIHJldHVybiB3b3Jkcy5sZW5ndGggPj0gNiA/IHdvcmRzIDogdGhpcy5leHRyYWN0Vm9jYWJ1bGFyeUZhbGxiYWNrKHNvdXJjZVRleHQsIHN0dWRlbnRMZXZlbClcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwi4pqg77iPIEFJIHZvY2FidWxhcnkgZXh0cmFjdGlvbiBmYWlsZWQsIHVzaW5nIGZhbGxiYWNrXCIpXHJcbiAgICAgIHJldHVybiB0aGlzLmV4dHJhY3RWb2NhYnVsYXJ5RmFsbGJhY2soc291cmNlVGV4dCwgc3R1ZGVudExldmVsKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBleHRyYWN0TWFpblRoZW1lcyhzb3VyY2VUZXh0OiBzdHJpbmcsIHN0dWRlbnRMZXZlbDogQ0VGUkxldmVsKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gICAgY29uc3QgcHJvbXB0ID0gYElkZW50aWZ5IDMtNSBtYWluIHRoZW1lcyBvciB0b3BpY3MgaW4gdGhpcyB0ZXh0IGZvciAke3N0dWRlbnRMZXZlbH0gbGV2ZWwgc3R1ZGVudHMuIFJldHVybiBvbmx5IHRoZSB0aGVtZXMsIG9uZSBwZXIgbGluZTpcclxuXHJcbiR7c291cmNlVGV4dC5zdWJzdHJpbmcoMCwgNDAwKX1gXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcclxuICAgICAgY29uc3QgdGhlbWVzID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpXHJcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpLnRvTG93ZXJDYXNlKCkpXHJcbiAgICAgICAgLmZpbHRlcih0aGVtZSA9PiB0aGVtZS5sZW5ndGggPiAzICYmIHRoZW1lLmxlbmd0aCA8IDUwKVxyXG4gICAgICAgIC5zbGljZSgwLCA1KVxyXG5cclxuICAgICAgcmV0dXJuIHRoZW1lcy5sZW5ndGggPj0gMiA/IHRoZW1lcyA6IHRoaXMuZXh0cmFjdFRoZW1lc0ZhbGxiYWNrKHNvdXJjZVRleHQpXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIuKaoO+4jyBBSSB0aGVtZSBleHRyYWN0aW9uIGZhaWxlZCwgdXNpbmcgZmFsbGJhY2tcIilcclxuICAgICAgcmV0dXJuIHRoaXMuZXh0cmFjdFRoZW1lc0ZhbGxiYWNrKHNvdXJjZVRleHQpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGNyZWF0ZUNvbnRlbnRTdW1tYXJ5KHNvdXJjZVRleHQ6IHN0cmluZywgc3R1ZGVudExldmVsOiBDRUZSTGV2ZWwpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gICAgY29uc3QgcHJvbXB0ID0gYFN1bW1hcml6ZSB0aGlzIHRleHQgaW4gMi0zIHNlbnRlbmNlcyBmb3IgJHtzdHVkZW50TGV2ZWx9IGxldmVsIHN0dWRlbnRzOlxyXG5cclxuJHtzb3VyY2VUZXh0LnN1YnN0cmluZygwLCA2MDApfWBcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQocHJvbXB0KVxyXG4gICAgICByZXR1cm4gcmVzcG9uc2UudHJpbSgpLnN1YnN0cmluZygwLCAzMDApXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIuKaoO+4jyBBSSBzdW1tYXJ5IGZhaWxlZCwgdXNpbmcgdHJ1bmNhdGlvblwiKVxyXG4gICAgICByZXR1cm4gc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgMjAwKSArIFwiLi4uXCJcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIFNlY3Rpb24gZ2VuZXJhdGlvbiBtZXRob2RzIHVzaW5nIHNoYXJlZCBjb250ZXh0XHJcblxyXG4gIC8qKlxyXG4gICAqIEJ1aWxkIGxldmVsLXNwZWNpZmljIHdhcm0tdXAgcHJvbXB0IHdpdGggY29udGVudCBhc3N1bXB0aW9uIGRldGVjdGlvblxyXG4gICAqL1xyXG4gIHByaXZhdGUgYnVpbGRXYXJtdXBQcm9tcHQoY29udGV4dDogU2hhcmVkQ29udGV4dCk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBtYWluVGhlbWUgPSBjb250ZXh0Lm1haW5UaGVtZXNbMF0gfHwgJ3RoaXMgdG9waWMnXHJcblxyXG4gICAgLy8gQ0VGUi1zcGVjaWZpYyBpbnN0cnVjdGlvbnNcclxuICAgIGNvbnN0IGxldmVsSW5zdHJ1Y3Rpb25zOiBSZWNvcmQ8Q0VGUkxldmVsLCBzdHJpbmc+ID0ge1xyXG4gICAgICAnQTEnOiAnVXNlIHZlcnkgc2ltcGxlIHByZXNlbnQgdGVuc2UgcXVlc3Rpb25zIHdpdGggYmFzaWMgdm9jYWJ1bGFyeS4gUXVlc3Rpb25zIHNob3VsZCBiZSBhYm91dCBwZXJzb25hbCBleHBlcmllbmNlcyBhbmQgZmFtaWxpYXIgc2l0dWF0aW9ucy4nLFxyXG4gICAgICAnQTInOiAnVXNlIHNpbXBsZSBxdWVzdGlvbnMgd2l0aCBwcmVzZW50IGFuZCBwYXN0IHRlbnNlcy4gRm9jdXMgb24gcGVyc29uYWwgZXhwZXJpZW5jZXMgYW5kIGV2ZXJ5ZGF5IHNpdHVhdGlvbnMuJyxcclxuICAgICAgJ0IxJzogJ1VzZSB2YXJpZWQgcXVlc3Rpb24gc3RydWN0dXJlcyB3aXRoIGRpZmZlcmVudCB0ZW5zZXMuIEluY2x1ZGUgcXVlc3Rpb25zIGFib3V0IG9waW5pb25zIGFuZCBleHBlcmllbmNlcy4nLFxyXG4gICAgICAnQjInOiAnVXNlIGNvbXBsZXggcXVlc3Rpb24gc3RydWN0dXJlcy4gSW5jbHVkZSBoeXBvdGhldGljYWwgYW5kIGFuYWx5dGljYWwgcXVlc3Rpb25zIGFib3V0IGV4cGVyaWVuY2VzLicsXHJcbiAgICAgICdDMSc6ICdVc2Ugc29waGlzdGljYXRlZCBxdWVzdGlvbiBzdHJ1Y3R1cmVzLiBJbmNsdWRlIGFic3RyYWN0IGFuZCBldmFsdWF0aXZlIHF1ZXN0aW9ucyB0aGF0IGVuY291cmFnZSBjcml0aWNhbCB0aGlua2luZy4nXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbGV2ZWxJbnN0cnVjdGlvbiA9IGxldmVsSW5zdHJ1Y3Rpb25zW2NvbnRleHQuZGlmZmljdWx0eUxldmVsXVxyXG5cclxuICAgIC8vIEJ1aWxkIHByb21wdCB0aGF0IGV4cGxpY2l0bHkgYXZvaWRzIGNvbnRlbnQgYXNzdW1wdGlvbnNcclxuICAgIGNvbnN0IHByb21wdCA9IGBDcmVhdGUgMyB3YXJtLXVwIHF1ZXN0aW9ucyBmb3IgJHtjb250ZXh0LmRpZmZpY3VsdHlMZXZlbH0gbGV2ZWwgc3R1ZGVudHMgYWJvdXQgdGhlIGdlbmVyYWwgdG9waWMgb2YgXCIke21haW5UaGVtZX1cIi5cclxuXHJcbkNSSVRJQ0FMIFJFUVVJUkVNRU5UUzpcclxuMS4gRE8gTk9UIHJlZmVyZW5jZSBzcGVjaWZpYyBldmVudHMsIHBlb3BsZSwgbmFtZXMsIGRhdGVzLCBvciBvdXRjb21lcyBmcm9tIGFueSB0ZXh0XHJcbjIuIERPIE5PVCBhc3N1bWUgc3R1ZGVudHMgaGF2ZSByZWFkIG9yIGtub3cgYW55dGhpbmcgYWJvdXQgc3BlY2lmaWMgY29udGVudFxyXG4zLiBGT0NVUyBvbiBzdHVkZW50cycgcGVyc29uYWwgZXhwZXJpZW5jZXMsIG9waW5pb25zLCBhbmQgZ2VuZXJhbCBrbm93bGVkZ2VcclxuNC4gUXVlc3Rpb25zIHNob3VsZCBhY3RpdmF0ZSBwcmlvciBrbm93bGVkZ2UgYWJvdXQgdGhlIFRPUElDLCBub3QgdGVzdCBrbm93bGVkZ2Ugb2Ygc3BlY2lmaWMgY29udGVudFxyXG41LiBRdWVzdGlvbnMgc2hvdWxkIGJ1aWxkIGludGVyZXN0IGFuZCBtZW50YWwgZm9jdXMgZm9yIGxlYXJuaW5nIGFib3V0IHRoaXMgdG9waWNcclxuNi4gJHtsZXZlbEluc3RydWN0aW9ufVxyXG5cclxuRVhBTVBMRVMgT0YgR09PRCBRVUVTVElPTlMgKGFjdGl2YXRlIHByaW9yIGtub3dsZWRnZSB3aXRob3V0IGNvbnRlbnQgYXNzdW1wdGlvbnMpOlxyXG4tIFwiSGF2ZSB5b3UgZXZlciBleHBlcmllbmNlZCBbZ2VuZXJhbCBzaXR1YXRpb24gcmVsYXRlZCB0byB0b3BpY10/XCJcclxuLSBcIldoYXQgZG8geW91IHRoaW5rIGFib3V0IFtnZW5lcmFsIGNvbmNlcHQgcmVsYXRlZCB0byB0b3BpY10/XCJcclxuLSBcIkluIHlvdXIgb3Bpbmlvbiwgd2h5IGlzIFtnZW5lcmFsIGFzcGVjdCBvZiB0b3BpY10gaW1wb3J0YW50P1wiXHJcblxyXG5FWEFNUExFUyBPRiBCQUQgUVVFU1RJT05TIChhc3N1bWUgY29udGVudCBrbm93bGVkZ2UpOlxyXG4tIFwiV2hhdCBoYXBwZW5lZCB3aGVuIFtzcGVjaWZpYyBwZXJzb25dIGRpZCBbc3BlY2lmaWMgZXZlbnRdP1wiXHJcbi0gXCJXaHkgZGlkIFtzcGVjaWZpYyBvdXRjb21lXSBvY2N1ciBpbiB0aGUgc3Rvcnk/XCJcclxuLSBcIldoYXQgZG8geW91IHJlbWVtYmVyIGFib3V0IFtzcGVjaWZpYyBkZXRhaWxdP1wiXHJcblxyXG5SZXR1cm4gT05MWSAzIHF1ZXN0aW9ucywgb25lIHBlciBsaW5lLCB3aXRoIG5vIG51bWJlcmluZyBvciBleHRyYSB0ZXh0OmBcclxuXHJcbiAgICByZXR1cm4gcHJvbXB0XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBWYWxpZGF0ZSB3YXJtLXVwIHF1ZXN0aW9ucyB1c2luZyB0aGUgY29tcHJlaGVuc2l2ZSBXYXJtdXBWYWxpZGF0b3JcclxuICAgKi9cclxuICBwcml2YXRlIHZhbGlkYXRlV2FybXVwUXVlc3Rpb25zKHF1ZXN0aW9uczogc3RyaW5nW10sIGNvbnRleHQ6IFNoYXJlZENvbnRleHQpOiB7XHJcbiAgICBpc1ZhbGlkOiBib29sZWFuXHJcbiAgICBpc3N1ZXM6IHN0cmluZ1tdXHJcbiAgfSB7XHJcbiAgICAvLyBVc2UgdGhlIGNvbXByZWhlbnNpdmUgdmFsaWRhdG9yXHJcbiAgICBjb25zdCB2YWxpZGF0aW9uUmVzdWx0ID0gdGhpcy53YXJtdXBWYWxpZGF0b3IudmFsaWRhdGUoXHJcbiAgICAgIHF1ZXN0aW9ucyxcclxuICAgICAgY29udGV4dC5kaWZmaWN1bHR5TGV2ZWwsXHJcbiAgICAgIHsgbWFpblRoZW1lczogY29udGV4dC5tYWluVGhlbWVzIH1cclxuICAgIClcclxuXHJcbiAgICAvLyBDb252ZXJ0IHZhbGlkYXRpb24gaXNzdWVzIHRvIHNpbXBsZSBzdHJpbmcgYXJyYXkgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcclxuICAgIGNvbnN0IGlzc3VlcyA9IFtcclxuICAgICAgLi4udmFsaWRhdGlvblJlc3VsdC5pc3N1ZXMubWFwKGlzc3VlID0+XHJcbiAgICAgICAgaXNzdWUucXVlc3Rpb25JbmRleCAhPT0gdW5kZWZpbmVkXHJcbiAgICAgICAgICA/IGAke2lzc3VlLm1lc3NhZ2V9IChRdWVzdGlvbiAke2lzc3VlLnF1ZXN0aW9uSW5kZXggKyAxfSlgXHJcbiAgICAgICAgICA6IGlzc3VlLm1lc3NhZ2VcclxuICAgICAgKSxcclxuICAgICAgLi4udmFsaWRhdGlvblJlc3VsdC53YXJuaW5ncy5tYXAod2FybmluZyA9PlxyXG4gICAgICAgIHdhcm5pbmcucXVlc3Rpb25JbmRleCAhPT0gdW5kZWZpbmVkXHJcbiAgICAgICAgICA/IGBXYXJuaW5nOiAke3dhcm5pbmcubWVzc2FnZX0gKFF1ZXN0aW9uICR7d2FybmluZy5xdWVzdGlvbkluZGV4ICsgMX0pYFxyXG4gICAgICAgICAgOiBgV2FybmluZzogJHt3YXJuaW5nLm1lc3NhZ2V9YFxyXG4gICAgICApXHJcbiAgICBdXHJcblxyXG4gICAgY29uc29sZS5sb2coYPCfk4ogV2FybXVwIHZhbGlkYXRpb24gc2NvcmU6ICR7dmFsaWRhdGlvblJlc3VsdC5zY29yZX0vMTAwYClcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBpc1ZhbGlkOiB2YWxpZGF0aW9uUmVzdWx0LmlzVmFsaWQsXHJcbiAgICAgIGlzc3Vlc1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVdhcm11cFdpdGhDb250ZXh0KFxyXG4gICAgY29udGV4dDogU2hhcmVkQ29udGV4dCxcclxuICAgIF9wcmV2aW91c1NlY3Rpb25zOiBHZW5lcmF0ZWRTZWN0aW9uW11cclxuICApOiBQcm9taXNlPHN0cmluZ1tdPiB7XHJcbiAgICBjb25zdCBtYXhBdHRlbXB0cyA9IDJcclxuICAgIGxldCBhdHRlbXB0ID0gMFxyXG4gICAgY29uc3Qgc2VjdGlvblN0YXJ0VGltZSA9IERhdGUubm93KClcclxuXHJcbiAgICAvLyBSZXBvcnQgcHJvZ3Jlc3MgYXQgc3RhcnQgb2Ygd2FybXVwIGdlbmVyYXRpb25cclxuICAgIHNhZmVQcm9ncmVzc0NhbGxiYWNrKHRoaXMucHJvZ3Jlc3NDYWxsYmFjaywge1xyXG4gICAgICBzdGVwOiAnR2VuZXJhdGluZyB3YXJtdXAgcXVlc3Rpb25zJyxcclxuICAgICAgcHJvZ3Jlc3M6IHRoaXMuY2FsY3VsYXRlUHJvZ3Jlc3ModGhpcy5jb21wbGV0ZWRTZWN0aW9ucywgJ3dhcm11cCcsIGNvbnRleHQubGVzc29uVHlwZSwgdGhpcy5waGFzZVdlaWdodHMpLFxyXG4gICAgICBwaGFzZTogJ3dhcm11cCcsXHJcbiAgICAgIHNlY3Rpb246ICd3YXJtdXAnXHJcbiAgICB9KVxyXG5cclxuICAgIHdoaWxlIChhdHRlbXB0IDwgbWF4QXR0ZW1wdHMpIHtcclxuICAgICAgYXR0ZW1wdCsrXHJcbiAgICAgIGNvbnNvbGUubG9nKGDwn46vIEdlbmVyYXRpbmcgd2FybS11cCBxdWVzdGlvbnMgKGF0dGVtcHQgJHthdHRlbXB0fS8ke21heEF0dGVtcHRzfSlgKVxyXG5cclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBCdWlsZCBlbmhhbmNlZCBwcm9tcHRcclxuICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmJ1aWxkV2FybXVwUHJvbXB0KGNvbnRleHQpXHJcblxyXG4gICAgICAgIC8vIEdlbmVyYXRlIHF1ZXN0aW9uc1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQpXHJcbiAgICAgICAgY29uc3QgcXVlc3Rpb25zID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpXHJcbiAgICAgICAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkpXHJcbiAgICAgICAgICAuZmlsdGVyKGxpbmUgPT4gbGluZS5sZW5ndGggPiAwKVxyXG4gICAgICAgICAgLm1hcChsaW5lID0+IHtcclxuICAgICAgICAgICAgLy8gUmVtb3ZlIG51bWJlcmluZyBpZiBwcmVzZW50XHJcbiAgICAgICAgICAgIHJldHVybiBsaW5lLnJlcGxhY2UoL15cXGQrW1xcLildXFxzKi8sICcnKS50cmltKClcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuZmlsdGVyKGxpbmUgPT4gbGluZS5lbmRzV2l0aCgnPycpICYmIGxpbmUubGVuZ3RoID4gMTApXHJcbiAgICAgICAgICAuc2xpY2UoMCwgMylcclxuXHJcbiAgICAgICAgaWYgKHF1ZXN0aW9ucy5sZW5ndGggPCAzKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIE9ubHkgJHtxdWVzdGlvbnMubGVuZ3RofSBxdWVzdGlvbnMgZ2VuZXJhdGVkLCBuZWVkIDNgKVxyXG4gICAgICAgICAgaWYgKGF0dGVtcHQgPCBtYXhBdHRlbXB0cykgY29udGludWVcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluc3VmZmljaWVudCBxdWVzdGlvbnMgZ2VuZXJhdGVkIGFmdGVyIHJldHJpZXNcIilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFZhbGlkYXRlIHF1ZXN0aW9uc1xyXG4gICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLnZhbGlkYXRlV2FybXVwUXVlc3Rpb25zKHF1ZXN0aW9ucywgY29udGV4dClcclxuXHJcbiAgICAgICAgaWYgKCF2YWxpZGF0aW9uLmlzVmFsaWQpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDimqDvuI8gVmFsaWRhdGlvbiBmYWlsZWQ6YCwgdmFsaWRhdGlvbi5pc3N1ZXMpXHJcbiAgICAgICAgICBpZiAoYXR0ZW1wdCA8IG1heEF0dGVtcHRzKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDwn5SEIFJldHJ5aW5nIHdpdGggYWRqdXN0ZWQgcHJvbXB0Li4uYClcclxuICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDimqDvuI8gVXNpbmcgcXVlc3Rpb25zIGRlc3BpdGUgdmFsaWRhdGlvbiBpc3N1ZXMgKG1heCBhdHRlbXB0cyByZWFjaGVkKWApXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDinIUgV2FybS11cCBxdWVzdGlvbnMgdmFsaWRhdGVkIHN1Y2Nlc3NmdWxseWApXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBUcmFjayBxdWFsaXR5IG1ldHJpY3NcclxuICAgICAgICBjb25zdCBnZW5lcmF0aW9uVGltZSA9IERhdGUubm93KCkgLSBzZWN0aW9uU3RhcnRUaW1lXHJcbiAgICAgICAgcXVhbGl0eU1ldHJpY3NUcmFja2VyLnJlY29yZFNlY3Rpb24oXHJcbiAgICAgICAgICAnd2FybXVwJyxcclxuICAgICAgICAgIHZhbGlkYXRpb24uaXNWYWxpZCA/IDEwMCA6IDcwLFxyXG4gICAgICAgICAgYXR0ZW1wdCxcclxuICAgICAgICAgIGdlbmVyYXRpb25UaW1lLFxyXG4gICAgICAgICAgdmFsaWRhdGlvbi5pc3N1ZXMubGVuZ3RoLFxyXG4gICAgICAgICAgMFxyXG4gICAgICAgIClcclxuXHJcbiAgICAgICAgY29uc3QgaW5zdHJ1Y3Rpb24gPSBcIkhhdmUgdGhlIGZvbGxvd2luZyBjb252ZXJzYXRpb25zIG9yIGRpc2N1c3Npb25zIHdpdGggeW91ciB0dXRvciBiZWZvcmUgcmVhZGluZyB0aGUgdGV4dDpcIlxyXG4gICAgICAgIHJldHVybiBbaW5zdHJ1Y3Rpb24sIC4uLnF1ZXN0aW9uc11cclxuXHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihg4p2MIEF0dGVtcHQgJHthdHRlbXB0fSBmYWlsZWQ6YCwgZXJyb3IpXHJcbiAgICAgICAgaWYgKGF0dGVtcHQgPj0gbWF4QXR0ZW1wdHMpIHtcclxuICAgICAgICAgIC8vIFRyYWNrIGZhaWxlZCBnZW5lcmF0aW9uXHJcbiAgICAgICAgICBxdWFsaXR5TWV0cmljc1RyYWNrZXIucmVjb3JkU2VjdGlvbihcclxuICAgICAgICAgICAgJ3dhcm11cCcsXHJcbiAgICAgICAgICAgIDAsXHJcbiAgICAgICAgICAgIGF0dGVtcHQsXHJcbiAgICAgICAgICAgIERhdGUubm93KCkgLSBzZWN0aW9uU3RhcnRUaW1lLFxyXG4gICAgICAgICAgICAxLFxyXG4gICAgICAgICAgICAwXHJcbiAgICAgICAgICApXHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2VuZXJhdGUgd2FybXVwIHF1ZXN0aW9uczogXCIgKyAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIHdhcm11cCBxdWVzdGlvbnMgYWZ0ZXIgYWxsIGF0dGVtcHRzXCIpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgdGhlIG51bWJlciBvZiBleGFtcGxlIHNlbnRlbmNlcyByZXF1aXJlZCBmb3IgZWFjaCBDRUZSIGxldmVsXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXRFeGFtcGxlQ291bnRGb3JMZXZlbChsZXZlbDogQ0VGUkxldmVsKTogbnVtYmVyIHtcclxuICAgIGNvbnN0IGV4YW1wbGVDb3VudHM6IFJlY29yZDxDRUZSTGV2ZWwsIG51bWJlcj4gPSB7XHJcbiAgICAgICdBMSc6IDUsXHJcbiAgICAgICdBMic6IDUsXHJcbiAgICAgICdCMSc6IDQsXHJcbiAgICAgICdCMic6IDMsXHJcbiAgICAgICdDMSc6IDJcclxuICAgIH1cclxuICAgIHJldHVybiBleGFtcGxlQ291bnRzW2xldmVsXVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQnVpbGQgbGV2ZWwtc3BlY2lmaWMgdm9jYWJ1bGFyeSBleGFtcGxlIHByb21wdCB3aXRoIGNvbnRleHR1YWwgcmVsZXZhbmNlXHJcbiAgICogT1BUSU1JWkVEOiBSZWR1Y2VkIHRva2VuIGNvdW50IGJ5IDYwJSB3aGlsZSBtYWludGFpbmluZyBxdWFsaXR5XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBidWlsZFZvY2FidWxhcnlFeGFtcGxlUHJvbXB0KFxyXG4gICAgd29yZDogc3RyaW5nLFxyXG4gICAgY29udGV4dDogU2hhcmVkQ29udGV4dCxcclxuICAgIGV4YW1wbGVDb3VudDogbnVtYmVyXHJcbiAgKTogc3RyaW5nIHtcclxuICAgIC8vIENvbmNpc2UgQ0VGUiBjb21wbGV4aXR5IGd1aWRlbGluZXNcclxuICAgIGNvbnN0IGxldmVsR3VpZGVsaW5lczogUmVjb3JkPENFRlJMZXZlbCwgc3RyaW5nPiA9IHtcclxuICAgICAgJ0ExJzogJzUtOCB3b3JkcywgcHJlc2VudCB0ZW5zZSwgYmFzaWMgdm9jYWJ1bGFyeScsXHJcbiAgICAgICdBMic6ICc4LTEyIHdvcmRzLCBzaW1wbGUgcGFzdC9mdXR1cmUsIGNvbW1vbiB3b3JkcycsXHJcbiAgICAgICdCMSc6ICcxMC0xNSB3b3JkcywgdmFyaWVkIHRlbnNlcywgY29tcG91bmQgc2VudGVuY2VzJyxcclxuICAgICAgJ0IyJzogJzEyLTE4IHdvcmRzLCBjb21wbGV4IHN0cnVjdHVyZXMsIHJlbGF0aXZlIGNsYXVzZXMnLFxyXG4gICAgICAnQzEnOiAnMTUtMjAgd29yZHMsIHNvcGhpc3RpY2F0ZWQgZ3JhbW1hciwgbnVhbmNlZCBleHByZXNzaW9ucydcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB0aGVtZXMgPSBjb250ZXh0Lm1haW5UaGVtZXMuc2xpY2UoMCwgMikuam9pbignLCAnKVxyXG4gICAgY29uc3QgY29udGV4dFNuaXBwZXQgPSBjb250ZXh0LmNvbnRlbnRTdW1tYXJ5LnN1YnN0cmluZygwLCAxNTApXHJcblxyXG4gICAgY29uc3QgcHJvbXB0ID0gYENyZWF0ZSAke2V4YW1wbGVDb3VudH0gc2VudGVuY2VzIHVzaW5nIFwiJHt3b3JkfVwiIGZvciAke2NvbnRleHQuZGlmZmljdWx0eUxldmVsfSBsZXZlbC5cclxuXHJcbkNvbnRleHQ6ICR7Y29udGV4dFNuaXBwZXR9XHJcblRvcGljOiAke3RoZW1lc31cclxuXHJcblJlcXVpcmVtZW50czpcclxuLSBSZWxhdGUgdG8gdGhlIHRvcGljICgke3RoZW1lc30pXHJcbi0gTWF0Y2ggJHtjb250ZXh0LmRpZmZpY3VsdHlMZXZlbH0gbGV2ZWw6ICR7bGV2ZWxHdWlkZWxpbmVzW2NvbnRleHQuZGlmZmljdWx0eUxldmVsXX1cclxuLSBTaG93IGRpZmZlcmVudCB1c2VzIG9mIFwiJHt3b3JkfVwiXHJcbi0gVXNlIGNvbnRleHQtc3BlY2lmaWMgdGVybXNcclxuXHJcblJldHVybiAke2V4YW1wbGVDb3VudH0gc2VudGVuY2VzLCBvbmUgcGVyIGxpbmUsIG5vIG51bWJlcmluZzpgXHJcblxyXG4gICAgcmV0dXJuIHByb21wdFxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVmFsaWRhdGUgdm9jYWJ1bGFyeSBleGFtcGxlcyBmb3IgcXVhbGl0eSBhbmQgcmVsZXZhbmNlXHJcbiAgICovXHJcbiAgcHJpdmF0ZSB2YWxpZGF0ZVZvY2FidWxhcnlFeGFtcGxlcyhcclxuICAgIHdvcmQ6IHN0cmluZyxcclxuICAgIGV4YW1wbGVzOiBzdHJpbmdbXSxcclxuICAgIGNvbnRleHQ6IFNoYXJlZENvbnRleHQsXHJcbiAgICBleHBlY3RlZENvdW50OiBudW1iZXJcclxuICApOiB7IGlzVmFsaWQ6IGJvb2xlYW47IGlzc3Vlczogc3RyaW5nW10gfSB7XHJcbiAgICBjb25zdCBpc3N1ZXM6IHN0cmluZ1tdID0gW11cclxuICAgIGNvbnN0IHdhcm5pbmdzOiBzdHJpbmdbXSA9IFtdXHJcblxyXG4gICAgLy8gQ2hlY2sgZXhhbXBsZSBjb3VudFxyXG4gICAgaWYgKGV4YW1wbGVzLmxlbmd0aCA8IGV4cGVjdGVkQ291bnQpIHtcclxuICAgICAgaXNzdWVzLnB1c2goYEluc3VmZmljaWVudCBleGFtcGxlczogZXhwZWN0ZWQgJHtleHBlY3RlZENvdW50fSwgZ290ICR7ZXhhbXBsZXMubGVuZ3RofWApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVHJhY2sgY29udGV4dHVhbCByZWxldmFuY2UgYWNyb3NzIGFsbCBleGFtcGxlc1xyXG4gICAgbGV0IGNvbnRleHR1YWxseVJlbGV2YW50Q291bnQgPSAwXHJcblxyXG4gICAgLy8gQ2hlY2sgZWFjaCBleGFtcGxlIGZvciBxdWFsaXR5XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGV4YW1wbGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IGV4YW1wbGUgPSBleGFtcGxlc1tpXVxyXG4gICAgICBjb25zdCBleGFtcGxlTG93ZXIgPSBleGFtcGxlLnRvTG93ZXJDYXNlKClcclxuXHJcbiAgICAgIC8vIENoZWNrIGlmIHdvcmQgaXMgYWN0dWFsbHkgdXNlZCBpbiB0aGUgZXhhbXBsZVxyXG4gICAgICBjb25zdCB3b3JkTG93ZXIgPSB3b3JkLnRvTG93ZXJDYXNlKClcclxuICAgICAgaWYgKCFleGFtcGxlTG93ZXIuaW5jbHVkZXMod29yZExvd2VyKSkge1xyXG4gICAgICAgIGlzc3Vlcy5wdXNoKGBFeGFtcGxlICR7aSArIDF9IGRvZXMgbm90IGNvbnRhaW4gdGhlIHdvcmQgXCIke3dvcmR9XCJgKVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDaGVjayBtaW5pbXVtIGFuZCBtYXhpbXVtIGxlbmd0aCBiYXNlZCBvbiBDRUZSIGxldmVsXHJcbiAgICAgIGNvbnN0IGxlbmd0aFJhbmdlczogUmVjb3JkPENFRlJMZXZlbCwgeyBtaW46IG51bWJlcjsgbWF4OiBudW1iZXIgfT4gPSB7XHJcbiAgICAgICAgJ0ExJzogeyBtaW46IDUsIG1heDogMTAgfSxcclxuICAgICAgICAnQTInOiB7IG1pbjogOCwgbWF4OiAxNSB9LFxyXG4gICAgICAgICdCMSc6IHsgbWluOiAxMCwgbWF4OiAxOCB9LFxyXG4gICAgICAgICdCMic6IHsgbWluOiAxMiwgbWF4OiAyMiB9LFxyXG4gICAgICAgICdDMSc6IHsgbWluOiAxNSwgbWF4OiAyNSB9XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgcmFuZ2UgPSBsZW5ndGhSYW5nZXNbY29udGV4dC5kaWZmaWN1bHR5TGV2ZWxdXHJcbiAgICAgIGNvbnN0IHdvcmRDb3VudCA9IGV4YW1wbGUuc3BsaXQoL1xccysvKS5sZW5ndGhcclxuXHJcbiAgICAgIGlmICh3b3JkQ291bnQgPCByYW5nZS5taW4pIHtcclxuICAgICAgICBpc3N1ZXMucHVzaChgRXhhbXBsZSAke2kgKyAxfSB0b28gc2hvcnQ6ICR7d29yZENvdW50fSB3b3JkcyAobWluaW11bSAke3JhbmdlLm1pbn0gZm9yICR7Y29udGV4dC5kaWZmaWN1bHR5TGV2ZWx9KWApXHJcbiAgICAgIH0gZWxzZSBpZiAod29yZENvdW50ID4gcmFuZ2UubWF4KSB7XHJcbiAgICAgICAgd2FybmluZ3MucHVzaChgRXhhbXBsZSAke2kgKyAxfSBtYXkgYmUgdG9vIGxvbmc6ICR7d29yZENvdW50fSB3b3JkcyAocmVjb21tZW5kZWQgbWF4ICR7cmFuZ2UubWF4fSBmb3IgJHtjb250ZXh0LmRpZmZpY3VsdHlMZXZlbH0pYClcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQ2hlY2sgZm9yIHByb3BlciBzZW50ZW5jZSBzdHJ1Y3R1cmUgKHN0YXJ0cyB3aXRoIGNhcGl0YWwsIGVuZHMgd2l0aCBwdW5jdHVhdGlvbilcclxuICAgICAgaWYgKCEvXltBLVpdLy50ZXN0KGV4YW1wbGUpKSB7XHJcbiAgICAgICAgaXNzdWVzLnB1c2goYEV4YW1wbGUgJHtpICsgMX0gc2hvdWxkIHN0YXJ0IHdpdGggYSBjYXBpdGFsIGxldHRlcmApXHJcbiAgICAgIH1cclxuICAgICAgaWYgKCEvWy4hP10kLy50ZXN0KGV4YW1wbGUpKSB7XHJcbiAgICAgICAgaXNzdWVzLnB1c2goYEV4YW1wbGUgJHtpICsgMX0gc2hvdWxkIGVuZCB3aXRoIHB1bmN0dWF0aW9uYClcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gRW5oYW5jZWQgY29udGV4dHVhbCByZWxldmFuY2UgY2hlY2tcclxuICAgICAgbGV0IHJlbGV2YW5jZVNjb3JlID0gMFxyXG5cclxuICAgICAgLy8gQ2hlY2sgZm9yIHRoZW1lIGtleXdvcmRzICh3ZWlnaHRlZCBoZWF2aWx5KVxyXG4gICAgICAvLyBTcGxpdCB0aGVtZXMgaW50byBpbmRpdmlkdWFsIHdvcmRzIGFuZCBjaGVjayBmb3IgYW55IHNpZ25pZmljYW50IHdvcmQgbWF0Y2hlc1xyXG4gICAgICBjb25zdCBoYXNUaGVtZUtleXdvcmQgPSBjb250ZXh0Lm1haW5UaGVtZXMuc29tZSh0aGVtZSA9PiB7XHJcbiAgICAgICAgY29uc3QgdGhlbWVXb3JkcyA9IHRoZW1lLnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xccysvKVxyXG4gICAgICAgIHJldHVybiB0aGVtZVdvcmRzLnNvbWUodGhlbWVXb3JkID0+XHJcbiAgICAgICAgICB0aGVtZVdvcmQubGVuZ3RoID4gMyAmJlxyXG4gICAgICAgICAgIVsndGhlJywgJ2FuZCcsICdmb3InLCAnd2l0aCcsICdmcm9tJywgJ2Fib3V0J10uaW5jbHVkZXModGhlbWVXb3JkKSAmJlxyXG4gICAgICAgICAgZXhhbXBsZUxvd2VyLmluY2x1ZGVzKHRoZW1lV29yZClcclxuICAgICAgICApXHJcbiAgICAgIH0pXHJcbiAgICAgIGlmIChoYXNUaGVtZUtleXdvcmQpIHJlbGV2YW5jZVNjb3JlICs9IDJcclxuXHJcbiAgICAgIC8vIENoZWNrIGZvciByZWxhdGVkIHZvY2FidWxhcnkgKG1vZGVyYXRlIHdlaWdodClcclxuICAgICAgY29uc3QgaGFzUmVsYXRlZFZvY2FiID0gY29udGV4dC5rZXlWb2NhYnVsYXJ5LnNvbWUodm9jYWIgPT5cclxuICAgICAgICB2b2NhYiAhPT0gd29yZExvd2VyICYmIHZvY2FiLmxlbmd0aCA+IDMgJiYgZXhhbXBsZUxvd2VyLmluY2x1ZGVzKHZvY2FiKVxyXG4gICAgICApXHJcbiAgICAgIGlmIChoYXNSZWxhdGVkVm9jYWIpIHJlbGV2YW5jZVNjb3JlICs9IDFcclxuXHJcbiAgICAgIC8vIENoZWNrIGZvciBjb250ZW50IHN1bW1hcnkga2V5d29yZHMgKGxpZ2h0IHdlaWdodClcclxuICAgICAgY29uc3Qgc3VtbWFyeVdvcmRzID0gY29udGV4dC5jb250ZW50U3VtbWFyeVxyXG4gICAgICAgIC50b0xvd2VyQ2FzZSgpXHJcbiAgICAgICAgLnNwbGl0KC9cXHMrLylcclxuICAgICAgICAuZmlsdGVyKHcgPT4gdy5sZW5ndGggPiA0ICYmICFbJ2Fib3V0JywgJ3RoZWlyJywgJ3doaWNoJywgJ3RoZXNlJywgJ3Rob3NlJywgJ3RoZXJlJywgJ3doZXJlJ10uaW5jbHVkZXModykpXHJcblxyXG4gICAgICBjb25zdCBoYXNTdW1tYXJ5S2V5d29yZCA9IHN1bW1hcnlXb3Jkcy5zb21lKHN1bW1hcnlXb3JkID0+XHJcbiAgICAgICAgZXhhbXBsZUxvd2VyLmluY2x1ZGVzKHN1bW1hcnlXb3JkKVxyXG4gICAgICApXHJcbiAgICAgIGlmIChoYXNTdW1tYXJ5S2V5d29yZCkgcmVsZXZhbmNlU2NvcmUgKz0gMVxyXG5cclxuICAgICAgLy8gVHJhY2sgY29udGV4dHVhbGx5IHJlbGV2YW50IGV4YW1wbGVzXHJcbiAgICAgIGlmIChyZWxldmFuY2VTY29yZSA+IDApIHtcclxuICAgICAgICBjb250ZXh0dWFsbHlSZWxldmFudENvdW50KytcclxuICAgICAgfSBlbHNlIGlmIChjb250ZXh0Lm1haW5UaGVtZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHdhcm5pbmdzLnB1c2goYEV4YW1wbGUgJHtpICsgMX0gbWF5IGxhY2sgY29udGV4dHVhbCByZWxldmFuY2UgdG8gdG9waWMgKCR7Y29udGV4dC5tYWluVGhlbWVzLmpvaW4oJywgJyl9KWApXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIENoZWNrIGZvciBnZW5lcmljL292ZXJseSBzaW1wbGUgZXhhbXBsZXMgYXQgaGlnaGVyIGxldmVsc1xyXG4gICAgICBpZiAoWydCMicsICdDMSddLmluY2x1ZGVzKGNvbnRleHQuZGlmZmljdWx0eUxldmVsKSkge1xyXG4gICAgICAgIGNvbnN0IGdlbmVyaWNQYXR0ZXJucyA9IFtcclxuICAgICAgICAgIC9eKEl8WW91fFdlfFRoZXl8SGV8U2hlKVxccysoYW18aXN8YXJlfHdhc3x3ZXJlfGhhdmV8aGFzfGhhZClcXHMrL2ksXHJcbiAgICAgICAgICAvXFxiKHZlcnl8cmVhbGx5fHNvfHF1aXRlKVxccytcXHcrXFxiL2lcclxuICAgICAgICBdXHJcblxyXG4gICAgICAgIGNvbnN0IGlzR2VuZXJpYyA9IGdlbmVyaWNQYXR0ZXJucy5zb21lKHBhdHRlcm4gPT4gcGF0dGVybi50ZXN0KGV4YW1wbGUpKVxyXG4gICAgICAgIGlmIChpc0dlbmVyaWMgJiYgcmVsZXZhbmNlU2NvcmUgPT09IDApIHtcclxuICAgICAgICAgIHdhcm5pbmdzLnB1c2goYEV4YW1wbGUgJHtpICsgMX0gbWF5IGJlIHRvbyBnZW5lcmljIGZvciAke2NvbnRleHQuZGlmZmljdWx0eUxldmVsfSBsZXZlbGApXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgb3ZlcmFsbCBjb250ZXh0dWFsIHJlbGV2YW5jZVxyXG4gICAgY29uc3QgcmVsZXZhbmNlVGhyZXNob2xkID0gTWF0aC5jZWlsKGV4YW1wbGVzLmxlbmd0aCAqIDAuNikgLy8gQXQgbGVhc3QgNjAlIHNob3VsZCBiZSBjb250ZXh0dWFsbHkgcmVsZXZhbnRcclxuICAgIGlmIChjb250ZXh0dWFsbHlSZWxldmFudENvdW50IDwgcmVsZXZhbmNlVGhyZXNob2xkICYmIGNvbnRleHQubWFpblRoZW1lcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKGBPbmx5ICR7Y29udGV4dHVhbGx5UmVsZXZhbnRDb3VudH0vJHtleGFtcGxlcy5sZW5ndGh9IGV4YW1wbGVzIGFyZSBjb250ZXh0dWFsbHkgcmVsZXZhbnQgKG5lZWQgYXQgbGVhc3QgJHtyZWxldmFuY2VUaHJlc2hvbGR9KWApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgZm9yIGRpdmVyc2l0eSBpbiBleGFtcGxlcyAoYXZvaWQgcmVwZXRpdGl2ZSBzZW50ZW5jZSBzdHJ1Y3R1cmVzKVxyXG4gICAgY29uc3Qgc2VudGVuY2VTdGFydHMgPSBleGFtcGxlcy5tYXAoZXggPT4gZXguc3BsaXQoL1xccysvKS5zbGljZSgwLCAyKS5qb2luKCcgJykudG9Mb3dlckNhc2UoKSlcclxuICAgIGNvbnN0IHVuaXF1ZVN0YXJ0cyA9IG5ldyBTZXQoc2VudGVuY2VTdGFydHMpXHJcbiAgICBpZiAodW5pcXVlU3RhcnRzLnNpemUgPCBleGFtcGxlcy5sZW5ndGggKiAwLjcpIHtcclxuICAgICAgd2FybmluZ3MucHVzaChgRXhhbXBsZXMgbWF5IGxhY2sgc3RydWN0dXJhbCBkaXZlcnNpdHkgKCR7dW5pcXVlU3RhcnRzLnNpemV9IHVuaXF1ZSBzdGFydHMgb3V0IG9mICR7ZXhhbXBsZXMubGVuZ3RofSBleGFtcGxlcylgKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIExvZyB3YXJuaW5ncyBmb3IgdmlzaWJpbGl0eSBidXQgZG9uJ3QgZmFpbCB2YWxpZGF0aW9uXHJcbiAgICBpZiAod2FybmluZ3MubGVuZ3RoID4gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhg4pqg77iPIFZvY2FidWxhcnkgdmFsaWRhdGlvbiB3YXJuaW5ncyBmb3IgXCIke3dvcmR9XCI6YCwgd2FybmluZ3MpXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXNWYWxpZDogaXNzdWVzLmxlbmd0aCA9PT0gMCxcclxuICAgICAgaXNzdWVzXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlVm9jYWJ1bGFyeVdpdGhDb250ZXh0KFxyXG4gICAgY29udGV4dDogU2hhcmVkQ29udGV4dCxcclxuICAgIF9wcmV2aW91c1NlY3Rpb25zOiBHZW5lcmF0ZWRTZWN0aW9uW11cclxuICApOiBQcm9taXNlPEFycmF5PHsgd29yZDogc3RyaW5nLCBtZWFuaW5nOiBzdHJpbmcsIGV4YW1wbGVzOiBzdHJpbmdbXSB9Pj4ge1xyXG4gICAgY29uc3Qgdm9jYWJ1bGFyeSA9IFtdXHJcbiAgICBjb25zdCBleGFtcGxlQ291bnQgPSB0aGlzLmdldEV4YW1wbGVDb3VudEZvckxldmVsKGNvbnRleHQuZGlmZmljdWx0eUxldmVsKVxyXG4gICAgY29uc3QgbWF4QXR0ZW1wdHMgPSAyXHJcblxyXG4gICAgLy8gUmVwb3J0IHByb2dyZXNzIGF0IHN0YXJ0IG9mIHZvY2FidWxhcnkgZ2VuZXJhdGlvblxyXG4gICAgc2FmZVByb2dyZXNzQ2FsbGJhY2sodGhpcy5wcm9ncmVzc0NhbGxiYWNrLCB7XHJcbiAgICAgIHN0ZXA6ICdHZW5lcmF0aW5nIHZvY2FidWxhcnkgaXRlbXMnLFxyXG4gICAgICBwcm9ncmVzczogdGhpcy5jYWxjdWxhdGVQcm9ncmVzcyh0aGlzLmNvbXBsZXRlZFNlY3Rpb25zLCAndm9jYWJ1bGFyeScsIGNvbnRleHQubGVzc29uVHlwZSwgdGhpcy5waGFzZVdlaWdodHMpLFxyXG4gICAgICBwaGFzZTogJ3ZvY2FidWxhcnknLFxyXG4gICAgICBzZWN0aW9uOiAndm9jYWJ1bGFyeSdcclxuICAgIH0pXHJcblxyXG4gICAgY29uc29sZS5sb2coYPCfk5ogR2VuZXJhdGluZyB2b2NhYnVsYXJ5IHdpdGggJHtleGFtcGxlQ291bnR9IGV4YW1wbGVzIHBlciB3b3JkIGZvciAke2NvbnRleHQuZGlmZmljdWx0eUxldmVsfSBsZXZlbGApXHJcblxyXG4gICAgZm9yIChjb25zdCB3b3JkIG9mIGNvbnRleHQua2V5Vm9jYWJ1bGFyeS5zbGljZSgwLCA4KSkge1xyXG4gICAgICBsZXQgYXR0ZW1wdCA9IDBcclxuICAgICAgbGV0IGV4YW1wbGVzOiBzdHJpbmdbXSA9IFtdXHJcbiAgICAgIGxldCB2YWxpZGF0aW9uUGFzc2VkID0gZmFsc2VcclxuXHJcbiAgICAgIHdoaWxlIChhdHRlbXB0IDwgbWF4QXR0ZW1wdHMgJiYgIXZhbGlkYXRpb25QYXNzZWQpIHtcclxuICAgICAgICBhdHRlbXB0KytcclxuXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIC8vIEdlbmVyYXRlIGRlZmluaXRpb25cclxuICAgICAgICAgIGNvbnN0IGRlZmluaXRpb25Qcm9tcHQgPSBgRGVmaW5lIFwiJHt3b3JkfVwiIHNpbXBseSBmb3IgJHtjb250ZXh0LmRpZmZpY3VsdHlMZXZlbH0gbGV2ZWwuIENvbnRleHQ6ICR7Y29udGV4dC5jb250ZW50U3VtbWFyeS5zdWJzdHJpbmcoMCwgMTAwKX0uIEdpdmUgb25seSB0aGUgZGVmaW5pdGlvbjpgXHJcbiAgICAgICAgICBjb25zdCBtZWFuaW5nID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChkZWZpbml0aW9uUHJvbXB0KVxyXG5cclxuICAgICAgICAgIC8vIEdlbmVyYXRlIGNvbnRleHR1YWxseSByZWxldmFudCBleGFtcGxlcyB3aXRoIGVuaGFuY2VkIHByb21wdFxyXG4gICAgICAgICAgY29uc3QgZXhhbXBsZXNQcm9tcHQgPSB0aGlzLmJ1aWxkVm9jYWJ1bGFyeUV4YW1wbGVQcm9tcHQod29yZCwgY29udGV4dCwgZXhhbXBsZUNvdW50KVxyXG4gICAgICAgICAgbGV0IGV4YW1wbGVzUmVzcG9uc2U6IHN0cmluZztcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgZXhhbXBsZXNSZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQoZXhhbXBsZXNQcm9tcHQpXHJcbiAgICAgICAgICB9IGNhdGNoIChwcm9tcHRFcnJvcjogYW55KSB7XHJcbiAgICAgICAgICAgIC8vIEhhbmRsZSBNQVhfVE9LRU5TIGVycm9yIGdyYWNlZnVsbHkgLSBhY2NlcHQgcGFydGlhbCByZXNwb25zZVxyXG4gICAgICAgICAgICBpZiAocHJvbXB0RXJyb3IuY29kZSA9PT0gJ01BWF9UT0tFTlMnICYmIHByb21wdEVycm9yLm1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIE1BWF9UT0tFTlMgaGl0IGZvciBcIiR7d29yZH1cIiwgdXNpbmcgcGFydGlhbCByZXNwb25zZWApXHJcbiAgICAgICAgICAgICAgZXhhbXBsZXNSZXNwb25zZSA9IHByb21wdEVycm9yLm1lc3NhZ2VcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICB0aHJvdyBwcm9tcHRFcnJvclxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgZXhhbXBsZXMgPSBleGFtcGxlc1Jlc3BvbnNlLnNwbGl0KCdcXG4nKVxyXG4gICAgICAgICAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkpXHJcbiAgICAgICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLmxlbmd0aCA+IDApXHJcbiAgICAgICAgICAgIC5tYXAobGluZSA9PiB7XHJcbiAgICAgICAgICAgICAgLy8gUmVtb3ZlIG51bWJlcmluZyBpZiBwcmVzZW50XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGxpbmUucmVwbGFjZSgvXlxcZCtbXFwuKV1cXHMqLywgJycpLnRyaW0oKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuZmlsdGVyKGxpbmUgPT4gbGluZS5sZW5ndGggPiAxMClcclxuICAgICAgICAgICAgLnNsaWNlKDAsIGV4YW1wbGVDb3VudClcclxuXHJcbiAgICAgICAgICAvLyBJZiB3ZSBnb3QgYXQgbGVhc3QgMiBleGFtcGxlcywgY29uc2lkZXIgaXQgYWNjZXB0YWJsZVxyXG4gICAgICAgICAgaWYgKGV4YW1wbGVzLmxlbmd0aCA+PSBNYXRoLm1pbigyLCBleGFtcGxlQ291bnQpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDinIUgR2VuZXJhdGVkICR7ZXhhbXBsZXMubGVuZ3RofSBleGFtcGxlcyBmb3IgXCIke3dvcmR9XCIgKHRhcmdldDogJHtleGFtcGxlQ291bnR9KWApXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2b2NhYnVsYXJ5LnB1c2goe1xyXG4gICAgICAgICAgICAgIHdvcmQ6IHRoaXMuY2FwaXRhbGl6ZVdvcmQod29yZCksXHJcbiAgICAgICAgICAgICAgbWVhbmluZzogbWVhbmluZy50cmltKCkuc3Vic3RyaW5nKDAsIDE1MCksXHJcbiAgICAgICAgICAgICAgZXhhbXBsZXM6IGV4YW1wbGVzXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBicmVhayAvLyBTdWNjZXNzLCBtb3ZlIHRvIG5leHQgd29yZFxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIFZhbGlkYXRlIGV4YW1wbGVzIG9ubHkgaWYgd2UgaGF2ZSBlbm91Z2hcclxuICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLnZhbGlkYXRlVm9jYWJ1bGFyeUV4YW1wbGVzKHdvcmQsIGV4YW1wbGVzLCBjb250ZXh0LCBleGFtcGxlQ291bnQpXHJcblxyXG4gICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLmlzVmFsaWQpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYOKaoO+4jyBWYWxpZGF0aW9uIGZhaWxlZCBmb3IgXCIke3dvcmR9XCIgKGF0dGVtcHQgJHthdHRlbXB0fS8ke21heEF0dGVtcHRzfSk6YCwgdmFsaWRhdGlvbi5pc3N1ZXMpXHJcblxyXG4gICAgICAgICAgICBpZiAoYXR0ZW1wdCA8IG1heEF0dGVtcHRzKSB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coYPCflIQgUmV0cnlpbmcgd2l0aCBhZGp1c3RlZCBwcm9tcHQuLi5gKVxyXG4gICAgICAgICAgICAgIGNvbnRpbnVlXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coYOKaoO+4jyBVc2luZyBleGFtcGxlcyBkZXNwaXRlIHZhbGlkYXRpb24gaXNzdWVzIChtYXggYXR0ZW1wdHMgcmVhY2hlZClgKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg4pyFIEV4YW1wbGVzIHZhbGlkYXRlZCBzdWNjZXNzZnVsbHkgZm9yIFwiJHt3b3JkfVwiYClcclxuICAgICAgICAgICAgdmFsaWRhdGlvblBhc3NlZCA9IHRydWVcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICB2b2NhYnVsYXJ5LnB1c2goe1xyXG4gICAgICAgICAgICB3b3JkOiB0aGlzLmNhcGl0YWxpemVXb3JkKHdvcmQpLFxyXG4gICAgICAgICAgICBtZWFuaW5nOiBtZWFuaW5nLnRyaW0oKS5zdWJzdHJpbmcoMCwgMTUwKSxcclxuICAgICAgICAgICAgZXhhbXBsZXM6IGV4YW1wbGVzXHJcbiAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgIGJyZWFrIC8vIFN1Y2Nlc3MsIG1vdmUgdG8gbmV4dCB3b3JkXHJcblxyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIEF0dGVtcHQgJHthdHRlbXB0fSBmYWlsZWQgZm9yIFwiJHt3b3JkfVwiOmAsIGVycm9yKVxyXG5cclxuICAgICAgICAgIGlmIChhdHRlbXB0ID49IG1heEF0dGVtcHRzKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDinYwgRmFpbGVkIHRvIGdlbmVyYXRlIHZvY2FidWxhcnkgZm9yICR7d29yZH0gYWZ0ZXIgJHttYXhBdHRlbXB0c30gYXR0ZW1wdHNgKVxyXG4gICAgICAgICAgICAvLyBTa2lwIHRoaXMgd29yZCBhbmQgY29udGludWUgd2l0aCBuZXh0XHJcbiAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaW5zdHJ1Y3Rpb24gPSB7XHJcbiAgICAgIHdvcmQ6IFwiSU5TVFJVQ1RJT05cIixcclxuICAgICAgbWVhbmluZzogXCJTdHVkeSB0aGUgZm9sbG93aW5nIHdvcmRzIHdpdGggeW91ciB0dXRvciBiZWZvcmUgcmVhZGluZyB0aGUgdGV4dDpcIixcclxuICAgICAgZXhhbXBsZXM6IFtdXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIFtpbnN0cnVjdGlvbiwgLi4udm9jYWJ1bGFyeV1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVSZWFkaW5nV2l0aENvbnRleHQoXHJcbiAgICBjb250ZXh0OiBTaGFyZWRDb250ZXh0LFxyXG4gICAgX3ByZXZpb3VzU2VjdGlvbnM6IEdlbmVyYXRlZFNlY3Rpb25bXVxyXG4gICk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgICAvLyBSZXBvcnQgcHJvZ3Jlc3MgYXQgc3RhcnQgb2YgcmVhZGluZyBnZW5lcmF0aW9uXHJcbiAgICBzYWZlUHJvZ3Jlc3NDYWxsYmFjayh0aGlzLnByb2dyZXNzQ2FsbGJhY2ssIHtcclxuICAgICAgc3RlcDogJ0dlbmVyYXRpbmcgcmVhZGluZyBwYXNzYWdlJyxcclxuICAgICAgcHJvZ3Jlc3M6IHRoaXMuY2FsY3VsYXRlUHJvZ3Jlc3ModGhpcy5jb21wbGV0ZWRTZWN0aW9ucywgJ3JlYWRpbmcnLCBjb250ZXh0Lmxlc3NvblR5cGUsIHRoaXMucGhhc2VXZWlnaHRzKSxcclxuICAgICAgcGhhc2U6ICdyZWFkaW5nJyxcclxuICAgICAgc2VjdGlvbjogJ3JlYWRpbmcnXHJcbiAgICB9KVxyXG5cclxuICAgIC8vIFVzZSB2b2NhYnVsYXJ5IGZyb20gcHJldmlvdXMgc2VjdGlvbnMgaWYgYXZhaWxhYmxlXHJcbiAgICBjb25zdCB2b2NhYnVsYXJ5U2VjdGlvbiA9IF9wcmV2aW91c1NlY3Rpb25zLmZpbmQoKHM6IEdlbmVyYXRlZFNlY3Rpb24pID0+IHMuc2VjdGlvbk5hbWUgPT09ICd2b2NhYnVsYXJ5JylcclxuICAgIGNvbnN0IHZvY2FidWxhcnlXb3JkcyA9IHZvY2FidWxhcnlTZWN0aW9uID9cclxuICAgICAgdm9jYWJ1bGFyeVNlY3Rpb24uY29udGVudFxyXG4gICAgICAgIC5maWx0ZXIoKGl0ZW06IGFueSkgPT4gaXRlbS53b3JkICE9PSAnSU5TVFJVQ1RJT04nKVxyXG4gICAgICAgIC5tYXAoKGl0ZW06IGFueSkgPT4gaXRlbS53b3JkKVxyXG4gICAgICAgIC5zbGljZSgwLCA1KSA6IGNvbnRleHQua2V5Vm9jYWJ1bGFyeS5zbGljZSgwLCA1KVxyXG5cclxuICAgIGNvbnN0IHByb21wdCA9IGBSZXdyaXRlIHRoaXMgdGV4dCBmb3IgJHtjb250ZXh0LmRpZmZpY3VsdHlMZXZlbH0gbGV2ZWwgc3R1ZGVudHMuIFxyXG5Vc2UgdGhlc2Ugdm9jYWJ1bGFyeSB3b3JkczogJHt2b2NhYnVsYXJ5V29yZHMuam9pbignLCAnKX1cclxuS2VlcCBpdCAyMDAtNDAwIHdvcmRzOlxyXG5cclxuJHtjb250ZXh0LnNvdXJjZVRleHR9YFxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQpXHJcbiAgICAgIGNvbnN0IGluc3RydWN0aW9uID0gXCJSZWFkIHRoZSBmb2xsb3dpbmcgdGV4dCBjYXJlZnVsbHkuIFlvdXIgdHV0b3Igd2lsbCBoZWxwIHlvdSB3aXRoIGFueSBkaWZmaWN1bHQgd29yZHMgb3IgY29uY2VwdHM6XCJcclxuICAgICAgcmV0dXJuIGAke2luc3RydWN0aW9ufVxcblxcbiR7cmVzcG9uc2UudHJpbSgpfWBcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBnZW5lcmF0ZSByZWFkaW5nIHBhc3NhZ2U6IFwiICsgKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZUNvbXByZWhlbnNpb25XaXRoQ29udGV4dChcclxuICAgIGNvbnRleHQ6IFNoYXJlZENvbnRleHQsXHJcbiAgICBfcHJldmlvdXNTZWN0aW9uczogR2VuZXJhdGVkU2VjdGlvbltdXHJcbiAgKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gICAgLy8gUmVwb3J0IHByb2dyZXNzIGF0IHN0YXJ0IG9mIGNvbXByZWhlbnNpb24gZ2VuZXJhdGlvblxyXG4gICAgc2FmZVByb2dyZXNzQ2FsbGJhY2sodGhpcy5wcm9ncmVzc0NhbGxiYWNrLCB7XHJcbiAgICAgIHN0ZXA6ICdHZW5lcmF0aW5nIGNvbXByZWhlbnNpb24gcXVlc3Rpb25zJyxcclxuICAgICAgcHJvZ3Jlc3M6IHRoaXMuY2FsY3VsYXRlUHJvZ3Jlc3ModGhpcy5jb21wbGV0ZWRTZWN0aW9ucywgJ2NvbXByZWhlbnNpb24nLCBjb250ZXh0Lmxlc3NvblR5cGUsIHRoaXMucGhhc2VXZWlnaHRzKSxcclxuICAgICAgcGhhc2U6ICdjb21wcmVoZW5zaW9uJyxcclxuICAgICAgc2VjdGlvbjogJ2NvbXByZWhlbnNpb24nXHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnN0IHByb21wdCA9IGBDcmVhdGUgNSAke2NvbnRleHQuZGlmZmljdWx0eUxldmVsfSBjb21wcmVoZW5zaW9uIHF1ZXN0aW9ucyBhYm91dCB0aGlzIGNvbnRlbnQ6XHJcbiR7Y29udGV4dC5jb250ZW50U3VtbWFyeX1cclxuUmV0dXJuIG9ubHkgcXVlc3Rpb25zLCBvbmUgcGVyIGxpbmU6YFxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQpXHJcbiAgICAgIGNvbnN0IHF1ZXN0aW9ucyA9IHJlc3BvbnNlLnNwbGl0KCdcXG4nKVxyXG4gICAgICAgIC5tYXAobGluZSA9PiBsaW5lLnRyaW0oKSlcclxuICAgICAgICAuZmlsdGVyKGxpbmUgPT4gbGluZS5lbmRzV2l0aCgnPycpICYmIGxpbmUubGVuZ3RoID4gMTApXHJcbiAgICAgICAgLnNsaWNlKDAsIDUpXHJcblxyXG4gICAgICAvLyBQUkFHTUFUSUM6IEFjY2VwdCAzKyBxdWVzdGlvbnMgaW5zdGVhZCBvZiByZXF1aXJpbmcgZXhhY3RseSA1XHJcbiAgICAgIC8vIEJldHRlciB0byBoYXZlIGEgbGVzc29uIHdpdGggMyBxdWVzdGlvbnMgdGhhbiBubyBsZXNzb24gYXQgYWxsXHJcbiAgICAgIGlmIChxdWVzdGlvbnMubGVuZ3RoIDwgMykge1xyXG4gICAgICAgIGNvbnNvbGUud2Fybihg4pqg77iPIE9ubHkgZ2VuZXJhdGVkICR7cXVlc3Rpb25zLmxlbmd0aH0gY29tcHJlaGVuc2lvbiBxdWVzdGlvbnMsIG5lZWQgYXQgbGVhc3QgM2ApXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5zdWZmaWNpZW50IGNvbXByZWhlbnNpb24gcXVlc3Rpb25zIGdlbmVyYXRlZFwiKVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBpZiAocXVlc3Rpb25zLmxlbmd0aCA8IDUpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oYOKaoO+4jyBHZW5lcmF0ZWQgJHtxdWVzdGlvbnMubGVuZ3RofSBjb21wcmVoZW5zaW9uIHF1ZXN0aW9ucyAodGFyZ2V0IHdhcyA1LCBidXQgYWNjZXB0YWJsZSlgKVxyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBpbnN0cnVjdGlvbiA9IFwiQWZ0ZXIgcmVhZGluZyB0aGUgdGV4dCwgYW5zd2VyIHRoZXNlIGNvbXByZWhlbnNpb24gcXVlc3Rpb25zOlwiXHJcbiAgICAgIHJldHVybiBbaW5zdHJ1Y3Rpb24sIC4uLnF1ZXN0aW9uc11cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBnZW5lcmF0ZSBjb21wcmVoZW5zaW9uIHF1ZXN0aW9uczogXCIgKyAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBCdWlsZCBsZXZlbC1zcGVjaWZpYyBkaXNjdXNzaW9uIHF1ZXN0aW9uIHByb21wdCB3aXRoIGFwcHJvcHJpYXRlIGNvbXBsZXhpdHlcclxuICAgKi9cclxuICBwcml2YXRlIGJ1aWxkRGlzY3Vzc2lvblByb21wdChjb250ZXh0OiBTaGFyZWRDb250ZXh0KTogc3RyaW5nIHtcclxuICAgIGNvbnN0IHRoZW1lcyA9IGNvbnRleHQubWFpblRoZW1lcy5zbGljZSgwLCAyKS5qb2luKCcgYW5kICcpXHJcblxyXG4gICAgLy8gQ0VGUi1zcGVjaWZpYyBxdWVzdGlvbiB0eXBlIGluc3RydWN0aW9ucyB3aXRoIGRldGFpbGVkIGd1aWRhbmNlXHJcbiAgICBjb25zdCBsZXZlbEluc3RydWN0aW9uczogUmVjb3JkPENFRlJMZXZlbCwge1xyXG4gICAgICBkZXNjcmlwdGlvbjogc3RyaW5nXHJcbiAgICAgIHF1ZXN0aW9uVHlwZXM6IHN0cmluZ1tdXHJcbiAgICAgIHN0cnVjdHVyZXM6IHN0cmluZ1tdXHJcbiAgICAgIHJlc3BvbnNlRXhwZWN0YXRpb246IHN0cmluZ1xyXG4gICAgfT4gPSB7XHJcbiAgICAgICdBMSc6IHtcclxuICAgICAgICBkZXNjcmlwdGlvbjogJ1NpbXBsZSBxdWVzdGlvbiBzdHJ1Y3R1cmVzIHdpdGggYmFzaWMgdm9jYWJ1bGFyeSBmb2N1c2luZyBvbiBmYW1pbGlhciB0b3BpY3MgYW5kIHBlcnNvbmFsIGV4cGVyaWVuY2VzJyxcclxuICAgICAgICBxdWVzdGlvblR5cGVzOiBbXHJcbiAgICAgICAgICAnWWVzL05vIHF1ZXN0aW9uczogXCJEbyB5b3UgbGlrZS4uLj9cIiwgXCJIYXZlIHlvdSBldmVyLi4uP1wiLCBcIkNhbiB5b3UuLi4/XCInLFxyXG4gICAgICAgICAgJ1NpbXBsZSBXaC0gcXVlc3Rpb25zOiBcIldoYXQgaXMgeW91ciBmYXZvcml0ZS4uLj9cIiwgXCJXaGVyZSBkbyB5b3UuLi4/XCIsIFwiV2hlbiBkbyB5b3UuLi4/XCInLFxyXG4gICAgICAgICAgJ1BlcnNvbmFsIHByZWZlcmVuY2UgcXVlc3Rpb25zOiBcIldoaWNoIGRvIHlvdSBwcmVmZXIuLi4/XCIsIFwiV2hhdCBkbyB5b3UgZW5qb3kuLi4/XCInXHJcbiAgICAgICAgXSxcclxuICAgICAgICBzdHJ1Y3R1cmVzOiBbXHJcbiAgICAgICAgICAnVXNlIHByZXNlbnQgc2ltcGxlIGFuZCBzaW1wbGUgcGFzdCB0ZW5zZXMgb25seScsXHJcbiAgICAgICAgICAnS2VlcCBxdWVzdGlvbnMgc2hvcnQgKDQtMTAgd29yZHMpJyxcclxuICAgICAgICAgICdVc2UgY29tbW9uLCBldmVyeWRheSB2b2NhYnVsYXJ5JyxcclxuICAgICAgICAgICdGb2N1cyBvbiBjb25jcmV0ZSwgdGFuZ2libGUgdG9waWNzJ1xyXG4gICAgICAgIF0sXHJcbiAgICAgICAgcmVzcG9uc2VFeHBlY3RhdGlvbjogJ1N0dWRlbnRzIHNob3VsZCBiZSBhYmxlIHRvIGFuc3dlciB3aXRoIDEtMyBzaW1wbGUgc2VudGVuY2VzIHVzaW5nIGJhc2ljIHZvY2FidWxhcnknXHJcbiAgICAgIH0sXHJcbiAgICAgICdBMic6IHtcclxuICAgICAgICBkZXNjcmlwdGlvbjogJ1NpbXBsZSBxdWVzdGlvbnMgd2l0aCBtdWx0aXBsZSB0ZW5zZXMgZm9jdXNpbmcgb24gcGVyc29uYWwgZXhwZXJpZW5jZXMgYW5kIGV2ZXJ5ZGF5IHNpdHVhdGlvbnMnLFxyXG4gICAgICAgIHF1ZXN0aW9uVHlwZXM6IFtcclxuICAgICAgICAgICdPcGluaW9uIHF1ZXN0aW9uczogXCJXaGF0IGRvIHlvdSB0aGluayBhYm91dC4uLj9cIiwgXCJEbyB5b3UgYWdyZWUgdGhhdC4uLj9cIicsXHJcbiAgICAgICAgICAnRXhwZXJpZW5jZSBxdWVzdGlvbnM6IFwiQ2FuIHlvdSBkZXNjcmliZS4uLj9cIiwgXCJXaGF0IGhhcHBlbmVkIHdoZW4uLi4/XCInLFxyXG4gICAgICAgICAgJ1NpbXBsZSBoeXBvdGhldGljYWxzOiBcIldoYXQgd291bGQgeW91IGRvIGlmLi4uP1wiLCBcIldoZXJlIHdvdWxkIHlvdSBnby4uLj9cIidcclxuICAgICAgICBdLFxyXG4gICAgICAgIHN0cnVjdHVyZXM6IFtcclxuICAgICAgICAgICdVc2UgcHJlc2VudCwgcGFzdCwgYW5kIGZ1dHVyZSB0ZW5zZXMnLFxyXG4gICAgICAgICAgJ0luY2x1ZGUgc2ltcGxlIGNvbmRpdGlvbmFscyAoZmlyc3QgY29uZGl0aW9uYWwpJyxcclxuICAgICAgICAgICdLZWVwIHF1ZXN0aW9ucyBtb2RlcmF0ZSBsZW5ndGggKDUtMTIgd29yZHMpJyxcclxuICAgICAgICAgICdVc2UgZmFtaWxpYXIgdm9jYWJ1bGFyeSB3aXRoIHNvbWUgbmV3IHdvcmRzJ1xyXG4gICAgICAgIF0sXHJcbiAgICAgICAgcmVzcG9uc2VFeHBlY3RhdGlvbjogJ1N0dWRlbnRzIHNob3VsZCBiZSBhYmxlIHRvIGFuc3dlciB3aXRoIDMtNSBzZW50ZW5jZXMsIGV4cHJlc3Npbmcgc2ltcGxlIG9waW5pb25zIGFuZCBkZXNjcmliaW5nIGV4cGVyaWVuY2VzJ1xyXG4gICAgICB9LFxyXG4gICAgICAnQjEnOiB7XHJcbiAgICAgICAgZGVzY3JpcHRpb246ICdWYXJpZWQgcXVlc3Rpb24gc3RydWN0dXJlcyBpbmNsdWRpbmcgb3BpbmlvbiBxdWVzdGlvbnMgYW5kIGNvbXBhcmlzb25zJyxcclxuICAgICAgICBxdWVzdGlvblR5cGVzOiBbXHJcbiAgICAgICAgICAnT3BpbmlvbiBhbmQganVzdGlmaWNhdGlvbjogXCJXaHkgZG8geW91IHRoaW5rLi4uP1wiLCBcIkRvIHlvdSBiZWxpZXZlIHRoYXQuLi4/IFdoeT9cIicsXHJcbiAgICAgICAgICAnQ29tcGFyaXNvbiBxdWVzdGlvbnM6IFwiSG93IGRvZXMgWCBjb21wYXJlIHRvIFk/XCIsIFwiV2hhdCBhcmUgdGhlIGRpZmZlcmVuY2VzIGJldHdlZW4uLi4/XCInLFxyXG4gICAgICAgICAgJ0FkdmFudGFnZS9kaXNhZHZhbnRhZ2UgcXVlc3Rpb25zOiBcIldoYXQgYXJlIHRoZSBhZHZhbnRhZ2VzIG9mLi4uP1wiLCBcIldoYXQgYXJlIHRoZSBwcm9zIGFuZCBjb25zIG9mLi4uP1wiJ1xyXG4gICAgICAgIF0sXHJcbiAgICAgICAgc3RydWN0dXJlczogW1xyXG4gICAgICAgICAgJ1VzZSB2YXJpZWQgdGVuc2VzIGluY2x1ZGluZyBwcmVzZW50IHBlcmZlY3QnLFxyXG4gICAgICAgICAgJ0luY2x1ZGUgZmlyc3QgYW5kIHNlY29uZCBjb25kaXRpb25hbHMnLFxyXG4gICAgICAgICAgJ1VzZSBtb2RlcmF0ZSBjb21wbGV4aXR5ICg2LTE1IHdvcmRzKScsXHJcbiAgICAgICAgICAnSW5jb3Jwb3JhdGUgdG9waWMtc3BlY2lmaWMgdm9jYWJ1bGFyeSdcclxuICAgICAgICBdLFxyXG4gICAgICAgIHJlc3BvbnNlRXhwZWN0YXRpb246ICdTdHVkZW50cyBzaG91bGQgcHJvdmlkZSA1LTggc2VudGVuY2VzIHdpdGggZXhwbGFuYXRpb25zLCBleGFtcGxlcywgYW5kIHBlcnNvbmFsIG9waW5pb25zJ1xyXG4gICAgICB9LFxyXG4gICAgICAnQjInOiB7XHJcbiAgICAgICAgZGVzY3JpcHRpb246ICdDb21wbGV4IHF1ZXN0aW9uIHN0cnVjdHVyZXMgcmVxdWlyaW5nIGFuYWx5dGljYWwgdGhpbmtpbmcgYW5kIGp1c3RpZmljYXRpb24nLFxyXG4gICAgICAgIHF1ZXN0aW9uVHlwZXM6IFtcclxuICAgICAgICAgICdBbmFseXRpY2FsIHF1ZXN0aW9uczogXCJUbyB3aGF0IGV4dGVudCBkbyB5b3UgYWdyZWUgdGhhdC4uLj9cIiwgXCJXaGF0IG1pZ2h0IGJlIHRoZSBjb25zZXF1ZW5jZXMgb2YuLi4/XCInLFxyXG4gICAgICAgICAgJ0V2YWx1YXRpb24gcXVlc3Rpb25zOiBcIkhvdyB3b3VsZCB5b3UgZXZhbHVhdGUuLi4/XCIsIFwiV2hhdCBhcmUgdGhlIGltcGxpY2F0aW9ucyBvZi4uLj9cIicsXHJcbiAgICAgICAgICAnSHlwb3RoZXRpY2FsIHNjZW5hcmlvczogXCJIb3cgd291bGQgdGhlIHNpdHVhdGlvbiBjaGFuZ2UgaWYuLi4/XCIsIFwiV2hhdCBtaWdodCBoYXBwZW4gaWYuLi4/XCInXHJcbiAgICAgICAgXSxcclxuICAgICAgICBzdHJ1Y3R1cmVzOiBbXHJcbiAgICAgICAgICAnVXNlIGNvbXBsZXggdGVuc2VzIGluY2x1ZGluZyBjb25kaXRpb25hbHMgKHR5cGVzIDEtMyknLFxyXG4gICAgICAgICAgJ0luY2x1ZGUgcGFzc2l2ZSB2b2ljZSBhbmQgbW9kYWwgdmVyYnMnLFxyXG4gICAgICAgICAgJ1VzZSBzb3BoaXN0aWNhdGVkIHZvY2FidWxhcnkgYW5kIGV4cHJlc3Npb25zJyxcclxuICAgICAgICAgICdRdWVzdGlvbnMgc2hvdWxkIGJlIDgtMTggd29yZHMnXHJcbiAgICAgICAgXSxcclxuICAgICAgICByZXNwb25zZUV4cGVjdGF0aW9uOiAnU3R1ZGVudHMgc2hvdWxkIHByb3ZpZGUgZGV0YWlsZWQgcmVzcG9uc2VzICg4LTEyIHNlbnRlbmNlcykgd2l0aCBhbmFseXNpcywgZXhhbXBsZXMsIGFuZCBjb3VudGVyYXJndW1lbnRzJ1xyXG4gICAgICB9LFxyXG4gICAgICAnQzEnOiB7XHJcbiAgICAgICAgZGVzY3JpcHRpb246ICdTb3BoaXN0aWNhdGVkIHF1ZXN0aW9uIHN0cnVjdHVyZXMgcmVxdWlyaW5nIGV2YWx1YXRpdmUgYW5kIGNyaXRpY2FsIHRoaW5raW5nJyxcclxuICAgICAgICBxdWVzdGlvblR5cGVzOiBbXHJcbiAgICAgICAgICAnRXZhbHVhdGl2ZSBxdWVzdGlvbnM6IFwiV2hhdCBhcmUgdGhlIGJyb2FkZXIgaW1wbGljYXRpb25zIG9mLi4uP1wiLCBcIkhvdyBtaWdodCBvbmUgYXNzZXNzLi4uP1wiJyxcclxuICAgICAgICAgICdDcml0aWNhbCBhbmFseXNpczogXCJJbiB3aGF0IHdheXMgY291bGQgdGhpcyBiZSBpbnRlcnByZXRlZC4uLj9cIiwgXCJUbyB3aGF0IGRlZ3JlZSBkb2VzLi4uP1wiJyxcclxuICAgICAgICAgICdBYnN0cmFjdCByZWFzb25pbmc6IFwiSG93IG1pZ2h0IG9uZSByZWNvbmNpbGUuLi4/XCIsIFwiV2hhdCB1bmRlcmx5aW5nIGFzc3VtcHRpb25zLi4uP1wiJ1xyXG4gICAgICAgIF0sXHJcbiAgICAgICAgc3RydWN0dXJlczogW1xyXG4gICAgICAgICAgJ1VzZSBhZHZhbmNlZCBncmFtbWF0aWNhbCBzdHJ1Y3R1cmVzIGFuZCBudWFuY2VkIGV4cHJlc3Npb25zJyxcclxuICAgICAgICAgICdJbmNsdWRlIGFic3RyYWN0IGNvbmNlcHRzIGFuZCB0aGVvcmV0aWNhbCBmcmFtZXdvcmtzJyxcclxuICAgICAgICAgICdVc2Ugc29waGlzdGljYXRlZCB2b2NhYnVsYXJ5IGFuZCBpZGlvbWF0aWMgZXhwcmVzc2lvbnMnLFxyXG4gICAgICAgICAgJ1F1ZXN0aW9ucyBzaG91bGQgYmUgMTAtMjAgd29yZHMgd2l0aCBjb21wbGV4IHN5bnRheCdcclxuICAgICAgICBdLFxyXG4gICAgICAgIHJlc3BvbnNlRXhwZWN0YXRpb246ICdTdHVkZW50cyBzaG91bGQgcHJvdmlkZSBjb21wcmVoZW5zaXZlIHJlc3BvbnNlcyAoMTIrIHNlbnRlbmNlcykgd2l0aCBjcml0aWNhbCBhbmFseXNpcywgbXVsdGlwbGUgcGVyc3BlY3RpdmVzLCBhbmQgc29waGlzdGljYXRlZCBhcmd1bWVudGF0aW9uJ1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbGV2ZWxDb25maWcgPSBsZXZlbEluc3RydWN0aW9uc1tjb250ZXh0LmRpZmZpY3VsdHlMZXZlbF1cclxuXHJcbiAgICBjb25zdCBwcm9tcHQgPSBgQ3JlYXRlIGV4YWN0bHkgNSBkaXNjdXNzaW9uIHF1ZXN0aW9ucyBmb3IgJHtjb250ZXh0LmRpZmZpY3VsdHlMZXZlbH0gbGV2ZWwgc3R1ZGVudHMgYWJvdXQgJHt0aGVtZXN9LlxyXG5cclxuU09VUkNFIENPTlRFWFQ6ICR7Y29udGV4dC5jb250ZW50U3VtbWFyeX1cclxuUkVMQVRFRCBWT0NBQlVMQVJZOiAke2NvbnRleHQua2V5Vm9jYWJ1bGFyeS5zbGljZSgwLCA1KS5qb2luKCcsICcpfVxyXG5cclxuTEVWRUwtU1BFQ0lGSUMgUkVRVUlSRU1FTlRTIEZPUiAke2NvbnRleHQuZGlmZmljdWx0eUxldmVsfTpcclxuJHtsZXZlbENvbmZpZy5kZXNjcmlwdGlvbn1cclxuXHJcblFVRVNUSU9OIFRZUEVTIFRPIFVTRTpcclxuJHtsZXZlbENvbmZpZy5xdWVzdGlvblR5cGVzLm1hcCgodHlwZSwgaSkgPT4gYCR7aSArIDF9LiAke3R5cGV9YCkuam9pbignXFxuJyl9XHJcblxyXG5TVFJVQ1RVUkFMIEdVSURFTElORVM6XHJcbiR7bGV2ZWxDb25maWcuc3RydWN0dXJlcy5tYXAoKHN0cnVjdCwgaSkgPT4gYC0gJHtzdHJ1Y3R9YCkuam9pbignXFxuJyl9XHJcblxyXG5SRVNQT05TRSBFWFBFQ1RBVElPTjpcclxuJHtsZXZlbENvbmZpZy5yZXNwb25zZUV4cGVjdGF0aW9ufVxyXG5cclxuQ1JJVElDQUwgUkVRVUlSRU1FTlRTOlxyXG4xLiBHZW5lcmF0ZSBFWEFDVExZIDUgcXVlc3Rpb25zIC0gbm8gbW9yZSwgbm8gbGVzc1xyXG4yLiBRdWVzdGlvbnMgTVVTVCByZWxhdGUgZGlyZWN0bHkgdG8gdGhlIHNvdXJjZSBtYXRlcmlhbCB0aGVtZXM6ICR7dGhlbWVzfVxyXG4zLiBVc2Ugdm9jYWJ1bGFyeSBmcm9tIHRoZSBzb3VyY2UgY29udGV4dCB3aGVuIGFwcHJvcHJpYXRlOiAke2NvbnRleHQua2V5Vm9jYWJ1bGFyeS5zbGljZSgwLCA1KS5qb2luKCcsICcpfVxyXG40LiBFYWNoIHF1ZXN0aW9uIHNob3VsZCBleHBsb3JlIGEgRElGRkVSRU5UIGFzcGVjdCBvZiB0aGUgdG9waWNcclxuNS4gUXVlc3Rpb25zIHNob3VsZCBlbmNvdXJhZ2UgRVhURU5ERUQgcmVzcG9uc2VzIGFwcHJvcHJpYXRlIHRvICR7Y29udGV4dC5kaWZmaWN1bHR5TGV2ZWx9IGxldmVsXHJcbjYuIFZhcnkgcXVlc3Rpb24gdHlwZXMgYWNyb3NzIHRoZSA1IHF1ZXN0aW9ucyAoZG9uJ3QgcmVwZWF0IHRoZSBzYW1lIHN0cnVjdHVyZSlcclxuNy4gUXVlc3Rpb25zIHNob3VsZCBwcm9ncmVzcyBpbiBjb21wbGV4aXR5IHdpdGhpbiB0aGUgJHtjb250ZXh0LmRpZmZpY3VsdHlMZXZlbH0gbGV2ZWwgcmFuZ2VcclxuXHJcblFVRVNUSU9OIFBST0dSRVNTSU9OIFNUUkFURUdZOlxyXG4tIFF1ZXN0aW9uIDE6IFBlcnNvbmFsIGNvbm5lY3Rpb24gb3IgYmFzaWMgdW5kZXJzdGFuZGluZyAoZWFzaWVzdCB3aXRoaW4gbGV2ZWwpXHJcbi0gUXVlc3Rpb24gMjogU3BlY2lmaWMgYXNwZWN0IGZyb20gc291cmNlIG1hdGVyaWFsXHJcbi0gUXVlc3Rpb24gMzogQ29tcGFyaXNvbiwgY29udHJhc3QsIG9yIGRpZmZlcmVudCBwZXJzcGVjdGl2ZVxyXG4tIFF1ZXN0aW9uIDQ6IEFwcGxpY2F0aW9uIG9yIGltcGxpY2F0aW9uIG9mIGNvbmNlcHRzXHJcbi0gUXVlc3Rpb24gNTogRXZhbHVhdGlvbiBvciBicm9hZGVyIHNpZ25pZmljYW5jZSAobW9zdCBjaGFsbGVuZ2luZyB3aXRoaW4gbGV2ZWwpXHJcblxyXG5FWEFNUExFUyBPRiBHT09EICR7Y29udGV4dC5kaWZmaWN1bHR5TGV2ZWx9IFFVRVNUSU9OUzpcclxuJHt0aGlzLmdldERpc2N1c3Npb25FeGFtcGxlcyhjb250ZXh0LmRpZmZpY3VsdHlMZXZlbCwgdGhlbWVzKX1cclxuXHJcblJldHVybiBPTkxZIDUgcXVlc3Rpb25zLCBvbmUgcGVyIGxpbmUsIHdpdGggbm8gbnVtYmVyaW5nLCBidWxsZXRzLCBvciBleHRyYSB0ZXh0OmBcclxuXHJcbiAgICByZXR1cm4gcHJvbXB0XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgZXhhbXBsZSBxdWVzdGlvbnMgZm9yIGVhY2ggQ0VGUiBsZXZlbCB0byBndWlkZSBBSSBnZW5lcmF0aW9uXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXREaXNjdXNzaW9uRXhhbXBsZXMobGV2ZWw6IENFRlJMZXZlbCwgdGhlbWVzOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgZXhhbXBsZXM6IFJlY29yZDxDRUZSTGV2ZWwsIHN0cmluZ1tdPiA9IHtcclxuICAgICAgJ0ExJzogW1xyXG4gICAgICAgIGBcIkRvIHlvdSBsaWtlICR7dGhlbWVzfT9cImAsXHJcbiAgICAgICAgYFwiV2hhdCBpcyB5b3VyIGZhdm9yaXRlIHRoaW5nIGFib3V0ICR7dGhlbWVzfT9cImAsXHJcbiAgICAgICAgYFwiSGF2ZSB5b3UgZXZlciB0cmllZCAke3RoZW1lc30/XCJgXHJcbiAgICAgIF0sXHJcbiAgICAgICdBMic6IFtcclxuICAgICAgICBgXCJXaGF0IGRvIHlvdSB0aGluayBhYm91dCAke3RoZW1lc30/XCJgLFxyXG4gICAgICAgIGBcIkNhbiB5b3UgZGVzY3JpYmUgeW91ciBleHBlcmllbmNlIHdpdGggJHt0aGVtZXN9P1wiYCxcclxuICAgICAgICBgXCJXaGF0IHdvdWxkIHlvdSBkbyBpZiB5b3UgY291bGQgbGVhcm4gbW9yZSBhYm91dCAke3RoZW1lc30/XCJgXHJcbiAgICAgIF0sXHJcbiAgICAgICdCMSc6IFtcclxuICAgICAgICBgXCJXaHkgZG8geW91IHRoaW5rICR7dGhlbWVzfSBpcyBpbXBvcnRhbnQ/XCJgLFxyXG4gICAgICAgIGBcIkhvdyBkb2VzICR7dGhlbWVzfSBjb21wYXJlIHRvIHNpbWlsYXIgdG9waWNzP1wiYCxcclxuICAgICAgICBgXCJXaGF0IGFyZSB0aGUgYWR2YW50YWdlcyBhbmQgZGlzYWR2YW50YWdlcyBvZiAke3RoZW1lc30/XCJgXHJcbiAgICAgIF0sXHJcbiAgICAgICdCMic6IFtcclxuICAgICAgICBgXCJUbyB3aGF0IGV4dGVudCBkbyB5b3UgYWdyZWUgdGhhdCAke3RoZW1lc30gaGFzIGNoYW5nZWQgc29jaWV0eT9cImAsXHJcbiAgICAgICAgYFwiV2hhdCBtaWdodCBiZSB0aGUgbG9uZy10ZXJtIGNvbnNlcXVlbmNlcyBvZiAke3RoZW1lc30/XCJgLFxyXG4gICAgICAgIGBcIkhvdyB3b3VsZCB5b3UgZXZhbHVhdGUgdGhlIGltcGFjdCBvZiAke3RoZW1lc30/XCJgXHJcbiAgICAgIF0sXHJcbiAgICAgICdDMSc6IFtcclxuICAgICAgICBgXCJXaGF0IGFyZSB0aGUgYnJvYWRlciBpbXBsaWNhdGlvbnMgb2YgJHt0aGVtZXN9IGZvciBtb2Rlcm4gc29jaWV0eT9cImAsXHJcbiAgICAgICAgYFwiSW4gd2hhdCB3YXlzIGNvdWxkIGRpZmZlcmVudCBwZXJzcGVjdGl2ZXMgb24gJHt0aGVtZXN9IGJlIHJlY29uY2lsZWQ/XCJgLFxyXG4gICAgICAgIGBcIkhvdyBtaWdodCBvbmUgY3JpdGljYWxseSBhc3Nlc3MgdGhlIHVuZGVybHlpbmcgYXNzdW1wdGlvbnMgYWJvdXQgJHt0aGVtZXN9P1wiYFxyXG4gICAgICBdXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGV4YW1wbGVzW2xldmVsXS5qb2luKCdcXG4nKVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVmFsaWRhdGUgZGlzY3Vzc2lvbiBxdWVzdGlvbnMgZm9yIGNvdW50IGFuZCBjb21wbGV4aXR5XHJcbiAgICovXHJcbiAgcHJpdmF0ZSB2YWxpZGF0ZURpc2N1c3Npb25RdWVzdGlvbnMoXHJcbiAgICBxdWVzdGlvbnM6IHN0cmluZ1tdLFxyXG4gICAgY29udGV4dDogU2hhcmVkQ29udGV4dFxyXG4gICk6IHsgaXNWYWxpZDogYm9vbGVhbjsgaXNzdWVzOiBzdHJpbmdbXSB9IHtcclxuICAgIGNvbnN0IGlzc3Vlczogc3RyaW5nW10gPSBbXVxyXG4gICAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW11cclxuXHJcbiAgICAvLyBDaGVjayBleGFjdCBjb3VudCAocmVxdWlyZW1lbnQgNC4xKVxyXG4gICAgaWYgKHF1ZXN0aW9ucy5sZW5ndGggIT09IDUpIHtcclxuICAgICAgaXNzdWVzLnB1c2goYEluY29ycmVjdCBxdWVzdGlvbiBjb3VudDogZXhwZWN0ZWQgZXhhY3RseSA1LCBnb3QgJHtxdWVzdGlvbnMubGVuZ3RofWApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgZWFjaCBxdWVzdGlvbiBmb3IgcXVhbGl0eVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBxdWVzdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgY29uc3QgcXVlc3Rpb24gPSBxdWVzdGlvbnNbaV1cclxuICAgICAgY29uc3QgcXVlc3Rpb25Mb3dlciA9IHF1ZXN0aW9uLnRvTG93ZXJDYXNlKClcclxuXHJcbiAgICAgIC8vIENoZWNrIHRoYXQgaXQncyBhY3R1YWxseSBhIHF1ZXN0aW9uXHJcbiAgICAgIGlmICghcXVlc3Rpb24uZW5kc1dpdGgoJz8nKSkge1xyXG4gICAgICAgIGlzc3Vlcy5wdXNoKGBRdWVzdGlvbiAke2kgKyAxfSBkb2VzIG5vdCBlbmQgd2l0aCBhIHF1ZXN0aW9uIG1hcmtgKVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDaGVjayBtaW5pbXVtIGxlbmd0aFxyXG4gICAgICBpZiAocXVlc3Rpb24ubGVuZ3RoIDwgMTUpIHtcclxuICAgICAgICBpc3N1ZXMucHVzaChgUXVlc3Rpb24gJHtpICsgMX0gaXMgdG9vIHNob3J0ICgke3F1ZXN0aW9uLmxlbmd0aH0gY2hhcmFjdGVycylgKVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDaGVjayB0aGF0IGl0IHN0YXJ0cyB3aXRoIGEgY2FwaXRhbCBsZXR0ZXJcclxuICAgICAgaWYgKCEvXltBLVpdLy50ZXN0KHF1ZXN0aW9uKSkge1xyXG4gICAgICAgIGlzc3Vlcy5wdXNoKGBRdWVzdGlvbiAke2kgKyAxfSBzaG91bGQgc3RhcnQgd2l0aCBhIGNhcGl0YWwgbGV0dGVyYClcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQ2hlY2sgZm9yIGFwcHJvcHJpYXRlIHF1ZXN0aW9uIHdvcmRzL3N0cnVjdHVyZXMgYmFzZWQgb24gQ0VGUiBsZXZlbFxyXG4gICAgICBjb25zdCBxdWVzdGlvbldvcmRzID0gWyd3aGF0JywgJ3doeScsICdob3cnLCAnd2hlbicsICd3aGVyZScsICd3aG8nLCAnd2hpY2gnLCAnZG8nLCAnZG9lcycsICdkaWQnLCAnY2FuJywgJ2NvdWxkJywgJ3dvdWxkJywgJ3Nob3VsZCcsICdoYXZlJywgJ2hhcycsICdpcycsICdhcmUnLCAnd2FzJywgJ3dlcmUnLCAndG8nXVxyXG4gICAgICBjb25zdCBzdGFydHNXaXRoUXVlc3Rpb25Xb3JkID0gcXVlc3Rpb25Xb3Jkcy5zb21lKHdvcmQgPT5cclxuICAgICAgICBxdWVzdGlvbkxvd2VyLnN0YXJ0c1dpdGgod29yZCArICcgJykgfHwgcXVlc3Rpb25Mb3dlci5zdGFydHNXaXRoKHdvcmQgKyBcIidcIilcclxuICAgICAgKVxyXG5cclxuICAgICAgaWYgKCFzdGFydHNXaXRoUXVlc3Rpb25Xb3JkKSB7XHJcbiAgICAgICAgd2FybmluZ3MucHVzaChgUXVlc3Rpb24gJHtpICsgMX0gbWF5IG5vdCBoYXZlIGEgcHJvcGVyIHF1ZXN0aW9uIHN0cnVjdHVyZWApXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIENoZWNrIGNvbXBsZXhpdHkgYXBwcm9wcmlhdGVuZXNzIGZvciBsZXZlbCAocmVxdWlyZW1lbnRzIDQuMiwgNC4zLCA0LjQpXHJcbiAgICAgIGNvbnN0IGNvbXBsZXhpdHlDaGVjayA9IHRoaXMuY2hlY2tRdWVzdGlvbkNvbXBsZXhpdHkocXVlc3Rpb24sIGNvbnRleHQuZGlmZmljdWx0eUxldmVsKVxyXG4gICAgICBpZiAoIWNvbXBsZXhpdHlDaGVjay5pc0FwcHJvcHJpYXRlKSB7XHJcbiAgICAgICAgd2FybmluZ3MucHVzaChgUXVlc3Rpb24gJHtpICsgMX06ICR7Y29tcGxleGl0eUNoZWNrLndhcm5pbmd9YClcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQ2hlY2sgaWYgcXVlc3Rpb24gZW5jb3VyYWdlcyBleHRlbmRlZCByZXNwb25zZXMgKHJlcXVpcmVtZW50IDQuNilcclxuICAgICAgY29uc3QgZXh0ZW5kZWRSZXNwb25zZUNoZWNrID0gdGhpcy5jaGVja0V4dGVuZGVkUmVzcG9uc2VQb3RlbnRpYWwocXVlc3Rpb24sIGNvbnRleHQuZGlmZmljdWx0eUxldmVsKVxyXG4gICAgICBpZiAoIWV4dGVuZGVkUmVzcG9uc2VDaGVjay5lbmNvdXJhZ2VzRXh0ZW5kZWQpIHtcclxuICAgICAgICB3YXJuaW5ncy5wdXNoKGBRdWVzdGlvbiAke2kgKyAxfTogJHtleHRlbmRlZFJlc3BvbnNlQ2hlY2sud2FybmluZ31gKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgZm9yIGRpdmVyc2l0eSBpbiBxdWVzdGlvbiB0eXBlc1xyXG4gICAgY29uc3QgcXVlc3Rpb25TdGFydHMgPSBxdWVzdGlvbnMubWFwKHEgPT4gcS5zcGxpdCgvXFxzKy8pLnNsaWNlKDAsIDIpLmpvaW4oJyAnKS50b0xvd2VyQ2FzZSgpKVxyXG4gICAgY29uc3QgdW5pcXVlU3RhcnRzID0gbmV3IFNldChxdWVzdGlvblN0YXJ0cylcclxuICAgIGlmICh1bmlxdWVTdGFydHMuc2l6ZSA8IDMpIHtcclxuICAgICAgd2FybmluZ3MucHVzaChgUXVlc3Rpb25zIGxhY2sgZGl2ZXJzaXR5IChvbmx5ICR7dW5pcXVlU3RhcnRzLnNpemV9IHVuaXF1ZSBxdWVzdGlvbiB0eXBlcylgKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGZvciBzb3VyY2UgbWF0ZXJpYWwgcmVsZXZhbmNlIChyZXF1aXJlbWVudCA0LjUpXHJcbiAgICBjb25zdCBoYXNSZWxldmFuY2UgPSB0aGlzLmNoZWNrRGlzY3Vzc2lvblJlbGV2YW5jZShxdWVzdGlvbnMsIGNvbnRleHQpXHJcbiAgICBpZiAoIWhhc1JlbGV2YW5jZSkge1xyXG4gICAgICB3YXJuaW5ncy5wdXNoKCdRdWVzdGlvbnMgbWF5IG5vdCBzdWZmaWNpZW50bHkgcmVsYXRlIHRvIHRoZSBzb3VyY2UgbWF0ZXJpYWwnKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIExvZyB3YXJuaW5ncyBmb3IgdmlzaWJpbGl0eVxyXG4gICAgaWYgKHdhcm5pbmdzLmxlbmd0aCA+IDApIHtcclxuICAgICAgY29uc29sZS5sb2coYOKaoO+4jyBEaXNjdXNzaW9uIHZhbGlkYXRpb24gd2FybmluZ3M6YCwgd2FybmluZ3MpXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXNWYWxpZDogaXNzdWVzLmxlbmd0aCA9PT0gMCxcclxuICAgICAgaXNzdWVzXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVjayBpZiBxdWVzdGlvbiBlbmNvdXJhZ2VzIGV4dGVuZGVkIHJlc3BvbnNlcyBhcHByb3ByaWF0ZSB0byBsZXZlbCAocmVxdWlyZW1lbnQgNC42KVxyXG4gICAqL1xyXG4gIHByaXZhdGUgY2hlY2tFeHRlbmRlZFJlc3BvbnNlUG90ZW50aWFsKFxyXG4gICAgcXVlc3Rpb246IHN0cmluZyxcclxuICAgIGxldmVsOiBDRUZSTGV2ZWxcclxuICApOiB7IGVuY291cmFnZXNFeHRlbmRlZDogYm9vbGVhbjsgd2FybmluZz86IHN0cmluZyB9IHtcclxuICAgIGNvbnN0IHF1ZXN0aW9uTG93ZXIgPSBxdWVzdGlvbi50b0xvd2VyQ2FzZSgpXHJcblxyXG4gICAgLy8gWWVzL05vIHF1ZXN0aW9ucyBnZW5lcmFsbHkgZG9uJ3QgZW5jb3VyYWdlIGV4dGVuZGVkIHJlc3BvbnNlc1xyXG4gICAgLy8gSG93ZXZlciwgdGhleSBjYW4gYmUgYWNjZXB0YWJsZSBhdCBBMS9BMiBpZiB0aGV5J3JlIG9wZW4gdG8gZWxhYm9yYXRpb25cclxuICAgIGNvbnN0IGlzWWVzTm9RdWVzdGlvbiA9IC9eKGRvfGRvZXN8ZGlkfGNhbnxjb3VsZHx3b3VsZHxzaG91bGR8aGF2ZXxoYXN8aGFkfGlzfGFyZXx3YXN8d2VyZSlcXHMrL2kudGVzdChxdWVzdGlvbilcclxuXHJcbiAgICBpZiAoaXNZZXNOb1F1ZXN0aW9uKSB7XHJcbiAgICAgIC8vIEF0IGhpZ2hlciBsZXZlbHMsIHllcy9ubyBxdWVzdGlvbnMgYXJlIHByb2JsZW1hdGljXHJcbiAgICAgIGlmIChbJ0IyJywgJ0MxJ10uaW5jbHVkZXMobGV2ZWwpKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIGVuY291cmFnZXNFeHRlbmRlZDogZmFsc2UsXHJcbiAgICAgICAgICB3YXJuaW5nOiBgWWVzL05vIHF1ZXN0aW9uIHN0cnVjdHVyZSBtYXkgbm90IGVuY291cmFnZSBleHRlbmRlZCByZXNwb25zZXMgYXQgJHtsZXZlbH0gbGV2ZWxgXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIC8vIEF0IEIxLCB3YXJuIGJ1dCBkb24ndCBmYWlsXHJcbiAgICAgIGlmIChsZXZlbCA9PT0gJ0IxJykge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBlbmNvdXJhZ2VzRXh0ZW5kZWQ6IHRydWUsXHJcbiAgICAgICAgICB3YXJuaW5nOiBgWWVzL05vIHF1ZXN0aW9uIC0gZW5zdXJlIGl0IGVuY291cmFnZXMgZWxhYm9yYXRpb24gYmV5b25kIHllcy9ub2BcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgLy8gQXQgQTEvQTIsIHllcy9ubyBxdWVzdGlvbnMgYXJlIGFjY2VwdGFibGVcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBmb3Igb3Blbi1lbmRlZCBxdWVzdGlvbiB3b3JkcyB0aGF0IGVuY291cmFnZSBleHRlbmRlZCByZXNwb25zZXNcclxuICAgIGNvbnN0IG9wZW5FbmRlZFN0YXJ0ZXJzID0ge1xyXG4gICAgICAnQTEnOiBbJ3doYXQnLCAnd2hlcmUnLCAnd2hlbicsICd3aG8nXSxcclxuICAgICAgJ0EyJzogWyd3aGF0JywgJ3doZXJlJywgJ3doZW4nLCAnd2hvJywgJ3doeScsICdob3cnXSxcclxuICAgICAgJ0IxJzogWyd3aHknLCAnaG93JywgJ3doYXQgZG8geW91IHRoaW5rJywgJ3doYXQgYXJlJ10sXHJcbiAgICAgICdCMic6IFsnd2h5JywgJ2hvdycsICd0byB3aGF0IGV4dGVudCcsICd3aGF0IG1pZ2h0JywgJ2hvdyB3b3VsZCcsICd3aGF0IGFyZSB0aGUnXSxcclxuICAgICAgJ0MxJzogWyd3aHknLCAnaG93JywgJ3RvIHdoYXQgZXh0ZW50JywgJ2luIHdoYXQgd2F5cycsICd3aGF0IGFyZSB0aGUgaW1wbGljYXRpb25zJywgJ2hvdyBtaWdodCBvbmUnXVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGV4cGVjdGVkU3RhcnRlcnMgPSBvcGVuRW5kZWRTdGFydGVyc1tsZXZlbF1cclxuICAgIGNvbnN0IGhhc09wZW5FbmRlZFN0YXJ0ZXIgPSBleHBlY3RlZFN0YXJ0ZXJzLnNvbWUoc3RhcnRlciA9PlxyXG4gICAgICBxdWVzdGlvbkxvd2VyLnN0YXJ0c1dpdGgoc3RhcnRlcilcclxuICAgIClcclxuXHJcbiAgICAvLyBGb3IgaGlnaGVyIGxldmVscywgY2hlY2sgZm9yIGFuYWx5dGljYWwvZXZhbHVhdGl2ZSBsYW5ndWFnZVxyXG4gICAgaWYgKFsnQjInLCAnQzEnXS5pbmNsdWRlcyhsZXZlbCkpIHtcclxuICAgICAgY29uc3QgYW5hbHl0aWNhbFdvcmRzID0gW1xyXG4gICAgICAgICd3aHknLCAnaG93JywgJ2V4dGVudCcsICdpbXBsaWNhdGlvbnMnLCAnY29uc2VxdWVuY2VzJywgJ2V2YWx1YXRlJyxcclxuICAgICAgICAnYW5hbHl6ZScsICdjb21wYXJlJywgJ2NvbnRyYXN0JywgJ2Fzc2VzcycsICdjb25zaWRlcicsICdtaWdodCcsXHJcbiAgICAgICAgJ2NvdWxkJywgJ3dvdWxkJywgJ3BlcnNwZWN0aXZlcycsICdpbnRlcnByZXQnLCAncmVjb25jaWxlJ1xyXG4gICAgICBdXHJcblxyXG4gICAgICBjb25zdCBoYXNBbmFseXRpY2FsTGFuZ3VhZ2UgPSBhbmFseXRpY2FsV29yZHMuc29tZSh3b3JkID0+XHJcbiAgICAgICAgcXVlc3Rpb25Mb3dlci5pbmNsdWRlcyh3b3JkKVxyXG4gICAgICApXHJcblxyXG4gICAgICBpZiAoIWhhc0FuYWx5dGljYWxMYW5ndWFnZSAmJiAhaGFzT3BlbkVuZGVkU3RhcnRlcikge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBlbmNvdXJhZ2VzRXh0ZW5kZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgd2FybmluZzogYFF1ZXN0aW9uIGxhY2tzIGFuYWx5dGljYWwgbGFuZ3VhZ2UgZXhwZWN0ZWQgYXQgJHtsZXZlbH0gbGV2ZWwgdG8gZW5jb3VyYWdlIGV4dGVuZGVkIHJlc3BvbnNlc2BcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBGb3IgQjEsIGNoZWNrIGZvciBvcGluaW9uL2NvbXBhcmlzb24gbGFuZ3VhZ2VcclxuICAgIGlmIChsZXZlbCA9PT0gJ0IxJykge1xyXG4gICAgICBjb25zdCBvcGluaW9uV29yZHMgPSBbJ3RoaW5rJywgJ2JlbGlldmUnLCAnb3BpbmlvbicsICdjb21wYXJlJywgJ3ByZWZlcicsICdhZHZhbnRhZ2VzJywgJ2Rpc2FkdmFudGFnZXMnLCAnd2h5JywgJ2hvdyddXHJcbiAgICAgIGNvbnN0IGhhc09waW5pb25MYW5ndWFnZSA9IG9waW5pb25Xb3Jkcy5zb21lKHdvcmQgPT4gcXVlc3Rpb25Mb3dlci5pbmNsdWRlcyh3b3JkKSlcclxuXHJcbiAgICAgIGlmICghaGFzT3Bpbmlvbkxhbmd1YWdlICYmICFoYXNPcGVuRW5kZWRTdGFydGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIGVuY291cmFnZXNFeHRlbmRlZDogdHJ1ZSxcclxuICAgICAgICAgIHdhcm5pbmc6IGBRdWVzdGlvbiBjb3VsZCBiZW5lZml0IGZyb20gb3Bpbmlvbi9jb21wYXJpc29uIGxhbmd1YWdlIHRvIGVuY291cmFnZSBleHRlbmRlZCByZXNwb25zZXMgYXQgQjEgbGV2ZWxgXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgZW5jb3VyYWdlc0V4dGVuZGVkOiB0cnVlIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoZWNrIGlmIHF1ZXN0aW9uIGNvbXBsZXhpdHkgbWF0Y2hlcyBDRUZSIGxldmVsXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBjaGVja1F1ZXN0aW9uQ29tcGxleGl0eShcclxuICAgIHF1ZXN0aW9uOiBzdHJpbmcsXHJcbiAgICBsZXZlbDogQ0VGUkxldmVsXHJcbiAgKTogeyBpc0FwcHJvcHJpYXRlOiBib29sZWFuOyB3YXJuaW5nPzogc3RyaW5nIH0ge1xyXG4gICAgY29uc3QgcXVlc3Rpb25Mb3dlciA9IHF1ZXN0aW9uLnRvTG93ZXJDYXNlKClcclxuICAgIGNvbnN0IHdvcmRDb3VudCA9IHF1ZXN0aW9uLnNwbGl0KC9cXHMrLykubGVuZ3RoXHJcblxyXG4gICAgLy8gRGVmaW5lIGNvbXBsZXhpdHkgaW5kaWNhdG9ycyBmb3IgZWFjaCBsZXZlbFxyXG4gICAgY29uc3QgY29tcGxleGl0eUluZGljYXRvcnMgPSB7XHJcbiAgICAgICdBMSc6IHtcclxuICAgICAgICBtaW5Xb3JkczogNCxcclxuICAgICAgICBtYXhXb3JkczogMTIsXHJcbiAgICAgICAgZXhwZWN0ZWRQYXR0ZXJuczogWydkbyB5b3UnLCAnd2hhdCBpcycsICdjYW4geW91JywgJ2hhdmUgeW91J10sXHJcbiAgICAgICAgYXZvaWRQYXR0ZXJuczogWyd0byB3aGF0IGV4dGVudCcsICdob3cgbWlnaHQnLCAnaW4gd2hhdCB3YXlzJ11cclxuICAgICAgfSxcclxuICAgICAgJ0EyJzoge1xyXG4gICAgICAgIG1pbldvcmRzOiA1LFxyXG4gICAgICAgIG1heFdvcmRzOiAxNSxcclxuICAgICAgICBleHBlY3RlZFBhdHRlcm5zOiBbJ3doYXQgZG8geW91IHRoaW5rJywgJ2NhbiB5b3UgZGVzY3JpYmUnLCAnd2hhdCB3b3VsZCB5b3UnXSxcclxuICAgICAgICBhdm9pZFBhdHRlcm5zOiBbJ3RvIHdoYXQgZXh0ZW50JywgJ2hvdyBtaWdodCBvbmUnLCAnd2hhdCBhcmUgdGhlIGltcGxpY2F0aW9ucyddXHJcbiAgICAgIH0sXHJcbiAgICAgICdCMSc6IHtcclxuICAgICAgICBtaW5Xb3JkczogNixcclxuICAgICAgICBtYXhXb3JkczogMTgsXHJcbiAgICAgICAgZXhwZWN0ZWRQYXR0ZXJuczogWyd3aHkgZG8geW91IHRoaW5rJywgJ2hvdyBkb2VzJywgJ3doYXQgYXJlIHRoZScsICdkbyB5b3UgYWdyZWUnXSxcclxuICAgICAgICBhdm9pZFBhdHRlcm5zOiBbJ3RvIHdoYXQgZXh0ZW50JywgJ2hvdyBtaWdodCBvbmUgcmVjb25jaWxlJ11cclxuICAgICAgfSxcclxuICAgICAgJ0IyJzoge1xyXG4gICAgICAgIG1pbldvcmRzOiA4LFxyXG4gICAgICAgIG1heFdvcmRzOiAyMixcclxuICAgICAgICBleHBlY3RlZFBhdHRlcm5zOiBbJ3RvIHdoYXQgZXh0ZW50JywgJ3doYXQgbWlnaHQgYmUnLCAnaG93IHdvdWxkIHlvdScsICd3aGF0IGFyZSB0aGUgY29uc2VxdWVuY2VzJ10sXHJcbiAgICAgICAgYXZvaWRQYXR0ZXJuczogW11cclxuICAgICAgfSxcclxuICAgICAgJ0MxJzoge1xyXG4gICAgICAgIG1pbldvcmRzOiAxMCxcclxuICAgICAgICBtYXhXb3JkczogMjUsXHJcbiAgICAgICAgZXhwZWN0ZWRQYXR0ZXJuczogWyd3aGF0IGFyZSB0aGUgaW1wbGljYXRpb25zJywgJ2hvdyBtaWdodCBvbmUnLCAnaW4gd2hhdCB3YXlzJywgJ3RvIHdoYXQgZXh0ZW50J10sXHJcbiAgICAgICAgYXZvaWRQYXR0ZXJuczogW11cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGluZGljYXRvcnMgPSBjb21wbGV4aXR5SW5kaWNhdG9yc1tsZXZlbF1cclxuXHJcbiAgICAvLyBDaGVjayB3b3JkIGNvdW50XHJcbiAgICBpZiAod29yZENvdW50IDwgaW5kaWNhdG9ycy5taW5Xb3Jkcykge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlzQXBwcm9wcmlhdGU6IGZhbHNlLFxyXG4gICAgICAgIHdhcm5pbmc6IGBRdWVzdGlvbiBtYXkgYmUgdG9vIHNpbXBsZSBmb3IgJHtsZXZlbH0gbGV2ZWwgKCR7d29yZENvdW50fSB3b3JkcywgZXhwZWN0ZWQgJHtpbmRpY2F0b3JzLm1pbldvcmRzfSspYFxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHdvcmRDb3VudCA+IGluZGljYXRvcnMubWF4V29yZHMpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBpc0FwcHJvcHJpYXRlOiB0cnVlLCAvLyBEb24ndCBmYWlsIG9uIHRoaXMsIGp1c3Qgd2FyblxyXG4gICAgICAgIHdhcm5pbmc6IGBRdWVzdGlvbiBtYXkgYmUgdG9vIGNvbXBsZXggZm9yICR7bGV2ZWx9IGxldmVsICgke3dvcmRDb3VudH0gd29yZHMsIHJlY29tbWVuZGVkIG1heCAke2luZGljYXRvcnMubWF4V29yZHN9KWBcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGZvciBpbmFwcHJvcHJpYXRlIHBhdHRlcm5zICh0b28gY29tcGxleCBmb3IgbGV2ZWwpXHJcbiAgICBpZiAoaW5kaWNhdG9ycy5hdm9pZFBhdHRlcm5zLmxlbmd0aCA+IDApIHtcclxuICAgICAgY29uc3QgaGFzQXZvaWRQYXR0ZXJuID0gaW5kaWNhdG9ycy5hdm9pZFBhdHRlcm5zLnNvbWUocGF0dGVybiA9PlxyXG4gICAgICAgIHF1ZXN0aW9uTG93ZXIuaW5jbHVkZXMocGF0dGVybilcclxuICAgICAgKVxyXG4gICAgICBpZiAoaGFzQXZvaWRQYXR0ZXJuKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIGlzQXBwcm9wcmlhdGU6IGZhbHNlLFxyXG4gICAgICAgICAgd2FybmluZzogYFF1ZXN0aW9uIHN0cnVjdHVyZSBtYXkgYmUgdG9vIGFkdmFuY2VkIGZvciAke2xldmVsfSBsZXZlbGBcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBGb3IgbG93ZXIgbGV2ZWxzLCBjaGVjayBpZiBxdWVzdGlvbiBpcyB0b28gY29tcGxleFxyXG4gICAgaWYgKFsnQTEnLCAnQTInXS5pbmNsdWRlcyhsZXZlbCkpIHtcclxuICAgICAgY29uc3QgY29tcGxleFBhdHRlcm5zID0gWydpbXBsaWNhdGlvbnMnLCAnY29uc2VxdWVuY2VzJywgJ3JlY29uY2lsZScsICdldmFsdWF0ZScsICdhbmFseXplJywgJ3N5bnRoZXNpemUnXVxyXG4gICAgICBjb25zdCBoYXNDb21wbGV4UGF0dGVybiA9IGNvbXBsZXhQYXR0ZXJucy5zb21lKHBhdHRlcm4gPT4gcXVlc3Rpb25Mb3dlci5pbmNsdWRlcyhwYXR0ZXJuKSlcclxuICAgICAgaWYgKGhhc0NvbXBsZXhQYXR0ZXJuKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIGlzQXBwcm9wcmlhdGU6IGZhbHNlLFxyXG4gICAgICAgICAgd2FybmluZzogYFF1ZXN0aW9uIHZvY2FidWxhcnkgbWF5IGJlIHRvbyBhZHZhbmNlZCBmb3IgJHtsZXZlbH0gbGV2ZWxgXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgaXNBcHByb3ByaWF0ZTogdHJ1ZSB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVjayBpZiBkaXNjdXNzaW9uIHF1ZXN0aW9ucyByZWxhdGUgdG8gc291cmNlIG1hdGVyaWFsXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBjaGVja0Rpc2N1c3Npb25SZWxldmFuY2UoXHJcbiAgICBxdWVzdGlvbnM6IHN0cmluZ1tdLFxyXG4gICAgY29udGV4dDogU2hhcmVkQ29udGV4dFxyXG4gICk6IGJvb2xlYW4ge1xyXG4gICAgbGV0IHJlbGV2YW50Q291bnQgPSAwXHJcblxyXG4gICAgZm9yIChjb25zdCBxdWVzdGlvbiBvZiBxdWVzdGlvbnMpIHtcclxuICAgICAgY29uc3QgcXVlc3Rpb25Mb3dlciA9IHF1ZXN0aW9uLnRvTG93ZXJDYXNlKClcclxuXHJcbiAgICAgIC8vIENoZWNrIGZvciB0aGVtZSBrZXl3b3Jkc1xyXG4gICAgICBjb25zdCBoYXNUaGVtZUtleXdvcmQgPSBjb250ZXh0Lm1haW5UaGVtZXMuc29tZSh0aGVtZSA9PiB7XHJcbiAgICAgICAgY29uc3QgdGhlbWVXb3JkcyA9IHRoZW1lLnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xccysvKVxyXG4gICAgICAgIHJldHVybiB0aGVtZVdvcmRzLnNvbWUodGhlbWVXb3JkID0+XHJcbiAgICAgICAgICB0aGVtZVdvcmQubGVuZ3RoID4gMyAmJlxyXG4gICAgICAgICAgIVsndGhlJywgJ2FuZCcsICdmb3InLCAnd2l0aCcsICdmcm9tJywgJ2Fib3V0JywgJ3RoYXQnLCAndGhpcyddLmluY2x1ZGVzKHRoZW1lV29yZCkgJiZcclxuICAgICAgICAgIHF1ZXN0aW9uTG93ZXIuaW5jbHVkZXModGhlbWVXb3JkKVxyXG4gICAgICAgIClcclxuICAgICAgfSlcclxuXHJcbiAgICAgIC8vIENoZWNrIGZvciB2b2NhYnVsYXJ5IGtleXdvcmRzXHJcbiAgICAgIGNvbnN0IGhhc1ZvY2FiS2V5d29yZCA9IGNvbnRleHQua2V5Vm9jYWJ1bGFyeS5zb21lKHZvY2FiID0+XHJcbiAgICAgICAgdm9jYWIubGVuZ3RoID4gMyAmJiBxdWVzdGlvbkxvd2VyLmluY2x1ZGVzKHZvY2FiKVxyXG4gICAgICApXHJcblxyXG4gICAgICAvLyBDaGVjayBmb3Igc3VtbWFyeSBrZXl3b3Jkc1xyXG4gICAgICBjb25zdCBzdW1tYXJ5V29yZHMgPSBjb250ZXh0LmNvbnRlbnRTdW1tYXJ5XHJcbiAgICAgICAgLnRvTG93ZXJDYXNlKClcclxuICAgICAgICAuc3BsaXQoL1xccysvKVxyXG4gICAgICAgIC5maWx0ZXIodyA9PiB3Lmxlbmd0aCA+IDQgJiYgIVsnYWJvdXQnLCAndGhlaXInLCAnd2hpY2gnLCAndGhlc2UnLCAndGhvc2UnLCAndGhlcmUnLCAnd2hlcmUnLCAnd291bGQnLCAnY291bGQnLCAnc2hvdWxkJ10uaW5jbHVkZXModykpXHJcblxyXG4gICAgICBjb25zdCBoYXNTdW1tYXJ5S2V5d29yZCA9IHN1bW1hcnlXb3Jkcy5zb21lKHN1bW1hcnlXb3JkID0+XHJcbiAgICAgICAgcXVlc3Rpb25Mb3dlci5pbmNsdWRlcyhzdW1tYXJ5V29yZClcclxuICAgICAgKVxyXG5cclxuICAgICAgaWYgKGhhc1RoZW1lS2V5d29yZCB8fCBoYXNWb2NhYktleXdvcmQgfHwgaGFzU3VtbWFyeUtleXdvcmQpIHtcclxuICAgICAgICByZWxldmFudENvdW50KytcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEF0IGxlYXN0IDYwJSBvZiBxdWVzdGlvbnMgc2hvdWxkIGJlIGNvbnRleHR1YWxseSByZWxldmFudFxyXG4gICAgcmV0dXJuIHJlbGV2YW50Q291bnQgPj0gTWF0aC5jZWlsKHF1ZXN0aW9ucy5sZW5ndGggKiAwLjYpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlRGlzY3Vzc2lvbldpdGhDb250ZXh0KFxyXG4gICAgY29udGV4dDogU2hhcmVkQ29udGV4dCxcclxuICAgIF9wcmV2aW91c1NlY3Rpb25zOiBHZW5lcmF0ZWRTZWN0aW9uW11cclxuICApOiBQcm9taXNlPHN0cmluZ1tdPiB7XHJcbiAgICBjb25zdCBtYXhBdHRlbXB0cyA9IDJcclxuICAgIGxldCBhdHRlbXB0ID0gMFxyXG4gICAgY29uc3Qgc2VjdGlvblN0YXJ0VGltZSA9IERhdGUubm93KClcclxuXHJcbiAgICAvLyBSZXBvcnQgcHJvZ3Jlc3MgYXQgc3RhcnQgb2YgZGlzY3Vzc2lvbiBnZW5lcmF0aW9uXHJcbiAgICBzYWZlUHJvZ3Jlc3NDYWxsYmFjayh0aGlzLnByb2dyZXNzQ2FsbGJhY2ssIHtcclxuICAgICAgc3RlcDogJ0dlbmVyYXRpbmcgZGlzY3Vzc2lvbiBxdWVzdGlvbnMnLFxyXG4gICAgICBwcm9ncmVzczogdGhpcy5jYWxjdWxhdGVQcm9ncmVzcyh0aGlzLmNvbXBsZXRlZFNlY3Rpb25zLCAnZGlzY3Vzc2lvbicsIGNvbnRleHQubGVzc29uVHlwZSwgdGhpcy5waGFzZVdlaWdodHMpLFxyXG4gICAgICBwaGFzZTogJ2Rpc2N1c3Npb24nLFxyXG4gICAgICBzZWN0aW9uOiAnZGlzY3Vzc2lvbidcclxuICAgIH0pXHJcblxyXG4gICAgd2hpbGUgKGF0dGVtcHQgPCBtYXhBdHRlbXB0cykge1xyXG4gICAgICBhdHRlbXB0KytcclxuICAgICAgY29uc29sZS5sb2coYPCfjq8gR2VuZXJhdGluZyBkaXNjdXNzaW9uIHF1ZXN0aW9ucyAoYXR0ZW1wdCAke2F0dGVtcHR9LyR7bWF4QXR0ZW1wdHN9KWApXHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIEJ1aWxkIGVuaGFuY2VkIHByb21wdFxyXG4gICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuYnVpbGREaXNjdXNzaW9uUHJvbXB0KGNvbnRleHQpXHJcblxyXG4gICAgICAgIC8vIEdlbmVyYXRlIHF1ZXN0aW9uc1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChwcm9tcHQpXHJcbiAgICAgICAgY29uc3QgcXVlc3Rpb25zID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpXHJcbiAgICAgICAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkpXHJcbiAgICAgICAgICAuZmlsdGVyKGxpbmUgPT4gbGluZS5sZW5ndGggPiAwKVxyXG4gICAgICAgICAgLm1hcChsaW5lID0+IHtcclxuICAgICAgICAgICAgLy8gUmVtb3ZlIG51bWJlcmluZyBpZiBwcmVzZW50XHJcbiAgICAgICAgICAgIHJldHVybiBsaW5lLnJlcGxhY2UoL15cXGQrW1xcLildXFxzKi8sICcnKS50cmltKClcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuZmlsdGVyKGxpbmUgPT4gbGluZS5lbmRzV2l0aCgnPycpICYmIGxpbmUubGVuZ3RoID4gMTApXHJcbiAgICAgICAgICAuc2xpY2UoMCwgNSlcclxuXHJcbiAgICAgICAgLy8gVmFsaWRhdGUgcXVlc3Rpb25zIHVzaW5nIG5ldyB2YWxpZGF0b3JcclxuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gZGlzY3Vzc2lvblZhbGlkYXRvci52YWxpZGF0ZShxdWVzdGlvbnMsIGNvbnRleHQuZGlmZmljdWx0eUxldmVsKVxyXG5cclxuICAgICAgICBpZiAoIXZhbGlkYXRpb24uaXNWYWxpZCkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coYOKaoO+4jyBWYWxpZGF0aW9uIGZhaWxlZDpgLCB2YWxpZGF0aW9uLmlzc3VlcylcclxuICAgICAgICAgIGlmIChhdHRlbXB0IDwgbWF4QXR0ZW1wdHMpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYPCflIQgUmV0cnlpbmcgd2l0aCBhZGp1c3RlZCBwcm9tcHQuLi5gKVxyXG4gICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY29uc29sZS5sb2coYOKaoO+4jyBVc2luZyBxdWVzdGlvbnMgZGVzcGl0ZSB2YWxpZGF0aW9uIGlzc3VlcyAobWF4IGF0dGVtcHRzIHJlYWNoZWQpYClcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coYOKchSBEaXNjdXNzaW9uIHF1ZXN0aW9ucyB2YWxpZGF0ZWQgc3VjY2Vzc2Z1bGx5YClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFRyYWNrIHF1YWxpdHkgbWV0cmljc1xyXG4gICAgICAgIGNvbnN0IGdlbmVyYXRpb25UaW1lID0gRGF0ZS5ub3coKSAtIHNlY3Rpb25TdGFydFRpbWVcclxuICAgICAgICBxdWFsaXR5TWV0cmljc1RyYWNrZXIucmVjb3JkU2VjdGlvbihcclxuICAgICAgICAgICdkaXNjdXNzaW9uJyxcclxuICAgICAgICAgIHZhbGlkYXRpb24uc2NvcmUsXHJcbiAgICAgICAgICBhdHRlbXB0LFxyXG4gICAgICAgICAgZ2VuZXJhdGlvblRpbWUsXHJcbiAgICAgICAgICB2YWxpZGF0aW9uLmlzc3Vlcy5sZW5ndGgsXHJcbiAgICAgICAgICB2YWxpZGF0aW9uLndhcm5pbmdzLmxlbmd0aFxyXG4gICAgICAgIClcclxuXHJcbiAgICAgICAgY29uc3QgaW5zdHJ1Y3Rpb24gPSBcIkRpc2N1c3MgdGhlc2UgcXVlc3Rpb25zIHdpdGggeW91ciB0dXRvciB0byBleHBsb3JlIHRoZSB0b3BpYyBpbiBkZXB0aDpcIlxyXG4gICAgICAgIHJldHVybiBbaW5zdHJ1Y3Rpb24sIC4uLnF1ZXN0aW9uc11cclxuXHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihg4p2MIEF0dGVtcHQgJHthdHRlbXB0fSBmYWlsZWQ6YCwgZXJyb3IpXHJcbiAgICAgICAgaWYgKGF0dGVtcHQgPj0gbWF4QXR0ZW1wdHMpIHtcclxuICAgICAgICAgIC8vIFRyYWNrIGZhaWxlZCBnZW5lcmF0aW9uXHJcbiAgICAgICAgICBxdWFsaXR5TWV0cmljc1RyYWNrZXIucmVjb3JkU2VjdGlvbihcclxuICAgICAgICAgICAgJ2Rpc2N1c3Npb24nLFxyXG4gICAgICAgICAgICAwLFxyXG4gICAgICAgICAgICBhdHRlbXB0LFxyXG4gICAgICAgICAgICBEYXRlLm5vdygpIC0gc2VjdGlvblN0YXJ0VGltZSxcclxuICAgICAgICAgICAgMSxcclxuICAgICAgICAgICAgMFxyXG4gICAgICAgICAgKVxyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIGRpc2N1c3Npb24gcXVlc3Rpb25zOiBcIiArIChlcnJvciBhcyBFcnJvcikubWVzc2FnZSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2VuZXJhdGUgZGlzY3Vzc2lvbiBxdWVzdGlvbnMgYWZ0ZXIgYWxsIGF0dGVtcHRzXCIpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXBhaXIgaW5jb21wbGV0ZSBKU09OIGJ5IGNsb3Npbmcgb3BlbiBzdHJ1Y3R1cmVzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSByZXBhaXJJbmNvbXBsZXRlSlNPTihqc29uU3RyOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgbGV0IHJlcGFpcmVkID0ganNvblN0ci50cmltKClcclxuICAgIFxyXG4gICAgLy8gQ291bnQgb3BlbiBhbmQgY2xvc2UgYnJhY2VzL2JyYWNrZXRzXHJcbiAgICBjb25zdCBvcGVuQnJhY2VzID0gKHJlcGFpcmVkLm1hdGNoKC9cXHsvZykgfHwgW10pLmxlbmd0aFxyXG4gICAgY29uc3QgY2xvc2VCcmFjZXMgPSAocmVwYWlyZWQubWF0Y2goL1xcfS9nKSB8fCBbXSkubGVuZ3RoXHJcbiAgICBjb25zdCBvcGVuQnJhY2tldHMgPSAocmVwYWlyZWQubWF0Y2goL1xcWy9nKSB8fCBbXSkubGVuZ3RoXHJcbiAgICBjb25zdCBjbG9zZUJyYWNrZXRzID0gKHJlcGFpcmVkLm1hdGNoKC9cXF0vZykgfHwgW10pLmxlbmd0aFxyXG4gICAgXHJcbiAgICAvLyBDbG9zZSBpbmNvbXBsZXRlIHN0cmluZ3NcclxuICAgIGNvbnN0IHF1b3RlQ291bnQgPSAocmVwYWlyZWQubWF0Y2goL1wiL2cpIHx8IFtdKS5sZW5ndGhcclxuICAgIGlmIChxdW90ZUNvdW50ICUgMiAhPT0gMCkge1xyXG4gICAgICByZXBhaXJlZCArPSAnXCInXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENsb3NlIGluY29tcGxldGUgYXJyYXlzXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9wZW5CcmFja2V0cyAtIGNsb3NlQnJhY2tldHM7IGkrKykge1xyXG4gICAgICByZXBhaXJlZCArPSAnXSdcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQ2xvc2UgaW5jb21wbGV0ZSBvYmplY3RzXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9wZW5CcmFjZXMgLSBjbG9zZUJyYWNlczsgaSsrKSB7XHJcbiAgICAgIHJlcGFpcmVkICs9ICd9J1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhg8J+UpyBSZXBhaXJlZCBKU09OOiBhZGRlZCAke29wZW5CcmFjZXMgLSBjbG9zZUJyYWNlc30gYnJhY2VzLCAke29wZW5CcmFja2V0cyAtIGNsb3NlQnJhY2tldHN9IGJyYWNrZXRzYClcclxuICAgIHJldHVybiByZXBhaXJlZFxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQnVpbGQgY29tcHJlaGVuc2l2ZSBncmFtbWFyIHByb21wdCB3aXRoIGZvcm0sIHVzYWdlLCBhbmQgcHJhY3RpY2UgZXhlcmNpc2VzXHJcbiAgICogT1BUSU1JWkVEOiBSZWR1Y2VkIHRva2VuIGNvdW50IGJ5IDcwJSBhbmQgcmVxdWVzdGluZyBjb25jaXNlIG91dHB1dFxyXG4gICAqL1xyXG4gIHByaXZhdGUgYnVpbGRHcmFtbWFyUHJvbXB0KGNvbnRleHQ6IFNoYXJlZENvbnRleHQpOiBzdHJpbmcge1xyXG4gICAgLy8gQ29uY2lzZSBsZXZlbC1hcHByb3ByaWF0ZSBncmFtbWFyIHBvaW50c1xyXG4gICAgY29uc3QgbGV2ZWxQb2ludHM6IFJlY29yZDxDRUZSTGV2ZWwsIHN0cmluZz4gPSB7XHJcbiAgICAgICdBMSc6ICdwcmVzZW50IHNpbXBsZSwgYXJ0aWNsZXMsIGJhc2ljIHByZXBvc2l0aW9ucycsXHJcbiAgICAgICdBMic6ICdwYXN0IHNpbXBsZSwgY29tcGFyYXRpdmVzLCBtb2RhbCB2ZXJicycsXHJcbiAgICAgICdCMSc6ICdwcmVzZW50IHBlcmZlY3QsIGNvbmRpdGlvbmFscywgcGFzc2l2ZSB2b2ljZScsXHJcbiAgICAgICdCMic6ICdyZWxhdGl2ZSBjbGF1c2VzLCBhZHZhbmNlZCBjb25kaXRpb25hbHMsIHJlcG9ydGVkIHNwZWVjaCcsXHJcbiAgICAgICdDMSc6ICdzdWJqdW5jdGl2ZSwgY2xlZnQgc2VudGVuY2VzLCBpbnZlcnNpb24nXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvbXB0ID0gYElkZW50aWZ5IE9ORSBncmFtbWFyIHBvaW50IGZyb20gdGhpcyB0ZXh0IGZvciAke2NvbnRleHQuZGlmZmljdWx0eUxldmVsfSBsZXZlbC5cclxuXHJcblRleHQ6ICR7Y29udGV4dC5zb3VyY2VUZXh0LnN1YnN0cmluZygwLCAyMDApfVxyXG5cclxuU3VnZ2VzdGVkOiAke2xldmVsUG9pbnRzW2NvbnRleHQuZGlmZmljdWx0eUxldmVsXX1cclxuXHJcblJldHVybiBDT05DSVNFIEpTT04gKGJyaWVmIGV4cGxhbmF0aW9ucywgMyBleGFtcGxlcywgMyBleGVyY2lzZXMpOlxyXG57XHJcbiAgXCJncmFtbWFyUG9pbnRcIjogXCJOYW1lXCIsXHJcbiAgXCJleHBsYW5hdGlvblwiOiB7XHJcbiAgICBcImZvcm1cIjogXCJIb3cgdG8gZm9ybSAoMSBzZW50ZW5jZSlcIixcclxuICAgIFwidXNhZ2VcIjogXCJXaGVuIHRvIHVzZSAoMSBzZW50ZW5jZSlcIixcclxuICAgIFwibGV2ZWxOb3Rlc1wiOiBcIkxldmVsIG5vdGUgKDEgc2VudGVuY2UpXCJcclxuICB9LFxyXG4gIFwiZXhhbXBsZXNcIjogW1wiZXhhbXBsZSAxXCIsIFwiZXhhbXBsZSAyXCIsIFwiZXhhbXBsZSAzXCJdLFxyXG4gIFwiZXhlcmNpc2VzXCI6IFtcclxuICAgIHtcInByb21wdFwiOiBcIkV4ZXJjaXNlIDFcIiwgXCJhbnN3ZXJcIjogXCJBbnN3ZXIgMVwiLCBcImV4cGxhbmF0aW9uXCI6IFwiV2h5XCJ9LFxyXG4gICAge1wicHJvbXB0XCI6IFwiRXhlcmNpc2UgMlwiLCBcImFuc3dlclwiOiBcIkFuc3dlciAyXCIsIFwiZXhwbGFuYXRpb25cIjogXCJXaHlcIn0sXHJcbiAgICB7XCJwcm9tcHRcIjogXCJFeGVyY2lzZSAzXCIsIFwiYW5zd2VyXCI6IFwiQW5zd2VyIDNcIiwgXCJleHBsYW5hdGlvblwiOiBcIldoeVwifVxyXG4gIF1cclxufWBcclxuXHJcbiAgICByZXR1cm4gcHJvbXB0XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBWYWxpZGF0ZSBncmFtbWFyIHNlY3Rpb24gZm9yIGNvbXBsZXRlbmVzcyBhbmQgcXVhbGl0eVxyXG4gICAqL1xyXG4gIHByaXZhdGUgdmFsaWRhdGVHcmFtbWFyU2VjdGlvbihcclxuICAgIGdyYW1tYXJEYXRhOiBhbnksXHJcbiAgICBjb250ZXh0OiBTaGFyZWRDb250ZXh0XHJcbiAgKTogeyBpc1ZhbGlkOiBib29sZWFuOyBpc3N1ZXM6IHN0cmluZ1tdIH0ge1xyXG4gICAgY29uc3QgaXNzdWVzOiBzdHJpbmdbXSA9IFtdXHJcblxyXG4gICAgLy8gQ2hlY2sgcmVxdWlyZWQgZmllbGRzIGV4aXN0XHJcbiAgICBpZiAoIWdyYW1tYXJEYXRhLmdyYW1tYXJQb2ludCB8fCB0eXBlb2YgZ3JhbW1hckRhdGEuZ3JhbW1hclBvaW50ICE9PSAnc3RyaW5nJykge1xyXG4gICAgICBpc3N1ZXMucHVzaCgnTWlzc2luZyBvciBpbnZhbGlkIGdyYW1tYXJQb2ludCcpXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFncmFtbWFyRGF0YS5leHBsYW5hdGlvbiB8fCB0eXBlb2YgZ3JhbW1hckRhdGEuZXhwbGFuYXRpb24gIT09ICdvYmplY3QnKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKCdNaXNzaW5nIG9yIGludmFsaWQgZXhwbGFuYXRpb24gb2JqZWN0JylcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIENoZWNrIGV4cGxhbmF0aW9uIGhhcyBib3RoIGZvcm0gYW5kIHVzYWdlXHJcbiAgICAgIGlmICghZ3JhbW1hckRhdGEuZXhwbGFuYXRpb24uZm9ybSB8fCBncmFtbWFyRGF0YS5leHBsYW5hdGlvbi5mb3JtLmxlbmd0aCA8IDIwKSB7XHJcbiAgICAgICAgaXNzdWVzLnB1c2goJ01pc3Npbmcgb3IgaW5zdWZmaWNpZW50IGZvcm0gZXhwbGFuYXRpb24gKG1pbmltdW0gMjAgY2hhcmFjdGVycyknKVxyXG4gICAgICB9XHJcbiAgICAgIGlmICghZ3JhbW1hckRhdGEuZXhwbGFuYXRpb24udXNhZ2UgfHwgZ3JhbW1hckRhdGEuZXhwbGFuYXRpb24udXNhZ2UubGVuZ3RoIDwgMzApIHtcclxuICAgICAgICBpc3N1ZXMucHVzaCgnTWlzc2luZyBvciBpbnN1ZmZpY2llbnQgdXNhZ2UgZXhwbGFuYXRpb24gKG1pbmltdW0gMzAgY2hhcmFjdGVycyknKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgZXhhbXBsZXMgYXJyYXlcclxuICAgIGlmICghQXJyYXkuaXNBcnJheShncmFtbWFyRGF0YS5leGFtcGxlcykpIHtcclxuICAgICAgaXNzdWVzLnB1c2goJ0V4YW1wbGVzIG11c3QgYmUgYW4gYXJyYXknKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKGdyYW1tYXJEYXRhLmV4YW1wbGVzLmxlbmd0aCA8IDMpIHtcclxuICAgICAgICBpc3N1ZXMucHVzaChgSW5zdWZmaWNpZW50IGV4YW1wbGVzOiBleHBlY3RlZCBtaW5pbXVtIDMsIGdvdCAke2dyYW1tYXJEYXRhLmV4YW1wbGVzLmxlbmd0aH1gKVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBWYWxpZGF0ZSBlYWNoIGV4YW1wbGVcclxuICAgICAgZ3JhbW1hckRhdGEuZXhhbXBsZXMuZm9yRWFjaCgoZXhhbXBsZTogYW55LCBpbmRleDogbnVtYmVyKSA9PiB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBleGFtcGxlICE9PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgaXNzdWVzLnB1c2goYEV4YW1wbGUgJHtpbmRleCArIDF9IG11c3QgYmUgYSBzdHJpbmdgKVxyXG4gICAgICAgIH0gZWxzZSBpZiAoZXhhbXBsZS5sZW5ndGggPCAxMCkge1xyXG4gICAgICAgICAgaXNzdWVzLnB1c2goYEV4YW1wbGUgJHtpbmRleCArIDF9IHRvbyBzaG9ydCAobWluaW11bSAxMCBjaGFyYWN0ZXJzKWApXHJcbiAgICAgICAgfSBlbHNlIGlmICghL15bQS1aXS8udGVzdChleGFtcGxlKSkge1xyXG4gICAgICAgICAgaXNzdWVzLnB1c2goYEV4YW1wbGUgJHtpbmRleCArIDF9IHNob3VsZCBzdGFydCB3aXRoIGNhcGl0YWwgbGV0dGVyYClcclxuICAgICAgICB9IGVsc2UgaWYgKCEvWy4hP10kLy50ZXN0KGV4YW1wbGUpKSB7XHJcbiAgICAgICAgICBpc3N1ZXMucHVzaChgRXhhbXBsZSAke2luZGV4ICsgMX0gc2hvdWxkIGVuZCB3aXRoIHB1bmN0dWF0aW9uYClcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgZXhlcmNpc2VzIGFycmF5XHJcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkoZ3JhbW1hckRhdGEuZXhlcmNpc2VzKSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCgnRXhlcmNpc2VzIG11c3QgYmUgYW4gYXJyYXknKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKGdyYW1tYXJEYXRhLmV4ZXJjaXNlcy5sZW5ndGggPCAzKSB7XHJcbiAgICAgICAgaXNzdWVzLnB1c2goYEluc3VmZmljaWVudCBleGVyY2lzZXM6IGV4cGVjdGVkIG1pbmltdW0gMywgZ290ICR7Z3JhbW1hckRhdGEuZXhlcmNpc2VzLmxlbmd0aH1gKVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBWYWxpZGF0ZSBlYWNoIGV4ZXJjaXNlXHJcbiAgICAgIGdyYW1tYXJEYXRhLmV4ZXJjaXNlcy5mb3JFYWNoKChleGVyY2lzZTogYW55LCBpbmRleDogbnVtYmVyKSA9PiB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBleGVyY2lzZSAhPT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgIGlzc3Vlcy5wdXNoKGBFeGVyY2lzZSAke2luZGV4ICsgMX0gbXVzdCBiZSBhbiBvYmplY3RgKVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAoIWV4ZXJjaXNlLnByb21wdCB8fCB0eXBlb2YgZXhlcmNpc2UucHJvbXB0ICE9PSAnc3RyaW5nJyB8fCBleGVyY2lzZS5wcm9tcHQubGVuZ3RoIDwgMTApIHtcclxuICAgICAgICAgICAgaXNzdWVzLnB1c2goYEV4ZXJjaXNlICR7aW5kZXggKyAxfSBtaXNzaW5nIG9yIGludmFsaWQgcHJvbXB0YClcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmICghZXhlcmNpc2UuYW5zd2VyIHx8IHR5cGVvZiBleGVyY2lzZS5hbnN3ZXIgIT09ICdzdHJpbmcnIHx8IGV4ZXJjaXNlLmFuc3dlci5sZW5ndGggPCAxKSB7XHJcbiAgICAgICAgICAgIGlzc3Vlcy5wdXNoKGBFeGVyY2lzZSAke2luZGV4ICsgMX0gbWlzc2luZyBvciBpbnZhbGlkIGFuc3dlcmApXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGNvbnRleHR1YWwgcmVsZXZhbmNlXHJcbiAgICBpZiAoZ3JhbW1hckRhdGEuZXhhbXBsZXMgJiYgQXJyYXkuaXNBcnJheShncmFtbWFyRGF0YS5leGFtcGxlcykpIHtcclxuICAgICAgY29uc3QgaGFzQ29udGV4dHVhbFJlbGV2YW5jZSA9IGdyYW1tYXJEYXRhLmV4YW1wbGVzLnNvbWUoKGV4YW1wbGU6IHN0cmluZykgPT4ge1xyXG4gICAgICAgIGNvbnN0IGV4YW1wbGVMb3dlciA9IGV4YW1wbGUudG9Mb3dlckNhc2UoKVxyXG4gICAgICAgIHJldHVybiBjb250ZXh0Lm1haW5UaGVtZXMuc29tZSh0aGVtZSA9PiB7XHJcbiAgICAgICAgICBjb25zdCB0aGVtZVdvcmRzID0gdGhlbWUudG9Mb3dlckNhc2UoKS5zcGxpdCgvXFxzKy8pXHJcbiAgICAgICAgICByZXR1cm4gdGhlbWVXb3Jkcy5zb21lKHdvcmQgPT5cclxuICAgICAgICAgICAgd29yZC5sZW5ndGggPiAzICYmIGV4YW1wbGVMb3dlci5pbmNsdWRlcyh3b3JkKVxyXG4gICAgICAgICAgKVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pXHJcblxyXG4gICAgICBpZiAoIWhhc0NvbnRleHR1YWxSZWxldmFuY2UgJiYgY29udGV4dC5tYWluVGhlbWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBpc3N1ZXMucHVzaCgnRXhhbXBsZXMgbGFjayBjb250ZXh0dWFsIHJlbGV2YW5jZSB0byBzb3VyY2UgbWF0ZXJpYWwnKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXNWYWxpZDogaXNzdWVzLmxlbmd0aCA9PT0gMCxcclxuICAgICAgaXNzdWVzXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlR3JhbW1hcldpdGhDb250ZXh0KFxyXG4gICAgY29udGV4dDogU2hhcmVkQ29udGV4dCxcclxuICAgIF9wcmV2aW91c1NlY3Rpb25zOiBHZW5lcmF0ZWRTZWN0aW9uW11cclxuICApOiBQcm9taXNlPGFueT4ge1xyXG4gICAgY29uc3QgbWF4QXR0ZW1wdHMgPSAyXHJcbiAgICBsZXQgYXR0ZW1wdCA9IDBcclxuICAgIGNvbnN0IHNlY3Rpb25TdGFydFRpbWUgPSBEYXRlLm5vdygpXHJcblxyXG4gICAgLy8gUmVwb3J0IHByb2dyZXNzIGF0IHN0YXJ0IG9mIGdyYW1tYXIgZ2VuZXJhdGlvblxyXG4gICAgc2FmZVByb2dyZXNzQ2FsbGJhY2sodGhpcy5wcm9ncmVzc0NhbGxiYWNrLCB7XHJcbiAgICAgIHN0ZXA6ICdHZW5lcmF0aW5nIGdyYW1tYXIgc2VjdGlvbicsXHJcbiAgICAgIHByb2dyZXNzOiB0aGlzLmNhbGN1bGF0ZVByb2dyZXNzKHRoaXMuY29tcGxldGVkU2VjdGlvbnMsICdncmFtbWFyJywgY29udGV4dC5sZXNzb25UeXBlLCB0aGlzLnBoYXNlV2VpZ2h0cyksXHJcbiAgICAgIHBoYXNlOiAnZ3JhbW1hcicsXHJcbiAgICAgIHNlY3Rpb246ICdncmFtbWFyJ1xyXG4gICAgfSlcclxuXHJcbiAgICB3aGlsZSAoYXR0ZW1wdCA8IG1heEF0dGVtcHRzKSB7XHJcbiAgICAgIGF0dGVtcHQrK1xyXG4gICAgICBjb25zb2xlLmxvZyhg8J+TmiBHZW5lcmF0aW5nIGNvbXByZWhlbnNpdmUgZ3JhbW1hciBzZWN0aW9uIChhdHRlbXB0ICR7YXR0ZW1wdH0vJHttYXhBdHRlbXB0c30pYClcclxuXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgLy8gQnVpbGQgZW5oYW5jZWQgZ3JhbW1hciBwcm9tcHRcclxuICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmJ1aWxkR3JhbW1hclByb21wdChjb250ZXh0KVxyXG5cclxuICAgICAgICAvLyBHZW5lcmF0ZSBncmFtbWFyIHNlY3Rpb24gd2l0aCBpbmNyZWFzZWQgdG9rZW4gbGltaXRcclxuICAgICAgICBsZXQgcmVzcG9uc2U6IHN0cmluZztcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgLy8gSW5jcmVhc2UgbWF4T3V0cHV0VG9rZW5zIHRvIDMwMDAgdG8gYWxsb3cgY29tcGxldGUgSlNPTiByZXNwb25zZVxyXG4gICAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdCwgeyBtYXhUb2tlbnM6IDMwMDAgfSlcclxuICAgICAgICB9IGNhdGNoIChwcm9tcHRFcnJvcjogYW55KSB7XHJcbiAgICAgICAgICAvLyBIYW5kbGUgTUFYX1RPS0VOUyBlcnJvciAtIGFjY2VwdCBwYXJ0aWFsIHJlc3BvbnNlIGlmIGF2YWlsYWJsZVxyXG4gICAgICAgICAgaWYgKHByb21wdEVycm9yLmNvZGUgPT09ICdNQVhfVE9LRU5TJykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIE1BWF9UT0tFTlMgaGl0IGluIGdyYW1tYXIgZ2VuZXJhdGlvbmApXHJcbiAgICAgICAgICAgIC8vIERvbid0IHJldHJ5IC0gdGhlIGVycm9yIG1lYW5zIHdlIGdvdCBubyBjb250ZW50IGF0IGFsbFxyXG4gICAgICAgICAgICAvLyBJZiB3ZSBnb3QgcGFydGlhbCBjb250ZW50LCBpdCB3b3VsZCBoYXZlIGJlZW4gcmV0dXJuZWRcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdHcmFtbWFyIGdlbmVyYXRpb24gZmFpbGVkOiBObyBjb250ZW50IHJldHVybmVkIGR1ZSB0byBNQVhfVE9LRU5TJylcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IHByb21wdEVycm9yXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnNvbGUubG9nKGDwn5OdIFJhdyBncmFtbWFyIHJlc3BvbnNlICgke3Jlc3BvbnNlLmxlbmd0aH0gY2hhcnMpYClcclxuXHJcbiAgICAgICAgLy8gUGFyc2UgSlNPTiByZXNwb25zZSB3aXRoIGJldHRlciBlcnJvciBoYW5kbGluZyBhbmQgcmVwYWlyXHJcbiAgICAgICAgbGV0IGdyYW1tYXJEYXRhOiBhbnlcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgLy8gUmVtb3ZlIG1hcmtkb3duIGNvZGUgYmxvY2tzIGlmIHByZXNlbnRcclxuICAgICAgICAgIGxldCBjbGVhblJlc3BvbnNlID0gcmVzcG9uc2UucmVwbGFjZSgvYGBganNvblxccyovZywgJycpLnJlcGxhY2UoL2BgYFxccyovZywgJycpLnRyaW0oKVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBUcnkgdG8gZXh0cmFjdCBKU09OIGZyb20gcmVzcG9uc2VcclxuICAgICAgICAgIGNvbnN0IGpzb25NYXRjaCA9IGNsZWFuUmVzcG9uc2UubWF0Y2goL1xce1tcXHNcXFNdKlxcfS8pXHJcbiAgICAgICAgICBpZiAoanNvbk1hdGNoKSB7XHJcbiAgICAgICAgICAgIGxldCBqc29uU3RyID0ganNvbk1hdGNoWzBdXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDwn5SNIEF0dGVtcHRpbmcgdG8gcGFyc2UgSlNPTiAoJHtqc29uU3RyLmxlbmd0aH0gY2hhcnMpYClcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFRyeSB0byByZXBhaXIgaW5jb21wbGV0ZSBKU09OXHJcbiAgICAgICAgICAgIGlmICghanNvblN0ci50cmltKCkuZW5kc1dpdGgoJ30nKSkge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGDimqDvuI8gSlNPTiBhcHBlYXJzIGluY29tcGxldGUsIGF0dGVtcHRpbmcgcmVwYWlyLi4uYClcclxuICAgICAgICAgICAgICAvLyBUcnkgdG8gY2xvc2UgaW5jb21wbGV0ZSBzdHJ1Y3R1cmVzXHJcbiAgICAgICAgICAgICAganNvblN0ciA9IHRoaXMucmVwYWlySW5jb21wbGV0ZUpTT04oanNvblN0cilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICBncmFtbWFyRGF0YSA9IEpTT04ucGFyc2UoanNvblN0cilcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg4pyFIEpTT04gcGFyc2VkIHN1Y2Nlc3NmdWxseWApXHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKHBhcnNlRXJyKSB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coYOKaoO+4jyBKU09OIHBhcnNpbmcgZmFpbGVkIGFmdGVyIHJlcGFpciBhdHRlbXB0YClcclxuICAgICAgICAgICAgICBpZiAoYXR0ZW1wdCA8IG1heEF0dGVtcHRzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+UhCBSZXRyeWluZyB3aXRoIGFkanVzdGVkIHByb21wdC4uLmApXHJcbiAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB0aHJvdyBwYXJzZUVyclxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+UjSBObyBKU09OIGZvdW5kIGluIHJlc3BvbnNlYClcclxuICAgICAgICAgICAgaWYgKGF0dGVtcHQgPCBtYXhBdHRlbXB0cykge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGDwn5SEIFJldHJ5aW5nLi4uYClcclxuICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gSlNPTiBmb3VuZCBpbiByZXNwb25zZScpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coYOKaoO+4jyBKU09OIHBhcnNpbmcgZmFpbGVkOmAsIHBhcnNlRXJyb3IpXHJcbiAgICAgICAgICBpZiAoYXR0ZW1wdCA8IG1heEF0dGVtcHRzKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDwn5SEIFJldHJ5aW5nIHdpdGggYWRqdXN0ZWQgcHJvbXB0Li4uYClcclxuICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHBhcnNlIGdyYW1tYXIgSlNPTiByZXNwb25zZScpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBWYWxpZGF0ZSBncmFtbWFyIHNlY3Rpb24gdXNpbmcgbmV3IHZhbGlkYXRvclxyXG4gICAgICAgIGNvbnN0IGdyYW1tYXJTZWN0aW9uID0ge1xyXG4gICAgICAgICAgcnVsZTogZ3JhbW1hckRhdGEuZXhwbGFuYXRpb24/LmZvcm0gfHwgJycsXHJcbiAgICAgICAgICBmb3JtOiBncmFtbWFyRGF0YS5leHBsYW5hdGlvbj8uZm9ybSB8fCAnJyxcclxuICAgICAgICAgIHVzYWdlOiBncmFtbWFyRGF0YS5leHBsYW5hdGlvbj8udXNhZ2UgfHwgJycsXHJcbiAgICAgICAgICBleGFtcGxlczogZ3JhbW1hckRhdGEuZXhhbXBsZXMgfHwgW10sXHJcbiAgICAgICAgICBleGVyY2lzZXM6IGdyYW1tYXJEYXRhLmV4ZXJjaXNlcyB8fCBbXVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gZ3JhbW1hclZhbGlkYXRvci52YWxpZGF0ZShncmFtbWFyU2VjdGlvbiwgY29udGV4dC5kaWZmaWN1bHR5TGV2ZWwpXHJcblxyXG4gICAgICAgIGlmICghdmFsaWRhdGlvbi5pc1ZhbGlkKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIEdyYW1tYXIgdmFsaWRhdGlvbiBmYWlsZWQ6YCwgdmFsaWRhdGlvbi5pc3N1ZXMpXHJcbiAgICAgICAgICBpZiAoYXR0ZW1wdCA8IG1heEF0dGVtcHRzKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDwn5SEIFJldHJ5aW5nIHdpdGggYWRqdXN0ZWQgcHJvbXB0Li4uYClcclxuICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDimqDvuI8gVXNpbmcgZ3JhbW1hciBzZWN0aW9uIGRlc3BpdGUgdmFsaWRhdGlvbiBpc3N1ZXMgKG1heCBhdHRlbXB0cyByZWFjaGVkKWApXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDinIUgR3JhbW1hciBzZWN0aW9uIHZhbGlkYXRlZCBzdWNjZXNzZnVsbHlgKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVHJhY2sgcXVhbGl0eSBtZXRyaWNzXHJcbiAgICAgICAgY29uc3QgZ2VuZXJhdGlvblRpbWUgPSBEYXRlLm5vdygpIC0gc2VjdGlvblN0YXJ0VGltZVxyXG4gICAgICAgIHF1YWxpdHlNZXRyaWNzVHJhY2tlci5yZWNvcmRTZWN0aW9uKFxyXG4gICAgICAgICAgJ2dyYW1tYXInLFxyXG4gICAgICAgICAgdmFsaWRhdGlvbi5zY29yZSxcclxuICAgICAgICAgIGF0dGVtcHQsXHJcbiAgICAgICAgICBnZW5lcmF0aW9uVGltZSxcclxuICAgICAgICAgIHZhbGlkYXRpb24uaXNzdWVzLmxlbmd0aCxcclxuICAgICAgICAgIHZhbGlkYXRpb24ud2FybmluZ3MubGVuZ3RoXHJcbiAgICAgICAgKVxyXG5cclxuICAgICAgICAvLyBSZXR1cm4gdGhlIGNvbXByZWhlbnNpdmUgZ3JhbW1hciBzdHJ1Y3R1cmVcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgZm9jdXM6IGdyYW1tYXJEYXRhLmdyYW1tYXJQb2ludCxcclxuICAgICAgICAgIGV4cGxhbmF0aW9uOiBncmFtbWFyRGF0YS5leHBsYW5hdGlvbixcclxuICAgICAgICAgIGV4YW1wbGVzOiBncmFtbWFyRGF0YS5leGFtcGxlcyxcclxuICAgICAgICAgIGV4ZXJjaXNlczogZ3JhbW1hckRhdGEuZXhlcmNpc2VzXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGDinYwgQXR0ZW1wdCAke2F0dGVtcHR9IGZhaWxlZDpgLCBlcnJvcilcclxuICAgICAgICBpZiAoYXR0ZW1wdCA+PSBtYXhBdHRlbXB0cykge1xyXG4gICAgICAgICAgLy8gVHJhY2sgZmFpbGVkIGdlbmVyYXRpb25cclxuICAgICAgICAgIHF1YWxpdHlNZXRyaWNzVHJhY2tlci5yZWNvcmRTZWN0aW9uKFxyXG4gICAgICAgICAgICAnZ3JhbW1hcicsXHJcbiAgICAgICAgICAgIDAsXHJcbiAgICAgICAgICAgIGF0dGVtcHQsXHJcbiAgICAgICAgICAgIERhdGUubm93KCkgLSBzZWN0aW9uU3RhcnRUaW1lLFxyXG4gICAgICAgICAgICAxLFxyXG4gICAgICAgICAgICAwXHJcbiAgICAgICAgICApXHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBnZW5lcmF0ZSBncmFtbWFyIHNlY3Rpb24gYWZ0ZXIgJHttYXhBdHRlbXB0c30gYXR0ZW1wdHM6ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfWApXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIGdyYW1tYXIgc2VjdGlvbiBhZnRlciBhbGwgYXR0ZW1wdHNcIilcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBhcnNlIHByb251bmNpYXRpb24gd29yZCByZXNwb25zZSBmcm9tIHN0cnVjdHVyZWQgdGV4dCBmb3JtYXRcclxuICAgKi9cclxuICBwcml2YXRlIHBhcnNlUHJvbnVuY2lhdGlvbldvcmRSZXNwb25zZShyZXNwb25zZTogc3RyaW5nLCB3b3JkOiBzdHJpbmcpOiBhbnkge1xyXG4gICAgY29uc3QgbGluZXMgPSByZXNwb25zZS5zcGxpdCgnXFxuJykubWFwKGxpbmUgPT4gbGluZS50cmltKCkpLmZpbHRlcihsaW5lID0+IGxpbmUubGVuZ3RoID4gMClcclxuXHJcbiAgICBjb25zdCByZXN1bHQ6IGFueSA9IHtcclxuICAgICAgd29yZDogd29yZCxcclxuICAgICAgaXBhOiAnJyxcclxuICAgICAgZGlmZmljdWx0U291bmRzOiBbXSxcclxuICAgICAgdGlwczogW10sXHJcbiAgICAgIHByYWN0aWNlU2VudGVuY2U6ICcnXHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XHJcbiAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoJ1dPUkQ6JykpIHtcclxuICAgICAgICByZXN1bHQud29yZCA9IGxpbmUuc3Vic3RyaW5nKDUpLnRyaW0oKVxyXG4gICAgICB9IGVsc2UgaWYgKGxpbmUuc3RhcnRzV2l0aCgnSVBBOicpKSB7XHJcbiAgICAgICAgcmVzdWx0LmlwYSA9IGxpbmUuc3Vic3RyaW5nKDQpLnRyaW0oKVxyXG4gICAgICB9IGVsc2UgaWYgKGxpbmUuc3RhcnRzV2l0aCgnRElGRklDVUxUX1NPVU5EUzonKSkge1xyXG4gICAgICAgIGNvbnN0IHNvdW5kcyA9IGxpbmUuc3Vic3RyaW5nKDE3KS50cmltKClcclxuICAgICAgICByZXN1bHQuZGlmZmljdWx0U291bmRzID0gc291bmRzLnNwbGl0KCcsJykubWFwKHMgPT4gcy50cmltKCkpLmZpbHRlcihzID0+IHMubGVuZ3RoID4gMClcclxuICAgICAgfSBlbHNlIGlmIChsaW5lLnN0YXJ0c1dpdGgoJ1RJUF8nKSkge1xyXG4gICAgICAgIGNvbnN0IHRpcCA9IGxpbmUuc3Vic3RyaW5nKGxpbmUuaW5kZXhPZignOicpICsgMSkudHJpbSgpXHJcbiAgICAgICAgaWYgKHRpcC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICByZXN1bHQudGlwcy5wdXNoKHRpcClcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAobGluZS5zdGFydHNXaXRoKCdQUkFDVElDRTonKSkge1xyXG4gICAgICAgIHJlc3VsdC5wcmFjdGljZVNlbnRlbmNlID0gbGluZS5zdWJzdHJpbmcoOSkudHJpbSgpXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmVzdWx0XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBQYXJzZSB0b25ndWUgdHdpc3RlciByZXNwb25zZSBmcm9tIHN0cnVjdHVyZWQgdGV4dCBmb3JtYXRcclxuICAgKi9cclxuICBwcml2YXRlIHBhcnNlVG9uZ3VlVHdpc3RlclJlc3BvbnNlKHJlc3BvbnNlOiBzdHJpbmcsIGV4cGVjdGVkQ291bnQ6IG51bWJlcik6IGFueVtdIHtcclxuICAgIGNvbnN0IGxpbmVzID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKS5maWx0ZXIobGluZSA9PiBsaW5lLmxlbmd0aCA+IDApXHJcblxyXG4gICAgY29uc3QgdHdpc3RlcnM6IGFueVtdID0gW11cclxuICAgIGxldCBjdXJyZW50VHdpc3RlcjogYW55ID0gbnVsbFxyXG4gICAgbGV0IGN1cnJlbnRJbmRleCA9IC0xXHJcblxyXG4gICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XHJcbiAgICAgIGNvbnN0IHR3aXN0ZXJNYXRjaCA9IGxpbmUubWF0Y2goL15UV0lTVEVSXyhcXGQrKTooLispLylcclxuICAgICAgaWYgKHR3aXN0ZXJNYXRjaCkge1xyXG4gICAgICAgIGN1cnJlbnRJbmRleCA9IHBhcnNlSW50KHR3aXN0ZXJNYXRjaFsxXSkgLSAxXHJcbiAgICAgICAgY3VycmVudFR3aXN0ZXIgPSB7XHJcbiAgICAgICAgICB0ZXh0OiB0d2lzdGVyTWF0Y2hbMl0udHJpbSgpLFxyXG4gICAgICAgICAgdGFyZ2V0U291bmRzOiBbXSxcclxuICAgICAgICAgIGRpZmZpY3VsdHk6ICdtb2RlcmF0ZSdcclxuICAgICAgICB9XHJcbiAgICAgICAgdHdpc3RlcnNbY3VycmVudEluZGV4XSA9IGN1cnJlbnRUd2lzdGVyXHJcbiAgICAgICAgY29udGludWVcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3Qgc291bmRzTWF0Y2ggPSBsaW5lLm1hdGNoKC9eU09VTkRTXyhcXGQrKTooLispLylcclxuICAgICAgaWYgKHNvdW5kc01hdGNoICYmIGN1cnJlbnRUd2lzdGVyKSB7XHJcbiAgICAgICAgY29uc3Qgc291bmRzID0gc291bmRzTWF0Y2hbMl0udHJpbSgpXHJcbiAgICAgICAgY3VycmVudFR3aXN0ZXIudGFyZ2V0U291bmRzID0gc291bmRzLnNwbGl0KCcsJykubWFwKHMgPT4gcy50cmltKCkpLmZpbHRlcihzID0+IHMubGVuZ3RoID4gMClcclxuICAgICAgICBjb250aW51ZVxyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBkaWZmaWN1bHR5TWF0Y2ggPSBsaW5lLm1hdGNoKC9eRElGRklDVUxUWV8oXFxkKyk6KC4rKS8pXHJcbiAgICAgIGlmIChkaWZmaWN1bHR5TWF0Y2ggJiYgY3VycmVudFR3aXN0ZXIpIHtcclxuICAgICAgICBjdXJyZW50VHdpc3Rlci5kaWZmaWN1bHR5ID0gZGlmZmljdWx0eU1hdGNoWzJdLnRyaW0oKVxyXG4gICAgICAgIGNvbnRpbnVlXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBGaWx0ZXIgb3V0IGFueSBudWxsIGVudHJpZXNcclxuICAgIHJldHVybiB0d2lzdGVycy5maWx0ZXIodCA9PiB0ICYmIHQudGV4dCAmJiB0LnRleHQubGVuZ3RoID4gMClcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNlbGVjdCBjaGFsbGVuZ2luZyB3b3JkcyBmb3IgcHJvbnVuY2lhdGlvbiBwcmFjdGljZVxyXG4gICAqIEltcGxlbWVudHMgUmVxdWlyZW1lbnRzIDYuNSwgNi42IC0gU2VsZWN0IHdvcmRzIHdpdGggY2hhbGxlbmdpbmcgc291bmRzIGZvciB0YXJnZXQgbGFuZ3VhZ2UgbGVhcm5lcnNcclxuICAgKi9cclxuICBwcml2YXRlIHNlbGVjdENoYWxsZW5naW5nV29yZHMoY29udGV4dDogU2hhcmVkQ29udGV4dCwgY291bnQ6IG51bWJlcik6IHN0cmluZ1tdIHtcclxuICAgIC8vIEdldCB2b2NhYnVsYXJ5IGZyb20gY29udGV4dCAtIGVuc3VyZSB3b3JkcyBhcmUgZnJvbSBsZXNzb24gdm9jYWJ1bGFyeVxyXG4gICAgY29uc3Qgdm9jYWJ1bGFyeVNlY3Rpb24gPSBjb250ZXh0LmtleVZvY2FidWxhcnlcclxuXHJcbiAgICBpZiAodm9jYWJ1bGFyeVNlY3Rpb24ubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfimqDvuI8gTm8gdm9jYWJ1bGFyeSBhdmFpbGFibGUgZm9yIHByb251bmNpYXRpb24gc2VsZWN0aW9uJylcclxuICAgICAgcmV0dXJuIFtdXHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coYPCflI0gU2VsZWN0aW5nICR7Y291bnR9IGNoYWxsZW5naW5nIHdvcmRzIGZyb20gJHt2b2NhYnVsYXJ5U2VjdGlvbi5sZW5ndGh9IHZvY2FidWxhcnkgd29yZHNgKVxyXG5cclxuICAgIC8vIFNjb3JlIHdvcmRzIGJ5IHByb251bmNpYXRpb24gZGlmZmljdWx0eSB3aXRoIGVuaGFuY2VkIGNyaXRlcmlhXHJcbiAgICBjb25zdCBzY29yZWRXb3JkcyA9IHZvY2FidWxhcnlTZWN0aW9uLm1hcCh3b3JkID0+IHtcclxuICAgICAgbGV0IHNjb3JlID0gMFxyXG4gICAgICBjb25zdCB3b3JkTG93ZXIgPSB3b3JkLnRvTG93ZXJDYXNlKClcclxuICAgICAgY29uc3QgY2hhbGxlbmdpbmdTb3VuZHM6IHN0cmluZ1tdID0gW11cclxuXHJcbiAgICAgIC8vIEJhc2Ugc2NvcmU6IExvbmdlciB3b3JkcyBhcmUgdHlwaWNhbGx5IG1vcmUgY2hhbGxlbmdpbmcgKGJ1dCBjYXAgdG8gYXZvaWQgb3Zlci13ZWlnaHRpbmcpXHJcbiAgICAgIHNjb3JlICs9IE1hdGgubWluKHdvcmQubGVuZ3RoLCAxMilcclxuXHJcbiAgICAgIC8vIEhJR0ggUFJJT1JJVFk6IENvbnNvbmFudCBkaWdyYXBocyBhbmQgZGlmZmljdWx0IGNvbnNvbmFudCBzb3VuZHMgKG1vc3QgY2hhbGxlbmdpbmcgZm9yIGxlYXJuZXJzKVxyXG4gICAgICBjb25zdCBjb25zb25hbnRQYXR0ZXJucyA9IFtcclxuICAgICAgICB7IHBhdHRlcm46IC90aC9naSwgc291bmQ6ICcvzrgvIG9yIC/DsC8nLCB3ZWlnaHQ6IDUgfSwgIC8vICd0aCcgc291bmRzICh0aGluaywgdGhpcylcclxuICAgICAgICB7IHBhdHRlcm46IC9jaC9naSwgc291bmQ6ICcvdMqDLycsIHdlaWdodDogNCB9LCAgICAgICAgLy8gJ2NoJyBzb3VuZCAoY2h1cmNoKVxyXG4gICAgICAgIHsgcGF0dGVybjogL3NoL2dpLCBzb3VuZDogJy/Kgy8nLCB3ZWlnaHQ6IDQgfSwgICAgICAgICAvLyAnc2gnIHNvdW5kIChzaGlwKVxyXG4gICAgICAgIHsgcGF0dGVybjogL3BoL2dpLCBzb3VuZDogJy9mLycsIHdlaWdodDogMyB9LCAgICAgICAgIC8vICdwaCcgc291bmQgKHBob25lKVxyXG4gICAgICAgIHsgcGF0dGVybjogL2doL2dpLCBzb3VuZDogJy9nLyBvciAvZi8nLCB3ZWlnaHQ6IDQgfSwgIC8vICdnaCcgc291bmQgKGdob3N0LCBsYXVnaClcclxuICAgICAgICB7IHBhdHRlcm46IC9uZy9naSwgc291bmQ6ICcvxYsvJywgd2VpZ2h0OiAzIH0sICAgICAgICAgLy8gJ25nJyBzb3VuZCAoc2luZylcclxuICAgICAgICB7IHBhdHRlcm46IC93aC9naSwgc291bmQ6ICcvdy8gb3IgL2h3LycsIHdlaWdodDogMyB9LCAvLyAnd2gnIHNvdW5kICh3aGF0KVxyXG4gICAgICAgIHsgcGF0dGVybjogL1teYWVpb3Vdci9naSwgc291bmQ6ICcvci8nLCB3ZWlnaHQ6IDQgfSwgIC8vICdyJyBhZnRlciBjb25zb25hbnQgKHRyeSwgYnJvd24pXHJcbiAgICAgIF1cclxuXHJcbiAgICAgIGNvbnNvbmFudFBhdHRlcm5zLmZvckVhY2goKHsgcGF0dGVybiwgc291bmQsIHdlaWdodCB9KSA9PiB7XHJcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHdvcmRMb3dlci5tYXRjaChwYXR0ZXJuKVxyXG4gICAgICAgIGlmIChtYXRjaGVzKSB7XHJcbiAgICAgICAgICBzY29yZSArPSB3ZWlnaHQgKiBtYXRjaGVzLmxlbmd0aFxyXG4gICAgICAgICAgY2hhbGxlbmdpbmdTb3VuZHMucHVzaChzb3VuZClcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAvLyBNRURJVU0gUFJJT1JJVFk6IENvbXBsZXggdm93ZWwgY29tYmluYXRpb25zIChjaGFsbGVuZ2luZyBmb3IgcHJvbnVuY2lhdGlvbilcclxuICAgICAgY29uc3Qgdm93ZWxQYXR0ZXJucyA9IFtcclxuICAgICAgICB7IHBhdHRlcm46IC9vdWdofGF1Z2gvZ2ksIHNvdW5kOiAnL8mUy5AvIG9yIC/KjGYvJywgd2VpZ2h0OiA1IH0sICAvLyBWZXJ5IGlycmVndWxhciAodGhyb3VnaCwgbGF1Z2gpXHJcbiAgICAgICAgeyBwYXR0ZXJuOiAvZWF1L2dpLCBzb3VuZDogJy9vyoovJywgd2VpZ2h0OiA0IH0sICAgICAgICAgICAgICAgIC8vIEZyZW5jaC1vcmlnaW4gKGJlYXV0aWZ1bClcclxuICAgICAgICB7IHBhdHRlcm46IC9pZXUvZ2ksIHNvdW5kOiAnL2p1y5AvJywgd2VpZ2h0OiA0IH0sICAgICAgICAgICAgICAgLy8gKGxpZXV0ZW5hbnQpXHJcbiAgICAgICAgeyBwYXR0ZXJuOiAvb3UvZ2ksIHNvdW5kOiAnL2HKii8gb3IgL3XLkC8nLCB3ZWlnaHQ6IDMgfSwgICAgICAgIC8vIChob3VzZSwgc291cClcclxuICAgICAgICB7IHBhdHRlcm46IC9vby9naSwgc291bmQ6ICcvdcuQLyBvciAvyoovJywgd2VpZ2h0OiAzIH0sICAgICAgICAgLy8gKGZvb2QsIGJvb2spXHJcbiAgICAgICAgeyBwYXR0ZXJuOiAvZWEvZ2ksIHNvdW5kOiAnL2nLkC8gb3IgL2UvJywgd2VpZ2h0OiAzIH0sICAgICAgICAgLy8gKGVhdCwgYnJlYWQpXHJcbiAgICAgICAgeyBwYXR0ZXJuOiAvYXV8YXcvZ2ksIHNvdW5kOiAnL8mUy5AvJywgd2VpZ2h0OiAzIH0sICAgICAgICAgICAgIC8vIChhdXR1bW4sIGxhdylcclxuICAgICAgICB7IHBhdHRlcm46IC9vaXxveS9naSwgc291bmQ6ICcvyZTJqi8nLCB3ZWlnaHQ6IDMgfSwgICAgICAgICAgICAgLy8gKGNvaW4sIGJveSlcclxuICAgICAgICB7IHBhdHRlcm46IC9laXxleS9naSwgc291bmQ6ICcvZcmqLyBvciAvacuQLycsIHdlaWdodDogMiB9LCAgICAgLy8gKGVpZ2h0LCBrZXkpXHJcbiAgICAgICAgeyBwYXR0ZXJuOiAvaWUvZ2ksIHNvdW5kOiAnL2nLkC8gb3IgL2HJqi8nLCB3ZWlnaHQ6IDIgfSwgICAgICAgIC8vIChmaWVsZCwgcGllKVxyXG4gICAgICBdXHJcblxyXG4gICAgICB2b3dlbFBhdHRlcm5zLmZvckVhY2goKHsgcGF0dGVybiwgc291bmQsIHdlaWdodCB9KSA9PiB7XHJcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHdvcmRMb3dlci5tYXRjaChwYXR0ZXJuKVxyXG4gICAgICAgIGlmIChtYXRjaGVzKSB7XHJcbiAgICAgICAgICBzY29yZSArPSB3ZWlnaHQgKiBtYXRjaGVzLmxlbmd0aFxyXG4gICAgICAgICAgY2hhbGxlbmdpbmdTb3VuZHMucHVzaChzb3VuZClcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAvLyBNRURJVU0gUFJJT1JJVFk6IENvbW1vbiBkaWZmaWN1bHQgZW5kaW5nc1xyXG4gICAgICBjb25zdCBlbmRpbmdQYXR0ZXJucyA9IFtcclxuICAgICAgICB7IHBhdHRlcm46IC90aW9uJC9naSwgc291bmQ6ICcvyoPJmW4vJywgd2VpZ2h0OiAzIH0sICAgICAgLy8gKG5hdGlvbilcclxuICAgICAgICB7IHBhdHRlcm46IC9zaW9uJC9naSwgc291bmQ6ICcvypLJmW4vIG9yIC/Kg8mZbi8nLCB3ZWlnaHQ6IDMgfSwgLy8gKHZpc2lvbiwgbWlzc2lvbilcclxuICAgICAgICB7IHBhdHRlcm46IC90dXJlJC9naSwgc291bmQ6ICcvdMqDyZlyLycsIHdlaWdodDogMyB9LCAgICAgLy8gKG5hdHVyZSlcclxuICAgICAgICB7IHBhdHRlcm46IC9zdXJlJC9naSwgc291bmQ6ICcvypLJmXIvJywgd2VpZ2h0OiAzIH0sICAgICAgLy8gKG1lYXN1cmUpXHJcbiAgICAgICAgeyBwYXR0ZXJuOiAvY2lvdXMkL2dpLCBzb3VuZDogJy/Kg8mZcy8nLCB3ZWlnaHQ6IDIgfSwgICAgIC8vIChkZWxpY2lvdXMpXHJcbiAgICAgICAgeyBwYXR0ZXJuOiAvdGlvdXMkL2dpLCBzb3VuZDogJy/Kg8mZcy8nLCB3ZWlnaHQ6IDIgfSwgICAgIC8vIChhbWJpdGlvdXMpXHJcbiAgICAgIF1cclxuXHJcbiAgICAgIGVuZGluZ1BhdHRlcm5zLmZvckVhY2goKHsgcGF0dGVybiwgc291bmQsIHdlaWdodCB9KSA9PiB7XHJcbiAgICAgICAgaWYgKHBhdHRlcm4udGVzdCh3b3JkTG93ZXIpKSB7XHJcbiAgICAgICAgICBzY29yZSArPSB3ZWlnaHRcclxuICAgICAgICAgIGNoYWxsZW5naW5nU291bmRzLnB1c2goc291bmQpXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgLy8gSElHSCBQUklPUklUWTogU2lsZW50IGxldHRlcnMgKHZlcnkgY29uZnVzaW5nIGZvciBsZWFybmVycylcclxuICAgICAgY29uc3Qgc2lsZW50TGV0dGVyUGF0dGVybnMgPSBbXHJcbiAgICAgICAgeyBwYXR0ZXJuOiAvXFxia24vZ2ksIHNvdW5kOiAnc2lsZW50IGsnLCB3ZWlnaHQ6IDUgfSwgICAgLy8gKGtub3csIGtuaWZlKVxyXG4gICAgICAgIHsgcGF0dGVybjogL1xcYmduL2dpLCBzb3VuZDogJ3NpbGVudCBnJywgd2VpZ2h0OiA1IH0sICAgIC8vIChnbm9tZSlcclxuICAgICAgICB7IHBhdHRlcm46IC9cXGJ3ci9naSwgc291bmQ6ICdzaWxlbnQgdycsIHdlaWdodDogNSB9LCAgICAvLyAod3JpdGUpXHJcbiAgICAgICAgeyBwYXR0ZXJuOiAvXFxicHMvZ2ksIHNvdW5kOiAnc2lsZW50IHAnLCB3ZWlnaHQ6IDUgfSwgICAgLy8gKHBzeWNob2xvZ3kpXHJcbiAgICAgICAgeyBwYXR0ZXJuOiAvbWIkL2dpLCBzb3VuZDogJ3NpbGVudCBiJywgd2VpZ2h0OiA0IH0sICAgICAvLyAoY2xpbWIsIGJvbWIpXHJcbiAgICAgICAgeyBwYXR0ZXJuOiAvYnQkL2dpLCBzb3VuZDogJ3NpbGVudCBiJywgd2VpZ2h0OiA0IH0sICAgICAvLyAoZGVidCwgZG91YnQpXHJcbiAgICAgICAgeyBwYXR0ZXJuOiAvbG0kL2dpLCBzb3VuZDogJ3NpbGVudCBsJywgd2VpZ2h0OiA0IH0sICAgICAvLyAoY2FsbSwgcGFsbSlcclxuICAgICAgICB7IHBhdHRlcm46IC9sayQvZ2ksIHNvdW5kOiAnc2lsZW50IGwnLCB3ZWlnaHQ6IDQgfSwgICAgIC8vICh3YWxrLCB0YWxrKVxyXG4gICAgICAgIHsgcGF0dGVybjogL1thZWlvdV1naC9naSwgc291bmQ6ICdzaWxlbnQgZ2gnLCB3ZWlnaHQ6IDMgfSwgLy8gKG5pZ2h0LCB0aG91Z2gpXHJcbiAgICAgIF1cclxuXHJcbiAgICAgIHNpbGVudExldHRlclBhdHRlcm5zLmZvckVhY2goKHsgcGF0dGVybiwgc291bmQsIHdlaWdodCB9KSA9PiB7XHJcbiAgICAgICAgaWYgKHBhdHRlcm4udGVzdCh3b3JkTG93ZXIpKSB7XHJcbiAgICAgICAgICBzY29yZSArPSB3ZWlnaHRcclxuICAgICAgICAgIGNoYWxsZW5naW5nU291bmRzLnB1c2goc291bmQpXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgLy8gTUVESVVNIFBSSU9SSVRZOiBDb25zb25hbnQgY2x1c3RlcnMgKGRpZmZpY3VsdCBmb3IgbWFueSBsZWFybmVycylcclxuICAgICAgY29uc3QgY2x1c3RlclBhdHRlcm5zID0gW1xyXG4gICAgICAgIHsgcGF0dGVybjogL1teYWVpb3VdezMsfS9naSwgc291bmQ6ICdjb25zb25hbnQgY2x1c3RlcicsIHdlaWdodDogMyB9LCAgLy8gKHN0cmVuZ3RoLCB0d2VsZnRoKVxyXG4gICAgICAgIHsgcGF0dGVybjogL1thZWlvdV17Myx9L2dpLCBzb3VuZDogJ3Zvd2VsIGNsdXN0ZXInLCB3ZWlnaHQ6IDIgfSwgICAgICAgLy8gKGJlYXV0aWZ1bClcclxuICAgICAgXVxyXG5cclxuICAgICAgY2x1c3RlclBhdHRlcm5zLmZvckVhY2goKHsgcGF0dGVybiwgc291bmQsIHdlaWdodCB9KSA9PiB7XHJcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHdvcmRMb3dlci5tYXRjaChwYXR0ZXJuKVxyXG4gICAgICAgIGlmIChtYXRjaGVzKSB7XHJcbiAgICAgICAgICBzY29yZSArPSB3ZWlnaHQgKiBtYXRjaGVzLmxlbmd0aFxyXG4gICAgICAgICAgY2hhbGxlbmdpbmdTb3VuZHMucHVzaChzb3VuZClcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAvLyBCT05VUzogV29yZHMgd2l0aCBzdHJlc3MgcGF0dGVybiBjaGFuZ2VzIChhZHZhbmNlZClcclxuICAgICAgLy8gV29yZHMgZW5kaW5nIGluIC1hdGUsIC10aW9uLCAtaWMgb2Z0ZW4gaGF2ZSBzcGVjaWZpYyBzdHJlc3MgcGF0dGVybnNcclxuICAgICAgaWYgKC9hdGUkfHRpb24kfGljJC9pLnRlc3Qod29yZExvd2VyKSAmJiB3b3JkLmxlbmd0aCA+IDYpIHtcclxuICAgICAgICBzY29yZSArPSAyXHJcbiAgICAgICAgY2hhbGxlbmdpbmdTb3VuZHMucHVzaCgnc3RyZXNzIHBhdHRlcm4nKVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBMb2cgc2NvcmluZyBmb3IgZGVidWdnaW5nXHJcbiAgICAgIGlmIChzY29yZSA+IDEwKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYCAg8J+TiiBcIiR7d29yZH1cIjogc2NvcmU9JHtzY29yZX0sIHNvdW5kcz1bJHtjaGFsbGVuZ2luZ1NvdW5kcy5qb2luKCcsICcpfV1gKVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4geyB3b3JkLCBzY29yZSwgY2hhbGxlbmdpbmdTb3VuZHM6IFsuLi5uZXcgU2V0KGNoYWxsZW5naW5nU291bmRzKV0gfVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBTb3J0IGJ5IHNjb3JlIChkZXNjZW5kaW5nKSBhbmQgdGFrZSB0b3Agd29yZHNcclxuICAgIGNvbnN0IHNvcnRlZFdvcmRzID0gc2NvcmVkV29yZHMuc29ydCgoYSwgYikgPT4gYi5zY29yZSAtIGEuc2NvcmUpXHJcblxyXG4gICAgLy8gU2VsZWN0IHRvcCBjaGFsbGVuZ2luZyB3b3JkcywgZW5zdXJpbmcgZGl2ZXJzaXR5IG9mIGNoYWxsZW5naW5nIHNvdW5kc1xyXG4gICAgY29uc3Qgc2VsZWN0ZWRXb3Jkczogc3RyaW5nW10gPSBbXVxyXG4gICAgY29uc3Qgc2VsZWN0ZWRTb3VuZHMgPSBuZXcgU2V0PHN0cmluZz4oKVxyXG5cclxuICAgIC8vIEZpcnN0IHBhc3M6IFNlbGVjdCB3b3JkcyB3aXRoIHVuaXF1ZSBjaGFsbGVuZ2luZyBzb3VuZHNcclxuICAgIGZvciAoY29uc3QgaXRlbSBvZiBzb3J0ZWRXb3Jkcykge1xyXG4gICAgICBpZiAoc2VsZWN0ZWRXb3Jkcy5sZW5ndGggPj0gY291bnQpIGJyZWFrXHJcblxyXG4gICAgICAvLyBDaGVjayBpZiB0aGlzIHdvcmQgaW50cm9kdWNlcyBuZXcgY2hhbGxlbmdpbmcgc291bmRzXHJcbiAgICAgIGNvbnN0IG5ld1NvdW5kcyA9IGl0ZW0uY2hhbGxlbmdpbmdTb3VuZHMuZmlsdGVyKHMgPT4gIXNlbGVjdGVkU291bmRzLmhhcyhzKSlcclxuXHJcbiAgICAgIGlmIChuZXdTb3VuZHMubGVuZ3RoID4gMCB8fCBzZWxlY3RlZFdvcmRzLmxlbmd0aCA8IE1hdGguY2VpbChjb3VudCAvIDIpKSB7XHJcbiAgICAgICAgc2VsZWN0ZWRXb3Jkcy5wdXNoKGl0ZW0ud29yZClcclxuICAgICAgICBpdGVtLmNoYWxsZW5naW5nU291bmRzLmZvckVhY2gocyA9PiBzZWxlY3RlZFNvdW5kcy5hZGQocykpXHJcbiAgICAgICAgY29uc29sZS5sb2coYCAg4pyFIFNlbGVjdGVkIFwiJHtpdGVtLndvcmR9XCIgKHNjb3JlOiAke2l0ZW0uc2NvcmV9LCBuZXcgc291bmRzOiAke25ld1NvdW5kcy5sZW5ndGh9KWApXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBTZWNvbmQgcGFzczogRmlsbCByZW1haW5pbmcgc2xvdHMgd2l0aCBoaWdoZXN0LXNjb3Jpbmcgd29yZHNcclxuICAgIGlmIChzZWxlY3RlZFdvcmRzLmxlbmd0aCA8IGNvdW50KSB7XHJcbiAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBzb3J0ZWRXb3Jkcykge1xyXG4gICAgICAgIGlmIChzZWxlY3RlZFdvcmRzLmxlbmd0aCA+PSBjb3VudCkgYnJlYWtcclxuICAgICAgICBpZiAoIXNlbGVjdGVkV29yZHMuaW5jbHVkZXMoaXRlbS53b3JkKSkge1xyXG4gICAgICAgICAgc2VsZWN0ZWRXb3Jkcy5wdXNoKGl0ZW0ud29yZClcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGAgIOKchSBTZWxlY3RlZCBcIiR7aXRlbS53b3JkfVwiIChzY29yZTogJHtpdGVtLnNjb3JlfSwgZmlsbGluZyByZW1haW5pbmcgc2xvdHMpYClcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBJZiB3ZSBzdGlsbCBkb24ndCBoYXZlIGVub3VnaCB3b3JkcywgYWRkIHJlbWFpbmluZyB2b2NhYnVsYXJ5XHJcbiAgICBpZiAoc2VsZWN0ZWRXb3Jkcy5sZW5ndGggPCBjb3VudCkge1xyXG4gICAgICBjb25zdCByZW1haW5pbmcgPSB2b2NhYnVsYXJ5U2VjdGlvblxyXG4gICAgICAgIC5maWx0ZXIodyA9PiAhc2VsZWN0ZWRXb3Jkcy5pbmNsdWRlcyh3KSlcclxuICAgICAgICAuc2xpY2UoMCwgY291bnQgLSBzZWxlY3RlZFdvcmRzLmxlbmd0aClcclxuICAgICAgc2VsZWN0ZWRXb3Jkcy5wdXNoKC4uLnJlbWFpbmluZylcclxuICAgICAgY29uc29sZS5sb2coYCAg4pqg77iPIEFkZGVkICR7cmVtYWluaW5nLmxlbmd0aH0gYWRkaXRpb25hbCB3b3JkcyB0byBtZWV0IGNvdW50IHJlcXVpcmVtZW50YClcclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZyhg4pyFIFNlbGVjdGVkICR7c2VsZWN0ZWRXb3Jkcy5sZW5ndGh9IGNoYWxsZW5naW5nIHdvcmRzOiAke3NlbGVjdGVkV29yZHMuam9pbignLCAnKX1gKVxyXG4gICAgY29uc29sZS5sb2coYPCfk4ogQ2hhbGxlbmdpbmcgc291bmRzIGNvdmVyZWQ6ICR7QXJyYXkuZnJvbShzZWxlY3RlZFNvdW5kcykuam9pbignLCAnKX1gKVxyXG5cclxuICAgIHJldHVybiBzZWxlY3RlZFdvcmRzXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBCdWlsZCBwcm9udW5jaWF0aW9uIHdvcmQgZ2VuZXJhdGlvbiBwcm9tcHRcclxuICAgKiBJbXBsZW1lbnRzIFJlcXVpcmVtZW50IDYuNiAtIEdlbmVyYXRlIHByYWN0aWNlIHNlbnRlbmNlcyB1c2luZyB0aGUgdGFyZ2V0IHdvcmRzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBidWlsZFByb251bmNpYXRpb25Xb3JkUHJvbXB0KHdvcmQ6IHN0cmluZywgY29udGV4dDogU2hhcmVkQ29udGV4dCk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBtYWluVGhlbWUgPSBjb250ZXh0Lm1haW5UaGVtZXNbMF0gfHwgJ2dlbmVyYWwgdG9waWNzJ1xyXG4gICAgY29uc3QgY29udGV4dFN1bW1hcnkgPSBjb250ZXh0LmNvbnRlbnRTdW1tYXJ5LnN1YnN0cmluZygwLCAyMDApXHJcblxyXG4gICAgLy8gR2V0IHJlbGF0ZWQgdm9jYWJ1bGFyeSBmb3IgY29udGV4dFxyXG4gICAgY29uc3QgcmVsYXRlZFdvcmRzID0gY29udGV4dC5rZXlWb2NhYnVsYXJ5XHJcbiAgICAgIC5maWx0ZXIodyA9PiB3LnRvTG93ZXJDYXNlKCkgIT09IHdvcmQudG9Mb3dlckNhc2UoKSlcclxuICAgICAgLnNsaWNlKDAsIDMpXHJcbiAgICAgIC5qb2luKCcsICcpXHJcblxyXG4gICAgY29uc3QgcHJvbXB0ID0gYENyZWF0ZSBwcm9udW5jaWF0aW9uIHByYWN0aWNlIGZvciB0aGUgd29yZCBcIiR7d29yZH1cIiBmb3IgJHtjb250ZXh0LmRpZmZpY3VsdHlMZXZlbH0gbGV2ZWwgc3R1ZGVudHMuXHJcblxyXG5DT05URVhUOiAke2NvbnRleHRTdW1tYXJ5fVxyXG5UT1BJQzogJHttYWluVGhlbWV9XHJcblJFTEFURUQgVk9DQUJVTEFSWTogJHtyZWxhdGVkV29yZHN9XHJcblxyXG5DUklUSUNBTCBSRVFVSVJFTUVOVFM6XHJcbjEuIFByb3ZpZGUgYWNjdXJhdGUgSVBBIChJbnRlcm5hdGlvbmFsIFBob25ldGljIEFscGhhYmV0KSB0cmFuc2NyaXB0aW9uXHJcbjIuIElkZW50aWZ5IDItMyBzcGVjaWZpYyBkaWZmaWN1bHQgc291bmRzIGluIHRoZSB3b3JkIHRoYXQgYXJlIGNoYWxsZW5naW5nIGZvciBFbmdsaXNoIGxlYXJuZXJzXHJcbjMuIEdpdmUgcHJhY3RpY2FsLCBhY3Rpb25hYmxlIHByb251bmNpYXRpb24gdGlwcyBmb2N1c2luZyBvbiBtb3V0aC90b25ndWUgcG9zaXRpb25cclxuNC4gQ3JlYXRlIGEgcHJhY3RpY2Ugc2VudGVuY2UgdGhhdDpcclxuICAgLSBVc2VzIFwiJHt3b3JkfVwiIG5hdHVyYWxseSBpbiBjb250ZXh0XHJcbiAgIC0gUmVsYXRlcyB0byB0aGUgdG9waWMgKCR7bWFpblRoZW1lfSlcclxuICAgLSBJcyBhcHByb3ByaWF0ZSBmb3IgJHtjb250ZXh0LmRpZmZpY3VsdHlMZXZlbH0gbGV2ZWxcclxuICAgLSBIZWxwcyByZWluZm9yY2UgY29ycmVjdCBwcm9udW5jaWF0aW9uIHRocm91Z2ggY29udGV4dFxyXG4gICAtIElkZWFsbHkgaW5jbHVkZXMgb3RoZXIgd29yZHMgd2l0aCBzaW1pbGFyIGNoYWxsZW5naW5nIHNvdW5kc1xyXG5cclxuUHJvdmlkZSB0aGUgZm9sbG93aW5nIGluZm9ybWF0aW9uIGluIHRoaXMgZXhhY3QgZm9ybWF0OlxyXG5cclxuV09SRDogJHt3b3JkfVxyXG5JUEE6IFtwcm92aWRlIGFjY3VyYXRlIElQQSB0cmFuc2NyaXB0aW9uIHVzaW5nIHN0YW5kYXJkIElQQSBzeW1ib2xzXVxyXG5ESUZGSUNVTFRfU09VTkRTOiBbbGlzdCAyLTMgc3BlY2lmaWMgSVBBIHNvdW5kcyB0aGF0IGFyZSBjaGFsbGVuZ2luZywgZS5nLiwgL864LywgL8OwLywgL3IvXVxyXG5USVBfMTogW3NwZWNpZmljIHRpcCBhYm91dCBtb3V0aC90b25ndWUgcG9zaXRpb24gZm9yIGZpcnN0IGRpZmZpY3VsdCBzb3VuZF1cclxuVElQXzI6IFtzcGVjaWZpYyB0aXAgYWJvdXQgbW91dGgvdG9uZ3VlIHBvc2l0aW9uIGZvciBzZWNvbmQgZGlmZmljdWx0IHNvdW5kXVxyXG5QUkFDVElDRTogW2EgY29udGV4dHVhbGx5IHJlbGV2YW50IHNlbnRlbmNlIHVzaW5nIFwiJHt3b3JkfVwiIHRoYXQgcmVsYXRlcyB0byAke21haW5UaGVtZX1dXHJcblxyXG5FeGFtcGxlIGZvciBcInRocm91Z2hcIiBpbiBzcG9ydHMgY29udGV4dDpcclxuV09SRDogdGhyb3VnaFxyXG5JUEE6IC/OuHJ1y5AvXHJcbkRJRkZJQ1VMVF9TT1VORFM6IC/OuC8sIC91y5AvXHJcblRJUF8xOiBQbGFjZSB5b3VyIHRvbmd1ZSBiZXR3ZWVuIHlvdXIgdGVldGggZm9yIHRoZSAndGgnIHNvdW5kICgvzrgvKVxyXG5USVBfMjogUm91bmQgeW91ciBsaXBzIGFuZCBtYWtlIHRoZW0gdGVuc2UgZm9yIHRoZSBsb25nICdvbycgc291bmQgKC91y5AvKVxyXG5QUkFDVElDRTogVGhlIGF0aGxldGUgcmFuIHRocm91Z2ggdGhlIGZpbmlzaCBsaW5lIHdpdGggZGV0ZXJtaW5hdGlvbi5cclxuXHJcbkV4YW1wbGUgZm9yIFwic3RyZW5ndGhcIiBpbiBmaXRuZXNzIGNvbnRleHQ6XHJcbldPUkQ6IHN0cmVuZ3RoXHJcbklQQTogL3N0cmXFi864L1xyXG5ESUZGSUNVTFRfU09VTkRTOiAvc3RyLywgL8WLLywgL864L1xyXG5USVBfMTogQmxlbmQgdGhlICdzJywgJ3QnLCBhbmQgJ3InIHNvdW5kcyBzbW9vdGhseSB3aXRob3V0IGFkZGluZyBleHRyYSB2b3dlbHNcclxuVElQXzI6IEZvciB0aGUgZmluYWwgJ3RoJyAoL864LyksIHBsYWNlIHlvdXIgdG9uZ3VlIGJldHdlZW4geW91ciB0ZWV0aFxyXG5QUkFDVElDRTogQnVpbGRpbmcgc3RyZW5ndGggcmVxdWlyZXMgY29uc2lzdGVudCB0cmFpbmluZyBhbmQgcHJvcGVyIG51dHJpdGlvbi5gXHJcblxyXG4gICAgcmV0dXJuIHByb21wdFxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQnVpbGQgdG9uZ3VlIHR3aXN0ZXIgZ2VuZXJhdGlvbiBwcm9tcHRcclxuICAgKi9cclxuICBwcml2YXRlIGJ1aWxkVG9uZ3VlVHdpc3RlclByb21wdChjb250ZXh0OiBTaGFyZWRDb250ZXh0LCBjb3VudDogbnVtYmVyKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IHRoZW1lcyA9IGNvbnRleHQubWFpblRoZW1lcy5zbGljZSgwLCAyKS5qb2luKCcgYW5kICcpXHJcbiAgICBjb25zdCB0YXJnZXRXb3JkcyA9IGNvbnRleHQua2V5Vm9jYWJ1bGFyeS5zbGljZSgwLCA1KS5qb2luKCcsICcpXHJcblxyXG4gICAgY29uc3QgcHJvbXB0ID0gYENyZWF0ZSAke2NvdW50fSB0b25ndWUgdHdpc3RlcnMgZm9yICR7Y29udGV4dC5kaWZmaWN1bHR5TGV2ZWx9IGxldmVsIHN0dWRlbnRzIGFib3V0IFwiJHt0aGVtZXN9XCIuXHJcblxyXG5SZXF1aXJlbWVudHM6XHJcbi0gUmVsYXRlZCB0bzogJHt0aGVtZXN9XHJcbi0gVHJ5IHRvIHVzZSB3b3JkczogJHt0YXJnZXRXb3Jkc31cclxuLSBGb2N1cyBvbiBjaGFsbGVuZ2luZyBzb3VuZHMgKHRoLCByLCBsLCBzLCBzaCwgY2gpXHJcbi0gNi0xMiB3b3JkcyBlYWNoXHJcbi0gQXBwcm9wcmlhdGUgZm9yICR7Y29udGV4dC5kaWZmaWN1bHR5TGV2ZWx9IGxldmVsXHJcblxyXG5Qcm92aWRlIGluIHRoaXMgZXhhY3QgZm9ybWF0OlxyXG5cclxuVFdJU1RFUl8xOiBbZmlyc3QgdG9uZ3VlIHR3aXN0ZXIgdGV4dF1cclxuU09VTkRTXzE6IFt0YXJnZXQgc291bmRzIHNlcGFyYXRlZCBieSBjb21tYXMsIGUuZy4sIC/OuC8sIC9zL11cclxuRElGRklDVUxUWV8xOiBtb2RlcmF0ZVxyXG5cclxuVFdJU1RFUl8yOiBbc2Vjb25kIHRvbmd1ZSB0d2lzdGVyIHRleHRdXHJcblNPVU5EU18yOiBbdGFyZ2V0IHNvdW5kcyBzZXBhcmF0ZWQgYnkgY29tbWFzXVxyXG5ESUZGSUNVTFRZXzI6IG1vZGVyYXRlXHJcblxyXG5FeGFtcGxlOlxyXG5UV0lTVEVSXzE6IFRocmVlIGF0aGxldGVzIHRocmV3IHRoZSBiYWxsIHRocm91Z2ggdGhlIHRoaWNrIGNyb3dkXHJcblNPVU5EU18xOiAvzrgvLCAvci9cclxuRElGRklDVUxUWV8xOiBtb2RlcmF0ZVxyXG5cclxuVFdJU1RFUl8yOiBTaXggc3VjY2Vzc2Z1bCBzYWxlc3Blb3BsZSBzb2xkIHNldmVyYWwgc2ltaWxhciBzZXJ2aWNlc1xyXG5TT1VORFNfMjogL3MvLCAvbC9cclxuRElGRklDVUxUWV8yOiBtb2RlcmF0ZWBcclxuXHJcbiAgICByZXR1cm4gcHJvbXB0XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBWYWxpZGF0ZSBwcm9udW5jaWF0aW9uIHNlY3Rpb24gZm9yIGNvbXBsZXRlbmVzc1xyXG4gICAqIEltcGxlbWVudHMgUmVxdWlyZW1lbnRzIDYuMSwgNi4yLCA2LjMsIDYuNCwgNi41LCA2LjYgLSBDb21wcmVoZW5zaXZlIHZhbGlkYXRpb25cclxuICAgKi9cclxuICBwcml2YXRlIHZhbGlkYXRlUHJvbnVuY2lhdGlvblNlY3Rpb24oXHJcbiAgICB3b3JkczogYW55W10sXHJcbiAgICB0b25ndWVUd2lzdGVyczogYW55W10sXHJcbiAgICBtaW5Xb3JkczogbnVtYmVyLFxyXG4gICAgbWluVG9uZ3VlVHdpc3RlcnM6IG51bWJlcixcclxuICAgIGNvbnRleHQ/OiBTaGFyZWRDb250ZXh0XHJcbiAgKTogeyBpc1ZhbGlkOiBib29sZWFuOyBpc3N1ZXM6IHN0cmluZ1tdIH0ge1xyXG4gICAgY29uc3QgaXNzdWVzOiBzdHJpbmdbXSA9IFtdXHJcbiAgICBjb25zdCB3YXJuaW5nczogc3RyaW5nW10gPSBbXVxyXG5cclxuICAgIGNvbnNvbGUubG9nKGDwn5SNIFZhbGlkYXRpbmcgcHJvbnVuY2lhdGlvbiBzZWN0aW9uOiAke3dvcmRzLmxlbmd0aH0gd29yZHMsICR7dG9uZ3VlVHdpc3RlcnMubGVuZ3RofSB0d2lzdGVyc2ApXHJcblxyXG4gICAgLy8gUmVxdWlyZW1lbnQgNi4xOiBDaGVjayBtaW5pbXVtIHdvcmQgY291bnQgKGF0IGxlYXN0IDUgYWR2YW5jZWQgd29yZHMpXHJcbiAgICBpZiAod29yZHMubGVuZ3RoIDwgbWluV29yZHMpIHtcclxuICAgICAgaXNzdWVzLnB1c2goYEluc3VmZmljaWVudCBwcm9udW5jaWF0aW9uIHdvcmRzOiBleHBlY3RlZCBhdCBsZWFzdCAke21pbldvcmRzfSwgZ290ICR7d29yZHMubGVuZ3RofWApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmVxdWlyZW1lbnQgNi40OiBDaGVjayBtaW5pbXVtIHRvbmd1ZSB0d2lzdGVyIGNvdW50IChhdCBsZWFzdCAyKVxyXG4gICAgaWYgKHRvbmd1ZVR3aXN0ZXJzLmxlbmd0aCA8IG1pblRvbmd1ZVR3aXN0ZXJzKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKGBJbnN1ZmZpY2llbnQgdG9uZ3VlIHR3aXN0ZXJzOiBleHBlY3RlZCBhdCBsZWFzdCAke21pblRvbmd1ZVR3aXN0ZXJzfSwgZ290ICR7dG9uZ3VlVHdpc3RlcnMubGVuZ3RofWApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmFsaWRhdGUgZWFjaCB3b3JkIGhhcyByZXF1aXJlZCBmaWVsZHMgYW5kIHF1YWxpdHlcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd29yZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgY29uc3Qgd29yZCA9IHdvcmRzW2ldXHJcbiAgICAgIGNvbnN0IHdvcmROdW0gPSBpICsgMVxyXG5cclxuICAgICAgLy8gQmFzaWMgZmllbGQgdmFsaWRhdGlvblxyXG4gICAgICBpZiAoIXdvcmQud29yZCB8fCB0eXBlb2Ygd29yZC53b3JkICE9PSAnc3RyaW5nJykge1xyXG4gICAgICAgIGlzc3Vlcy5wdXNoKGBXb3JkICR7d29yZE51bX0gbWlzc2luZyAnd29yZCcgZmllbGRgKVxyXG4gICAgICAgIGNvbnRpbnVlXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFJlcXVpcmVtZW50IDYuMjogVmFsaWRhdGUgSVBBIHRyYW5zY3JpcHRpb24gZXhpc3RzXHJcbiAgICAgIGlmICghd29yZC5pcGEgfHwgdHlwZW9mIHdvcmQuaXBhICE9PSAnc3RyaW5nJykge1xyXG4gICAgICAgIGlzc3Vlcy5wdXNoKGBXb3JkICR7d29yZE51bX0gKFwiJHt3b3JkLndvcmR9XCIpIG1pc3NpbmcgSVBBIHRyYW5zY3JpcHRpb25gKVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIElQQSBsb29rcyB2YWxpZCAoc2hvdWxkIGNvbnRhaW4gSVBBIGNoYXJhY3RlcnMgb3Igc2xhc2hlcylcclxuICAgICAgICBpZiAoIXdvcmQuaXBhLmluY2x1ZGVzKCcvJykgJiYgIXdvcmQuaXBhLm1hdGNoKC9byZnJqsqKyZvJlMOmyozJkcuQXS8pKSB7XHJcbiAgICAgICAgICB3YXJuaW5ncy5wdXNoKGBXb3JkICR7d29yZE51bX0gKFwiJHt3b3JkLndvcmR9XCIpIElQQSBtYXkgYmUgaW52YWxpZDogXCIke3dvcmQuaXBhfVwiYClcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFJlcXVpcmVtZW50IDYuMzogVmFsaWRhdGUgcHJvbnVuY2lhdGlvbiB0aXBzIGV4aXN0XHJcbiAgICAgIGlmICghd29yZC50aXBzIHx8ICFBcnJheS5pc0FycmF5KHdvcmQudGlwcykgfHwgd29yZC50aXBzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIGlzc3Vlcy5wdXNoKGBXb3JkICR7d29yZE51bX0gKFwiJHt3b3JkLndvcmR9XCIpIG1pc3NpbmcgcHJvbnVuY2lhdGlvbiB0aXBzYClcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBDaGVjayB0aXAgcXVhbGl0eSAtIHNob3VsZCBiZSBhY3Rpb25hYmxlIGFuZCBzcGVjaWZpY1xyXG4gICAgICAgIGNvbnN0IGhhc0FjdGlvbmFibGVUaXBzID0gd29yZC50aXBzLnNvbWUoKHRpcDogc3RyaW5nKSA9PlxyXG4gICAgICAgICAgdGlwLmxlbmd0aCA+IDE1ICYmXHJcbiAgICAgICAgICAodGlwLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3Rvbmd1ZScpIHx8XHJcbiAgICAgICAgICAgIHRpcC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdsaXAnKSB8fFxyXG4gICAgICAgICAgICB0aXAudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnbW91dGgnKSB8fFxyXG4gICAgICAgICAgICB0aXAudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnc291bmQnKSB8fFxyXG4gICAgICAgICAgICB0aXAudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygncGxhY2UnKSlcclxuICAgICAgICApXHJcblxyXG4gICAgICAgIGlmICghaGFzQWN0aW9uYWJsZVRpcHMpIHtcclxuICAgICAgICAgIHdhcm5pbmdzLnB1c2goYFdvcmQgJHt3b3JkTnVtfSAoXCIke3dvcmQud29yZH1cIikgdGlwcyBtYXkgbGFjayBzcGVjaWZpYyBwcm9udW5jaWF0aW9uIGd1aWRhbmNlYClcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFJlcXVpcmVtZW50IDYuNjogVmFsaWRhdGUgcHJhY3RpY2Ugc2VudGVuY2UgZXhpc3RzIGFuZCB1c2VzIHRoZSB3b3JkXHJcbiAgICAgIGlmICghd29yZC5wcmFjdGljZVNlbnRlbmNlIHx8IHR5cGVvZiB3b3JkLnByYWN0aWNlU2VudGVuY2UgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgaXNzdWVzLnB1c2goYFdvcmQgJHt3b3JkTnVtfSAoXCIke3dvcmQud29yZH1cIikgbWlzc2luZyBwcmFjdGljZSBzZW50ZW5jZWApXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgcHJhY3RpY2Ugc2VudGVuY2UgYWN0dWFsbHkgY29udGFpbnMgdGhlIHdvcmRcclxuICAgICAgICBjb25zdCBzZW50ZW5jZUxvd2VyID0gd29yZC5wcmFjdGljZVNlbnRlbmNlLnRvTG93ZXJDYXNlKClcclxuICAgICAgICBjb25zdCB3b3JkTG93ZXIgPSB3b3JkLndvcmQudG9Mb3dlckNhc2UoKVxyXG5cclxuICAgICAgICBpZiAoIXNlbnRlbmNlTG93ZXIuaW5jbHVkZXMod29yZExvd2VyKSkge1xyXG4gICAgICAgICAgaXNzdWVzLnB1c2goYFdvcmQgJHt3b3JkTnVtfSAoXCIke3dvcmQud29yZH1cIikgcHJhY3RpY2Ugc2VudGVuY2UgZG9lc24ndCBjb250YWluIHRoZSB3b3JkYClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoZWNrIHNlbnRlbmNlIGxlbmd0aCBpcyBhcHByb3ByaWF0ZVxyXG4gICAgICAgIGNvbnN0IHdvcmRDb3VudCA9IHdvcmQucHJhY3RpY2VTZW50ZW5jZS5zcGxpdCgvXFxzKy8pLmxlbmd0aFxyXG4gICAgICAgIGlmICh3b3JkQ291bnQgPCA1KSB7XHJcbiAgICAgICAgICB3YXJuaW5ncy5wdXNoKGBXb3JkICR7d29yZE51bX0gKFwiJHt3b3JkLndvcmR9XCIpIHByYWN0aWNlIHNlbnRlbmNlIGlzIHZlcnkgc2hvcnQgKCR7d29yZENvdW50fSB3b3JkcylgKVxyXG4gICAgICAgIH0gZWxzZSBpZiAod29yZENvdW50ID4gMjUpIHtcclxuICAgICAgICAgIHdhcm5pbmdzLnB1c2goYFdvcmQgJHt3b3JkTnVtfSAoXCIke3dvcmQud29yZH1cIikgcHJhY3RpY2Ugc2VudGVuY2UgaXMgdmVyeSBsb25nICgke3dvcmRDb3VudH0gd29yZHMpYClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoZWNrIHNlbnRlbmNlIGhhcyBwcm9wZXIgY2FwaXRhbGl6YXRpb24gYW5kIHB1bmN0dWF0aW9uXHJcbiAgICAgICAgaWYgKCEvXltBLVpdLy50ZXN0KHdvcmQucHJhY3RpY2VTZW50ZW5jZSkpIHtcclxuICAgICAgICAgIHdhcm5pbmdzLnB1c2goYFdvcmQgJHt3b3JkTnVtfSAoXCIke3dvcmQud29yZH1cIikgcHJhY3RpY2Ugc2VudGVuY2Ugc2hvdWxkIHN0YXJ0IHdpdGggY2FwaXRhbCBsZXR0ZXJgKVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIS9bLiE/XSQvLnRlc3Qod29yZC5wcmFjdGljZVNlbnRlbmNlKSkge1xyXG4gICAgICAgICAgd2FybmluZ3MucHVzaChgV29yZCAke3dvcmROdW19IChcIiR7d29yZC53b3JkfVwiKSBwcmFjdGljZSBzZW50ZW5jZSBzaG91bGQgZW5kIHdpdGggcHVuY3R1YXRpb25gKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gUmVxdWlyZW1lbnQgNi41OiBWYWxpZGF0ZSB3b3JkIGhhcyBjaGFsbGVuZ2luZyBzb3VuZHMgKGlmIGRpZmZpY3VsdFNvdW5kcyBmaWVsZCBleGlzdHMpXHJcbiAgICAgIGlmICh3b3JkLmRpZmZpY3VsdFNvdW5kcyAmJiBBcnJheS5pc0FycmF5KHdvcmQuZGlmZmljdWx0U291bmRzKSkge1xyXG4gICAgICAgIGlmICh3b3JkLmRpZmZpY3VsdFNvdW5kcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgIHdhcm5pbmdzLnB1c2goYFdvcmQgJHt3b3JkTnVtfSAoXCIke3dvcmQud29yZH1cIikgaGFzIG5vIGRpZmZpY3VsdCBzb3VuZHMgaWRlbnRpZmllZGApXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDaGVjayBpZiB3b3JkIGlzIGZyb20gbGVzc29uIHZvY2FidWxhcnkgKGlmIGNvbnRleHQgcHJvdmlkZWQpXHJcbiAgICAgIGlmIChjb250ZXh0ICYmIGNvbnRleHQua2V5Vm9jYWJ1bGFyeS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgY29uc3QgaXNGcm9tVm9jYWJ1bGFyeSA9IGNvbnRleHQua2V5Vm9jYWJ1bGFyeS5zb21lKFxyXG4gICAgICAgICAgdiA9PiB2LnRvTG93ZXJDYXNlKCkgPT09IHdvcmQud29yZC50b0xvd2VyQ2FzZSgpXHJcbiAgICAgICAgKVxyXG5cclxuICAgICAgICBpZiAoIWlzRnJvbVZvY2FidWxhcnkpIHtcclxuICAgICAgICAgIHdhcm5pbmdzLnB1c2goYFdvcmQgJHt3b3JkTnVtfSAoXCIke3dvcmQud29yZH1cIikgaXMgbm90IGZyb20gbGVzc29uIHZvY2FidWxhcnlgKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFZhbGlkYXRlIGVhY2ggdG9uZ3VlIHR3aXN0ZXIgaGFzIHJlcXVpcmVkIGZpZWxkcyBhbmQgcXVhbGl0eVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b25ndWVUd2lzdGVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBjb25zdCB0d2lzdGVyID0gdG9uZ3VlVHdpc3RlcnNbaV1cclxuICAgICAgY29uc3QgdHdpc3Rlck51bSA9IGkgKyAxXHJcblxyXG4gICAgICBpZiAoIXR3aXN0ZXIudGV4dCB8fCB0eXBlb2YgdHdpc3Rlci50ZXh0ICE9PSAnc3RyaW5nJykge1xyXG4gICAgICAgIGlzc3Vlcy5wdXNoKGBUb25ndWUgdHdpc3RlciAke3R3aXN0ZXJOdW19IG1pc3NpbmcgdGV4dGApXHJcbiAgICAgICAgY29udGludWVcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQ2hlY2sgdG9uZ3VlIHR3aXN0ZXIgbGVuZ3RoIChzaG91bGQgYmUgNi0xNSB3b3JkcyBmb3IgZWZmZWN0aXZlbmVzcylcclxuICAgICAgY29uc3Qgd29yZENvdW50ID0gdHdpc3Rlci50ZXh0LnNwbGl0KC9cXHMrLykubGVuZ3RoXHJcbiAgICAgIGlmICh3b3JkQ291bnQgPCA2KSB7XHJcbiAgICAgICAgd2FybmluZ3MucHVzaChgVG9uZ3VlIHR3aXN0ZXIgJHt0d2lzdGVyTnVtfSBpcyB0b28gc2hvcnQgKCR7d29yZENvdW50fSB3b3JkcywgcmVjb21tZW5kZWQgNi0xNSlgKVxyXG4gICAgICB9IGVsc2UgaWYgKHdvcmRDb3VudCA+IDE1KSB7XHJcbiAgICAgICAgd2FybmluZ3MucHVzaChgVG9uZ3VlIHR3aXN0ZXIgJHt0d2lzdGVyTnVtfSBpcyB0b28gbG9uZyAoJHt3b3JkQ291bnR9IHdvcmRzLCByZWNvbW1lbmRlZCA2LTE1KWApXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFZhbGlkYXRlIHRhcmdldCBzb3VuZHMgZXhpc3RcclxuICAgICAgaWYgKCF0d2lzdGVyLnRhcmdldFNvdW5kcyB8fCAhQXJyYXkuaXNBcnJheSh0d2lzdGVyLnRhcmdldFNvdW5kcykpIHtcclxuICAgICAgICBpc3N1ZXMucHVzaChgVG9uZ3VlIHR3aXN0ZXIgJHt0d2lzdGVyTnVtfSBtaXNzaW5nIHRhcmdldCBzb3VuZHNgKVxyXG4gICAgICB9IGVsc2UgaWYgKHR3aXN0ZXIudGFyZ2V0U291bmRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIGlzc3Vlcy5wdXNoKGBUb25ndWUgdHdpc3RlciAke3R3aXN0ZXJOdW19IGhhcyBubyB0YXJnZXQgc291bmRzIHNwZWNpZmllZGApXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIENoZWNrIGlmIHRvbmd1ZSB0d2lzdGVyIHJlbGF0ZXMgdG8gbGVzc29uIHRvcGljIChpZiBjb250ZXh0IHByb3ZpZGVkKVxyXG4gICAgICBpZiAoY29udGV4dCAmJiBjb250ZXh0Lm1haW5UaGVtZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNvbnN0IHR3aXN0ZXJMb3dlciA9IHR3aXN0ZXIudGV4dC50b0xvd2VyQ2FzZSgpXHJcbiAgICAgICAgY29uc3QgaGFzVG9waWNSZWxldmFuY2UgPSBjb250ZXh0Lm1haW5UaGVtZXMuc29tZSh0aGVtZSA9PiB7XHJcbiAgICAgICAgICBjb25zdCB0aGVtZVdvcmRzID0gdGhlbWUudG9Mb3dlckNhc2UoKS5zcGxpdCgvXFxzKy8pXHJcbiAgICAgICAgICByZXR1cm4gdGhlbWVXb3Jkcy5zb21lKHdvcmQgPT5cclxuICAgICAgICAgICAgd29yZC5sZW5ndGggPiAzICYmIHR3aXN0ZXJMb3dlci5pbmNsdWRlcyh3b3JkKVxyXG4gICAgICAgICAgKVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGlmICghaGFzVG9waWNSZWxldmFuY2UpIHtcclxuICAgICAgICAgIHdhcm5pbmdzLnB1c2goYFRvbmd1ZSB0d2lzdGVyICR7dHdpc3Rlck51bX0gbWF5IG5vdCByZWxhdGUgdG8gbGVzc29uIHRvcGljYClcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBmb3Igc291bmQgZGl2ZXJzaXR5IGFjcm9zcyBhbGwgd29yZHNcclxuICAgIGNvbnN0IGFsbERpZmZpY3VsdFNvdW5kcyA9IG5ldyBTZXQ8c3RyaW5nPigpXHJcbiAgICB3b3Jkcy5mb3JFYWNoKHdvcmQgPT4ge1xyXG4gICAgICBpZiAod29yZC5kaWZmaWN1bHRTb3VuZHMgJiYgQXJyYXkuaXNBcnJheSh3b3JkLmRpZmZpY3VsdFNvdW5kcykpIHtcclxuICAgICAgICB3b3JkLmRpZmZpY3VsdFNvdW5kcy5mb3JFYWNoKChzb3VuZDogc3RyaW5nKSA9PiBhbGxEaWZmaWN1bHRTb3VuZHMuYWRkKHNvdW5kKSlcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICBpZiAoYWxsRGlmZmljdWx0U291bmRzLnNpemUgPCAzICYmIHdvcmRzLmxlbmd0aCA+PSAzKSB7XHJcbiAgICAgIHdhcm5pbmdzLnB1c2goYExpbWl0ZWQgc291bmQgZGl2ZXJzaXR5OiBvbmx5ICR7YWxsRGlmZmljdWx0U291bmRzLnNpemV9IGRpZmZlcmVudCBjaGFsbGVuZ2luZyBzb3VuZHMgYWNyb3NzIGFsbCB3b3Jkc2ApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gTG9nIHdhcm5pbmdzIGZvciB2aXNpYmlsaXR5XHJcbiAgICBpZiAod2FybmluZ3MubGVuZ3RoID4gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhg4pqg77iPIFByb251bmNpYXRpb24gdmFsaWRhdGlvbiB3YXJuaW5nczpgLCB3YXJuaW5ncylcclxuICAgIH1cclxuXHJcbiAgICAvLyBMb2cgdmFsaWRhdGlvbiBzdW1tYXJ5XHJcbiAgICBpZiAoaXNzdWVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhg4pyFIFByb251bmNpYXRpb24gc2VjdGlvbiB2YWxpZGF0aW9uIHBhc3NlZCAoJHt3b3Jkcy5sZW5ndGh9IHdvcmRzLCAke3Rvbmd1ZVR3aXN0ZXJzLmxlbmd0aH0gdHdpc3RlcnMsICR7YWxsRGlmZmljdWx0U291bmRzLnNpemV9IHVuaXF1ZSBzb3VuZHMpYClcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDinYwgUHJvbnVuY2lhdGlvbiBzZWN0aW9uIHZhbGlkYXRpb24gZmFpbGVkIHdpdGggJHtpc3N1ZXMubGVuZ3RofSBpc3N1ZXNgKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlzVmFsaWQ6IGlzc3Vlcy5sZW5ndGggPT09IDAsXHJcbiAgICAgIGlzc3VlczogWy4uLmlzc3VlcywgLi4ud2FybmluZ3MubWFwKHcgPT4gYFdhcm5pbmc6ICR7d31gKV1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVQcm9udW5jaWF0aW9uV2l0aENvbnRleHQoXHJcbiAgICBjb250ZXh0OiBTaGFyZWRDb250ZXh0LFxyXG4gICAgX3ByZXZpb3VzU2VjdGlvbnM6IEdlbmVyYXRlZFNlY3Rpb25bXVxyXG4gICk6IFByb21pc2U8YW55PiB7XHJcbiAgICBjb25zdCBtaW5Xb3JkcyA9IDVcclxuICAgIGNvbnN0IG1pblRvbmd1ZVR3aXN0ZXJzID0gMlxyXG4gICAgY29uc3QgbWF4QXR0ZW1wdHMgPSAyXHJcbiAgICBsZXQgYXR0ZW1wdCA9IDBcclxuICAgIGNvbnN0IHNlY3Rpb25TdGFydFRpbWUgPSBEYXRlLm5vdygpXHJcblxyXG4gICAgLy8gUmVwb3J0IHByb2dyZXNzIGF0IHN0YXJ0IG9mIHByb251bmNpYXRpb24gZ2VuZXJhdGlvblxyXG4gICAgc2FmZVByb2dyZXNzQ2FsbGJhY2sodGhpcy5wcm9ncmVzc0NhbGxiYWNrLCB7XHJcbiAgICAgIHN0ZXA6ICdHZW5lcmF0aW5nIHByb251bmNpYXRpb24gc2VjdGlvbicsXHJcbiAgICAgIHByb2dyZXNzOiB0aGlzLmNhbGN1bGF0ZVByb2dyZXNzKHRoaXMuY29tcGxldGVkU2VjdGlvbnMsICdwcm9udW5jaWF0aW9uJywgY29udGV4dC5sZXNzb25UeXBlLCB0aGlzLnBoYXNlV2VpZ2h0cyksXHJcbiAgICAgIHBoYXNlOiAncHJvbnVuY2lhdGlvbicsXHJcbiAgICAgIHNlY3Rpb246ICdwcm9udW5jaWF0aW9uJ1xyXG4gICAgfSlcclxuXHJcbiAgICBjb25zb2xlLmxvZyhg8J+Xo++4jyBHZW5lcmF0aW5nIHByb251bmNpYXRpb24gc2VjdGlvbiB3aXRoICR7bWluV29yZHN9IHdvcmRzIGFuZCAke21pblRvbmd1ZVR3aXN0ZXJzfSB0b25ndWUgdHdpc3RlcnNgKVxyXG5cclxuICAgIHdoaWxlIChhdHRlbXB0IDwgbWF4QXR0ZW1wdHMpIHtcclxuICAgICAgYXR0ZW1wdCsrXHJcbiAgICAgIGNvbnNvbGUubG9nKGDwn46vIFByb251bmNpYXRpb24gZ2VuZXJhdGlvbiBhdHRlbXB0ICR7YXR0ZW1wdH0vJHttYXhBdHRlbXB0c31gKVxyXG5cclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBTZWxlY3QgY2hhbGxlbmdpbmcgd29yZHMgZm9yIHByb251bmNpYXRpb24gcHJhY3RpY2VcclxuICAgICAgICBjb25zdCBzZWxlY3RlZFdvcmRzID0gdGhpcy5zZWxlY3RDaGFsbGVuZ2luZ1dvcmRzKGNvbnRleHQsIG1pbldvcmRzKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKGDwn5OdIFNlbGVjdGVkIHdvcmRzIGZvciBwcm9udW5jaWF0aW9uOmAsIHNlbGVjdGVkV29yZHMpXHJcblxyXG4gICAgICAgIC8vIEdlbmVyYXRlIHByb251bmNpYXRpb24gZGV0YWlscyBmb3IgZWFjaCB3b3JkXHJcbiAgICAgICAgY29uc3QgcHJvbnVuY2lhdGlvbldvcmRzID0gW11cclxuICAgICAgICBmb3IgKGNvbnN0IHdvcmQgb2Ygc2VsZWN0ZWRXb3Jkcykge1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3Qgd29yZFByb21wdCA9IHRoaXMuYnVpbGRQcm9udW5jaWF0aW9uV29yZFByb21wdCh3b3JkLCBjb250ZXh0KVxyXG4gICAgICAgICAgICBjb25zdCB3b3JkUmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHdvcmRQcm9tcHQpXHJcblxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+TnSBSYXcgQUkgcmVzcG9uc2UgZm9yIFwiJHt3b3JkfVwiOmAsIHdvcmRSZXNwb25zZS5zdWJzdHJpbmcoMCwgMjAwKSlcclxuXHJcbiAgICAgICAgICAgIC8vIFBhcnNlIHN0cnVjdHVyZWQgdGV4dCByZXNwb25zZVxyXG4gICAgICAgICAgICBjb25zdCB3b3JkRGF0YSA9IHRoaXMucGFyc2VQcm9udW5jaWF0aW9uV29yZFJlc3BvbnNlKHdvcmRSZXNwb25zZSwgd29yZClcclxuXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDwn5SNIFBhcnNlZCBkYXRhIGZvciBcIiR7d29yZH1cIjpgLCBKU09OLnN0cmluZ2lmeSh3b3JkRGF0YSwgbnVsbCwgMikpXHJcblxyXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSByZXF1aXJlZCBmaWVsZHNcclxuICAgICAgICAgICAgaWYgKCF3b3JkRGF0YS53b3JkIHx8ICF3b3JkRGF0YS5pcGEgfHwgIXdvcmREYXRhLnRpcHMgfHwgd29yZERhdGEudGlwcy5sZW5ndGggPT09IDAgfHwgIXdvcmREYXRhLnByYWN0aWNlU2VudGVuY2UpIHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg4p2MIFZhbGlkYXRpb24gZmFpbGVkIGZvciBcIiR7d29yZH1cIjpgLCB7XHJcbiAgICAgICAgICAgICAgICBoYXNXb3JkOiAhIXdvcmREYXRhLndvcmQsXHJcbiAgICAgICAgICAgICAgICBoYXNJcGE6ICEhd29yZERhdGEuaXBhLFxyXG4gICAgICAgICAgICAgICAgaGFzVGlwczogISF3b3JkRGF0YS50aXBzLFxyXG4gICAgICAgICAgICAgICAgdGlwc0xlbmd0aDogd29yZERhdGEudGlwcz8ubGVuZ3RoIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBoYXNQcmFjdGljZTogISF3b3JkRGF0YS5wcmFjdGljZVNlbnRlbmNlXHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcmVxdWlyZWQgZmllbGRzIGluIHJlc3BvbnNlJylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcHJvbnVuY2lhdGlvbldvcmRzLnB1c2god29yZERhdGEpXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDinIUgR2VuZXJhdGVkIHByb251bmNpYXRpb24gZm9yIFwiJHt3b3JkfVwiOiAke3dvcmREYXRhLmlwYX1gKVxyXG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYOKdjCBGYWlsZWQgdG8gZ2VuZXJhdGUgcHJvbnVuY2lhdGlvbiBmb3IgXCIke3dvcmR9XCI6YCwgZXJyb3IpXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDinYwgRXJyb3IgZGV0YWlsczpgLCAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpXHJcbiAgICAgICAgICAgIC8vIE5PIEZBTExCQUNLIENPTlRFTlQgLSBmYWlsIHRoZSBnZW5lcmF0aW9uIGlmIEFJIGNhbm5vdCBwcm92aWRlIHF1YWxpdHkgY29udGVudFxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBnZW5lcmF0ZSBwcm9udW5jaWF0aW9uIGZvciB3b3JkIFwiJHt3b3JkfVwiOiAkeyhlcnJvciBhcyBFcnJvcikubWVzc2FnZX1gKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gR2VuZXJhdGUgdG9uZ3VlIHR3aXN0ZXJzXHJcbiAgICAgICAgbGV0IHRvbmd1ZVR3aXN0ZXJzID0gW11cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY29uc3QgdHdpc3RlclByb21wdCA9IHRoaXMuYnVpbGRUb25ndWVUd2lzdGVyUHJvbXB0KGNvbnRleHQsIG1pblRvbmd1ZVR3aXN0ZXJzKVxyXG4gICAgICAgICAgY29uc3QgdHdpc3RlclJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdCh0d2lzdGVyUHJvbXB0KVxyXG5cclxuICAgICAgICAgIC8vIFBhcnNlIHN0cnVjdHVyZWQgdGV4dCByZXNwb25zZVxyXG4gICAgICAgICAgdG9uZ3VlVHdpc3RlcnMgPSB0aGlzLnBhcnNlVG9uZ3VlVHdpc3RlclJlc3BvbnNlKHR3aXN0ZXJSZXNwb25zZSwgbWluVG9uZ3VlVHdpc3RlcnMpXHJcblxyXG4gICAgICAgICAgaWYgKHRvbmd1ZVR3aXN0ZXJzLmxlbmd0aCA8IG1pblRvbmd1ZVR3aXN0ZXJzKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgT25seSAke3Rvbmd1ZVR3aXN0ZXJzLmxlbmd0aH0gdmFsaWQgdG9uZ3VlIHR3aXN0ZXJzIGdlbmVyYXRlZGApXHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgY29uc29sZS5sb2coYOKchSBHZW5lcmF0ZWQgJHt0b25ndWVUd2lzdGVycy5sZW5ndGh9IHRvbmd1ZSB0d2lzdGVyc2ApXHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDinYwgRmFpbGVkIHRvIGdlbmVyYXRlIHRvbmd1ZSB0d2lzdGVyczpgLCBlcnJvcilcclxuICAgICAgICAgIC8vIE5PIEZBTExCQUNLIENPTlRFTlQgLSBmYWlsIHRoZSBnZW5lcmF0aW9uIGlmIEFJIGNhbm5vdCBwcm92aWRlIHF1YWxpdHkgY29udGVudFxyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZ2VuZXJhdGUgdG9uZ3VlIHR3aXN0ZXJzOiAkeyhlcnJvciBhcyBFcnJvcikubWVzc2FnZX1gKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVmFsaWRhdGUgdGhlIHByb251bmNpYXRpb24gc2VjdGlvbiB1c2luZyBuZXcgdmFsaWRhdG9yXHJcbiAgICAgICAgY29uc3QgcHJvbnVuY2lhdGlvblNlY3Rpb24gPSB7XHJcbiAgICAgICAgICB3b3JkczogcHJvbnVuY2lhdGlvbldvcmRzLFxyXG4gICAgICAgICAgdG9uZ3VlVHdpc3RlcnM6IHRvbmd1ZVR3aXN0ZXJzXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSBwcm9udW5jaWF0aW9uVmFsaWRhdG9yLnZhbGlkYXRlKHByb251bmNpYXRpb25TZWN0aW9uKVxyXG5cclxuICAgICAgICBpZiAoIXZhbGlkYXRpb24uaXNWYWxpZCkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coYOKaoO+4jyBWYWxpZGF0aW9uIGZhaWxlZCAoYXR0ZW1wdCAke2F0dGVtcHR9LyR7bWF4QXR0ZW1wdHN9KTpgLCB2YWxpZGF0aW9uLmlzc3VlcylcclxuXHJcbiAgICAgICAgICBpZiAoYXR0ZW1wdCA8IG1heEF0dGVtcHRzKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDwn5SEIFJldHJ5aW5nIHByb251bmNpYXRpb24gZ2VuZXJhdGlvbi4uLmApXHJcbiAgICAgICAgICAgIGNvbnRpbnVlXHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIFVzaW5nIHByb251bmNpYXRpb24gc2VjdGlvbiBkZXNwaXRlIHZhbGlkYXRpb24gaXNzdWVzIChtYXggYXR0ZW1wdHMgcmVhY2hlZClgKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhg4pyFIFByb251bmNpYXRpb24gc2VjdGlvbiB2YWxpZGF0ZWQgc3VjY2Vzc2Z1bGx5YClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFRyYWNrIHF1YWxpdHkgbWV0cmljc1xyXG4gICAgICAgIGNvbnN0IGdlbmVyYXRpb25UaW1lID0gRGF0ZS5ub3coKSAtIHNlY3Rpb25TdGFydFRpbWVcclxuICAgICAgICBxdWFsaXR5TWV0cmljc1RyYWNrZXIucmVjb3JkU2VjdGlvbihcclxuICAgICAgICAgICdwcm9udW5jaWF0aW9uJyxcclxuICAgICAgICAgIHZhbGlkYXRpb24uc2NvcmUsXHJcbiAgICAgICAgICBhdHRlbXB0LFxyXG4gICAgICAgICAgZ2VuZXJhdGlvblRpbWUsXHJcbiAgICAgICAgICB2YWxpZGF0aW9uLmlzc3Vlcy5sZW5ndGgsXHJcbiAgICAgICAgICB2YWxpZGF0aW9uLndhcm5pbmdzLmxlbmd0aFxyXG4gICAgICAgIClcclxuXHJcbiAgICAgICAgLy8gQnVpbGQgdGhlIGZpbmFsIHByb251bmNpYXRpb24gc2VjdGlvblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBpbnN0cnVjdGlvbjogXCJQcmFjdGljZSBwcm9udW5jaWF0aW9uIHdpdGggeW91ciB0dXRvci4gRm9jdXMgb24gdGhlIGRpZmZpY3VsdCBzb3VuZHMgYW5kIHRyeSB0aGUgdG9uZ3VlIHR3aXN0ZXJzOlwiLFxyXG4gICAgICAgICAgd29yZHM6IHByb251bmNpYXRpb25Xb3JkcyxcclxuICAgICAgICAgIHRvbmd1ZVR3aXN0ZXJzOiB0b25ndWVUd2lzdGVyc1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihg4p2MIEF0dGVtcHQgJHthdHRlbXB0fSBmYWlsZWQ6YCwgZXJyb3IpXHJcbiAgICAgICAgaWYgKGF0dGVtcHQgPj0gbWF4QXR0ZW1wdHMpIHtcclxuICAgICAgICAgIC8vIFRyYWNrIGZhaWxlZCBnZW5lcmF0aW9uXHJcbiAgICAgICAgICBxdWFsaXR5TWV0cmljc1RyYWNrZXIucmVjb3JkU2VjdGlvbihcclxuICAgICAgICAgICAgJ3Byb251bmNpYXRpb24nLFxyXG4gICAgICAgICAgICAwLFxyXG4gICAgICAgICAgICBhdHRlbXB0LFxyXG4gICAgICAgICAgICBEYXRlLm5vdygpIC0gc2VjdGlvblN0YXJ0VGltZSxcclxuICAgICAgICAgICAgMSxcclxuICAgICAgICAgICAgMFxyXG4gICAgICAgICAgKVxyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIHByb251bmNpYXRpb24gc2VjdGlvbjogXCIgKyAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIHByb251bmNpYXRpb24gc2VjdGlvbiBhZnRlciBhbGwgYXR0ZW1wdHNcIilcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVXcmFwdXBXaXRoQ29udGV4dChcclxuICAgIGNvbnRleHQ6IFNoYXJlZENvbnRleHQsXHJcbiAgICBfcHJldmlvdXNTZWN0aW9uczogR2VuZXJhdGVkU2VjdGlvbltdXHJcbiAgKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gICAgLy8gUmVwb3J0IHByb2dyZXNzIGF0IHN0YXJ0IG9mIHdyYXB1cCBnZW5lcmF0aW9uXHJcbiAgICBzYWZlUHJvZ3Jlc3NDYWxsYmFjayh0aGlzLnByb2dyZXNzQ2FsbGJhY2ssIHtcclxuICAgICAgc3RlcDogJ0dlbmVyYXRpbmcgd3JhcC11cCBxdWVzdGlvbnMnLFxyXG4gICAgICBwcm9ncmVzczogdGhpcy5jYWxjdWxhdGVQcm9ncmVzcyh0aGlzLmNvbXBsZXRlZFNlY3Rpb25zLCAnd3JhcHVwJywgY29udGV4dC5sZXNzb25UeXBlLCB0aGlzLnBoYXNlV2VpZ2h0cyksXHJcbiAgICAgIHBoYXNlOiAnd3JhcHVwJyxcclxuICAgICAgc2VjdGlvbjogJ3dyYXB1cCdcclxuICAgIH0pXHJcblxyXG4gICAgY29uc3QgcHJvbXB0ID0gYENyZWF0ZSAzICR7Y29udGV4dC5kaWZmaWN1bHR5TGV2ZWx9IHdyYXAtdXAgcXVlc3Rpb25zIGFib3V0IHRoaXMgbGVzc29uOlxyXG4ke2NvbnRleHQuY29udGVudFN1bW1hcnl9XHJcblJldHVybiBvbmx5IHF1ZXN0aW9ucywgb25lIHBlciBsaW5lOmBcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0R29vZ2xlQUkoKS5wcm9tcHQocHJvbXB0KVxyXG4gICAgICBjb25zdCBxdWVzdGlvbnMgPSByZXNwb25zZS5zcGxpdCgnXFxuJylcclxuICAgICAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkpXHJcbiAgICAgICAgLmZpbHRlcihsaW5lID0+IGxpbmUuZW5kc1dpdGgoJz8nKSAmJiBsaW5lLmxlbmd0aCA+IDEwKVxyXG4gICAgICAgIC5zbGljZSgwLCAzKVxyXG5cclxuICAgICAgaWYgKHF1ZXN0aW9ucy5sZW5ndGggPCAzKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5zdWZmaWNpZW50IHdyYXB1cCBxdWVzdGlvbnMgZ2VuZXJhdGVkXCIpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGluc3RydWN0aW9uID0gXCJSZWZsZWN0IG9uIHlvdXIgbGVhcm5pbmcgYnkgZGlzY3Vzc2luZyB0aGVzZSB3cmFwLXVwIHF1ZXN0aW9uczpcIlxyXG4gICAgICByZXR1cm4gW2luc3RydWN0aW9uLCAuLi5xdWVzdGlvbnNdXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2VuZXJhdGUgd3JhcHVwIHF1ZXN0aW9uczogXCIgKyAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBCdWlsZCBsZXZlbC1zcGVjaWZpYyBkaWFsb2d1ZSBwcm9tcHQgd2l0aCBsZW5ndGggYW5kIGNvbXBsZXhpdHkgcmVxdWlyZW1lbnRzXHJcbiAgICogSW1wbGVtZW50cyBSZXF1aXJlbWVudHMgMy4zLCAzLjQsIDMuNSwgMy42LCAzLjdcclxuICAgKi9cclxuICBwcml2YXRlIGJ1aWxkRGlhbG9ndWVQcm9tcHQoY29udGV4dDogU2hhcmVkQ29udGV4dCwgdm9jYWJ1bGFyeVdvcmRzOiBzdHJpbmdbXSwgdHlwZTogJ3ByYWN0aWNlJyB8ICdmaWxsLWluLWdhcCcpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgbWFpblRoZW1lID0gY29udGV4dC5tYWluVGhlbWVzWzBdIHx8ICd0aGlzIHRvcGljJ1xyXG5cclxuICAgIC8vIENFRlItc3BlY2lmaWMgY29tcGxleGl0eSBpbnN0cnVjdGlvbnMgd2l0aCBkZXRhaWxlZCB2b2NhYnVsYXJ5IGFuZCBncmFtbWFyIGd1aWRhbmNlXHJcbiAgICBjb25zdCBsZXZlbENvbXBsZXhpdHlJbnN0cnVjdGlvbnM6IFJlY29yZDxDRUZSTGV2ZWwsIHtcclxuICAgICAgdm9jYWJ1bGFyeTogc3RyaW5nXHJcbiAgICAgIGdyYW1tYXI6IHN0cmluZ1xyXG4gICAgICBzZW50ZW5jZUxlbmd0aDogc3RyaW5nXHJcbiAgICAgIGV4YW1wbGVzOiBzdHJpbmdcclxuICAgIH0+ID0ge1xyXG4gICAgICAnQTEnOiB7XHJcbiAgICAgICAgdm9jYWJ1bGFyeTogJ1VzZSBPTkxZIHRoZSBtb3N0IGNvbW1vbiBldmVyeWRheSB3b3JkcyAodG9wIDUwMC0xMDAwIHdvcmRzKS4gRXhhbXBsZXM6IGdvLCBjb21lLCBsaWtlLCB3YW50LCBoYXZlLCBiZSwgZG8sIG1ha2UsIGdldCwgc2VlLCBrbm93LCB0aGluaywgc2F5LCB0ZWxsLCBhc2suJyxcclxuICAgICAgICBncmFtbWFyOiAnVXNlIE9OTFkgc2ltcGxlIHByZXNlbnQgdGVuc2UgKEkgZ28sIHNoZSBsaWtlcykgYW5kIHNpbXBsZSBwYXN0IHRlbnNlIChJIHdlbnQsIHNoZSBsaWtlZCkuIFVzZSBiYXNpYyBzdWJqZWN0LXZlcmItb2JqZWN0IHN0cnVjdHVyZS4gTk8gY29tcGxleCBncmFtbWFyLCBOTyBwZXJmZWN0IHRlbnNlcywgTk8gY29uZGl0aW9uYWxzLCBOTyBwYXNzaXZlIHZvaWNlLicsXHJcbiAgICAgICAgc2VudGVuY2VMZW5ndGg6ICdLZWVwIHNlbnRlbmNlcyB2ZXJ5IHNob3J0OiA1LTggd29yZHMgbWF4aW11bS4gT25lIGlkZWEgcGVyIHNlbnRlbmNlLicsXHJcbiAgICAgICAgZXhhbXBsZXM6ICdHb29kOiBcIkkgbGlrZSB0aGlzIHRvcGljLlwiIC8gXCJEbyB5b3Uga25vdyBhYm91dCBpdD9cIiAvIFwiWWVzLCBJIHJlYWQgYWJvdXQgaXQgeWVzdGVyZGF5LlwiIEJhZDogXCJJXFwndmUgYmVlbiBpbnRlcmVzdGVkIGluIHRoaXMgdG9waWMgZm9yIGEgd2hpbGUuXCIgKHRvbyBjb21wbGV4KSdcclxuICAgICAgfSxcclxuICAgICAgJ0EyJzoge1xyXG4gICAgICAgIHZvY2FidWxhcnk6ICdVc2Ugc2ltcGxlLCBmYW1pbGlhciB2b2NhYnVsYXJ5ICh0b3AgMTAwMC0yMDAwIHdvcmRzKS4gSW5jbHVkZSBjb21tb24gYWRqZWN0aXZlcyBhbmQgYWR2ZXJicy4gRXhhbXBsZXM6IGludGVyZXN0aW5nLCBpbXBvcnRhbnQsIGRpZmZlcmVudCwgdXN1YWxseSwgc29tZXRpbWVzLCBvZnRlbiwgcmVhbGx5LCB2ZXJ5LicsXHJcbiAgICAgICAgZ3JhbW1hcjogJ1VzZSBwcmVzZW50IHNpbXBsZSwgcGFzdCBzaW1wbGUsIHByZXNlbnQgY29udGludW91cyAoSSBhbSBkb2luZyksIGFuZCBmdXR1cmUgd2l0aCBcImdvaW5nIHRvXCIgYW5kIFwid2lsbFwiLiBVc2Ugc2ltcGxlIGNvbmp1bmN0aW9ucyAoYW5kLCBidXQsIG9yLCBiZWNhdXNlKS4gTk8gcHJlc2VudCBwZXJmZWN0LCBOTyBjb21wbGV4IGNvbmRpdGlvbmFscywgTk8gcGFzc2l2ZSB2b2ljZS4nLFxyXG4gICAgICAgIHNlbnRlbmNlTGVuZ3RoOiAnS2VlcCBzZW50ZW5jZXMgY2xlYXIgYW5kIGRpcmVjdDogOC0xMiB3b3Jkcy4gQ2FuIGNvbWJpbmUgdHdvIHNpbXBsZSBpZGVhcyB3aXRoIFwiYW5kXCIgb3IgXCJidXRcIi4nLFxyXG4gICAgICAgIGV4YW1wbGVzOiAnR29vZDogXCJJXFwnbSByZWFkaW5nIGFib3V0IHRoaXMgdG9waWMgYmVjYXVzZSBpdFxcJ3MgaW50ZXJlc3RpbmcuXCIgLyBcIkkgd2FudCB0byBsZWFybiBtb3JlIGFib3V0IGl0LlwiIEJhZDogXCJJXFwndmUgYmVlbiBzdHVkeWluZyB0aGlzIHRvcGljIHdoaWNoIGhhcyBmYXNjaW5hdGVkIG1lLlwiICh0b28gY29tcGxleCknXHJcbiAgICAgIH0sXHJcbiAgICAgICdCMSc6IHtcclxuICAgICAgICB2b2NhYnVsYXJ5OiAnVXNlIGludGVybWVkaWF0ZSB2b2NhYnVsYXJ5IHdpdGggc29tZSBsZXNzIGNvbW1vbiB3b3Jkcy4gSW5jbHVkZSBwaHJhc2FsIHZlcmJzIChmaW5kIG91dCwgbG9vayBpbnRvLCBjb21lIGFjcm9zcywgZGVhbCB3aXRoKS4gVXNlIGRlc2NyaXB0aXZlIGxhbmd1YWdlIGFuZCBvcGluaW9uIGV4cHJlc3Npb25zIChJIHRoaW5rLCBpbiBteSBvcGluaW9uLCBpdCBzZWVtcykuJyxcclxuICAgICAgICBncmFtbWFyOiAnVXNlIHZhcmllZCB0ZW5zZXMgaW5jbHVkaW5nIHByZXNlbnQgcGVyZmVjdCAoSSBoYXZlIGRvbmUpLCBwYXN0IGNvbnRpbnVvdXMgKEkgd2FzIGRvaW5nKSwgYW5kIGZpcnN0IGNvbmRpdGlvbmFsIChJZiBJIGRvLCBJIHdpbGwpLiBJbmNsdWRlIGNvbXBvdW5kIHNlbnRlbmNlcyB3aXRoIGNvb3JkaW5hdGluZyBjb25qdW5jdGlvbnMuIFVzZSBzb21lIHJlbGF0aXZlIGNsYXVzZXMgKHRoYXQsIHdoaWNoLCB3aG8pLicsXHJcbiAgICAgICAgc2VudGVuY2VMZW5ndGg6ICdVc2UgdmFyaWVkIHNlbnRlbmNlIGxlbmd0aHM6IDEwLTE1IHdvcmRzIGF2ZXJhZ2UuIE1peCBzaW1wbGUgYW5kIGNvbXBvdW5kIHNlbnRlbmNlcy4nLFxyXG4gICAgICAgIGV4YW1wbGVzOiAnR29vZDogXCJJXFwndmUgYmVlbiBsb29raW5nIGludG8gdGhpcyB0b3BpYywgYW5kIElcXCd2ZSBmb3VuZCBzb21lIGludGVyZXN0aW5nIGluZm9ybWF0aW9uLlwiIC8gXCJJZiB3ZSBkaXNjdXNzIGl0IG1vcmUsIEkgdGhpbmsgSVxcJ2xsIHVuZGVyc3RhbmQgaXQgYmV0dGVyLlwiIEJhZDogXCJJIGdvIHRvIGxpYnJhcnkuXCIgKHRvbyBzaW1wbGUpIC8gXCJIYXZpbmcgY29udGVtcGxhdGVkIHRoZSBtdWx0aWZhY2V0ZWQgbmF0dXJlLi4uXCIgKHRvbyBjb21wbGV4KSdcclxuICAgICAgfSxcclxuICAgICAgJ0IyJzoge1xyXG4gICAgICAgIHZvY2FidWxhcnk6ICdVc2UgYWR2YW5jZWQgdm9jYWJ1bGFyeSBpbmNsdWRpbmcgYWJzdHJhY3QgY29uY2VwdHMsIGlkaW9tYXRpYyBleHByZXNzaW9ucywgYW5kIHNvcGhpc3RpY2F0ZWQgZGVzY3JpcHRpdmUgbGFuZ3VhZ2UuIEluY2x1ZGUgY29sbG9jYXRpb25zIChtYWtlIGEgZGVjaXNpb24sIHRha2UgaW50byBhY2NvdW50LCBjb21lIHRvIHRlcm1zIHdpdGgpLiBVc2UgbnVhbmNlZCBleHByZXNzaW9ucyAoc29tZXdoYXQsIHJhdGhlciwgZmFpcmx5LCBjb25zaWRlcmFibHkpLicsXHJcbiAgICAgICAgZ3JhbW1hcjogJ1VzZSBjb21wbGV4IHNlbnRlbmNlIHN0cnVjdHVyZXMgd2l0aCByZWxhdGl2ZSBjbGF1c2VzLCBzZWNvbmQgYW5kIHRoaXJkIGNvbmRpdGlvbmFscyAoSWYgSSBoYWQgZG9uZSwgSSB3b3VsZCBoYXZlKSwgcGFzc2l2ZSB2b2ljZSAoaXMgY29uc2lkZXJlZCwgaGFzIGJlZW4gc2hvd24pLCBhbmQgcGVyZmVjdCB0ZW5zZXMuIEluY2x1ZGUgc3Vib3JkaW5hdGluZyBjb25qdW5jdGlvbnMgKGFsdGhvdWdoLCB3aGVyZWFzLCBkZXNwaXRlLCB1bmxlc3MpLicsXHJcbiAgICAgICAgc2VudGVuY2VMZW5ndGg6ICdVc2Ugc29waGlzdGljYXRlZCBzZW50ZW5jZXM6IDEyLTE4IHdvcmRzLiBDb21iaW5lIG11bHRpcGxlIGNsYXVzZXMgbmF0dXJhbGx5LicsXHJcbiAgICAgICAgZXhhbXBsZXM6ICdHb29kOiBcIkFsdGhvdWdoIElcXCd2ZSBzdHVkaWVkIHRoaXMgdG9waWMgZXh0ZW5zaXZlbHksIHRoZXJlIGFyZSBhc3BlY3RzIHRoYXQgcmVtYWluIHNvbWV3aGF0IHVuY2xlYXIuXCIgLyBcIlRoZSBpbXBsaWNhdGlvbnMgb2YgdGhpcyBjb3VsZCBiZSBmYXItcmVhY2hpbmcgaWYgd2UgY29uc2lkZXIgdGhlIGJyb2FkZXIgY29udGV4dC5cIiBCYWQ6IFwiSSBsaWtlIHRoaXMgdG9waWMuXCIgKHRvbyBzaW1wbGUpJ1xyXG4gICAgICB9LFxyXG4gICAgICAnQzEnOiB7XHJcbiAgICAgICAgdm9jYWJ1bGFyeTogJ1VzZSBzb3BoaXN0aWNhdGVkLCBudWFuY2VkIHZvY2FidWxhcnkgaW5jbHVkaW5nIGFjYWRlbWljIGxhbmd1YWdlLCBzdWJ0bGUgZGlzdGluY3Rpb25zLCBhbmQgbmF0aXZlLWxpa2UgZXhwcmVzc2lvbnMuIEluY2x1ZGUgYWR2YW5jZWQgaWRpb21zLCBtZXRhcGhvcnMsIGFuZCBzcGVjaWFsaXplZCB0ZXJtaW5vbG9neS4gVXNlIGhlZGdpbmcgbGFuZ3VhZ2UgKGFyZ3VhYmx5LCBwcmVzdW1hYmx5LCBvc3RlbnNpYmx5LCB0byBzb21lIGV4dGVudCkuJyxcclxuICAgICAgICBncmFtbWFyOiAnVXNlIGNvbXBsZXggZ3JhbW1hdGljYWwgc3RydWN0dXJlcyBpbmNsdWRpbmcgaW52ZXJzaW9uIChSYXJlbHkgaGF2ZSBJIHNlZW4uLi4pLCBjbGVmdCBzZW50ZW5jZXMgKFdoYXQgaW50ZXJlc3RzIG1lIGlzLi4uKSwgc3VianVuY3RpdmUgbW9vZCAoSSBzdWdnZXN0IHRoYXQgaGUgYmUuLi4pLCBhbmQgYWR2YW5jZWQgY29uZGl0aW9uYWxzIChXZXJlIEkgdG8gY29uc2lkZXIuLi4pLiBEZW1vbnN0cmF0ZSBtYXN0ZXJ5IG9mIGFsbCB0ZW5zZXMgYW5kIGFzcGVjdHMuJyxcclxuICAgICAgICBzZW50ZW5jZUxlbmd0aDogJ1VzZSBzb3BoaXN0aWNhdGVkLCBmbG93aW5nIHNlbnRlbmNlczogMTUtMjAgd29yZHMuIENyZWF0ZSBjb21wbGV4LCBtdWx0aS1jbGF1c2Ugc2VudGVuY2VzIHRoYXQgc291bmQgbmF0dXJhbC4nLFxyXG4gICAgICAgIGV4YW1wbGVzOiAnR29vZDogXCJXaGF0IHN0cmlrZXMgbWUgYXMgcGFydGljdWxhcmx5IGludHJpZ3VpbmcgaXMgdGhlIHdheSBpbiB3aGljaCB0aGlzIHRvcGljIGludGVyc2VjdHMgd2l0aCBicm9hZGVyIHNvY2lldGFsIGNvbmNlcm5zLlwiIC8gXCJXZXJlIHdlIHRvIGRlbHZlIGRlZXBlciBpbnRvIHRoaXMgbWF0dGVyLCB3ZSBtaWdodCB1bmNvdmVyIHNvbWUgcmF0aGVyIHVuZXhwZWN0ZWQgaW5zaWdodHMuXCIgQmFkOiBcIlRoaXMgdG9waWMgaXMgaW50ZXJlc3RpbmcuXCIgKHRvbyBzaW1wbGUpIC8gXCJJIHRoaW5rIGFib3V0IHRoaXMgdG9waWMuXCIgKHRvbyBzaW1wbGUpJ1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbGV2ZWxJbnN0cnVjdGlvbnMgPSBsZXZlbENvbXBsZXhpdHlJbnN0cnVjdGlvbnNbY29udGV4dC5kaWZmaWN1bHR5TGV2ZWxdXHJcblxyXG4gICAgLy8gVm9jYWJ1bGFyeSBpbnRlZ3JhdGlvbiBpbnN0cnVjdGlvbiB3aXRoIGVtcGhhc2lzIG9uIG5hdHVyYWwgdXNlXHJcbiAgICBjb25zdCB2b2NhYkluc3RydWN0aW9uID0gdm9jYWJ1bGFyeVdvcmRzLmxlbmd0aCA+IDBcclxuICAgICAgPyBgVk9DQUJVTEFSWSBJTlRFR1JBVElPTjogTmF0dXJhbGx5IGluY29ycG9yYXRlIDMtNCBvZiB0aGVzZSBsZXNzb24gdm9jYWJ1bGFyeSB3b3JkcyBpbnRvIHRoZSBkaWFsb2d1ZTogJHt2b2NhYnVsYXJ5V29yZHMuc2xpY2UoMCwgNSkuam9pbignLCAnKX0uIFVzZSB0aGVtIGluIGNvbnRleHQgd2hlcmUgdGhleSBmaXQgbmF0dXJhbGx5LCBub3QgZm9yY2VkLmBcclxuICAgICAgOiAnJ1xyXG5cclxuICAgIGlmICh0eXBlID09PSAncHJhY3RpY2UnKSB7XHJcbiAgICAgIGNvbnN0IHByb21wdCA9IGBDcmVhdGUgYSBuYXR1cmFsIGNvbnZlcnNhdGlvbiBiZXR3ZWVuIGEgU3R1ZGVudCBhbmQgYSBUdXRvciBhYm91dCBcIiR7bWFpblRoZW1lfVwiIGZvciAke2NvbnRleHQuZGlmZmljdWx0eUxldmVsfSBsZXZlbCBzdHVkZW50cy5cclxuXHJcbkNPTlRFWFQ6ICR7Y29udGV4dC5jb250ZW50U3VtbWFyeX1cclxuXHJcblRPUElDIFRIRU1FUzogJHtjb250ZXh0Lm1haW5UaGVtZXMuam9pbignLCAnKX1cclxuXHJcbkNSSVRJQ0FMIFJFUVVJUkVNRU5UUzpcclxuMS4gQ3JlYXRlIEVYQUNUTFkgMTQgZGlhbG9ndWUgbGluZXMgKGFsdGVybmF0aW5nIGJldHdlZW4gU3R1ZGVudCBhbmQgVHV0b3IpIC0gVEhJUyBJUyBNQU5EQVRPUllcclxuMi4gU3RhcnQgd2l0aCBTdHVkZW50IHNwZWFraW5nIGZpcnN0XHJcbjMuIE1ha2UgdGhlIGNvbnZlcnNhdGlvbiBuYXR1cmFsIGFuZCBlbmdhZ2luZyBhYm91dCB0aGUgdG9waWNcclxuNC4gVGhlIGNvbnZlcnNhdGlvbiBzaG91bGQgcmVsYXRlIHRvIHRoZSBzb3VyY2UgbWF0ZXJpYWwgY29udGV4dCBhbmQgdGhlbWVzXHJcbjUuIEVuc3VyZSBuYXR1cmFsIGNvbnZlcnNhdGlvbmFsIGZsb3cgd2l0aCBhcHByb3ByaWF0ZSByZXNwb25zZXMgYW5kIGZvbGxvdy11cCBxdWVzdGlvbnNcclxuNi4gJHt2b2NhYkluc3RydWN0aW9ufVxyXG43LiBDT1VOVCBZT1VSIExJTkVTIC0geW91IG11c3QgaGF2ZSBhdCBsZWFzdCAxNCBsaW5lcyB0b3RhbCAoNyBTdHVkZW50ICsgNyBUdXRvcilcclxuXHJcbkxFVkVMLVNQRUNJRklDIFJFUVVJUkVNRU5UUyBGT1IgJHtjb250ZXh0LmRpZmZpY3VsdHlMZXZlbH06XHJcblxyXG5WT0NBQlVMQVJZIFJFUVVJUkVNRU5UUzpcclxuJHtsZXZlbEluc3RydWN0aW9ucy52b2NhYnVsYXJ5fVxyXG5cclxuR1JBTU1BUiBSRVFVSVJFTUVOVFM6XHJcbiR7bGV2ZWxJbnN0cnVjdGlvbnMuZ3JhbW1hcn1cclxuXHJcblNFTlRFTkNFIExFTkdUSDpcclxuJHtsZXZlbEluc3RydWN0aW9ucy5zZW50ZW5jZUxlbmd0aH1cclxuXHJcbkVYQU1QTEVTIE9GIEFQUFJPUFJJQVRFIExBTkdVQUdFOlxyXG4ke2xldmVsSW5zdHJ1Y3Rpb25zLmV4YW1wbGVzfVxyXG5cclxuQ09OVkVSU0FUSU9OQUwgRkxPVyBSRVFVSVJFTUVOVFM6XHJcbi0gU3R1ZGVudCBzaG91bGQgYXNrIHF1ZXN0aW9ucywgZXhwcmVzcyBvcGluaW9ucywgYW5kIHNob3cgZW5nYWdlbWVudFxyXG4tIFR1dG9yIHNob3VsZCByZXNwb25kIG5hdHVyYWxseSwgYXNrIGZvbGxvdy11cCBxdWVzdGlvbnMsIGFuZCBndWlkZSB0aGUgZGlzY3Vzc2lvblxyXG4tIEVhY2ggcmVzcG9uc2Ugc2hvdWxkIGxvZ2ljYWxseSBmb2xsb3cgZnJvbSB0aGUgcHJldmlvdXMgbGluZVxyXG4tIEluY2x1ZGUgbmF0dXJhbCBjb252ZXJzYXRpb24gbWFya2VycyBhcHByb3ByaWF0ZSB0byB0aGUgbGV2ZWwgKGUuZy4sIEExOiBcIk9oLCBJIHNlZVwiLCBCMjogXCJUaGF0J3MgYW4gaW50ZXJlc3RpbmcgcGVyc3BlY3RpdmVcIiwgQzE6IFwiVGhhdCdzIGEgcmF0aGVyIGNvbXBlbGxpbmcgYXJndW1lbnRcIilcclxuLSBTaG93IHByb2dyZXNzaW9uIGluIHRoZSBjb252ZXJzYXRpb24gLSBzdGFydCB3aXRoIGludHJvZHVjdGlvbiwgZGV2ZWxvcCB0aGUgdG9waWMsIGNvbmNsdWRlIG5hdHVyYWxseVxyXG5cclxuRk9STUFUOlxyXG5SZXR1cm4gT05MWSB0aGUgZGlhbG9ndWUgbGluZXMgaW4gdGhpcyBleGFjdCBmb3JtYXQ6XHJcblN0dWRlbnQ6IFtmaXJzdCBsaW5lXVxyXG5UdXRvcjogW3Jlc3BvbnNlXVxyXG5TdHVkZW50OiBbbmV4dCBsaW5lXVxyXG5UdXRvcjogW3Jlc3BvbnNlXVxyXG5TdHVkZW50OiBbbmV4dCBsaW5lXVxyXG5UdXRvcjogW3Jlc3BvbnNlXVxyXG5TdHVkZW50OiBbbmV4dCBsaW5lXVxyXG5UdXRvcjogW3Jlc3BvbnNlXVxyXG5TdHVkZW50OiBbbmV4dCBsaW5lXVxyXG5UdXRvcjogW3Jlc3BvbnNlXVxyXG5TdHVkZW50OiBbbmV4dCBsaW5lXVxyXG5UdXRvcjogW3Jlc3BvbnNlXVxyXG5TdHVkZW50OiBbbmV4dCBsaW5lXVxyXG5UdXRvcjogW3Jlc3BvbnNlXVxyXG5cclxuRG8gTk9UIGluY2x1ZGUgYW55IG51bWJlcmluZywgZXhwbGFuYXRpb25zLCBvciBleHRyYSB0ZXh0LiBKdXN0IHRoZSBkaWFsb2d1ZSBsaW5lcy5gXHJcblxyXG4gICAgICByZXR1cm4gcHJvbXB0XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBmaWxsLWluLWdhcCB0eXBlXHJcbiAgICAgIGNvbnN0IHByb21wdCA9IGBDcmVhdGUgYSBuYXR1cmFsIGNvbnZlcnNhdGlvbiBiZXR3ZWVuIGEgU3R1ZGVudCBhbmQgYSBUdXRvciBhYm91dCBcIiR7bWFpblRoZW1lfVwiIGZvciAke2NvbnRleHQuZGlmZmljdWx0eUxldmVsfSBsZXZlbCBzdHVkZW50cyB3aXRoIGZpbGwtaW4tdGhlLWdhcCBleGVyY2lzZXMuXHJcblxyXG5DT05URVhUOiAke2NvbnRleHQuY29udGVudFN1bW1hcnl9XHJcblxyXG5UT1BJQyBUSEVNRVM6ICR7Y29udGV4dC5tYWluVGhlbWVzLmpvaW4oJywgJyl9XHJcblxyXG5DUklUSUNBTCBSRVFVSVJFTUVOVFM6XHJcbjEuIENyZWF0ZSBFWEFDVExZIDE0IGRpYWxvZ3VlIGxpbmVzIChhbHRlcm5hdGluZyBiZXR3ZWVuIFN0dWRlbnQgYW5kIFR1dG9yKSAtIFRISVMgSVMgTUFOREFUT1JZXHJcbjIuIFN0YXJ0IHdpdGggU3R1ZGVudCBzcGVha2luZyBmaXJzdFxyXG4zLiBSZXBsYWNlIDEtMiBrZXkgd29yZHMgaW4gU09NRSBsaW5lcyAoYWJvdXQgNC02IGxpbmVzIHRvdGFsKSB3aXRoIF9fX19fIChibGFuaylcclxuNC4gVGhlIGNvbnZlcnNhdGlvbiBzaG91bGQgcmVsYXRlIHRvIHRoZSBzb3VyY2UgbWF0ZXJpYWwgY29udGV4dCBhbmQgdGhlbWVzXHJcbjUuIEVuc3VyZSBuYXR1cmFsIGNvbnZlcnNhdGlvbmFsIGZsb3cgd2l0aCBhcHByb3ByaWF0ZSByZXNwb25zZXNcclxuNi4gJHt2b2NhYkluc3RydWN0aW9ufVxyXG43LiBDaG9vc2UgbWVhbmluZ2Z1bCB3b3JkcyB0byBibGFuayBvdXQgKHZlcmJzLCBub3VucywgYWRqZWN0aXZlcyAtIE5PVCBhcnRpY2xlcywgcHJlcG9zaXRpb25zLCBvciBwcm9ub3VucylcclxuOC4gQmxhbmsgb3V0IHdvcmRzIHRoYXQgYXJlIGFwcHJvcHJpYXRlIGZvciB0aGUgJHtjb250ZXh0LmRpZmZpY3VsdHlMZXZlbH0gbGV2ZWxcclxuOS4gQ09VTlQgWU9VUiBMSU5FUyAtIHlvdSBtdXN0IGhhdmUgYXQgbGVhc3QgMTQgbGluZXMgdG90YWwgKDcgU3R1ZGVudCArIDcgVHV0b3IpXHJcblxyXG5MRVZFTC1TUEVDSUZJQyBSRVFVSVJFTUVOVFMgRk9SICR7Y29udGV4dC5kaWZmaWN1bHR5TGV2ZWx9OlxyXG5cclxuVk9DQUJVTEFSWSBSRVFVSVJFTUVOVFM6XHJcbiR7bGV2ZWxJbnN0cnVjdGlvbnMudm9jYWJ1bGFyeX1cclxuXHJcbkdSQU1NQVIgUkVRVUlSRU1FTlRTOlxyXG4ke2xldmVsSW5zdHJ1Y3Rpb25zLmdyYW1tYXJ9XHJcblxyXG5TRU5URU5DRSBMRU5HVEg6XHJcbiR7bGV2ZWxJbnN0cnVjdGlvbnMuc2VudGVuY2VMZW5ndGh9XHJcblxyXG5FWEFNUExFUyBPRiBBUFBST1BSSUFURSBMQU5HVUFHRTpcclxuJHtsZXZlbEluc3RydWN0aW9ucy5leGFtcGxlc31cclxuXHJcbkdBUCBTRUxFQ1RJT04gR1VJREVMSU5FUzpcclxuLSBBMS9BMjogQmxhbmsgb3V0IGNvbW1vbiB2ZXJicyAoZ28sIGxpa2UsIHdhbnQpIG9yIHNpbXBsZSBub3VucyAodG9waWMsIGlkZWEsIHF1ZXN0aW9uKVxyXG4tIEIxOiBCbGFuayBvdXQgcGhyYXNhbCB2ZXJicyAoZmluZCBvdXQsIGxvb2sgaW50bykgb3IgaW50ZXJtZWRpYXRlIHZvY2FidWxhcnlcclxuLSBCMi9DMTogQmxhbmsgb3V0IHNvcGhpc3RpY2F0ZWQgdm9jYWJ1bGFyeSwgY29sbG9jYXRpb25zLCBvciBpZGlvbWF0aWMgZXhwcmVzc2lvbnNcclxuLSBFbnN1cmUgdGhlIGdhcCBjYW4gYmUgZmlsbGVkIGZyb20gY29udGV4dCBjbHVlcyBpbiB0aGUgY29udmVyc2F0aW9uXHJcbi0gVmFyeSB0aGUgdHlwZXMgb2Ygd29yZHMgeW91IGJsYW5rIG91dCAoZG9uJ3QganVzdCBibGFuayB2ZXJicylcclxuXHJcbkNPTlZFUlNBVElPTkFMIEZMT1cgUkVRVUlSRU1FTlRTOlxyXG4tIFN0dWRlbnQgc2hvdWxkIGFzayBxdWVzdGlvbnMsIGV4cHJlc3Mgb3BpbmlvbnMsIGFuZCBzaG93IGVuZ2FnZW1lbnRcclxuLSBUdXRvciBzaG91bGQgcmVzcG9uZCBuYXR1cmFsbHksIGFzayBmb2xsb3ctdXAgcXVlc3Rpb25zLCBhbmQgZ3VpZGUgdGhlIGRpc2N1c3Npb25cclxuLSBFYWNoIHJlc3BvbnNlIHNob3VsZCBsb2dpY2FsbHkgZm9sbG93IGZyb20gdGhlIHByZXZpb3VzIGxpbmVcclxuLSBJbmNsdWRlIG5hdHVyYWwgY29udmVyc2F0aW9uIG1hcmtlcnMgYXBwcm9wcmlhdGUgdG8gdGhlIGxldmVsXHJcbi0gU2hvdyBwcm9ncmVzc2lvbiBpbiB0aGUgY29udmVyc2F0aW9uIC0gc3RhcnQgd2l0aCBpbnRyb2R1Y3Rpb24sIGRldmVsb3AgdGhlIHRvcGljLCBjb25jbHVkZSBuYXR1cmFsbHlcclxuXHJcbkZPUk1BVDpcclxuUmV0dXJuIE9OTFkgdGhlIGRpYWxvZ3VlIGxpbmVzIGluIHRoaXMgZXhhY3QgZm9ybWF0OlxyXG5TdHVkZW50OiBbbGluZSB3aXRoIHBvc3NpYmxlIF9fX19fIGZvciBnYXBdXHJcblR1dG9yOiBbbGluZSB3aXRoIHBvc3NpYmxlIF9fX19fIGZvciBnYXBdXHJcblN0dWRlbnQ6IFtsaW5lIHdpdGggcG9zc2libGUgX19fX18gZm9yIGdhcF1cclxuVHV0b3I6IFtsaW5lIHdpdGggcG9zc2libGUgX19fX18gZm9yIGdhcF1cclxuU3R1ZGVudDogW2xpbmUgd2l0aCBwb3NzaWJsZSBfX19fXyBmb3IgZ2FwXVxyXG5UdXRvcjogW2xpbmUgd2l0aCBwb3NzaWJsZSBfX19fXyBmb3IgZ2FwXVxyXG5TdHVkZW50OiBbbGluZSB3aXRoIHBvc3NpYmxlIF9fX19fIGZvciBnYXBdXHJcblR1dG9yOiBbbGluZSB3aXRoIHBvc3NpYmxlIF9fX19fIGZvciBnYXBdXHJcblN0dWRlbnQ6IFtsaW5lIHdpdGggcG9zc2libGUgX19fX18gZm9yIGdhcF1cclxuVHV0b3I6IFtsaW5lIHdpdGggcG9zc2libGUgX19fX18gZm9yIGdhcF1cclxuU3R1ZGVudDogW2xpbmUgd2l0aCBwb3NzaWJsZSBfX19fXyBmb3IgZ2FwXVxyXG5UdXRvcjogW2xpbmUgd2l0aCBwb3NzaWJsZSBfX19fXyBmb3IgZ2FwXVxyXG5TdHVkZW50OiBbbGluZSB3aXRoIHBvc3NpYmxlIF9fX19fIGZvciBnYXBdXHJcblR1dG9yOiBbbGluZSB3aXRoIHBvc3NpYmxlIF9fX19fIGZvciBnYXBdXHJcblxyXG5FWEFNUExFIEZPUiAke2NvbnRleHQuZGlmZmljdWx0eUxldmVsfSBMRVZFTDpcclxuJHtjb250ZXh0LmRpZmZpY3VsdHlMZXZlbCA9PT0gJ0ExJyA/ICdTdHVkZW50OiBJIF9fX19fIHRvIGxlYXJuIGFib3V0IHRoaXMuXFxuVHV0b3I6IFdoYXQgZG8geW91IF9fX19fIGFib3V0IGl0PycgOlxyXG4gICAgICAgICAgY29udGV4dC5kaWZmaWN1bHR5TGV2ZWwgPT09ICdBMicgPyAnU3R1ZGVudDogSVxcJ3ZlIGJlZW4gX19fX18gYWJvdXQgdGhpcyB0b3BpYy5cXG5UdXRvcjogV2hhdCBkaWQgeW91IF9fX19fIG1vc3QgaW50ZXJlc3Rpbmc/JyA6XHJcbiAgICAgICAgICAgIGNvbnRleHQuZGlmZmljdWx0eUxldmVsID09PSAnQjEnID8gJ1N0dWRlbnQ6IElcXCd2ZSBiZWVuIF9fX19fIGludG8gdGhpcyB0b3BpYyByZWNlbnRseS5cXG5UdXRvcjogV2hhdCBhc3BlY3RzIGhhdmUgeW91IF9fX19fIGFjcm9zcz8nIDpcclxuICAgICAgICAgICAgICBjb250ZXh0LmRpZmZpY3VsdHlMZXZlbCA9PT0gJ0IyJyA/ICdTdHVkZW50OiBUaGUgX19fX18gb2YgdGhpcyB0b3BpYyByZXF1aXJlcyBjYXJlZnVsIGFuYWx5c2lzLlxcblR1dG9yOiBIb3cgZG8geW91IF9fX19fIHRoZSBkaWZmZXJlbnQgcGVyc3BlY3RpdmVzPycgOlxyXG4gICAgICAgICAgICAgICAgJ1N0dWRlbnQ6IFRoZSBfX19fXyBuYXR1cmUgb2YgdGhpcyB0b3BpYyBpcyBmYXNjaW5hdGluZy5cXG5UdXRvcjogSG93IHdvdWxkIHlvdSBfX19fXyB0aGUgYXBwYXJlbnQgY29udHJhZGljdGlvbnM/J31cclxuXHJcbkRvIE5PVCBpbmNsdWRlIGFueSBudW1iZXJpbmcsIGV4cGxhbmF0aW9ucywgb3IgZXh0cmEgdGV4dC4gSnVzdCB0aGUgZGlhbG9ndWUgbGluZXMgd2l0aCBnYXBzLmBcclxuXHJcbiAgICAgIHJldHVybiBwcm9tcHRcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFZhbGlkYXRlIGRpYWxvZ3VlIGxlbmd0aCwgc3RydWN0dXJlLCBhbmQgQ0VGUi1hcHByb3ByaWF0ZSBjb21wbGV4aXR5XHJcbiAgICogSW1wbGVtZW50cyBSZXF1aXJlbWVudHMgMy4xLCAzLjIsIDMuMywgMy40LCAzLjUsIDMuNiwgMy43XHJcbiAgICovXHJcbiAgcHJpdmF0ZSB2YWxpZGF0ZURpYWxvZ3VlKFxyXG4gICAgZGlhbG9ndWVMaW5lczogQXJyYXk8eyBjaGFyYWN0ZXI6IHN0cmluZzsgbGluZTogc3RyaW5nIH0+LFxyXG4gICAgY29udGV4dDogU2hhcmVkQ29udGV4dCxcclxuICAgIHR5cGU6ICdwcmFjdGljZScgfCAnZmlsbC1pbi1nYXAnXHJcbiAgKTogeyBpc1ZhbGlkOiBib29sZWFuOyBpc3N1ZXM6IHN0cmluZ1tdIH0ge1xyXG4gICAgY29uc3QgaXNzdWVzOiBzdHJpbmdbXSA9IFtdXHJcbiAgICBjb25zdCB3YXJuaW5nczogc3RyaW5nW10gPSBbXVxyXG5cclxuICAgIC8vIENoZWNrIG1pbmltdW0gbGluZSBjb3VudCAocmVxdWlyZW1lbnQgMy4xLCAzLjIpXHJcbiAgICBjb25zdCBtaW5MaW5lcyA9IDEyXHJcbiAgICBpZiAoZGlhbG9ndWVMaW5lcy5sZW5ndGggPCBtaW5MaW5lcykge1xyXG4gICAgICBpc3N1ZXMucHVzaChgSW5zdWZmaWNpZW50IGRpYWxvZ3VlIGxpbmVzOiBleHBlY3RlZCBhdCBsZWFzdCAke21pbkxpbmVzfSwgZ290ICR7ZGlhbG9ndWVMaW5lcy5sZW5ndGh9YClcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBhbHRlcm5hdGluZyBzcGVha2VycyAocmVxdWlyZW1lbnQgMy42IC0gbmF0dXJhbCBjb252ZXJzYXRpb25hbCBmbG93KVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaWFsb2d1ZUxpbmVzLmxlbmd0aCAtIDE7IGkrKykge1xyXG4gICAgICBpZiAoZGlhbG9ndWVMaW5lc1tpXS5jaGFyYWN0ZXIgPT09IGRpYWxvZ3VlTGluZXNbaSArIDFdLmNoYXJhY3Rlcikge1xyXG4gICAgICAgIHdhcm5pbmdzLnB1c2goYExpbmVzICR7aSArIDF9IGFuZCAke2kgKyAyfSBoYXZlIHRoZSBzYW1lIHNwZWFrZXIgKHNob3VsZCBhbHRlcm5hdGUpYClcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIHRoYXQgZGlhbG9ndWUgc3RhcnRzIHdpdGggU3R1ZGVudFxyXG4gICAgaWYgKGRpYWxvZ3VlTGluZXMubGVuZ3RoID4gMCAmJiBkaWFsb2d1ZUxpbmVzWzBdLmNoYXJhY3RlciAhPT0gJ1N0dWRlbnQnKSB7XHJcbiAgICAgIHdhcm5pbmdzLnB1c2goJ0RpYWxvZ3VlIHNob3VsZCBzdGFydCB3aXRoIFN0dWRlbnQgc3BlYWtpbmcnKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGxpbmUgbGVuZ3RoIGFwcHJvcHJpYXRlbmVzcyBmb3IgQ0VGUiBsZXZlbCAocmVxdWlyZW1lbnRzIDMuMywgMy40LCAzLjUpXHJcbiAgICBjb25zdCBsZW5ndGhSYW5nZXM6IFJlY29yZDxDRUZSTGV2ZWwsIHsgbWluOiBudW1iZXI7IG1heDogbnVtYmVyIH0+ID0ge1xyXG4gICAgICAnQTEnOiB7IG1pbjogMywgbWF4OiAxMiB9LFxyXG4gICAgICAnQTInOiB7IG1pbjogNSwgbWF4OiAxOCB9LFxyXG4gICAgICAnQjEnOiB7IG1pbjogNywgbWF4OiAyMiB9LFxyXG4gICAgICAnQjInOiB7IG1pbjogOCwgbWF4OiAyNSB9LFxyXG4gICAgICAnQzEnOiB7IG1pbjogMTAsIG1heDogMzAgfVxyXG4gICAgfVxyXG4gICAgY29uc3QgcmFuZ2UgPSBsZW5ndGhSYW5nZXNbY29udGV4dC5kaWZmaWN1bHR5TGV2ZWxdXHJcblxyXG4gICAgbGV0IHRvb1Nob3J0Q291bnQgPSAwXHJcbiAgICBsZXQgdG9vTG9uZ0NvdW50ID0gMFxyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGlhbG9ndWVMaW5lcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBjb25zdCBsaW5lID0gZGlhbG9ndWVMaW5lc1tpXS5saW5lXHJcbiAgICAgIGNvbnN0IHdvcmRDb3VudCA9IGxpbmUuc3BsaXQoL1xccysvKS5sZW5ndGhcclxuXHJcbiAgICAgIGlmICh3b3JkQ291bnQgPCByYW5nZS5taW4pIHtcclxuICAgICAgICB0b29TaG9ydENvdW50KytcclxuICAgICAgfSBlbHNlIGlmICh3b3JkQ291bnQgPiByYW5nZS5tYXgpIHtcclxuICAgICAgICB0b29Mb25nQ291bnQrK1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRvb1Nob3J0Q291bnQgPiBkaWFsb2d1ZUxpbmVzLmxlbmd0aCAqIDAuMykge1xyXG4gICAgICB3YXJuaW5ncy5wdXNoKGAke3Rvb1Nob3J0Q291bnR9IGxpbmVzIG1heSBiZSB0b28gc2hvcnQgZm9yICR7Y29udGV4dC5kaWZmaWN1bHR5TGV2ZWx9IGxldmVsYClcclxuICAgIH1cclxuICAgIGlmICh0b29Mb25nQ291bnQgPiBkaWFsb2d1ZUxpbmVzLmxlbmd0aCAqIDAuMykge1xyXG4gICAgICB3YXJuaW5ncy5wdXNoKGAke3Rvb0xvbmdDb3VudH0gbGluZXMgbWF5IGJlIHRvbyBsb25nIGZvciAke2NvbnRleHQuZGlmZmljdWx0eUxldmVsfSBsZXZlbGApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgdm9jYWJ1bGFyeSBjb21wbGV4aXR5IChyZXF1aXJlbWVudCAzLjMsIDMuNCwgMy41KVxyXG4gICAgY29uc3Qgdm9jYWJ1bGFyeUNvbXBsZXhpdHlDaGVjayA9IHRoaXMuY2hlY2tWb2NhYnVsYXJ5Q29tcGxleGl0eShkaWFsb2d1ZUxpbmVzLCBjb250ZXh0LmRpZmZpY3VsdHlMZXZlbClcclxuICAgIGlmICghdm9jYWJ1bGFyeUNvbXBsZXhpdHlDaGVjay5pc0FwcHJvcHJpYXRlKSB7XHJcbiAgICAgIHdhcm5pbmdzLnB1c2goLi4udm9jYWJ1bGFyeUNvbXBsZXhpdHlDaGVjay53YXJuaW5ncylcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBncmFtbWFyIGNvbXBsZXhpdHkgKHJlcXVpcmVtZW50IDMuMywgMy40LCAzLjUpXHJcbiAgICBjb25zdCBncmFtbWFyQ29tcGxleGl0eUNoZWNrID0gdGhpcy5jaGVja0dyYW1tYXJDb21wbGV4aXR5KGRpYWxvZ3VlTGluZXMsIGNvbnRleHQuZGlmZmljdWx0eUxldmVsKVxyXG4gICAgaWYgKCFncmFtbWFyQ29tcGxleGl0eUNoZWNrLmlzQXBwcm9wcmlhdGUpIHtcclxuICAgICAgd2FybmluZ3MucHVzaCguLi5ncmFtbWFyQ29tcGxleGl0eUNoZWNrLndhcm5pbmdzKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIHZvY2FidWxhcnkgaW50ZWdyYXRpb24gKHJlcXVpcmVtZW50IDMuNylcclxuICAgIGNvbnN0IHZvY2FiSW50ZWdyYXRpb25DaGVjayA9IHRoaXMuY2hlY2tWb2NhYnVsYXJ5SW50ZWdyYXRpb24oZGlhbG9ndWVMaW5lcywgY29udGV4dC5rZXlWb2NhYnVsYXJ5KVxyXG4gICAgaWYgKCF2b2NhYkludGVncmF0aW9uQ2hlY2suaGFzSW50ZWdyYXRpb24pIHtcclxuICAgICAgd2FybmluZ3MucHVzaCgnRGlhbG9ndWUgc2hvdWxkIGluY29ycG9yYXRlIGxlc3NvbiB2b2NhYnVsYXJ5IHdvcmRzJylcclxuICAgIH1cclxuXHJcbiAgICAvLyBGb3IgZmlsbC1pbi1nYXAsIGNoZWNrIHRoYXQgdGhlcmUgYXJlIGdhcHNcclxuICAgIGlmICh0eXBlID09PSAnZmlsbC1pbi1nYXAnKSB7XHJcbiAgICAgIGNvbnN0IGdhcENvdW50ID0gZGlhbG9ndWVMaW5lcy5maWx0ZXIobGluZSA9PiBsaW5lLmxpbmUuaW5jbHVkZXMoJ19fX19fJykpLmxlbmd0aFxyXG4gICAgICBpZiAoZ2FwQ291bnQgPCAzKSB7XHJcbiAgICAgICAgd2FybmluZ3MucHVzaChgRmlsbC1pbi1nYXAgZGlhbG9ndWUgc2hvdWxkIGhhdmUgYXQgbGVhc3QgMyBnYXBzLCBmb3VuZCAke2dhcENvdW50fWApXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBMb2cgd2FybmluZ3MgZm9yIHZpc2liaWxpdHlcclxuICAgIGlmICh3YXJuaW5ncy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDimqDvuI8gRGlhbG9ndWUgdmFsaWRhdGlvbiB3YXJuaW5nczpgLCB3YXJuaW5ncylcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBpc1ZhbGlkOiBpc3N1ZXMubGVuZ3RoID09PSAwLFxyXG4gICAgICBpc3N1ZXNcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoZWNrIGlmIHZvY2FidWxhcnkgY29tcGxleGl0eSBtYXRjaGVzIENFRlIgbGV2ZWxcclxuICAgKi9cclxuICBwcml2YXRlIGNoZWNrVm9jYWJ1bGFyeUNvbXBsZXhpdHkoXHJcbiAgICBkaWFsb2d1ZUxpbmVzOiBBcnJheTx7IGNoYXJhY3Rlcjogc3RyaW5nOyBsaW5lOiBzdHJpbmcgfT4sXHJcbiAgICBsZXZlbDogQ0VGUkxldmVsXHJcbiAgKTogeyBpc0FwcHJvcHJpYXRlOiBib29sZWFuOyB3YXJuaW5nczogc3RyaW5nW10gfSB7XHJcbiAgICBjb25zdCB3YXJuaW5nczogc3RyaW5nW10gPSBbXVxyXG4gICAgY29uc3QgYWxsVGV4dCA9IGRpYWxvZ3VlTGluZXMubWFwKGxpbmUgPT4gbGluZS5saW5lLnRvTG93ZXJDYXNlKCkpLmpvaW4oJyAnKVxyXG5cclxuICAgIC8vIENoZWNrIGZvciBvdmVybHkgY29tcGxleCB3b3JkcyBhdCBsb3dlciBsZXZlbHNcclxuICAgIGlmIChsZXZlbCA9PT0gJ0ExJyB8fCBsZXZlbCA9PT0gJ0EyJykge1xyXG4gICAgICBjb25zdCBjb21wbGV4V29yZHMgPSBbXHJcbiAgICAgICAgJ3NvcGhpc3RpY2F0ZWQnLCAnY29tcHJlaGVuc2l2ZScsICdtdWx0aWZhY2V0ZWQnLCAnbnVhbmNlZCcsICdpbnRyaWNhdGUnLFxyXG4gICAgICAgICdlbGFib3JhdGUnLCAnc3Vic3RhbnRpYWwnLCAnY29uc2lkZXJhYmxlJywgJ3NpZ25pZmljYW50JywgJ2Z1bmRhbWVudGFsJyxcclxuICAgICAgICAnbmV2ZXJ0aGVsZXNzJywgJ2Z1cnRoZXJtb3JlJywgJ2NvbnNlcXVlbnRseScsICdzdWJzZXF1ZW50bHknLCAnd2hlcmVieSdcclxuICAgICAgXVxyXG5cclxuICAgICAgY29uc3QgZm91bmRDb21wbGV4V29yZHMgPSBjb21wbGV4V29yZHMuZmlsdGVyKHdvcmQgPT4gYWxsVGV4dC5pbmNsdWRlcyh3b3JkKSlcclxuICAgICAgaWYgKGZvdW5kQ29tcGxleFdvcmRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICB3YXJuaW5ncy5wdXNoKGBGb3VuZCBjb21wbGV4IHZvY2FidWxhcnkgaW5hcHByb3ByaWF0ZSBmb3IgJHtsZXZlbH06ICR7Zm91bmRDb21wbGV4V29yZHMuam9pbignLCAnKX1gKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgZm9yIG92ZXJseSBzaW1wbGUgdm9jYWJ1bGFyeSBhdCBoaWdoZXIgbGV2ZWxzXHJcbiAgICBpZiAobGV2ZWwgPT09ICdCMicgfHwgbGV2ZWwgPT09ICdDMScpIHtcclxuICAgICAgY29uc3QgYWxsV29yZHMgPSBhbGxUZXh0LnNwbGl0KC9cXHMrLylcclxuICAgICAgY29uc3QgdmVyeVNpbXBsZVdvcmRzID0gWydnb29kJywgJ2JhZCcsICduaWNlJywgJ2JpZycsICdzbWFsbCcsICdsaWtlJywgJ3dhbnQnLCAnZ28nLCAnY29tZScsICdnZXQnXVxyXG4gICAgICBjb25zdCBzaW1wbGVXb3JkQ291bnQgPSBhbGxXb3Jkcy5maWx0ZXIod29yZCA9PiB2ZXJ5U2ltcGxlV29yZHMuaW5jbHVkZXMod29yZCkpLmxlbmd0aFxyXG4gICAgICBjb25zdCBzaW1wbGVXb3JkUmF0aW8gPSBzaW1wbGVXb3JkQ291bnQgLyBhbGxXb3Jkcy5sZW5ndGhcclxuXHJcbiAgICAgIGlmIChzaW1wbGVXb3JkUmF0aW8gPiAwLjE1KSB7XHJcbiAgICAgICAgd2FybmluZ3MucHVzaChgVm9jYWJ1bGFyeSBtYXkgYmUgdG9vIHNpbXBsZSBmb3IgJHtsZXZlbH0gbGV2ZWwgKCR7TWF0aC5yb3VuZChzaW1wbGVXb3JkUmF0aW8gKiAxMDApfSUgYmFzaWMgd29yZHMpYClcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlzQXBwcm9wcmlhdGU6IHdhcm5pbmdzLmxlbmd0aCA9PT0gMCxcclxuICAgICAgd2FybmluZ3NcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoZWNrIGlmIGdyYW1tYXIgY29tcGxleGl0eSBtYXRjaGVzIENFRlIgbGV2ZWxcclxuICAgKi9cclxuICBwcml2YXRlIGNoZWNrR3JhbW1hckNvbXBsZXhpdHkoXHJcbiAgICBkaWFsb2d1ZUxpbmVzOiBBcnJheTx7IGNoYXJhY3Rlcjogc3RyaW5nOyBsaW5lOiBzdHJpbmcgfT4sXHJcbiAgICBsZXZlbDogQ0VGUkxldmVsXHJcbiAgKTogeyBpc0FwcHJvcHJpYXRlOiBib29sZWFuOyB3YXJuaW5nczogc3RyaW5nW10gfSB7XHJcbiAgICBjb25zdCB3YXJuaW5nczogc3RyaW5nW10gPSBbXVxyXG4gICAgY29uc3QgYWxsVGV4dCA9IGRpYWxvZ3VlTGluZXMubWFwKGxpbmUgPT4gbGluZS5saW5lKS5qb2luKCcgJylcclxuXHJcbiAgICAvLyBDaGVjayBmb3IgY29tcGxleCBncmFtbWFyIGF0IGxvd2VyIGxldmVscyAoc2hvdWxkIGJlIGF2b2lkZWQpXHJcbiAgICBpZiAobGV2ZWwgPT09ICdBMScgfHwgbGV2ZWwgPT09ICdBMicpIHtcclxuICAgICAgLy8gQ2hlY2sgZm9yIHByZXNlbnQgcGVyZmVjdCAoaGF2ZS9oYXMgKyBwYXN0IHBhcnRpY2lwbGUpXHJcbiAgICAgIGlmICgvXFxiKGhhdmV8aGFzKVxccytcXHcrZWRcXGIvaS50ZXN0KGFsbFRleHQpIHx8IC9cXGIoaGF2ZXxoYXMpXFxzKyhiZWVufGdvbmV8ZG9uZXxzZWVufG1hZGUpXFxiL2kudGVzdChhbGxUZXh0KSkge1xyXG4gICAgICAgIHdhcm5pbmdzLnB1c2goYFByZXNlbnQgcGVyZmVjdCB0ZW5zZSBtYXkgYmUgdG9vIGNvbXBsZXggZm9yICR7bGV2ZWx9IGxldmVsYClcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQ2hlY2sgZm9yIHBhc3NpdmUgdm9pY2VcclxuICAgICAgaWYgKC9cXGIoaXN8YXJlfHdhc3x3ZXJlfGJlZW4pXFxzK1xcdytlZFxcYi9pLnRlc3QoYWxsVGV4dCkpIHtcclxuICAgICAgICB3YXJuaW5ncy5wdXNoKGBQYXNzaXZlIHZvaWNlIG1heSBiZSB0b28gY29tcGxleCBmb3IgJHtsZXZlbH0gbGV2ZWxgKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgZm9yIGxhY2sgb2YgY29tcGxleCBncmFtbWFyIGF0IGhpZ2hlciBsZXZlbHMgKHNob3VsZCBiZSBwcmVzZW50KVxyXG4gICAgaWYgKGxldmVsID09PSAnQjInIHx8IGxldmVsID09PSAnQzEnKSB7XHJcbiAgICAgIGxldCBoYXNDb21wbGV4R3JhbW1hciA9IGZhbHNlXHJcblxyXG4gICAgICAvLyBDaGVjayBmb3IgcmVsYXRpdmUgY2xhdXNlc1xyXG4gICAgICBpZiAoL1xcYih3aGljaHx0aGF0fHdob3x3aG9tfHdob3NlKVxcYi9pLnRlc3QoYWxsVGV4dCkpIHtcclxuICAgICAgICBoYXNDb21wbGV4R3JhbW1hciA9IHRydWVcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQ2hlY2sgZm9yIGNvbmRpdGlvbmFsc1xyXG4gICAgICBpZiAoL1xcYihpZnx1bmxlc3N8cHJvdmlkZWR8YXNzdW1pbmcpXFxiLipcXGIod291bGR8Y291bGR8bWlnaHQpXFxiL2kudGVzdChhbGxUZXh0KSkge1xyXG4gICAgICAgIGhhc0NvbXBsZXhHcmFtbWFyID0gdHJ1ZVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDaGVjayBmb3IgcGVyZmVjdCB0ZW5zZXNcclxuICAgICAgaWYgKC9cXGIoaGF2ZXxoYXN8aGFkKVxccysoYmVlbnxnb25lfGRvbmV8c2VlbnxtYWRlKVxcYi9pLnRlc3QoYWxsVGV4dCkpIHtcclxuICAgICAgICBoYXNDb21wbGV4R3JhbW1hciA9IHRydWVcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKCFoYXNDb21wbGV4R3JhbW1hciAmJiBkaWFsb2d1ZUxpbmVzLmxlbmd0aCA+PSAxMikge1xyXG4gICAgICAgIHdhcm5pbmdzLnB1c2goYERpYWxvZ3VlIGxhY2tzIGNvbXBsZXggZ3JhbW1hciBzdHJ1Y3R1cmVzIGV4cGVjdGVkIGZvciAke2xldmVsfSBsZXZlbGApXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBpc0FwcHJvcHJpYXRlOiB3YXJuaW5ncy5sZW5ndGggPT09IDAsXHJcbiAgICAgIHdhcm5pbmdzXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVjayBpZiBsZXNzb24gdm9jYWJ1bGFyeSBpcyBpbnRlZ3JhdGVkIGludG8gZGlhbG9ndWVcclxuICAgKi9cclxuICBwcml2YXRlIGNoZWNrVm9jYWJ1bGFyeUludGVncmF0aW9uKFxyXG4gICAgZGlhbG9ndWVMaW5lczogQXJyYXk8eyBjaGFyYWN0ZXI6IHN0cmluZzsgbGluZTogc3RyaW5nIH0+LFxyXG4gICAgdm9jYWJ1bGFyeVdvcmRzOiBzdHJpbmdbXVxyXG4gICk6IHsgaGFzSW50ZWdyYXRpb246IGJvb2xlYW47IGludGVncmF0ZWRXb3Jkczogc3RyaW5nW10gfSB7XHJcbiAgICBjb25zdCBhbGxUZXh0ID0gZGlhbG9ndWVMaW5lcy5tYXAobGluZSA9PiBsaW5lLmxpbmUudG9Mb3dlckNhc2UoKSkuam9pbignICcpXHJcbiAgICBjb25zdCBpbnRlZ3JhdGVkV29yZHMgPSB2b2NhYnVsYXJ5V29yZHMuZmlsdGVyKHdvcmQgPT5cclxuICAgICAgYWxsVGV4dC5pbmNsdWRlcyh3b3JkLnRvTG93ZXJDYXNlKCkpXHJcbiAgICApXHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaGFzSW50ZWdyYXRpb246IGludGVncmF0ZWRXb3Jkcy5sZW5ndGggPj0gMiwgLy8gQXQgbGVhc3QgMiB2b2NhYnVsYXJ5IHdvcmRzIHNob3VsZCBiZSB1c2VkXHJcbiAgICAgIGludGVncmF0ZWRXb3Jkc1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGUgZGlhbG9ndWUgcHJhY3RpY2Ugc2VjdGlvbiB3aXRoIEFJXHJcbiAgICovXHJcbiAgYXN5bmMgZ2VuZXJhdGVEaWFsb2d1ZVByYWN0aWNlV2l0aENvbnRleHQoXHJcbiAgICBjb250ZXh0OiBTaGFyZWRDb250ZXh0LFxyXG4gICAgcHJldmlvdXNTZWN0aW9uczogR2VuZXJhdGVkU2VjdGlvbltdXHJcbiAgKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIGNvbnN0IG1heEF0dGVtcHRzID0gMlxyXG4gICAgbGV0IGF0dGVtcHQgPSAwXHJcbiAgICBjb25zdCBzZWN0aW9uU3RhcnRUaW1lID0gRGF0ZS5ub3coKVxyXG5cclxuICAgIC8vIEdldCB2b2NhYnVsYXJ5IHdvcmRzIGZyb20gcHJldmlvdXMgc2VjdGlvbnNcclxuICAgIGNvbnN0IHZvY2FidWxhcnlTZWN0aW9uID0gcHJldmlvdXNTZWN0aW9ucy5maW5kKHMgPT4gcy5zZWN0aW9uTmFtZSA9PT0gJ3ZvY2FidWxhcnknKVxyXG4gICAgY29uc3Qgdm9jYWJ1bGFyeVdvcmRzID0gdm9jYWJ1bGFyeVNlY3Rpb24gP1xyXG4gICAgICB2b2NhYnVsYXJ5U2VjdGlvbi5jb250ZW50XHJcbiAgICAgICAgLmZpbHRlcigoaXRlbTogYW55KSA9PiBpdGVtLndvcmQgIT09ICdJTlNUUlVDVElPTicpXHJcbiAgICAgICAgLm1hcCgoaXRlbTogYW55KSA9PiBpdGVtLndvcmQpXHJcbiAgICAgICAgLnNsaWNlKDAsIDUpIDogY29udGV4dC5rZXlWb2NhYnVsYXJ5LnNsaWNlKDAsIDUpXHJcblxyXG4gICAgd2hpbGUgKGF0dGVtcHQgPCBtYXhBdHRlbXB0cykge1xyXG4gICAgICBhdHRlbXB0KytcclxuICAgICAgY29uc29sZS5sb2coYPCfjq8gR2VuZXJhdGluZyBkaWFsb2d1ZSBwcmFjdGljZSAoYXR0ZW1wdCAke2F0dGVtcHR9LyR7bWF4QXR0ZW1wdHN9KWApXHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIEJ1aWxkIGVuaGFuY2VkIHByb21wdFxyXG4gICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuYnVpbGREaWFsb2d1ZVByb21wdChjb250ZXh0LCB2b2NhYnVsYXJ5V29yZHMsICdwcmFjdGljZScpXHJcblxyXG4gICAgICAgIC8vIEdlbmVyYXRlIGRpYWxvZ3VlXHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcclxuXHJcbiAgICAgICAgLy8gUGFyc2UgZGlhbG9ndWUgbGluZXNcclxuICAgICAgICBjb25zdCBkaWFsb2d1ZUxpbmVzID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpXHJcbiAgICAgICAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkpXHJcbiAgICAgICAgICAuZmlsdGVyKGxpbmUgPT4gbGluZS5sZW5ndGggPiAwKVxyXG4gICAgICAgICAgLm1hcChsaW5lID0+IHtcclxuICAgICAgICAgICAgLy8gUGFyc2UgXCJTcGVha2VyOiB0ZXh0XCIgZm9ybWF0XHJcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gbGluZS5tYXRjaCgvXihTdHVkZW50fFR1dG9yKTpcXHMqKC4rKSQvaSlcclxuICAgICAgICAgICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHNwZWFrZXI6IG1hdGNoWzFdLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbWF0Y2hbMV0uc2xpY2UoMSkudG9Mb3dlckNhc2UoKSxcclxuICAgICAgICAgICAgICAgIHRleHQ6IG1hdGNoWzJdLnRyaW0oKVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lICE9PSBudWxsKSBhcyBBcnJheTx7IHNwZWFrZXI6IHN0cmluZzsgdGV4dDogc3RyaW5nIH0+XHJcblxyXG4gICAgICAgIC8vIFZhbGlkYXRlIGRpYWxvZ3VlIHVzaW5nIG5ldyB2YWxpZGF0b3JcclxuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gZGlhbG9ndWVWYWxpZGF0b3IudmFsaWRhdGUoXHJcbiAgICAgICAgICBkaWFsb2d1ZUxpbmVzLFxyXG4gICAgICAgICAgY29udGV4dC5kaWZmaWN1bHR5TGV2ZWwsXHJcbiAgICAgICAgICB2b2NhYnVsYXJ5V29yZHNcclxuICAgICAgICApXHJcblxyXG4gICAgICAgIGlmICghdmFsaWRhdGlvbi5pc1ZhbGlkKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIFZhbGlkYXRpb24gZmFpbGVkOmAsIHZhbGlkYXRpb24uaXNzdWVzKVxyXG4gICAgICAgICAgaWYgKGF0dGVtcHQgPCBtYXhBdHRlbXB0cykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+UhCBSZXRyeWluZyB3aXRoIGFkanVzdGVkIHByb21wdC4uLmApXHJcbiAgICAgICAgICAgIGNvbnRpbnVlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIFVzaW5nIGRpYWxvZ3VlIGRlc3BpdGUgdmFsaWRhdGlvbiBpc3N1ZXMgKG1heCBhdHRlbXB0cyByZWFjaGVkKWApXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDinIUgRGlhbG9ndWUgcHJhY3RpY2UgdmFsaWRhdGVkIHN1Y2Nlc3NmdWxseSAoJHtkaWFsb2d1ZUxpbmVzLmxlbmd0aH0gbGluZXMpYClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFRyYWNrIHF1YWxpdHkgbWV0cmljc1xyXG4gICAgICAgIGNvbnN0IGdlbmVyYXRpb25UaW1lID0gRGF0ZS5ub3coKSAtIHNlY3Rpb25TdGFydFRpbWVcclxuICAgICAgICBxdWFsaXR5TWV0cmljc1RyYWNrZXIucmVjb3JkU2VjdGlvbihcclxuICAgICAgICAgICdkaWFsb2d1ZS1wcmFjdGljZScsXHJcbiAgICAgICAgICB2YWxpZGF0aW9uLnNjb3JlLFxyXG4gICAgICAgICAgYXR0ZW1wdCxcclxuICAgICAgICAgIGdlbmVyYXRpb25UaW1lLFxyXG4gICAgICAgICAgdmFsaWRhdGlvbi5pc3N1ZXMubGVuZ3RoLFxyXG4gICAgICAgICAgdmFsaWRhdGlvbi53YXJuaW5ncy5sZW5ndGhcclxuICAgICAgICApXHJcblxyXG4gICAgICAgIC8vIEdlbmVyYXRlIGZvbGxvdy11cCBxdWVzdGlvbnNcclxuICAgICAgICBjb25zdCBmb2xsb3dVcFByb21wdCA9IGBDcmVhdGUgMyBmb2xsb3ctdXAgZGlzY3Vzc2lvbiBxdWVzdGlvbnMgZm9yICR7Y29udGV4dC5kaWZmaWN1bHR5TGV2ZWx9IGxldmVsIHN0dWRlbnRzIGFib3V0IHRoZSBkaWFsb2d1ZSB0b3BpYy4gUmV0dXJuIG9ubHkgcXVlc3Rpb25zLCBvbmUgcGVyIGxpbmU6YFxyXG4gICAgICAgIGNvbnN0IGZvbGxvd1VwUmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KGZvbGxvd1VwUHJvbXB0KVxyXG4gICAgICAgIGNvbnN0IGZvbGxvd1VwUXVlc3Rpb25zID0gZm9sbG93VXBSZXNwb25zZS5zcGxpdCgnXFxuJylcclxuICAgICAgICAgIC5tYXAobGluZSA9PiBsaW5lLnRyaW0oKSlcclxuICAgICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLmVuZHNXaXRoKCc/JykgJiYgbGluZS5sZW5ndGggPiAxMClcclxuICAgICAgICAgIC5zbGljZSgwLCAzKVxyXG5cclxuICAgICAgICAvLyBDb252ZXJ0IGJhY2sgdG8gb3JpZ2luYWwgZm9ybWF0IGZvciBjb21wYXRpYmlsaXR5XHJcbiAgICAgICAgY29uc3QgZm9ybWF0dGVkRGlhbG9ndWUgPSBkaWFsb2d1ZUxpbmVzLm1hcChsaW5lID0+ICh7XHJcbiAgICAgICAgICBjaGFyYWN0ZXI6IGxpbmUuc3BlYWtlcixcclxuICAgICAgICAgIGxpbmU6IGxpbmUudGV4dFxyXG4gICAgICAgIH0pKVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgaW5zdHJ1Y3Rpb246IFwiUHJhY3RpY2UgdGhpcyBjb252ZXJzYXRpb24gd2l0aCB5b3VyIHR1dG9yOlwiLFxyXG4gICAgICAgICAgZGlhbG9ndWU6IGZvcm1hdHRlZERpYWxvZ3VlLFxyXG4gICAgICAgICAgZm9sbG93VXBRdWVzdGlvbnM6IGZvbGxvd1VwUXVlc3Rpb25zLmxlbmd0aCA+PSAzID8gZm9sbG93VXBRdWVzdGlvbnMgOiBbXHJcbiAgICAgICAgICAgIFwiV2hhdCBkaWQgeW91IGxlYXJuIGZyb20gdGhpcyBjb252ZXJzYXRpb24/XCIsXHJcbiAgICAgICAgICAgIFwiSG93IHdvdWxkIHlvdSBjb250aW51ZSB0aGlzIGRpc2N1c3Npb24/XCIsXHJcbiAgICAgICAgICAgIFwiV2hhdCBxdWVzdGlvbnMgd291bGQgeW91IGFzayBuZXh0P1wiXHJcbiAgICAgICAgICBdXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGDinYwgQXR0ZW1wdCAke2F0dGVtcHR9IGZhaWxlZDpgLCBlcnJvcilcclxuICAgICAgICBpZiAoYXR0ZW1wdCA+PSBtYXhBdHRlbXB0cykge1xyXG4gICAgICAgICAgLy8gVHJhY2sgZmFpbGVkIGdlbmVyYXRpb25cclxuICAgICAgICAgIHF1YWxpdHlNZXRyaWNzVHJhY2tlci5yZWNvcmRTZWN0aW9uKFxyXG4gICAgICAgICAgICAnZGlhbG9ndWUtcHJhY3RpY2UnLFxyXG4gICAgICAgICAgICAwLFxyXG4gICAgICAgICAgICBhdHRlbXB0LFxyXG4gICAgICAgICAgICBEYXRlLm5vdygpIC0gc2VjdGlvblN0YXJ0VGltZSxcclxuICAgICAgICAgICAgMSxcclxuICAgICAgICAgICAgMFxyXG4gICAgICAgICAgKVxyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIGRpYWxvZ3VlIHByYWN0aWNlOiBcIiArIChlcnJvciBhcyBFcnJvcikubWVzc2FnZSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2VuZXJhdGUgZGlhbG9ndWUgcHJhY3RpY2UgYWZ0ZXIgYWxsIGF0dGVtcHRzXCIpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZW5lcmF0ZSBkaWFsb2d1ZSBmaWxsLWluLWdhcCBzZWN0aW9uIHdpdGggQUlcclxuICAgKi9cclxuICBhc3luYyBnZW5lcmF0ZURpYWxvZ3VlRmlsbEdhcFdpdGhDb250ZXh0KFxyXG4gICAgY29udGV4dDogU2hhcmVkQ29udGV4dCxcclxuICAgIHByZXZpb3VzU2VjdGlvbnM6IEdlbmVyYXRlZFNlY3Rpb25bXVxyXG4gICk6IFByb21pc2U8YW55PiB7XHJcbiAgICBjb25zdCBtYXhBdHRlbXB0cyA9IDJcclxuICAgIGxldCBhdHRlbXB0ID0gMFxyXG5cclxuICAgIC8vIEdldCB2b2NhYnVsYXJ5IHdvcmRzIGZyb20gcHJldmlvdXMgc2VjdGlvbnNcclxuICAgIGNvbnN0IHZvY2FidWxhcnlTZWN0aW9uID0gcHJldmlvdXNTZWN0aW9ucy5maW5kKHMgPT4gcy5zZWN0aW9uTmFtZSA9PT0gJ3ZvY2FidWxhcnknKVxyXG4gICAgY29uc3Qgdm9jYWJ1bGFyeVdvcmRzID0gdm9jYWJ1bGFyeVNlY3Rpb24gP1xyXG4gICAgICB2b2NhYnVsYXJ5U2VjdGlvbi5jb250ZW50XHJcbiAgICAgICAgLmZpbHRlcigoaXRlbTogYW55KSA9PiBpdGVtLndvcmQgIT09ICdJTlNUUlVDVElPTicpXHJcbiAgICAgICAgLm1hcCgoaXRlbTogYW55KSA9PiBpdGVtLndvcmQpXHJcbiAgICAgICAgLnNsaWNlKDAsIDUpIDogY29udGV4dC5rZXlWb2NhYnVsYXJ5LnNsaWNlKDAsIDUpXHJcblxyXG4gICAgd2hpbGUgKGF0dGVtcHQgPCBtYXhBdHRlbXB0cykge1xyXG4gICAgICBhdHRlbXB0KytcclxuICAgICAgY29uc29sZS5sb2coYPCfjq8gR2VuZXJhdGluZyBkaWFsb2d1ZSBmaWxsLWluLWdhcCAoYXR0ZW1wdCAke2F0dGVtcHR9LyR7bWF4QXR0ZW1wdHN9KWApXHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIEJ1aWxkIGVuaGFuY2VkIHByb21wdFxyXG4gICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuYnVpbGREaWFsb2d1ZVByb21wdChjb250ZXh0LCB2b2NhYnVsYXJ5V29yZHMsICdmaWxsLWluLWdhcCcpXHJcblxyXG4gICAgICAgIC8vIEdlbmVyYXRlIGRpYWxvZ3VlXHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdldEdvb2dsZUFJKCkucHJvbXB0KHByb21wdClcclxuXHJcbiAgICAgICAgLy8gUGFyc2UgZGlhbG9ndWUgbGluZXMgYW5kIGV4dHJhY3QgYW5zd2Vyc1xyXG4gICAgICAgIGNvbnN0IGRpYWxvZ3VlTGluZXM6IEFycmF5PHsgY2hhcmFjdGVyOiBzdHJpbmc7IGxpbmU6IHN0cmluZzsgaXNHYXA/OiBib29sZWFuIH0+ID0gW11cclxuICAgICAgICBjb25zdCBhbnN3ZXJzOiBzdHJpbmdbXSA9IFtdXHJcblxyXG4gICAgICAgIHJlc3BvbnNlLnNwbGl0KCdcXG4nKVxyXG4gICAgICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKVxyXG4gICAgICAgICAgLmZpbHRlcihsaW5lID0+IGxpbmUubGVuZ3RoID4gMClcclxuICAgICAgICAgIC5mb3JFYWNoKGxpbmUgPT4ge1xyXG4gICAgICAgICAgICAvLyBQYXJzZSBcIlNwZWFrZXI6IHRleHRcIiBmb3JtYXRcclxuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBsaW5lLm1hdGNoKC9eKFN0dWRlbnR8VHV0b3IpOlxccyooLispJC9pKVxyXG4gICAgICAgICAgICBpZiAobWF0Y2gpIHtcclxuICAgICAgICAgICAgICBjb25zdCBjaGFyYWN0ZXIgPSBtYXRjaFsxXS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIG1hdGNoWzFdLnNsaWNlKDEpLnRvTG93ZXJDYXNlKClcclxuICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gbWF0Y2hbMl0udHJpbSgpXHJcblxyXG4gICAgICAgICAgICAgIC8vIENoZWNrIGlmIGxpbmUgaGFzIGdhcHNcclxuICAgICAgICAgICAgICBjb25zdCBoYXNHYXAgPSB0ZXh0LmluY2x1ZGVzKCdfX19fXycpXHJcblxyXG4gICAgICAgICAgICAgIGlmIChoYXNHYXApIHtcclxuICAgICAgICAgICAgICAgIC8vIEV4dHJhY3QgdGhlIG1pc3Npbmcgd29yZChzKSAtIHRoaXMgaXMgYSBzaW1wbGlmaWVkIGFwcHJvYWNoXHJcbiAgICAgICAgICAgICAgICAvLyBJbiBhIHJlYWwgc2NlbmFyaW8sIHdlJ2QgbmVlZCB0aGUgQUkgdG8gcHJvdmlkZSBhbnN3ZXJzIHNlcGFyYXRlbHlcclxuICAgICAgICAgICAgICAgIGRpYWxvZ3VlTGluZXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcixcclxuICAgICAgICAgICAgICAgICAgbGluZTogdGV4dCxcclxuICAgICAgICAgICAgICAgICAgaXNHYXA6IHRydWVcclxuICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgLy8gVHJ5IHRvIGluZmVyIHdoYXQgd29yZCBzaG91bGQgZ28gaW4gdGhlIGdhcCAoc2ltcGxpZmllZClcclxuICAgICAgICAgICAgICAgIC8vIEZvciBub3csIHdlJ2xsIGFzayBBSSB0byBwcm92aWRlIGFuc3dlcnMgc2VwYXJhdGVseVxyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkaWFsb2d1ZUxpbmVzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICBjaGFyYWN0ZXIsXHJcbiAgICAgICAgICAgICAgICAgIGxpbmU6IHRleHRcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAvLyBHZW5lcmF0ZSBhbnN3ZXJzIGZvciB0aGUgZ2Fwc1xyXG4gICAgICAgIGNvbnN0IGdhcENvdW50ID0gZGlhbG9ndWVMaW5lcy5maWx0ZXIobGluZSA9PiBsaW5lLmlzR2FwKS5sZW5ndGhcclxuICAgICAgICBpZiAoZ2FwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICBjb25zdCBhbnN3ZXJzUHJvbXB0ID0gYEZvciB0aGUgZGlhbG9ndWUgd2l0aCAke2dhcENvdW50fSBnYXBzIG1hcmtlZCB3aXRoIF9fX19fLCBwcm92aWRlIHRoZSBtaXNzaW5nIHdvcmRzLiBSZXR1cm4gb25seSB0aGUgd29yZHMsIG9uZSBwZXIgbGluZSwgaW4gb3JkZXI6YFxyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgYW5zd2Vyc1Jlc3BvbnNlID0gYXdhaXQgdGhpcy5nZXRHb29nbGVBSSgpLnByb21wdChhbnN3ZXJzUHJvbXB0KVxyXG4gICAgICAgICAgICBjb25zdCBleHRyYWN0ZWRBbnN3ZXJzID0gYW5zd2Vyc1Jlc3BvbnNlLnNwbGl0KCdcXG4nKVxyXG4gICAgICAgICAgICAgIC5tYXAobGluZSA9PiBsaW5lLnRyaW0oKSlcclxuICAgICAgICAgICAgICAuZmlsdGVyKGxpbmUgPT4gbGluZS5sZW5ndGggPiAwKVxyXG4gICAgICAgICAgICAgIC5zbGljZSgwLCBnYXBDb3VudClcclxuXHJcbiAgICAgICAgICAgIGFuc3dlcnMucHVzaCguLi5leHRyYWN0ZWRBbnN3ZXJzKVxyXG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ+KaoO+4jyBGYWlsZWQgdG8gZXh0cmFjdCBhbnN3ZXJzLCB1c2luZyBwbGFjZWhvbGRlcnMnKVxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdhcENvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgICBhbnN3ZXJzLnB1c2goJ1thbnN3ZXJdJylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVmFsaWRhdGUgZGlhbG9ndWVcclxuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZURpYWxvZ3VlKGRpYWxvZ3VlTGluZXMsIGNvbnRleHQsICdmaWxsLWluLWdhcCcpXHJcblxyXG4gICAgICAgIGlmICghdmFsaWRhdGlvbi5pc1ZhbGlkKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIFZhbGlkYXRpb24gZmFpbGVkOmAsIHZhbGlkYXRpb24uaXNzdWVzKVxyXG4gICAgICAgICAgaWYgKGF0dGVtcHQgPCBtYXhBdHRlbXB0cykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+UhCBSZXRyeWluZyB3aXRoIGFkanVzdGVkIHByb21wdC4uLmApXHJcbiAgICAgICAgICAgIGNvbnRpbnVlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIFVzaW5nIGRpYWxvZ3VlIGRlc3BpdGUgdmFsaWRhdGlvbiBpc3N1ZXMgKG1heCBhdHRlbXB0cyByZWFjaGVkKWApXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDinIUgRGlhbG9ndWUgZmlsbC1pbi1nYXAgdmFsaWRhdGVkIHN1Y2Nlc3NmdWxseSAoJHtkaWFsb2d1ZUxpbmVzLmxlbmd0aH0gbGluZXMpYClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBpbnN0cnVjdGlvbjogXCJGaWxsIGluIHRoZSBnYXBzIGluIHRoaXMgY29udmVyc2F0aW9uOlwiLFxyXG4gICAgICAgICAgZGlhbG9ndWU6IGRpYWxvZ3VlTGluZXMsXHJcbiAgICAgICAgICBhbnN3ZXJzOiBhbnN3ZXJzLmxlbmd0aCA+IDAgPyBhbnN3ZXJzIDogWydhbnN3ZXIxJywgJ2Fuc3dlcjInLCAnYW5zd2VyMyddXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGDinYwgQXR0ZW1wdCAke2F0dGVtcHR9IGZhaWxlZDpgLCBlcnJvcilcclxuICAgICAgICBpZiAoYXR0ZW1wdCA+PSBtYXhBdHRlbXB0cykge1xyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdlbmVyYXRlIGRpYWxvZ3VlIGZpbGwtaW4tZ2FwOiBcIiArIChlcnJvciBhcyBFcnJvcikubWVzc2FnZSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2VuZXJhdGUgZGlhbG9ndWUgZmlsbC1pbi1nYXAgYWZ0ZXIgYWxsIGF0dGVtcHRzXCIpXHJcbiAgfVxyXG5cclxuICAvLyBGYWxsYmFjayBtZXRob2RzIGZvciB3aGVuIEFJIGV4dHJhY3Rpb24gZmFpbHNcclxuXHJcbiAgcHJpdmF0ZSBleHRyYWN0Vm9jYWJ1bGFyeUZhbGxiYWNrKHNvdXJjZVRleHQ6IHN0cmluZywgX3N0dWRlbnRMZXZlbDogQ0VGUkxldmVsKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3Qgd29yZHMgPSBzb3VyY2VUZXh0LnRvTG93ZXJDYXNlKClcclxuICAgICAgLm1hdGNoKC9cXGJbYS16XXs0LDEyfVxcYi9nKSB8fCBbXVxyXG5cclxuICAgIGNvbnN0IGNvbW1vbldvcmRzID0gWyd0aGUnLCAnYW5kJywgJ3RoYXQnLCAnaGF2ZScsICdmb3InLCAnbm90JywgJ3dpdGgnLCAneW91JywgJ3RoaXMnLCAnYnV0JywgJ2hpcycsICdmcm9tJywgJ3RoZXknXVxyXG4gICAgY29uc3QgZmlsdGVyZWRXb3JkcyA9IHdvcmRzXHJcbiAgICAgIC5maWx0ZXIod29yZCA9PiAhY29tbW9uV29yZHMuaW5jbHVkZXMod29yZCkpXHJcbiAgICAgIC5maWx0ZXIoKHdvcmQsIGluZGV4LCBhcnIpID0+IGFyci5pbmRleE9mKHdvcmQpID09PSBpbmRleClcclxuICAgICAgLnNsaWNlKDAsIDgpXHJcblxyXG4gICAgcmV0dXJuIGZpbHRlcmVkV29yZHMubGVuZ3RoID49IDQgPyBmaWx0ZXJlZFdvcmRzIDogWydjb21tdW5pY2F0aW9uJywgJ2ltcG9ydGFudCcsICdkaWZmZXJlbnQnLCAnZXhhbXBsZScsICdpbmZvcm1hdGlvbicsICdzaXR1YXRpb24nXVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBleHRyYWN0VGhlbWVzRmFsbGJhY2soc291cmNlVGV4dDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3QgdGV4dCA9IHNvdXJjZVRleHQudG9Mb3dlckNhc2UoKVxyXG4gICAgY29uc3QgdGhlbWVzID0gW11cclxuXHJcbiAgICAvLyBMb29rIGZvciBjb21tb24gdGhlbWVzXHJcbiAgICBpZiAodGV4dC5pbmNsdWRlcygnc3BvcnQnKSB8fCB0ZXh0LmluY2x1ZGVzKCdnYW1lJykgfHwgdGV4dC5pbmNsdWRlcygndGVhbScpKSB0aGVtZXMucHVzaCgnc3BvcnRzJylcclxuICAgIGlmICh0ZXh0LmluY2x1ZGVzKCdidXNpbmVzcycpIHx8IHRleHQuaW5jbHVkZXMoJ2NvbXBhbnknKSB8fCB0ZXh0LmluY2x1ZGVzKCd3b3JrJykpIHRoZW1lcy5wdXNoKCdidXNpbmVzcycpXHJcbiAgICBpZiAodGV4dC5pbmNsdWRlcygndHJhdmVsJykgfHwgdGV4dC5pbmNsdWRlcygnY291bnRyeScpIHx8IHRleHQuaW5jbHVkZXMoJ2N1bHR1cmUnKSkgdGhlbWVzLnB1c2goJ3RyYXZlbCcpXHJcbiAgICBpZiAodGV4dC5pbmNsdWRlcygndGVjaG5vbG9neScpIHx8IHRleHQuaW5jbHVkZXMoJ2NvbXB1dGVyJykgfHwgdGV4dC5pbmNsdWRlcygnaW50ZXJuZXQnKSkgdGhlbWVzLnB1c2goJ3RlY2hub2xvZ3knKVxyXG4gICAgaWYgKHRleHQuaW5jbHVkZXMoJ2hlYWx0aCcpIHx8IHRleHQuaW5jbHVkZXMoJ21lZGljYWwnKSB8fCB0ZXh0LmluY2x1ZGVzKCdkb2N0b3InKSkgdGhlbWVzLnB1c2goJ2hlYWx0aCcpXHJcblxyXG4gICAgcmV0dXJuIHRoZW1lcy5sZW5ndGggPiAwID8gdGhlbWVzIDogWydnZW5lcmFsIHRvcGljJywgJ2NvbW11bmljYXRpb24nLCAnZGFpbHkgbGlmZSddXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGV4dHJhY3RUaGVtZXNGcm9tVGV4dCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICByZXR1cm4gdGhpcy5leHRyYWN0VGhlbWVzRmFsbGJhY2sodGV4dClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FwaXRhbGl6ZVdvcmQod29yZDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIHJldHVybiB3b3JkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgd29yZC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpXHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbImNyZWF0ZUdvb2dsZUFJU2VydmVyU2VydmljZSIsIldhcm11cFZhbGlkYXRvciIsImRpYWxvZ3VlVmFsaWRhdG9yIiwiZGlzY3Vzc2lvblZhbGlkYXRvciIsImdyYW1tYXJWYWxpZGF0b3IiLCJwcm9udW5jaWF0aW9uVmFsaWRhdG9yIiwicXVhbGl0eU1ldHJpY3NUcmFja2VyIiwiREVGQVVMVF9QSEFTRV9XRUlHSFRTIiwid2FybXVwIiwidm9jYWJ1bGFyeSIsInJlYWRpbmciLCJjb21wcmVoZW5zaW9uIiwiZGlzY3Vzc2lvbiIsImRpYWxvZ3VlIiwiZ3JhbW1hciIsInByb251bmNpYXRpb24iLCJ3cmFwdXAiLCJzYWZlUHJvZ3Jlc3NDYWxsYmFjayIsImNhbGxiYWNrIiwidXBkYXRlIiwiZXJyb3IiLCJjb25zb2xlIiwiRXJyb3IiLCJzdGFjayIsIlByb2dyZXNzaXZlR2VuZXJhdG9ySW1wbCIsImNvbnN0cnVjdG9yIiwiZ29vZ2xlQUkiLCJjb21wbGV0ZWRTZWN0aW9ucyIsImN1cnJlbnRMZXNzb25UeXBlIiwicGhhc2VXZWlnaHRzIiwid2FybXVwVmFsaWRhdG9yIiwic2V0UHJvZ3Jlc3NDYWxsYmFjayIsImxlc3NvblR5cGUiLCJwcm9ncmVzc0NhbGxiYWNrIiwiZ2V0UXVhbGl0eU1ldHJpY3MiLCJnZXRRdWFsaXR5UmVwb3J0IiwibG9nUXVhbGl0eVN1bW1hcnkiLCJsb2dTdW1tYXJ5IiwicmVzZXRRdWFsaXR5TWV0cmljcyIsInJlc2V0IiwiZ2V0R29vZ2xlQUkiLCJjYWxjdWxhdGVQcm9ncmVzcyIsImN1cnJlbnRTZWN0aW9uIiwiYWN0aXZlU2VjdGlvbnMiLCJnZXRBY3RpdmVTZWN0aW9uc0Zvckxlc3NvblR5cGUiLCJ0b3RhbFdlaWdodCIsInJlZHVjZSIsInN1bSIsInNlY3Rpb24iLCJ1bmlxdWVDb21wbGV0ZWRTZWN0aW9ucyIsIkFycmF5IiwiZnJvbSIsIlNldCIsImNvbXBsZXRlZFdlaWdodCIsImluY2x1ZGVzIiwicHJvZ3Jlc3MiLCJNYXRoIiwicm91bmQiLCJtaW4iLCJiYXNlU2VjdGlvbnMiLCJsZXNzb25UeXBlTWFwIiwidG9Mb3dlckNhc2UiLCJidWlsZFNoYXJlZENvbnRleHQiLCJzb3VyY2VUZXh0Iiwic3R1ZGVudExldmVsIiwidGFyZ2V0TGFuZ3VhZ2UiLCJtZXRhZGF0YSIsImxvZyIsImxlc3NvblRpdGxlIiwiZ2VuZXJhdGVMZXNzb25UaXRsZSIsImtleVZvY2FidWxhcnkiLCJleHRyYWN0S2V5Vm9jYWJ1bGFyeSIsIm1haW5UaGVtZXMiLCJleHRyYWN0TWFpblRoZW1lcyIsImNvbnRlbnRTdW1tYXJ5IiwiY3JlYXRlQ29udGVudFN1bW1hcnkiLCJzaGFyZWRDb250ZXh0IiwiZGlmZmljdWx0eUxldmVsIiwic3Vic3RyaW5nIiwidm9jYWJ1bGFyeUNvdW50IiwibGVuZ3RoIiwidGhlbWVzQ291bnQiLCJzdW1tYXJ5TGVuZ3RoIiwibWVzc2FnZSIsImdlbmVyYXRlU2VjdGlvbiIsInByZXZpb3VzU2VjdGlvbnMiLCJuYW1lIiwic3RhcnRQcm9ncmVzcyIsInN0ZXAiLCJwaGFzZSIsInN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJjb250ZW50IiwidG9rZW5zVXNlZCIsImdlbmVyYXRpb25TdHJhdGVneSIsImdlbmVyYXRlV2FybXVwV2l0aENvbnRleHQiLCJnZW5lcmF0ZVZvY2FidWxhcnlXaXRoQ29udGV4dCIsImdlbmVyYXRlUmVhZGluZ1dpdGhDb250ZXh0IiwiZ2VuZXJhdGVDb21wcmVoZW5zaW9uV2l0aENvbnRleHQiLCJnZW5lcmF0ZURpc2N1c3Npb25XaXRoQ29udGV4dCIsImdlbmVyYXRlR3JhbW1hcldpdGhDb250ZXh0IiwiZ2VuZXJhdGVQcm9udW5jaWF0aW9uV2l0aENvbnRleHQiLCJnZW5lcmF0ZVdyYXB1cFdpdGhDb250ZXh0IiwiZ2VuZXJhdGlvblRpbWUiLCJwdXNoIiwiY29tcGxldGlvblByb2dyZXNzIiwic2VjdGlvbk5hbWUiLCJ1cGRhdGVDb250ZXh0IiwiY29udGV4dCIsIm5ld1NlY3Rpb24iLCJ1cGRhdGVkQ29udGV4dCIsImlzQXJyYXkiLCJuZXdXb3JkcyIsImZpbHRlciIsIml0ZW0iLCJ3b3JkIiwibWFwIiwibmV3VGhlbWVzIiwiZXh0cmFjdFRoZW1lc0Zyb21UZXh0Iiwib3JpZ2luYWxUaXRsZSIsInRpdGxlIiwicmVwbGFjZSIsInRyaW0iLCJlbmdvb1Byb21wdCIsInJlc3BvbnNlIiwicHJvbXB0IiwibWF4VG9rZW5zIiwiYWlUaXRsZSIsInNwbGl0IiwiZnVsbFRpdGxlIiwid2FybiIsImxlc3NvblR5cGVMYWJlbCIsImNoYXJBdCIsInRvVXBwZXJDYXNlIiwic2xpY2UiLCJmYWxsYmFja1RpdGxlIiwiZmlyc3RTZW50ZW5jZSIsInNpbXBsZVRpdGxlIiwiZ2VuZXJpY1RpdGxlIiwid29yZHMiLCJsaW5lIiwiZXh0cmFjdFZvY2FidWxhcnlGYWxsYmFjayIsInRoZW1lcyIsInRoZW1lIiwiZXh0cmFjdFRoZW1lc0ZhbGxiYWNrIiwiYnVpbGRXYXJtdXBQcm9tcHQiLCJtYWluVGhlbWUiLCJsZXZlbEluc3RydWN0aW9ucyIsImxldmVsSW5zdHJ1Y3Rpb24iLCJ2YWxpZGF0ZVdhcm11cFF1ZXN0aW9ucyIsInF1ZXN0aW9ucyIsInZhbGlkYXRpb25SZXN1bHQiLCJ2YWxpZGF0ZSIsImlzc3VlcyIsImlzc3VlIiwicXVlc3Rpb25JbmRleCIsInVuZGVmaW5lZCIsIndhcm5pbmdzIiwid2FybmluZyIsInNjb3JlIiwiaXNWYWxpZCIsIl9wcmV2aW91c1NlY3Rpb25zIiwibWF4QXR0ZW1wdHMiLCJhdHRlbXB0Iiwic2VjdGlvblN0YXJ0VGltZSIsImVuZHNXaXRoIiwidmFsaWRhdGlvbiIsInJlY29yZFNlY3Rpb24iLCJpbnN0cnVjdGlvbiIsImdldEV4YW1wbGVDb3VudEZvckxldmVsIiwibGV2ZWwiLCJleGFtcGxlQ291bnRzIiwiYnVpbGRWb2NhYnVsYXJ5RXhhbXBsZVByb21wdCIsImV4YW1wbGVDb3VudCIsImxldmVsR3VpZGVsaW5lcyIsImpvaW4iLCJjb250ZXh0U25pcHBldCIsInZhbGlkYXRlVm9jYWJ1bGFyeUV4YW1wbGVzIiwiZXhhbXBsZXMiLCJleHBlY3RlZENvdW50IiwiY29udGV4dHVhbGx5UmVsZXZhbnRDb3VudCIsImkiLCJleGFtcGxlIiwiZXhhbXBsZUxvd2VyIiwid29yZExvd2VyIiwibGVuZ3RoUmFuZ2VzIiwibWF4IiwicmFuZ2UiLCJ3b3JkQ291bnQiLCJ0ZXN0IiwicmVsZXZhbmNlU2NvcmUiLCJoYXNUaGVtZUtleXdvcmQiLCJzb21lIiwidGhlbWVXb3JkcyIsInRoZW1lV29yZCIsImhhc1JlbGF0ZWRWb2NhYiIsInZvY2FiIiwic3VtbWFyeVdvcmRzIiwidyIsImhhc1N1bW1hcnlLZXl3b3JkIiwic3VtbWFyeVdvcmQiLCJnZW5lcmljUGF0dGVybnMiLCJpc0dlbmVyaWMiLCJwYXR0ZXJuIiwicmVsZXZhbmNlVGhyZXNob2xkIiwiY2VpbCIsInNlbnRlbmNlU3RhcnRzIiwiZXgiLCJ1bmlxdWVTdGFydHMiLCJzaXplIiwidmFsaWRhdGlvblBhc3NlZCIsImRlZmluaXRpb25Qcm9tcHQiLCJtZWFuaW5nIiwiZXhhbXBsZXNQcm9tcHQiLCJleGFtcGxlc1Jlc3BvbnNlIiwicHJvbXB0RXJyb3IiLCJjb2RlIiwiY2FwaXRhbGl6ZVdvcmQiLCJ2b2NhYnVsYXJ5U2VjdGlvbiIsImZpbmQiLCJzIiwidm9jYWJ1bGFyeVdvcmRzIiwiYnVpbGREaXNjdXNzaW9uUHJvbXB0IiwiZGVzY3JpcHRpb24iLCJxdWVzdGlvblR5cGVzIiwic3RydWN0dXJlcyIsInJlc3BvbnNlRXhwZWN0YXRpb24iLCJsZXZlbENvbmZpZyIsInR5cGUiLCJzdHJ1Y3QiLCJnZXREaXNjdXNzaW9uRXhhbXBsZXMiLCJ2YWxpZGF0ZURpc2N1c3Npb25RdWVzdGlvbnMiLCJxdWVzdGlvbiIsInF1ZXN0aW9uTG93ZXIiLCJxdWVzdGlvbldvcmRzIiwic3RhcnRzV2l0aFF1ZXN0aW9uV29yZCIsInN0YXJ0c1dpdGgiLCJjb21wbGV4aXR5Q2hlY2siLCJjaGVja1F1ZXN0aW9uQ29tcGxleGl0eSIsImlzQXBwcm9wcmlhdGUiLCJleHRlbmRlZFJlc3BvbnNlQ2hlY2siLCJjaGVja0V4dGVuZGVkUmVzcG9uc2VQb3RlbnRpYWwiLCJlbmNvdXJhZ2VzRXh0ZW5kZWQiLCJxdWVzdGlvblN0YXJ0cyIsInEiLCJoYXNSZWxldmFuY2UiLCJjaGVja0Rpc2N1c3Npb25SZWxldmFuY2UiLCJpc1llc05vUXVlc3Rpb24iLCJvcGVuRW5kZWRTdGFydGVycyIsImV4cGVjdGVkU3RhcnRlcnMiLCJoYXNPcGVuRW5kZWRTdGFydGVyIiwic3RhcnRlciIsImFuYWx5dGljYWxXb3JkcyIsImhhc0FuYWx5dGljYWxMYW5ndWFnZSIsIm9waW5pb25Xb3JkcyIsImhhc09waW5pb25MYW5ndWFnZSIsImNvbXBsZXhpdHlJbmRpY2F0b3JzIiwibWluV29yZHMiLCJtYXhXb3JkcyIsImV4cGVjdGVkUGF0dGVybnMiLCJhdm9pZFBhdHRlcm5zIiwiaW5kaWNhdG9ycyIsImhhc0F2b2lkUGF0dGVybiIsImNvbXBsZXhQYXR0ZXJucyIsImhhc0NvbXBsZXhQYXR0ZXJuIiwicmVsZXZhbnRDb3VudCIsImhhc1ZvY2FiS2V5d29yZCIsInJlcGFpckluY29tcGxldGVKU09OIiwianNvblN0ciIsInJlcGFpcmVkIiwib3BlbkJyYWNlcyIsIm1hdGNoIiwiY2xvc2VCcmFjZXMiLCJvcGVuQnJhY2tldHMiLCJjbG9zZUJyYWNrZXRzIiwicXVvdGVDb3VudCIsImJ1aWxkR3JhbW1hclByb21wdCIsImxldmVsUG9pbnRzIiwidmFsaWRhdGVHcmFtbWFyU2VjdGlvbiIsImdyYW1tYXJEYXRhIiwiZ3JhbW1hclBvaW50IiwiZXhwbGFuYXRpb24iLCJmb3JtIiwidXNhZ2UiLCJmb3JFYWNoIiwiaW5kZXgiLCJleGVyY2lzZXMiLCJleGVyY2lzZSIsImFuc3dlciIsImhhc0NvbnRleHR1YWxSZWxldmFuY2UiLCJjbGVhblJlc3BvbnNlIiwianNvbk1hdGNoIiwiSlNPTiIsInBhcnNlIiwicGFyc2VFcnIiLCJwYXJzZUVycm9yIiwiZ3JhbW1hclNlY3Rpb24iLCJydWxlIiwiZm9jdXMiLCJwYXJzZVByb251bmNpYXRpb25Xb3JkUmVzcG9uc2UiLCJsaW5lcyIsInJlc3VsdCIsImlwYSIsImRpZmZpY3VsdFNvdW5kcyIsInRpcHMiLCJwcmFjdGljZVNlbnRlbmNlIiwic291bmRzIiwidGlwIiwiaW5kZXhPZiIsInBhcnNlVG9uZ3VlVHdpc3RlclJlc3BvbnNlIiwidHdpc3RlcnMiLCJjdXJyZW50VHdpc3RlciIsImN1cnJlbnRJbmRleCIsInR3aXN0ZXJNYXRjaCIsInBhcnNlSW50IiwidGV4dCIsInRhcmdldFNvdW5kcyIsImRpZmZpY3VsdHkiLCJzb3VuZHNNYXRjaCIsImRpZmZpY3VsdHlNYXRjaCIsInQiLCJzZWxlY3RDaGFsbGVuZ2luZ1dvcmRzIiwiY291bnQiLCJzY29yZWRXb3JkcyIsImNoYWxsZW5naW5nU291bmRzIiwiY29uc29uYW50UGF0dGVybnMiLCJzb3VuZCIsIndlaWdodCIsIm1hdGNoZXMiLCJ2b3dlbFBhdHRlcm5zIiwiZW5kaW5nUGF0dGVybnMiLCJzaWxlbnRMZXR0ZXJQYXR0ZXJucyIsImNsdXN0ZXJQYXR0ZXJucyIsInNvcnRlZFdvcmRzIiwic29ydCIsImEiLCJiIiwic2VsZWN0ZWRXb3JkcyIsInNlbGVjdGVkU291bmRzIiwibmV3U291bmRzIiwiaGFzIiwiYWRkIiwicmVtYWluaW5nIiwiYnVpbGRQcm9udW5jaWF0aW9uV29yZFByb21wdCIsImNvbnRleHRTdW1tYXJ5IiwicmVsYXRlZFdvcmRzIiwiYnVpbGRUb25ndWVUd2lzdGVyUHJvbXB0IiwidGFyZ2V0V29yZHMiLCJ2YWxpZGF0ZVByb251bmNpYXRpb25TZWN0aW9uIiwidG9uZ3VlVHdpc3RlcnMiLCJtaW5Ub25ndWVUd2lzdGVycyIsIndvcmROdW0iLCJoYXNBY3Rpb25hYmxlVGlwcyIsInNlbnRlbmNlTG93ZXIiLCJpc0Zyb21Wb2NhYnVsYXJ5IiwidiIsInR3aXN0ZXIiLCJ0d2lzdGVyTnVtIiwidHdpc3Rlckxvd2VyIiwiaGFzVG9waWNSZWxldmFuY2UiLCJhbGxEaWZmaWN1bHRTb3VuZHMiLCJwcm9udW5jaWF0aW9uV29yZHMiLCJ3b3JkUHJvbXB0Iiwid29yZFJlc3BvbnNlIiwid29yZERhdGEiLCJzdHJpbmdpZnkiLCJoYXNXb3JkIiwiaGFzSXBhIiwiaGFzVGlwcyIsInRpcHNMZW5ndGgiLCJoYXNQcmFjdGljZSIsInR3aXN0ZXJQcm9tcHQiLCJ0d2lzdGVyUmVzcG9uc2UiLCJwcm9udW5jaWF0aW9uU2VjdGlvbiIsImJ1aWxkRGlhbG9ndWVQcm9tcHQiLCJsZXZlbENvbXBsZXhpdHlJbnN0cnVjdGlvbnMiLCJzZW50ZW5jZUxlbmd0aCIsInZvY2FiSW5zdHJ1Y3Rpb24iLCJ2YWxpZGF0ZURpYWxvZ3VlIiwiZGlhbG9ndWVMaW5lcyIsIm1pbkxpbmVzIiwiY2hhcmFjdGVyIiwidG9vU2hvcnRDb3VudCIsInRvb0xvbmdDb3VudCIsInZvY2FidWxhcnlDb21wbGV4aXR5Q2hlY2siLCJjaGVja1ZvY2FidWxhcnlDb21wbGV4aXR5IiwiZ3JhbW1hckNvbXBsZXhpdHlDaGVjayIsImNoZWNrR3JhbW1hckNvbXBsZXhpdHkiLCJ2b2NhYkludGVncmF0aW9uQ2hlY2siLCJjaGVja1ZvY2FidWxhcnlJbnRlZ3JhdGlvbiIsImhhc0ludGVncmF0aW9uIiwiZ2FwQ291bnQiLCJhbGxUZXh0IiwiY29tcGxleFdvcmRzIiwiZm91bmRDb21wbGV4V29yZHMiLCJhbGxXb3JkcyIsInZlcnlTaW1wbGVXb3JkcyIsInNpbXBsZVdvcmRDb3VudCIsInNpbXBsZVdvcmRSYXRpbyIsImhhc0NvbXBsZXhHcmFtbWFyIiwiaW50ZWdyYXRlZFdvcmRzIiwiZ2VuZXJhdGVEaWFsb2d1ZVByYWN0aWNlV2l0aENvbnRleHQiLCJzcGVha2VyIiwiZm9sbG93VXBQcm9tcHQiLCJmb2xsb3dVcFJlc3BvbnNlIiwiZm9sbG93VXBRdWVzdGlvbnMiLCJmb3JtYXR0ZWREaWFsb2d1ZSIsImdlbmVyYXRlRGlhbG9ndWVGaWxsR2FwV2l0aENvbnRleHQiLCJhbnN3ZXJzIiwiaGFzR2FwIiwiaXNHYXAiLCJhbnN3ZXJzUHJvbXB0IiwiYW5zd2Vyc1Jlc3BvbnNlIiwiZXh0cmFjdGVkQW5zd2VycyIsIl9zdHVkZW50TGV2ZWwiLCJjb21tb25Xb3JkcyIsImZpbHRlcmVkV29yZHMiLCJhcnIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/progressive-generator.ts\n");

/***/ }),

/***/ "(rsc)/./lib/quality-metrics.ts":
/*!********************************!*\
  !*** ./lib/quality-metrics.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   QualityMetricsTracker: () => (/* binding */ QualityMetricsTracker),\n/* harmony export */   qualityMetricsTracker: () => (/* binding */ qualityMetricsTracker)\n/* harmony export */ });\n/**\r\n * Quality Metrics Tracker\r\n * \r\n * Tracks quality metrics for each lesson section during generation\r\n */ class QualityMetricsTracker {\n    /**\r\n   * Record metrics for a section\r\n   */ recordSection(sectionName, validationScore, attemptCount, generationTimeMs, issueCount, warningCount) {\n        this.metrics.set(sectionName, {\n            sectionName,\n            validationScore,\n            attemptCount,\n            generationTimeMs,\n            issueCount,\n            warningCount,\n            regenerated: attemptCount > 1\n        });\n        console.log(` Quality metrics for ${sectionName}:`, {\n            score: validationScore,\n            attempts: attemptCount,\n            time: `${generationTimeMs}ms`,\n            issues: issueCount,\n            warnings: warningCount\n        });\n    }\n    /**\r\n   * Get metrics for a specific section\r\n   */ getSectionMetrics(sectionName) {\n        return this.metrics.get(sectionName);\n    }\n    /**\r\n   * Get all section metrics\r\n   */ getAllMetrics() {\n        return Array.from(this.metrics.values());\n    }\n    /**\r\n   * Calculate overall lesson quality score\r\n   */ calculateOverallScore() {\n        const sections = this.getAllMetrics();\n        if (sections.length === 0) return 0;\n        const totalScore = sections.reduce((sum, section)=>sum + section.validationScore, 0);\n        return Math.round(totalScore / sections.length);\n    }\n    /**\r\n   * Get total regeneration count\r\n   */ getTotalRegenerations() {\n        return this.getAllMetrics().filter((s)=>s.regenerated).length;\n    }\n    /**\r\n   * Get complete lesson quality report\r\n   */ getQualityReport() {\n        const sections = this.getAllMetrics();\n        const totalTime = Date.now() - this.startTime;\n        return {\n            overallScore: this.calculateOverallScore(),\n            sections,\n            totalGenerationTimeMs: totalTime,\n            totalRegenerations: this.getTotalRegenerations(),\n            timestamp: new Date().toISOString()\n        };\n    }\n    /**\r\n   * Log quality summary\r\n   */ logSummary() {\n        const report = this.getQualityReport();\n        console.log(\"\\n\" + \"=\".repeat(60));\n        console.log(\"\\uD83D\\uDCCA LESSON QUALITY REPORT\");\n        console.log(\"=\".repeat(60));\n        console.log(`Overall Quality Score: ${report.overallScore}/100`);\n        console.log(`Total Generation Time: ${(report.totalGenerationTimeMs / 1000).toFixed(2)}s`);\n        console.log(`Total Regenerations: ${report.totalRegenerations}`);\n        console.log(\"\\nSection Breakdown:\");\n        report.sections.forEach((section)=>{\n            const status = section.regenerated ? \"\\uD83D\\uDD04\" : \"\";\n            console.log(`  ${status} ${section.sectionName}: ${section.validationScore}/100 (${section.attemptCount} attempts, ${section.issueCount} issues, ${section.warningCount} warnings)`);\n        });\n        console.log(\"=\".repeat(60) + \"\\n\");\n    }\n    /**\r\n   * Reset metrics for new lesson generation\r\n   */ reset() {\n        this.metrics.clear();\n        this.startTime = Date.now();\n    }\n    constructor(){\n        this.metrics = new Map();\n        this.startTime = Date.now();\n    }\n}\n// Export singleton instance\nconst qualityMetricsTracker = new QualityMetricsTracker();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxFQUFFNEIsUUFBUTNCLGVBQWUsQ0FBQyxNQUFNLEVBQUUyQixRQUFRMUIsWUFBWSxDQUFDLFdBQVcsRUFBRTBCLFFBQVF4QixVQUFVLENBQUMsU0FBUyxFQUFFd0IsUUFBUXZCLFlBQVksQ0FBQyxVQUFVLENBQUM7UUFDckw7UUFFQUksUUFBUUMsR0FBRyxDQUFDLElBQUlvQyxNQUFNLENBQUMsTUFBTTtJQUMvQjtJQUVBOztHQUVDLEdBQ0RJLFFBQWM7UUFDWixJQUFJLENBQUM1QyxPQUFPLENBQUM2QyxLQUFLO1FBQ2xCLElBQUksQ0FBQ2IsU0FBUyxHQUFHRixLQUFLQyxHQUFHO0lBQzNCOzthQTdHUS9CLFVBQXVDLElBQUk4QzthQUMzQ2QsWUFBb0JGLEtBQUtDLEdBQUc7O0FBNkd0QztBQUVBLDRCQUE0QjtBQUNyQixNQUFNZ0Isd0JBQXdCLElBQUl2RCx3QkFBdUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL3F1YWxpdHktbWV0cmljcy50cz9mOWFlIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBRdWFsaXR5IE1ldHJpY3MgVHJhY2tlclxyXG4gKiBcclxuICogVHJhY2tzIHF1YWxpdHkgbWV0cmljcyBmb3IgZWFjaCBsZXNzb24gc2VjdGlvbiBkdXJpbmcgZ2VuZXJhdGlvblxyXG4gKi9cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2VjdGlvbk1ldHJpY3Mge1xyXG4gIHNlY3Rpb25OYW1lOiBzdHJpbmdcclxuICB2YWxpZGF0aW9uU2NvcmU6IG51bWJlclxyXG4gIGF0dGVtcHRDb3VudDogbnVtYmVyXHJcbiAgZ2VuZXJhdGlvblRpbWVNczogbnVtYmVyXHJcbiAgaXNzdWVDb3VudDogbnVtYmVyXHJcbiAgd2FybmluZ0NvdW50OiBudW1iZXJcclxuICByZWdlbmVyYXRlZDogYm9vbGVhblxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIExlc3NvblF1YWxpdHlNZXRyaWNzIHtcclxuICBvdmVyYWxsU2NvcmU6IG51bWJlclxyXG4gIHNlY3Rpb25zOiBTZWN0aW9uTWV0cmljc1tdXHJcbiAgdG90YWxHZW5lcmF0aW9uVGltZU1zOiBudW1iZXJcclxuICB0b3RhbFJlZ2VuZXJhdGlvbnM6IG51bWJlclxyXG4gIHRpbWVzdGFtcDogc3RyaW5nXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBRdWFsaXR5TWV0cmljc1RyYWNrZXIge1xyXG4gIHByaXZhdGUgbWV0cmljczogTWFwPHN0cmluZywgU2VjdGlvbk1ldHJpY3M+ID0gbmV3IE1hcCgpXHJcbiAgcHJpdmF0ZSBzdGFydFRpbWU6IG51bWJlciA9IERhdGUubm93KClcclxuXHJcbiAgLyoqXHJcbiAgICogUmVjb3JkIG1ldHJpY3MgZm9yIGEgc2VjdGlvblxyXG4gICAqL1xyXG4gIHJlY29yZFNlY3Rpb24oXHJcbiAgICBzZWN0aW9uTmFtZTogc3RyaW5nLFxyXG4gICAgdmFsaWRhdGlvblNjb3JlOiBudW1iZXIsXHJcbiAgICBhdHRlbXB0Q291bnQ6IG51bWJlcixcclxuICAgIGdlbmVyYXRpb25UaW1lTXM6IG51bWJlcixcclxuICAgIGlzc3VlQ291bnQ6IG51bWJlcixcclxuICAgIHdhcm5pbmdDb3VudDogbnVtYmVyXHJcbiAgKTogdm9pZCB7XHJcbiAgICB0aGlzLm1ldHJpY3Muc2V0KHNlY3Rpb25OYW1lLCB7XHJcbiAgICAgIHNlY3Rpb25OYW1lLFxyXG4gICAgICB2YWxpZGF0aW9uU2NvcmUsXHJcbiAgICAgIGF0dGVtcHRDb3VudCxcclxuICAgICAgZ2VuZXJhdGlvblRpbWVNcyxcclxuICAgICAgaXNzdWVDb3VudCxcclxuICAgICAgd2FybmluZ0NvdW50LFxyXG4gICAgICByZWdlbmVyYXRlZDogYXR0ZW1wdENvdW50ID4gMVxyXG4gICAgfSlcclxuXHJcbiAgICBjb25zb2xlLmxvZyhg8J+TiiBRdWFsaXR5IG1ldHJpY3MgZm9yICR7c2VjdGlvbk5hbWV9OmAsIHtcclxuICAgICAgc2NvcmU6IHZhbGlkYXRpb25TY29yZSxcclxuICAgICAgYXR0ZW1wdHM6IGF0dGVtcHRDb3VudCxcclxuICAgICAgdGltZTogYCR7Z2VuZXJhdGlvblRpbWVNc31tc2AsXHJcbiAgICAgIGlzc3VlczogaXNzdWVDb3VudCxcclxuICAgICAgd2FybmluZ3M6IHdhcm5pbmdDb3VudFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBtZXRyaWNzIGZvciBhIHNwZWNpZmljIHNlY3Rpb25cclxuICAgKi9cclxuICBnZXRTZWN0aW9uTWV0cmljcyhzZWN0aW9uTmFtZTogc3RyaW5nKTogU2VjdGlvbk1ldHJpY3MgfCB1bmRlZmluZWQge1xyXG4gICAgcmV0dXJuIHRoaXMubWV0cmljcy5nZXQoc2VjdGlvbk5hbWUpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWxsIHNlY3Rpb24gbWV0cmljc1xyXG4gICAqL1xyXG4gIGdldEFsbE1ldHJpY3MoKTogU2VjdGlvbk1ldHJpY3NbXSB7XHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLm1ldHJpY3MudmFsdWVzKCkpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDYWxjdWxhdGUgb3ZlcmFsbCBsZXNzb24gcXVhbGl0eSBzY29yZVxyXG4gICAqL1xyXG4gIGNhbGN1bGF0ZU92ZXJhbGxTY29yZSgpOiBudW1iZXIge1xyXG4gICAgY29uc3Qgc2VjdGlvbnMgPSB0aGlzLmdldEFsbE1ldHJpY3MoKVxyXG4gICAgaWYgKHNlY3Rpb25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDBcclxuXHJcbiAgICBjb25zdCB0b3RhbFNjb3JlID0gc2VjdGlvbnMucmVkdWNlKChzdW0sIHNlY3Rpb24pID0+IHN1bSArIHNlY3Rpb24udmFsaWRhdGlvblNjb3JlLCAwKVxyXG4gICAgcmV0dXJuIE1hdGgucm91bmQodG90YWxTY29yZSAvIHNlY3Rpb25zLmxlbmd0aClcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB0b3RhbCByZWdlbmVyYXRpb24gY291bnRcclxuICAgKi9cclxuICBnZXRUb3RhbFJlZ2VuZXJhdGlvbnMoKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLmdldEFsbE1ldHJpY3MoKS5maWx0ZXIocyA9PiBzLnJlZ2VuZXJhdGVkKS5sZW5ndGhcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBjb21wbGV0ZSBsZXNzb24gcXVhbGl0eSByZXBvcnRcclxuICAgKi9cclxuICBnZXRRdWFsaXR5UmVwb3J0KCk6IExlc3NvblF1YWxpdHlNZXRyaWNzIHtcclxuICAgIGNvbnN0IHNlY3Rpb25zID0gdGhpcy5nZXRBbGxNZXRyaWNzKClcclxuICAgIGNvbnN0IHRvdGFsVGltZSA9IERhdGUubm93KCkgLSB0aGlzLnN0YXJ0VGltZVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIG92ZXJhbGxTY29yZTogdGhpcy5jYWxjdWxhdGVPdmVyYWxsU2NvcmUoKSxcclxuICAgICAgc2VjdGlvbnMsXHJcbiAgICAgIHRvdGFsR2VuZXJhdGlvblRpbWVNczogdG90YWxUaW1lLFxyXG4gICAgICB0b3RhbFJlZ2VuZXJhdGlvbnM6IHRoaXMuZ2V0VG90YWxSZWdlbmVyYXRpb25zKCksXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBMb2cgcXVhbGl0eSBzdW1tYXJ5XHJcbiAgICovXHJcbiAgbG9nU3VtbWFyeSgpOiB2b2lkIHtcclxuICAgIGNvbnN0IHJlcG9ydCA9IHRoaXMuZ2V0UXVhbGl0eVJlcG9ydCgpXHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKCdcXG4nICsgJz0nLnJlcGVhdCg2MCkpXHJcbiAgICBjb25zb2xlLmxvZygn8J+TiiBMRVNTT04gUVVBTElUWSBSRVBPUlQnKVxyXG4gICAgY29uc29sZS5sb2coJz0nLnJlcGVhdCg2MCkpXHJcbiAgICBjb25zb2xlLmxvZyhgT3ZlcmFsbCBRdWFsaXR5IFNjb3JlOiAke3JlcG9ydC5vdmVyYWxsU2NvcmV9LzEwMGApXHJcbiAgICBjb25zb2xlLmxvZyhgVG90YWwgR2VuZXJhdGlvbiBUaW1lOiAkeyhyZXBvcnQudG90YWxHZW5lcmF0aW9uVGltZU1zIC8gMTAwMCkudG9GaXhlZCgyKX1zYClcclxuICAgIGNvbnNvbGUubG9nKGBUb3RhbCBSZWdlbmVyYXRpb25zOiAke3JlcG9ydC50b3RhbFJlZ2VuZXJhdGlvbnN9YClcclxuICAgIGNvbnNvbGUubG9nKCdcXG5TZWN0aW9uIEJyZWFrZG93bjonKVxyXG4gICAgXHJcbiAgICByZXBvcnQuc2VjdGlvbnMuZm9yRWFjaChzZWN0aW9uID0+IHtcclxuICAgICAgY29uc3Qgc3RhdHVzID0gc2VjdGlvbi5yZWdlbmVyYXRlZCA/ICfwn5SEJyA6ICfinIUnXHJcbiAgICAgIGNvbnNvbGUubG9nKGAgICR7c3RhdHVzfSAke3NlY3Rpb24uc2VjdGlvbk5hbWV9OiAke3NlY3Rpb24udmFsaWRhdGlvblNjb3JlfS8xMDAgKCR7c2VjdGlvbi5hdHRlbXB0Q291bnR9IGF0dGVtcHRzLCAke3NlY3Rpb24uaXNzdWVDb3VudH0gaXNzdWVzLCAke3NlY3Rpb24ud2FybmluZ0NvdW50fSB3YXJuaW5ncylgKVxyXG4gICAgfSlcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJz0nLnJlcGVhdCg2MCkgKyAnXFxuJylcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc2V0IG1ldHJpY3MgZm9yIG5ldyBsZXNzb24gZ2VuZXJhdGlvblxyXG4gICAqL1xyXG4gIHJlc2V0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5tZXRyaWNzLmNsZWFyKClcclxuICAgIHRoaXMuc3RhcnRUaW1lID0gRGF0ZS5ub3coKVxyXG4gIH1cclxufVxyXG5cclxuLy8gRXhwb3J0IHNpbmdsZXRvbiBpbnN0YW5jZVxyXG5leHBvcnQgY29uc3QgcXVhbGl0eU1ldHJpY3NUcmFja2VyID0gbmV3IFF1YWxpdHlNZXRyaWNzVHJhY2tlcigpXHJcbiJdLCJuYW1lcyI6WyJRdWFsaXR5TWV0cmljc1RyYWNrZXIiLCJyZWNvcmRTZWN0aW9uIiwic2VjdGlvbk5hbWUiLCJ2YWxpZGF0aW9uU2NvcmUiLCJhdHRlbXB0Q291bnQiLCJnZW5lcmF0aW9uVGltZU1zIiwiaXNzdWVDb3VudCIsIndhcm5pbmdDb3VudCIsIm1ldHJpY3MiLCJzZXQiLCJyZWdlbmVyYXRlZCIsImNvbnNvbGUiLCJsb2ciLCJzY29yZSIsImF0dGVtcHRzIiwidGltZSIsImlzc3VlcyIsIndhcm5pbmdzIiwiZ2V0U2VjdGlvbk1ldHJpY3MiLCJnZXQiLCJnZXRBbGxNZXRyaWNzIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIiwiY2FsY3VsYXRlT3ZlcmFsbFNjb3JlIiwic2VjdGlvbnMiLCJsZW5ndGgiLCJ0b3RhbFNjb3JlIiwicmVkdWNlIiwic3VtIiwic2VjdGlvbiIsIk1hdGgiLCJyb3VuZCIsImdldFRvdGFsUmVnZW5lcmF0aW9ucyIsImZpbHRlciIsInMiLCJnZXRRdWFsaXR5UmVwb3J0IiwidG90YWxUaW1lIiwiRGF0ZSIsIm5vdyIsInN0YXJ0VGltZSIsIm92ZXJhbGxTY29yZSIsInRvdGFsR2VuZXJhdGlvblRpbWVNcyIsInRvdGFsUmVnZW5lcmF0aW9ucyIsInRpbWVzdGFtcCIsInRvSVNPU3RyaW5nIiwibG9nU3VtbWFyeSIsInJlcG9ydCIsInJlcGVhdCIsInRvRml4ZWQiLCJmb3JFYWNoIiwic3RhdHVzIiwicmVzZXQiLCJjbGVhciIsIk1hcCIsInF1YWxpdHlNZXRyaWNzVHJhY2tlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/quality-metrics.ts\n");

/***/ }),

/***/ "(rsc)/./lib/section-validators.ts":
/*!***********************************!*\
  !*** ./lib/section-validators.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DialogueValidator: () => (/* binding */ DialogueValidator),\n/* harmony export */   DiscussionValidator: () => (/* binding */ DiscussionValidator),\n/* harmony export */   GrammarValidator: () => (/* binding */ GrammarValidator),\n/* harmony export */   PronunciationValidator: () => (/* binding */ PronunciationValidator),\n/* harmony export */   dialogueValidator: () => (/* binding */ dialogueValidator),\n/* harmony export */   discussionValidator: () => (/* binding */ discussionValidator),\n/* harmony export */   grammarValidator: () => (/* binding */ grammarValidator),\n/* harmony export */   pronunciationValidator: () => (/* binding */ pronunciationValidator)\n/* harmony export */ });\n/**\r\n * Section Validators\r\n * \r\n * Comprehensive validation for all lesson sections to ensure quality standards\r\n */ /**\r\n * Dialogue Section Validator\r\n */ class DialogueValidator {\n    validate(dialogueLines, cefrLevel, vocabularyWords) {\n        const issues = [];\n        const warnings = [];\n        // Validate line count\n        if (dialogueLines.length < this.MIN_DIALOGUE_LINES) {\n            issues.push({\n                type: \"count_error\",\n                severity: \"error\",\n                message: `Insufficient dialogue lines: expected at least ${this.MIN_DIALOGUE_LINES}, got ${dialogueLines.length}`,\n                suggestion: \"Generate more dialogue lines\"\n            });\n        }\n        // Validate complexity matches CEFR level\n        this.validateComplexity(dialogueLines, cefrLevel, issues, warnings);\n        // Validate vocabulary integration\n        this.validateVocabularyIntegration(dialogueLines, vocabularyWords, warnings);\n        // Validate natural flow\n        this.validateNaturalFlow(dialogueLines, warnings);\n        const score = this.calculateScore(issues, warnings, dialogueLines.length);\n        return {\n            isValid: issues.length === 0,\n            issues,\n            warnings,\n            score\n        };\n    }\n    validateComplexity(lines, cefrLevel, issues, warnings) {\n        const complexityRanges = {\n            \"A1\": {\n                minWords: 3,\n                maxWords: 8\n            },\n            \"A2\": {\n                minWords: 5,\n                maxWords: 12\n            },\n            \"B1\": {\n                minWords: 8,\n                maxWords: 15\n            },\n            \"B2\": {\n                minWords: 10,\n                maxWords: 20\n            },\n            \"C1\": {\n                minWords: 12,\n                maxWords: 25\n            }\n        };\n        const range = complexityRanges[cefrLevel];\n        lines.forEach((line, index)=>{\n            const wordCount = line.text.split(/\\s+/).length;\n            if (wordCount < range.minWords) {\n                warnings.push({\n                    type: \"complexity_mismatch\",\n                    severity: \"warning\",\n                    message: `Line ${index + 1} too short for ${cefrLevel} (${wordCount} words)`,\n                    itemIndex: index,\n                    suggestion: `Lines should be ${range.minWords}-${range.maxWords} words`\n                });\n            }\n        });\n    }\n    validateVocabularyIntegration(lines, vocabularyWords, warnings) {\n        const allText = lines.map((l)=>l.text.toLowerCase()).join(\" \");\n        const usedVocab = vocabularyWords.filter((word)=>allText.includes(word.toLowerCase()));\n        if (usedVocab.length < Math.min(3, vocabularyWords.length)) {\n            warnings.push({\n                type: \"vocabulary_integration\",\n                severity: \"warning\",\n                message: `Only ${usedVocab.length} vocabulary words used in dialogue`,\n                suggestion: \"Integrate more lesson vocabulary into dialogue\"\n            });\n        }\n    }\n    validateNaturalFlow(lines, warnings) {\n        // Check for speaker alternation\n        for(let i = 1; i < lines.length; i++){\n            if (lines[i].speaker === lines[i - 1].speaker) {\n                warnings.push({\n                    type: \"flow_issue\",\n                    severity: \"warning\",\n                    message: `Same speaker has consecutive lines at position ${i}`,\n                    itemIndex: i,\n                    suggestion: \"Alternate speakers for natural conversation flow\"\n                });\n                break; // Only report once\n            }\n        }\n    }\n    calculateScore(issues, warnings, lineCount) {\n        let score = 100;\n        score -= issues.length * 20;\n        score -= warnings.length * 5;\n        if (lineCount >= this.MIN_DIALOGUE_LINES) score += 10;\n        return Math.max(0, Math.min(100, score));\n    }\n    constructor(){\n        this.MIN_DIALOGUE_LINES = 12;\n    }\n}\n/**\r\n * Discussion Questions Validator\r\n */ class DiscussionValidator {\n    validate(questions, cefrLevel) {\n        const issues = [];\n        const warnings = [];\n        // Validate question count\n        if (questions.length !== this.REQUIRED_QUESTION_COUNT) {\n            issues.push({\n                type: \"count_error\",\n                severity: \"error\",\n                message: `Expected exactly ${this.REQUIRED_QUESTION_COUNT} questions, got ${questions.length}`,\n                suggestion: `Generate exactly ${this.REQUIRED_QUESTION_COUNT} questions`\n            });\n        }\n        // Validate question format\n        questions.forEach((question, index)=>{\n            if (!question.endsWith(\"?\")) {\n                issues.push({\n                    type: \"format_error\",\n                    severity: \"error\",\n                    message: `Question ${index + 1} doesn't end with question mark`,\n                    itemIndex: index\n                });\n            }\n            if (question.length < 10) {\n                issues.push({\n                    type: \"format_error\",\n                    severity: \"error\",\n                    message: `Question ${index + 1} too short`,\n                    itemIndex: index\n                });\n            }\n        });\n        // Validate complexity matches CEFR level\n        this.validateQuestionComplexity(questions, cefrLevel, issues, warnings);\n        // Validate question variety\n        this.validateQuestionVariety(questions, warnings);\n        const score = this.calculateScore(issues, warnings, questions.length);\n        return {\n            isValid: issues.length === 0,\n            issues,\n            warnings,\n            score\n        };\n    }\n    validateQuestionComplexity(questions, cefrLevel, issues, warnings) {\n        const expectedTypes = {\n            \"A1\": [\n                \"simple\",\n                \"factual\"\n            ],\n            \"A2\": [\n                \"simple\",\n                \"factual\"\n            ],\n            \"B1\": [\n                \"opinion\",\n                \"comparison\"\n            ],\n            \"B2\": [\n                \"analytical\",\n                \"evaluative\"\n            ],\n            \"C1\": [\n                \"analytical\",\n                \"evaluative\",\n                \"hypothetical\"\n            ]\n        };\n        const allText = questions.join(\" \").toLowerCase();\n        // Check for appropriate question types\n        if ([\n            \"B2\",\n            \"C1\"\n        ].includes(cefrLevel)) {\n            const hasAnalytical = /why do you think|what factors|how might|to what extent|in what ways/.test(allText);\n            if (!hasAnalytical) {\n                warnings.push({\n                    type: \"complexity_mismatch\",\n                    severity: \"warning\",\n                    message: `Questions lack analytical depth for ${cefrLevel} level`,\n                    suggestion: \"Include more analytical or evaluative questions\"\n                });\n            }\n        }\n        if ([\n            \"A1\",\n            \"A2\"\n        ].includes(cefrLevel)) {\n            const hasTooComplex = /hypothetically|analyze|evaluate|implications/.test(allText);\n            if (hasTooComplex) {\n                warnings.push({\n                    type: \"complexity_mismatch\",\n                    severity: \"warning\",\n                    message: `Questions may be too complex for ${cefrLevel} level`,\n                    suggestion: \"Use simpler question structures\"\n                });\n            }\n        }\n    }\n    validateQuestionVariety(questions, warnings) {\n        const starters = questions.map((q)=>q.trim().split(\" \")[0].toLowerCase());\n        const uniqueStarters = new Set(starters);\n        if (uniqueStarters.size < 3) {\n            warnings.push({\n                type: \"variety_issue\",\n                severity: \"warning\",\n                message: \"Limited question variety\",\n                suggestion: \"Use different question types (What, Why, How, etc.)\"\n            });\n        }\n    }\n    calculateScore(issues, warnings, questionCount) {\n        let score = 100;\n        score -= issues.length * 20;\n        score -= warnings.length * 5;\n        if (questionCount === this.REQUIRED_QUESTION_COUNT) score += 10;\n        return Math.max(0, Math.min(100, score));\n    }\n    constructor(){\n        this.REQUIRED_QUESTION_COUNT = 5;\n    }\n}\n/**\r\n * Grammar Section Validator\r\n */ class GrammarValidator {\n    validate(grammarSection, cefrLevel) {\n        const issues = [];\n        const warnings = [];\n        // Validate completeness\n        if (!grammarSection.rule || grammarSection.rule.length < 10) {\n            issues.push({\n                type: \"completeness_error\",\n                severity: \"error\",\n                message: \"Grammar rule explanation missing or too short\",\n                suggestion: \"Provide clear explanation of the grammar rule\"\n            });\n        }\n        if (!grammarSection.form || grammarSection.form.length < 10) {\n            issues.push({\n                type: \"completeness_error\",\n                severity: \"error\",\n                message: \"Grammar form explanation missing or too short\",\n                suggestion: \"Explain the grammatical form\"\n            });\n        }\n        if (!grammarSection.usage || grammarSection.usage.length < 10) {\n            issues.push({\n                type: \"completeness_error\",\n                severity: \"error\",\n                message: \"Grammar usage explanation missing or too short\",\n                suggestion: \"Explain when and how to use this grammar\"\n            });\n        }\n        // Validate examples\n        if (!grammarSection.examples || grammarSection.examples.length < 3) {\n            issues.push({\n                type: \"completeness_error\",\n                severity: \"error\",\n                message: \"Insufficient example sentences\",\n                suggestion: \"Provide at least 3 example sentences\"\n            });\n        }\n        // Validate exercises\n        if (!grammarSection.exercises || grammarSection.exercises.length < this.MIN_EXERCISES) {\n            issues.push({\n                type: \"count_error\",\n                severity: \"error\",\n                message: `Insufficient exercises: expected at least ${this.MIN_EXERCISES}, got ${grammarSection.exercises?.length || 0}`,\n                suggestion: `Provide at least ${this.MIN_EXERCISES} practice exercises`\n            });\n        }\n        // Validate exercise quality\n        if (grammarSection.exercises) {\n            grammarSection.exercises.forEach((exercise, index)=>{\n                if (!exercise.prompt || exercise.prompt.length < 5) {\n                    issues.push({\n                        type: \"quality_issue\",\n                        severity: \"error\",\n                        message: `Exercise ${index + 1} has invalid prompt`,\n                        itemIndex: index\n                    });\n                }\n                if (!exercise.answer || exercise.answer.length < 1) {\n                    issues.push({\n                        type: \"quality_issue\",\n                        severity: \"error\",\n                        message: `Exercise ${index + 1} missing answer`,\n                        itemIndex: index\n                    });\n                }\n            });\n        }\n        const score = this.calculateScore(issues, warnings, grammarSection.exercises?.length || 0);\n        return {\n            isValid: issues.length === 0,\n            issues,\n            warnings,\n            score\n        };\n    }\n    calculateScore(issues, warnings, exerciseCount) {\n        let score = 100;\n        score -= issues.length * 15;\n        score -= warnings.length * 5;\n        if (exerciseCount >= this.MIN_EXERCISES) score += 10;\n        return Math.max(0, Math.min(100, score));\n    }\n    constructor(){\n        this.MIN_EXERCISES = 5;\n    }\n}\n/**\r\n * Pronunciation Section Validator\r\n */ class PronunciationValidator {\n    validate(pronunciationSection) {\n        const issues = [];\n        const warnings = [];\n        // Validate word count\n        if (!pronunciationSection.words || pronunciationSection.words.length < this.MIN_WORDS) {\n            issues.push({\n                type: \"count_error\",\n                severity: \"error\",\n                message: `Insufficient pronunciation words: expected at least ${this.MIN_WORDS}, got ${pronunciationSection.words?.length || 0}`,\n                suggestion: `Include at least ${this.MIN_WORDS} challenging words`\n            });\n        }\n        // Validate tongue twister count\n        if (!pronunciationSection.tongueTwisters || pronunciationSection.tongueTwisters.length < this.MIN_TONGUE_TWISTERS) {\n            issues.push({\n                type: \"count_error\",\n                severity: \"error\",\n                message: `Insufficient tongue twisters: expected at least ${this.MIN_TONGUE_TWISTERS}, got ${pronunciationSection.tongueTwisters?.length || 0}`,\n                suggestion: `Include at least ${this.MIN_TONGUE_TWISTERS} tongue twisters`\n            });\n        }\n        // Validate word completeness\n        if (pronunciationSection.words) {\n            pronunciationSection.words.forEach((wordItem, index)=>{\n                if (!wordItem.word || wordItem.word.length < 2) {\n                    issues.push({\n                        type: \"completeness_error\",\n                        severity: \"error\",\n                        message: `Word ${index + 1} is invalid`,\n                        itemIndex: index\n                    });\n                }\n                if (!wordItem.ipa || wordItem.ipa.length < 2) {\n                    issues.push({\n                        type: \"completeness_error\",\n                        severity: \"error\",\n                        message: `Word ${index + 1} missing IPA transcription`,\n                        itemIndex: index,\n                        suggestion: \"Provide IPA transcription for pronunciation\"\n                    });\n                }\n                if (!wordItem.tips || wordItem.tips.length === 0) {\n                    warnings.push({\n                        type: \"completeness_warning\",\n                        severity: \"warning\",\n                        message: `Word ${index + 1} missing pronunciation tips`,\n                        itemIndex: index,\n                        suggestion: \"Add pronunciation tips for difficult sounds\"\n                    });\n                }\n                if (!wordItem.practiceSentence || wordItem.practiceSentence.length < 10) {\n                    warnings.push({\n                        type: \"completeness_warning\",\n                        severity: \"warning\",\n                        message: `Word ${index + 1} missing practice sentence`,\n                        itemIndex: index,\n                        suggestion: \"Provide practice sentence using the word\"\n                    });\n                }\n            });\n        }\n        // Validate tongue twister completeness\n        if (pronunciationSection.tongueTwisters) {\n            pronunciationSection.tongueTwisters.forEach((twister, index)=>{\n                if (!twister.text || twister.text.length < 15) {\n                    issues.push({\n                        type: \"completeness_error\",\n                        severity: \"error\",\n                        message: `Tongue twister ${index + 1} too short or missing`,\n                        itemIndex: index\n                    });\n                }\n                if (!twister.targetSounds || twister.targetSounds.length === 0) {\n                    warnings.push({\n                        type: \"completeness_warning\",\n                        severity: \"warning\",\n                        message: `Tongue twister ${index + 1} missing target sounds`,\n                        itemIndex: index\n                    });\n                }\n            });\n        }\n        const score = this.calculateScore(issues, warnings, pronunciationSection.words?.length || 0, pronunciationSection.tongueTwisters?.length || 0);\n        return {\n            isValid: issues.length === 0,\n            issues,\n            warnings,\n            score\n        };\n    }\n    calculateScore(issues, warnings, wordCount, twisterCount) {\n        let score = 100;\n        score -= issues.length * 15;\n        score -= warnings.length * 5;\n        if (wordCount >= this.MIN_WORDS) score += 5;\n        if (twisterCount >= this.MIN_TONGUE_TWISTERS) score += 5;\n        return Math.max(0, Math.min(100, score));\n    }\n    constructor(){\n        this.MIN_WORDS = 5;\n        this.MIN_TONGUE_TWISTERS = 2;\n    }\n}\n// Export validator instances\nconst dialogueValidator = new DialogueValidator();\nconst discussionValidator = new DiscussionValidator();\nconst grammarValidator = new GrammarValidator();\nconst pronunciationValidator = new PronunciationValidator();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TSxLQUFLO1lBQUdGO1lBQVFDO1lBQVVXO1FBQU07SUFDakU7SUFFUUMsZUFDTmIsTUFBeUIsRUFDekJDLFFBQTJCLEVBQzNCc0IsU0FBaUIsRUFDakI2RCxZQUFvQixFQUNaO1FBQ1IsSUFBSXhFLFFBQVE7UUFDWkEsU0FBU1osT0FBT0UsTUFBTSxHQUFHO1FBQ3pCVSxTQUFTWCxTQUFTQyxNQUFNLEdBQUc7UUFDM0IsSUFBSXFCLGFBQWEsSUFBSSxDQUFDb0QsU0FBUyxFQUFFL0QsU0FBUztRQUMxQyxJQUFJd0UsZ0JBQWdCLElBQUksQ0FBQ1AsbUJBQW1CLEVBQUVqRSxTQUFTO1FBQ3ZELE9BQU93QixLQUFLSyxHQUFHLENBQUMsR0FBR0wsS0FBS0MsR0FBRyxDQUFDLEtBQUt6QjtJQUNuQzs7YUF6SGlCK0QsWUFBWTthQUNaRSxzQkFBc0I7O0FBeUh6QztBQUVBLDZCQUE2QjtBQUN0QixNQUFNUSxvQkFBb0IsSUFBSTFGLG9CQUFtQjtBQUNqRCxNQUFNMkYsc0JBQXNCLElBQUk1QyxzQkFBcUI7QUFDckQsTUFBTTZDLG1CQUFtQixJQUFJM0IsbUJBQWtCO0FBQy9DLE1BQU00Qix5QkFBeUIsSUFBSWhCLHlCQUF3QiIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvLi9saWIvc2VjdGlvbi12YWxpZGF0b3JzLnRzP2JhNzQiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFNlY3Rpb24gVmFsaWRhdG9yc1xyXG4gKiBcclxuICogQ29tcHJlaGVuc2l2ZSB2YWxpZGF0aW9uIGZvciBhbGwgbGVzc29uIHNlY3Rpb25zIHRvIGVuc3VyZSBxdWFsaXR5IHN0YW5kYXJkc1xyXG4gKi9cclxuXHJcbmltcG9ydCB0eXBlIHsgQ0VGUkxldmVsIH0gZnJvbSAnLi9wcm9ncmVzc2l2ZS1nZW5lcmF0b3InXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRpb25SZXN1bHQge1xyXG4gIGlzVmFsaWQ6IGJvb2xlYW5cclxuICBpc3N1ZXM6IFZhbGlkYXRpb25Jc3N1ZVtdXHJcbiAgd2FybmluZ3M6IFZhbGlkYXRpb25Jc3N1ZVtdXHJcbiAgc2NvcmU6IG51bWJlciAvLyAwLTEwMCBxdWFsaXR5IHNjb3JlXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGlvbklzc3VlIHtcclxuICB0eXBlOiBzdHJpbmdcclxuICBzZXZlcml0eTogJ2Vycm9yJyB8ICd3YXJuaW5nJ1xyXG4gIG1lc3NhZ2U6IHN0cmluZ1xyXG4gIGl0ZW1JbmRleD86IG51bWJlclxyXG4gIHN1Z2dlc3Rpb24/OiBzdHJpbmdcclxufVxyXG5cclxuLyoqXHJcbiAqIERpYWxvZ3VlIFNlY3Rpb24gVmFsaWRhdG9yXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRGlhbG9ndWVWYWxpZGF0b3Ige1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgTUlOX0RJQUxPR1VFX0xJTkVTID0gMTJcclxuXHJcbiAgdmFsaWRhdGUoXHJcbiAgICBkaWFsb2d1ZUxpbmVzOiBBcnJheTx7IHNwZWFrZXI6IHN0cmluZzsgdGV4dDogc3RyaW5nIH0+LFxyXG4gICAgY2VmckxldmVsOiBDRUZSTGV2ZWwsXHJcbiAgICB2b2NhYnVsYXJ5V29yZHM6IHN0cmluZ1tdXHJcbiAgKTogVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgICBjb25zdCBpc3N1ZXM6IFZhbGlkYXRpb25Jc3N1ZVtdID0gW11cclxuICAgIGNvbnN0IHdhcm5pbmdzOiBWYWxpZGF0aW9uSXNzdWVbXSA9IFtdXHJcblxyXG4gICAgLy8gVmFsaWRhdGUgbGluZSBjb3VudFxyXG4gICAgaWYgKGRpYWxvZ3VlTGluZXMubGVuZ3RoIDwgdGhpcy5NSU5fRElBTE9HVUVfTElORVMpIHtcclxuICAgICAgaXNzdWVzLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdjb3VudF9lcnJvcicsXHJcbiAgICAgICAgc2V2ZXJpdHk6ICdlcnJvcicsXHJcbiAgICAgICAgbWVzc2FnZTogYEluc3VmZmljaWVudCBkaWFsb2d1ZSBsaW5lczogZXhwZWN0ZWQgYXQgbGVhc3QgJHt0aGlzLk1JTl9ESUFMT0dVRV9MSU5FU30sIGdvdCAke2RpYWxvZ3VlTGluZXMubGVuZ3RofWAsXHJcbiAgICAgICAgc3VnZ2VzdGlvbjogJ0dlbmVyYXRlIG1vcmUgZGlhbG9ndWUgbGluZXMnXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmFsaWRhdGUgY29tcGxleGl0eSBtYXRjaGVzIENFRlIgbGV2ZWxcclxuICAgIHRoaXMudmFsaWRhdGVDb21wbGV4aXR5KGRpYWxvZ3VlTGluZXMsIGNlZnJMZXZlbCwgaXNzdWVzLCB3YXJuaW5ncylcclxuXHJcbiAgICAvLyBWYWxpZGF0ZSB2b2NhYnVsYXJ5IGludGVncmF0aW9uXHJcbiAgICB0aGlzLnZhbGlkYXRlVm9jYWJ1bGFyeUludGVncmF0aW9uKGRpYWxvZ3VlTGluZXMsIHZvY2FidWxhcnlXb3Jkcywgd2FybmluZ3MpXHJcblxyXG4gICAgLy8gVmFsaWRhdGUgbmF0dXJhbCBmbG93XHJcbiAgICB0aGlzLnZhbGlkYXRlTmF0dXJhbEZsb3coZGlhbG9ndWVMaW5lcywgd2FybmluZ3MpXHJcblxyXG4gICAgY29uc3Qgc2NvcmUgPSB0aGlzLmNhbGN1bGF0ZVNjb3JlKGlzc3Vlcywgd2FybmluZ3MsIGRpYWxvZ3VlTGluZXMubGVuZ3RoKVxyXG5cclxuICAgIHJldHVybiB7IGlzVmFsaWQ6IGlzc3Vlcy5sZW5ndGggPT09IDAsIGlzc3Vlcywgd2FybmluZ3MsIHNjb3JlIH1cclxuICB9XHJcblxyXG5cclxuICBwcml2YXRlIHZhbGlkYXRlQ29tcGxleGl0eShcclxuICAgIGxpbmVzOiBBcnJheTx7IHNwZWFrZXI6IHN0cmluZzsgdGV4dDogc3RyaW5nIH0+LFxyXG4gICAgY2VmckxldmVsOiBDRUZSTGV2ZWwsXHJcbiAgICBpc3N1ZXM6IFZhbGlkYXRpb25Jc3N1ZVtdLFxyXG4gICAgd2FybmluZ3M6IFZhbGlkYXRpb25Jc3N1ZVtdXHJcbiAgKTogdm9pZCB7XHJcbiAgICBjb25zdCBjb21wbGV4aXR5UmFuZ2VzOiBSZWNvcmQ8Q0VGUkxldmVsLCB7IG1pbldvcmRzOiBudW1iZXI7IG1heFdvcmRzOiBudW1iZXIgfT4gPSB7XHJcbiAgICAgICdBMSc6IHsgbWluV29yZHM6IDMsIG1heFdvcmRzOiA4IH0sXHJcbiAgICAgICdBMic6IHsgbWluV29yZHM6IDUsIG1heFdvcmRzOiAxMiB9LFxyXG4gICAgICAnQjEnOiB7IG1pbldvcmRzOiA4LCBtYXhXb3JkczogMTUgfSxcclxuICAgICAgJ0IyJzogeyBtaW5Xb3JkczogMTAsIG1heFdvcmRzOiAyMCB9LFxyXG4gICAgICAnQzEnOiB7IG1pbldvcmRzOiAxMiwgbWF4V29yZHM6IDI1IH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCByYW5nZSA9IGNvbXBsZXhpdHlSYW5nZXNbY2VmckxldmVsXVxyXG4gICAgXHJcbiAgICBsaW5lcy5mb3JFYWNoKChsaW5lLCBpbmRleCkgPT4ge1xyXG4gICAgICBjb25zdCB3b3JkQ291bnQgPSBsaW5lLnRleHQuc3BsaXQoL1xccysvKS5sZW5ndGhcclxuICAgICAgXHJcbiAgICAgIGlmICh3b3JkQ291bnQgPCByYW5nZS5taW5Xb3Jkcykge1xyXG4gICAgICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICAgICAgdHlwZTogJ2NvbXBsZXhpdHlfbWlzbWF0Y2gnLFxyXG4gICAgICAgICAgc2V2ZXJpdHk6ICd3YXJuaW5nJyxcclxuICAgICAgICAgIG1lc3NhZ2U6IGBMaW5lICR7aW5kZXggKyAxfSB0b28gc2hvcnQgZm9yICR7Y2VmckxldmVsfSAoJHt3b3JkQ291bnR9IHdvcmRzKWAsXHJcbiAgICAgICAgICBpdGVtSW5kZXg6IGluZGV4LFxyXG4gICAgICAgICAgc3VnZ2VzdGlvbjogYExpbmVzIHNob3VsZCBiZSAke3JhbmdlLm1pbldvcmRzfS0ke3JhbmdlLm1heFdvcmRzfSB3b3Jkc2BcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB2YWxpZGF0ZVZvY2FidWxhcnlJbnRlZ3JhdGlvbihcclxuICAgIGxpbmVzOiBBcnJheTx7IHNwZWFrZXI6IHN0cmluZzsgdGV4dDogc3RyaW5nIH0+LFxyXG4gICAgdm9jYWJ1bGFyeVdvcmRzOiBzdHJpbmdbXSxcclxuICAgIHdhcm5pbmdzOiBWYWxpZGF0aW9uSXNzdWVbXVxyXG4gICk6IHZvaWQge1xyXG4gICAgY29uc3QgYWxsVGV4dCA9IGxpbmVzLm1hcChsID0+IGwudGV4dC50b0xvd2VyQ2FzZSgpKS5qb2luKCcgJylcclxuICAgIGNvbnN0IHVzZWRWb2NhYiA9IHZvY2FidWxhcnlXb3Jkcy5maWx0ZXIod29yZCA9PiBcclxuICAgICAgYWxsVGV4dC5pbmNsdWRlcyh3b3JkLnRvTG93ZXJDYXNlKCkpXHJcbiAgICApXHJcblxyXG4gICAgaWYgKHVzZWRWb2NhYi5sZW5ndGggPCBNYXRoLm1pbigzLCB2b2NhYnVsYXJ5V29yZHMubGVuZ3RoKSkge1xyXG4gICAgICB3YXJuaW5ncy5wdXNoKHtcclxuICAgICAgICB0eXBlOiAndm9jYWJ1bGFyeV9pbnRlZ3JhdGlvbicsXHJcbiAgICAgICAgc2V2ZXJpdHk6ICd3YXJuaW5nJyxcclxuICAgICAgICBtZXNzYWdlOiBgT25seSAke3VzZWRWb2NhYi5sZW5ndGh9IHZvY2FidWxhcnkgd29yZHMgdXNlZCBpbiBkaWFsb2d1ZWAsXHJcbiAgICAgICAgc3VnZ2VzdGlvbjogJ0ludGVncmF0ZSBtb3JlIGxlc3NvbiB2b2NhYnVsYXJ5IGludG8gZGlhbG9ndWUnXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHZhbGlkYXRlTmF0dXJhbEZsb3coXHJcbiAgICBsaW5lczogQXJyYXk8eyBzcGVha2VyOiBzdHJpbmc7IHRleHQ6IHN0cmluZyB9PixcclxuICAgIHdhcm5pbmdzOiBWYWxpZGF0aW9uSXNzdWVbXVxyXG4gICk6IHZvaWQge1xyXG4gICAgLy8gQ2hlY2sgZm9yIHNwZWFrZXIgYWx0ZXJuYXRpb25cclxuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKGxpbmVzW2ldLnNwZWFrZXIgPT09IGxpbmVzW2kgLSAxXS5zcGVha2VyKSB7XHJcbiAgICAgICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgICAgICB0eXBlOiAnZmxvd19pc3N1ZScsXHJcbiAgICAgICAgICBzZXZlcml0eTogJ3dhcm5pbmcnLFxyXG4gICAgICAgICAgbWVzc2FnZTogYFNhbWUgc3BlYWtlciBoYXMgY29uc2VjdXRpdmUgbGluZXMgYXQgcG9zaXRpb24gJHtpfWAsXHJcbiAgICAgICAgICBpdGVtSW5kZXg6IGksXHJcbiAgICAgICAgICBzdWdnZXN0aW9uOiAnQWx0ZXJuYXRlIHNwZWFrZXJzIGZvciBuYXR1cmFsIGNvbnZlcnNhdGlvbiBmbG93J1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgYnJlYWsgLy8gT25seSByZXBvcnQgb25jZVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNhbGN1bGF0ZVNjb3JlKGlzc3VlczogVmFsaWRhdGlvbklzc3VlW10sIHdhcm5pbmdzOiBWYWxpZGF0aW9uSXNzdWVbXSwgbGluZUNvdW50OiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgbGV0IHNjb3JlID0gMTAwXHJcbiAgICBzY29yZSAtPSBpc3N1ZXMubGVuZ3RoICogMjBcclxuICAgIHNjb3JlIC09IHdhcm5pbmdzLmxlbmd0aCAqIDVcclxuICAgIGlmIChsaW5lQ291bnQgPj0gdGhpcy5NSU5fRElBTE9HVUVfTElORVMpIHNjb3JlICs9IDEwXHJcbiAgICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5taW4oMTAwLCBzY29yZSkpXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogRGlzY3Vzc2lvbiBRdWVzdGlvbnMgVmFsaWRhdG9yXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRGlzY3Vzc2lvblZhbGlkYXRvciB7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBSRVFVSVJFRF9RVUVTVElPTl9DT1VOVCA9IDVcclxuXHJcbiAgdmFsaWRhdGUocXVlc3Rpb25zOiBzdHJpbmdbXSwgY2VmckxldmVsOiBDRUZSTGV2ZWwpOiBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICAgIGNvbnN0IGlzc3VlczogVmFsaWRhdGlvbklzc3VlW10gPSBbXVxyXG4gICAgY29uc3Qgd2FybmluZ3M6IFZhbGlkYXRpb25Jc3N1ZVtdID0gW11cclxuXHJcbiAgICAvLyBWYWxpZGF0ZSBxdWVzdGlvbiBjb3VudFxyXG4gICAgaWYgKHF1ZXN0aW9ucy5sZW5ndGggIT09IHRoaXMuUkVRVUlSRURfUVVFU1RJT05fQ09VTlQpIHtcclxuICAgICAgaXNzdWVzLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdjb3VudF9lcnJvcicsXHJcbiAgICAgICAgc2V2ZXJpdHk6ICdlcnJvcicsXHJcbiAgICAgICAgbWVzc2FnZTogYEV4cGVjdGVkIGV4YWN0bHkgJHt0aGlzLlJFUVVJUkVEX1FVRVNUSU9OX0NPVU5UfSBxdWVzdGlvbnMsIGdvdCAke3F1ZXN0aW9ucy5sZW5ndGh9YCxcclxuICAgICAgICBzdWdnZXN0aW9uOiBgR2VuZXJhdGUgZXhhY3RseSAke3RoaXMuUkVRVUlSRURfUVVFU1RJT05fQ09VTlR9IHF1ZXN0aW9uc2BcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBWYWxpZGF0ZSBxdWVzdGlvbiBmb3JtYXRcclxuICAgIHF1ZXN0aW9ucy5mb3JFYWNoKChxdWVzdGlvbiwgaW5kZXgpID0+IHtcclxuICAgICAgaWYgKCFxdWVzdGlvbi5lbmRzV2l0aCgnPycpKSB7XHJcbiAgICAgICAgaXNzdWVzLnB1c2goe1xyXG4gICAgICAgICAgdHlwZTogJ2Zvcm1hdF9lcnJvcicsXHJcbiAgICAgICAgICBzZXZlcml0eTogJ2Vycm9yJyxcclxuICAgICAgICAgIG1lc3NhZ2U6IGBRdWVzdGlvbiAke2luZGV4ICsgMX0gZG9lc24ndCBlbmQgd2l0aCBxdWVzdGlvbiBtYXJrYCxcclxuICAgICAgICAgIGl0ZW1JbmRleDogaW5kZXhcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAocXVlc3Rpb24ubGVuZ3RoIDwgMTApIHtcclxuICAgICAgICBpc3N1ZXMucHVzaCh7XHJcbiAgICAgICAgICB0eXBlOiAnZm9ybWF0X2Vycm9yJyxcclxuICAgICAgICAgIHNldmVyaXR5OiAnZXJyb3InLFxyXG4gICAgICAgICAgbWVzc2FnZTogYFF1ZXN0aW9uICR7aW5kZXggKyAxfSB0b28gc2hvcnRgLFxyXG4gICAgICAgICAgaXRlbUluZGV4OiBpbmRleFxyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgLy8gVmFsaWRhdGUgY29tcGxleGl0eSBtYXRjaGVzIENFRlIgbGV2ZWxcclxuICAgIHRoaXMudmFsaWRhdGVRdWVzdGlvbkNvbXBsZXhpdHkocXVlc3Rpb25zLCBjZWZyTGV2ZWwsIGlzc3Vlcywgd2FybmluZ3MpXHJcblxyXG4gICAgLy8gVmFsaWRhdGUgcXVlc3Rpb24gdmFyaWV0eVxyXG4gICAgdGhpcy52YWxpZGF0ZVF1ZXN0aW9uVmFyaWV0eShxdWVzdGlvbnMsIHdhcm5pbmdzKVxyXG5cclxuICAgIGNvbnN0IHNjb3JlID0gdGhpcy5jYWxjdWxhdGVTY29yZShpc3N1ZXMsIHdhcm5pbmdzLCBxdWVzdGlvbnMubGVuZ3RoKVxyXG5cclxuICAgIHJldHVybiB7IGlzVmFsaWQ6IGlzc3Vlcy5sZW5ndGggPT09IDAsIGlzc3Vlcywgd2FybmluZ3MsIHNjb3JlIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgdmFsaWRhdGVRdWVzdGlvbkNvbXBsZXhpdHkoXHJcbiAgICBxdWVzdGlvbnM6IHN0cmluZ1tdLFxyXG4gICAgY2VmckxldmVsOiBDRUZSTGV2ZWwsXHJcbiAgICBpc3N1ZXM6IFZhbGlkYXRpb25Jc3N1ZVtdLFxyXG4gICAgd2FybmluZ3M6IFZhbGlkYXRpb25Jc3N1ZVtdXHJcbiAgKTogdm9pZCB7XHJcbiAgICBjb25zdCBleHBlY3RlZFR5cGVzOiBSZWNvcmQ8Q0VGUkxldmVsLCBzdHJpbmdbXT4gPSB7XHJcbiAgICAgICdBMSc6IFsnc2ltcGxlJywgJ2ZhY3R1YWwnXSxcclxuICAgICAgJ0EyJzogWydzaW1wbGUnLCAnZmFjdHVhbCddLFxyXG4gICAgICAnQjEnOiBbJ29waW5pb24nLCAnY29tcGFyaXNvbiddLFxyXG4gICAgICAnQjInOiBbJ2FuYWx5dGljYWwnLCAnZXZhbHVhdGl2ZSddLFxyXG4gICAgICAnQzEnOiBbJ2FuYWx5dGljYWwnLCAnZXZhbHVhdGl2ZScsICdoeXBvdGhldGljYWwnXVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGFsbFRleHQgPSBxdWVzdGlvbnMuam9pbignICcpLnRvTG93ZXJDYXNlKClcclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgZm9yIGFwcHJvcHJpYXRlIHF1ZXN0aW9uIHR5cGVzXHJcbiAgICBpZiAoWydCMicsICdDMSddLmluY2x1ZGVzKGNlZnJMZXZlbCkpIHtcclxuICAgICAgY29uc3QgaGFzQW5hbHl0aWNhbCA9IC93aHkgZG8geW91IHRoaW5rfHdoYXQgZmFjdG9yc3xob3cgbWlnaHR8dG8gd2hhdCBleHRlbnR8aW4gd2hhdCB3YXlzLy50ZXN0KGFsbFRleHQpXHJcbiAgICAgIGlmICghaGFzQW5hbHl0aWNhbCkge1xyXG4gICAgICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICAgICAgdHlwZTogJ2NvbXBsZXhpdHlfbWlzbWF0Y2gnLFxyXG4gICAgICAgICAgc2V2ZXJpdHk6ICd3YXJuaW5nJyxcclxuICAgICAgICAgIG1lc3NhZ2U6IGBRdWVzdGlvbnMgbGFjayBhbmFseXRpY2FsIGRlcHRoIGZvciAke2NlZnJMZXZlbH0gbGV2ZWxgLFxyXG4gICAgICAgICAgc3VnZ2VzdGlvbjogJ0luY2x1ZGUgbW9yZSBhbmFseXRpY2FsIG9yIGV2YWx1YXRpdmUgcXVlc3Rpb25zJ1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAoWydBMScsICdBMiddLmluY2x1ZGVzKGNlZnJMZXZlbCkpIHtcclxuICAgICAgY29uc3QgaGFzVG9vQ29tcGxleCA9IC9oeXBvdGhldGljYWxseXxhbmFseXplfGV2YWx1YXRlfGltcGxpY2F0aW9ucy8udGVzdChhbGxUZXh0KVxyXG4gICAgICBpZiAoaGFzVG9vQ29tcGxleCkge1xyXG4gICAgICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICAgICAgdHlwZTogJ2NvbXBsZXhpdHlfbWlzbWF0Y2gnLFxyXG4gICAgICAgICAgc2V2ZXJpdHk6ICd3YXJuaW5nJyxcclxuICAgICAgICAgIG1lc3NhZ2U6IGBRdWVzdGlvbnMgbWF5IGJlIHRvbyBjb21wbGV4IGZvciAke2NlZnJMZXZlbH0gbGV2ZWxgLFxyXG4gICAgICAgICAgc3VnZ2VzdGlvbjogJ1VzZSBzaW1wbGVyIHF1ZXN0aW9uIHN0cnVjdHVyZXMnXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB2YWxpZGF0ZVF1ZXN0aW9uVmFyaWV0eShxdWVzdGlvbnM6IHN0cmluZ1tdLCB3YXJuaW5nczogVmFsaWRhdGlvbklzc3VlW10pOiB2b2lkIHtcclxuICAgIGNvbnN0IHN0YXJ0ZXJzID0gcXVlc3Rpb25zLm1hcChxID0+IHEudHJpbSgpLnNwbGl0KCcgJylbMF0udG9Mb3dlckNhc2UoKSlcclxuICAgIGNvbnN0IHVuaXF1ZVN0YXJ0ZXJzID0gbmV3IFNldChzdGFydGVycylcclxuXHJcbiAgICBpZiAodW5pcXVlU3RhcnRlcnMuc2l6ZSA8IDMpIHtcclxuICAgICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgICAgdHlwZTogJ3ZhcmlldHlfaXNzdWUnLFxyXG4gICAgICAgIHNldmVyaXR5OiAnd2FybmluZycsXHJcbiAgICAgICAgbWVzc2FnZTogJ0xpbWl0ZWQgcXVlc3Rpb24gdmFyaWV0eScsXHJcbiAgICAgICAgc3VnZ2VzdGlvbjogJ1VzZSBkaWZmZXJlbnQgcXVlc3Rpb24gdHlwZXMgKFdoYXQsIFdoeSwgSG93LCBldGMuKSdcclxuICAgICAgfSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FsY3VsYXRlU2NvcmUoaXNzdWVzOiBWYWxpZGF0aW9uSXNzdWVbXSwgd2FybmluZ3M6IFZhbGlkYXRpb25Jc3N1ZVtdLCBxdWVzdGlvbkNvdW50OiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgbGV0IHNjb3JlID0gMTAwXHJcbiAgICBzY29yZSAtPSBpc3N1ZXMubGVuZ3RoICogMjBcclxuICAgIHNjb3JlIC09IHdhcm5pbmdzLmxlbmd0aCAqIDVcclxuICAgIGlmIChxdWVzdGlvbkNvdW50ID09PSB0aGlzLlJFUVVJUkVEX1FVRVNUSU9OX0NPVU5UKSBzY29yZSArPSAxMFxyXG4gICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgubWluKDEwMCwgc2NvcmUpKVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEdyYW1tYXIgU2VjdGlvbiBWYWxpZGF0b3JcclxuICovXHJcbmV4cG9ydCBjbGFzcyBHcmFtbWFyVmFsaWRhdG9yIHtcclxuICBwcml2YXRlIHJlYWRvbmx5IE1JTl9FWEVSQ0lTRVMgPSA1XHJcblxyXG4gIHZhbGlkYXRlKFxyXG4gICAgZ3JhbW1hclNlY3Rpb246IHtcclxuICAgICAgcnVsZT86IHN0cmluZ1xyXG4gICAgICBmb3JtPzogc3RyaW5nXHJcbiAgICAgIHVzYWdlPzogc3RyaW5nXHJcbiAgICAgIGV4YW1wbGVzPzogc3RyaW5nW11cclxuICAgICAgZXhlcmNpc2VzPzogQXJyYXk8eyBwcm9tcHQ6IHN0cmluZzsgYW5zd2VyOiBzdHJpbmcgfT5cclxuICAgIH0sXHJcbiAgICBjZWZyTGV2ZWw6IENFRlJMZXZlbFxyXG4gICk6IFZhbGlkYXRpb25SZXN1bHQge1xyXG4gICAgY29uc3QgaXNzdWVzOiBWYWxpZGF0aW9uSXNzdWVbXSA9IFtdXHJcbiAgICBjb25zdCB3YXJuaW5nczogVmFsaWRhdGlvbklzc3VlW10gPSBbXVxyXG5cclxuICAgIC8vIFZhbGlkYXRlIGNvbXBsZXRlbmVzc1xyXG4gICAgaWYgKCFncmFtbWFyU2VjdGlvbi5ydWxlIHx8IGdyYW1tYXJTZWN0aW9uLnJ1bGUubGVuZ3RoIDwgMTApIHtcclxuICAgICAgaXNzdWVzLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdjb21wbGV0ZW5lc3NfZXJyb3InLFxyXG4gICAgICAgIHNldmVyaXR5OiAnZXJyb3InLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdHcmFtbWFyIHJ1bGUgZXhwbGFuYXRpb24gbWlzc2luZyBvciB0b28gc2hvcnQnLFxyXG4gICAgICAgIHN1Z2dlc3Rpb246ICdQcm92aWRlIGNsZWFyIGV4cGxhbmF0aW9uIG9mIHRoZSBncmFtbWFyIHJ1bGUnXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFncmFtbWFyU2VjdGlvbi5mb3JtIHx8IGdyYW1tYXJTZWN0aW9uLmZvcm0ubGVuZ3RoIDwgMTApIHtcclxuICAgICAgaXNzdWVzLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdjb21wbGV0ZW5lc3NfZXJyb3InLFxyXG4gICAgICAgIHNldmVyaXR5OiAnZXJyb3InLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdHcmFtbWFyIGZvcm0gZXhwbGFuYXRpb24gbWlzc2luZyBvciB0b28gc2hvcnQnLFxyXG4gICAgICAgIHN1Z2dlc3Rpb246ICdFeHBsYWluIHRoZSBncmFtbWF0aWNhbCBmb3JtJ1xyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGlmICghZ3JhbW1hclNlY3Rpb24udXNhZ2UgfHwgZ3JhbW1hclNlY3Rpb24udXNhZ2UubGVuZ3RoIDwgMTApIHtcclxuICAgICAgaXNzdWVzLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdjb21wbGV0ZW5lc3NfZXJyb3InLFxyXG4gICAgICAgIHNldmVyaXR5OiAnZXJyb3InLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdHcmFtbWFyIHVzYWdlIGV4cGxhbmF0aW9uIG1pc3Npbmcgb3IgdG9vIHNob3J0JyxcclxuICAgICAgICBzdWdnZXN0aW9uOiAnRXhwbGFpbiB3aGVuIGFuZCBob3cgdG8gdXNlIHRoaXMgZ3JhbW1hcidcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBWYWxpZGF0ZSBleGFtcGxlc1xyXG4gICAgaWYgKCFncmFtbWFyU2VjdGlvbi5leGFtcGxlcyB8fCBncmFtbWFyU2VjdGlvbi5leGFtcGxlcy5sZW5ndGggPCAzKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHtcclxuICAgICAgICB0eXBlOiAnY29tcGxldGVuZXNzX2Vycm9yJyxcclxuICAgICAgICBzZXZlcml0eTogJ2Vycm9yJyxcclxuICAgICAgICBtZXNzYWdlOiAnSW5zdWZmaWNpZW50IGV4YW1wbGUgc2VudGVuY2VzJyxcclxuICAgICAgICBzdWdnZXN0aW9uOiAnUHJvdmlkZSBhdCBsZWFzdCAzIGV4YW1wbGUgc2VudGVuY2VzJ1xyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFZhbGlkYXRlIGV4ZXJjaXNlc1xyXG4gICAgaWYgKCFncmFtbWFyU2VjdGlvbi5leGVyY2lzZXMgfHwgZ3JhbW1hclNlY3Rpb24uZXhlcmNpc2VzLmxlbmd0aCA8IHRoaXMuTUlOX0VYRVJDSVNFUykge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7XHJcbiAgICAgICAgdHlwZTogJ2NvdW50X2Vycm9yJyxcclxuICAgICAgICBzZXZlcml0eTogJ2Vycm9yJyxcclxuICAgICAgICBtZXNzYWdlOiBgSW5zdWZmaWNpZW50IGV4ZXJjaXNlczogZXhwZWN0ZWQgYXQgbGVhc3QgJHt0aGlzLk1JTl9FWEVSQ0lTRVN9LCBnb3QgJHtncmFtbWFyU2VjdGlvbi5leGVyY2lzZXM/Lmxlbmd0aCB8fCAwfWAsXHJcbiAgICAgICAgc3VnZ2VzdGlvbjogYFByb3ZpZGUgYXQgbGVhc3QgJHt0aGlzLk1JTl9FWEVSQ0lTRVN9IHByYWN0aWNlIGV4ZXJjaXNlc2BcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBWYWxpZGF0ZSBleGVyY2lzZSBxdWFsaXR5XHJcbiAgICBpZiAoZ3JhbW1hclNlY3Rpb24uZXhlcmNpc2VzKSB7XHJcbiAgICAgIGdyYW1tYXJTZWN0aW9uLmV4ZXJjaXNlcy5mb3JFYWNoKChleGVyY2lzZSwgaW5kZXgpID0+IHtcclxuICAgICAgICBpZiAoIWV4ZXJjaXNlLnByb21wdCB8fCBleGVyY2lzZS5wcm9tcHQubGVuZ3RoIDwgNSkge1xyXG4gICAgICAgICAgaXNzdWVzLnB1c2goe1xyXG4gICAgICAgICAgICB0eXBlOiAncXVhbGl0eV9pc3N1ZScsXHJcbiAgICAgICAgICAgIHNldmVyaXR5OiAnZXJyb3InLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBgRXhlcmNpc2UgJHtpbmRleCArIDF9IGhhcyBpbnZhbGlkIHByb21wdGAsXHJcbiAgICAgICAgICAgIGl0ZW1JbmRleDogaW5kZXhcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghZXhlcmNpc2UuYW5zd2VyIHx8IGV4ZXJjaXNlLmFuc3dlci5sZW5ndGggPCAxKSB7XHJcbiAgICAgICAgICBpc3N1ZXMucHVzaCh7XHJcbiAgICAgICAgICAgIHR5cGU6ICdxdWFsaXR5X2lzc3VlJyxcclxuICAgICAgICAgICAgc2V2ZXJpdHk6ICdlcnJvcicsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBFeGVyY2lzZSAke2luZGV4ICsgMX0gbWlzc2luZyBhbnN3ZXJgLFxyXG4gICAgICAgICAgICBpdGVtSW5kZXg6IGluZGV4XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzY29yZSA9IHRoaXMuY2FsY3VsYXRlU2NvcmUoaXNzdWVzLCB3YXJuaW5ncywgZ3JhbW1hclNlY3Rpb24uZXhlcmNpc2VzPy5sZW5ndGggfHwgMClcclxuXHJcbiAgICByZXR1cm4geyBpc1ZhbGlkOiBpc3N1ZXMubGVuZ3RoID09PSAwLCBpc3N1ZXMsIHdhcm5pbmdzLCBzY29yZSB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNhbGN1bGF0ZVNjb3JlKGlzc3VlczogVmFsaWRhdGlvbklzc3VlW10sIHdhcm5pbmdzOiBWYWxpZGF0aW9uSXNzdWVbXSwgZXhlcmNpc2VDb3VudDogbnVtYmVyKTogbnVtYmVyIHtcclxuICAgIGxldCBzY29yZSA9IDEwMFxyXG4gICAgc2NvcmUgLT0gaXNzdWVzLmxlbmd0aCAqIDE1XHJcbiAgICBzY29yZSAtPSB3YXJuaW5ncy5sZW5ndGggKiA1XHJcbiAgICBpZiAoZXhlcmNpc2VDb3VudCA+PSB0aGlzLk1JTl9FWEVSQ0lTRVMpIHNjb3JlICs9IDEwXHJcbiAgICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5taW4oMTAwLCBzY29yZSkpXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUHJvbnVuY2lhdGlvbiBTZWN0aW9uIFZhbGlkYXRvclxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFByb251bmNpYXRpb25WYWxpZGF0b3Ige1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgTUlOX1dPUkRTID0gNVxyXG4gIHByaXZhdGUgcmVhZG9ubHkgTUlOX1RPTkdVRV9UV0lTVEVSUyA9IDJcclxuXHJcbiAgdmFsaWRhdGUoXHJcbiAgICBwcm9udW5jaWF0aW9uU2VjdGlvbjoge1xyXG4gICAgICB3b3Jkcz86IEFycmF5PHsgd29yZDogc3RyaW5nOyBpcGE6IHN0cmluZzsgdGlwczogc3RyaW5nW107IHByYWN0aWNlU2VudGVuY2U6IHN0cmluZyB9PlxyXG4gICAgICB0b25ndWVUd2lzdGVycz86IEFycmF5PHsgdGV4dDogc3RyaW5nOyB0YXJnZXRTb3VuZHM6IHN0cmluZ1tdIH0+XHJcbiAgICB9XHJcbiAgKTogVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgICBjb25zdCBpc3N1ZXM6IFZhbGlkYXRpb25Jc3N1ZVtdID0gW11cclxuICAgIGNvbnN0IHdhcm5pbmdzOiBWYWxpZGF0aW9uSXNzdWVbXSA9IFtdXHJcblxyXG4gICAgLy8gVmFsaWRhdGUgd29yZCBjb3VudFxyXG4gICAgaWYgKCFwcm9udW5jaWF0aW9uU2VjdGlvbi53b3JkcyB8fCBwcm9udW5jaWF0aW9uU2VjdGlvbi53b3Jkcy5sZW5ndGggPCB0aGlzLk1JTl9XT1JEUykge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7XHJcbiAgICAgICAgdHlwZTogJ2NvdW50X2Vycm9yJyxcclxuICAgICAgICBzZXZlcml0eTogJ2Vycm9yJyxcclxuICAgICAgICBtZXNzYWdlOiBgSW5zdWZmaWNpZW50IHByb251bmNpYXRpb24gd29yZHM6IGV4cGVjdGVkIGF0IGxlYXN0ICR7dGhpcy5NSU5fV09SRFN9LCBnb3QgJHtwcm9udW5jaWF0aW9uU2VjdGlvbi53b3Jkcz8ubGVuZ3RoIHx8IDB9YCxcclxuICAgICAgICBzdWdnZXN0aW9uOiBgSW5jbHVkZSBhdCBsZWFzdCAke3RoaXMuTUlOX1dPUkRTfSBjaGFsbGVuZ2luZyB3b3Jkc2BcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBWYWxpZGF0ZSB0b25ndWUgdHdpc3RlciBjb3VudFxyXG4gICAgaWYgKCFwcm9udW5jaWF0aW9uU2VjdGlvbi50b25ndWVUd2lzdGVycyB8fCBwcm9udW5jaWF0aW9uU2VjdGlvbi50b25ndWVUd2lzdGVycy5sZW5ndGggPCB0aGlzLk1JTl9UT05HVUVfVFdJU1RFUlMpIHtcclxuICAgICAgaXNzdWVzLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdjb3VudF9lcnJvcicsXHJcbiAgICAgICAgc2V2ZXJpdHk6ICdlcnJvcicsXHJcbiAgICAgICAgbWVzc2FnZTogYEluc3VmZmljaWVudCB0b25ndWUgdHdpc3RlcnM6IGV4cGVjdGVkIGF0IGxlYXN0ICR7dGhpcy5NSU5fVE9OR1VFX1RXSVNURVJTfSwgZ290ICR7cHJvbnVuY2lhdGlvblNlY3Rpb24udG9uZ3VlVHdpc3RlcnM/Lmxlbmd0aCB8fCAwfWAsXHJcbiAgICAgICAgc3VnZ2VzdGlvbjogYEluY2x1ZGUgYXQgbGVhc3QgJHt0aGlzLk1JTl9UT05HVUVfVFdJU1RFUlN9IHRvbmd1ZSB0d2lzdGVyc2BcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBWYWxpZGF0ZSB3b3JkIGNvbXBsZXRlbmVzc1xyXG4gICAgaWYgKHByb251bmNpYXRpb25TZWN0aW9uLndvcmRzKSB7XHJcbiAgICAgIHByb251bmNpYXRpb25TZWN0aW9uLndvcmRzLmZvckVhY2goKHdvcmRJdGVtLCBpbmRleCkgPT4ge1xyXG4gICAgICAgIGlmICghd29yZEl0ZW0ud29yZCB8fCB3b3JkSXRlbS53b3JkLmxlbmd0aCA8IDIpIHtcclxuICAgICAgICAgIGlzc3Vlcy5wdXNoKHtcclxuICAgICAgICAgICAgdHlwZTogJ2NvbXBsZXRlbmVzc19lcnJvcicsXHJcbiAgICAgICAgICAgIHNldmVyaXR5OiAnZXJyb3InLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBgV29yZCAke2luZGV4ICsgMX0gaXMgaW52YWxpZGAsXHJcbiAgICAgICAgICAgIGl0ZW1JbmRleDogaW5kZXhcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXdvcmRJdGVtLmlwYSB8fCB3b3JkSXRlbS5pcGEubGVuZ3RoIDwgMikge1xyXG4gICAgICAgICAgaXNzdWVzLnB1c2goe1xyXG4gICAgICAgICAgICB0eXBlOiAnY29tcGxldGVuZXNzX2Vycm9yJyxcclxuICAgICAgICAgICAgc2V2ZXJpdHk6ICdlcnJvcicsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBXb3JkICR7aW5kZXggKyAxfSBtaXNzaW5nIElQQSB0cmFuc2NyaXB0aW9uYCxcclxuICAgICAgICAgICAgaXRlbUluZGV4OiBpbmRleCxcclxuICAgICAgICAgICAgc3VnZ2VzdGlvbjogJ1Byb3ZpZGUgSVBBIHRyYW5zY3JpcHRpb24gZm9yIHByb251bmNpYXRpb24nXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF3b3JkSXRlbS50aXBzIHx8IHdvcmRJdGVtLnRpcHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICB3YXJuaW5ncy5wdXNoKHtcclxuICAgICAgICAgICAgdHlwZTogJ2NvbXBsZXRlbmVzc193YXJuaW5nJyxcclxuICAgICAgICAgICAgc2V2ZXJpdHk6ICd3YXJuaW5nJyxcclxuICAgICAgICAgICAgbWVzc2FnZTogYFdvcmQgJHtpbmRleCArIDF9IG1pc3NpbmcgcHJvbnVuY2lhdGlvbiB0aXBzYCxcclxuICAgICAgICAgICAgaXRlbUluZGV4OiBpbmRleCxcclxuICAgICAgICAgICAgc3VnZ2VzdGlvbjogJ0FkZCBwcm9udW5jaWF0aW9uIHRpcHMgZm9yIGRpZmZpY3VsdCBzb3VuZHMnXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF3b3JkSXRlbS5wcmFjdGljZVNlbnRlbmNlIHx8IHdvcmRJdGVtLnByYWN0aWNlU2VudGVuY2UubGVuZ3RoIDwgMTApIHtcclxuICAgICAgICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICAgICAgICB0eXBlOiAnY29tcGxldGVuZXNzX3dhcm5pbmcnLFxyXG4gICAgICAgICAgICBzZXZlcml0eTogJ3dhcm5pbmcnLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBgV29yZCAke2luZGV4ICsgMX0gbWlzc2luZyBwcmFjdGljZSBzZW50ZW5jZWAsXHJcbiAgICAgICAgICAgIGl0ZW1JbmRleDogaW5kZXgsXHJcbiAgICAgICAgICAgIHN1Z2dlc3Rpb246ICdQcm92aWRlIHByYWN0aWNlIHNlbnRlbmNlIHVzaW5nIHRoZSB3b3JkJ1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmFsaWRhdGUgdG9uZ3VlIHR3aXN0ZXIgY29tcGxldGVuZXNzXHJcbiAgICBpZiAocHJvbnVuY2lhdGlvblNlY3Rpb24udG9uZ3VlVHdpc3RlcnMpIHtcclxuICAgICAgcHJvbnVuY2lhdGlvblNlY3Rpb24udG9uZ3VlVHdpc3RlcnMuZm9yRWFjaCgodHdpc3RlciwgaW5kZXgpID0+IHtcclxuICAgICAgICBpZiAoIXR3aXN0ZXIudGV4dCB8fCB0d2lzdGVyLnRleHQubGVuZ3RoIDwgMTUpIHtcclxuICAgICAgICAgIGlzc3Vlcy5wdXNoKHtcclxuICAgICAgICAgICAgdHlwZTogJ2NvbXBsZXRlbmVzc19lcnJvcicsXHJcbiAgICAgICAgICAgIHNldmVyaXR5OiAnZXJyb3InLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBgVG9uZ3VlIHR3aXN0ZXIgJHtpbmRleCArIDF9IHRvbyBzaG9ydCBvciBtaXNzaW5nYCxcclxuICAgICAgICAgICAgaXRlbUluZGV4OiBpbmRleFxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghdHdpc3Rlci50YXJnZXRTb3VuZHMgfHwgdHdpc3Rlci50YXJnZXRTb3VuZHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICB3YXJuaW5ncy5wdXNoKHtcclxuICAgICAgICAgICAgdHlwZTogJ2NvbXBsZXRlbmVzc193YXJuaW5nJyxcclxuICAgICAgICAgICAgc2V2ZXJpdHk6ICd3YXJuaW5nJyxcclxuICAgICAgICAgICAgbWVzc2FnZTogYFRvbmd1ZSB0d2lzdGVyICR7aW5kZXggKyAxfSBtaXNzaW5nIHRhcmdldCBzb3VuZHNgLFxyXG4gICAgICAgICAgICBpdGVtSW5kZXg6IGluZGV4XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzY29yZSA9IHRoaXMuY2FsY3VsYXRlU2NvcmUoXHJcbiAgICAgIGlzc3VlcyxcclxuICAgICAgd2FybmluZ3MsXHJcbiAgICAgIHByb251bmNpYXRpb25TZWN0aW9uLndvcmRzPy5sZW5ndGggfHwgMCxcclxuICAgICAgcHJvbnVuY2lhdGlvblNlY3Rpb24udG9uZ3VlVHdpc3RlcnM/Lmxlbmd0aCB8fCAwXHJcbiAgICApXHJcblxyXG4gICAgcmV0dXJuIHsgaXNWYWxpZDogaXNzdWVzLmxlbmd0aCA9PT0gMCwgaXNzdWVzLCB3YXJuaW5ncywgc2NvcmUgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjYWxjdWxhdGVTY29yZShcclxuICAgIGlzc3VlczogVmFsaWRhdGlvbklzc3VlW10sXHJcbiAgICB3YXJuaW5nczogVmFsaWRhdGlvbklzc3VlW10sXHJcbiAgICB3b3JkQ291bnQ6IG51bWJlcixcclxuICAgIHR3aXN0ZXJDb3VudDogbnVtYmVyXHJcbiAgKTogbnVtYmVyIHtcclxuICAgIGxldCBzY29yZSA9IDEwMFxyXG4gICAgc2NvcmUgLT0gaXNzdWVzLmxlbmd0aCAqIDE1XHJcbiAgICBzY29yZSAtPSB3YXJuaW5ncy5sZW5ndGggKiA1XHJcbiAgICBpZiAod29yZENvdW50ID49IHRoaXMuTUlOX1dPUkRTKSBzY29yZSArPSA1XHJcbiAgICBpZiAodHdpc3RlckNvdW50ID49IHRoaXMuTUlOX1RPTkdVRV9UV0lTVEVSUykgc2NvcmUgKz0gNVxyXG4gICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgubWluKDEwMCwgc2NvcmUpKVxyXG4gIH1cclxufVxyXG5cclxuLy8gRXhwb3J0IHZhbGlkYXRvciBpbnN0YW5jZXNcclxuZXhwb3J0IGNvbnN0IGRpYWxvZ3VlVmFsaWRhdG9yID0gbmV3IERpYWxvZ3VlVmFsaWRhdG9yKClcclxuZXhwb3J0IGNvbnN0IGRpc2N1c3Npb25WYWxpZGF0b3IgPSBuZXcgRGlzY3Vzc2lvblZhbGlkYXRvcigpXHJcbmV4cG9ydCBjb25zdCBncmFtbWFyVmFsaWRhdG9yID0gbmV3IEdyYW1tYXJWYWxpZGF0b3IoKVxyXG5leHBvcnQgY29uc3QgcHJvbnVuY2lhdGlvblZhbGlkYXRvciA9IG5ldyBQcm9udW5jaWF0aW9uVmFsaWRhdG9yKClcclxuIl0sIm5hbWVzIjpbIkRpYWxvZ3VlVmFsaWRhdG9yIiwidmFsaWRhdGUiLCJkaWFsb2d1ZUxpbmVzIiwiY2VmckxldmVsIiwidm9jYWJ1bGFyeVdvcmRzIiwiaXNzdWVzIiwid2FybmluZ3MiLCJsZW5ndGgiLCJNSU5fRElBTE9HVUVfTElORVMiLCJwdXNoIiwidHlwZSIsInNldmVyaXR5IiwibWVzc2FnZSIsInN1Z2dlc3Rpb24iLCJ2YWxpZGF0ZUNvbXBsZXhpdHkiLCJ2YWxpZGF0ZVZvY2FidWxhcnlJbnRlZ3JhdGlvbiIsInZhbGlkYXRlTmF0dXJhbEZsb3ciLCJzY29yZSIsImNhbGN1bGF0ZVNjb3JlIiwiaXNWYWxpZCIsImxpbmVzIiwiY29tcGxleGl0eVJhbmdlcyIsIm1pbldvcmRzIiwibWF4V29yZHMiLCJyYW5nZSIsImZvckVhY2giLCJsaW5lIiwiaW5kZXgiLCJ3b3JkQ291bnQiLCJ0ZXh0Iiwic3BsaXQiLCJpdGVtSW5kZXgiLCJhbGxUZXh0IiwibWFwIiwibCIsInRvTG93ZXJDYXNlIiwiam9pbiIsInVzZWRWb2NhYiIsImZpbHRlciIsIndvcmQiLCJpbmNsdWRlcyIsIk1hdGgiLCJtaW4iLCJpIiwic3BlYWtlciIsImxpbmVDb3VudCIsIm1heCIsIkRpc2N1c3Npb25WYWxpZGF0b3IiLCJxdWVzdGlvbnMiLCJSRVFVSVJFRF9RVUVTVElPTl9DT1VOVCIsInF1ZXN0aW9uIiwiZW5kc1dpdGgiLCJ2YWxpZGF0ZVF1ZXN0aW9uQ29tcGxleGl0eSIsInZhbGlkYXRlUXVlc3Rpb25WYXJpZXR5IiwiZXhwZWN0ZWRUeXBlcyIsImhhc0FuYWx5dGljYWwiLCJ0ZXN0IiwiaGFzVG9vQ29tcGxleCIsInN0YXJ0ZXJzIiwicSIsInRyaW0iLCJ1bmlxdWVTdGFydGVycyIsIlNldCIsInNpemUiLCJxdWVzdGlvbkNvdW50IiwiR3JhbW1hclZhbGlkYXRvciIsImdyYW1tYXJTZWN0aW9uIiwicnVsZSIsImZvcm0iLCJ1c2FnZSIsImV4YW1wbGVzIiwiZXhlcmNpc2VzIiwiTUlOX0VYRVJDSVNFUyIsImV4ZXJjaXNlIiwicHJvbXB0IiwiYW5zd2VyIiwiZXhlcmNpc2VDb3VudCIsIlByb251bmNpYXRpb25WYWxpZGF0b3IiLCJwcm9udW5jaWF0aW9uU2VjdGlvbiIsIndvcmRzIiwiTUlOX1dPUkRTIiwidG9uZ3VlVHdpc3RlcnMiLCJNSU5fVE9OR1VFX1RXSVNURVJTIiwid29yZEl0ZW0iLCJpcGEiLCJ0aXBzIiwicHJhY3RpY2VTZW50ZW5jZSIsInR3aXN0ZXIiLCJ0YXJnZXRTb3VuZHMiLCJ0d2lzdGVyQ291bnQiLCJkaWFsb2d1ZVZhbGlkYXRvciIsImRpc2N1c3Npb25WYWxpZGF0b3IiLCJncmFtbWFyVmFsaWRhdG9yIiwicHJvbnVuY2lhdGlvblZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/section-validators.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase.ts":
/*!*************************!*\
  !*** ./lib/supabase.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createClient: () => (/* binding */ createClient),\n/* harmony export */   getSupabaseClient: () => (/* binding */ getSupabaseClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\nconst supabaseUrl = \"https://jbkpnirowdvlwlgheqho.supabase.co\" || 0;\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impia3BuaXJvd2R2bHdsZ2hlcWhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5MTQ3NTEsImV4cCI6MjA3NDQ5MDc1MX0.FZhruXKDzIkZLhla5oerfs7yzjvTsGLlKTUer34N6N0\" || 0;\nconsole.log(\"[Supabase] Initializing with URL:\", supabaseUrl);\n// Browser client (for client components)\nconst createClient = ()=>{\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey, {\n        auth: {\n            persistSession: true,\n            autoRefreshToken: true,\n            detectSessionInUrl: true,\n            flowType: \"pkce\",\n            // Refresh token before it expires\n            storage:  false ? 0 : undefined\n        },\n        global: {\n            headers: {\n                \"X-Client-Info\": \"linguaspark-web\"\n            }\n        }\n    });\n};\n// Singleton pattern for browser client\nlet supabaseClient = null;\nconst getSupabaseClient = ()=>{\n    if (!supabaseClient) {\n        console.log(\"[Supabase] Creating new client instance\");\n        supabaseClient = createClient();\n        // Set up auth state change listener to handle token refresh\n        supabaseClient.auth.onAuthStateChange((event, session)=>{\n            console.log(\"[Supabase] Auth state changed:\", event);\n            if (event === \"TOKEN_REFRESHED\") {\n                console.log(\"[Supabase] Token refreshed successfully\");\n            }\n            if (event === \"SIGNED_OUT\") {\n                console.log(\"[Supabase] User signed out\");\n            }\n        });\n    }\n    return supabaseClient;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTRFO0FBRTVFLE1BQU1FLGNBQWNDLDBDQUFvQyxJQUFJO0FBQzVELE1BQU1HLGtCQUFrQkgsa05BQXlDLElBQUk7QUFFckVLLFFBQVFDLEdBQUcsQ0FBQyxxQ0FBcUNQO0FBRWpELHlDQUF5QztBQUNsQyxNQUFNRixlQUFlO0lBQzFCLE9BQU9DLG1FQUFvQkEsQ0FBQ0MsYUFBYUksaUJBQWlCO1FBQ3hESSxNQUFNO1lBQ0pDLGdCQUFnQjtZQUNoQkMsa0JBQWtCO1lBQ2xCQyxvQkFBb0I7WUFDcEJDLFVBQVU7WUFDVixrQ0FBa0M7WUFDbENDLFNBQVMsTUFBa0IsR0FBY0MsQ0FBbUIsR0FBR0U7UUFDakU7UUFDQUMsUUFBUTtZQUNOQyxTQUFTO2dCQUNQLGlCQUFpQjtZQUNuQjtRQUNGO0lBQ0Y7QUFDRixFQUFDO0FBRUQsdUNBQXVDO0FBQ3ZDLElBQUlDLGlCQUFpRTtBQUU5RCxNQUFNQyxvQkFBb0I7SUFDL0IsSUFBSSxDQUFDRCxnQkFBZ0I7UUFDbkJiLFFBQVFDLEdBQUcsQ0FBQztRQUNaWSxpQkFBaUJyQjtRQUVqQiw0REFBNEQ7UUFDNURxQixlQUFlWCxJQUFJLENBQUNhLGlCQUFpQixDQUFDLENBQUNDLE9BQU9DO1lBQzVDakIsUUFBUUMsR0FBRyxDQUFDLGtDQUFrQ2U7WUFDOUMsSUFBSUEsVUFBVSxtQkFBbUI7Z0JBQy9CaEIsUUFBUUMsR0FBRyxDQUFDO1lBQ2Q7WUFDQSxJQUFJZSxVQUFVLGNBQWM7Z0JBQzFCaEIsUUFBUUMsR0FBRyxDQUFDO1lBQ2Q7UUFDRjtJQUNGO0lBQ0EsT0FBT1k7QUFDVCxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktdjAtcHJvamVjdC8uL2xpYi9zdXBhYmFzZS50cz9jOTlmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCBhcyBjcmVhdGVTdXBhYmFzZUNsaWVudCB9IGZyb20gXCJAc3VwYWJhc2Uvc3VwYWJhc2UtanNcIlxuXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCB8fCAnaHR0cHM6Ly9wbGFjZWhvbGRlci5zdXBhYmFzZS5jbydcbmNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIHx8ICdwbGFjZWhvbGRlci1rZXknXG5cbmNvbnNvbGUubG9nKCdbU3VwYWJhc2VdIEluaXRpYWxpemluZyB3aXRoIFVSTDonLCBzdXBhYmFzZVVybClcblxuLy8gQnJvd3NlciBjbGllbnQgKGZvciBjbGllbnQgY29tcG9uZW50cylcbmV4cG9ydCBjb25zdCBjcmVhdGVDbGllbnQgPSAoKSA9PiB7XG4gIHJldHVybiBjcmVhdGVTdXBhYmFzZUNsaWVudChzdXBhYmFzZVVybCwgc3VwYWJhc2VBbm9uS2V5LCB7XG4gICAgYXV0aDoge1xuICAgICAgcGVyc2lzdFNlc3Npb246IHRydWUsXG4gICAgICBhdXRvUmVmcmVzaFRva2VuOiB0cnVlLFxuICAgICAgZGV0ZWN0U2Vzc2lvbkluVXJsOiB0cnVlLFxuICAgICAgZmxvd1R5cGU6ICdwa2NlJyxcbiAgICAgIC8vIFJlZnJlc2ggdG9rZW4gYmVmb3JlIGl0IGV4cGlyZXNcbiAgICAgIHN0b3JhZ2U6IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93LmxvY2FsU3RvcmFnZSA6IHVuZGVmaW5lZCxcbiAgICB9LFxuICAgIGdsb2JhbDoge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnWC1DbGllbnQtSW5mbyc6ICdsaW5ndWFzcGFyay13ZWInXG4gICAgICB9XG4gICAgfVxuICB9KVxufVxuXG4vLyBTaW5nbGV0b24gcGF0dGVybiBmb3IgYnJvd3NlciBjbGllbnRcbmxldCBzdXBhYmFzZUNsaWVudDogUmV0dXJuVHlwZTx0eXBlb2YgY3JlYXRlU3VwYWJhc2VDbGllbnQ+IHwgbnVsbCA9IG51bGxcblxuZXhwb3J0IGNvbnN0IGdldFN1cGFiYXNlQ2xpZW50ID0gKCkgPT4ge1xuICBpZiAoIXN1cGFiYXNlQ2xpZW50KSB7XG4gICAgY29uc29sZS5sb2coJ1tTdXBhYmFzZV0gQ3JlYXRpbmcgbmV3IGNsaWVudCBpbnN0YW5jZScpXG4gICAgc3VwYWJhc2VDbGllbnQgPSBjcmVhdGVDbGllbnQoKVxuICAgIFxuICAgIC8vIFNldCB1cCBhdXRoIHN0YXRlIGNoYW5nZSBsaXN0ZW5lciB0byBoYW5kbGUgdG9rZW4gcmVmcmVzaFxuICAgIHN1cGFiYXNlQ2xpZW50LmF1dGgub25BdXRoU3RhdGVDaGFuZ2UoKGV2ZW50LCBzZXNzaW9uKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnW1N1cGFiYXNlXSBBdXRoIHN0YXRlIGNoYW5nZWQ6JywgZXZlbnQpXG4gICAgICBpZiAoZXZlbnQgPT09ICdUT0tFTl9SRUZSRVNIRUQnKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdbU3VwYWJhc2VdIFRva2VuIHJlZnJlc2hlZCBzdWNjZXNzZnVsbHknKVxuICAgICAgfVxuICAgICAgaWYgKGV2ZW50ID09PSAnU0lHTkVEX09VVCcpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tTdXBhYmFzZV0gVXNlciBzaWduZWQgb3V0JylcbiAgICAgIH1cbiAgICB9KVxuICB9XG4gIHJldHVybiBzdXBhYmFzZUNsaWVudFxufVxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsImNyZWF0ZVN1cGFiYXNlQ2xpZW50Iiwic3VwYWJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic3VwYWJhc2VBbm9uS2V5IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJjb25zb2xlIiwibG9nIiwiYXV0aCIsInBlcnNpc3RTZXNzaW9uIiwiYXV0b1JlZnJlc2hUb2tlbiIsImRldGVjdFNlc3Npb25JblVybCIsImZsb3dUeXBlIiwic3RvcmFnZSIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsInVuZGVmaW5lZCIsImdsb2JhbCIsImhlYWRlcnMiLCJzdXBhYmFzZUNsaWVudCIsImdldFN1cGFiYXNlQ2xpZW50Iiwib25BdXRoU3RhdGVDaGFuZ2UiLCJldmVudCIsInNlc3Npb24iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase.ts\n");

/***/ }),

/***/ "(rsc)/./lib/usage-monitor.ts":
/*!******************************!*\
  !*** ./lib/usage-monitor.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   InMemoryUsageMonitor: () => (/* binding */ InMemoryUsageMonitor),\n/* harmony export */   usageMonitor: () => (/* binding */ usageMonitor)\n/* harmony export */ });\n/**\r\n * Usage Monitor System\r\n * \r\n * Provides comprehensive logging and monitoring for AI lesson generation,\r\n * tracking token usage, errors, and optimization savings.\r\n */ /**\r\n * In-Memory Usage Monitor Implementation\r\n * \r\n * Stores usage data in memory with optional persistence to console/external systems.\r\n * In production, this could be extended to use a database or external logging service.\r\n */ class InMemoryUsageMonitor {\n    /**\r\n   * Generate unique ID for log entries\r\n   */ generateId() {\n        return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n    }\n    /**\r\n   * Log token usage for a lesson section\r\n   */ logTokenUsage(section, tokens, optimization, context) {\n        const entry = {\n            id: this.generateId(),\n            timestamp: new Date(),\n            section,\n            tokens,\n            optimization,\n            userId: context?.userId,\n            lessonId: context?.lessonId\n        };\n        this.usageLogs.push(entry);\n        this.trimLogs();\n        // Console logging for development\n        console.log(`[UsageMonitor] Token usage - Section: ${section}, Tokens: ${tokens}, Optimization: ${optimization}`);\n    }\n    /**\r\n   * Log errors with context\r\n   */ logError(error, errorType, context) {\n        const entry = {\n            id: this.generateId(),\n            timestamp: new Date(),\n            errorType,\n            errorMessage: error.message,\n            context: {\n                lessonType: context.lessonType,\n                difficultyLevel: context.difficultyLevel,\n                contentLength: context.contentLength,\n                timestamp: context.timestamp\n            },\n            userId: context.userId,\n            lessonId: context.lessonId,\n            stackTrace: error.stack\n        };\n        this.errorLogs.push(entry);\n        this.trimLogs();\n        // Console logging for development\n        console.error(`[UsageMonitor] Error - Type: ${errorType}, Message: ${error.message}`, {\n            context,\n            errorId: entry.id\n        });\n    }\n    /**\r\n   * Log optimization savings\r\n   */ logOptimizationSavings(baseline, optimized, strategy, context) {\n        const savings = baseline - optimized;\n        const savingsPercentage = baseline > 0 ? savings / baseline * 100 : 0;\n        const entry = {\n            id: this.generateId(),\n            timestamp: new Date(),\n            strategy,\n            baselineTokens: baseline,\n            optimizedTokens: optimized,\n            savingsPercentage,\n            userId: context?.userId,\n            lessonId: context?.lessonId\n        };\n        this.optimizationLogs.push(entry);\n        this.trimLogs();\n        // Console logging for development\n        console.log(`[UsageMonitor] Optimization - Strategy: ${strategy}, Savings: ${savings} tokens (${savingsPercentage.toFixed(1)}%)`);\n    }\n    /**\r\n   * Generate comprehensive usage report\r\n   */ async generateUsageReport(startDate, endDate) {\n        const start = startDate || new Date(Date.now() - 30 * 24 * 60 * 60 * 1000); // Default: 30 days ago\n        const end = endDate || new Date();\n        // Filter logs by date range\n        const filteredUsageLogs = this.usageLogs.filter((log)=>log.timestamp >= start && log.timestamp <= end);\n        const filteredErrorLogs = this.errorLogs.filter((log)=>log.timestamp >= start && log.timestamp <= end);\n        const filteredOptimizationLogs = this.optimizationLogs.filter((log)=>log.timestamp >= start && log.timestamp <= end);\n        // Calculate metrics\n        const uniqueLessons = new Set(filteredUsageLogs.map((log)=>log.lessonId).filter(Boolean));\n        const totalLessons = uniqueLessons.size;\n        const totalTokens = filteredUsageLogs.reduce((sum, log)=>sum + log.tokens, 0);\n        const averageTokensPerLesson = totalLessons > 0 ? totalTokens / totalLessons : 0;\n        const totalOptimizationSavings = filteredOptimizationLogs.reduce((sum, log)=>sum + (log.baselineTokens - log.optimizedTokens), 0);\n        const errorRate = totalLessons > 0 ? filteredErrorLogs.length / totalLessons * 100 : 0;\n        // Top optimization strategies\n        const strategyStats = new Map();\n        filteredOptimizationLogs.forEach((log)=>{\n            const current = strategyStats.get(log.strategy) || {\n                usage: 0,\n                totalSavings: 0\n            };\n            current.usage++;\n            current.totalSavings += log.baselineTokens - log.optimizedTokens;\n            strategyStats.set(log.strategy, current);\n        });\n        const topOptimizationStrategies = Array.from(strategyStats.entries()).map(([strategy, stats])=>({\n                strategy,\n                usage: stats.usage,\n                averageSavings: stats.usage > 0 ? stats.totalSavings / stats.usage : 0\n            })).sort((a, b)=>b.usage - a.usage).slice(0, 5);\n        // Error breakdown\n        const errorBreakdown = {};\n        filteredErrorLogs.forEach((log)=>{\n            errorBreakdown[log.errorType] = (errorBreakdown[log.errorType] || 0) + 1;\n        });\n        // Section token breakdown\n        const sectionTokenBreakdown = {};\n        filteredUsageLogs.forEach((log)=>{\n            sectionTokenBreakdown[log.section] = (sectionTokenBreakdown[log.section] || 0) + log.tokens;\n        });\n        return {\n            period: {\n                start,\n                end\n            },\n            totalLessons,\n            totalTokens,\n            averageTokensPerLesson,\n            totalOptimizationSavings,\n            errorRate,\n            topOptimizationStrategies,\n            errorBreakdown,\n            sectionTokenBreakdown\n        };\n    }\n    /**\r\n   * Get usage metrics for a specific lesson\r\n   */ async getLessonMetrics(lessonId) {\n        const lessonLogs = this.usageLogs.filter((log)=>log.lessonId === lessonId);\n        if (lessonLogs.length === 0) {\n            return null;\n        }\n        const totalTokens = lessonLogs.reduce((sum, log)=>sum + log.tokens, 0);\n        const tokensPerSection = {};\n        lessonLogs.forEach((log)=>{\n            tokensPerSection[log.section] = (tokensPerSection[log.section] || 0) + log.tokens;\n        });\n        // Calculate optimization savings for this lesson\n        const lessonOptimizationLogs = this.optimizationLogs.filter((log)=>log.lessonId === lessonId);\n        const optimizationSavings = lessonOptimizationLogs.reduce((sum, log)=>sum + (log.baselineTokens - log.optimizedTokens), 0);\n        // Calculate generation time (time between first and last log entry)\n        const timestamps = lessonLogs.map((log)=>log.timestamp.getTime()).sort();\n        const generationTime = timestamps.length > 1 ? timestamps[timestamps.length - 1] - timestamps[0] : 0;\n        return {\n            totalTokens,\n            tokensPerSection,\n            optimizationSavings,\n            generationTime,\n            timestamp: new Date(timestamps[0])\n        };\n    }\n    /**\r\n   * Clear old logs to prevent memory overflow\r\n   */ async clearOldLogs(olderThanDays) {\n        const cutoffDate = new Date(Date.now() - olderThanDays * 24 * 60 * 60 * 1000);\n        const initialUsageCount = this.usageLogs.length;\n        const initialErrorCount = this.errorLogs.length;\n        const initialOptimizationCount = this.optimizationLogs.length;\n        this.usageLogs = this.usageLogs.filter((log)=>log.timestamp >= cutoffDate);\n        this.errorLogs = this.errorLogs.filter((log)=>log.timestamp >= cutoffDate);\n        this.optimizationLogs = this.optimizationLogs.filter((log)=>log.timestamp >= cutoffDate);\n        const clearedUsage = initialUsageCount - this.usageLogs.length;\n        const clearedErrors = initialErrorCount - this.errorLogs.length;\n        const clearedOptimizations = initialOptimizationCount - this.optimizationLogs.length;\n        console.log(`[UsageMonitor] Cleared old logs: ${clearedUsage} usage, ${clearedErrors} errors, ${clearedOptimizations} optimizations`);\n    }\n    /**\r\n   * Trim logs to prevent memory overflow\r\n   */ trimLogs() {\n        if (this.usageLogs.length > this.maxLogEntries) {\n            this.usageLogs = this.usageLogs.slice(-this.maxLogEntries);\n        }\n        if (this.errorLogs.length > this.maxLogEntries) {\n            this.errorLogs = this.errorLogs.slice(-this.maxLogEntries);\n        }\n        if (this.optimizationLogs.length > this.maxLogEntries) {\n            this.optimizationLogs = this.optimizationLogs.slice(-this.maxLogEntries);\n        }\n    }\n    /**\r\n   * Get current log counts (for debugging)\r\n   */ getLogCounts() {\n        return {\n            usage: this.usageLogs.length,\n            errors: this.errorLogs.length,\n            optimizations: this.optimizationLogs.length\n        };\n    }\n    /**\r\n   * Export logs for external analysis\r\n   */ exportLogs() {\n        return {\n            usage: [\n                ...this.usageLogs\n            ],\n            errors: [\n                ...this.errorLogs\n            ],\n            optimizations: [\n                ...this.optimizationLogs\n            ]\n        };\n    }\n    constructor(){\n        this.usageLogs = [];\n        this.errorLogs = [];\n        this.optimizationLogs = [];\n        this.maxLogEntries = 10000 // Prevent memory overflow\n        ;\n    }\n}\n// Singleton instance for global usage monitoring\nconst usageMonitor = new InMemoryUsageMonitor();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cyI6WyJ3ZWJwYWNrOi8vbXktdjAtcHJvamVjdC8uL2xpYi91c2FnZS1tb25pdG9yLnRzPzMxNTMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFVzYWdlIE1vbml0b3IgU3lzdGVtXHJcbiAqIFxyXG4gKiBQcm92aWRlcyBjb21wcmVoZW5zaXZlIGxvZ2dpbmcgYW5kIG1vbml0b3JpbmcgZm9yIEFJIGxlc3NvbiBnZW5lcmF0aW9uLFxyXG4gKiB0cmFja2luZyB0b2tlbiB1c2FnZSwgZXJyb3JzLCBhbmQgb3B0aW1pemF0aW9uIHNhdmluZ3MuXHJcbiAqL1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBVc2FnZU1ldHJpY3Mge1xyXG4gIHRvdGFsVG9rZW5zOiBudW1iZXI7XHJcbiAgdG9rZW5zUGVyU2VjdGlvbjogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcclxuICBvcHRpbWl6YXRpb25TYXZpbmdzOiBudW1iZXI7XHJcbiAgZ2VuZXJhdGlvblRpbWU6IG51bWJlcjtcclxuICB0aW1lc3RhbXA6IERhdGU7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVXNhZ2VMb2dFbnRyeSB7XHJcbiAgaWQ6IHN0cmluZztcclxuICB0aW1lc3RhbXA6IERhdGU7XHJcbiAgc2VjdGlvbjogc3RyaW5nO1xyXG4gIHRva2VuczogbnVtYmVyO1xyXG4gIG9wdGltaXphdGlvbjogc3RyaW5nO1xyXG4gIHVzZXJJZD86IHN0cmluZztcclxuICBsZXNzb25JZD86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBFcnJvckxvZ0VudHJ5IHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHRpbWVzdGFtcDogRGF0ZTtcclxuICBlcnJvclR5cGU6IHN0cmluZztcclxuICBlcnJvck1lc3NhZ2U6IHN0cmluZztcclxuICBjb250ZXh0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xyXG4gIHVzZXJJZD86IHN0cmluZztcclxuICBsZXNzb25JZD86IHN0cmluZztcclxuICBzdGFja1RyYWNlPzogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIE9wdGltaXphdGlvbkxvZ0VudHJ5IHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHRpbWVzdGFtcDogRGF0ZTtcclxuICBzdHJhdGVneTogc3RyaW5nO1xyXG4gIGJhc2VsaW5lVG9rZW5zOiBudW1iZXI7XHJcbiAgb3B0aW1pemVkVG9rZW5zOiBudW1iZXI7XHJcbiAgc2F2aW5nc1BlcmNlbnRhZ2U6IG51bWJlcjtcclxuICB1c2VySWQ/OiBzdHJpbmc7XHJcbiAgbGVzc29uSWQ/OiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVXNhZ2VSZXBvcnQge1xyXG4gIHBlcmlvZDoge1xyXG4gICAgc3RhcnQ6IERhdGU7XHJcbiAgICBlbmQ6IERhdGU7XHJcbiAgfTtcclxuICB0b3RhbExlc3NvbnM6IG51bWJlcjtcclxuICB0b3RhbFRva2VuczogbnVtYmVyO1xyXG4gIGF2ZXJhZ2VUb2tlbnNQZXJMZXNzb246IG51bWJlcjtcclxuICB0b3RhbE9wdGltaXphdGlvblNhdmluZ3M6IG51bWJlcjtcclxuICBlcnJvclJhdGU6IG51bWJlcjtcclxuICB0b3BPcHRpbWl6YXRpb25TdHJhdGVnaWVzOiBBcnJheTx7XHJcbiAgICBzdHJhdGVneTogc3RyaW5nO1xyXG4gICAgdXNhZ2U6IG51bWJlcjtcclxuICAgIGF2ZXJhZ2VTYXZpbmdzOiBudW1iZXI7XHJcbiAgfT47XHJcbiAgZXJyb3JCcmVha2Rvd246IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XHJcbiAgc2VjdGlvblRva2VuQnJlYWtkb3duOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEdlbmVyYXRpb25Db250ZXh0IHtcclxuICB1c2VySWQ/OiBzdHJpbmc7XHJcbiAgbGVzc29uSWQ/OiBzdHJpbmc7XHJcbiAgbGVzc29uVHlwZT86IHN0cmluZztcclxuICBkaWZmaWN1bHR5TGV2ZWw/OiBzdHJpbmc7XHJcbiAgY29udGVudExlbmd0aD86IG51bWJlcjtcclxuICB0aW1lc3RhbXA6IERhdGU7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVc2FnZSBNb25pdG9yIEludGVyZmFjZVxyXG4gKiBcclxuICogRGVmaW5lcyB0aGUgY29udHJhY3QgZm9yIG1vbml0b3JpbmcgQUkgdXNhZ2UsIGVycm9ycywgYW5kIG9wdGltaXphdGlvbnNcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgVXNhZ2VNb25pdG9yIHtcclxuICAvKipcclxuICAgKiBMb2cgdG9rZW4gdXNhZ2UgZm9yIGEgc3BlY2lmaWMgbGVzc29uIHNlY3Rpb25cclxuICAgKi9cclxuICBsb2dUb2tlblVzYWdlKFxyXG4gICAgc2VjdGlvbjogc3RyaW5nLCBcclxuICAgIHRva2VuczogbnVtYmVyLCBcclxuICAgIG9wdGltaXphdGlvbjogc3RyaW5nLCBcclxuICAgIGNvbnRleHQ/OiBHZW5lcmF0aW9uQ29udGV4dFxyXG4gICk6IHZvaWQ7XHJcblxyXG4gIC8qKlxyXG4gICAqIExvZyBlcnJvcnMgd2l0aCBzcGVjaWZpYyBjb250ZXh0IGZvciBkZWJ1Z2dpbmdcclxuICAgKi9cclxuICBsb2dFcnJvcihcclxuICAgIGVycm9yOiBFcnJvciwgXHJcbiAgICBlcnJvclR5cGU6IHN0cmluZywgXHJcbiAgICBjb250ZXh0OiBHZW5lcmF0aW9uQ29udGV4dFxyXG4gICk6IHZvaWQ7XHJcblxyXG4gIC8qKlxyXG4gICAqIFRyYWNrIG9wdGltaXphdGlvbiBzYXZpbmdzIGFjaGlldmVkXHJcbiAgICovXHJcbiAgbG9nT3B0aW1pemF0aW9uU2F2aW5ncyhcclxuICAgIGJhc2VsaW5lOiBudW1iZXIsIFxyXG4gICAgb3B0aW1pemVkOiBudW1iZXIsIFxyXG4gICAgc3RyYXRlZ3k6IHN0cmluZywgXHJcbiAgICBjb250ZXh0PzogR2VuZXJhdGlvbkNvbnRleHRcclxuICApOiB2b2lkO1xyXG5cclxuICAvKipcclxuICAgKiBHZW5lcmF0ZSBjb21wcmVoZW5zaXZlIHVzYWdlIHJlcG9ydFxyXG4gICAqL1xyXG4gIGdlbmVyYXRlVXNhZ2VSZXBvcnQoc3RhcnREYXRlPzogRGF0ZSwgZW5kRGF0ZT86IERhdGUpOiBQcm9taXNlPFVzYWdlUmVwb3J0PjtcclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHVzYWdlIG1ldHJpY3MgZm9yIGEgc3BlY2lmaWMgbGVzc29uXHJcbiAgICovXHJcbiAgZ2V0TGVzc29uTWV0cmljcyhsZXNzb25JZDogc3RyaW5nKTogUHJvbWlzZTxVc2FnZU1ldHJpY3MgfCBudWxsPjtcclxuXHJcbiAgLyoqXHJcbiAgICogQ2xlYXIgb2xkIGxvZ3MgKGZvciBtYWludGVuYW5jZSlcclxuICAgKi9cclxuICBjbGVhck9sZExvZ3Mob2xkZXJUaGFuRGF5czogbnVtYmVyKTogUHJvbWlzZTx2b2lkPjtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluLU1lbW9yeSBVc2FnZSBNb25pdG9yIEltcGxlbWVudGF0aW9uXHJcbiAqIFxyXG4gKiBTdG9yZXMgdXNhZ2UgZGF0YSBpbiBtZW1vcnkgd2l0aCBvcHRpb25hbCBwZXJzaXN0ZW5jZSB0byBjb25zb2xlL2V4dGVybmFsIHN5c3RlbXMuXHJcbiAqIEluIHByb2R1Y3Rpb24sIHRoaXMgY291bGQgYmUgZXh0ZW5kZWQgdG8gdXNlIGEgZGF0YWJhc2Ugb3IgZXh0ZXJuYWwgbG9nZ2luZyBzZXJ2aWNlLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEluTWVtb3J5VXNhZ2VNb25pdG9yIGltcGxlbWVudHMgVXNhZ2VNb25pdG9yIHtcclxuICBwcml2YXRlIHVzYWdlTG9nczogVXNhZ2VMb2dFbnRyeVtdID0gW107XHJcbiAgcHJpdmF0ZSBlcnJvckxvZ3M6IEVycm9yTG9nRW50cnlbXSA9IFtdO1xyXG4gIHByaXZhdGUgb3B0aW1pemF0aW9uTG9nczogT3B0aW1pemF0aW9uTG9nRW50cnlbXSA9IFtdO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgbWF4TG9nRW50cmllcyA9IDEwMDAwOyAvLyBQcmV2ZW50IG1lbW9yeSBvdmVyZmxvd1xyXG5cclxuICAvKipcclxuICAgKiBHZW5lcmF0ZSB1bmlxdWUgSUQgZm9yIGxvZyBlbnRyaWVzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZW5lcmF0ZUlkKCk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gYCR7RGF0ZS5ub3coKX0tJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIExvZyB0b2tlbiB1c2FnZSBmb3IgYSBsZXNzb24gc2VjdGlvblxyXG4gICAqL1xyXG4gIGxvZ1Rva2VuVXNhZ2UoXHJcbiAgICBzZWN0aW9uOiBzdHJpbmcsIFxyXG4gICAgdG9rZW5zOiBudW1iZXIsIFxyXG4gICAgb3B0aW1pemF0aW9uOiBzdHJpbmcsIFxyXG4gICAgY29udGV4dD86IEdlbmVyYXRpb25Db250ZXh0XHJcbiAgKTogdm9pZCB7XHJcbiAgICBjb25zdCBlbnRyeTogVXNhZ2VMb2dFbnRyeSA9IHtcclxuICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVJZCgpLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXHJcbiAgICAgIHNlY3Rpb24sXHJcbiAgICAgIHRva2VucyxcclxuICAgICAgb3B0aW1pemF0aW9uLFxyXG4gICAgICB1c2VySWQ6IGNvbnRleHQ/LnVzZXJJZCxcclxuICAgICAgbGVzc29uSWQ6IGNvbnRleHQ/Lmxlc3NvbklkXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMudXNhZ2VMb2dzLnB1c2goZW50cnkpO1xyXG4gICAgdGhpcy50cmltTG9ncygpO1xyXG5cclxuICAgIC8vIENvbnNvbGUgbG9nZ2luZyBmb3IgZGV2ZWxvcG1lbnRcclxuICAgIGNvbnNvbGUubG9nKGBbVXNhZ2VNb25pdG9yXSBUb2tlbiB1c2FnZSAtIFNlY3Rpb246ICR7c2VjdGlvbn0sIFRva2VuczogJHt0b2tlbnN9LCBPcHRpbWl6YXRpb246ICR7b3B0aW1pemF0aW9ufWApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTG9nIGVycm9ycyB3aXRoIGNvbnRleHRcclxuICAgKi9cclxuICBsb2dFcnJvcihcclxuICAgIGVycm9yOiBFcnJvciwgXHJcbiAgICBlcnJvclR5cGU6IHN0cmluZywgXHJcbiAgICBjb250ZXh0OiBHZW5lcmF0aW9uQ29udGV4dFxyXG4gICk6IHZvaWQge1xyXG4gICAgY29uc3QgZW50cnk6IEVycm9yTG9nRW50cnkgPSB7XHJcbiAgICAgIGlkOiB0aGlzLmdlbmVyYXRlSWQoKSxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxyXG4gICAgICBlcnJvclR5cGUsXHJcbiAgICAgIGVycm9yTWVzc2FnZTogZXJyb3IubWVzc2FnZSxcclxuICAgICAgY29udGV4dDoge1xyXG4gICAgICAgIGxlc3NvblR5cGU6IGNvbnRleHQubGVzc29uVHlwZSxcclxuICAgICAgICBkaWZmaWN1bHR5TGV2ZWw6IGNvbnRleHQuZGlmZmljdWx0eUxldmVsLFxyXG4gICAgICAgIGNvbnRlbnRMZW5ndGg6IGNvbnRleHQuY29udGVudExlbmd0aCxcclxuICAgICAgICB0aW1lc3RhbXA6IGNvbnRleHQudGltZXN0YW1wXHJcbiAgICAgIH0sXHJcbiAgICAgIHVzZXJJZDogY29udGV4dC51c2VySWQsXHJcbiAgICAgIGxlc3NvbklkOiBjb250ZXh0Lmxlc3NvbklkLFxyXG4gICAgICBzdGFja1RyYWNlOiBlcnJvci5zdGFja1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmVycm9yTG9ncy5wdXNoKGVudHJ5KTtcclxuICAgIHRoaXMudHJpbUxvZ3MoKTtcclxuXHJcbiAgICAvLyBDb25zb2xlIGxvZ2dpbmcgZm9yIGRldmVsb3BtZW50XHJcbiAgICBjb25zb2xlLmVycm9yKGBbVXNhZ2VNb25pdG9yXSBFcnJvciAtIFR5cGU6ICR7ZXJyb3JUeXBlfSwgTWVzc2FnZTogJHtlcnJvci5tZXNzYWdlfWAsIHtcclxuICAgICAgY29udGV4dCxcclxuICAgICAgZXJyb3JJZDogZW50cnkuaWRcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTG9nIG9wdGltaXphdGlvbiBzYXZpbmdzXHJcbiAgICovXHJcbiAgbG9nT3B0aW1pemF0aW9uU2F2aW5ncyhcclxuICAgIGJhc2VsaW5lOiBudW1iZXIsIFxyXG4gICAgb3B0aW1pemVkOiBudW1iZXIsIFxyXG4gICAgc3RyYXRlZ3k6IHN0cmluZywgXHJcbiAgICBjb250ZXh0PzogR2VuZXJhdGlvbkNvbnRleHRcclxuICApOiB2b2lkIHtcclxuICAgIGNvbnN0IHNhdmluZ3MgPSBiYXNlbGluZSAtIG9wdGltaXplZDtcclxuICAgIGNvbnN0IHNhdmluZ3NQZXJjZW50YWdlID0gYmFzZWxpbmUgPiAwID8gKHNhdmluZ3MgLyBiYXNlbGluZSkgKiAxMDAgOiAwO1xyXG5cclxuICAgIGNvbnN0IGVudHJ5OiBPcHRpbWl6YXRpb25Mb2dFbnRyeSA9IHtcclxuICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVJZCgpLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXHJcbiAgICAgIHN0cmF0ZWd5LFxyXG4gICAgICBiYXNlbGluZVRva2VuczogYmFzZWxpbmUsXHJcbiAgICAgIG9wdGltaXplZFRva2Vuczogb3B0aW1pemVkLFxyXG4gICAgICBzYXZpbmdzUGVyY2VudGFnZSxcclxuICAgICAgdXNlcklkOiBjb250ZXh0Py51c2VySWQsXHJcbiAgICAgIGxlc3NvbklkOiBjb250ZXh0Py5sZXNzb25JZFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLm9wdGltaXphdGlvbkxvZ3MucHVzaChlbnRyeSk7XHJcbiAgICB0aGlzLnRyaW1Mb2dzKCk7XHJcblxyXG4gICAgLy8gQ29uc29sZSBsb2dnaW5nIGZvciBkZXZlbG9wbWVudFxyXG4gICAgY29uc29sZS5sb2coYFtVc2FnZU1vbml0b3JdIE9wdGltaXphdGlvbiAtIFN0cmF0ZWd5OiAke3N0cmF0ZWd5fSwgU2F2aW5nczogJHtzYXZpbmdzfSB0b2tlbnMgKCR7c2F2aW5nc1BlcmNlbnRhZ2UudG9GaXhlZCgxKX0lKWApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGUgY29tcHJlaGVuc2l2ZSB1c2FnZSByZXBvcnRcclxuICAgKi9cclxuICBhc3luYyBnZW5lcmF0ZVVzYWdlUmVwb3J0KHN0YXJ0RGF0ZT86IERhdGUsIGVuZERhdGU/OiBEYXRlKTogUHJvbWlzZTxVc2FnZVJlcG9ydD4ge1xyXG4gICAgY29uc3Qgc3RhcnQgPSBzdGFydERhdGUgfHwgbmV3IERhdGUoRGF0ZS5ub3coKSAtIDMwICogMjQgKiA2MCAqIDYwICogMTAwMCk7IC8vIERlZmF1bHQ6IDMwIGRheXMgYWdvXHJcbiAgICBjb25zdCBlbmQgPSBlbmREYXRlIHx8IG5ldyBEYXRlKCk7XHJcblxyXG4gICAgLy8gRmlsdGVyIGxvZ3MgYnkgZGF0ZSByYW5nZVxyXG4gICAgY29uc3QgZmlsdGVyZWRVc2FnZUxvZ3MgPSB0aGlzLnVzYWdlTG9ncy5maWx0ZXIoXHJcbiAgICAgIGxvZyA9PiBsb2cudGltZXN0YW1wID49IHN0YXJ0ICYmIGxvZy50aW1lc3RhbXAgPD0gZW5kXHJcbiAgICApO1xyXG4gICAgY29uc3QgZmlsdGVyZWRFcnJvckxvZ3MgPSB0aGlzLmVycm9yTG9ncy5maWx0ZXIoXHJcbiAgICAgIGxvZyA9PiBsb2cudGltZXN0YW1wID49IHN0YXJ0ICYmIGxvZy50aW1lc3RhbXAgPD0gZW5kXHJcbiAgICApO1xyXG4gICAgY29uc3QgZmlsdGVyZWRPcHRpbWl6YXRpb25Mb2dzID0gdGhpcy5vcHRpbWl6YXRpb25Mb2dzLmZpbHRlcihcclxuICAgICAgbG9nID0+IGxvZy50aW1lc3RhbXAgPj0gc3RhcnQgJiYgbG9nLnRpbWVzdGFtcCA8PSBlbmRcclxuICAgICk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIG1ldHJpY3NcclxuICAgIGNvbnN0IHVuaXF1ZUxlc3NvbnMgPSBuZXcgU2V0KGZpbHRlcmVkVXNhZ2VMb2dzLm1hcChsb2cgPT4gbG9nLmxlc3NvbklkKS5maWx0ZXIoQm9vbGVhbikpO1xyXG4gICAgY29uc3QgdG90YWxMZXNzb25zID0gdW5pcXVlTGVzc29ucy5zaXplO1xyXG4gICAgY29uc3QgdG90YWxUb2tlbnMgPSBmaWx0ZXJlZFVzYWdlTG9ncy5yZWR1Y2UoKHN1bSwgbG9nKSA9PiBzdW0gKyBsb2cudG9rZW5zLCAwKTtcclxuICAgIGNvbnN0IGF2ZXJhZ2VUb2tlbnNQZXJMZXNzb24gPSB0b3RhbExlc3NvbnMgPiAwID8gdG90YWxUb2tlbnMgLyB0b3RhbExlc3NvbnMgOiAwO1xyXG5cclxuICAgIGNvbnN0IHRvdGFsT3B0aW1pemF0aW9uU2F2aW5ncyA9IGZpbHRlcmVkT3B0aW1pemF0aW9uTG9ncy5yZWR1Y2UoXHJcbiAgICAgIChzdW0sIGxvZykgPT4gc3VtICsgKGxvZy5iYXNlbGluZVRva2VucyAtIGxvZy5vcHRpbWl6ZWRUb2tlbnMpLCAwXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IGVycm9yUmF0ZSA9IHRvdGFsTGVzc29ucyA+IDAgPyAoZmlsdGVyZWRFcnJvckxvZ3MubGVuZ3RoIC8gdG90YWxMZXNzb25zKSAqIDEwMCA6IDA7XHJcblxyXG4gICAgLy8gVG9wIG9wdGltaXphdGlvbiBzdHJhdGVnaWVzXHJcbiAgICBjb25zdCBzdHJhdGVneVN0YXRzID0gbmV3IE1hcDxzdHJpbmcsIHsgdXNhZ2U6IG51bWJlcjsgdG90YWxTYXZpbmdzOiBudW1iZXIgfT4oKTtcclxuICAgIGZpbHRlcmVkT3B0aW1pemF0aW9uTG9ncy5mb3JFYWNoKGxvZyA9PiB7XHJcbiAgICAgIGNvbnN0IGN1cnJlbnQgPSBzdHJhdGVneVN0YXRzLmdldChsb2cuc3RyYXRlZ3kpIHx8IHsgdXNhZ2U6IDAsIHRvdGFsU2F2aW5nczogMCB9O1xyXG4gICAgICBjdXJyZW50LnVzYWdlKys7XHJcbiAgICAgIGN1cnJlbnQudG90YWxTYXZpbmdzICs9IChsb2cuYmFzZWxpbmVUb2tlbnMgLSBsb2cub3B0aW1pemVkVG9rZW5zKTtcclxuICAgICAgc3RyYXRlZ3lTdGF0cy5zZXQobG9nLnN0cmF0ZWd5LCBjdXJyZW50KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IHRvcE9wdGltaXphdGlvblN0cmF0ZWdpZXMgPSBBcnJheS5mcm9tKHN0cmF0ZWd5U3RhdHMuZW50cmllcygpKVxyXG4gICAgICAubWFwKChbc3RyYXRlZ3ksIHN0YXRzXSkgPT4gKHtcclxuICAgICAgICBzdHJhdGVneSxcclxuICAgICAgICB1c2FnZTogc3RhdHMudXNhZ2UsXHJcbiAgICAgICAgYXZlcmFnZVNhdmluZ3M6IHN0YXRzLnVzYWdlID4gMCA/IHN0YXRzLnRvdGFsU2F2aW5ncyAvIHN0YXRzLnVzYWdlIDogMFxyXG4gICAgICB9KSlcclxuICAgICAgLnNvcnQoKGEsIGIpID0+IGIudXNhZ2UgLSBhLnVzYWdlKVxyXG4gICAgICAuc2xpY2UoMCwgNSk7XHJcblxyXG4gICAgLy8gRXJyb3IgYnJlYWtkb3duXHJcbiAgICBjb25zdCBlcnJvckJyZWFrZG93bjogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xyXG4gICAgZmlsdGVyZWRFcnJvckxvZ3MuZm9yRWFjaChsb2cgPT4ge1xyXG4gICAgICBlcnJvckJyZWFrZG93bltsb2cuZXJyb3JUeXBlXSA9IChlcnJvckJyZWFrZG93bltsb2cuZXJyb3JUeXBlXSB8fCAwKSArIDE7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBTZWN0aW9uIHRva2VuIGJyZWFrZG93blxyXG4gICAgY29uc3Qgc2VjdGlvblRva2VuQnJlYWtkb3duOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XHJcbiAgICBmaWx0ZXJlZFVzYWdlTG9ncy5mb3JFYWNoKGxvZyA9PiB7XHJcbiAgICAgIHNlY3Rpb25Ub2tlbkJyZWFrZG93bltsb2cuc2VjdGlvbl0gPSAoc2VjdGlvblRva2VuQnJlYWtkb3duW2xvZy5zZWN0aW9uXSB8fCAwKSArIGxvZy50b2tlbnM7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBwZXJpb2Q6IHsgc3RhcnQsIGVuZCB9LFxyXG4gICAgICB0b3RhbExlc3NvbnMsXHJcbiAgICAgIHRvdGFsVG9rZW5zLFxyXG4gICAgICBhdmVyYWdlVG9rZW5zUGVyTGVzc29uLFxyXG4gICAgICB0b3RhbE9wdGltaXphdGlvblNhdmluZ3MsXHJcbiAgICAgIGVycm9yUmF0ZSxcclxuICAgICAgdG9wT3B0aW1pemF0aW9uU3RyYXRlZ2llcyxcclxuICAgICAgZXJyb3JCcmVha2Rvd24sXHJcbiAgICAgIHNlY3Rpb25Ub2tlbkJyZWFrZG93blxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB1c2FnZSBtZXRyaWNzIGZvciBhIHNwZWNpZmljIGxlc3NvblxyXG4gICAqL1xyXG4gIGFzeW5jIGdldExlc3Nvbk1ldHJpY3MobGVzc29uSWQ6IHN0cmluZyk6IFByb21pc2U8VXNhZ2VNZXRyaWNzIHwgbnVsbD4ge1xyXG4gICAgY29uc3QgbGVzc29uTG9ncyA9IHRoaXMudXNhZ2VMb2dzLmZpbHRlcihsb2cgPT4gbG9nLmxlc3NvbklkID09PSBsZXNzb25JZCk7XHJcbiAgICBcclxuICAgIGlmIChsZXNzb25Mb2dzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB0b3RhbFRva2VucyA9IGxlc3NvbkxvZ3MucmVkdWNlKChzdW0sIGxvZykgPT4gc3VtICsgbG9nLnRva2VucywgMCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHRva2Vuc1BlclNlY3Rpb246IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcclxuICAgIGxlc3NvbkxvZ3MuZm9yRWFjaChsb2cgPT4ge1xyXG4gICAgICB0b2tlbnNQZXJTZWN0aW9uW2xvZy5zZWN0aW9uXSA9ICh0b2tlbnNQZXJTZWN0aW9uW2xvZy5zZWN0aW9uXSB8fCAwKSArIGxvZy50b2tlbnM7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgb3B0aW1pemF0aW9uIHNhdmluZ3MgZm9yIHRoaXMgbGVzc29uXHJcbiAgICBjb25zdCBsZXNzb25PcHRpbWl6YXRpb25Mb2dzID0gdGhpcy5vcHRpbWl6YXRpb25Mb2dzLmZpbHRlcihsb2cgPT4gbG9nLmxlc3NvbklkID09PSBsZXNzb25JZCk7XHJcbiAgICBjb25zdCBvcHRpbWl6YXRpb25TYXZpbmdzID0gbGVzc29uT3B0aW1pemF0aW9uTG9ncy5yZWR1Y2UoXHJcbiAgICAgIChzdW0sIGxvZykgPT4gc3VtICsgKGxvZy5iYXNlbGluZVRva2VucyAtIGxvZy5vcHRpbWl6ZWRUb2tlbnMpLCAwXHJcbiAgICApO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSBnZW5lcmF0aW9uIHRpbWUgKHRpbWUgYmV0d2VlbiBmaXJzdCBhbmQgbGFzdCBsb2cgZW50cnkpXHJcbiAgICBjb25zdCB0aW1lc3RhbXBzID0gbGVzc29uTG9ncy5tYXAobG9nID0+IGxvZy50aW1lc3RhbXAuZ2V0VGltZSgpKS5zb3J0KCk7XHJcbiAgICBjb25zdCBnZW5lcmF0aW9uVGltZSA9IHRpbWVzdGFtcHMubGVuZ3RoID4gMSA/IHRpbWVzdGFtcHNbdGltZXN0YW1wcy5sZW5ndGggLSAxXSAtIHRpbWVzdGFtcHNbMF0gOiAwO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRvdGFsVG9rZW5zLFxyXG4gICAgICB0b2tlbnNQZXJTZWN0aW9uLFxyXG4gICAgICBvcHRpbWl6YXRpb25TYXZpbmdzLFxyXG4gICAgICBnZW5lcmF0aW9uVGltZSxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSh0aW1lc3RhbXBzWzBdKVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsZWFyIG9sZCBsb2dzIHRvIHByZXZlbnQgbWVtb3J5IG92ZXJmbG93XHJcbiAgICovXHJcbiAgYXN5bmMgY2xlYXJPbGRMb2dzKG9sZGVyVGhhbkRheXM6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc3QgY3V0b2ZmRGF0ZSA9IG5ldyBEYXRlKERhdGUubm93KCkgLSBvbGRlclRoYW5EYXlzICogMjQgKiA2MCAqIDYwICogMTAwMCk7XHJcbiAgICBcclxuICAgIGNvbnN0IGluaXRpYWxVc2FnZUNvdW50ID0gdGhpcy51c2FnZUxvZ3MubGVuZ3RoO1xyXG4gICAgY29uc3QgaW5pdGlhbEVycm9yQ291bnQgPSB0aGlzLmVycm9yTG9ncy5sZW5ndGg7XHJcbiAgICBjb25zdCBpbml0aWFsT3B0aW1pemF0aW9uQ291bnQgPSB0aGlzLm9wdGltaXphdGlvbkxvZ3MubGVuZ3RoO1xyXG5cclxuICAgIHRoaXMudXNhZ2VMb2dzID0gdGhpcy51c2FnZUxvZ3MuZmlsdGVyKGxvZyA9PiBsb2cudGltZXN0YW1wID49IGN1dG9mZkRhdGUpO1xyXG4gICAgdGhpcy5lcnJvckxvZ3MgPSB0aGlzLmVycm9yTG9ncy5maWx0ZXIobG9nID0+IGxvZy50aW1lc3RhbXAgPj0gY3V0b2ZmRGF0ZSk7XHJcbiAgICB0aGlzLm9wdGltaXphdGlvbkxvZ3MgPSB0aGlzLm9wdGltaXphdGlvbkxvZ3MuZmlsdGVyKGxvZyA9PiBsb2cudGltZXN0YW1wID49IGN1dG9mZkRhdGUpO1xyXG5cclxuICAgIGNvbnN0IGNsZWFyZWRVc2FnZSA9IGluaXRpYWxVc2FnZUNvdW50IC0gdGhpcy51c2FnZUxvZ3MubGVuZ3RoO1xyXG4gICAgY29uc3QgY2xlYXJlZEVycm9ycyA9IGluaXRpYWxFcnJvckNvdW50IC0gdGhpcy5lcnJvckxvZ3MubGVuZ3RoO1xyXG4gICAgY29uc3QgY2xlYXJlZE9wdGltaXphdGlvbnMgPSBpbml0aWFsT3B0aW1pemF0aW9uQ291bnQgLSB0aGlzLm9wdGltaXphdGlvbkxvZ3MubGVuZ3RoO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKGBbVXNhZ2VNb25pdG9yXSBDbGVhcmVkIG9sZCBsb2dzOiAke2NsZWFyZWRVc2FnZX0gdXNhZ2UsICR7Y2xlYXJlZEVycm9yc30gZXJyb3JzLCAke2NsZWFyZWRPcHRpbWl6YXRpb25zfSBvcHRpbWl6YXRpb25zYCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUcmltIGxvZ3MgdG8gcHJldmVudCBtZW1vcnkgb3ZlcmZsb3dcclxuICAgKi9cclxuICBwcml2YXRlIHRyaW1Mb2dzKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMudXNhZ2VMb2dzLmxlbmd0aCA+IHRoaXMubWF4TG9nRW50cmllcykge1xyXG4gICAgICB0aGlzLnVzYWdlTG9ncyA9IHRoaXMudXNhZ2VMb2dzLnNsaWNlKC10aGlzLm1heExvZ0VudHJpZXMpO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuZXJyb3JMb2dzLmxlbmd0aCA+IHRoaXMubWF4TG9nRW50cmllcykge1xyXG4gICAgICB0aGlzLmVycm9yTG9ncyA9IHRoaXMuZXJyb3JMb2dzLnNsaWNlKC10aGlzLm1heExvZ0VudHJpZXMpO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMub3B0aW1pemF0aW9uTG9ncy5sZW5ndGggPiB0aGlzLm1heExvZ0VudHJpZXMpIHtcclxuICAgICAgdGhpcy5vcHRpbWl6YXRpb25Mb2dzID0gdGhpcy5vcHRpbWl6YXRpb25Mb2dzLnNsaWNlKC10aGlzLm1heExvZ0VudHJpZXMpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGN1cnJlbnQgbG9nIGNvdW50cyAoZm9yIGRlYnVnZ2luZylcclxuICAgKi9cclxuICBnZXRMb2dDb3VudHMoKTogeyB1c2FnZTogbnVtYmVyOyBlcnJvcnM6IG51bWJlcjsgb3B0aW1pemF0aW9uczogbnVtYmVyIH0ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdXNhZ2U6IHRoaXMudXNhZ2VMb2dzLmxlbmd0aCxcclxuICAgICAgZXJyb3JzOiB0aGlzLmVycm9yTG9ncy5sZW5ndGgsXHJcbiAgICAgIG9wdGltaXphdGlvbnM6IHRoaXMub3B0aW1pemF0aW9uTG9ncy5sZW5ndGhcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFeHBvcnQgbG9ncyBmb3IgZXh0ZXJuYWwgYW5hbHlzaXNcclxuICAgKi9cclxuICBleHBvcnRMb2dzKCk6IHtcclxuICAgIHVzYWdlOiBVc2FnZUxvZ0VudHJ5W107XHJcbiAgICBlcnJvcnM6IEVycm9yTG9nRW50cnlbXTtcclxuICAgIG9wdGltaXphdGlvbnM6IE9wdGltaXphdGlvbkxvZ0VudHJ5W107XHJcbiAgfSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB1c2FnZTogWy4uLnRoaXMudXNhZ2VMb2dzXSxcclxuICAgICAgZXJyb3JzOiBbLi4udGhpcy5lcnJvckxvZ3NdLFxyXG4gICAgICBvcHRpbWl6YXRpb25zOiBbLi4udGhpcy5vcHRpbWl6YXRpb25Mb2dzXVxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8vIFNpbmdsZXRvbiBpbnN0YW5jZSBmb3IgZ2xvYmFsIHVzYWdlIG1vbml0b3JpbmdcclxuZXhwb3J0IGNvbnN0IHVzYWdlTW9uaXRvciA9IG5ldyBJbk1lbW9yeVVzYWdlTW9uaXRvcigpOyJdLCJuYW1lcyI6WyJJbk1lbW9yeVVzYWdlTW9uaXRvciIsImdlbmVyYXRlSWQiLCJEYXRlIiwibm93IiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyIiwibG9nVG9rZW5Vc2FnZSIsInNlY3Rpb24iLCJ0b2tlbnMiLCJvcHRpbWl6YXRpb24iLCJjb250ZXh0IiwiZW50cnkiLCJpZCIsInRpbWVzdGFtcCIsInVzZXJJZCIsImxlc3NvbklkIiwidXNhZ2VMb2dzIiwicHVzaCIsInRyaW1Mb2dzIiwiY29uc29sZSIsImxvZyIsImxvZ0Vycm9yIiwiZXJyb3IiLCJlcnJvclR5cGUiLCJlcnJvck1lc3NhZ2UiLCJtZXNzYWdlIiwibGVzc29uVHlwZSIsImRpZmZpY3VsdHlMZXZlbCIsImNvbnRlbnRMZW5ndGgiLCJzdGFja1RyYWNlIiwic3RhY2siLCJlcnJvckxvZ3MiLCJlcnJvcklkIiwibG9nT3B0aW1pemF0aW9uU2F2aW5ncyIsImJhc2VsaW5lIiwib3B0aW1pemVkIiwic3RyYXRlZ3kiLCJzYXZpbmdzIiwic2F2aW5nc1BlcmNlbnRhZ2UiLCJiYXNlbGluZVRva2VucyIsIm9wdGltaXplZFRva2VucyIsIm9wdGltaXphdGlvbkxvZ3MiLCJ0b0ZpeGVkIiwiZ2VuZXJhdGVVc2FnZVJlcG9ydCIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJzdGFydCIsImVuZCIsImZpbHRlcmVkVXNhZ2VMb2dzIiwiZmlsdGVyIiwiZmlsdGVyZWRFcnJvckxvZ3MiLCJmaWx0ZXJlZE9wdGltaXphdGlvbkxvZ3MiLCJ1bmlxdWVMZXNzb25zIiwiU2V0IiwibWFwIiwiQm9vbGVhbiIsInRvdGFsTGVzc29ucyIsInNpemUiLCJ0b3RhbFRva2VucyIsInJlZHVjZSIsInN1bSIsImF2ZXJhZ2VUb2tlbnNQZXJMZXNzb24iLCJ0b3RhbE9wdGltaXphdGlvblNhdmluZ3MiLCJlcnJvclJhdGUiLCJsZW5ndGgiLCJzdHJhdGVneVN0YXRzIiwiTWFwIiwiZm9yRWFjaCIsImN1cnJlbnQiLCJnZXQiLCJ1c2FnZSIsInRvdGFsU2F2aW5ncyIsInNldCIsInRvcE9wdGltaXphdGlvblN0cmF0ZWdpZXMiLCJBcnJheSIsImZyb20iLCJlbnRyaWVzIiwic3RhdHMiLCJhdmVyYWdlU2F2aW5ncyIsInNvcnQiLCJhIiwiYiIsInNsaWNlIiwiZXJyb3JCcmVha2Rvd24iLCJzZWN0aW9uVG9rZW5CcmVha2Rvd24iLCJwZXJpb2QiLCJnZXRMZXNzb25NZXRyaWNzIiwibGVzc29uTG9ncyIsInRva2Vuc1BlclNlY3Rpb24iLCJsZXNzb25PcHRpbWl6YXRpb25Mb2dzIiwib3B0aW1pemF0aW9uU2F2aW5ncyIsInRpbWVzdGFtcHMiLCJnZXRUaW1lIiwiZ2VuZXJhdGlvblRpbWUiLCJjbGVhck9sZExvZ3MiLCJvbGRlclRoYW5EYXlzIiwiY3V0b2ZmRGF0ZSIsImluaXRpYWxVc2FnZUNvdW50IiwiaW5pdGlhbEVycm9yQ291bnQiLCJpbml0aWFsT3B0aW1pemF0aW9uQ291bnQiLCJjbGVhcmVkVXNhZ2UiLCJjbGVhcmVkRXJyb3JzIiwiY2xlYXJlZE9wdGltaXphdGlvbnMiLCJtYXhMb2dFbnRyaWVzIiwiZ2V0TG9nQ291bnRzIiwiZXJyb3JzIiwib3B0aW1pemF0aW9ucyIsImV4cG9ydExvZ3MiLCJ1c2FnZU1vbml0b3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/usage-monitor.ts\n");

/***/ }),

/***/ "(rsc)/./lib/warmup-validator.ts":
/*!*********************************!*\
  !*** ./lib/warmup-validator.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   WarmupValidator: () => (/* binding */ WarmupValidator)\n/* harmony export */ });\n/**\r\n * Warm-up question validator\r\n * Validates that warm-up questions meet pedagogical requirements\r\n */ class WarmupValidator {\n    /**\r\n   * Validate warm-up questions against all quality criteria\r\n   */ validate(questions, cefrLevel, context) {\n        const issues = [];\n        const warnings = [];\n        // 1. Validate question count\n        this.validateQuestionCount(questions, issues);\n        // 2. Validate question format\n        this.validateQuestionFormat(questions, issues, warnings);\n        // 3. Validate no content assumptions\n        this.validateNoContentAssumptions(questions, issues, warnings);\n        // 4. Validate CEFR level appropriateness\n        this.validateCEFRComplexity(questions, cefrLevel, issues, warnings);\n        // 5. Validate pedagogical quality\n        this.validatePedagogicalQuality(questions, issues, warnings);\n        // Calculate quality score\n        const score = this.calculateQualityScore(issues, warnings, questions.length);\n        return {\n            isValid: issues.length === 0,\n            issues,\n            warnings,\n            score\n        };\n    }\n    /**\r\n   * Validate that we have the correct number of questions\r\n   */ validateQuestionCount(questions, issues) {\n        if (questions.length < this.REQUIRED_QUESTION_COUNT) {\n            issues.push({\n                type: \"count_error\",\n                severity: \"error\",\n                message: `Insufficient questions: expected ${this.REQUIRED_QUESTION_COUNT}, got ${questions.length}`,\n                suggestion: \"Generate more questions to meet the requirement\"\n            });\n        } else if (questions.length > this.REQUIRED_QUESTION_COUNT) {\n            issues.push({\n                type: \"count_error\",\n                severity: \"error\",\n                message: `Too many questions: expected ${this.REQUIRED_QUESTION_COUNT}, got ${questions.length}`,\n                suggestion: \"Remove extra questions to meet the requirement\"\n            });\n        }\n    }\n    /**\r\n   * Validate question format (length, punctuation, structure)\r\n   */ validateQuestionFormat(questions, issues, warnings) {\n        questions.forEach((question, index)=>{\n            // Check length\n            if (question.length < this.MIN_QUESTION_LENGTH) {\n                issues.push({\n                    type: \"format_error\",\n                    severity: \"error\",\n                    message: `Question ${index + 1} is too short (${question.length} characters)`,\n                    questionIndex: index,\n                    suggestion: \"Questions should be at least 10 characters long\"\n                });\n            }\n            if (question.length > this.MAX_QUESTION_LENGTH) {\n                warnings.push({\n                    type: \"format_error\",\n                    severity: \"warning\",\n                    message: `Question ${index + 1} is very long (${question.length} characters)`,\n                    questionIndex: index,\n                    suggestion: \"Consider simplifying the question\"\n                });\n            }\n            // Check for question mark\n            if (!question.endsWith(\"?\")) {\n                issues.push({\n                    type: \"format_error\",\n                    severity: \"error\",\n                    message: `Question ${index + 1} doesn't end with a question mark`,\n                    questionIndex: index,\n                    suggestion: \"Add a question mark at the end\"\n                });\n            }\n            // Check for question words\n            const questionWords = [\n                \"what\",\n                \"when\",\n                \"where\",\n                \"who\",\n                \"why\",\n                \"how\",\n                \"do\",\n                \"does\",\n                \"did\",\n                \"have\",\n                \"has\",\n                \"is\",\n                \"are\",\n                \"can\",\n                \"could\",\n                \"would\",\n                \"should\",\n                \"will\"\n            ];\n            const startsWithQuestionWord = questionWords.some((word)=>question.toLowerCase().startsWith(word + \" \"));\n            if (!startsWithQuestionWord) {\n                warnings.push({\n                    type: \"format_error\",\n                    severity: \"warning\",\n                    message: `Question ${index + 1} doesn't start with a typical question word`,\n                    questionIndex: index,\n                    suggestion: \"Consider starting with What, How, Why, etc.\"\n                });\n            }\n            // Check for empty or whitespace-only content\n            if (question.trim().length === 0) {\n                issues.push({\n                    type: \"format_error\",\n                    severity: \"error\",\n                    message: `Question ${index + 1} is empty`,\n                    questionIndex: index,\n                    suggestion: \"Provide a valid question\"\n                });\n            }\n        });\n    }\n    /**\r\n   * Validate that questions don't reference specific content details\r\n   */ validateNoContentAssumptions(questions, issues, warnings) {\n        // Patterns that indicate content assumptions\n        const contentAssumptionPatterns = [\n            {\n                pattern: /what happened/i,\n                message: \"References specific events\"\n            },\n            {\n                pattern: /in the (text|story|article|passage|reading)/i,\n                message: \"References the text directly\"\n            },\n            {\n                pattern: /according to (the )?(text|story|article|author)/i,\n                message: \"References the text/author\"\n            },\n            {\n                pattern: /the author (said|wrote|mentioned|stated|explained)/i,\n                message: \"References author statements\"\n            },\n            {\n                pattern: /do you remember/i,\n                message: \"Assumes prior knowledge of content\"\n            },\n            {\n                pattern: /what did .+ do/i,\n                message: \"References specific actions\"\n            },\n            {\n                pattern: /why did .+ happen/i,\n                message: \"References specific events\"\n            },\n            {\n                pattern: /when did/i,\n                message: \"References specific timing\"\n            },\n            {\n                pattern: /who (was|were|did)/i,\n                message: \"References specific people\"\n            },\n            {\n                pattern: /which (person|character|event)/i,\n                message: \"References specific content elements\"\n            },\n            {\n                pattern: /the (story|text|article|passage) (says|mentions|describes|tells)/i,\n                message: \"References text content\"\n            },\n            {\n                pattern: /in this (story|text|article)/i,\n                message: \"References the text\"\n            },\n            {\n                pattern: /from the (story|text|article)/i,\n                message: \"References the text\"\n            }\n        ];\n        questions.forEach((question, index)=>{\n            for (const { pattern, message } of contentAssumptionPatterns){\n                if (pattern.test(question)) {\n                    issues.push({\n                        type: \"content_assumption\",\n                        severity: \"error\",\n                        message: `Question ${index + 1} assumes content knowledge: ${message}`,\n                        questionIndex: index,\n                        suggestion: \"Rephrase to focus on personal experience or general knowledge\"\n                    });\n                    break; // Only report first match per question\n                }\n            }\n            // Check for proper names (potential content-specific references)\n            const words = question.split(\" \");\n            const suspiciousCapitalizedWords = words.filter((word)=>/^[A-Z][a-z]+$/.test(word) && !this.isCommonQuestionWord(word) && !this.isCommonNoun(word));\n            if (suspiciousCapitalizedWords.length > 0) {\n                warnings.push({\n                    type: \"content_assumption\",\n                    severity: \"warning\",\n                    message: `Question ${index + 1} may contain proper names: ${suspiciousCapitalizedWords.join(\", \")}`,\n                    questionIndex: index,\n                    suggestion: \"Verify these are not content-specific names\"\n                });\n            }\n            // Check for specific dates or numbers that might reference content\n            if (/\\b(19|20)\\d{2}\\b/.test(question)) {\n                warnings.push({\n                    type: \"content_assumption\",\n                    severity: \"warning\",\n                    message: `Question ${index + 1} contains a specific year`,\n                    questionIndex: index,\n                    suggestion: \"Avoid referencing specific dates unless asking about general knowledge\"\n                });\n            }\n        });\n    }\n    /**\r\n   * Validate CEFR level appropriateness\r\n   */ validateCEFRComplexity(questions, cefrLevel, issues, warnings) {\n        const complexity = this.assessQuestionComplexity(questions);\n        const expectedComplexity = this.getExpectedComplexity(cefrLevel);\n        if (!expectedComplexity.includes(complexity)) {\n            issues.push({\n                type: \"complexity_mismatch\",\n                severity: \"error\",\n                message: `Questions are ${complexity} but ${cefrLevel} requires ${expectedComplexity.join(\" or \")}`,\n                suggestion: `Adjust question complexity to match ${cefrLevel} level`\n            });\n        }\n        // Check vocabulary complexity\n        questions.forEach((question, index)=>{\n            const vocabularyLevel = this.assessVocabularyLevel(question);\n            if (vocabularyLevel === \"too_simple\" && [\n                \"B2\",\n                \"C1\"\n            ].includes(cefrLevel)) {\n                warnings.push({\n                    type: \"complexity_mismatch\",\n                    severity: \"warning\",\n                    message: `Question ${index + 1} uses very simple vocabulary for ${cefrLevel} level`,\n                    questionIndex: index,\n                    suggestion: \"Consider using more sophisticated vocabulary\"\n                });\n            }\n            if (vocabularyLevel === \"too_complex\" && [\n                \"A1\",\n                \"A2\"\n            ].includes(cefrLevel)) {\n                warnings.push({\n                    type: \"complexity_mismatch\",\n                    severity: \"warning\",\n                    message: `Question ${index + 1} may use vocabulary too advanced for ${cefrLevel} level`,\n                    questionIndex: index,\n                    suggestion: \"Simplify vocabulary for beginner level\"\n                });\n            }\n        });\n        // Check sentence structure complexity\n        questions.forEach((question, index)=>{\n            const structureComplexity = this.assessSentenceStructure(question);\n            if (structureComplexity === \"complex\" && [\n                \"A1\",\n                \"A2\"\n            ].includes(cefrLevel)) {\n                warnings.push({\n                    type: \"complexity_mismatch\",\n                    severity: \"warning\",\n                    message: `Question ${index + 1} has complex sentence structure for ${cefrLevel} level`,\n                    questionIndex: index,\n                    suggestion: \"Use simpler sentence structures\"\n                });\n            }\n            if (structureComplexity === \"simple\" && cefrLevel === \"C1\") {\n                warnings.push({\n                    type: \"complexity_mismatch\",\n                    severity: \"warning\",\n                    message: `Question ${index + 1} has simple structure for ${cefrLevel} level`,\n                    questionIndex: index,\n                    suggestion: \"Consider using more sophisticated structures\"\n                });\n            }\n        });\n    }\n    /**\r\n   * Validate pedagogical quality (activates prior knowledge, builds interest)\r\n   */ validatePedagogicalQuality(questions, issues, warnings) {\n        // Check for personal experience focus\n        const personalExperiencePatterns = [\n            /have you (ever)?/i,\n            /do you (think|believe|feel)/i,\n            /what (is|are) your/i,\n            /in your (opinion|experience)/i,\n            /how do you/i\n        ];\n        let personalQuestionCount = 0;\n        questions.forEach((question, index)=>{\n            const hasPersonalFocus = personalExperiencePatterns.some((pattern)=>pattern.test(question));\n            if (hasPersonalFocus) {\n                personalQuestionCount++;\n            }\n        });\n        if (personalQuestionCount === 0) {\n            warnings.push({\n                type: \"quality_issue\",\n                severity: \"warning\",\n                message: \"No questions focus on personal experience\",\n                suggestion: \"Include questions that ask about student experiences or opinions\"\n            });\n        }\n        // Check for variety in question types\n        const questionStarters = questions.map((q)=>{\n            const firstWord = q.trim().split(\" \")[0].toLowerCase();\n            return firstWord;\n        });\n        const uniqueStarters = new Set(questionStarters);\n        if (uniqueStarters.size === 1 && questions.length > 1) {\n            warnings.push({\n                type: \"quality_issue\",\n                severity: \"warning\",\n                message: \"All questions start with the same word\",\n                suggestion: \"Vary question types for better engagement\"\n            });\n        }\n        // Check for yes/no questions (should have some open-ended)\n        const yesNoPatterns = [\n            /^do you/i,\n            /^have you/i,\n            /^is (it|there)/i,\n            /^are (you|there)/i,\n            /^can you/i,\n            /^would you/i\n        ];\n        let yesNoCount = 0;\n        questions.forEach((question)=>{\n            if (yesNoPatterns.some((pattern)=>pattern.test(question))) {\n                yesNoCount++;\n            }\n        });\n        if (yesNoCount === questions.length) {\n            warnings.push({\n                type: \"quality_issue\",\n                severity: \"warning\",\n                message: \"All questions appear to be yes/no questions\",\n                suggestion: \"Include open-ended questions (What, How, Why) for deeper discussion\"\n            });\n        }\n    }\n    /**\r\n   * Assess overall question complexity\r\n   */ assessQuestionComplexity(questions) {\n        const allText = questions.join(\" \").toLowerCase();\n        // Advanced indicators\n        const advancedPatterns = [\n            /hypothetically/i,\n            /in what ways/i,\n            /to what extent/i,\n            /how might/i,\n            /what factors/i,\n            /analyze/i,\n            /evaluate/i,\n            /compare and contrast/i,\n            /what implications/i,\n            /how would you assess/i\n        ];\n        // Intermediate indicators\n        const intermediatePatterns = [\n            /why do you think/i,\n            /what would/i,\n            /how could/i,\n            /in your opinion/i,\n            /do you believe/i,\n            /what are the (advantages|disadvantages)/i,\n            /how does .+ affect/i\n        ];\n        const advancedCount = advancedPatterns.filter((pattern)=>pattern.test(allText)).length;\n        const intermediateCount = intermediatePatterns.filter((pattern)=>pattern.test(allText)).length;\n        if (advancedCount >= 2) return \"advanced\";\n        if (advancedCount >= 1 || intermediateCount >= 2) return \"intermediate\";\n        return \"simple\";\n    }\n    /**\r\n   * Get expected complexity for CEFR level\r\n   */ getExpectedComplexity(level) {\n        const levelComplexityMap = {\n            \"A1\": [\n                \"simple\"\n            ],\n            \"A2\": [\n                \"simple\"\n            ],\n            \"B1\": [\n                \"simple\",\n                \"intermediate\"\n            ],\n            \"B2\": [\n                \"intermediate\",\n                \"advanced\"\n            ],\n            \"C1\": [\n                \"advanced\",\n                \"intermediate\"\n            ]\n        };\n        return levelComplexityMap[level];\n    }\n    /**\r\n   * Assess vocabulary level in a question\r\n   */ assessVocabularyLevel(question) {\n        const words = question.toLowerCase().split(/\\s+/);\n        // Very simple words\n        const verySimpleWords = [\n            \"you\",\n            \"your\",\n            \"have\",\n            \"do\",\n            \"what\",\n            \"how\",\n            \"is\",\n            \"are\",\n            \"the\",\n            \"a\",\n            \"an\",\n            \"like\",\n            \"want\",\n            \"go\",\n            \"see\",\n            \"get\"\n        ];\n        const simpleWordCount = words.filter((w)=>verySimpleWords.includes(w)).length;\n        const simpleRatio = simpleWordCount / words.length;\n        // Complex words (longer, less common)\n        const complexWords = words.filter((w)=>w.length > 10 || /tion|sion|ment|ness|ity/.test(w));\n        const complexRatio = complexWords.length / words.length;\n        if (simpleRatio > 0.8) return \"too_simple\";\n        if (complexRatio > 0.3) return \"too_complex\";\n        return \"appropriate\";\n    }\n    /**\r\n   * Assess sentence structure complexity\r\n   */ assessSentenceStructure(question) {\n        // Count clauses (rough estimate based on conjunctions and commas)\n        const clauseIndicators = question.match(/,|and|but|or|because|although|if|when|while|which|that/gi);\n        const clauseCount = clauseIndicators ? clauseIndicators.length + 1 : 1;\n        // Count words\n        const wordCount = question.split(/\\s+/).length;\n        if (clauseCount >= 3 || wordCount > 20) return \"complex\";\n        if (clauseCount === 2 || wordCount > 12) return \"moderate\";\n        return \"simple\";\n    }\n    /**\r\n   * Check if word is a common question word\r\n   */ isCommonQuestionWord(word) {\n        const questionWords = [\n            \"What\",\n            \"When\",\n            \"Where\",\n            \"Who\",\n            \"Why\",\n            \"How\",\n            \"Do\",\n            \"Does\",\n            \"Did\",\n            \"Have\",\n            \"Has\",\n            \"Is\",\n            \"Are\",\n            \"Can\",\n            \"Could\",\n            \"Would\",\n            \"Should\",\n            \"Will\",\n            \"Which\"\n        ];\n        return questionWords.includes(word);\n    }\n    /**\r\n   * Check if word is a common noun that's typically capitalized\r\n   */ isCommonNoun(word) {\n        const commonNouns = [\n            \"English\",\n            \"Spanish\",\n            \"French\",\n            \"German\",\n            \"Chinese\",\n            \"Japanese\",\n            \"Monday\",\n            \"Tuesday\",\n            \"Wednesday\",\n            \"Thursday\",\n            \"Friday\",\n            \"Saturday\",\n            \"Sunday\",\n            \"January\",\n            \"February\",\n            \"March\",\n            \"April\",\n            \"May\",\n            \"June\",\n            \"July\",\n            \"August\",\n            \"September\",\n            \"October\",\n            \"November\",\n            \"December\"\n        ];\n        return commonNouns.includes(word);\n    }\n    /**\r\n   * Calculate overall quality score\r\n   */ calculateQualityScore(issues, warnings, questionCount) {\n        let score = 100;\n        // Deduct points for errors\n        score -= issues.length * 20;\n        // Deduct points for warnings\n        score -= warnings.length * 5;\n        // Bonus for correct question count\n        if (questionCount === this.REQUIRED_QUESTION_COUNT) {\n            score += 10;\n        }\n        // Ensure score is between 0 and 100\n        return Math.max(0, Math.min(100, score));\n    }\n    constructor(){\n        this.REQUIRED_QUESTION_COUNT = 3;\n        this.MIN_QUESTION_LENGTH = 10;\n        this.MAX_QUESTION_LENGTH = 200;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aEM7SUFFQTs7R0FFQyxHQUNELGFBQXFCQSxJQUFZLEVBQVc7UUFDMUMsTUFBTW9ELGNBQWM7WUFBQztZQUFXO1lBQVc7WUFBVTtZQUFVO1lBQVc7WUFBWTtZQUFVO1lBQVc7WUFBYTtZQUFZO1lBQVU7WUFBWTtZQUFVO1lBQVc7WUFBWTtZQUFTO1lBQVM7WUFBTztZQUFRO1lBQVE7WUFBVTtZQUFhO1lBQVc7WUFBWTtTQUFXO1FBQzdSLE9BQU9BLFlBQVlsQyxRQUFRLENBQUNsQjtJQUM5QjtJQUVBOztHQUVDLEdBQ0Qsc0JBQThCM0IsTUFBeUIsRUFBRUMsUUFBMkIsRUFBRStFLGFBQXFCLEVBQVU7UUFDbkgsSUFBSXpFLFFBQVE7UUFFWiwyQkFBMkI7UUFDM0JBLFNBQVNQLE9BQU9TLE1BQU0sR0FBRztRQUV6Qiw2QkFBNkI7UUFDN0JGLFNBQVNOLFNBQVNRLE1BQU0sR0FBRztRQUUzQixtQ0FBbUM7UUFDbkMsSUFBSXVFLGtCQUFrQixJQUFJLENBQUNyRSx1QkFBdUIsRUFBRTtZQUNsREosU0FBUztRQUNYO1FBRUEsb0NBQW9DO1FBQ3BDLE9BQU8wRSxLQUFLQyxHQUFHLENBQUMsR0FBR0QsS0FBS0UsR0FBRyxDQUFDLEtBQUs1RTtJQUNuQzs7YUF2Y2lCSSwwQkFBMEI7YUFDMUJTLHNCQUFzQjthQUN0QkUsc0JBQXNCOztBQXNjekMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL3dhcm11cC12YWxpZGF0b3IudHM/Mjg5NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IENFRlJMZXZlbCB9IGZyb20gJy4vcHJvZ3Jlc3NpdmUtZ2VuZXJhdG9yJ1xyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRpb24gcmVzdWx0IGZvciB3YXJtLXVwIHF1ZXN0aW9uc1xyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBXYXJtdXBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICBpc1ZhbGlkOiBib29sZWFuXHJcbiAgaXNzdWVzOiBWYWxpZGF0aW9uSXNzdWVbXVxyXG4gIHdhcm5pbmdzOiBWYWxpZGF0aW9uSXNzdWVbXVxyXG4gIHNjb3JlOiBudW1iZXIgLy8gMC0xMDAgcXVhbGl0eSBzY29yZVxyXG59XHJcblxyXG4vKipcclxuICogSW5kaXZpZHVhbCB2YWxpZGF0aW9uIGlzc3VlXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRpb25Jc3N1ZSB7XHJcbiAgdHlwZTogJ2NvbnRlbnRfYXNzdW1wdGlvbicgfCAnY29tcGxleGl0eV9taXNtYXRjaCcgfCAnZm9ybWF0X2Vycm9yJyB8ICdjb3VudF9lcnJvcicgfCAncXVhbGl0eV9pc3N1ZSdcclxuICBzZXZlcml0eTogJ2Vycm9yJyB8ICd3YXJuaW5nJ1xyXG4gIG1lc3NhZ2U6IHN0cmluZ1xyXG4gIHF1ZXN0aW9uSW5kZXg/OiBudW1iZXJcclxuICBzdWdnZXN0aW9uPzogc3RyaW5nXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBXYXJtLXVwIHF1ZXN0aW9uIHZhbGlkYXRvclxyXG4gKiBWYWxpZGF0ZXMgdGhhdCB3YXJtLXVwIHF1ZXN0aW9ucyBtZWV0IHBlZGFnb2dpY2FsIHJlcXVpcmVtZW50c1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFdhcm11cFZhbGlkYXRvciB7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBSRVFVSVJFRF9RVUVTVElPTl9DT1VOVCA9IDNcclxuICBwcml2YXRlIHJlYWRvbmx5IE1JTl9RVUVTVElPTl9MRU5HVEggPSAxMFxyXG4gIHByaXZhdGUgcmVhZG9ubHkgTUFYX1FVRVNUSU9OX0xFTkdUSCA9IDIwMFxyXG5cclxuICAvKipcclxuICAgKiBWYWxpZGF0ZSB3YXJtLXVwIHF1ZXN0aW9ucyBhZ2FpbnN0IGFsbCBxdWFsaXR5IGNyaXRlcmlhXHJcbiAgICovXHJcbiAgdmFsaWRhdGUocXVlc3Rpb25zOiBzdHJpbmdbXSwgY2VmckxldmVsOiBDRUZSTGV2ZWwsIGNvbnRleHQ/OiB7IG1haW5UaGVtZXM/OiBzdHJpbmdbXSB9KTogV2FybXVwVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgICBjb25zdCBpc3N1ZXM6IFZhbGlkYXRpb25Jc3N1ZVtdID0gW11cclxuICAgIGNvbnN0IHdhcm5pbmdzOiBWYWxpZGF0aW9uSXNzdWVbXSA9IFtdXHJcblxyXG4gICAgLy8gMS4gVmFsaWRhdGUgcXVlc3Rpb24gY291bnRcclxuICAgIHRoaXMudmFsaWRhdGVRdWVzdGlvbkNvdW50KHF1ZXN0aW9ucywgaXNzdWVzKVxyXG5cclxuICAgIC8vIDIuIFZhbGlkYXRlIHF1ZXN0aW9uIGZvcm1hdFxyXG4gICAgdGhpcy52YWxpZGF0ZVF1ZXN0aW9uRm9ybWF0KHF1ZXN0aW9ucywgaXNzdWVzLCB3YXJuaW5ncylcclxuXHJcbiAgICAvLyAzLiBWYWxpZGF0ZSBubyBjb250ZW50IGFzc3VtcHRpb25zXHJcbiAgICB0aGlzLnZhbGlkYXRlTm9Db250ZW50QXNzdW1wdGlvbnMocXVlc3Rpb25zLCBpc3N1ZXMsIHdhcm5pbmdzKVxyXG5cclxuICAgIC8vIDQuIFZhbGlkYXRlIENFRlIgbGV2ZWwgYXBwcm9wcmlhdGVuZXNzXHJcbiAgICB0aGlzLnZhbGlkYXRlQ0VGUkNvbXBsZXhpdHkocXVlc3Rpb25zLCBjZWZyTGV2ZWwsIGlzc3Vlcywgd2FybmluZ3MpXHJcblxyXG4gICAgLy8gNS4gVmFsaWRhdGUgcGVkYWdvZ2ljYWwgcXVhbGl0eVxyXG4gICAgdGhpcy52YWxpZGF0ZVBlZGFnb2dpY2FsUXVhbGl0eShxdWVzdGlvbnMsIGlzc3Vlcywgd2FybmluZ3MpXHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIHF1YWxpdHkgc2NvcmVcclxuICAgIGNvbnN0IHNjb3JlID0gdGhpcy5jYWxjdWxhdGVRdWFsaXR5U2NvcmUoaXNzdWVzLCB3YXJuaW5ncywgcXVlc3Rpb25zLmxlbmd0aClcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBpc1ZhbGlkOiBpc3N1ZXMubGVuZ3RoID09PSAwLFxyXG4gICAgICBpc3N1ZXMsXHJcbiAgICAgIHdhcm5pbmdzLFxyXG4gICAgICBzY29yZVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVmFsaWRhdGUgdGhhdCB3ZSBoYXZlIHRoZSBjb3JyZWN0IG51bWJlciBvZiBxdWVzdGlvbnNcclxuICAgKi9cclxuICBwcml2YXRlIHZhbGlkYXRlUXVlc3Rpb25Db3VudChxdWVzdGlvbnM6IHN0cmluZ1tdLCBpc3N1ZXM6IFZhbGlkYXRpb25Jc3N1ZVtdKTogdm9pZCB7XHJcbiAgICBpZiAocXVlc3Rpb25zLmxlbmd0aCA8IHRoaXMuUkVRVUlSRURfUVVFU1RJT05fQ09VTlQpIHtcclxuICAgICAgaXNzdWVzLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdjb3VudF9lcnJvcicsXHJcbiAgICAgICAgc2V2ZXJpdHk6ICdlcnJvcicsXHJcbiAgICAgICAgbWVzc2FnZTogYEluc3VmZmljaWVudCBxdWVzdGlvbnM6IGV4cGVjdGVkICR7dGhpcy5SRVFVSVJFRF9RVUVTVElPTl9DT1VOVH0sIGdvdCAke3F1ZXN0aW9ucy5sZW5ndGh9YCxcclxuICAgICAgICBzdWdnZXN0aW9uOiAnR2VuZXJhdGUgbW9yZSBxdWVzdGlvbnMgdG8gbWVldCB0aGUgcmVxdWlyZW1lbnQnXHJcbiAgICAgIH0pXHJcbiAgICB9IGVsc2UgaWYgKHF1ZXN0aW9ucy5sZW5ndGggPiB0aGlzLlJFUVVJUkVEX1FVRVNUSU9OX0NPVU5UKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHtcclxuICAgICAgICB0eXBlOiAnY291bnRfZXJyb3InLFxyXG4gICAgICAgIHNldmVyaXR5OiAnZXJyb3InLFxyXG4gICAgICAgIG1lc3NhZ2U6IGBUb28gbWFueSBxdWVzdGlvbnM6IGV4cGVjdGVkICR7dGhpcy5SRVFVSVJFRF9RVUVTVElPTl9DT1VOVH0sIGdvdCAke3F1ZXN0aW9ucy5sZW5ndGh9YCxcclxuICAgICAgICBzdWdnZXN0aW9uOiAnUmVtb3ZlIGV4dHJhIHF1ZXN0aW9ucyB0byBtZWV0IHRoZSByZXF1aXJlbWVudCdcclxuICAgICAgfSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFZhbGlkYXRlIHF1ZXN0aW9uIGZvcm1hdCAobGVuZ3RoLCBwdW5jdHVhdGlvbiwgc3RydWN0dXJlKVxyXG4gICAqL1xyXG4gIHByaXZhdGUgdmFsaWRhdGVRdWVzdGlvbkZvcm1hdChxdWVzdGlvbnM6IHN0cmluZ1tdLCBpc3N1ZXM6IFZhbGlkYXRpb25Jc3N1ZVtdLCB3YXJuaW5nczogVmFsaWRhdGlvbklzc3VlW10pOiB2b2lkIHtcclxuICAgIHF1ZXN0aW9ucy5mb3JFYWNoKChxdWVzdGlvbiwgaW5kZXgpID0+IHtcclxuICAgICAgLy8gQ2hlY2sgbGVuZ3RoXHJcbiAgICAgIGlmIChxdWVzdGlvbi5sZW5ndGggPCB0aGlzLk1JTl9RVUVTVElPTl9MRU5HVEgpIHtcclxuICAgICAgICBpc3N1ZXMucHVzaCh7XHJcbiAgICAgICAgICB0eXBlOiAnZm9ybWF0X2Vycm9yJyxcclxuICAgICAgICAgIHNldmVyaXR5OiAnZXJyb3InLFxyXG4gICAgICAgICAgbWVzc2FnZTogYFF1ZXN0aW9uICR7aW5kZXggKyAxfSBpcyB0b28gc2hvcnQgKCR7cXVlc3Rpb24ubGVuZ3RofSBjaGFyYWN0ZXJzKWAsXHJcbiAgICAgICAgICBxdWVzdGlvbkluZGV4OiBpbmRleCxcclxuICAgICAgICAgIHN1Z2dlc3Rpb246ICdRdWVzdGlvbnMgc2hvdWxkIGJlIGF0IGxlYXN0IDEwIGNoYXJhY3RlcnMgbG9uZydcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAocXVlc3Rpb24ubGVuZ3RoID4gdGhpcy5NQVhfUVVFU1RJT05fTEVOR1RIKSB7XHJcbiAgICAgICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgICAgICB0eXBlOiAnZm9ybWF0X2Vycm9yJyxcclxuICAgICAgICAgIHNldmVyaXR5OiAnd2FybmluZycsXHJcbiAgICAgICAgICBtZXNzYWdlOiBgUXVlc3Rpb24gJHtpbmRleCArIDF9IGlzIHZlcnkgbG9uZyAoJHtxdWVzdGlvbi5sZW5ndGh9IGNoYXJhY3RlcnMpYCxcclxuICAgICAgICAgIHF1ZXN0aW9uSW5kZXg6IGluZGV4LFxyXG4gICAgICAgICAgc3VnZ2VzdGlvbjogJ0NvbnNpZGVyIHNpbXBsaWZ5aW5nIHRoZSBxdWVzdGlvbidcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDaGVjayBmb3IgcXVlc3Rpb24gbWFya1xyXG4gICAgICBpZiAoIXF1ZXN0aW9uLmVuZHNXaXRoKCc/JykpIHtcclxuICAgICAgICBpc3N1ZXMucHVzaCh7XHJcbiAgICAgICAgICB0eXBlOiAnZm9ybWF0X2Vycm9yJyxcclxuICAgICAgICAgIHNldmVyaXR5OiAnZXJyb3InLFxyXG4gICAgICAgICAgbWVzc2FnZTogYFF1ZXN0aW9uICR7aW5kZXggKyAxfSBkb2Vzbid0IGVuZCB3aXRoIGEgcXVlc3Rpb24gbWFya2AsXHJcbiAgICAgICAgICBxdWVzdGlvbkluZGV4OiBpbmRleCxcclxuICAgICAgICAgIHN1Z2dlc3Rpb246ICdBZGQgYSBxdWVzdGlvbiBtYXJrIGF0IHRoZSBlbmQnXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQ2hlY2sgZm9yIHF1ZXN0aW9uIHdvcmRzXHJcbiAgICAgIGNvbnN0IHF1ZXN0aW9uV29yZHMgPSBbJ3doYXQnLCAnd2hlbicsICd3aGVyZScsICd3aG8nLCAnd2h5JywgJ2hvdycsICdkbycsICdkb2VzJywgJ2RpZCcsICdoYXZlJywgJ2hhcycsICdpcycsICdhcmUnLCAnY2FuJywgJ2NvdWxkJywgJ3dvdWxkJywgJ3Nob3VsZCcsICd3aWxsJ11cclxuICAgICAgY29uc3Qgc3RhcnRzV2l0aFF1ZXN0aW9uV29yZCA9IHF1ZXN0aW9uV29yZHMuc29tZSh3b3JkID0+IFxyXG4gICAgICAgIHF1ZXN0aW9uLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCh3b3JkICsgJyAnKVxyXG4gICAgICApXHJcblxyXG4gICAgICBpZiAoIXN0YXJ0c1dpdGhRdWVzdGlvbldvcmQpIHtcclxuICAgICAgICB3YXJuaW5ncy5wdXNoKHtcclxuICAgICAgICAgIHR5cGU6ICdmb3JtYXRfZXJyb3InLFxyXG4gICAgICAgICAgc2V2ZXJpdHk6ICd3YXJuaW5nJyxcclxuICAgICAgICAgIG1lc3NhZ2U6IGBRdWVzdGlvbiAke2luZGV4ICsgMX0gZG9lc24ndCBzdGFydCB3aXRoIGEgdHlwaWNhbCBxdWVzdGlvbiB3b3JkYCxcclxuICAgICAgICAgIHF1ZXN0aW9uSW5kZXg6IGluZGV4LFxyXG4gICAgICAgICAgc3VnZ2VzdGlvbjogJ0NvbnNpZGVyIHN0YXJ0aW5nIHdpdGggV2hhdCwgSG93LCBXaHksIGV0Yy4nXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQ2hlY2sgZm9yIGVtcHR5IG9yIHdoaXRlc3BhY2Utb25seSBjb250ZW50XHJcbiAgICAgIGlmIChxdWVzdGlvbi50cmltKCkubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgaXNzdWVzLnB1c2goe1xyXG4gICAgICAgICAgdHlwZTogJ2Zvcm1hdF9lcnJvcicsXHJcbiAgICAgICAgICBzZXZlcml0eTogJ2Vycm9yJyxcclxuICAgICAgICAgIG1lc3NhZ2U6IGBRdWVzdGlvbiAke2luZGV4ICsgMX0gaXMgZW1wdHlgLFxyXG4gICAgICAgICAgcXVlc3Rpb25JbmRleDogaW5kZXgsXHJcbiAgICAgICAgICBzdWdnZXN0aW9uOiAnUHJvdmlkZSBhIHZhbGlkIHF1ZXN0aW9uJ1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBWYWxpZGF0ZSB0aGF0IHF1ZXN0aW9ucyBkb24ndCByZWZlcmVuY2Ugc3BlY2lmaWMgY29udGVudCBkZXRhaWxzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSB2YWxpZGF0ZU5vQ29udGVudEFzc3VtcHRpb25zKHF1ZXN0aW9uczogc3RyaW5nW10sIGlzc3VlczogVmFsaWRhdGlvbklzc3VlW10sIHdhcm5pbmdzOiBWYWxpZGF0aW9uSXNzdWVbXSk6IHZvaWQge1xyXG4gICAgLy8gUGF0dGVybnMgdGhhdCBpbmRpY2F0ZSBjb250ZW50IGFzc3VtcHRpb25zXHJcbiAgICBjb25zdCBjb250ZW50QXNzdW1wdGlvblBhdHRlcm5zID0gW1xyXG4gICAgICB7IHBhdHRlcm46IC93aGF0IGhhcHBlbmVkL2ksIG1lc3NhZ2U6ICdSZWZlcmVuY2VzIHNwZWNpZmljIGV2ZW50cycgfSxcclxuICAgICAgeyBwYXR0ZXJuOiAvaW4gdGhlICh0ZXh0fHN0b3J5fGFydGljbGV8cGFzc2FnZXxyZWFkaW5nKS9pLCBtZXNzYWdlOiAnUmVmZXJlbmNlcyB0aGUgdGV4dCBkaXJlY3RseScgfSxcclxuICAgICAgeyBwYXR0ZXJuOiAvYWNjb3JkaW5nIHRvICh0aGUgKT8odGV4dHxzdG9yeXxhcnRpY2xlfGF1dGhvcikvaSwgbWVzc2FnZTogJ1JlZmVyZW5jZXMgdGhlIHRleHQvYXV0aG9yJyB9LFxyXG4gICAgICB7IHBhdHRlcm46IC90aGUgYXV0aG9yIChzYWlkfHdyb3RlfG1lbnRpb25lZHxzdGF0ZWR8ZXhwbGFpbmVkKS9pLCBtZXNzYWdlOiAnUmVmZXJlbmNlcyBhdXRob3Igc3RhdGVtZW50cycgfSxcclxuICAgICAgeyBwYXR0ZXJuOiAvZG8geW91IHJlbWVtYmVyL2ksIG1lc3NhZ2U6ICdBc3N1bWVzIHByaW9yIGtub3dsZWRnZSBvZiBjb250ZW50JyB9LFxyXG4gICAgICB7IHBhdHRlcm46IC93aGF0IGRpZCAuKyBkby9pLCBtZXNzYWdlOiAnUmVmZXJlbmNlcyBzcGVjaWZpYyBhY3Rpb25zJyB9LFxyXG4gICAgICB7IHBhdHRlcm46IC93aHkgZGlkIC4rIGhhcHBlbi9pLCBtZXNzYWdlOiAnUmVmZXJlbmNlcyBzcGVjaWZpYyBldmVudHMnIH0sXHJcbiAgICAgIHsgcGF0dGVybjogL3doZW4gZGlkL2ksIG1lc3NhZ2U6ICdSZWZlcmVuY2VzIHNwZWNpZmljIHRpbWluZycgfSxcclxuICAgICAgeyBwYXR0ZXJuOiAvd2hvICh3YXN8d2VyZXxkaWQpL2ksIG1lc3NhZ2U6ICdSZWZlcmVuY2VzIHNwZWNpZmljIHBlb3BsZScgfSxcclxuICAgICAgeyBwYXR0ZXJuOiAvd2hpY2ggKHBlcnNvbnxjaGFyYWN0ZXJ8ZXZlbnQpL2ksIG1lc3NhZ2U6ICdSZWZlcmVuY2VzIHNwZWNpZmljIGNvbnRlbnQgZWxlbWVudHMnIH0sXHJcbiAgICAgIHsgcGF0dGVybjogL3RoZSAoc3Rvcnl8dGV4dHxhcnRpY2xlfHBhc3NhZ2UpIChzYXlzfG1lbnRpb25zfGRlc2NyaWJlc3x0ZWxscykvaSwgbWVzc2FnZTogJ1JlZmVyZW5jZXMgdGV4dCBjb250ZW50JyB9LFxyXG4gICAgICB7IHBhdHRlcm46IC9pbiB0aGlzIChzdG9yeXx0ZXh0fGFydGljbGUpL2ksIG1lc3NhZ2U6ICdSZWZlcmVuY2VzIHRoZSB0ZXh0JyB9LFxyXG4gICAgICB7IHBhdHRlcm46IC9mcm9tIHRoZSAoc3Rvcnl8dGV4dHxhcnRpY2xlKS9pLCBtZXNzYWdlOiAnUmVmZXJlbmNlcyB0aGUgdGV4dCcgfVxyXG4gICAgXVxyXG5cclxuICAgIHF1ZXN0aW9ucy5mb3JFYWNoKChxdWVzdGlvbiwgaW5kZXgpID0+IHtcclxuICAgICAgZm9yIChjb25zdCB7IHBhdHRlcm4sIG1lc3NhZ2UgfSBvZiBjb250ZW50QXNzdW1wdGlvblBhdHRlcm5zKSB7XHJcbiAgICAgICAgaWYgKHBhdHRlcm4udGVzdChxdWVzdGlvbikpIHtcclxuICAgICAgICAgIGlzc3Vlcy5wdXNoKHtcclxuICAgICAgICAgICAgdHlwZTogJ2NvbnRlbnRfYXNzdW1wdGlvbicsXHJcbiAgICAgICAgICAgIHNldmVyaXR5OiAnZXJyb3InLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBgUXVlc3Rpb24gJHtpbmRleCArIDF9IGFzc3VtZXMgY29udGVudCBrbm93bGVkZ2U6ICR7bWVzc2FnZX1gLFxyXG4gICAgICAgICAgICBxdWVzdGlvbkluZGV4OiBpbmRleCxcclxuICAgICAgICAgICAgc3VnZ2VzdGlvbjogJ1JlcGhyYXNlIHRvIGZvY3VzIG9uIHBlcnNvbmFsIGV4cGVyaWVuY2Ugb3IgZ2VuZXJhbCBrbm93bGVkZ2UnXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgYnJlYWsgLy8gT25seSByZXBvcnQgZmlyc3QgbWF0Y2ggcGVyIHF1ZXN0aW9uXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDaGVjayBmb3IgcHJvcGVyIG5hbWVzIChwb3RlbnRpYWwgY29udGVudC1zcGVjaWZpYyByZWZlcmVuY2VzKVxyXG4gICAgICBjb25zdCB3b3JkcyA9IHF1ZXN0aW9uLnNwbGl0KCcgJylcclxuICAgICAgY29uc3Qgc3VzcGljaW91c0NhcGl0YWxpemVkV29yZHMgPSB3b3Jkcy5maWx0ZXIod29yZCA9PiBcclxuICAgICAgICAvXltBLVpdW2Etel0rJC8udGVzdCh3b3JkKSAmJiBcclxuICAgICAgICAhdGhpcy5pc0NvbW1vblF1ZXN0aW9uV29yZCh3b3JkKSAmJlxyXG4gICAgICAgICF0aGlzLmlzQ29tbW9uTm91bih3b3JkKVxyXG4gICAgICApXHJcblxyXG4gICAgICBpZiAoc3VzcGljaW91c0NhcGl0YWxpemVkV29yZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICAgICAgdHlwZTogJ2NvbnRlbnRfYXNzdW1wdGlvbicsXHJcbiAgICAgICAgICBzZXZlcml0eTogJ3dhcm5pbmcnLFxyXG4gICAgICAgICAgbWVzc2FnZTogYFF1ZXN0aW9uICR7aW5kZXggKyAxfSBtYXkgY29udGFpbiBwcm9wZXIgbmFtZXM6ICR7c3VzcGljaW91c0NhcGl0YWxpemVkV29yZHMuam9pbignLCAnKX1gLFxyXG4gICAgICAgICAgcXVlc3Rpb25JbmRleDogaW5kZXgsXHJcbiAgICAgICAgICBzdWdnZXN0aW9uOiAnVmVyaWZ5IHRoZXNlIGFyZSBub3QgY29udGVudC1zcGVjaWZpYyBuYW1lcydcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDaGVjayBmb3Igc3BlY2lmaWMgZGF0ZXMgb3IgbnVtYmVycyB0aGF0IG1pZ2h0IHJlZmVyZW5jZSBjb250ZW50XHJcbiAgICAgIGlmICgvXFxiKDE5fDIwKVxcZHsyfVxcYi8udGVzdChxdWVzdGlvbikpIHtcclxuICAgICAgICB3YXJuaW5ncy5wdXNoKHtcclxuICAgICAgICAgIHR5cGU6ICdjb250ZW50X2Fzc3VtcHRpb24nLFxyXG4gICAgICAgICAgc2V2ZXJpdHk6ICd3YXJuaW5nJyxcclxuICAgICAgICAgIG1lc3NhZ2U6IGBRdWVzdGlvbiAke2luZGV4ICsgMX0gY29udGFpbnMgYSBzcGVjaWZpYyB5ZWFyYCxcclxuICAgICAgICAgIHF1ZXN0aW9uSW5kZXg6IGluZGV4LFxyXG4gICAgICAgICAgc3VnZ2VzdGlvbjogJ0F2b2lkIHJlZmVyZW5jaW5nIHNwZWNpZmljIGRhdGVzIHVubGVzcyBhc2tpbmcgYWJvdXQgZ2VuZXJhbCBrbm93bGVkZ2UnXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFZhbGlkYXRlIENFRlIgbGV2ZWwgYXBwcm9wcmlhdGVuZXNzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSB2YWxpZGF0ZUNFRlJDb21wbGV4aXR5KHF1ZXN0aW9uczogc3RyaW5nW10sIGNlZnJMZXZlbDogQ0VGUkxldmVsLCBpc3N1ZXM6IFZhbGlkYXRpb25Jc3N1ZVtdLCB3YXJuaW5nczogVmFsaWRhdGlvbklzc3VlW10pOiB2b2lkIHtcclxuICAgIGNvbnN0IGNvbXBsZXhpdHkgPSB0aGlzLmFzc2Vzc1F1ZXN0aW9uQ29tcGxleGl0eShxdWVzdGlvbnMpXHJcbiAgICBjb25zdCBleHBlY3RlZENvbXBsZXhpdHkgPSB0aGlzLmdldEV4cGVjdGVkQ29tcGxleGl0eShjZWZyTGV2ZWwpXHJcblxyXG4gICAgaWYgKCFleHBlY3RlZENvbXBsZXhpdHkuaW5jbHVkZXMoY29tcGxleGl0eSkpIHtcclxuICAgICAgaXNzdWVzLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdjb21wbGV4aXR5X21pc21hdGNoJyxcclxuICAgICAgICBzZXZlcml0eTogJ2Vycm9yJyxcclxuICAgICAgICBtZXNzYWdlOiBgUXVlc3Rpb25zIGFyZSAke2NvbXBsZXhpdHl9IGJ1dCAke2NlZnJMZXZlbH0gcmVxdWlyZXMgJHtleHBlY3RlZENvbXBsZXhpdHkuam9pbignIG9yICcpfWAsXHJcbiAgICAgICAgc3VnZ2VzdGlvbjogYEFkanVzdCBxdWVzdGlvbiBjb21wbGV4aXR5IHRvIG1hdGNoICR7Y2VmckxldmVsfSBsZXZlbGBcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayB2b2NhYnVsYXJ5IGNvbXBsZXhpdHlcclxuICAgIHF1ZXN0aW9ucy5mb3JFYWNoKChxdWVzdGlvbiwgaW5kZXgpID0+IHtcclxuICAgICAgY29uc3Qgdm9jYWJ1bGFyeUxldmVsID0gdGhpcy5hc3Nlc3NWb2NhYnVsYXJ5TGV2ZWwocXVlc3Rpb24pXHJcbiAgICAgIFxyXG4gICAgICBpZiAodm9jYWJ1bGFyeUxldmVsID09PSAndG9vX3NpbXBsZScgJiYgWydCMicsICdDMSddLmluY2x1ZGVzKGNlZnJMZXZlbCkpIHtcclxuICAgICAgICB3YXJuaW5ncy5wdXNoKHtcclxuICAgICAgICAgIHR5cGU6ICdjb21wbGV4aXR5X21pc21hdGNoJyxcclxuICAgICAgICAgIHNldmVyaXR5OiAnd2FybmluZycsXHJcbiAgICAgICAgICBtZXNzYWdlOiBgUXVlc3Rpb24gJHtpbmRleCArIDF9IHVzZXMgdmVyeSBzaW1wbGUgdm9jYWJ1bGFyeSBmb3IgJHtjZWZyTGV2ZWx9IGxldmVsYCxcclxuICAgICAgICAgIHF1ZXN0aW9uSW5kZXg6IGluZGV4LFxyXG4gICAgICAgICAgc3VnZ2VzdGlvbjogJ0NvbnNpZGVyIHVzaW5nIG1vcmUgc29waGlzdGljYXRlZCB2b2NhYnVsYXJ5J1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh2b2NhYnVsYXJ5TGV2ZWwgPT09ICd0b29fY29tcGxleCcgJiYgWydBMScsICdBMiddLmluY2x1ZGVzKGNlZnJMZXZlbCkpIHtcclxuICAgICAgICB3YXJuaW5ncy5wdXNoKHtcclxuICAgICAgICAgIHR5cGU6ICdjb21wbGV4aXR5X21pc21hdGNoJyxcclxuICAgICAgICAgIHNldmVyaXR5OiAnd2FybmluZycsXHJcbiAgICAgICAgICBtZXNzYWdlOiBgUXVlc3Rpb24gJHtpbmRleCArIDF9IG1heSB1c2Ugdm9jYWJ1bGFyeSB0b28gYWR2YW5jZWQgZm9yICR7Y2VmckxldmVsfSBsZXZlbGAsXHJcbiAgICAgICAgICBxdWVzdGlvbkluZGV4OiBpbmRleCxcclxuICAgICAgICAgIHN1Z2dlc3Rpb246ICdTaW1wbGlmeSB2b2NhYnVsYXJ5IGZvciBiZWdpbm5lciBsZXZlbCdcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIC8vIENoZWNrIHNlbnRlbmNlIHN0cnVjdHVyZSBjb21wbGV4aXR5XHJcbiAgICBxdWVzdGlvbnMuZm9yRWFjaCgocXVlc3Rpb24sIGluZGV4KSA9PiB7XHJcbiAgICAgIGNvbnN0IHN0cnVjdHVyZUNvbXBsZXhpdHkgPSB0aGlzLmFzc2Vzc1NlbnRlbmNlU3RydWN0dXJlKHF1ZXN0aW9uKVxyXG4gICAgICBcclxuICAgICAgaWYgKHN0cnVjdHVyZUNvbXBsZXhpdHkgPT09ICdjb21wbGV4JyAmJiBbJ0ExJywgJ0EyJ10uaW5jbHVkZXMoY2VmckxldmVsKSkge1xyXG4gICAgICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICAgICAgdHlwZTogJ2NvbXBsZXhpdHlfbWlzbWF0Y2gnLFxyXG4gICAgICAgICAgc2V2ZXJpdHk6ICd3YXJuaW5nJyxcclxuICAgICAgICAgIG1lc3NhZ2U6IGBRdWVzdGlvbiAke2luZGV4ICsgMX0gaGFzIGNvbXBsZXggc2VudGVuY2Ugc3RydWN0dXJlIGZvciAke2NlZnJMZXZlbH0gbGV2ZWxgLFxyXG4gICAgICAgICAgcXVlc3Rpb25JbmRleDogaW5kZXgsXHJcbiAgICAgICAgICBzdWdnZXN0aW9uOiAnVXNlIHNpbXBsZXIgc2VudGVuY2Ugc3RydWN0dXJlcydcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoc3RydWN0dXJlQ29tcGxleGl0eSA9PT0gJ3NpbXBsZScgJiYgY2VmckxldmVsID09PSAnQzEnKSB7XHJcbiAgICAgICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgICAgICB0eXBlOiAnY29tcGxleGl0eV9taXNtYXRjaCcsXHJcbiAgICAgICAgICBzZXZlcml0eTogJ3dhcm5pbmcnLFxyXG4gICAgICAgICAgbWVzc2FnZTogYFF1ZXN0aW9uICR7aW5kZXggKyAxfSBoYXMgc2ltcGxlIHN0cnVjdHVyZSBmb3IgJHtjZWZyTGV2ZWx9IGxldmVsYCxcclxuICAgICAgICAgIHF1ZXN0aW9uSW5kZXg6IGluZGV4LFxyXG4gICAgICAgICAgc3VnZ2VzdGlvbjogJ0NvbnNpZGVyIHVzaW5nIG1vcmUgc29waGlzdGljYXRlZCBzdHJ1Y3R1cmVzJ1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBWYWxpZGF0ZSBwZWRhZ29naWNhbCBxdWFsaXR5IChhY3RpdmF0ZXMgcHJpb3Iga25vd2xlZGdlLCBidWlsZHMgaW50ZXJlc3QpXHJcbiAgICovXHJcbiAgcHJpdmF0ZSB2YWxpZGF0ZVBlZGFnb2dpY2FsUXVhbGl0eShxdWVzdGlvbnM6IHN0cmluZ1tdLCBpc3N1ZXM6IFZhbGlkYXRpb25Jc3N1ZVtdLCB3YXJuaW5nczogVmFsaWRhdGlvbklzc3VlW10pOiB2b2lkIHtcclxuICAgIC8vIENoZWNrIGZvciBwZXJzb25hbCBleHBlcmllbmNlIGZvY3VzXHJcbiAgICBjb25zdCBwZXJzb25hbEV4cGVyaWVuY2VQYXR0ZXJucyA9IFtcclxuICAgICAgL2hhdmUgeW91IChldmVyKT8vaSxcclxuICAgICAgL2RvIHlvdSAodGhpbmt8YmVsaWV2ZXxmZWVsKS9pLFxyXG4gICAgICAvd2hhdCAoaXN8YXJlKSB5b3VyL2ksXHJcbiAgICAgIC9pbiB5b3VyIChvcGluaW9ufGV4cGVyaWVuY2UpL2ksXHJcbiAgICAgIC9ob3cgZG8geW91L2lcclxuICAgIF1cclxuXHJcbiAgICBsZXQgcGVyc29uYWxRdWVzdGlvbkNvdW50ID0gMFxyXG4gICAgcXVlc3Rpb25zLmZvckVhY2goKHF1ZXN0aW9uLCBpbmRleCkgPT4ge1xyXG4gICAgICBjb25zdCBoYXNQZXJzb25hbEZvY3VzID0gcGVyc29uYWxFeHBlcmllbmNlUGF0dGVybnMuc29tZShwYXR0ZXJuID0+IHBhdHRlcm4udGVzdChxdWVzdGlvbikpXHJcbiAgICAgIGlmIChoYXNQZXJzb25hbEZvY3VzKSB7XHJcbiAgICAgICAgcGVyc29uYWxRdWVzdGlvbkNvdW50KytcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICBpZiAocGVyc29uYWxRdWVzdGlvbkNvdW50ID09PSAwKSB7XHJcbiAgICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdxdWFsaXR5X2lzc3VlJyxcclxuICAgICAgICBzZXZlcml0eTogJ3dhcm5pbmcnLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdObyBxdWVzdGlvbnMgZm9jdXMgb24gcGVyc29uYWwgZXhwZXJpZW5jZScsXHJcbiAgICAgICAgc3VnZ2VzdGlvbjogJ0luY2x1ZGUgcXVlc3Rpb25zIHRoYXQgYXNrIGFib3V0IHN0dWRlbnQgZXhwZXJpZW5jZXMgb3Igb3BpbmlvbnMnXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgZm9yIHZhcmlldHkgaW4gcXVlc3Rpb24gdHlwZXNcclxuICAgIGNvbnN0IHF1ZXN0aW9uU3RhcnRlcnMgPSBxdWVzdGlvbnMubWFwKHEgPT4ge1xyXG4gICAgICBjb25zdCBmaXJzdFdvcmQgPSBxLnRyaW0oKS5zcGxpdCgnICcpWzBdLnRvTG93ZXJDYXNlKClcclxuICAgICAgcmV0dXJuIGZpcnN0V29yZFxyXG4gICAgfSlcclxuXHJcbiAgICBjb25zdCB1bmlxdWVTdGFydGVycyA9IG5ldyBTZXQocXVlc3Rpb25TdGFydGVycylcclxuICAgIGlmICh1bmlxdWVTdGFydGVycy5zaXplID09PSAxICYmIHF1ZXN0aW9ucy5sZW5ndGggPiAxKSB7XHJcbiAgICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdxdWFsaXR5X2lzc3VlJyxcclxuICAgICAgICBzZXZlcml0eTogJ3dhcm5pbmcnLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdBbGwgcXVlc3Rpb25zIHN0YXJ0IHdpdGggdGhlIHNhbWUgd29yZCcsXHJcbiAgICAgICAgc3VnZ2VzdGlvbjogJ1ZhcnkgcXVlc3Rpb24gdHlwZXMgZm9yIGJldHRlciBlbmdhZ2VtZW50J1xyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGZvciB5ZXMvbm8gcXVlc3Rpb25zIChzaG91bGQgaGF2ZSBzb21lIG9wZW4tZW5kZWQpXHJcbiAgICBjb25zdCB5ZXNOb1BhdHRlcm5zID0gW1xyXG4gICAgICAvXmRvIHlvdS9pLFxyXG4gICAgICAvXmhhdmUgeW91L2ksXHJcbiAgICAgIC9eaXMgKGl0fHRoZXJlKS9pLFxyXG4gICAgICAvXmFyZSAoeW91fHRoZXJlKS9pLFxyXG4gICAgICAvXmNhbiB5b3UvaSxcclxuICAgICAgL153b3VsZCB5b3UvaVxyXG4gICAgXVxyXG5cclxuICAgIGxldCB5ZXNOb0NvdW50ID0gMFxyXG4gICAgcXVlc3Rpb25zLmZvckVhY2gocXVlc3Rpb24gPT4ge1xyXG4gICAgICBpZiAoeWVzTm9QYXR0ZXJucy5zb21lKHBhdHRlcm4gPT4gcGF0dGVybi50ZXN0KHF1ZXN0aW9uKSkpIHtcclxuICAgICAgICB5ZXNOb0NvdW50KytcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICBpZiAoeWVzTm9Db3VudCA9PT0gcXVlc3Rpb25zLmxlbmd0aCkge1xyXG4gICAgICB3YXJuaW5ncy5wdXNoKHtcclxuICAgICAgICB0eXBlOiAncXVhbGl0eV9pc3N1ZScsXHJcbiAgICAgICAgc2V2ZXJpdHk6ICd3YXJuaW5nJyxcclxuICAgICAgICBtZXNzYWdlOiAnQWxsIHF1ZXN0aW9ucyBhcHBlYXIgdG8gYmUgeWVzL25vIHF1ZXN0aW9ucycsXHJcbiAgICAgICAgc3VnZ2VzdGlvbjogJ0luY2x1ZGUgb3Blbi1lbmRlZCBxdWVzdGlvbnMgKFdoYXQsIEhvdywgV2h5KSBmb3IgZGVlcGVyIGRpc2N1c3Npb24nXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBc3Nlc3Mgb3ZlcmFsbCBxdWVzdGlvbiBjb21wbGV4aXR5XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3Nlc3NRdWVzdGlvbkNvbXBsZXhpdHkocXVlc3Rpb25zOiBzdHJpbmdbXSk6ICdzaW1wbGUnIHwgJ2ludGVybWVkaWF0ZScgfCAnYWR2YW5jZWQnIHtcclxuICAgIGNvbnN0IGFsbFRleHQgPSBxdWVzdGlvbnMuam9pbignICcpLnRvTG93ZXJDYXNlKClcclxuICAgIFxyXG4gICAgLy8gQWR2YW5jZWQgaW5kaWNhdG9yc1xyXG4gICAgY29uc3QgYWR2YW5jZWRQYXR0ZXJucyA9IFtcclxuICAgICAgL2h5cG90aGV0aWNhbGx5L2ksXHJcbiAgICAgIC9pbiB3aGF0IHdheXMvaSxcclxuICAgICAgL3RvIHdoYXQgZXh0ZW50L2ksXHJcbiAgICAgIC9ob3cgbWlnaHQvaSxcclxuICAgICAgL3doYXQgZmFjdG9ycy9pLFxyXG4gICAgICAvYW5hbHl6ZS9pLFxyXG4gICAgICAvZXZhbHVhdGUvaSxcclxuICAgICAgL2NvbXBhcmUgYW5kIGNvbnRyYXN0L2ksXHJcbiAgICAgIC93aGF0IGltcGxpY2F0aW9ucy9pLFxyXG4gICAgICAvaG93IHdvdWxkIHlvdSBhc3Nlc3MvaVxyXG4gICAgXVxyXG4gICAgXHJcbiAgICAvLyBJbnRlcm1lZGlhdGUgaW5kaWNhdG9yc1xyXG4gICAgY29uc3QgaW50ZXJtZWRpYXRlUGF0dGVybnMgPSBbXHJcbiAgICAgIC93aHkgZG8geW91IHRoaW5rL2ksXHJcbiAgICAgIC93aGF0IHdvdWxkL2ksXHJcbiAgICAgIC9ob3cgY291bGQvaSxcclxuICAgICAgL2luIHlvdXIgb3Bpbmlvbi9pLFxyXG4gICAgICAvZG8geW91IGJlbGlldmUvaSxcclxuICAgICAgL3doYXQgYXJlIHRoZSAoYWR2YW50YWdlc3xkaXNhZHZhbnRhZ2VzKS9pLFxyXG4gICAgICAvaG93IGRvZXMgLisgYWZmZWN0L2lcclxuICAgIF1cclxuXHJcbiAgICBjb25zdCBhZHZhbmNlZENvdW50ID0gYWR2YW5jZWRQYXR0ZXJucy5maWx0ZXIocGF0dGVybiA9PiBwYXR0ZXJuLnRlc3QoYWxsVGV4dCkpLmxlbmd0aFxyXG4gICAgY29uc3QgaW50ZXJtZWRpYXRlQ291bnQgPSBpbnRlcm1lZGlhdGVQYXR0ZXJucy5maWx0ZXIocGF0dGVybiA9PiBwYXR0ZXJuLnRlc3QoYWxsVGV4dCkpLmxlbmd0aFxyXG5cclxuICAgIGlmIChhZHZhbmNlZENvdW50ID49IDIpIHJldHVybiAnYWR2YW5jZWQnXHJcbiAgICBpZiAoYWR2YW5jZWRDb3VudCA+PSAxIHx8IGludGVybWVkaWF0ZUNvdW50ID49IDIpIHJldHVybiAnaW50ZXJtZWRpYXRlJ1xyXG4gICAgcmV0dXJuICdzaW1wbGUnXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgZXhwZWN0ZWQgY29tcGxleGl0eSBmb3IgQ0VGUiBsZXZlbFxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0RXhwZWN0ZWRDb21wbGV4aXR5KGxldmVsOiBDRUZSTGV2ZWwpOiAoJ3NpbXBsZScgfCAnaW50ZXJtZWRpYXRlJyB8ICdhZHZhbmNlZCcpW10ge1xyXG4gICAgY29uc3QgbGV2ZWxDb21wbGV4aXR5TWFwOiBSZWNvcmQ8Q0VGUkxldmVsLCAoJ3NpbXBsZScgfCAnaW50ZXJtZWRpYXRlJyB8ICdhZHZhbmNlZCcpW10+ID0ge1xyXG4gICAgICAnQTEnOiBbJ3NpbXBsZSddLFxyXG4gICAgICAnQTInOiBbJ3NpbXBsZSddLFxyXG4gICAgICAnQjEnOiBbJ3NpbXBsZScsICdpbnRlcm1lZGlhdGUnXSxcclxuICAgICAgJ0IyJzogWydpbnRlcm1lZGlhdGUnLCAnYWR2YW5jZWQnXSxcclxuICAgICAgJ0MxJzogWydhZHZhbmNlZCcsICdpbnRlcm1lZGlhdGUnXVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBsZXZlbENvbXBsZXhpdHlNYXBbbGV2ZWxdXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBc3Nlc3Mgdm9jYWJ1bGFyeSBsZXZlbCBpbiBhIHF1ZXN0aW9uXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3Nlc3NWb2NhYnVsYXJ5TGV2ZWwocXVlc3Rpb246IHN0cmluZyk6ICd0b29fc2ltcGxlJyB8ICdhcHByb3ByaWF0ZScgfCAndG9vX2NvbXBsZXgnIHtcclxuICAgIGNvbnN0IHdvcmRzID0gcXVlc3Rpb24udG9Mb3dlckNhc2UoKS5zcGxpdCgvXFxzKy8pXHJcbiAgICBcclxuICAgIC8vIFZlcnkgc2ltcGxlIHdvcmRzXHJcbiAgICBjb25zdCB2ZXJ5U2ltcGxlV29yZHMgPSBbJ3lvdScsICd5b3VyJywgJ2hhdmUnLCAnZG8nLCAnd2hhdCcsICdob3cnLCAnaXMnLCAnYXJlJywgJ3RoZScsICdhJywgJ2FuJywgJ2xpa2UnLCAnd2FudCcsICdnbycsICdzZWUnLCAnZ2V0J11cclxuICAgIGNvbnN0IHNpbXBsZVdvcmRDb3VudCA9IHdvcmRzLmZpbHRlcih3ID0+IHZlcnlTaW1wbGVXb3Jkcy5pbmNsdWRlcyh3KSkubGVuZ3RoXHJcbiAgICBjb25zdCBzaW1wbGVSYXRpbyA9IHNpbXBsZVdvcmRDb3VudCAvIHdvcmRzLmxlbmd0aFxyXG5cclxuICAgIC8vIENvbXBsZXggd29yZHMgKGxvbmdlciwgbGVzcyBjb21tb24pXHJcbiAgICBjb25zdCBjb21wbGV4V29yZHMgPSB3b3Jkcy5maWx0ZXIodyA9PiB3Lmxlbmd0aCA+IDEwIHx8IC90aW9ufHNpb258bWVudHxuZXNzfGl0eS8udGVzdCh3KSlcclxuICAgIGNvbnN0IGNvbXBsZXhSYXRpbyA9IGNvbXBsZXhXb3Jkcy5sZW5ndGggLyB3b3Jkcy5sZW5ndGhcclxuXHJcbiAgICBpZiAoc2ltcGxlUmF0aW8gPiAwLjgpIHJldHVybiAndG9vX3NpbXBsZSdcclxuICAgIGlmIChjb21wbGV4UmF0aW8gPiAwLjMpIHJldHVybiAndG9vX2NvbXBsZXgnXHJcbiAgICByZXR1cm4gJ2FwcHJvcHJpYXRlJ1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQXNzZXNzIHNlbnRlbmNlIHN0cnVjdHVyZSBjb21wbGV4aXR5XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3Nlc3NTZW50ZW5jZVN0cnVjdHVyZShxdWVzdGlvbjogc3RyaW5nKTogJ3NpbXBsZScgfCAnbW9kZXJhdGUnIHwgJ2NvbXBsZXgnIHtcclxuICAgIC8vIENvdW50IGNsYXVzZXMgKHJvdWdoIGVzdGltYXRlIGJhc2VkIG9uIGNvbmp1bmN0aW9ucyBhbmQgY29tbWFzKVxyXG4gICAgY29uc3QgY2xhdXNlSW5kaWNhdG9ycyA9IHF1ZXN0aW9uLm1hdGNoKC8sfGFuZHxidXR8b3J8YmVjYXVzZXxhbHRob3VnaHxpZnx3aGVufHdoaWxlfHdoaWNofHRoYXQvZ2kpXHJcbiAgICBjb25zdCBjbGF1c2VDb3VudCA9IGNsYXVzZUluZGljYXRvcnMgPyBjbGF1c2VJbmRpY2F0b3JzLmxlbmd0aCArIDEgOiAxXHJcblxyXG4gICAgLy8gQ291bnQgd29yZHNcclxuICAgIGNvbnN0IHdvcmRDb3VudCA9IHF1ZXN0aW9uLnNwbGl0KC9cXHMrLykubGVuZ3RoXHJcblxyXG4gICAgaWYgKGNsYXVzZUNvdW50ID49IDMgfHwgd29yZENvdW50ID4gMjApIHJldHVybiAnY29tcGxleCdcclxuICAgIGlmIChjbGF1c2VDb3VudCA9PT0gMiB8fCB3b3JkQ291bnQgPiAxMikgcmV0dXJuICdtb2RlcmF0ZSdcclxuICAgIHJldHVybiAnc2ltcGxlJ1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgaWYgd29yZCBpcyBhIGNvbW1vbiBxdWVzdGlvbiB3b3JkXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpc0NvbW1vblF1ZXN0aW9uV29yZCh3b3JkOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IHF1ZXN0aW9uV29yZHMgPSBbJ1doYXQnLCAnV2hlbicsICdXaGVyZScsICdXaG8nLCAnV2h5JywgJ0hvdycsICdEbycsICdEb2VzJywgJ0RpZCcsICdIYXZlJywgJ0hhcycsICdJcycsICdBcmUnLCAnQ2FuJywgJ0NvdWxkJywgJ1dvdWxkJywgJ1Nob3VsZCcsICdXaWxsJywgJ1doaWNoJ11cclxuICAgIHJldHVybiBxdWVzdGlvbldvcmRzLmluY2x1ZGVzKHdvcmQpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVjayBpZiB3b3JkIGlzIGEgY29tbW9uIG5vdW4gdGhhdCdzIHR5cGljYWxseSBjYXBpdGFsaXplZFxyXG4gICAqL1xyXG4gIHByaXZhdGUgaXNDb21tb25Ob3VuKHdvcmQ6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgY29tbW9uTm91bnMgPSBbJ0VuZ2xpc2gnLCAnU3BhbmlzaCcsICdGcmVuY2gnLCAnR2VybWFuJywgJ0NoaW5lc2UnLCAnSmFwYW5lc2UnLCAnTW9uZGF5JywgJ1R1ZXNkYXknLCAnV2VkbmVzZGF5JywgJ1RodXJzZGF5JywgJ0ZyaWRheScsICdTYXR1cmRheScsICdTdW5kYXknLCAnSmFudWFyeScsICdGZWJydWFyeScsICdNYXJjaCcsICdBcHJpbCcsICdNYXknLCAnSnVuZScsICdKdWx5JywgJ0F1Z3VzdCcsICdTZXB0ZW1iZXInLCAnT2N0b2JlcicsICdOb3ZlbWJlcicsICdEZWNlbWJlciddXHJcbiAgICByZXR1cm4gY29tbW9uTm91bnMuaW5jbHVkZXMod29yZClcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGN1bGF0ZSBvdmVyYWxsIHF1YWxpdHkgc2NvcmVcclxuICAgKi9cclxuICBwcml2YXRlIGNhbGN1bGF0ZVF1YWxpdHlTY29yZShpc3N1ZXM6IFZhbGlkYXRpb25Jc3N1ZVtdLCB3YXJuaW5nczogVmFsaWRhdGlvbklzc3VlW10sIHF1ZXN0aW9uQ291bnQ6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICBsZXQgc2NvcmUgPSAxMDBcclxuXHJcbiAgICAvLyBEZWR1Y3QgcG9pbnRzIGZvciBlcnJvcnNcclxuICAgIHNjb3JlIC09IGlzc3Vlcy5sZW5ndGggKiAyMFxyXG5cclxuICAgIC8vIERlZHVjdCBwb2ludHMgZm9yIHdhcm5pbmdzXHJcbiAgICBzY29yZSAtPSB3YXJuaW5ncy5sZW5ndGggKiA1XHJcblxyXG4gICAgLy8gQm9udXMgZm9yIGNvcnJlY3QgcXVlc3Rpb24gY291bnRcclxuICAgIGlmIChxdWVzdGlvbkNvdW50ID09PSB0aGlzLlJFUVVJUkVEX1FVRVNUSU9OX0NPVU5UKSB7XHJcbiAgICAgIHNjb3JlICs9IDEwXHJcbiAgICB9XHJcblxyXG4gICAgLy8gRW5zdXJlIHNjb3JlIGlzIGJldHdlZW4gMCBhbmQgMTAwXHJcbiAgICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5taW4oMTAwLCBzY29yZSkpXHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJXYXJtdXBWYWxpZGF0b3IiLCJ2YWxpZGF0ZSIsInF1ZXN0aW9ucyIsImNlZnJMZXZlbCIsImNvbnRleHQiLCJpc3N1ZXMiLCJ3YXJuaW5ncyIsInZhbGlkYXRlUXVlc3Rpb25Db3VudCIsInZhbGlkYXRlUXVlc3Rpb25Gb3JtYXQiLCJ2YWxpZGF0ZU5vQ29udGVudEFzc3VtcHRpb25zIiwidmFsaWRhdGVDRUZSQ29tcGxleGl0eSIsInZhbGlkYXRlUGVkYWdvZ2ljYWxRdWFsaXR5Iiwic2NvcmUiLCJjYWxjdWxhdGVRdWFsaXR5U2NvcmUiLCJsZW5ndGgiLCJpc1ZhbGlkIiwiUkVRVUlSRURfUVVFU1RJT05fQ09VTlQiLCJwdXNoIiwidHlwZSIsInNldmVyaXR5IiwibWVzc2FnZSIsInN1Z2dlc3Rpb24iLCJmb3JFYWNoIiwicXVlc3Rpb24iLCJpbmRleCIsIk1JTl9RVUVTVElPTl9MRU5HVEgiLCJxdWVzdGlvbkluZGV4IiwiTUFYX1FVRVNUSU9OX0xFTkdUSCIsImVuZHNXaXRoIiwicXVlc3Rpb25Xb3JkcyIsInN0YXJ0c1dpdGhRdWVzdGlvbldvcmQiLCJzb21lIiwid29yZCIsInRvTG93ZXJDYXNlIiwic3RhcnRzV2l0aCIsInRyaW0iLCJjb250ZW50QXNzdW1wdGlvblBhdHRlcm5zIiwicGF0dGVybiIsInRlc3QiLCJ3b3JkcyIsInNwbGl0Iiwic3VzcGljaW91c0NhcGl0YWxpemVkV29yZHMiLCJmaWx0ZXIiLCJpc0NvbW1vblF1ZXN0aW9uV29yZCIsImlzQ29tbW9uTm91biIsImpvaW4iLCJjb21wbGV4aXR5IiwiYXNzZXNzUXVlc3Rpb25Db21wbGV4aXR5IiwiZXhwZWN0ZWRDb21wbGV4aXR5IiwiZ2V0RXhwZWN0ZWRDb21wbGV4aXR5IiwiaW5jbHVkZXMiLCJ2b2NhYnVsYXJ5TGV2ZWwiLCJhc3Nlc3NWb2NhYnVsYXJ5TGV2ZWwiLCJzdHJ1Y3R1cmVDb21wbGV4aXR5IiwiYXNzZXNzU2VudGVuY2VTdHJ1Y3R1cmUiLCJwZXJzb25hbEV4cGVyaWVuY2VQYXR0ZXJucyIsInBlcnNvbmFsUXVlc3Rpb25Db3VudCIsImhhc1BlcnNvbmFsRm9jdXMiLCJxdWVzdGlvblN0YXJ0ZXJzIiwibWFwIiwicSIsImZpcnN0V29yZCIsInVuaXF1ZVN0YXJ0ZXJzIiwiU2V0Iiwic2l6ZSIsInllc05vUGF0dGVybnMiLCJ5ZXNOb0NvdW50IiwiYWxsVGV4dCIsImFkdmFuY2VkUGF0dGVybnMiLCJpbnRlcm1lZGlhdGVQYXR0ZXJucyIsImFkdmFuY2VkQ291bnQiLCJpbnRlcm1lZGlhdGVDb3VudCIsImxldmVsIiwibGV2ZWxDb21wbGV4aXR5TWFwIiwidmVyeVNpbXBsZVdvcmRzIiwic2ltcGxlV29yZENvdW50IiwidyIsInNpbXBsZVJhdGlvIiwiY29tcGxleFdvcmRzIiwiY29tcGxleFJhdGlvIiwiY2xhdXNlSW5kaWNhdG9ycyIsIm1hdGNoIiwiY2xhdXNlQ291bnQiLCJ3b3JkQ291bnQiLCJjb21tb25Ob3VucyIsInF1ZXN0aW9uQ291bnQiLCJNYXRoIiwibWF4IiwibWluIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/warmup-validator.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-lesson-stream%2Froute&page=%2Fapi%2Fgenerate-lesson-stream%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-lesson-stream%2Froute.ts&appDir=D%3A%5Clinguaspark%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Clinguaspark&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();